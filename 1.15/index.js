(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const A0=!1;var Hp=Array.isArray,EC=Array.prototype.indexOf,km=Array.from,Mb=Object.defineProperty,ba=Object.getOwnPropertyDescriptor,Hb=Object.getOwnPropertyDescriptors,FC=Object.prototype,IC=Array.prototype,Om=Object.getPrototypeOf;function Qc(n){return typeof n=="function"}const bd=()=>{};function UC(n){return n()}function l0(n){for(var e=0;e<n.length;e++)n[e]()}const Js=2,jb=4,Pu=8,Dm=16,Yi=32,Hd=64,tp=128,Ki=256,rp=512,Ro=1024,Ia=2048,pl=4096,_a=8192,jp=16384,QC=32768,ku=65536,Rb=1<<17,TC=1<<19,qb=1<<20,Hi=Symbol("$state"),Kb=Symbol("legacy props"),d0=Symbol("");function $b(n){return n===this.v}function Nm(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function LC(n,e){return n!==e}function Mm(n){return!Nm(n,this.v)}function PC(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function kC(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function OC(n){throw new Error("https://svelte.dev/e/effect_orphan")}function DC(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function NC(n){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function MC(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function HC(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function jC(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function RC(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function qC(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let jd=!1,KC=!1;function $C(){jd=!0}const Hm=1,jm=2,Vb=4,VC=8,GC=16,WC=1,XC=2,Gb=4,YC=8,JC=16,Wb=1,ZC=2,Wo=Symbol(),Xb="http://www.w3.org/2000/svg";function Rp(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let tn=null;function T2(n){tn=n}function Hr(n,e=!1,t){tn={p:tn,c:null,e:null,m:!1,s:n,x:null,l:null},jd&&!e&&(tn.l={s:null,u:null,r1:[],r2:Us(!1)})}function jr(n){const e=tn;if(e!==null){n!==void 0&&(e.x=n);const i=e.e;if(i!==null){var t=rn,r=yn;e.e=null;try{for(var o=0;o<i.length;o++){var s=i[o];Vi(s.effect),gA(s.reaction),Du(s.fn)}}finally{Vi(t),gA(r)}}tn=e.p,e.m=!0}return n||{}}function Rd(){return!jd||tn!==null&&tn.l===null}function Us(n,e){var t={f:0,v:n,reactions:null,equals:$b,rv:0,wv:0};return t}function qp(n,e=!1){var r;const t=Us(n);return e||(t.equals=Mm),jd&&tn!==null&&tn.l!==null&&((r=tn.l).s??(r.s=[])).push(t),t}function Ie(n,e=!1){return e4(qp(n,e))}function e4(n){return yn!==null&&!Ba&&yn.f&Js&&(ji===null?u4([n]):ji.push(n)),n}function hr(n,e){return _(n,lt(()=>l(n))),e}function _(n,e){return yn!==null&&!Ba&&Rd()&&yn.f&(Js|Dm)&&(ji===null||!ji.includes(n))&&qC(),fu(n,e)}function fu(n,e){return n.equals(e)||(n.v,n.v=e,n.wv=c_(),Yb(n,Ia),Rd()&&rn!==null&&rn.f&Ro&&!(rn.f&(Yi|Hd))&&(ga===null?h4([n]):ga.push(n))),e}function fa(n,e=1){var t=l(n),r=e===1?t++:t--;return _(n,t),r}function Yb(n,e){var t=n.reactions;if(t!==null)for(var r=Rd(),o=t.length,s=0;s<o;s++){var i=t[s],a=i.f;a&Ia||!r&&i===rn||(yi(i,e),a&(Ro|Ki)&&(a&Js?Yb(i,pl):Wp(i)))}}let Rm=!1;function ld(n,e=null,t){if(typeof n!="object"||n===null||Hi in n)return n;const r=Om(n);if(r!==FC&&r!==IC)return n;var o=new Map,s=Hp(n),i=Us(0);s&&o.set("length",Us(n.length));var a;return new Proxy(n,{defineProperty(A,d,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&HC();var u=o.get(d);return u===void 0?(u=Us(c.value),o.set(d,u)):_(u,ld(c.value,a)),!0},deleteProperty(A,d){var c=o.get(d);if(c===void 0)d in A&&o.set(d,Us(Wo));else{if(s&&typeof d=="string"){var u=o.get("length"),h=Number(d);Number.isInteger(h)&&h<u.v&&_(u,h)}_(c,Wo),L2(i)}return!0},get(A,d,c){var g;if(d===Hi)return n;var u=o.get(d),h=d in A;if(u===void 0&&(!h||(g=ba(A,d))!=null&&g.writable)&&(u=Us(ld(h?A[d]:Wo,a)),o.set(d,u)),u!==void 0){var f=l(u);return f===Wo?void 0:f}return Reflect.get(A,d,c)},getOwnPropertyDescriptor(A,d){var c=Reflect.getOwnPropertyDescriptor(A,d);if(c&&"value"in c){var u=o.get(d);u&&(c.value=l(u))}else if(c===void 0){var h=o.get(d),f=h==null?void 0:h.v;if(h!==void 0&&f!==Wo)return{enumerable:!0,configurable:!0,value:f,writable:!0}}return c},has(A,d){var f;if(d===Hi)return!0;var c=o.get(d),u=c!==void 0&&c.v!==Wo||Reflect.has(A,d);if(c!==void 0||rn!==null&&(!u||(f=ba(A,d))!=null&&f.writable)){c===void 0&&(c=Us(u?ld(A[d],a):Wo),o.set(d,c));var h=l(c);if(h===Wo)return!1}return u},set(A,d,c,u){var F;var h=o.get(d),f=d in A;if(s&&d==="length")for(var g=c;g<h.v;g+=1){var m=o.get(g+"");m!==void 0?_(m,Wo):g in A&&(m=Us(Wo),o.set(g+"",m))}h===void 0?(!f||(F=ba(A,d))!=null&&F.writable)&&(h=Us(void 0),_(h,ld(c,a)),o.set(d,h)):(f=h.v!==Wo,_(h,ld(c,a)));var y=Reflect.getOwnPropertyDescriptor(A,d);if(y!=null&&y.set&&y.set.call(u,c),!f){if(s&&typeof d=="string"){var b=o.get("length"),S=Number(d);Number.isInteger(S)&&S>=b.v&&_(b,S+1)}L2(i)}return!0},ownKeys(A){l(i);var d=Reflect.ownKeys(A).filter(h=>{var f=o.get(h);return f===void 0||f.v!==Wo});for(var[c,u]of o)u.v!==Wo&&!(c in A)&&d.push(c);return d},setPrototypeOf(){jC()}})}function L2(n,e=1){_(n,n.v+e)}function P2(n){return n!==null&&typeof n=="object"&&Hi in n?n[Hi]:n}function t4(n,e){return Object.is(P2(n),P2(e))}var k2,Jb,Zb;function r4(){if(k2===void 0){k2=window;var n=Element.prototype,e=Node.prototype;Jb=ba(e,"firstChild").get,Zb=ba(e,"nextSibling").get,n.__click=void 0,n.__className="",n.__attributes=null,n.__styles=null,n.__e=void 0,Text.prototype.__t=void 0}}function Ou(n=""){return document.createTextNode(n)}function Qs(n){return Jb.call(n)}function Kp(n){return Zb.call(n)}function w(n,e){return Qs(n)}function gt(n,e){{var t=Qs(n);return t instanceof Comment&&t.data===""?Kp(t):t}}function z(n,e=1,t=!1){let r=n;for(;e--;)r=Kp(r);return r}function n4(n){n.textContent=""}function kd(n){var e=Js|Ia,t=yn!==null&&yn.f&Js?yn:null;return rn===null||t!==null&&t.f&Ki?e|=Ki:rn.f|=qb,{ctx:tn,deps:null,effects:null,equals:$b,f:e,fn:n,reactions:null,rv:0,v:null,wv:0,parent:t??rn}}function it(n){const e=kd(n);return e.equals=Mm,e}function e_(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)$i(e[t])}}function o4(n){for(var e=n.parent;e!==null;){if(!(e.f&Js))return e;e=e.parent}return null}function s4(n){var e,t=rn;Vi(o4(n));try{e_(n),e=h_(n)}finally{Vi(t)}return e}function t_(n){var e=s4(n),t=(AA||n.f&Ki)&&n.deps!==null?pl:Ro;yi(n,t),n.equals(e)||(n.v=e,n.wv=c_())}function r_(n){rn===null&&yn===null&&OC(),yn!==null&&yn.f&Ki&&rn===null&&kC(),$m&&PC()}function i4(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function qd(n,e,t,r=!0){var o=(n&Hd)!==0,s=rn,i={ctx:tn,deps:null,nodes_start:null,nodes_end:null,f:n|Ia,first:null,fn:e,last:null,next:null,parent:o?null:s,prev:null,teardown:null,transitions:null,wv:0};if(t){var a=_d;try{O2(!0),Gp(i),i.f|=QC}catch(c){throw $i(i),c}finally{O2(a)}}else e!==null&&Wp(i);var A=t&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&(qb|tp))===0;if(!A&&!o&&r&&(s!==null&&i4(i,s),yn!==null&&yn.f&Js)){var d=yn;(d.effects??(d.effects=[])).push(i)}return i}function qm(n){const e=qd(Pu,null,!1);return yi(e,Ro),e.teardown=n,e}function c0(n){r_();var e=rn!==null&&(rn.f&Yi)!==0&&tn!==null&&!tn.m;if(e){var t=tn;(t.e??(t.e=[])).push({fn:n,effect:rn,reaction:yn})}else{var r=Du(n);return r}}function a4(n){return r_(),Kd(n)}function A4(n){const e=qd(Hd,n,!0);return(t={})=>new Promise(r=>{t.outro?cl(e,()=>{$i(e),r(void 0)}):($i(e),r(void 0))})}function Du(n){return qd(jb,n,!1)}function Zt(n,e){var t=tn,r={effect:null,ran:!1};t.l.r1.push(r),r.effect=Kd(()=>{n(),!r.ran&&(r.ran=!0,_(t.l.r2,!0),lt(e))})}function Zn(){var n=tn;Kd(()=>{if(l(n.l.r2)){for(var e of n.l.r1){var t=e.effect;t.f&Ro&&yi(t,pl),$d(t)&&Gp(t),e.ran=!1}n.l.r2.v=!1}})}function Kd(n){return qd(Pu,n,!0)}function He(n,e=[],t=kd){const r=e.map(t);return gl(()=>n(...r.map(l)))}function gl(n,e=0){return qd(Pu|Dm|e,n,!0)}function Ca(n,e=!0){return qd(Pu|Yi,n,!0,e)}function n_(n){var e=n.teardown;if(e!==null){const t=$m,r=yn;D2(!0),gA(null);try{e.call(null)}finally{D2(t),gA(r)}}}function o_(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){var r=t.next;$i(t,e),t=r}}function l4(n){for(var e=n.first;e!==null;){var t=e.next;e.f&Yi||$i(e),e=t}}function $i(n,e=!0){var t=!1;if((e||n.f&TC)&&n.nodes_start!==null){for(var r=n.nodes_start,o=n.nodes_end;r!==null;){var s=r===o?null:Kp(r);r.remove(),r=s}t=!0}o_(n,e&&!t),sp(n,0),yi(n,jp);var i=n.transitions;if(i!==null)for(const A of i)A.stop();n_(n);var a=n.parent;a!==null&&a.first!==null&&s_(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=null}function s_(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function cl(n,e){var t=[];Km(n,t,!0),i_(t,()=>{$i(n),e&&e()})}function i_(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function Km(n,e,t){if(!(n.f&_a)){if(n.f^=_a,n.transitions!==null)for(const i of n.transitions)(i.is_global||t)&&e.push(i);for(var r=n.first;r!==null;){var o=r.next,s=(r.f&ku)!==0||(r.f&Yi)!==0;Km(r,e,s?t:!1),r=o}}}function pu(n){a_(n,!0)}function a_(n,e){if(n.f&_a){n.f^=_a,n.f&Ro||(n.f^=Ro),$d(n)&&(yi(n,Ia),Wp(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&ku)!==0||(t.f&Yi)!==0;a_(t,o?e:!1),t=r}if(n.transitions!==null)for(const s of n.transitions)(s.is_global||e)&&s.in()}}let np=!1,u0=[];function A_(){np=!1;const n=u0.slice();u0=[],l0(n)}function $p(n){np||(np=!0,queueMicrotask(A_)),u0.push(n)}function d4(){np&&A_()}const l_=0,c4=1;let Tf=!1,Lf=l_,gu=!1,vu=null,_d=!1,$m=!1;function O2(n){_d=n}function D2(n){$m=n}let JA=[],Bd=0;let yn=null,Ba=!1;function gA(n){yn=n}let rn=null;function Vi(n){rn=n}let ji=null;function u4(n){ji=n}let Jo=null,Fs=0,ga=null;function h4(n){ga=n}let d_=1,op=0,AA=!1,iA=null;function c_(){return++d_}function $d(n){var d;var e=n.f;if(e&Ia)return!0;if(e&pl){var t=n.deps,r=(e&Ki)!==0;if(t!==null){var o,s,i=(e&rp)!==0,a=r&&rn!==null&&!AA,A=t.length;if(i||a){for(o=0;o<A;o++)s=t[o],(i||!((d=s==null?void 0:s.reactions)!=null&&d.includes(n)))&&(s.reactions??(s.reactions=[])).push(n);i&&(n.f^=rp)}for(o=0;o<A;o++)if(s=t[o],$d(s)&&t_(s),s.wv>n.wv)return!0}(!r||rn!==null&&!AA)&&yi(n,Ro)}return!1}function f4(n,e){for(var t=e;t!==null;){if(t.f&tp)try{t.fn(n);return}catch{t.f^=tp}t=t.parent}throw Tf=!1,n}function p4(n){return(n.f&jp)===0&&(n.parent===null||(n.parent.f&tp)===0)}function Vp(n,e,t,r){if(Tf){if(t===null&&(Tf=!1),p4(e))throw n;return}t!==null&&(Tf=!0);{f4(n,e);return}}function u_(n,e,t=0){var r=n.reactions;if(r!==null)for(var o=0;o<r.length;o++){var s=r[o];s.f&Js?u_(s,e,t+1):e===s&&(t===0?yi(s,Ia):s.f&Ro&&yi(s,pl),Wp(s))}}function h_(n){var f;var e=Jo,t=Fs,r=ga,o=yn,s=AA,i=ji,a=tn,A=Ba,d=n.f;Jo=null,Fs=0,ga=null,yn=d&(Yi|Hd)?null:n,AA=(d&Ki)!==0&&(!_d||o===null||A),ji=null,T2(n.ctx),Ba=!1,op++;try{var c=(0,n.fn)(),u=n.deps;if(Jo!==null){var h;if(sp(n,Fs),u!==null&&Fs>0)for(u.length=Fs+Jo.length,h=0;h<Jo.length;h++)u[Fs+h]=Jo[h];else n.deps=u=Jo;if(!AA)for(h=Fs;h<u.length;h++)((f=u[h]).reactions??(f.reactions=[])).push(n)}else u!==null&&Fs<u.length&&(sp(n,Fs),u.length=Fs);if(Rd()&&ga!==null&&!(n.f&(Js|pl|Ia)))for(h=0;h<ga.length;h++)u_(ga[h],n);return o!==null&&op++,c}finally{Jo=e,Fs=t,ga=r,yn=o,AA=s,ji=i,T2(a),Ba=A}}function g4(n,e){let t=e.reactions;if(t!==null){var r=EC.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&e.f&Js&&(Jo===null||!Jo.includes(e))&&(yi(e,pl),e.f&(Ki|rp)||(e.f^=rp),e_(e),sp(e,0))}function sp(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)g4(n,t[r])}function Gp(n){var e=n.f;if(!(e&jp)){yi(n,Ro);var t=rn,r=tn;rn=n;try{e&Dm?l4(n):o_(n),n_(n);var o=h_(n);n.teardown=typeof o=="function"?o:null,n.wv=d_;var s=n.deps,i;A0&&KC&&n.f&Ia}catch(a){Vp(a,n,t,r||n.ctx)}finally{rn=t}}}function f_(){if(Bd>1e3){Bd=0;try{DC()}catch(n){if(vu!==null)Vp(n,vu,null);else throw n}}Bd++}function p_(n){var e=n.length;if(e!==0){f_();var t=_d;_d=!0;try{for(var r=0;r<e;r++){var o=n[r];o.f&Ro||(o.f^=Ro);var s=[];g_(o,s),v4(s)}}finally{_d=t}}}function v4(n){var e=n.length;if(e!==0)for(var t=0;t<e;t++){var r=n[t];if(!(r.f&(jp|_a)))try{$d(r)&&(Gp(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?s_(r):r.fn=null))}catch(o){Vp(o,r,null,r.ctx)}}}function m4(){if(gu=!1,Bd>1001)return;const n=JA;JA=[],p_(n),gu||(Bd=0,vu=null)}function Wp(n){Lf===l_&&(gu||(gu=!0,queueMicrotask(m4))),vu=n;for(var e=n;e.parent!==null;){e=e.parent;var t=e.f;if(t&(Hd|Yi)){if(!(t&Ro))return;e.f^=Ro}}JA.push(e)}function g_(n,e){var t=n.first,r=[];e:for(;t!==null;){var o=t.f,s=(o&Yi)!==0,i=s&&(o&Ro)!==0,a=t.next;if(!i&&!(o&_a))if(o&Pu){if(s)t.f^=Ro;else{var A=yn;try{yn=t,$d(t)&&Gp(t)}catch(h){Vp(h,t,null,t.ctx)}finally{yn=A}}var d=t.first;if(d!==null){t=d;continue}}else o&jb&&r.push(t);if(a===null){let h=t.parent;for(;h!==null;){if(n===h)break e;var c=h.next;if(c!==null){t=c;continue e}h=h.parent}}t=a}for(var u=0;u<r.length;u++)d=r[u],e.push(d),g_(d,e)}function v_(n){var e=Lf,t=JA;try{f_();const o=[];Lf=c4,JA=o,gu=!1,p_(t);var r=n==null?void 0:n();return d4(),(JA.length>0||o.length>0)&&v_(),Bd=0,vu=null,r}finally{Lf=e,JA=t}}async function Oi(){await Promise.resolve(),v_()}function l(n){var e=n.f,t=(e&Js)!==0;if(iA!==null&&iA.add(n),yn!==null&&!Ba){ji!==null&&ji.includes(n)&&RC();var r=yn.deps;n.rv<op&&(n.rv=op,Jo===null&&r!==null&&r[Fs]===n?Fs++:Jo===null?Jo=[n]:(!AA||!Jo.includes(n))&&Jo.push(n))}else if(t&&n.deps===null&&n.effects===null){var o=n,s=o.parent;s!==null&&!(s.f&Ki)&&(o.f^=Ki)}return t&&(o=n,$d(o)&&t_(o)),n.v}function w4(n){var e=iA;iA=new Set;var t=iA,r;try{if(lt(n),e!==null)for(r of iA)e.add(r)}finally{iA=e}return t}function ip(n){var e=w4(()=>lt(n));for(var t of e)if(t.f&Rb)for(const r of t.deps||[])r.f&Js||fu(r,r.v);else fu(t,t.v)}function lt(n){var e=Ba;try{return Ba=!0,n()}finally{Ba=e}}const y4=-7169;function yi(n,e){n.f=n.f&y4|e}function zn(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(Hi in n)h0(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&Hi in t&&h0(t)}}}function h0(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{h0(n[r],e)}catch{}const t=Om(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=Hb(t);for(let o in r){const s=r[o].get;if(s)try{s.call(n)}catch{}}}}}function b4(n){return n.endsWith("capture")&&n!=="gotpointercapture"&&n!=="lostpointercapture"}const _4=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function B4(n){return _4.includes(n)}const x4={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function z4(n){return n=n.toLowerCase(),x4[n]??n}const C4=["touchstart","touchmove"];function S4(n){return C4.includes(n)}function E4(n,e){if(e){const t=document.body;n.autofocus=!0,$p(()=>{document.activeElement===t&&n.focus()})}}let N2=!1;function F4(){N2||(N2=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const t of n.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function m_(n){var e=yn,t=rn;gA(null),Vi(null);try{return n()}finally{gA(e),Vi(t)}}function Vm(n,e,t,r=t){n.addEventListener(e,()=>m_(t));const o=n.__on_r;o?n.__on_r=()=>{o(),r(!0)}:n.__on_r=()=>r(!0),F4()}const w_=new Set,f0=new Set;function y_(n,e,t,r={}){function o(s){if(r.capture||Kc.call(e,s),!s.cancelBubble)return m_(()=>t==null?void 0:t.call(this,s))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?$p(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function at(n,e,t,r,o){var s={capture:r,passive:o},i=y_(n,e,t,s);(e===document.body||e===window||e===document)&&qm(()=>{e.removeEventListener(n,i,s)})}function I4(n){for(var e=0;e<n.length;e++)w_.add(n[e]);for(var t of f0)t(n)}function Kc(n){var S;var e=this,t=e.ownerDocument,r=n.type,o=((S=n.composedPath)==null?void 0:S.call(n))||[],s=o[0]||n.target,i=0,a=n.__root;if(a){var A=o.indexOf(a);if(A!==-1&&(e===document||e===window)){n.__root=e;return}var d=o.indexOf(e);if(d===-1)return;A<=d&&(i=A)}if(s=o[i]||n.target,s!==e){Mb(n,"currentTarget",{configurable:!0,get(){return s||t}});var c=yn,u=rn;gA(null),Vi(null);try{for(var h,f=[];s!==null;){var g=s.assignedSlot||s.parentNode||s.host||null;try{var m=s["__"+r];if(m!==void 0&&!s.disabled)if(Hp(m)){var[y,...b]=m;y.apply(s,[n,...b])}else m.call(s,n)}catch(F){h?f.push(F):h=F}if(n.cancelBubble||g===e||g===null)break;s=g}if(h){for(let F of f)queueMicrotask(()=>{throw F});throw h}}finally{n.__root=e,delete n.currentTarget,gA(c),Vi(u)}}}function Gm(n){var e=document.createElement("template");return e.innerHTML=n,e.content}function vA(n,e){var t=rn;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function ee(n,e){var t=(e&Wb)!==0,r=(e&ZC)!==0,o,s=!n.startsWith("<!>");return()=>{o===void 0&&(o=Gm(s?n:"<!>"+n),t||(o=Qs(o)));var i=r?document.importNode(o,!0):o.cloneNode(!0);if(t){var a=Qs(i),A=i.lastChild;vA(a,A)}else vA(i,i);return i}}function Xp(n,e,t="svg"){var r=!n.startsWith("<!>"),o=(e&Wb)!==0,s=`<${t}>${r?n:"<!>"+n}</${t}>`,i;return()=>{if(!i){var a=Gm(s),A=Qs(a);if(o)for(i=document.createDocumentFragment();Qs(A);)i.appendChild(Qs(A));else i=Qs(A)}var d=i.cloneNode(!0);if(o){var c=Qs(d),u=d.lastChild;vA(c,u)}else vA(d,d);return d}}function Wr(n=""){{var e=Ou(n+"");return vA(e,e),e}}function Nt(){var n=document.createDocumentFragment(),e=document.createComment(""),t=Ou();return n.append(e,t),vA(e,t),n}function T(n,e){n!==null&&n.before(e)}function Qe(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=t,n.nodeValue=t+"")}function ua(n,e){return U4(n,e)}const jl=new Map;function U4(n,{target:e,anchor:t,props:r={},events:o,context:s,intro:i=!0}){r4();var a=new Set,A=u=>{for(var h=0;h<u.length;h++){var f=u[h];if(!a.has(f)){a.add(f);var g=S4(f);e.addEventListener(f,Kc,{passive:g});var m=jl.get(f);m===void 0?(document.addEventListener(f,Kc,{passive:g}),jl.set(f,1)):jl.set(f,m+1)}}};A(km(w_)),f0.add(A);var d=void 0,c=A4(()=>{var u=t??e.appendChild(Ou());return Ca(()=>{if(s){Hr({});var h=tn;h.c=s}o&&(r.$$events=o),d=n(u,r)||{},s&&jr()}),()=>{var g;for(var h of a){e.removeEventListener(h,Kc);var f=jl.get(h);--f===0?(document.removeEventListener(h,Kc),jl.delete(h)):jl.set(h,f)}f0.delete(A),u!==t&&((g=u.parentNode)==null||g.removeChild(u))}});return p0.set(d,c),d}let p0=new WeakMap;function M2(n,e){const t=p0.get(n);return t?(p0.delete(n),t(e)):Promise.resolve()}function Se(n,e,t=!1){var r=n,o=null,s=null,i=Wo,a=t?ku:0,A=!1;const d=(u,h=!0)=>{A=!0,c(h,u)},c=(u,h)=>{i!==(i=u)&&(i?(o?pu(o):h&&(o=Ca(()=>h(r))),s&&cl(s,()=>{s=null})):(s?pu(s):h&&(s=Ca(()=>h(r))),o&&cl(o,()=>{o=null})))};gl(()=>{A=!1,e(d),A||c(null,null)},a)}function Q4(n,e,t){var r=n,o=Wo,s,i=Rd()?LC:Nm;gl(()=>{i(o,o=e())&&(s&&cl(s),s=Ca(()=>t(r)))})}function ar(n,e){return e}function T4(n,e,t,r){for(var o=[],s=e.length,i=0;i<s;i++)Km(e[i].e,o,!0);var a=s>0&&o.length===0&&t!==null;if(a){var A=t.parentNode;n4(A),A.append(t),r.clear(),nA(n,e[0].prev,e[s-1].next)}i_(o,()=>{for(var d=0;d<s;d++){var c=e[d];a||(r.delete(c.k),nA(n,c.prev,c.next)),$i(c.e,!a)}})}function Jt(n,e,t,r,o,s=null){var i=n,a={items:new Map,first:null},A=(e&Vb)!==0;if(A){var d=n;i=d.appendChild(Ou())}var c=null,u=!1,h=it(()=>{var f=t();return Hp(f)?f:f==null?[]:km(f)});gl(()=>{var f=l(h),g=f.length;u&&g===0||(u=g===0,L4(f,a,i,o,e,r,t),s!==null&&(g===0?c?pu(c):c=Ca(()=>s(i)):c!==null&&cl(c,()=>{c=null})),l(h))})}function L4(n,e,t,r,o,s,i){var se,ce,re,pe;var a=(o&VC)!==0,A=(o&(Hm|jm))!==0,d=n.length,c=e.items,u=e.first,h=u,f,g=null,m,y=[],b=[],S,F,k,P;if(a)for(P=0;P<d;P+=1)S=n[P],F=s(S,P),k=c.get(F),k!==void 0&&((se=k.a)==null||se.measure(),(m??(m=new Set)).add(k));for(P=0;P<d;P+=1){if(S=n[P],F=s(S,P),k=c.get(F),k===void 0){var te=h?h.e.nodes_start:t;g=k4(te,e,g,g===null?e.first:g.next,S,F,P,r,o,i),c.set(F,g),y=[],b=[],h=g.next;continue}if(A&&P4(k,S,P,o),k.e.f&_a&&(pu(k.e),a&&((ce=k.a)==null||ce.unfix(),(m??(m=new Set)).delete(k))),k!==h){if(f!==void 0&&f.has(k)){if(y.length<b.length){var $=b[0],j;g=$.prev;var J=y[0],we=y[y.length-1];for(j=0;j<y.length;j+=1)H2(y[j],$,t);for(j=0;j<b.length;j+=1)f.delete(b[j]);nA(e,J.prev,we.next),nA(e,g,J),nA(e,we,$),h=$,g=we,P-=1,y=[],b=[]}else f.delete(k),H2(k,h,t),nA(e,k.prev,k.next),nA(e,k,g===null?e.first:g.next),nA(e,g,k),g=k;continue}for(y=[],b=[];h!==null&&h.k!==F;)h.e.f&_a||(f??(f=new Set)).add(h),b.push(h),h=h.next;if(h===null)continue;k=h}y.push(k),g=k,h=k.next}if(h!==null||f!==void 0){for(var D=f===void 0?[]:km(f);h!==null;)h.e.f&_a||D.push(h),h=h.next;var N=D.length;if(N>0){var Z=o&Vb&&d===0?t:null;if(a){for(P=0;P<N;P+=1)(re=D[P].a)==null||re.measure();for(P=0;P<N;P+=1)(pe=D[P].a)==null||pe.fix()}T4(e,D,Z,c)}}a&&$p(()=>{var V;if(m!==void 0)for(k of m)(V=k.a)==null||V.apply()}),rn.first=e.first&&e.first.e,rn.last=g&&g.e}function P4(n,e,t,r){r&Hm&&fu(n.v,e),r&jm?fu(n.i,t):n.i=t}function k4(n,e,t,r,o,s,i,a,A,d){var c=(A&Hm)!==0,u=(A&GC)===0,h=c?u?qp(o):Us(o):o,f=A&jm?Us(i):i,g={i:f,v:h,k:s,a:null,e:null,prev:t,next:r};try{return g.e=Ca(()=>a(n,h,f,d),Rm),g.e.prev=t&&t.e,g.e.next=r&&r.e,t===null?e.first=g:(t.next=g,t.e.next=g.e),r!==null&&(r.prev=g,r.e.prev=g.e),g}finally{}}function H2(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,s=n.e.nodes_start;s!==r;){var i=Kp(s);o.before(s),s=i}}function nA(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function g0(n,e,t,r,o){var s=n,i="",a;gl(()=>{i!==(i=e()??"")&&(a!==void 0&&($i(a),a=void 0),i!==""&&(a=Ca(()=>{var A=i+"";t&&(A=`<svg>${A}</svg>`);var d=Gm(A);if((t||r)&&(d=Qs(d)),vA(Qs(d),d.lastChild),t||r)for(;Qs(d);)s.before(Qs(d));else s.before(d)})))})}function dn(n,e,t,r,o){var a;var s=(a=e.$$slots)==null?void 0:a[t],i=!1;s===!0&&(s=e.children,i=!0),s===void 0||s(n,i?()=>r:r)}function Wm(n,e,t){var r=n,o,s;gl(()=>{o!==(o=e())&&(s&&(cl(s),s=null),o&&(s=Ca(()=>t(r,o))))},ku)}function O4(n,e,t,r,o,s){var i,a,A=null,d=n,c;gl(()=>{const u=e()||null;var h=Xb;u!==i&&(c&&(u===null?cl(c,()=>{c=null,a=null}):u===a?pu(c):$i(c)),u&&u!==a&&(c=Ca(()=>{if(A=document.createElementNS(h,u),vA(A,A),r){var f=A.appendChild(Ou());r(A,f)}rn.nodes_end=A,d.before(A)})),i=u,i&&(a=i))},ku)}function b_(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(t=b_(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function D4(){for(var n,e,t=0,r="",o=arguments.length;t<o;t++)(n=arguments[t])&&(e=b_(n))&&(r&&(r+=" "),r+=e);return r}function v0(n){return typeof n=="object"?D4(n):n??""}function Xm(n,e){var t=n.__attributes??(n.__attributes={});t.value===(t.value=e??void 0)||n.value===e&&(e!==0||n.nodeName!=="PROGRESS")||(n.value=e??"")}function mu(n,e){var t=n.__attributes??(n.__attributes={});t.checked!==(t.checked=e??void 0)&&(n.checked=e)}function N4(n,e){e?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function nr(n,e,t,r){var o=n.__attributes??(n.__attributes={});o[e]!==(o[e]=t)&&(e==="style"&&"__styles"in n&&(n.__styles={}),e==="loading"&&(n[d0]=t),t==null?n.removeAttribute(e):typeof t!="string"&&__(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function j2(n,e,t,r,o=!1,s=!1,i=!1){var a=e||{},A=n.tagName==="OPTION";for(var d in e)d in t||(t[d]=null);t.class&&(t.class=v0(t.class));var c=__(n),u=n.__attributes??(n.__attributes={});for(const b in t){let S=t[b];if(A&&b==="value"&&S==null){n.value=n.__value="",a[b]=S;continue}var h=a[b];if(S!==h){a[b]=S;var f=b[0]+b[1];if(f!=="$$"){if(f==="on"){const F={},k="$$"+b;let P=b.slice(2);var g=B4(P);if(b4(P)&&(P=P.slice(0,-7),F.capture=!0),!g&&h){if(S!=null)continue;n.removeEventListener(P,a[k],F),a[k]=null}if(S!=null)if(g)n[`__${P}`]=S,I4([P]);else{let te=function($){a[b].call(this,$)};a[k]=y_(P,n,te,F)}else g&&(n[`__${P}`]=void 0)}else if(b==="style"&&S!=null)n.style.cssText=S+"";else if(b==="autofocus")E4(n,!!S);else if(!s&&(b==="__value"||b==="value"&&S!=null))n.value=n.__value=S;else if(b==="selected"&&A)N4(n,S);else{var m=b;o||(m=z4(m));var y=m==="defaultValue"||m==="defaultChecked";if(S==null&&!s&&!y)if(u[b]=null,m==="value"||m==="checked"){let F=n;if(m==="value"){let k=F.defaultValue;F.removeAttribute(m),F.defaultValue=k}else{let k=F.defaultChecked;F.removeAttribute(m),F.defaultChecked=k}}else n.removeAttribute(b);else y||c.includes(m)&&(s||typeof S!="string")?n[m]=S:typeof S!="function"&&nr(n,m,S)}b==="style"&&"__styles"in n&&(n.__styles={})}}}return a}var R2=new Map;function __(n){var e=R2.get(n.nodeName);if(e)return e;R2.set(n.nodeName,e=[]);for(var t,r=n,o=Element.prototype;o!==r;){t=Hb(r);for(var s in t)t[s].set&&e.push(s);r=Om(r)}return e}function B_(n){if(n.loading==="lazy"){var e=n.src;n[d0]=null,n.loading="eager",n.removeAttribute("src"),requestAnimationFrame(()=>{n[d0]!=="eager"&&(n.loading="lazy"),n.src=e})}}function M4(n,e,t){var r=n.__className,o=x_(e);(r!==o||Rm)&&(o===""?n.removeAttribute("class"):n.setAttribute("class",o),n.__className=o)}function Ir(n,e,t){var r=n.__className,o=x_(e);(r!==o||Rm)&&(e==null?n.removeAttribute("class"):n.className=o,n.__className=o)}function x_(n,e){return(n??"")+""}function hA(n,e,t){if(t){if(n.classList.contains(e))return;n.classList.add(e)}else{if(!n.classList.contains(e))return;n.classList.remove(e)}}function br(n,e,t=e){var r=Rd();Vm(n,"input",o=>{var s=o?n.defaultValue:n.value;if(s=iv(n)?av(s):s,t(s),r&&s!==(s=e())){var i=n.selectionStart,a=n.selectionEnd;n.value=s??"",a!==null&&(n.selectionStart=i,n.selectionEnd=Math.min(a,n.value.length))}}),lt(e)==null&&n.value&&t(iv(n)?av(n.value):n.value),Kd(()=>{var o=e();iv(n)&&o===av(n.value)||n.type==="date"&&!o&&!n.value||o!==n.value&&(n.value=o??"")})}function m0(n,e,t=e){Vm(n,"change",r=>{var o=r?n.defaultChecked:n.checked;t(o)}),lt(e)==null&&t(n.checked),Kd(()=>{var r=e();n.checked=!!r})}function iv(n){var e=n.type;return e==="number"||e==="range"}function av(n){return n===""?null:+n}function z_(n,e,t){var r=ba(n,e);r&&r.set&&(n[e]=t,qm(()=>{n[e]=null}))}function C_(n,e,t){if(n.multiple)return j4(n,e);for(var r of n.options){var o=tu(r);if(t4(o,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function H4(n,e){Du(()=>{var t=new MutationObserver(()=>{var r=n.__value;C_(n,r)});return t.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function ap(n,e,t=e){var r=!0;Vm(n,"change",o=>{var s=o?"[selected]":":checked",i;if(n.multiple)i=[].map.call(n.querySelectorAll(s),tu);else{var a=n.querySelector(s)??n.querySelector("option:not([disabled])");i=a&&tu(a)}t(i)}),Du(()=>{var o=e();if(C_(n,o,r),r&&o===void 0){var s=n.querySelector(":checked");s!==null&&(o=tu(s),t(o))}n.__value=o,r=!1}),H4(n)}function j4(n,e){for(var t of n.options)t.selected=~e.indexOf(tu(t))}function tu(n){return"__value"in n?n.__value:n.value}function q2(n,e){return n===e||(n==null?void 0:n[Hi])===e}function ts(n={},e,t,r){return Du(()=>{var o,s;return Kd(()=>{o=s,s=[],lt(()=>{n!==t(...s)&&(e(n,...s),o&&q2(t(...o),n)&&e(null,...o))})}),()=>{$p(()=>{s&&q2(t(...s),n)&&e(null,...s)})}}),n}function S_(n){return function(...e){var t=e[0];t.target===this&&(n==null||n.apply(this,e))}}function Av(n){return function(...e){var t=e[0];return t.preventDefault(),n==null?void 0:n.apply(this,e)}}function qr(n=!1){const e=tn,t=e.l.u;if(!t)return;let r=()=>zn(e.s);if(n){let o=0,s={};const i=kd(()=>{let a=!1;const A=e.s;for(const d in A)A[d]!==s[d]&&(s[d]=A[d],a=!0);return a&&o++,o});r=()=>l(i)}t.b.length&&a4(()=>{K2(e,r),l0(t.b)}),c0(()=>{const o=lt(()=>t.m.map(UC));return()=>{for(const s of o)typeof s=="function"&&s()}}),t.a.length&&c0(()=>{K2(e,r),l0(t.a)})}function K2(n,e){if(n.l.s)for(const t of n.l.s)l(t);e()}function E_(n,e,t){if(n==null)return e(void 0),bd;const r=lt(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const Rl=[];function vl(n,e=bd){let t=null;const r=new Set;function o(a){if(Nm(n,a)&&(n=a,t)){const A=!Rl.length;for(const d of r)d[1](),Rl.push(d,n);if(A){for(let d=0;d<Rl.length;d+=2)Rl[d][0](Rl[d+1]);Rl.length=0}}}function s(a){o(a(n))}function i(a,A=bd){const d=[a,A];return r.add(d),r.size===1&&(t=e(o,s)||bd),a(n),()=>{r.delete(d),r.size===0&&t&&(t(),t=null)}}return{set:o,update:s,subscribe:i}}function hn(n){let e;return E_(n,t=>e=t)(),e}let Eh=!1,w0=Symbol();function Xr(n,e,t){const r=t[e]??(t[e]={store:null,source:qp(void 0),unsubscribe:bd});if(r.store!==n&&!(w0 in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=bd;else{var o=!0;r.unsubscribe=E_(n,s=>{o?r.source.v=s:_(r.source,s)}),o=!1}return n&&w0 in t?hn(n):l(r.source)}function F_(n,e){return n.set(e),e}function uo(){const n={};function e(){qm(()=>{for(var t in n)n[t].unsubscribe();Mb(n,w0,{enumerable:!1,value:!0})})}return[n,e]}function Kt(n,e,t){return n.set(t),e}function R4(n){var e=Eh;try{return Eh=!1,[n(),Eh]}finally{Eh=e}}const q4={get(n,e){if(!n.exclude.includes(e))return l(n.version),e in n.special?n.special[e]():n.props[e]},set(n,e,t){return e in n.special||(n.special[e]=pt({get[e](){return n.props[e]}},e,Gb)),n.special[e](t),fa(n.version),!0},getOwnPropertyDescriptor(n,e){if(!n.exclude.includes(e)&&e in n.props)return{enumerable:!0,configurable:!0,value:n.props[e]}},deleteProperty(n,e){return n.exclude.includes(e)||(n.exclude.push(e),fa(n.version)),!0},has(n,e){return n.exclude.includes(e)?!1:e in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(e=>!n.exclude.includes(e))}};function nn(n,e){return new Proxy({props:n,exclude:e,special:{},version:Us(0)},q4)}const K4={get(n,e){let t=n.props.length;for(;t--;){let r=n.props[t];if(Qc(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(n,e,t){let r=n.props.length;for(;r--;){let o=n.props[r];Qc(o)&&(o=o());const s=ba(o,e);if(s&&s.set)return s.set(t),!0}return!1},getOwnPropertyDescriptor(n,e){let t=n.props.length;for(;t--;){let r=n.props[t];if(Qc(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=ba(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(n,e){if(e===Hi||e===Kb)return!1;for(let t of n.props)if(Qc(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(n){const e=[];for(let t of n.props){Qc(t)&&(t=t());for(const r in t)e.includes(r)||e.push(r)}return e}};function fn(...n){return new Proxy({props:n},K4)}function $2(n){for(var e=rn,t=rn;e!==null&&!(e.f&(Yi|Hd));)e=e.parent;try{return Vi(e),n()}finally{Vi(t)}}function pt(n,e,t,r){var $;var o=(t&WC)!==0,s=!jd||(t&XC)!==0,i=(t&YC)!==0,a=(t&JC)!==0,A=!1,d;i?[d,A]=R4(()=>n[e]):d=n[e];var c=Hi in n||Kb in n,u=i&&((($=ba(n,e))==null?void 0:$.set)??(c&&e in n&&(j=>n[e]=j)))||void 0,h=r,f=!0,g=!1,m=()=>(g=!0,f&&(f=!1,a?h=lt(r):h=r),h);d===void 0&&r!==void 0&&(u&&s&&MC(),d=m(),u&&u(d));var y;if(s)y=()=>{var j=n[e];return j===void 0?m():(f=!0,g=!1,j)};else{var b=$2(()=>(o?kd:it)(()=>n[e]));b.f|=Rb,y=()=>{var j=l(b);return j!==void 0&&(h=void 0),j===void 0?h:j}}if(!(t&Gb))return y;if(u){var S=n.$$legacy;return function(j,J){return arguments.length>0?((!s||!J||S||A)&&u(J?y():j),j):y()}}var F=!1,k=!1,P=qp(d),te=$2(()=>kd(()=>{var j=y(),J=l(P);return F?(F=!1,k=!0,J):(k=!1,P.v=j)}));return o||(te.equals=Mm),function(j,J){if(iA!==null&&(F=k,y(),l(P)),arguments.length>0){const we=J?l(te):s&&i?ld(j):j;return te.equals(we)||(F=!0,_(P,we),g&&h!==void 0&&(h=we),lt(()=>l(te))),j}return l(te)}}function En(n){tn===null&&Rp(),jd&&tn.l!==null?I_(tn).m.push(n):c0(()=>{const e=lt(n);if(typeof e=="function")return e})}function Eo(n){tn===null&&Rp(),En(()=>()=>lt(n))}function $4(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function Yp(){const n=tn;return n===null&&Rp(),(e,t,r)=>{var s;const o=(s=n.s.$$events)==null?void 0:s[e];if(o){const i=Hp(o)?o.slice():[o],a=$4(e,t,r);for(const A of i)A.call(n.x,a);return!a.defaultPrevented}return!0}}function V4(n){tn===null&&Rp(),tn.l===null&&NC(),I_(tn).a.push(n)}function I_(n){var e=n.l;return e.u??(e.u={a:[],b:[],m:[]})}const G4="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(G4);$C();const W4="modulepreload",X4=function(n){return"/"+n},V2={},cs=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(t.map(A=>{if(A=X4(A),A in V2)return;V2[A]=!0;const d=A.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${A}"]${c}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":W4,d||(u.as="script"),u.crossOrigin="",u.href=A,a&&u.setAttribute("nonce",a),document.head.appendChild(u),d)return new Promise((h,f)=>{u.addEventListener("load",h),u.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${A}`)))})}))}function s(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return o.then(i=>{for(const a of i||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},Y4=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>cs(async()=>{const{default:r}=await Promise.resolve().then(()=>Vd);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class Ym extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class J4 extends Ym{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Z4 extends Ym{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class eS extends Ym{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var y0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(y0||(y0={}));var tS=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class rS{constructor(e,{headers:t={},customFetch:r,region:o=y0.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=Y4(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return tS(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=t;let a={},{region:A}=t;A||(A=this.region),A&&A!=="any"&&(a["x-region"]=A);let d;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(a["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(a["Content-Type"]="application/json",d=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),o),body:d}).catch(g=>{throw new J4(g)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new Z4(c);if(!c.ok)throw new eS(c);let h=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),f;return h==="application/json"?f=yield c.json():h==="application/octet-stream"?f=yield c.blob():h==="text/event-stream"?f=c:h==="multipart/form-data"?f=yield c.formData():f=yield c.text(),{data:f,error:null}}catch(o){return{data:null,error:o}}})}}var zK=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function oS(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var go={},ql={},Kl={},$l={},Vl={},Gl={},sS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Od=sS();const iS=Od.fetch,U_=Od.fetch.bind(Od),Q_=Od.Headers,aS=Od.Request,AS=Od.Response,Vd=Object.freeze(Object.defineProperty({__proto__:null,Headers:Q_,Request:aS,Response:AS,default:U_,fetch:iS},Symbol.toStringTag,{value:"Module"})),lS=oS(Vd);var Fh={},G2;function T_(){if(G2)return Fh;G2=1,Object.defineProperty(Fh,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Fh.default=n,Fh}var W2;function L_(){if(W2)return Gl;W2=1;var n=Gl&&Gl.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Gl,"__esModule",{value:!0});const e=n(lS),t=n(T_());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=Object.assign({},this.headers),this.headers[s]=i,this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let A=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var c,u,h;let f=null,g=null,m=null,y=d.status,b=d.statusText;if(d.ok){if(this.method!=="HEAD"){const P=await d.text();P===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?g=P:g=JSON.parse(P))}const F=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),k=(u=d.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");F&&k&&k.length>1&&(m=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(g)&&(g.length>1?(f={code:"PGRST116",details:`Results contain ${g.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},g=null,m=null,y=406,b="Not Acceptable"):g.length===1?g=g[0]:g=null)}else{const F=await d.text();try{f=JSON.parse(F),Array.isArray(f)&&d.status===404&&(g=[],f=null,y=200,b="OK")}catch{d.status===404&&F===""?(y=204,b="No Content"):f={message:F}}if(f&&this.isMaybeSingle&&(!((h=f==null?void 0:f.details)===null||h===void 0)&&h.includes("0 rows"))&&(f=null,y=200,b="OK"),f&&this.shouldThrowOnError)throw new t.default(f)}return{error:f,data:g,count:m,status:y,statusText:b}});return this.shouldThrowOnError||(A=A.catch(d=>{var c,u,h;return{error:{message:`${(c=d==null?void 0:d.name)!==null&&c!==void 0?c:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(u=d==null?void 0:d.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=d==null?void 0:d.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),A.then(s,i)}}return Gl.default=r,Gl}var X2;function P_(){if(X2)return Vl;X2=1;var n=Vl&&Vl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Vl,"__esModule",{value:!0});const e=n(L_());class t extends e.default{select(o){let s=!1;const i=(o??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:s=!0,nullsFirst:i,foreignTable:a,referencedTable:A=a}={}){const d=A?`${A}.order`:"order",c=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${c?`${c},`:""}${o}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${o}`),this}range(o,s,{foreignTable:i,referencedTable:a=i}={}){const A=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(A,`${o}`),this.url.searchParams.set(d,`${s-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:s=!1,settings:i=!1,buffers:a=!1,wal:A=!1,format:d="text"}={}){var c;const u=[o?"analyze":null,s?"verbose":null,i?"settings":null,a?"buffers":null,A?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${h}"; options=${u};`,d==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Vl.default=t,Vl}var Y2;function Jm(){if(Y2)return $l;Y2=1;var n=$l&&$l.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty($l,"__esModule",{value:!0});const e=n(P_());class t extends e.default{eq(o,s){return this.url.searchParams.append(o,`eq.${s}`),this}neq(o,s){return this.url.searchParams.append(o,`neq.${s}`),this}gt(o,s){return this.url.searchParams.append(o,`gt.${s}`),this}gte(o,s){return this.url.searchParams.append(o,`gte.${s}`),this}lt(o,s){return this.url.searchParams.append(o,`lt.${s}`),this}lte(o,s){return this.url.searchParams.append(o,`lte.${s}`),this}like(o,s){return this.url.searchParams.append(o,`like.${s}`),this}likeAllOf(o,s){return this.url.searchParams.append(o,`like(all).{${s.join(",")}}`),this}likeAnyOf(o,s){return this.url.searchParams.append(o,`like(any).{${s.join(",")}}`),this}ilike(o,s){return this.url.searchParams.append(o,`ilike.${s}`),this}ilikeAllOf(o,s){return this.url.searchParams.append(o,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(o,s){return this.url.searchParams.append(o,`ilike(any).{${s.join(",")}}`),this}is(o,s){return this.url.searchParams.append(o,`is.${s}`),this}in(o,s){const i=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(o,`in.(${i})`),this}contains(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cs.{${s.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(s)}`),this}containedBy(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cd.{${s.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(s)}`),this}rangeGt(o,s){return this.url.searchParams.append(o,`sr.${s}`),this}rangeGte(o,s){return this.url.searchParams.append(o,`nxl.${s}`),this}rangeLt(o,s){return this.url.searchParams.append(o,`sl.${s}`),this}rangeLte(o,s){return this.url.searchParams.append(o,`nxr.${s}`),this}rangeAdjacent(o,s){return this.url.searchParams.append(o,`adj.${s}`),this}overlaps(o,s){return typeof s=="string"?this.url.searchParams.append(o,`ov.${s}`):this.url.searchParams.append(o,`ov.{${s.join(",")}}`),this}textSearch(o,s,{config:i,type:a}={}){let A="";a==="plain"?A="pl":a==="phrase"?A="ph":a==="websearch"&&(A="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(o,`${A}fts${d}.${s}`),this}match(o){return Object.entries(o).forEach(([s,i])=>{this.url.searchParams.append(s,`eq.${i}`)}),this}not(o,s,i){return this.url.searchParams.append(o,`not.${s}.${i}`),this}or(o,{foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${o})`),this}filter(o,s,i){return this.url.searchParams.append(o,`${s}.${i}`),this}}return $l.default=t,$l}var J2;function k_(){if(J2)return Kl;J2=1;var n=Kl&&Kl.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Kl,"__esModule",{value:!0});const e=n(Jm());class t{constructor(o,{headers:s={},schema:i,fetch:a}){this.url=o,this.headers=s,this.schema=i,this.fetch=a}select(o,{head:s=!1,count:i}={}){const a=s?"HEAD":"GET";let A=!1;const d=(o??"*").split("").map(c=>/\s/.test(c)&&!A?"":(c==='"'&&(A=!A),c)).join("");return this.url.searchParams.set("select",d),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:s,defaultToNull:i=!0}={}){const a="POST",A=[];if(this.headers.Prefer&&A.push(this.headers.Prefer),s&&A.push(`count=${s}`),i||A.push("missing=default"),this.headers.Prefer=A.join(","),Array.isArray(o)){const d=o.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(d.length>0){const c=[...new Set(d)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:s,ignoreDuplicates:i=!1,count:a,defaultToNull:A=!0}={}){const d="POST",c=[`resolution=${i?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),A||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(o)){const u=o.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(u.length>0){const h=[...new Set(u)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:s}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const s="DELETE",i=[];return o&&i.push(`count=${o}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Kl.default=t,Kl}var Tc={},Lc={},Z2;function dS(){return Z2||(Z2=1,Object.defineProperty(Lc,"__esModule",{value:!0}),Lc.version=void 0,Lc.version="0.0.0-automated"),Lc}var ew;function cS(){if(ew)return Tc;ew=1,Object.defineProperty(Tc,"__esModule",{value:!0}),Tc.DEFAULT_HEADERS=void 0;const n=dS();return Tc.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},Tc}var tw;function uS(){if(tw)return ql;tw=1;var n=ql&&ql.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(ql,"__esModule",{value:!0});const e=n(k_()),t=n(Jm()),r=cS();class o{constructor(i,{headers:a={},schema:A,fetch:d}={}){this.url=i,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),a),this.schemaName=A,this.fetch=d}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new o(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:A=!1,get:d=!1,count:c}={}){let u;const h=new URL(`${this.url}/rpc/${i}`);let f;A||d?(u=A?"HEAD":"GET",Object.entries(a).filter(([m,y])=>y!==void 0).map(([m,y])=>[m,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([m,y])=>{h.searchParams.append(m,y)})):(u="POST",f=a);const g=Object.assign({},this.headers);return c&&(g.Prefer=`count=${c}`),new t.default({method:u,url:h,headers:g,schema:this.schemaName,body:f,fetch:this.fetch,allowEmpty:!1})}}return ql.default=o,ql}var rw;function hS(){if(rw)return go;rw=1;var n=go&&go.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(go,"__esModule",{value:!0}),go.PostgrestError=go.PostgrestBuilder=go.PostgrestTransformBuilder=go.PostgrestFilterBuilder=go.PostgrestQueryBuilder=go.PostgrestClient=void 0;const e=n(uS());go.PostgrestClient=e.default;const t=n(k_());go.PostgrestQueryBuilder=t.default;const r=n(Jm());go.PostgrestFilterBuilder=r.default;const o=n(P_());go.PostgrestTransformBuilder=o.default;const s=n(L_());go.PostgrestBuilder=s.default;const i=n(T_());return go.PostgrestError=i.default,go.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:s.default,PostgrestError:i.default},go}var fS=hS();const pS=nS(fS),{PostgrestClient:gS,PostgrestQueryBuilder:CK,PostgrestFilterBuilder:SK,PostgrestTransformBuilder:EK,PostgrestBuilder:FK,PostgrestError:IK}=pS,vS="2.11.2",mS={"X-Client-Info":`realtime-js/${vS}`},wS="1.0.0",O_=1e4,yS=1e3;var xd;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(xd||(xd={}));var Is;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Is||(Is={}));var hi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(hi||(hi={}));var b0;(function(n){n.websocket="websocket"})(b0||(b0={}));var RA;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(RA||(RA={}));class bS{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=r.decode(e.slice(i,i+o));i=i+o;const A=r.decode(e.slice(i,i+s));i=i+s;const d=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:A,payload:d}}}class D_{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Bn;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Bn||(Bn={}));const nw=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,i)=>(s[i]=_S(i,n,e,o),s),{})},_S=(n,e,t,r)=>{const o=e.find(a=>a.name===n),s=o==null?void 0:o.type,i=t[n];return s&&!r.includes(s)?N_(s,i):_0(i)},N_=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return CS(e,t)}switch(n){case Bn.bool:return BS(e);case Bn.float4:case Bn.float8:case Bn.int2:case Bn.int4:case Bn.int8:case Bn.numeric:case Bn.oid:return xS(e);case Bn.json:case Bn.jsonb:return zS(e);case Bn.timestamp:return SS(e);case Bn.abstime:case Bn.date:case Bn.daterange:case Bn.int4range:case Bn.int8range:case Bn.money:case Bn.reltime:case Bn.text:case Bn.time:case Bn.timestamptz:case Bn.timetz:case Bn.tsrange:case Bn.tstzrange:return _0(e);default:return _0(e)}},_0=n=>n,BS=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},xS=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},zS=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},CS=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let s;const i=n.slice(1,t);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(a=>N_(e,a))}return n},SS=n=>typeof n=="string"?n.replace(" ","T"):n,M_=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class lv{constructor(e,t,r={},o=O_){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var ow;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(ow||(ow={}));class ru{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ru.syncState(this.state,o,s,i),this.pendingDiffs.forEach(A=>{this.state=ru.syncDiff(this.state,A,s,i)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=ru.syncDiff(this.state,o,s,i),a())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const s=this.cloneDeep(e),i=this.transformState(t),a={},A={};return this.map(s,(d,c)=>{i[d]||(A[d]=c)}),this.map(i,(d,c)=>{const u=s[d];if(u){const h=c.map(y=>y.presence_ref),f=u.map(y=>y.presence_ref),g=c.filter(y=>f.indexOf(y.presence_ref)<0),m=u.filter(y=>h.indexOf(y.presence_ref)<0);g.length>0&&(a[d]=g),m.length>0&&(A[d]=m)}else a[d]=c}),this.syncDiff(s,{joins:a,leaves:A},r,o)}static syncDiff(e,t,r,o){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(s,(a,A)=>{var d;const c=(d=e[a])!==null&&d!==void 0?d:[];if(e[a]=this.cloneDeep(A),c.length>0){const u=e[a].map(f=>f.presence_ref),h=c.filter(f=>u.indexOf(f.presence_ref)<0);e[a].unshift(...h)}r(a,c,A)}),this.map(i,(a,A)=>{let d=e[a];if(!d)return;const c=A.map(u=>u.presence_ref);d=d.filter(u=>c.indexOf(u.presence_ref)<0),e[a]=d,o(a,d,A),d.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var sw;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(sw||(sw={}));var iw;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(iw||(iw={}));var pa;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(pa||(pa={}));class Zm{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Is.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new lv(this,hi.join,this.params,this.timeout),this.rejoinTimer=new D_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Is.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Is.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Is.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Is.errored,this.rejoinTimer.scheduleTimeout())}),this._on(hi.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new ru(this),this.broadcastEndpointURL=M_(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:a}}=this.params;this._onError(c=>e==null?void 0:e(pa.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(pa.CLOSED));const A={},d={broadcast:s,presence:i,postgres_changes:(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&o!==void 0?o:[],private:a};this.socket.accessTokenValue&&(A.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},A)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var u;if(this.socket.setAuth(),c===void 0){e==null||e(pa.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,f=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,g=[];for(let m=0;m<f;m++){const y=h[m],{filter:{event:b,schema:S,table:F,filter:k}}=y,P=c&&c[m];if(P&&P.event===b&&P.schema===S&&P.table===F&&P.filter===k)g.push(Object.assign(Object.assign({},y),{id:P.id}));else{this.unsubscribe(),e==null||e(pa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e(pa.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(pa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(pa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,A={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,A,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=d.body)===null||o===void 0?void 0:o.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,a,A;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((A=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||A===void 0)&&A.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Is.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(hi.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const o=new lv(this,hi.leave,{},e);o.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),o.send(),this._canPush()||o.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const o=new AbortController,s=setTimeout(()=>o.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(s),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new lv(this,e,t,r);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,s;const i=e.toLocaleLowerCase(),{close:a,error:A,leave:d,join:c}=hi;if(r&&[a,A,d,c].indexOf(i)>=0&&r!==this._joinRef())return;let h=this._onMessage(i,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(f=>{var g,m,y;return((g=f.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(m=f.filter)===null||m===void 0?void 0:m.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(f=>f.callback(h,r)):(s=this.bindings[i])===null||s===void 0||s.filter(f=>{var g,m,y,b,S,F;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in f){const k=f.id,P=(g=f.filter)===null||g===void 0?void 0:g.event;return k&&((m=t.ids)===null||m===void 0?void 0:m.includes(k))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const k=(S=(b=f==null?void 0:f.filter)===null||b===void 0?void 0:b.event)===null||S===void 0?void 0:S.toLocaleLowerCase();return k==="*"||k===((F=t==null?void 0:t.event)===null||F===void 0?void 0:F.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===i}).map(f=>{if(typeof h=="object"&&"ids"in h){const g=h.data,{schema:m,table:y,commit_timestamp:b,type:S,errors:F}=g;h=Object.assign(Object.assign({},{schema:m,table:y,commit_timestamp:b,eventType:S,new:{},old:{},errors:F}),this._getPayloadRecords(g))}f.callback(h,r)})}_isClosed(){return this.state===Is.closed}_isJoined(){return this.state===Is.joined}_isJoining(){return this.state===Is.joining}_isLeaving(){return this.state===Is.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),s={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&Zm.isEqual(o.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(hi.close,{},e)}_onError(e){this._on(hi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Is.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=nw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=nw(e.columns,e.old_record)),t}}const ES=()=>{},FS=typeof WebSocket<"u",IS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class US{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=mS,this.params={},this.timeout=O_,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ES,this.conn=null,this.sendBuffer=[],this.serializer=new bS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>cs(async()=>{const{default:A}=await Promise.resolve().then(()=>Vd);return{default:A}},void 0).then(({default:A})=>A(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${b0.websocket}`,this.httpEndpoint=M_(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const o=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,i)=>i(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new D_(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(FS){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new QS(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),cs(async()=>{const{default:e}=await import("./browser.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:wS}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case xd.connecting:return RA.Connecting;case xd.open:return RA.Open;case xd.closing:return RA.Closing;default:return RA.Closed}}isConnected(){return this.connectionState()===RA.Open}channel(e,t={config:{}}){const r=new Zm(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:o,ref:s}=e,i=()=>{this.encode(e,a=>{var A;(A=this.conn)===null||A===void 0||A.send(a)})};this.log("push",`${t} ${r} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(o=>{t&&o.updateJoinPayload({access_token:t}),o.joinedOnce&&o._isJoined()&&o._push(hi.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(yS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:o,payload:s,ref:i}=t;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${o} ${i&&"("+i+")"||""}`,s),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(o,s,i)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(hi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([IS],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class QS{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=xd.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class e1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function mo(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class TS extends e1{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class B0 extends e1{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var LS=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const H_=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>cs(async()=>{const{default:r}=await Promise.resolve().then(()=>Vd);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},PS=()=>LS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield cs(()=>Promise.resolve().then(()=>Vd),void 0)).Response:Response}),x0=n=>{if(Array.isArray(n))return n.map(t=>x0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=x0(r)}),e};var ml=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const dv=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),kS=(n,e,t)=>ml(void 0,void 0,void 0,function*(){const r=yield PS();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(o=>{e(new TS(dv(o),n.status||500))}).catch(o=>{e(new B0(dv(o),o))}):e(new B0(dv(n),n))}),OS=(n,e,t,r)=>{const o={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(o.body=JSON.stringify(r)),Object.assign(Object.assign({},o),t))};function Nu(n,e,t,r,o,s){return ml(this,void 0,void 0,function*(){return new Promise((i,a)=>{n(t,OS(e,r,o,s)).then(A=>{if(!A.ok)throw A;return r!=null&&r.noResolveJson?A:A.json()}).then(A=>i(A)).catch(A=>kS(A,a,r))})})}function Ap(n,e,t,r){return ml(this,void 0,void 0,function*(){return Nu(n,"GET",e,t,r)})}function oA(n,e,t,r,o){return ml(this,void 0,void 0,function*(){return Nu(n,"POST",e,r,o,t)})}function DS(n,e,t,r,o){return ml(this,void 0,void 0,function*(){return Nu(n,"PUT",e,r,o,t)})}function NS(n,e,t,r){return ml(this,void 0,void 0,function*(){return Nu(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function j_(n,e,t,r,o){return ml(this,void 0,void 0,function*(){return Nu(n,"DELETE",e,r,o,t)})}var As=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const MS={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},aw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class HS{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=H_(o)}uploadOrUpdate(e,t,r,o){return As(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},aw),o);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const A=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),A&&s.append("metadata",this.encodeMetadata(A)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),A&&s.append("metadata",this.encodeMetadata(A))):(s=r,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,A&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(A)))),o!=null&&o.headers&&(a=Object.assign(Object.assign({},a),o.headers));const d=this._removeEmptyFolders(t),c=this._getFinalPath(d),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield u.json();return u.ok?{data:{path:d,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(mo(s))return{data:null,error:s};throw s}})}upload(e,t,r){return As(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return As(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let A;const d=Object.assign({upsert:aw.upsert},o),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(A=new FormData,A.append("cacheControl",d.cacheControl),A.append("",r)):typeof FormData<"u"&&r instanceof FormData?(A=r,A.append("cacheControl",d.cacheControl)):(A=r,c["cache-control"]=`max-age=${d.cacheControl}`,c["content-type"]=d.contentType);const u=yield this.fetch(a.toString(),{method:"PUT",body:A,headers:c}),h=yield u.json();return u.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(A){if(mo(A))return{data:null,error:A};throw A}})}createSignedUploadUrl(e,t){return As(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t!=null&&t.upsert&&(o["x-upsert"]="true");const s=yield oA(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),i=new URL(this.url+s.url),a=i.searchParams.get("token");if(!a)throw new e1("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(r){if(mo(r))return{data:null,error:r};throw r}})}update(e,t,r){return As(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return As(this,void 0,void 0,function*(){try{return{data:yield oA(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(mo(o))return{data:null,error:o};throw o}})}copy(e,t,r){return As(this,void 0,void 0,function*(){try{return{data:{path:(yield oA(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(mo(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return As(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield oA(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(mo(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return As(this,void 0,void 0,function*(){try{const o=yield oA(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(mo(o))return{data:null,error:o};throw o}})}download(e,t){return As(this,void 0,void 0,function*(){const o=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield Ap(this.fetch,`${this.url}/${o}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(mo(a))return{data:null,error:a};throw a}})}info(e){return As(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield Ap(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:x0(r),error:null}}catch(r){if(mo(r))return{data:null,error:r};throw r}})}exists(e){return As(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield NS(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(mo(r)&&r instanceof B0){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&o.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",A=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});A!==""&&o.push(A);let d=o.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${d}`)}}}remove(e){return As(this,void 0,void 0,function*(){try{return{data:yield j_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(mo(t))return{data:null,error:t};throw t}})}list(e,t,r){return As(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},MS),t),{prefix:e||""});return{data:yield oA(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(mo(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const jS="2.7.1",RS={"X-Client-Info":`storage-js/${jS}`};var Wl=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class qS{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},RS),t),this.fetch=H_(r)}listBuckets(){return Wl(this,void 0,void 0,function*(){try{return{data:yield Ap(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(mo(e))return{data:null,error:e};throw e}})}getBucket(e){return Wl(this,void 0,void 0,function*(){try{return{data:yield Ap(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(mo(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Wl(this,void 0,void 0,function*(){try{return{data:yield oA(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(mo(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Wl(this,void 0,void 0,function*(){try{return{data:yield DS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(mo(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Wl(this,void 0,void 0,function*(){try{return{data:yield oA(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(mo(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Wl(this,void 0,void 0,function*(){try{return{data:yield j_(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(mo(t))return{data:null,error:t};throw t}})}}class KS extends qS{constructor(e,t={},r){super(e,t,r)}from(e){return new HS(this.url,this.headers,e,this.fetch)}}const $S="2.48.1";let $c="";typeof Deno<"u"?$c="deno":typeof document<"u"?$c="web":typeof navigator<"u"&&navigator.product==="ReactNative"?$c="react-native":$c="node";const VS={"X-Client-Info":`supabase-js-${$c}/${$S}`},GS={headers:VS},WS={schema:"public"},XS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},YS={};var JS=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const ZS=n=>{let e;return n?e=n:typeof fetch>"u"?e=U_:e=fetch,(...t)=>e(...t)},e3=()=>typeof Headers>"u"?Q_:Headers,t3=(n,e,t)=>{const r=ZS(t),o=e3();return(s,i)=>JS(void 0,void 0,void 0,function*(){var a;const A=(a=yield e())!==null&&a!==void 0?a:n;let d=new o(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${A}`),r(s,Object.assign(Object.assign({},i),{headers:d}))})};var r3=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};function n3(n){return n.replace(/\/$/,"")}function o3(n,e){const{db:t,auth:r,realtime:o,global:s}=n,{db:i,auth:a,realtime:A,global:d}=e,c={db:Object.assign(Object.assign({},i),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},A),o),global:Object.assign(Object.assign({},d),s),accessToken:()=>r3(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const R_="2.67.3",s3="http://localhost:9999",i3="supabase.auth.token",a3={"X-Client-Info":`gotrue-js/${R_}`},Aw=10,z0="X-Supabase-Api-Version",q_={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function A3(n){return Math.round(Date.now()/1e3)+n}function l3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Pi=()=>typeof window<"u"&&typeof document<"u",NA={tested:!1,writable:!1},nu=()=>{if(!Pi())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(NA.tested)return NA.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),NA.tested=!0,NA.writable=!0}catch{NA.tested=!0,NA.writable=!1}return NA.writable};function d3(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const K_=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>cs(async()=>{const{default:r}=await Promise.resolve().then(()=>Vd);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},c3=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",$_=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Ih=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Uh=async(n,e)=>{await n.removeItem(e)};function u3(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,o,s,i,a,A,d,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)i=e.indexOf(n.charAt(c++)),a=e.indexOf(n.charAt(c++)),A=e.indexOf(n.charAt(c++)),d=e.indexOf(n.charAt(c++)),r=i<<2|a>>4,o=(a&15)<<4|A>>2,s=(A&3)<<6|d,t=t+String.fromCharCode(r),A!=64&&o!=0&&(t=t+String.fromCharCode(o)),d!=64&&s!=0&&(t=t+String.fromCharCode(s));return t}class Jp{constructor(){this.promise=new Jp.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}Jp.promiseConstructor=Promise;function lw(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(u3(r))}async function h3(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function f3(n,e){return new Promise((r,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await n(s);if(!e(s,null,i)){r(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function p3(n){return("0"+n.toString(16)).substr(-2)}function g3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let s=0;s<56;s++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,p3).join("")}async function v3(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}function m3(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function w3(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await v3(n);return m3(t)}async function Xl(n,e,t=!1){const r=g3();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await $_(n,`${e}-code-verifier`,o);const s=await w3(r);return[s,r===s?"plain":"s256"]}const y3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function b3(n){const e=n.headers.get(z0);if(!e||!e.match(y3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class t1 extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function Ur(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class _3 extends t1{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function B3(n){return Ur(n)&&n.name==="AuthApiError"}class V_ extends t1{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class wl extends t1{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class Za extends wl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function x3(n){return Ur(n)&&n.name==="AuthSessionMissingError"}class cv extends wl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Qh extends wl{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Th extends wl{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function z3(n){return Ur(n)&&n.name==="AuthImplicitGrantRedirectError"}class dw extends wl{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class C0 extends wl{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function uv(n){return Ur(n)&&n.name==="AuthRetryableFetchError"}class cw extends wl{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var C3=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const HA=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),S3=[502,503,504];async function uw(n){var e;if(!c3(n))throw new C0(HA(n),0);if(S3.includes(n.status))throw new C0(HA(n),n.status);let t;try{t=await n.json()}catch(s){throw new V_(HA(s),s)}let r;const o=b3(n);if(o&&o.getTime()>=q_["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new cw(HA(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new Za}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new cw(HA(t),n.status,t.weak_password.reasons);throw new _3(HA(t),n.status||500,r)}const E3=(n,e,t,r)=>{const o={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function Nr(n,e,t,r){var o;const s=Object.assign({},r==null?void 0:r.headers);s[z0]||(s[z0]=q_["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",A=await F3(n,e,t+a,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(A):{data:Object.assign({},A),error:null}}async function F3(n,e,t,r,o,s){const i=E3(e,r,o,s);let a;try{a=await n(t,Object.assign({},i))}catch(A){throw console.error(A),new C0(HA(A),0)}if(a.ok||await uw(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(A){await uw(A)}}function eA(n){var e;let t=null;T3(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=A3(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function hw(n){const e=eA(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function aA(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function I3(n){return{data:n,error:null}}function U3(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:s}=n,i=C3(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:s},A=Object.assign({},i);return{data:{properties:a,user:A},error:null}}function Q3(n){return n}function T3(n){return n.access_token&&n.refresh_token&&n.expires_in}var L3=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class P3{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=K_(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await Nr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ur(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await Nr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:aA})}catch(r){if(Ur(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=L3(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await Nr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:U3,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ur(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await Nr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:aA})}catch(t){if(Ur(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,s,i,a,A;try{const d={nextPage:null,lastPage:0,total:0},c=await Nr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(s=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:Q3});if(c.error)throw c.error;const u=await c.json(),h=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,f=(A=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&A!==void 0?A:[];return f.length>0&&(f.forEach(g=>{const m=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);d[`${y}Page`]=m}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if(Ur(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){try{return await Nr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:aA})}catch(t){if(Ur(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await Nr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:aA})}catch(r){if(Ur(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await Nr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:aA})}catch(r){if(Ur(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await Nr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if(Ur(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await Nr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ur(t))return{data:null,error:t};throw t}}}const k3={getItem:n=>nu()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{nu()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{nu()&&globalThis.localStorage.removeItem(n)}};function fw(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function O3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Yl={debug:!!(globalThis&&nu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class G_ extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class D3 extends G_{}async function N3(n,e,t){Yl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Yl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Yl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{Yl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw Yl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new D3(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Yl.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}O3();const M3={url:s3,storageKey:i3,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:a3,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Pc=30*1e3,pw=3;async function gw(n,e,t){return await t()}class wu{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=wu.nextInstanceID,wu.nextInstanceID+=1,this.instanceID>0&&Pi()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},M3),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new P3({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=K_(o.fetch),this.lock=o.lock||gw,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Pi()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=N3:this.lock=gw,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:nu()?this.storage=k3:(this.memoryStorage={},this.storage=fw(this.memoryStorage)):(this.memoryStorage={},this.storage=fw(this.memoryStorage)),Pi()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${R_}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=d3(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Pi()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),z3(s)){const A=(e=s.details)===null||e===void 0?void 0:e.code;if(A==="identity_already_exists"||A==="identity_not_found"||A==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:a}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ur(t)?{error:t}:{error:new V_("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const s=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:eA}),{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const A=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(s){if(Ur(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,o;try{let s;if("email"in e){const{email:c,password:u,options:h}=e;let f=null,g=null;this.flowType==="pkce"&&([f,g]=await Xl(this.storage,this.storageKey)),s=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:u,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:g},xform:eA})}else if("phone"in e){const{phone:c,password:u,options:h}=e;s=await Nr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(o=h==null?void 0:h.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:eA})}else throw new Qh("You must provide either an email or phone number and a password");const{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const A=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(s){if(Ur(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:i,options:a}=e;t=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hw})}else if("phone"in e){const{phone:s,password:i,options:a}=e;t=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:hw})}else throw new Qh("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new cv}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if(Ur(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await Ih(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:s,error:i}=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:eA});if(await Uh(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new cv}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if(Ur(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:s,nonce:i}=e,a=await Nr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:eA}),{data:A,error:d}=a;return d?{data:{user:null,session:null},error:d}:!A||!A.session||!A.user?{data:{user:null,session:null},error:new cv}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:A,error:d})}catch(t){if(Ur(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,s,i;try{if("email"in e){const{email:a,options:A}=e;let d=null,c=null;this.flowType==="pkce"&&([d,c]=await Xl(this.storage,this.storageKey));const{error:u}=await Nr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=A==null?void 0:A.data)!==null&&t!==void 0?t:{},create_user:(r=A==null?void 0:A.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken},code_challenge:d,code_challenge_method:c},redirectTo:A==null?void 0:A.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in e){const{phone:a,options:A}=e,{data:d,error:c}=await Nr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(o=A==null?void 0:A.data)!==null&&o!==void 0?o:{},create_user:(s=A==null?void 0:A.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken},channel:(i=A==null?void 0:A.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:c}}throw new Qh("You must provide either an email or phone number.")}catch(a){if(Ur(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let o,s;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:a}=await Nr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:eA});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const A=i.session,d=i.user;return A!=null&&A.access_token&&(await this._saveSession(A),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(o){if(Ur(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Xl(this.storage,this.storageKey)),await Nr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:I3})}catch(s){if(Ur(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new Za;const{error:o}=await Nr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if(Ur(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:s}=e,{error:i}=await Nr(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:o,options:s}=e,{data:i,error:a}=await Nr(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a}}throw new Qh("You must provide either an email or phone number and a type")}catch(t){if(Ur(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Ih(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(A,d,c)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(A,d,c))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await Nr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:aA}):await this._useSession(async t=>{var r,o,s;const{data:i,error:a}=t;if(a)throw a;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Za}:await Nr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:aA})})}catch(t){if(Ur(t))return x3(t)&&(await this._removeSession(),await Uh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:s}=r;if(s)throw s;if(!o.session)throw new Za;const i=o.session;let a=null,A=null;this.flowType==="pkce"&&e.email!=null&&([a,A]=await Xl(this.storage,this.storageKey));const{data:d,error:c}=await Nr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:A}),jwt:i.access_token,xform:aA});if(c)throw c;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if(Ur(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return lw(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Za;const t=Date.now()/1e3;let r=t,o=!0,s=null;const i=lw(e.access_token);if(i.exp&&(r=i.exp,o=r<=t),o){const{session:a,error:A}=await this._callRefreshToken(e.refresh_token);if(A)return{data:{user:null,session:null},error:A};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:A}=await this._getUser(e.access_token);if(A)throw A;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if(Ur(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:i,error:a}=t;if(a)throw a;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new Za;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if(Ur(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Pi())throw new Th("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Th(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new dw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Th("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new dw("No code detected.");const{data:S,error:F}=await this._exchangeCodeForSession(e.code);if(F)throw F;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:S.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:a,expires_at:A,token_type:d}=e;if(!s||!a||!i||!d)throw new Th("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(a);let h=c+u;A&&(h=parseInt(A));const f=h-c;f*1e3<=Pc&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${u}s`);const g=h-u;c-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,h,c):c-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,h,c);const{data:m,error:y}=await this._getUser(s);if(y)throw y;const b={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:u,expires_at:h,refresh_token:i,token_type:d,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:b,redirectType:e.type},error:null}}catch(r){if(Ur(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Ih(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:s}=t;if(s)return{error:s};const i=(r=o.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(B3(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Uh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=l3(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:s},error:i}=t;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Xl(this.storage,this.storageKey,!0));try{return await Nr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if(Ur(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if(Ur(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async s=>{var i,a,A,d,c;const{data:u,error:h}=s;if(h)throw h;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(A=e.options)===null||A===void 0?void 0:A.queryParams,skipBrowserRedirect:!0});return await Nr(this.fetch,"GET",f,{headers:this.headers,jwt:(c=(d=u.session)===null||d===void 0?void 0:d.access_token)!==null&&c!==void 0?c:void 0})});if(o)throw o;return Pi()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ur(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:s,error:i}=t;if(i)throw i;return await Nr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if(Ur(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await f3(async o=>(o>0&&await h3(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await Nr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:eA})),(o,s)=>{const i=200*Math.pow(2,o);return s&&uv(s)&&Date.now()+i-r<Pc})}catch(r){if(this._debug(t,"error",r),Ur(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Pi()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Ih(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const o=Math.round(Date.now()/1e3),s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<o+Aw;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${Aw}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),uv(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new Za;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new Jp;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new Za;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(o,"error",s),Ur(s)){const i={session:null,error:s};return uv(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(A){s.push(A)}});if(await Promise.all(i),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await $_(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Uh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Pi()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),Pc);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/Pc);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${Pc}ms, refresh threshold is ${pw} ticks`),o<=pw&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof G_)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Pi()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await Xl(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(a.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;return s?{data:null,error:s}:await Nr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ur(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:s,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:A,error:d}=await Nr(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((o=A==null?void 0:A.totp)===null||o===void 0)&&o.qr_code)&&(A.totp.qr_code=`data:image/svg+xml;utf-8,${A.totp.qr_code}`),{data:A,error:null})})}catch(t){if(Ur(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:a}=await Nr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(t){if(Ur(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;return s?{data:null,error:s}:await Nr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(Ur(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],o=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(o.access_token);let a=null;i.aal&&(a=i.aal);let A=a;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(A="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:A,currentAuthenticationMethods:c},error:null}}))}}wu.nextInstanceID=0;const H3=wu;class j3 extends H3{constructor(e){super(e)}}var R3=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class q3{constructor(e,t,r){var o,s,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=n3(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const A=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,d={db:WS,realtime:YS,auth:Object.assign(Object.assign({},XS),{storageKey:A}),global:GS},c=o3(r??{},d);this.storageKey=(o=c.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch),this.fetch=t3(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new gS(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new rS(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new KS(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return R3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:s,flowType:i,lock:a,debug:A},d,c){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new j3({url:this.authUrl,headers:Object.assign(Object.assign({},u),d),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:i,lock:a,debug:A,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new US(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const K3=(n,e,t)=>new q3(n,e,t),$3="https://mprzyonufqescpcpusno.supabase.co",V3="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1wcnp5b251ZnFlc2NwY3B1c25vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk3NjAwMzIsImV4cCI6MjA0NTMzNjAzMn0._EwKZZ9Yk-C6t96up66bvHDv_pLcE5HDD1TNpi2dWy4",ft=K3($3,V3);async function Mu(n,e){const{data:t,error:r}=await ft.from("products").select(`
            *,
            variants:product_variants(
                *,
                prices(*),
                option_values:product_variant_option_values(
                    option_value:product_option_values(
                        *,
                        option:product_options(*)
                    )
                )
            ),
            categories:categories(*),
            options:product_options(
                *,
                values:product_option_values(*)
            ),
            process:processes(*)
        `).eq("id",n).eq("shop",e).single();if(r)throw r;return t}async function mA(n){const{data:e,error:t}=await ft.from("product_variants").select(" *, prices(*)").eq("id",n).single();if(t)throw t;return e}async function W_(){const{data:n,error:e}=await ft.from("categories").select("*").order("name");if(e)throw e;const t=n||[],r=new Map,o=[];return t.forEach(s=>{r.set(s.id,{...s,children:[]})}),t.forEach(s=>{const i=r.get(s.id);if(i)if(s.parent_category_id){const a=r.get(s.parent_category_id);a&&(a.children=a.children||[],a.children.push(i))}else o.push(i)}),o}async function Pf(n,e,t=1,r=12,o,s=!1){const i=(t-1)*r,a=i+r-1;let A=ft.from("products").select(`
      *,
      variants:product_variants(
        *,
        prices(*)
      )
    `,{count:"exact"}).ilike("title",`%${n}%`).range(i,a).order("created_at",{ascending:!1});if(o==="godo"&&(A=A.not("godo_product","is",null)),s&&(A=A.not("process_id","is",null)),e){const{data:h}=await ft.from("product_categories").select("product_id").eq("category_id",e),f=(h==null?void 0:h.map(g=>g.product_id))||[];A=A.in("id",f)}const{data:d,error:c,count:u}=await A;if(c)throw c;return{products:d||[],total:u||0}}async function S0(n,e){if(!n||!e)return console.warn("getProductByMallInfo: mallType or mallProductNo is missing."),null;const{data:t,error:r}=await ft.from("products").select("*").eq("mall_type",n).eq("mall_product_id",e).maybeSingle();if(r)throw console.error("Error fetching product by mall info:",r),r;return t||console.log("Product not found for given mall info."),t}async function Hu(n){const{data:e,error:t}=await ft.from("product_addons").select("*").eq("product_id",n).order("created_at",{ascending:!0});if(t)throw console.error("Error fetching product addons:",t),t;if(!e||e.length===0)return[];const r=[];for(const o of e){const{data:s,error:i}=await ft.from("product_addon_items").select(`
        *,
        addon_product:products(
          *,
          variants:product_variants(
            *,
            prices(*)
          )
        )
      `).eq("addon_id",o.id);if(i){console.error("Error fetching addon items:",i);continue}r.push({...o,items:s||[]})}return r}const G3=Object.freeze(Object.defineProperty({__proto__:null,getCategories:W_,getProductAddons:Hu,getProductById:Mu,getProductByMallInfo:S0,getProductVariant:mA,searchProducts:Pf},Symbol.toStringTag,{value:"Module"}));function mi(n,e,t){if(!t||t.length===0)return{originalPrice:e,discountedPrice:e,discountAmount:0,hasDiscount:!1};const r=t.find(i=>n>=i.min_quantity&&n<=i.max_quantity);if(!r)return{originalPrice:e,discountedPrice:e,discountAmount:0,hasDiscount:!1};let o=e,s=0;if(r.type==="amount")r.direction==="minus"?(o=Math.max(0,e-r.value),s=e-o):(o=e+r.value,s=-r.value);else if(r.type==="percentage"){const i=r.value/100;r.direction==="minus"?(s=e*i,o=e-s):(s=-(e*i),o=e+Math.abs(s))}return{originalPrice:e,discountedPrice:o,discountAmount:s,discountInfo:r,hasDiscount:s!==0}}const W3={productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1};function X3(){const{subscribe:n,set:e,update:t}=vl(W3);return{subscribe:n,set:e,update:t,async loadIntegratedProductData(r,o){var i;const s=hn({subscribe:n});if((i=s.productDataCache[r])!=null&&i.isLoaded)return s.productDataCache[r];if(s.loadingProducts.has(r))return new Promise((a,A)=>{const d=setInterval(()=>{var u;const c=hn({subscribe:n});c.loadingProducts.has(r)||(clearInterval(d),(u=c.productDataCache[r])!=null&&u.isLoaded?a(c.productDataCache[r]):A(new Error("   ")))},100)});t(a=>({...a,loadingProducts:new Set([...a.loadingProducts,r]),isGlobalLoading:!0,productDataCache:{...a.productDataCache,[r]:{id:r,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!0}}}));try{const[a,A]=await Promise.all([Mu(r,o),Hu(r)]);if(!a)throw new Error("   ");const d={};A.forEach(u=>{u.items.forEach(h=>{h.addon_product.variants&&h.addon_product.variants.length>0&&(d[h.addon_product.id]={price:h.addon_product.variants[0].prices[0].amount,title:h.addon_product.title,variants:h.addon_product.variants,description:h.addon_product.description,thumbnail:h.addon_product.thumbnail})})});const c={id:r,product:a,addons:A,process:a.process,addonProductsMap:d,isLoaded:!0,isLoading:!1};return t(u=>{const h=new Set(u.loadingProducts);return h.delete(r),{...u,loadingProducts:h,isGlobalLoading:h.size>0,productDataCache:{...u.productDataCache,[r]:c}}}),c}catch(a){throw console.error("   :",a),t(A=>{const d=new Set(A.loadingProducts);return d.delete(r),{...A,loadingProducts:d,isGlobalLoading:d.size>0,productDataCache:{...A.productDataCache,[r]:{id:r,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!1,error:a instanceof Error?a.message:"   "}}}}),a}},async loadMultipleProductData(r,o){t(s=>({...s,isGlobalLoading:!0}));try{const s=r.map(a=>this.loadIntegratedProductData(a,o)),i=await Promise.all(s);return t(a=>({...a,isGlobalLoading:!1})),i}catch(s){throw t(i=>({...i,isGlobalLoading:!1})),s}},getProductData(r){return hn({subscribe:n}).productDataCache[r]||null},clearProductData(r){t(r?o=>{const s={...o.productDataCache};return delete s[r],{...o,productDataCache:s}}:o=>({...o,productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1}))},isProductLoading(r){return hn({subscribe:n}).loadingProducts.has(r)},isGlobalLoading(){return hn({subscribe:n}).isGlobalLoading},isCached(r){var s;return((s=hn({subscribe:n}).productDataCache[r])==null?void 0:s.isLoaded)===!0}}}const pd=X3(),Ls=vl(null);function Y3(){const n={},e={products:[],index:0,totalAmount:0,totalQuantity:0,totalProductAmount:0,totalPrintAmount:0,totalAddonAmount:0,totalAdditionalAmount:0,estimateName:"",organizationName:"",orderName:"",orderPhone:"",phone1:"010",phone2:"",phone3:"",postcode:"",address1:"",address2:"",prefDeliveryDate:"",estDeliveryDate:"",shippingMethod:"",comment:"",password:"",uploadMemo:"",discountAmount:0,originalAmount:0,finalAmount:0,discountDetails:null},{subscribe:t,set:r,update:o}=vl(e),s=i=>{const a=i.products.map(h=>{var J;let f=0,g={originalAmount:0,discountAmount:0,hasDiscount:!1,discountDetails:void 0};const m=(h.variants||[]).reduce((we,D)=>we+(D.quantity||0),0),y=(h.variants||[]).map(we=>{const D=we.quantity||0,N=we.prices[0].amount;if(D>0){if(we.isDiscountedPrice)return{originalAmount:N*D,discountedAmount:N*D,discountAmount:0,discountDetails:void 0,hasDiscount:!1};const Z=mi(m,N,h.product.quantity_discounts);return{originalAmount:N*D,discountedAmount:Z.discountedPrice*D,discountAmount:Z.discountAmount*D,discountDetails:Z.discountInfo,hasDiscount:Z.hasDiscount}}else return{originalAmount:N*D,discountedAmount:N*D,discountAmount:0,discountDetails:void 0,hasDiscount:!1}});f=y.reduce((we,D)=>we+D.discountedAmount,0);const b=y.some(we=>we.hasDiscount),S=(J=y.find(we=>we.hasDiscount))==null?void 0:J.discountDetails;g={originalAmount:y.reduce((we,D)=>we+D.originalAmount,0),discountAmount:y.reduce((we,D)=>we+D.discountAmount,0),hasDiscount:b,discountDetails:S};let F=0;const k=h.prints&&h.prints.length>0,P=h.simplePrints&&h.simplePrints.length>0,te=h.print_type==="simple"&&P||P&&!k;k&&!te&&(F=(h.prints||[]).reduce((we,D)=>we+(D.price||0),0));let $=0;if(h.addons&&Object.keys(h.addons).length>0){const we=h.quantity||0;$=Object.values(h.addons).reduce((D,N)=>{if(N.price!==void 0){const Z=N.quantity||1;return D+N.price*Z}if(h.addonProductsMap){const Z=h.addonProductsMap[N.productId];if(Z&&N.variantId){const se=Z.variants.find(ce=>ce.id===N.variantId);if(se&&se.prices&&se.prices.length>0)return D+se.prices[0].amount*we}}return D},0)}const j=f+F+$;return{...h,productAmount:f,printAmount:F,addonAmount:$,totalAmount:j,discountInfo:g}}),A=a.reduce((h,f)=>h+f.quantity,0),d=a.reduce((h,f)=>h+(f.productAmount||0),0),c=a.reduce((h,f)=>h+(f.printAmount||0),0),u=a.reduce((h,f)=>h+(f.addonAmount||0),0);return{products:a,totalQuantity:A,totalProductAmount:d,totalPrintAmount:c,totalAddonAmount:u,totalAmount:d+c+u+(i.totalAdditionalAmount||0)}};return{subscribe:t,set:r,update:o,async addProductWithIntegratedData(i,a){try{const A=await pd.loadIntegratedProductData(i,a),d={product:A.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:A.addonProductsMap,productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0};o(c=>({...c,products:[...c.products,d],index:c.products.length}))}catch(A){throw console.error("  :",A),A}},async preloadProductsForFixedMode(i,a){try{const d=(await pd.loadMultipleProductData(i,a)).map(c=>({product:c.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:c.addonProductsMap,productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0}));o(c=>({...c,products:d,index:0}))}catch(A){throw console.error("   :",A),A}},async refreshProductData(i,a){const d=hn({subscribe:t}).products[i];if(!d)throw new Error("   ");try{pd.clearProductData(d.product.id);const c=await pd.loadIntegratedProductData(d.product.id,a);o(u=>({...u,products:u.products.map((h,f)=>f===i?{...h,product:c.product,addonProductsMap:c.addonProductsMap,isLoaded:!0}:h)}))}catch(c){throw console.error("   :",c),c}},reset:()=>{r({products:[],index:0,totalAmount:0,totalQuantity:0,totalProductAmount:0,totalPrintAmount:0,totalAddonAmount:0,totalAdditionalAmount:0,estimateName:"",organizationName:"",orderName:"",orderPhone:"",phone1:"010",phone2:"",phone3:"",postcode:"",address1:"",address2:"",prefDeliveryDate:"",estDeliveryDate:"",shippingMethod:"",comment:"",password:"",uploadMemo:"",discountAmount:0,originalAmount:0,finalAmount:0,discountDetails:null})},calculatePrintPrice:async(i,a=!1)=>{const A=hn(Et),d=A.products[i];if(console.log({product:d}),d.prints&&d.prints.length>0)for(const c of d.prints){console.log({print:c});let u=0,h=0;if(c.colors&&c.template.templateProduct){const f=c.template.templateProduct.template_product_variants.find(g=>g.color_count===c.colors.length);if(console.log({selectedVariant:f}),f){if(n[f.variant_id])u=n[f.variant_id].prices[0].amount;else{const g=await mA(f.variant_id);g&&(n[f.variant_id]=g,u=g.prices[0].amount)}if(c.variant_id=f.variant_id,f.min_quantity<=d.quantity)if(h=u*d.quantity,c.template.templateProduct.product.quantity_discounts&&c.template.templateProduct.product.quantity_discounts.length>0){const g=mi(d.quantity,u,c.template.templateProduct.product.quantity_discounts);g.hasDiscount?(c.price=g.discountedPrice*d.quantity,c.discountInfo={originalPrice:h,discountAmount:h-g.discountedPrice*d.quantity,discountDetails:g.discountInfo,hasDiscount:!0}):(c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1})}else c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1};else c.price=f.plate_price,c.discountInfo={originalPrice:f.plate_price,discountAmount:0,hasDiscount:!1}}}else if(c.template.templateProduct){const f=c.template.templateProduct.template_product_variants[0];if(f){if(n[f.variant_id])u=n[f.variant_id].prices[0].amount;else{const g=await mA(f.variant_id);g&&(n[f.variant_id]=g,u=g.prices[0].amount)}if(c.variant_id=f.variant_id,f.min_quantity<=d.quantity)if(h=u*d.quantity,c.template.templateProduct.product.quantity_discounts&&c.template.templateProduct.product.quantity_discounts.length>0){const g=mi(d.quantity,u,c.template.templateProduct.product.quantity_discounts);g.hasDiscount?(c.price=g.discountedPrice*d.quantity,c.discountInfo={originalPrice:h,discountAmount:h-g.discountedPrice*d.quantity,discountDetails:g.discountInfo,hasDiscount:!0}):(c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1})}else c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1};else c.price=f.plate_price,c.discountInfo={originalPrice:f.plate_price,discountAmount:0,hasDiscount:!1}}}}if(!a){const c=s(A);r({...A,...c,totalAdditionalAmount:A.totalAdditionalAmount})}},updateTotalAmounts:()=>{o(i=>{const a=s(i);return{...i,...a,totalAdditionalAmount:i.totalAdditionalAmount}})},cancelPrint:(i,a)=>{o(A=>{var c;A.products[i].prints=(c=A.products[i].prints)==null?void 0:c.filter(u=>u.objectId!==a);const d=s(A);return{...A,...d,totalAdditionalAmount:A.totalAdditionalAmount}})},updateSimplePrint:(i,a,A)=>{o(d=>{d.products[i].prints||(d.products[i].prints=[]);const c=d.products[i].prints.findIndex(u=>u.objectId===a);return c>=0?d.products[i].prints[c]={...d.products[i].prints[c],...A}:d.products[i].prints.push(A),d})},saveSimplePrintState:(i,a)=>{console.log("Store: saveSimplePrintState ",{productIndex:i,selectedAreasCount:a.length,selectedAreas:a}),o(A=>A.products[i]?(A.products[i].simplePrintState=a,console.log("Store: saveSimplePrintState ",{productIndex:i,savedState:A.products[i].simplePrintState}),A):(console.warn("Store: saveSimplePrintState -   :",i),A))},getSimplePrintState:i=>{var d;const a=hn(Et),A=((d=a.products[i])==null?void 0:d.simplePrintState)||[];return console.log("Store: getSimplePrintState ",{productIndex:i,hasProduct:!!a.products[i],result:A,resultType:typeof A,resultLength:Array.isArray(A)?A.length:"not array"}),A}}}const Et=Y3();function J3(){const n={name:"",phone:"",address1:"",address2:"",postcode:""},{subscribe:e,set:t,update:r}=vl(n);return{subscribe:e,set:t,update:r,reset:()=>{console.log(" Customer Store "),t(n)}}}const sl=J3(),vr=n=>n.toLocaleString("ko-KR");/**
* @license lucide-svelte v0.475.0 - ISC
*
* ISC License
* 
* Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
* 
* Permission to use, copy, modify, and/or distribute this software for any
* purpose with or without fee is hereby granted, provided that the above
* copyright notice and this permission notice appear in all copies.
* 
* THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
* WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
* MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
* ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
* ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
* OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
* 
*/const Z3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var eE=Xp("<svg><!><!></svg>");function pn(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]),r=nn(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);Hr(e,!1);let o=pt(e,"name",8,void 0),s=pt(e,"color",8,"currentColor"),i=pt(e,"size",8,24),a=pt(e,"strokeWidth",8,2),A=pt(e,"absoluteStrokeWidth",8,!1),d=pt(e,"iconNode",24,()=>[]);const c=(...m)=>m.filter((y,b,S)=>!!y&&S.indexOf(y)===b).join(" ");qr();var u=eE();let h;var f=w(u);Jt(f,1,d,ar,(m,y)=>{let b=()=>l(y)[0],S=()=>l(y)[1];var F=Nt(),k=gt(F);O4(k,b,!0,(P,te)=>{let $;He(()=>$=j2(P,$,{...S()},void 0,P.namespaceURI===Xb,P.nodeName.includes("-")))}),T(m,F)});var g=z(f);dn(g,e,"default",{}),He((m,y)=>h=j2(u,h,{...Z3,...r,width:i(),height:i(),stroke:s(),"stroke-width":m,class:y},void 0,!0),[()=>A()?Number(a())*24/Number(i()):a(),()=>c("lucide-icon","lucide",o()?`lucide-${o()}`:"",t.class)],it),T(n,u),jr()}function Ga(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"asterisk"},()=>t,{iconNode:[["path",{d:"M12 6v12"}],["path",{d:"M17.196 9 6.804 15"}],["path",{d:"m6.804 9 10.392 6"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function vw(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"book-text"},()=>t,{iconNode:[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"}],["path",{d:"M8 11h8"}],["path",{d:"M8 7h6"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function tE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"bot"},()=>t,{iconNode:[["path",{d:"M12 8V4H8"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}],["path",{d:"M2 14h2"}],["path",{d:"M20 14h2"}],["path",{d:"M15 13v2"}],["path",{d:"M9 13v2"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function rE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"chevron-right"},()=>t,{iconNode:[["path",{d:"m9 18 6-6-6-6"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function r1(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"circle-check-big"},()=>t,{iconNode:[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function yu(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"circle-x"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function lp(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"clock"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function nE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"eye"},()=>t,{iconNode:[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function kf(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"file-text"},()=>t,{iconNode:[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function oE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"key"},()=>t,{iconNode:[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4"}],["path",{d:"m21 2-9.6 9.6"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function zd(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"loader-circle"},()=>t,{iconNode:[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function X_(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"lock"},()=>t,{iconNode:[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function sE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"mail"},()=>t,{iconNode:[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function iE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"message-square"},()=>t,{iconNode:[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function E0(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"package"},()=>t,{iconNode:[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z"}],["path",{d:"M12 22V12"}],["polyline",{points:"3.29 7 12 12 20.71 7"}],["path",{d:"m7.5 4.27 9 5.15"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function Y_(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"pencil"},()=>t,{iconNode:[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function bu(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"plus"},()=>t,{iconNode:[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function aE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"printer"},()=>t,{iconNode:[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function AE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"refresh-cw"},()=>t,{iconNode:[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function lE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"save"},()=>t,{iconNode:[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function J_(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"search"},()=>t,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["path",{d:"m21 21-4.3-4.3"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function dE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"send"},()=>t,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function cE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"shopping-bag"},()=>t,{iconNode:[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"}],["path",{d:"M3 6h18"}],["path",{d:"M16 10a4 4 0 0 1-8 0"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function uE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"shopping-cart"},()=>t,{iconNode:[["circle",{cx:"8",cy:"21",r:"1"}],["circle",{cx:"19",cy:"21",r:"1"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function n1(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"trash-2"},()=>t,{iconNode:[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function hE(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"user-cog"},()=>t,{iconNode:[["circle",{cx:"18",cy:"15",r:"3"}],["circle",{cx:"9",cy:"7",r:"4"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2"}],["path",{d:"m21.7 16.4-.9-.3"}],["path",{d:"m15.2 13.9-.9-.3"}],["path",{d:"m16.6 18.7.3-.9"}],["path",{d:"m19.1 12.2.3-.9"}],["path",{d:"m19.6 18.7-.4-1"}],["path",{d:"m16.8 12.3-.4-1"}],["path",{d:"m14.3 16.6 1-.4"}],["path",{d:"m20.7 13.8 1-.4"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function F0(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"user"},()=>t,{iconNode:[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}],["circle",{cx:"12",cy:"7",r:"4"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}function ju(n,e){const t=nn(e,["children","$$slots","$$events","$$legacy"]);pn(n,fn({name:"x"},()=>t,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(o,s)=>{var i=Nt(),a=gt(i);dn(a,e,"default",{}),T(o,i)},$$slots:{default:!0}}))}async function fE(n,e,t,r,o){let s=ft.from("estimates").select("*").eq("is_delete",!1).neq("status","temp").order("created_at",{ascending:!1});t&&(s=s.eq("shop_id",t)),e?s=s.eq("customer_id",e):n&&(s=s.eq("sess",n)),r&&(s=s.gte("created_at",`${r}T00:00:00`)),o&&(s=s.lte("created_at",`${o}T23:59:59`));const{data:i,error:a}=await s;if(a)throw a;return i||[]}async function o1(n,e,t){if(n&&e){const{data:r,error:o}=await ft.from("estimates").select("*").eq("status","temp").eq("mall_type",n).eq("customer_id",e).eq("is_delete",!1).order("created_at",{ascending:!1}).limit(1);if(o)throw o;if(r&&r.length>0)return r[0]}if(t){const{data:r,error:o}=await ft.from("estimates").select("*").eq("status","temp").eq("sess",t).eq("is_delete",!1).order("created_at",{ascending:!1}).limit(1);if(o)throw o;if(r&&r.length>0)return r[0]}return null}async function _u(n){const{data:e,error:t}=await ft.from("estimates").select("*").eq("id",n).eq("is_delete",!1).single();if(t)throw t;return e}function Bu(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),i=String(Math.floor(Math.random()*999)+1).padStart(3,"0");return`${e}${t}${r}${o}${s}${i}`}async function s1(n){const e={...n,estimate_no:Bu()},{data:t,error:r}=await ft.from("estimates").insert(e).select().single();if(r)throw r;return t}async function Dd(n,e){const{data:t,error:r}=await ft.from("estimates").select("estimate_no").eq("id",n).single();if(r)throw r;const o={...e};t!=null&&t.estimate_no||(o.estimate_no=Bu());const{error:s}=await ft.from("estimates").update(o).eq("id",n);if(s)throw s;const{data:i,error:a}=await ft.from("estimates").select("*").eq("id",n).single();if(a)throw a;if(!i)throw new Error("   .");return i}async function xu(n){const{data:e,error:t}=await ft.from("estimate_items").select(`
      *,
      product:products(*),
      variant:product_variants(id, title, thumbnail)
    `).eq("estimate_id",n);if(t)throw t;return(e||[]).map(r=>{var o;return{...r,variant_title:((o=r.variant)==null?void 0:o.title)||null}})}async function i1(n){const{data:e,error:t}=await ft.from("estimate_items").insert(n).select().single();if(t)throw t;return e}async function Z_(n){const{error:e}=await ft.from("estimate_items").delete().eq("id",n);if(e)throw e}async function Nd(n){const{data:e,error:t}=await ft.from("estimate_prints").select("*").eq("estimate_id",n);if(t)throw t;return e||[]}async function eB(n){const{data:e,error:t}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n);if(t)throw t;return e||[]}async function a1(n){const{data:e,error:t}=await ft.from("estimate_prints").insert(n).select().single();if(t)throw t;return e}async function tB(n){const{error:e}=await ft.from("estimate_prints").delete().eq("id",n);if(e)throw e}async function I0(n){const{data:e,error:t}=await ft.from("estimate_simple_prints").insert(n).select().single();if(t)throw t;return e}async function rB(n,e){const{data:t,error:r}=await ft.from("estimates").update({status:e}).eq("id",n).select().single();if(r)throw r;return t}function Zp(n,e){return ft.channel(`estimate-${n}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"estimates",filter:`id=eq.${n}`},t=>{e(t.new)}).subscribe()}function nB(n,e,t,r){const o=r?`estimate-list-${e}-${r}`:`estimate-list-${n}-${e}`;let s=`shop_id=eq.${e}`;return r?s=`customer_id=eq.${r}`:n&&(s=`sess=eq.${n}`),ft.channel(o).on("postgres_changes",{event:"*",schema:"public",table:"estimates",filter:s},i=>{t({...i,eventType:i.eventType})}).subscribe()}function Cd(n){return n===void 0||n==="temp"||n==="pending"}async function A1(n){try{const e=_u(n),t=xu(n),r=Nd(n),[o,s,i]=await Promise.all([e,t,r]);return{estimate:o,items:s||[],prints:i||[]}}catch(e){throw e}}async function oB(n){const{data:e,error:t}=await ft.from("estimate_comments").select("*").eq("estimate_id",n).order("created_at",{ascending:!0});if(t)throw t;return e||[]}async function Of(n){const{data:e,error:t}=await ft.from("estimate_comments").insert(n).select().single();if(t)throw t;return e}function l1(n,e){return ft.channel(`estimate-comments-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_comments",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{})}async function sB(){var n,e;try{const t=document.getElementById("odiz-customer-id"),r=document.getElementById("odiz-sess"),o=(n=t==null?void 0:t.value)==null?void 0:n.trim(),s=(e=r==null?void 0:r.value)==null?void 0:e.trim();if(!o||!s)return 0;const{data:i,error:a}=await ft.from("estimates").select("id").eq("sess",s).is("customer_id",null);if(a)throw a;if(!i||i.length===0)return 0;const{data:A,error:d}=await ft.from("estimates").update({customer_id:o}).eq("sess",s).is("customer_id",null).select();if(d)throw d;return(A==null?void 0:A.length)||0}catch{return 0}}function d1(n,e){return ft.channel(`estimate-prints-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_prints",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{})}function iB(n,e){return ft.channel(`estimate-items-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_items",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateItems  :",r)})}function aB(n,e){return ft.channel(`estimate-simple-prints-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_simple_prints",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateSimplePrints  :",r)})}function AB(n,e){return ft.channel(`estimate-addon-items-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_addon_items",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateAddonItems  :",r)})}function lB(n,e){return ft.channel(`estimate-additional-costs-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_additional_costs",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateAdditionalCosts  :",r)})}async function dB(n,e,t,r,o){const s=t?t.replace(/[\s\-\(\)\.]/g,""):"";let i=ft.from("estimates").select("*").eq("shop_id",n).or("customer_id.is.null,customer_id.eq.").neq("status","temp").order("created_at",{ascending:!1});e&&(i=i.ilike("order_name",`%${e}%`)),s&&(i=i.filter("order_phone","ilike",`%${s}%`)),o&&(i=i.eq("mall_type",o));const{data:a,error:A}=await i;if(A)throw A;return a||[]}async function cB(n){try{const{data:e,error:t}=await ft.from("estimate_items").select(`
        *,
        product:products(*)
      `).eq("estimate_id",n).order("idx");if(t)throw t;const{data:r,error:o}=await ft.from("estimate_prints").select("*").eq("estimate_id",n).order("idx");if(o)throw o;const s={};return(e||[]).forEach(i=>{const a=i.idx||0;s[a]||(s[a]={idx:a,product:i.product,items:[],prints:[]}),s[a].items.push(i)}),(r||[]).forEach(i=>{const a=i.idx||0;s[a]||(s[a]={idx:a,items:[],prints:[]}),s[a].prints.push(i)}),Object.values(s)}catch(e){throw e}}async function eg(n){const{data:e,error:t}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n).order("idx");if(t)throw t;return e||[]}async function uB(n){const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("id",n).single();if(t)throw t;return e||null}async function c1(n){const e={...n,selected_variant_id:n.selected_variant_id&&n.selected_variant_id.trim()!==""?n.selected_variant_id:null},{data:t,error:r}=await ft.from("estimate_addon_items").insert(e).select().single();if(r)throw r;return t}async function hB(n,e){const{error:t}=await ft.from("estimate_addon_items").delete().eq("estimate_id",n).eq("idx",e);if(t)throw t}async function u1(n){const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n).order("created_at",{ascending:!0});if(t)throw t;return e||[]}async function fB(n){try{const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n).order("created_at");if(t)throw t;return(e||[]).map((o,s)=>({id:o.id,product:{name:o.name,title:o.name,mall_type:o.mall_type||null,mall_product_id:o.mall_product_id||null},items:[{estimate_id:n,quantity:1,price:o.amount}],additionalCosts:[o],isAdditionalCost:!0}))}catch(e){throw e}}async function pB(n){const{data:e,error:t}=await ft.from("estimate_items").select("idx").eq("estimate_id",n).order("idx",{ascending:!1}).limit(1).single();return t||!e?-1:e.idx}async function gB(n,e,t,r){try{const o=await o1(e,t,r);let s,i,a=!1,A=0;if(o&&o.id)s=o.id,i=o.estimate_no||Bu(),await Dd(s,{...n.estimate,estimate_no:i}),A=await pB(s)+1;else{const g={...n.estimate,estimate_no:Bu(),status:"temp"},{data:m,error:y}=await ft.from("estimates").insert(g).select().single();if(y)throw new Error(`  : ${y.message}`);s=m.id,i=m.estimate_no,a=!0}let d=0;if(n.estimate_items&&n.estimate_items.length>0){const g=n.estimate_items.map(b=>({...b,estimate_id:s,idx:A})),{data:m,error:y}=await ft.from("estimate_items").insert(g).select();if(y)throw new Error(`   : ${y.message}`);d=(m==null?void 0:m.length)||0}let c=0;if(n.estimate_simple_prints&&n.estimate_simple_prints.length>0){const g=n.estimate_simple_prints.map(b=>({...b,estimate_id:s,idx:a?b.idx||0:A})),{data:m,error:y}=await ft.from("estimate_simple_prints").insert(g).select();if(y)throw new Error(`   : ${y.message}`);c=(m==null?void 0:m.length)||0}let u=0;if(n.estimate_prints&&n.estimate_prints.length>0){const g=n.estimate_prints.map(b=>({...b,estimate_id:s,idx:a?b.idx||0:A})),{data:m,error:y}=await ft.from("estimate_prints").insert(g).select();if(y)throw new Error(`    : ${y.message}`);if(u=(m==null?void 0:m.length)||0,u>0){const{error:b}=await ft.from("estimate_items").update({print_type:"detailed"}).eq("estimate_id",s).eq("idx",A)}}let h=0;if(n.estimate_addon_items&&n.estimate_addon_items.length>0){const g=n.estimate_addon_items.map(b=>({...b,estimate_id:s,idx:a?b.idx||0:A,selected_variant_id:b.selected_variant_id&&b.selected_variant_id.trim()!==""?b.selected_variant_id:null})),{data:m,error:y}=await ft.from("estimate_addon_items").insert(g).select();if(y)throw new Error(`   : ${y.message}`);h=(m==null?void 0:m.length)||0}const f={success:!0,estimateId:s,details:{estimateCount:a?1:0,itemsCount:d,simplePrintsCount:c,detailedPrintsCount:u,addonItemsCount:h}};return await h1(s),f}catch(o){return{success:!1,error:o instanceof Error?o.message:"    ."}}}async function U0(n,e){try{const{error:t}=await ft.from("estimate_items").delete().eq("estimate_id",n).eq("idx",e);if(t)throw t;const{error:r}=await ft.from("estimate_prints").delete().eq("estimate_id",n).eq("idx",e);if(r)throw r;const{error:o}=await ft.from("estimate_simple_prints").delete().eq("estimate_id",n).eq("idx",e);if(o)throw o;const{error:s}=await ft.from("estimate_addon_items").delete().eq("estimate_id",n).eq("idx",e);if(s)throw s}catch(t){throw t}}async function vB(n,e){try{const{data:t,error:r}=await ft.from("estimate_items").select(`
        *,
        product:products(
          *,
          options:product_options(
            *,
            values:product_option_values(*)
          ),
          variants:product_variants(*)
        )
      `).eq("estimate_id",n).eq("idx",e);if(r)throw r;if(t&&t.length>0)for(const h of t)if(h.variant_id)try{const{data:f,error:g}=await ft.from("product_variants").select("*").eq("id",h.variant_id).single();if(g)h.variant=null;else{h.variant=f;try{const{data:m,error:y}=await ft.from("prices").select("*").eq("variant_id",h.variant_id);y?h.variant.prices=[]:h.variant.prices=m||[]}catch{h.variant.prices=[]}try{const{data:m,error:y}=await ft.from("product_variant_option_values").select("option_value_id").eq("variant_id",h.variant_id);if(y||!m||m.length===0)h.variant.option_values=[];else{const b=m.map(F=>F.option_value_id).filter(Boolean),S=[];for(const F of b)try{const{data:k,error:P}=await ft.from("product_option_values").select("id, value, option_id").eq("id",F).single();if(P||!k)continue;let te=null;if(k.option_id){const{data:$,error:j}=await ft.from("product_options").select("*").eq("id",k.option_id).single();!j&&$&&(te={id:$.id,name:$.title})}S.push({option_value:{id:k.id,value:k.value,option_id:k.option_id,option:te}})}catch{}h.variant.option_values=S}}catch{h.variant.option_values=[]}}}catch{h.variant=null}else h.variant=null;const{data:o,error:s}=await ft.from("estimate_prints").select("*").eq("estimate_id",n).eq("idx",e);if(s)throw s;if(o&&o.length>0){const{getParentTemplates:h}=await cs(async()=>{const{getParentTemplates:f}=await Promise.resolve().then(()=>yE);return{getParentTemplates:f}},void 0);for(const f of o)if(f.template_id)try{const g=await h(f.template_id);f.parentTemplates=g}catch{f.parentTemplates=[]}else f.parentTemplates=[]}const{data:i,error:a}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n).eq("idx",e);if(a)throw a;const{data:A,error:d}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n).eq("idx",e);if(d)throw d;const c=t&&t.length>0?t[0].product_id:null;let u=[];if(c)try{const{getProductAddons:h}=await cs(async()=>{const{getProductAddons:f}=await Promise.resolve().then(()=>G3);return{getProductAddons:f}},void 0);u=await h(c)}catch{u=[]}return{items:t||[],prints:o||[],simplePrints:i||[],addonItems:A||[],addons:u||[]}}catch(t){throw t}}function mB(n){const e={};return n.forEach((t,r)=>{if(!t.variant)return;const o=t.variant;let s="";if(o.option_values&&Array.isArray(o.option_values)&&o.option_values.length>0)try{const a=o.option_values.find(A=>{var c;if(!A||!A.option_value)return!1;const d=(c=A.option_value.option)==null?void 0:c.name;return d===""||d===""||d==="color"||d==="Color"});a&&a.option_value&&(s=a.option_value.value||"")}catch{}if(!s&&o.title){const a=o.title.split("/").map(A=>A.trim());a.length>0&&(s=a[0])}s||(s=""),e[s]||(e[s]=[]),e[s].some(a=>a.id===o.id)||e[s].push({id:o.id,title:o.title,thumbnail:o.thumbnail,product_id:o.product_id,prices:t.variant.prices||[],option_values:o.option_values||[]})}),e}function wB(n,e){var y,b,S;if(!n.items||n.items.length===0)throw new Error("estimate_items  ");const t=(y=n.items[0])==null?void 0:y.product_id;if(!t)throw new Error("Product ID   ");let r;r=mB(n.items),Object.keys(r).length;const o={},s={},i=new Set;let a=0;n.items.forEach((F,k)=>{const P=F.variant_id,te=F.quantity||0;a+=te;let $="";for(const[j,J]of Object.entries(r))if(J.some(we=>we.id===P)){$=j,i.add(j);break}$&&(o[$]||(o[$]={}),o[$][P]=te),(F.discount_amount>0||F.discount_value>0)&&(s[P]={hasDiscount:!0,discountedPrice:F.price,discountAmount:F.discount_amount,discountInfo:{type:F.discount_type,value:F.discount_value,direction:F.discount_direction,min_quantity:F.discount_min_quantity,max_quantity:F.discount_max_quantity}})});const A={productId:t,product:(b=n.items[0])==null?void 0:b.product,addons:n.addons||[],addonItems:n.addonItems||[],selectedColors:Array.from(i),quantityByVariant:o,variantsByColor:r,variantDiscounts:s,totalQuantity:a,isCompleted:!0,lastUpdated:Date.now()},d=(n.simplePrints||[]).map(F=>({objectId:F.object_id,title:F.title,printMethod:F.print_method,uploadedFiles:F.uploaded_files,savedFileInfo:F.file_metadata,price:F.price})),c=n.prints.map((F,k)=>({template:{id:F.template_id},template_id:F.template_id,variant_id:F.variant_id,colors:F.colors,uploads:F.uploads,nameSheet:F.name_sheet,name_sheet:F.name_sheet,objectId:F.object_id,object_id:F.object_id,price:F.price,original_price:F.original_price,discount_amount:F.discount_amount,discount_type:F.discount_type,discount_value:F.discount_value,discount_direction:F.discount_direction,discount_min_quantity:F.discount_min_quantity,discount_max_quantity:F.discount_max_quantity,parentTemplates:F.parentTemplates||[],discountInfo:{originalPrice:F.original_price,discountAmount:F.discount_amount,discountDetails:{type:F.discount_type,value:F.discount_value,direction:F.discount_direction,min_quantity:F.discount_min_quantity,max_quantity:F.discount_max_quantity}}})),u={};n.addonItems.forEach(F=>{u[F.addon_id]={productId:F.selected_product_id,variantId:F.selected_variant_id}});const h={productId:t,selectedAddons:u,isCompleted:!0,lastUpdated:Date.now()};let f="none";const g=(S=n.items[0])==null?void 0:S.print_type;g&&["simple","detailed","self-design","none"].includes(g)?f=g:(f="selection",(d.length>0||c.length>0)&&console.warn("    print_type .    ."));const m={productId:t,currentMethod:f,isCompleted:!0,lastUpdated:Date.now()};return{productId:t,fixedEstimateData:{productId:t,productSelection:A,printSelection:m,addonSelection:h,additionalInfo:null,currentStep:"product",isDebugMode:!0,sessionId:Date.now().toString(36)+Math.random().toString(36).substr(2)},sessionStorageData:{fixedEstimateKey:`fixedEstimate_${t}`,simplePrintKey:`simplePrint_${t}`,detailedPrintKey:`detailedPrint_${t}`,printMethod:f,simplePrintState:d,detailedPrintState:c}}}async function yB(n){const{data:e,error:t}=await ft.from("estimate_items").select("quantity, price, print_type").eq("estimate_id",n);if(t)throw t;let r=0,o=0,s=!1;(e||[]).forEach(g=>{const m=g.quantity||0,y=g.price||0;r+=m*y,o+=m,g.print_type==="detailed"&&(s=!0)});let i=0;if(s){const{data:g,error:m}=await ft.from("estimate_prints").select("price").eq("estimate_id",n);if(m)throw m;i=(g||[]).reduce((y,b)=>y+(b.price||0),0)}const{data:a,error:A}=await ft.from("estimate_addon_items").select("price, quantity").eq("estimate_id",n);if(A)throw A;let d=0;(a||[]).forEach(g=>{const m=g.price||0,y=g.quantity||1;d+=m*y});const{data:c,error:u}=await ft.from("estimate_additional_costs").select("amount").eq("estimate_id",n);if(u)throw u;const h=(c||[]).reduce((g,m)=>g+(m.amount||0),0),f=r+i+d+h;return{product_amount:r,print_amount:i,addon_amount:d,additional_amount:h,total_quantity:o,total_amount:f}}async function h1(n){const e=await yB(n),{error:t}=await ft.from("estimates").update(e).eq("id",n);if(t)throw new Error(`Failed to update estimate summary: ${t.message}`)}async function bB(n,e,t,r,o){try{const s=await _u(n);if(!s)throw new Error("    ");const i=new Date().toISOString(),a=Bu(),A={shop_id:s.shop_id||e,name:s.name,organization_name:s.organization_name,order_name:s.order_name,order_phone:s.order_phone,postcode:s.postcode,address1:s.address1,address2:s.address2,comment:s.comment,shipping_method:s.shipping_method,pref_delivery_date:s.pref_delivery_date,upload_memo:s.upload_memo,product_amount:s.product_amount,print_amount:s.print_amount,addon_amount:s.addon_amount,additional_amount:s.additional_amount,total_quantity:s.total_quantity,total_amount:s.total_amount,delivery_fee:s.delivery_fee,memo:s.memo,use_reorder:s.use_reorder,sess:t||null,customer_id:r||null,mall_type:o||s.mall_type,estimate_no:a,status:"temp",design_confirm:"none",source_estimate_id:n,is_delete:!1,created_at:i,updated_at:i},{data:d,error:c}=await ft.from("estimates").insert(A).select().single();if(c)throw new Error(`  : ${c.message}`);const u=d.id;return await pE(n,u),await gE(n,u),await vE(n,u),await mE(n,u),await wE(n,u),console.log(`[copyEstimateForUser]   : ${n}  ${u}`),{success:!0,newEstimateId:u,newEstimateNo:a}}catch(s){return console.error("[copyEstimateForUser] :",s),{success:!1,newEstimateId:null,newEstimateNo:null,error:s instanceof Error?s.message:"    ."}}}async function pE(n,e){const{data:t,error:r}=await ft.from("estimate_items").select("*").eq("estimate_id",n);if(r)throw new Error(`   : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_items").insert(s);if(i)throw new Error(`   : ${i.message}`)}}async function gE(n,e){const{data:t,error:r}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_simple_prints").insert(s);if(i)throw new Error(`    : ${i.message}`)}}async function vE(n,e){const{data:t,error:r}=await ft.from("estimate_prints").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_prints").insert(s);if(i)throw new Error(`    : ${i.message}`)}}async function mE(n,e){const{data:t,error:r}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n);if(r)throw new Error(`   : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_addon_items").insert(s);if(i)throw new Error(`   : ${i.message}`)}}async function wE(n,e){const{data:t,error:r}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_additional_costs").insert(s);if(i)throw new Error(`    : ${i.message}`)}}function _B(n){return n?!n.sess&&!n.customer_id:!1}const hv=Object.freeze(Object.defineProperty({__proto__:null,addEstimateAddonItem:c1,addEstimateComment:Of,addEstimateItem:i1,addEstimatePrint:a1,addEstimateSimplePrint:I0,buildVariantsByColorFromDB:mB,calculateEstimateSummary:yB,canEditEstimate:Cd,convertDBDataToSessionStorage:wB,copyEstimateForUser:bB,createEstimate:s1,deleteEstimateAddonItemsByIdx:hB,deleteEstimateItem:Z_,deleteEstimatePrint:tB,deleteEstimateProductByIdx:U0,getAdditionalItems:fB,getEstimateAdditionalCost:uB,getEstimateAdditionalCosts:u1,getEstimateAddonItems:eg,getEstimateById:_u,getEstimateComments:oB,getEstimateItems:xu,getEstimateItemsGroupedByIdx:cB,getEstimatePrints:Nd,getEstimateSimplePrints:eB,getEstimatesWithDateFilter:fE,getFullEstimateDetails:A1,getGuestEstimates:dB,getMaxEstimateItemIdx:pB,getTempEstimate:o1,isAdminCreatedEstimate:_B,loadEstimateItemDataByIdx:vB,migrateSessionEstimatesToCustomer:sB,saveCompleteEstimateData:gB,subscribeToEstimateAdditionalCostsChanges:lB,subscribeToEstimateAddonItemsChanges:AB,subscribeToEstimateChanges:Zp,subscribeToEstimateCommentChanges:l1,subscribeToEstimateItemsChanges:iB,subscribeToEstimateListChanges:nB,subscribeToEstimatePrintChanges:d1,subscribeToEstimateSimplePrintsChanges:aB,updateEstimate:Dd,updateEstimateStatus:rB,updateEstimateSummary:h1},Symbol.toStringTag,{value:"Module"}));async function BB(n){const{data:e,error:t}=await ft.from("templates").select("*").eq("id",n).single();if(t)throw t;return e}async function xB(n){const{data:e,error:t}=await ft.from("templates").select("*").eq("parent_id",n).order("sort");if(t)throw t;return e||[]}async function dp(n){const{data:e,error:t}=await ft.from("process_print_areas").select(`
            id,
            title,
            process_print_area_templates!inner (
                id,
                print_area_id,
                template_id,
                group_cd,
                created_at,
                updated_at,
                template:templates (*)
            )
        `).eq("object_id",n).single();if(t)throw t;return e}async function Ru(n){const e=[],{data:t,error:r}=await ft.from("templates").select(" * ").eq("id",n).single();if(r)return console.error("   :",r),e;if(!t)return e;e.push(t);let o=t.parent_id;for(;o;){const{data:s,error:i}=await ft.from("templates").select(" * ").eq("id",o).single();if(i){console.error("   :",i);break}if(!s)break;e.push(s),o=s.parent_id}return e.reverse()}async function Gd(n){const{data:e,error:t}=await ft.from("template_products").select(`
            *,
            product:products (*),
            template_product_variants (
                id,
                variant_id,
                color_count,
                min_quantity,
                plate_price
            )
        `).eq("template_id",n).single();if(t)throw t;return e}async function f1(n){const{data:e,error:t}=await ft.from("process_print_areas").select("*").eq("object_id",n).single();return t?(console.error("  :",t),null):e}const yE=Object.freeze(Object.defineProperty({__proto__:null,getChildTemplates:xB,getParentTemplates:Ru,getPrintAreaByObjectId:f1,getTemplate:BB,getTemplateProduct:Gd,getTemplatesByObjectId:dp},Symbol.toStringTag,{value:"Module"}));var bE=ee('<div class="odz-gap-2 odz-mt-3 odz-flex odz-flex-col"><button class="odz-btn odz-btn-sm odz-btn-secondary"></button> <button class="odz-btn odz-btn-sm odz-btn-primary"></button></div>'),_E=ee('<img class="odz-w-8 odz-h-8 odz-object-cover odz-rounded">'),BE=ee('<div class="odz-flex odz-items-center odz-gap-2 odz-border odz-rounded-lg odz-p-2"><!> <div class="odz-text-xs"><span> </span> <span class="odz-ml-2 odz-font-semibold"> </span></div></div>'),xE=ee('<div class="odz-flex odz-items-center odz-gap-2 odz-text-sm"><span class="odz-text-gray-600 odz-font-bold"> </span> <span class="odz-text-xs"> </span></div>'),zE=ee('<div class="odz-mt-3"></div>'),CE=ee('<span class="odz-text-gray-600"> </span> <span class="odz-text-primary odz-font-semibold odz-ml-auto"> </span>',1),SE=ee('<div class="odz-flex odz-items-center odz-gap-2 odz-text-xs odz-bg-gray-50 odz-p-2 odz-rounded odz-mb-1"><span class="odz-font-medium"> </span> <!></div>'),EE=ee('<div class="odz-mt-3"><div class="odz-text-sm odz-font-bold odz-text-gray-600 odz-mb-2"> </div> <!></div>'),FE=ee('<span class="odz-text-sm odz-font-bold odz-text-gray-500"></span>'),IE=ee('<span class="odz-text-sm odz-font-bold"> </span>'),UE=ee('<div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <span class="odz-text-sm odz-font-bold"> </span></div>'),QE=ee('<div class="odz-flex odz-flex-col odz-gap-1"><div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <span class="odz-text-sm odz-font-bold"> </span></div> <div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <!></div> <!></div> <div class="odz-flex odz-flex-col odz-items-end"><span class="odz-font-bold"> </span> <span class="odz-font-bold odz-text-lg"> </span></div>',1),TE=ee('<div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border"><div class="odz-card-body odz-p-3"><div class="odz-flex odz-gap-4"><div class="odz-flex odz-flex-col odz-justify-between"><img class="odz-w-24 odz-h-24 odz-object-cover odz-rounded"> <!></div> <div class="odz-flex-1"><h2 class="odz-text-lg odz-font-bold"> </h2> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mt-3"></div> <!> <!> <div class="odz-flex odz-justify-between odz-items-center odz-mt-4 odz-pt-3 odz-border-t"></div></div></div></div></div>'),LE=ee('<div class="odz-text-center odz-py-8 odz-text-gray-500">  .</div>'),PE=ee('<div class="odz-fixed odz-inset-0 odz-z-50 odz-flex odz-items-center odz-justify-center odz-bg-black odz-bg-opacity-50"><div class="odz-bg-white odz-rounded-lg odz-shadow-xl odz-max-w-md odz-w-full odz-mx-4"><div class="odz-px-6 odz-py-4 odz-border-b odz-border-gray-200"><h3 class="odz-text-lg odz-font-semibold odz-text-gray-900">  </h3></div> <div class="odz-px-6 odz-py-4"><p class="odz-text-sm odz-text-gray-600"><span class="odz-font-medium odz-text-gray-900"> </span>() ?</p> <p class="odz-text-xs odz-text-gray-500 odz-mt-2">    .</p></div> <div class="odz-px-6 odz-py-4 odz-border-t odz-border-gray-200 odz-flex odz-gap-3 odz-justify-end"><button class="odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-text-gray-700 odz-bg-white odz-border odz-border-gray-300 odz-rounded-lg hover:odz-bg-gray-50 odz-transition-colors"></button> <button class="odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-text-white odz-bg-red-500 odz-rounded-lg hover:odz-bg-red-600 odz-transition-colors"></button></div></div></div>'),kE=ee('<div class="odz-flex odz-flex-col odz-gap-4"><!></div> <!>',1);function zB(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t);let s=pt(e,"onSelectProduct",8),i=pt(e,"onDeleteProduct",8,void 0),a=pt(e,"isEditable",8,!1),A=Ie(!1),d=null,c=Ie("");function u($){return $.title?$.title:!$.option_values||!Array.isArray($.option_values)?$.id||"":$.option_values.map(j=>{var J;return((J=j.option_value)==null?void 0:J.value)||""}).join(" / ")}function h($){const j=[];return $.parentTemplates&&j.push($.parentTemplates.map(J=>J.name).join(" > ")),$.colors&&j.push(`${$.colors.length}`),j.join(" - ")}function f($){var j,J;d=$,_(c,((J=(j=o().products[$])==null?void 0:j.product)==null?void 0:J.title)||" "),_(A,!0)}async function g(){if(d===null)return;const $=d;_(A,!1),d=null,_(c,""),i()?await i()($):Kt(Et,lt(o).products=o().products.filter((j,J)=>J!==$),lt(o))}function m(){_(A,!1),d=null,_(c,"")}qr();var y=kE(),b=gt(y),S=w(b);{var F=$=>{var j=Nt(),J=gt(j);Jt(J,1,()=>o().products,ar,(we,D,N)=>{var Z=TE(),se=w(Z),ce=w(se),re=w(ce),pe=w(re),V=z(pe,2);{var K=G=>{var R=bE(),he=w(R),Be=z(he,2);at("click",he,()=>s()(N)),at("click",Be,()=>f(N)),T(G,R)};Se(V,G=>{a()&&G(K)})}var oe=z(re,2),ae=w(oe),x=w(ae),E=z(ae,2);Jt(E,5,()=>l(D).variants,ar,(G,R)=>{var he=BE(),Be=w(he);{var be=me=>{var le=_E();He(ze=>{nr(le,"src",l(R).thumbnail),nr(le,"alt",ze)},[()=>u(l(R))],it),T(me,le)};Se(Be,me=>{l(R).thumbnail&&me(be)})}var Le=z(Be,2),Y=w(Le),O=w(Y),ve=z(Y,2),xe=w(ve);He(me=>{Qe(O,me),Qe(xe,`${l(R).quantity??""}`)},[()=>u(l(R))],it),T(G,he)});var I=z(E,2);{var L=G=>{var R=zE();Jt(R,5,()=>l(D).prints,ar,(he,Be)=>{var be=xE(),Le=w(be),Y=w(Le),O=z(Le,2),ve=w(O);He(xe=>{Qe(Y,l(Be).title),Qe(ve,xe)},[()=>h(l(Be))],it),T(he,be)}),T(G,R)};Se(I,G=>{l(D).prints&&l(D).prints.length>0&&G(L)})}var M=z(I,2);{var H=G=>{var R=EE(),he=z(w(R),2);Jt(he,1,()=>Object.entries(l(D).addons),ar,(Be,be)=>{let Le=()=>l(be)[1];var Y=Nt();const O=it(()=>l(D).addonProductsMap[Le().productId]);var ve=gt(Y);{var xe=me=>{var le=SE();const ze=it(()=>l(O).variants.find(Ae=>Ae.id===Le().variantId));var ke=w(le),de=w(ke),Fe=z(ke,2);{var U=Ae=>{var fe=CE(),Ce=gt(fe),ge=w(Ce),De=z(Ce,2),Ne=w(De);He(Ze=>{Qe(ge,`- ${l(ze).title||" "}`),Qe(Ne,` ${Ze??""}`)},[()=>vr(l(ze).prices[0].amount)],it),T(Ae,fe)};Se(Fe,Ae=>{l(ze)&&Ae(U)})}He(()=>Qe(de,l(O).title)),T(me,le)};Se(ve,me=>{l(O)&&me(xe)})}T(Be,Y)}),T(G,R)};Se(M,G=>{l(D).addons&&Object.keys(l(D).addons).length>0&&l(D).addonProductsMap&&G(H)})}var q=z(M,2);Jt(q,5,()=>[l(D)],ar,(G,R)=>{var he=QE();const Be=it(()=>l(R).productAmount||(l(R).variants||[]).reduce((Oe,Ke)=>Oe+Ke.prices[0].amount*Ke.quantity,0)),be=it(()=>l(R).printAmount||(l(R).prints||[]).reduce((Oe,Ke)=>Oe+(Ke.price||0),0)),Le=it(()=>l(R).addonAmount||0),Y=it(()=>l(R).totalAmount||l(Be)+l(be)+l(Le)),O=it(()=>l(R).prints&&l(R).prints.length>0),ve=it(()=>l(R).simplePrints&&l(R).simplePrints.length>0),xe=it(()=>l(R).print_type==="simple"&&l(ve)||l(ve)&&!l(O)),me=it(()=>!l(O)&&!l(ve));var le=gt(he),ze=w(le),ke=z(w(ze),2),de=w(ke),Fe=z(ze,2),U=z(w(Fe),2);{var Ae=Oe=>{var Ke=FE();T(Oe,Ke)},fe=Oe=>{var Ke=IE(),Je=w(Ke);He(Te=>Qe(Je,`${Te??""}`),[()=>vr(l(be))],it),T(Oe,Ke)};Se(U,Oe=>{l(xe)||l(me)?Oe(Ae):Oe(fe,!1)})}var Ce=z(Fe,2);{var ge=Oe=>{var Ke=UE(),Je=z(w(Ke),2),Te=w(Je);He(_e=>Qe(Te,`${_e??""}`),[()=>vr(l(Le))],it),T(Oe,Ke)};Se(Ce,Oe=>{l(Le)>0&&Oe(ge)})}var De=z(le,2),Ne=z(w(De),2),Ze=w(Ne);He((Oe,Ke)=>{Qe(de,`${Oe??""}`),Qe(Ze,`${Ke??""}`)},[()=>vr(l(Be)),()=>vr(l(Y))],it),T(G,he)}),He(()=>{nr(pe,"src",l(D).product.thumbnail),nr(pe,"alt",l(D).product.title),Qe(x,l(D).product.title)}),T(we,Z)}),T($,j)},k=$=>{var j=LE();T($,j)};Se(S,$=>{o().products&&o().products.length>0?$(F):$(k,!1)})}var P=z(b,2);{var te=$=>{var j=PE(),J=w(j),we=z(w(J),2),D=w(we),N=w(D),Z=w(N),se=z(we,2),ce=w(se),re=z(ce,2);He(()=>Qe(Z,l(c))),at("click",ce,m),at("click",re,g),T($,j)};Se(P,$=>{l(A)&&$(te)})}T(n,y),jr(),r()}var OE=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl"><h3 class="odz-text-lg odz-font-bold"> </h3> <p class="odz-py-4"> </p> <div class="odz-modal-action"><form method="dialog"><button class="odz-btn"></button></form></div></div></dialog>');function Wd(n,e){Hr(e,!1);let t=pt(e,"isOpen",12),r=pt(e,"message",12),o=pt(e,"title",8,""),s=pt(e,"onClose",8,void 0);function i(){t(!1),r(""),s()&&s()()}qr();var a=Nt(),A=gt(a);{var d=c=>{var u=OE(),h=w(u),f=w(h),g=w(f),m=z(f,2),y=w(m),b=z(m,2),S=w(b),F=w(S);He(()=>{Qe(g,o()),Qe(y,r())}),at("click",F,i),T(c,u)};Se(A,c=>{t()&&c(d)})}T(n,a),jr()}var DE=ee('<div class="odz-fixed odz-inset-0 odz-bg-base-100 odz-bg-opacity-50 odz-flex odz-items-center odz-justify-center odz-z-50"><div class="odz-rounded-lg odz-p-8 odz-flex odz-flex-col odz-items-center odz-gap-4"><span class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></span> <p class="odz-text-base-content odz-font-medium"> </p></div></div>');function Xd(n,e){let t=pt(e,"isLoading",8,!1),r=pt(e,"message",8,"...");var o=Nt(),s=gt(o);{var i=a=>{var A=DE(),d=w(A),c=z(w(d),2),u=w(c);He(()=>Qe(u,r())),T(a,A)};Se(s,a=>{t()&&a(i)})}T(n,o)}var NE=ee("<span> <span></span></span>"),ME=ee('<div class="odz-flex odz-items-center odz-gap-2 odz-w-full odz-justify-center"><!> <span> <span></span></span> <!></div>');function CB(n,e){Hr(e,!1);const t=Ie();let r=pt(e,"originalPrice",8),o=pt(e,"finalPrice",8),s=pt(e,"hasDiscount",8,!1),i=pt(e,"size",8,"md"),a=pt(e,"showOriginal",8,!0);Zt(()=>zn(i()),()=>{_(t,{sm:{original:"odz-text-sm",final:"odz-text-sm odz-font-semibold",currency:"odz-text-xs"},md:{original:"odz-text-base",final:"odz-text-lg odz-font-bold",currency:"odz-text-sm"},lg:{original:"odz-text-lg",final:"odz-text-xl odz-font-bold",currency:"odz-text-base"}}[i()])}),Zn(),qr();var A=ME(),d=w(A);{var c=y=>{var b=NE(),S=w(b),F=z(S);He(k=>{Ir(b,`odz-text-gray-500 odz-line-through ${l(t).original??""}`),Qe(S,k),Ir(F,v0(l(t).currency))},[()=>r().toLocaleString()],it),T(y,b)};Se(d,y=>{s()&&a()&&r()!==o()&&y(c)})}var u=z(d,2),h=w(u),f=z(h),g=z(u,2);{var m=y=>{var b=Nt();const S=it(()=>Math.round((r()-o())/r()*100));var F=gt(b);{var k=P=>{};Se(F,P=>{l(S)>0&&P(k)})}T(y,b)};Se(g,y=>{s()&&r()!==o()&&y(m)})}He(y=>{Ir(u,`odz-text-gray-900 ${l(t).final??""}`),Qe(h,y),Ir(f,v0(l(t).currency))},[()=>o().toLocaleString()],it),T(n,A),jr()}var HE=ee('<img class="odz-w-8 odz-h-8 odz-object-cover odz-mb-1">'),jE=ee('<span class="odz-ml-1"></span>'),RE=ee('<span class="odz-ml-1"></span>'),qE=ee("<button><!> <span> </span> <!></button>"),KE=ee('<div class="odz-flex odz-flex-col odz-gap-2 mb-4"><h3 class="odz-font-bold odz-text-sm"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),$E=ee('<img class="odz-w-10 odz-h-10 odz-rounded odz-object-cover">'),VE=ee('<!> <div class="odz-inline-flex odz-items-center odz-justify-center odz-w-5 odz-h-5 odz-bg-red-500 odz-text-white odz-rounded-full odz-text-xs odz-font-bold odz-flex-shrink-0" title=" ">%</div>',1),GE=ee('<span class="odz-text-xs"> </span>'),WE=ee('<div class="odz-flex odz-flex-col odz-border odz-rounded odz-overflow-hidden"><div class="odz-bg-gray-50 odz-px-3 odz-py-2 odz-border-b"><span class="odz-text-xs odz-font-medium odz-text-center odz-block"> </span></div> <div class="odz-flex odz-flex-col odz-p-3 odz-gap-2"><div class="odz-text-center"><div class="odz-flex odz-items-center odz-justify-center odz-gap-1"><!></div></div> <div class="odz-flex odz-items-center odz-border odz-rounded odz-mt-1"><button class="odz-btn odz-btn-ghost odz-btn-sm odz-px-2">-</button> <input type="number" class="odz-input odz-input-sm odz-w-full odz-text-center odz-border-x-0 odz-border-y focus:odz-outline-none focus:odz-ring-0 focus:odz-border-x-0 focus:odz-border-y" min="0"> <button class="odz-btn odz-btn-ghost odz-btn-sm odz-px-2">+</button></div></div></div>'),XE=ee('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div>'),YE=ee('<p class="odz-text-sm odz-text-gray-500">    ( ) .</p>'),JE=ee('<div class="odz-flex odz-flex-col odz-gap-3"><div class="odz-flex odz-items-center odz-gap-2 odz-bg-gray-100 odz-p-2 odz-rounded"><!> <h3 class="odz-font-semibold odz-text-base"> </h3></div> <!></div>'),ZE=ee('<div class="odz-flex odz-flex-col odz-gap-6 mt-4"></div>'),eF=ee('<img class="odz-w-16 odz-h-16 odz-object-cover odz-rounded">'),tF=ee('<p class="odz-text-sm odz-text-gray-600 odz-mt-1"> </p>'),rF=ee('<div class="odz-text-sm odz-font-semibold odz-text-primary"> </div>'),nF=ee('<div role="button" tabindex="0"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-2"><input type="radio" class="odz-radio odz-radio-primary odz-radio-sm"> <span class="odz-text-sm odz-font-medium"> </span></div> <!></div>'),oF=ee('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 odz-gap-3"></div>'),sF=ee('<div class="odz-border odz-rounded-lg odz-p-4 odz-bg-base-100"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-3"><!> <div><h5 class="odz-font-medium odz-text-base"> </h5> <!></div></div> <!></div>'),iF=ee('<div class="odz-flex odz-flex-col odz-gap-4"><h4 class="odz-font-semibold odz-text-base odz-text-gray-700"> </h4> <!></div>'),aF=ee('<div class="odz-flex odz-flex-col odz-gap-6 odz-mt-8"><h3 class="odz-font-bold odz-text-lg odz-border-b odz-pb-2"> </h3> <!></div>'),AF=ee('<div class="odz-flex odz-justify-end odz-mt-6"><button class="odz-btn odz-btn-accent odz-w-full"></button></div>'),lF=ee('<div class="odz-card odz-card-side odz-bg-base-100 odz-border odz-rounded odz-p-3"><figure><img class="odz-max-h-24 odz-border"></figure> <div class="odz-card-body"><h2 class="odz-card-title odz-text-base"> </h2> <div class="odz-card-actions odz-justify-end"></div></div></div> <!>  <div class="odz-bg-yellow-100 odz-p-2 odz-rounded odz-text-xs odz-mb-2"><strong>  :</strong><br> <br> <br> <br> </div> <!> <!> <!>',1),dF=ee('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><!></div> <!> <!>',1);function cF(n,e){var ae;Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=()=>Xr(Ls,"$shopStore",t);let i=pt(e,"step",12,0),a=pt(e,"productId",8),A=Ie(null),d=Ie(!1),c=Ie(""),u=Ie(""),h=Ie(!1),f=Ie([]),g=Ie({}),m=Ie({}),y=Ie(((ae=o().products[o().index])==null?void 0:ae.variants.map(x=>({...x})))||[]),b=Ie({}),S=Ie(null),F=Ie({}),k=Ie([]),P=Ie({});function te(x,E){console.log(" togglePenultimateSelection :",{optionId:x,value:E,penultimateOptionId:l(S)}),!l(S)&&l(A)&&l(A).options.length>=2&&(_(S,l(A).options[l(A).options.length-2].id),console.log(" penultimateOptionId :",l(S))),x!==l(S)&&console.log(" optionId :",{optionId:x,penultimateOptionId:l(S)}),hr(b,l(b)[x]=E),_(b,{...l(b)});const I=l(k).indexOf(E);if(console.log("  expandedPenultimateValues:",l(k),"index:",I),I===-1)if(_(k,[...l(k),E]),console.log("    expandedPenultimateValues:",l(k)),!l(P)[E]||l(P)[E].length===0){console.log(" variants  :",{value:E,optionId:x,penultimateOptionId:l(S)});const L=l(A).variants.filter(M=>M.option_values?M.option_values.some(q=>{if(q.option_id&&q.value){const G=q.option_id===x&&q.value===E;return G&&console.log("   :",{variantId:M.id,ov:q}),G}else if(q.option_value&&q.option_value.option_id){const G=q.option_value.option_id===x&&q.option_value.value===E;return G&&console.log("   :",{variantId:M.id,ov:q}),G}return!1}):(console.log(" variant.option_values :",M.id),!1));console.log("  variants:",{value:E,count:L.length,variants:L.map(M=>({id:M.id,title:M.title}))}),hr(P,l(P)[E]=L),_(P,{...l(P)}),L.forEach(M=>{l(y).some(H=>H.id===M.id)||_(y,[...l(y),{...M,quantity:0}])})}else console.log("  variants :",{value:E,count:l(P)[E].length});else _(k,l(k).filter(L=>L!==E)),console.log("    expandedPenultimateValues:",l(k));_(k,[...l(k)]),_(P,{...l(P)}),console.log(" togglePenultimateSelection :",{expandedPenultimateValues:l(k),variantsByGroup:Object.keys(l(P)),hasExpanded:l(k).length>0}),setTimeout(()=>{console.log(" 1   :",{expandedPenultimateValues:l(k).length,variantsByGroupKeys:Object.keys(l(P))})},1e3)}function $(x,E){var L;const I=((L=l(A))==null?void 0:L.options.findIndex(M=>M.id===x))??-1;if(!(!l(A)||I===-1||I>=l(A).options.length-1)){for(let M=I+1;M<l(A).options.length;M++)delete l(b)[l(A).options[M].id];hr(b,l(b)[x]=E),_(b,{...l(b)}),_(k,[]),_(P,{}),l(S)&&_(y,l(y).filter(M=>!M.option_values.some(H=>H.option_value.option_id===l(S))||(M.quantity||0)>0))}}function j(x){_(y,l(y).map(E=>E.id===x?{...E,quantity:(E.quantity||0)+1}:E))}function J(x){_(y,l(y).map(E=>E.id===x&&(E.quantity||0)>0?{...E,quantity:(E.quantity||0)-1}:E))}function we(){const x=l(y).filter(I=>(I.quantity||0)>0);if(x.length===0){_(d,!0),_(c," "),_(u,"1    .");return}const E=o().products[o().index];E&&(Kt(Et,lt(o).products[o().index]={...E,variants:x,quantity:x.reduce((I,L)=>I+(L.quantity||0),0)},lt(o)),Et.updateTotalAmounts()),i(2)}async function D(){var L,M;if(!((L=l(A))!=null&&L.quantity_discounts)){_(F,{});return}const x=l(y).reduce((H,q)=>H+(q.quantity||0),0);let E=null;if(x>0){const H=((M=l(y).find(q=>(q.quantity||0)>0))==null?void 0:M.prices[0].amount)||0;E=mi(x,H,l(A).quantity_discounts)}const I={};for(const H of l(y))(H.quantity||0)>0&&(E!=null&&E.hasDiscount)&&(I[H.id]=E);_(F,I)}let N=Ie(null);En(async()=>{var x;_(h,!0);try{if(_(A,await Mu(a(),s().id)),l(A)&&(_(f,await Hu(l(A).id)),_(m,{}),l(f).forEach(E=>{E.items.forEach(I=>{I.addon_product.variants&&I.addon_product.variants.length>0&&hr(m,l(m)[I.addon_product.id]={price:I.addon_product.variants[0].prices[0].amount,title:I.addon_product.title,variants:I.addon_product.variants})})}),(x=o().products[o().index])!=null&&x.addons)){const E=o().products[o().index].addons;_(g,{}),Object.entries(E).forEach(([I,L])=>{typeof L=="object"&&L.productId&&L.variantId?hr(g,l(g)[I]={productId:L.productId,variantId:L.variantId}):typeof L=="string"&&hr(g,l(g)[I]={productId:L,variantId:""})}),_(g,{...l(g)})}if(l(A)&&l(A).options.length>0&&(l(A).options.length>=2?(_(S,l(A).options[l(A).options.length-2].id),console.log(" penultimateOptionId :",{penultimateOptionId:l(S),optionCount:l(A).options.length,allOptions:l(A).options.map(E=>({id:E.id,title:E.title}))})):console.log("  2 :",l(A).options.length)),o().products[o().index]&&o().products[o().index].variants.length>0){Kt(Et,lt(o).products[o().index].product=l(A),lt(o)),_(y,o().products[o().index].variants.map(I=>({...I})));const E=o().products[o().index].addons||{};if(_(g,{}),Object.entries(E).forEach(([I,L])=>{typeof L=="object"&&L.productId&&L.variantId?hr(g,l(g)[I]={productId:L.productId,variantId:L.variantId}):typeof L=="string"&&hr(g,l(g)[I]={productId:L,variantId:""})}),l(A)&&l(A).options.length>0){const I=l(y).filter(L=>(L.quantity||0)>0);if(I.length>0){const L=l(A).options.map(M=>M.id);if(l(A).options.length>=2){_(S,l(A).options[l(A).options.length-2].id);const M=[];if(I.forEach(H=>{if(H.title){const q=H.title.split(" / ");if(q.length>0){const G=q[0];M.includes(G)||M.push(G)}}H.option_values&&H.option_values.forEach(q=>{q.option_id&&q.value?q.option_id===l(S)&&(M.includes(q.value)||M.push(q.value)):q.option_value&&q.option_value.option_id&&q.option_value.option_id===l(S)&&(M.includes(q.option_value.value)||M.push(q.option_value.value))})}),M.length>0)M.forEach(H=>{te(l(S),H)});else{const H=[];I.forEach(q=>{if(q.title){const G=q.title.split(" / ");if(G.length>0){const R=G[0].trim();H.includes(R)||H.push(R)}}}),H.length>0?H.forEach(q=>{const G=l(A).options[l(A).options.length-2].values.find(R=>R.value.toLowerCase()===q.toLowerCase());if(G)te(l(S),G.value);else{const R=l(A).options[l(A).options.length-2].values.filter(he=>he.value.toLowerCase().includes(q.toLowerCase())||q.toLowerCase().includes(he.value.toLowerCase()));R.length>0&&R.forEach(he=>{te(l(S),he.value)})}}):l(A).options[l(A).options.length-2].values.forEach(q=>{te(l(S),q.value)})}}else l(A).options.length}}}else l(A)&&Kt(Et,lt(o).products=[...o().products,{product:l(A),variants:[],quantity:0,prints:[],addons:{},addonProductsMap:l(m)}],lt(o));setTimeout(()=>{Et.updateTotalAmounts()},100)}catch(E){console.error("Product component  :",E)}finally{_(h,!1)}});function Z(x,E,I){if(!I||I.trim()===""){console.error("Invalid variantId provided:",I);return}hr(g,l(g)[x]={productId:E,variantId:I}),_(g,{...l(g)});const L=o().products[o().index];L&&(Kt(Et,lt(o).products[o().index]={...L,addons:l(g),addonProductsMap:l(m)},lt(o)),Et.updateTotalAmounts())}function se(x){return x?x.replace(/<[^>]*>/g,"").trim():""}Zt(()=>(o(),l(g)),()=>{var x;if((x=o().products[o().index])!=null&&x.addons&&Object.keys(o().products[o().index].addons).length>0&&Object.keys(l(g)).length===0){const E=o().products[o().index].addons;Object.entries(E).forEach(([I,L])=>{typeof L=="object"&&L.productId&&L.variantId&&hr(g,l(g)[I]={productId:L.productId,variantId:L.variantId})}),_(g,{...l(g)})}}),Zt(()=>(l(y),l(A),l(N),o(),l(g),l(m),Et),()=>{l(y)&&l(A)&&(l(N)&&clearTimeout(l(N)),_(N,setTimeout(()=>{const x=o().products[o().index];if(x){const E=l(y).reduce((M,H)=>M+(H.quantity||0),0),I=x.quantity||0,L=l(y).filter(M=>(M.quantity||0)>0);Kt(Et,lt(o).products[o().index]={...x,variants:L,quantity:E,addons:l(g),addonProductsMap:l(m)},lt(o)),D(),E!==I&&x.prints&&x.prints.length>0&&Et.calculatePrintPrice(o().index),Et.updateTotalAmounts()}},100)))}),Zn(),qr();var ce=dF(),re=gt(ce),pe=w(re);{var V=x=>{var E=lF(),I=gt(E),L=w(I),M=w(L),H=z(L,2),q=w(H),G=w(q),R=z(I,2);Jt(R,1,()=>l(A).options,ar,(ke,de,Fe)=>{var U=Nt(),Ae=gt(U);{var fe=Ce=>{var ge=KE(),De=w(ge),Ne=w(De),Ze=z(De,2);Jt(Ze,5,()=>l(de).values,ar,(Oe,Ke)=>{var Je=qE();const Te=it(()=>Fe===l(A).options.length-2),_e=it(()=>l(Te)&&l(k).includes(l(Ke).value)),Ue=it(()=>l(Te)?l(_e):l(b)[l(de).id]===l(Ke).value);var Me=w(Je);{var je=tt=>{var rt=HE();He(()=>{nr(rt,"src",l(Ke).image),nr(rt,"alt",l(Ke).value)}),T(tt,rt)};Se(Me,tt=>{l(Ke).image&&tt(je)})}var At=z(Me,2),ut=w(At),ht=z(At,2);{var Re=tt=>{var rt=jE();T(tt,rt)},Xe=tt=>{var rt=Nt(),Bt=gt(rt);{var nt=ot=>{var xt=RE();T(ot,xt)};Se(Bt,ot=>{l(Te)&&ot(nt)},!0)}T(tt,rt)};Se(ht,tt=>{l(Te)&&l(_e)?tt(Re):tt(Xe,!1)})}He(()=>{Ir(Je,`odz-btn odz-btn-outline odz-h-auto odz-min-h-10 odz-border-gray-300 odz-w-44 odz-p-2 odz-text-xs ${(l(Ue)?"odz-border-2 odz-border-gray-800":"")??""}`),Qe(ut,l(Ke).value)}),at("click",Je,()=>{var tt;console.log("   :",{optionTitle:l(de).title,optionId:l(de).id,value:l(Ke).value,isPenultimateOption:l(Te),index:Fe,totalOptions:(tt=l(A))==null?void 0:tt.options.length}),l(Te)?te(l(de).id,l(Ke).value):$(l(de).id,l(Ke).value)}),T(Oe,Je)}),He(()=>Qe(Ne,l(de).title)),T(Ce,ge)};Se(Ae,Ce=>{Fe<l(A).options.length-1&&Ce(fe)})}T(ke,U)});var he=z(R,2),Be=z(w(he),2),be=z(Be,2),Le=z(be,2),Y=z(Le,2),O=z(he,2);{var ve=ke=>{var de=ZE();Jt(de,5,()=>l(k),Fe=>Fe,(Fe,U)=>{var Ae=JE();const fe=it(()=>l(P)[l(U)]||[]),Ce=it(()=>{var _e;return(_e=l(A).options[l(A).options.length-2])==null?void 0:_e.values.find(Ue=>Ue.value===l(U))});var ge=w(Ae),De=w(ge);{var Ne=_e=>{var Ue=$E();He(()=>{nr(Ue,"src",l(Ce).image),nr(Ue,"alt",l(U))}),T(_e,Ue)};Se(De,_e=>{var Ue;(Ue=l(Ce))!=null&&Ue.image&&_e(Ne)})}var Ze=z(De,2),Oe=w(Ze),Ke=z(ge,2);{var Je=_e=>{var Ue=XE();Jt(Ue,5,()=>l(fe),Me=>Me.id,(Me,je)=>{var At=WE();const ut=it(()=>l(y).find(zt=>zt.id===l(je).id)),ht=it(()=>{var zt;return((zt=l(ut))==null?void 0:zt.quantity)||0}),Re=it(()=>{var zt;return((zt=l(je).option_values.find(Tt=>Tt.option_value.option_id===l(A).options[l(A).options.length-1].id))==null?void 0:zt.option_value.value)||"N/A"}),Xe=it(()=>l(F)[l(je).id]);var tt=w(At),rt=w(tt),Bt=w(rt),nt=z(tt,2),ot=w(nt),xt=w(ot),Lt=w(xt);{var _t=zt=>{var Tt=VE(),Rt=gt(Tt);CB(Rt,{get originalPrice(){return l(je).prices[0].amount},get finalPrice(){return l(Xe).discountedPrice},hasDiscount:!0,size:"sm"}),T(zt,Tt)},vt=zt=>{var Tt=GE(),Rt=w(Tt);He(Dt=>Qe(Rt,`${Dt??""}`),[()=>vr(l(je).prices[0].amount)],it),T(zt,Tt)};Se(Lt,zt=>{var Tt;(Tt=l(Xe))!=null&&Tt.hasDiscount&&l(ht)>0?zt(_t):zt(vt,!1)})}var Pt=z(ot,2),kt=w(Pt),Ct=z(kt,2),Ft=z(Ct,2);He(()=>{Qe(Bt,l(Re)),kt.disabled=l(ht)<=0,Xm(Ct,l(ht))}),at("click",kt,()=>J(l(je).id)),at("input",Ct,zt=>{const Tt=parseInt(zt.target.value)||0;_(y,l(y).map(Rt=>Rt.id===l(je).id?{...Rt,quantity:Tt>=0?Tt:0}:Rt))}),at("click",Ft,()=>j(l(je).id)),T(Me,At)}),T(_e,Ue)},Te=_e=>{var Ue=YE();T(_e,Ue)};Se(Ke,_e=>{l(fe).length>0?_e(Je):_e(Te,!1)})}He(()=>Qe(Oe,l(U))),T(Fe,Ae)}),T(ke,de)};Se(O,ke=>{l(k).length>0&&ke(ve)})}var xe=z(O,2);{var me=ke=>{var de=aF(),Fe=z(w(de),2);Jt(Fe,1,()=>l(f),U=>U.id,(U,Ae)=>{var fe=iF(),Ce=w(fe),ge=w(Ce),De=z(Ce,2);Jt(De,1,()=>l(Ae).items,Ne=>Ne.id,(Ne,Ze)=>{var Oe=sF(),Ke=w(Oe),Je=w(Ke);{var Te=Re=>{var Xe=eF();He(()=>{nr(Xe,"src",l(Ze).addon_product.thumbnail),nr(Xe,"alt",l(Ze).addon_product.title)}),T(Re,Xe)};Se(Je,Re=>{l(Ze).addon_product.thumbnail&&Re(Te)})}var _e=z(Je,2),Ue=w(_e),Me=w(Ue),je=z(Ue,2);{var At=Re=>{var Xe=tF(),tt=w(Xe);He(rt=>Qe(tt,rt),[()=>se(l(Ze).addon_product.description)],it),T(Re,Xe)};Se(je,Re=>{l(Ze).addon_product.description&&Re(At)})}var ut=z(Ke,2);{var ht=Re=>{var Xe=oF();Jt(Xe,5,()=>l(Ze).addon_product.variants,tt=>tt.id,(tt,rt)=>{var Bt=nF();const nt=it(()=>l(g)[l(Ae).id]),ot=it(()=>{var Ct,Ft;return((Ct=l(nt))==null?void 0:Ct.productId)===l(Ze).addon_product.id&&((Ft=l(nt))==null?void 0:Ft.variantId)===l(rt).id});var xt=w(Bt),Lt=w(xt),_t=z(Lt,2),vt=w(_t),Pt=z(xt,2);{var kt=Ct=>{var Ft=rF(),zt=w(Ft);He(Tt=>Qe(zt,` ${Tt??""}`),[()=>vr(l(rt).prices[0].amount)],it),T(Ct,Ft)};Se(Pt,Ct=>{l(rt).prices&&l(rt).prices.length>0&&Ct(kt)})}He(Ct=>{Ir(Bt,`odz-border odz-rounded odz-p-3 odz-cursor-pointer odz-transition-all odz-duration-200 ${(l(ot)?"odz-border-primary odz-bg-primary/5":"odz-border-gray-300 hover:odz-border-gray-400")??""}`),nr(Lt,"name",`addon-${l(Ae).id??""}`),mu(Lt,l(ot)),Qe(vt,Ct)},[()=>l(rt).title||` ${l(rt).id.substring(0,4)}`],it),at("change",Lt,()=>Z(l(Ae).id,l(Ze).addon_product.id,l(rt).id)),at("click",Bt,()=>Z(l(Ae).id,l(Ze).addon_product.id,l(rt).id)),at("keydown",Bt,Ct=>Ct.key==="Enter"&&Z(l(Ae).id,l(Ze).addon_product.id,l(rt).id)),T(tt,Bt)}),T(Re,Xe)};Se(ut,Re=>{l(Ze).addon_product.variants&&l(Ze).addon_product.variants.length>0&&Re(ht)})}He(()=>Qe(Me,l(Ze).addon_product.title)),T(Ne,Oe)}),He(()=>Qe(ge,l(Ae).name)),T(U,fe)}),T(ke,de)};Se(xe,ke=>{l(f).length>0&&ke(me)})}var le=z(xe,2);{var ze=ke=>{var de=AF(),Fe=w(de);at("click",Fe,()=>we()),T(ke,de)};Se(le,ke=>{l(y).filter(de=>(de.quantity||0)>0).length>0&&ke(ze)})}He(ke=>{var de;nr(M,"src",l(A).thumbnail),nr(M,"alt",l(A).title),Qe(G,l(A).title),Qe(Be,` expandedPenultimateValues.length: ${l(k).length??""}`),Qe(be,` expandedPenultimateValues: ${ke??""}`),Qe(Le,` penultimateOptionId: ${l(S)??""}`),Qe(Y,`  : ${((de=l(A))==null?void 0:de.options.length)||0}`)},[()=>JSON.stringify(l(k))],it),T(x,E)};Se(pe,x=>{l(A)&&x(V)})}var K=z(re,2);Wd(K,{get isOpen(){return l(d)},set isOpen(x){_(d,x)},get title(){return l(c)},set title(x){_(c,x)},get message(){return l(u)},set message(x){_(u,x)},$$legacy:!0});var oe=z(K,2);Xd(oe,{get isLoading(){return l(h)},set isLoading(x){_(h,x)},$$legacy:!0}),T(n,ce),jr(),r()}const Jl={productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1,currentSessionId:`session-${Date.now()}-${Math.random().toString(36).substring(2)}`,sessionStorageKey:"extended-product-data-cache"};function uF(){const{subscribe:n,set:e,update:t}=vl(Jl),r={save(o,s){if(!(typeof window>"u"))try{const i=`${Jl.sessionStorageKey}-${o}`,a={...s,lastSavedToSession:Date.now()};window.sessionStorage.setItem(i,JSON.stringify(a))}catch(i){console.warn("   :",i)}},restore(o){if(typeof window>"u")return null;try{const s=`${Jl.sessionStorageKey}-${o}`,i=window.sessionStorage.getItem(s);if(i)return JSON.parse(i)}catch(s){console.warn("   :",s)}return null},clear(o){if(!(typeof window>"u"))if(o){const s=`${Jl.sessionStorageKey}-${o}`;window.sessionStorage.removeItem(s)}else Object.keys(window.sessionStorage).forEach(s=>{s.startsWith(Jl.sessionStorageKey)&&window.sessionStorage.removeItem(s)})}};return{subscribe:n,set:e,update:t,async loadIntegratedProductData(o,s){var d;const i={subscribe:n},a=hn(i),A=r.restore(o);if((d=a.productDataCache[o])!=null&&d.isLoaded||A!=null&&A.isLoaded){const c=A||a.productDataCache[o];return A&&t(u=>({...u,productDataCache:{...u.productDataCache,[o]:c}})),c}if(a.loadingProducts.has(o))return new Promise((c,u)=>{const h=setInterval(()=>{var g;const f=hn(i);f.loadingProducts.has(o)||(clearInterval(h),(g=f.productDataCache[o])!=null&&g.isLoaded?c(f.productDataCache[o]):u(new Error("   ")))},100)});t(c=>({...c,loadingProducts:new Set([...c.loadingProducts,o]),isGlobalLoading:!0,productDataCache:{...c.productDataCache,[o]:{id:o,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!0,sessionId:c.currentSessionId}}}));try{const[c,u]=await Promise.all([Mu(o,s),Hu(o)]);if(!c)throw new Error("   ");const h={};u.forEach(g=>{g.items.forEach(m=>{m.addon_product.variants&&m.addon_product.variants.length>0&&(h[m.addon_product.id]={price:m.addon_product.variants[0].prices[0].amount,title:m.addon_product.title,variants:m.addon_product.variants,description:m.addon_product.description,thumbnail:m.addon_product.thumbnail})})});const f={id:o,product:c,addons:u,process:c.process,addonProductsMap:h,productSelection:A==null?void 0:A.productSelection,printSelection:A==null?void 0:A.printSelection,addonSelection:A==null?void 0:A.addonSelection,isLoaded:!0,isLoading:!1,sessionId:a.currentSessionId};return t(g=>{const m=new Set(g.loadingProducts);return m.delete(o),{...g,loadingProducts:m,isGlobalLoading:m.size>0,productDataCache:{...g.productDataCache,[o]:f}}}),r.save(o,f),f}catch(c){throw console.error("   :",c),t(u=>{const h=new Set(u.loadingProducts);return h.delete(o),{...u,loadingProducts:h,isGlobalLoading:h.size>0,productDataCache:{...u.productDataCache,[o]:{id:o,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!1,error:c instanceof Error?c.message:"   ",sessionId:u.currentSessionId}}}}),c}},updateProductSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,selectedColors:[],quantityByVariant:{},variantsByColor:{},totalQuantity:0,isCompleted:!1,...a.productSelection,...s,lastUpdated:A},c={...a,productSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},updatePrintSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,currentMethod:"selection",isCompleted:!1,...a.printSelection,...s,lastUpdated:A},c={...a,printSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},selectPrintMethod(o,s){this.updatePrintSelection(o,{currentMethod:s,lastUpdated:Date.now()})},completePrintSelection(o){this.updatePrintSelection(o,{isCompleted:!0,lastUpdated:Date.now()})},updateAddonSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,selectedAddons:{},isCompleted:!1,...a.addonSelection,...s,lastUpdated:A},c={...a,addonSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},getProductData(o){return hn({subscribe:n}).productDataCache[o]||null},restoreFromSession(o){const s=r.restore(o);return s&&t(i=>({...i,productDataCache:{...i.productDataCache,[o]:s}})),s},saveToSession(o){const a=hn({subscribe:n}).productDataCache[o];a&&r.save(o,a)},clearProductData(o){o?(r.clear(o),t(s=>{const i={...s.productDataCache};return delete i[o],{...s,productDataCache:i}})):(r.clear(),t(s=>({...s,productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1})))},updateProduct(o,s){t(i=>{const A={...i.productDataCache[o]||{id:o,product:s.product,addons:s.addons,addonProductsMap:{},isLoaded:!0,isLoading:!1,sessionId:i.currentSessionId},product:s.product,addons:s.addons,isLoaded:!0,isLoading:!1};return r.save(o,A),{...i,productDataCache:{...i.productDataCache,[o]:A}}})},hasProductSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.productSelection)!=null&&i.isCompleted)},hasPrintSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.printSelection)!=null&&i.isCompleted)},hasAddonSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.addonSelection)!=null&&i.isCompleted)},reset(){console.log(" Extended Product Data Store  "),r.clear(),e(Jl),console.log(" Extended Product Data Store  ")}}}const Hn=uF();class hF{constructor(e){this.isEnabled=!0,this.sessionId=e}log(e,t,r){if(!this.isEnabled)return;const o=new Date().toISOString();`${this.sessionId}${o}`}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t){this.log("error",e,t)}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}}function fF(n){const e=Date.now().toString(36)+Math.random().toString(36).substr(2);return{productId:n,productSelection:null,printSelection:null,addonSelection:null,additionalInfo:null,currentStep:"product",isDebugMode:!0,sessionId:e}}function pF(){const{subscribe:n,set:e,update:t}=vl(null);let r=null,o=null,s=0;return{subscribe:n,set:e,update:t,saveToSessionStorage(i){!i||Date.now()-s<100||(o&&clearTimeout(o),o=setTimeout(()=>{try{[`fixedEstimate_${i.productId}`,`fixedEstimate_${i.productId}_${i.estimateId}`,`fixedEstimate_${i.productId}_${i.estimateId}_0`,`fixedEstimate_${i.productId}_${i.estimateId}_1`,`fixedEstimate_${i.productId}_${i.estimateId}_2`,`fixedEstimate_${i.productId}_${i.estimateId}_3`,`fixedEstimate_${i.productId}_${i.estimateId}_4`,`fixedEstimate_${i.productId}_${i.estimateId}_5`,`fixedEstimate_${i.productId}_0`,`fixedEstimate_${i.productId}_1`,`fixedEstimate_${i.productId}_2`,`fixedEstimate_${i.productId}_3`,`fixedEstimate_${i.productId}_4`,`fixedEstimate_${i.productId}_5`].forEach(c=>{try{sessionStorage.removeItem(c)}catch{}});let d=`fixedEstimate_${i.productId}`;i.estimateId&&(d+=`_${i.estimateId}`),i.idx!==void 0&&(d+=`_${i.idx}`),sessionStorage.setItem(d,JSON.stringify(i)),s=Date.now()}catch{}},10))},initialize(i,a,A){var h,f,g;let d=`fixedEstimate_${i}`;a&&(d+=`_${a}`),A!==void 0&&(d+=`_${A}`);let c=null;try{const m=sessionStorage.getItem(d);if(m){const y=JSON.parse(m);y.productId===i&&(c=y)}}catch{}const u=c||{...fF(i),estimateId:a,idx:A};r=new hF(u.sessionId),e(u),c?r.info("Fixed Estimate Store   ",{productId:i,estimateId:a,idx:A,sessionId:u.sessionId,selectedColors:((f=(h=u.productSelection)==null?void 0:h.selectedColors)==null?void 0:f.length)||0,totalQuantity:((g=u.productSelection)==null?void 0:g.totalQuantity)||0}):r.info("Fixed Estimate Store  ",{productId:i,estimateId:a,idx:A,sessionId:u.sessionId}),this.saveToSessionStorage(u)},reset(){r==null||r.info("Fixed Estimate Store "),e(null),r=null},setCurrentStep(i){t(a=>{if(!a)return a;r==null||r.info(" ",{from:a.currentStep,to:i});const A={...a,currentStep:i};return this.saveToSessionStorage(A),A})},updateProductSelection(i){t(a=>{if(!a)return a;const A=Date.now(),d=a.productSelection,c={productId:a.productId,selectedColors:[],quantityByVariant:{},variantsByColor:{},variantDiscounts:{},totalQuantity:0,isCompleted:!1,...d,...i,lastUpdated:A};return r==null||r.info("   ",{productId:a.productId,changes:i,totalQuantity:c.totalQuantity,selectedColors:c.selectedColors.length}),{...a,productSelection:c}})},toggleColorSelection(i,a){t(A=>{var m;if(!A)return A;if(!A.productSelection){const y={productId:A.productId,selectedColors:[],quantityByVariant:{},variantsByColor:{},variantDiscounts:{},totalQuantity:0,isCompleted:!1,lastUpdated:Date.now()};A={...A,productSelection:y}}const d=[...A.productSelection.selectedColors],c={...A.productSelection.quantityByVariant},u={...A.productSelection.variantsByColor},h=d.indexOf(i);h===-1?(d.push(i),u[i]=a[i]||[],c[i]=c[i]||{},r==null||r.info("  ",{color:i,totalColors:d.length,variantCount:((m=a[i])==null?void 0:m.length)||0})):(d.splice(h,1),delete u[i],delete c[i],r==null||r.info("  ",{color:i,remainingColors:d.length}));const f=Object.values(c).reduce((y,b)=>y+Object.values(b).reduce((S,F)=>S+F,0),0),g={...A,productSelection:{...A.productSelection,selectedColors:d,quantityByVariant:c,variantsByColor:u,totalQuantity:f,lastUpdated:Date.now()}};return this.saveToSessionStorage(g),g})},updateQuantity(i,a,A){t(d=>{if(!d||!d.productSelection)return d;const c={...d.productSelection.quantityByVariant};c[i]||(c[i]={});const u=c[i][a]||0;c[i][a]=Math.max(0,A);const h=Object.values(c).reduce((g,m)=>g+Object.values(m).reduce((y,b)=>y+b,0),0);r==null||r.info(" ",{color:i,variantId:a,oldQuantity:u,newQuantity:c[i][a],totalQuantity:h,triggerDiscountUpdate:!0});const f={...d,productSelection:{...d.productSelection,quantityByVariant:c,totalQuantity:h,lastUpdated:Date.now(),needsDiscountRecalculation:!0}};return this.saveToSessionStorage(f),f})},updateVariantDiscounts(i){t(a=>{if(!a||!a.productSelection)return a;const A=a.productSelection.variantDiscounts||{},d=Object.keys(A).sort(),c=Object.keys(i).sort();if(!(JSON.stringify(d)!==JSON.stringify(c)||Object.keys(i).some(f=>JSON.stringify(A[f])!==JSON.stringify(i[f]))))return a;r==null||r.info("  ",{productId:a.productId,discountCount:Object.keys(i).length,changedVariants:Object.keys(i)});const h={...a,productSelection:{...a.productSelection,variantDiscounts:{...i},needsDiscountRecalculation:!1,lastUpdated:Date.now()}};return this.saveToSessionStorage(h),h})},completeProductSelection(){t(i=>{if(!i||!i.productSelection)return i;r==null||r.info("  ",{totalQuantity:i.productSelection.totalQuantity,selectedColors:i.productSelection.selectedColors.length});const a={...i,productSelection:{...i.productSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"print"};return this.saveToSessionStorage(a),a})},updatePrintSelection(i){t(a=>{if(!a)return a;const A=Date.now(),d=a.printSelection,c={productId:a.productId,currentMethod:"selection",isCompleted:!1,...d,...i,lastUpdated:A};return r==null||r.info("   ",{productId:a.productId,changes:i,currentMethod:c.currentMethod}),{...a,printSelection:c}})},selectPrintMethod(i){t(a=>{if(!a)return a;r==null||r.info("  ",{method:i,productId:a.productId});const A={...a.printSelection,productId:a.productId,currentMethod:i,isCompleted:!1,lastUpdated:Date.now()},d={...a,printSelection:A};try{let c=`fixedEstimate_${d.productId}`;d.estimateId&&(c+=`_${d.estimateId}`),d.idx!==void 0&&(c+=`_${d.idx}`),sessionStorage.setItem(c,JSON.stringify(d)),console.log("    :",{method:i,storageKey:c,printSelection:d.printSelection})}catch(c){console.error("     :",c)}return d})},completePrintSelection(){t(i=>!i||!i.printSelection?i:(r==null||r.info("  ",{method:i.printSelection.currentMethod}),{...i,printSelection:{...i.printSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"addon"}))},updateAddonSelection(i){t(a=>{if(!a)return a;const A=Date.now(),d=a.addonSelection,c={productId:a.productId,selectedAddons:{},isCompleted:!1,...d,...i,lastUpdated:A};return r==null||r.info("   ",{productId:a.productId,changes:i,addonCount:Object.keys(c.selectedAddons).length}),{...a,addonSelection:c}})},toggleAddonSelection(i,a,A){t(d=>{var g,m,y;if(!d)return d;const c={...((g=d.addonSelection)==null?void 0:g.selectedAddons)||{}};((m=c[i])==null?void 0:m.productId)===a&&((y=c[i])==null?void 0:y.variantId)===A?(delete c[i],r==null||r.info("  ",{addonId:i,productId:a,variantId:A,remainingAddons:Object.keys(c).length})):(c[i]={productId:a,variantId:A},r==null||r.info(" ",{addonId:i,productId:a,variantId:A,totalAddons:Object.keys(c).length}));const h={...d.addonSelection??{productId:d.productId,selectedAddons:{},isCompleted:!1,lastUpdated:Date.now()},productId:d.productId,selectedAddons:c,isCompleted:!1,lastUpdated:Date.now()},f={...d,addonSelection:h};try{const b=`fixedEstimate_${f.productId}`;sessionStorage.setItem(b,JSON.stringify(f))}catch{}return f})},completeAddonSelection(){t(i=>{var A;if(!i)return i;const a=Object.keys(((A=i.addonSelection)==null?void 0:A.selectedAddons)||{}).length;return r==null||r.info("  ",{addonCount:a}),{...i,addonSelection:{...i.addonSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"additional"}})},updateAdditionalInfo(i){t(a=>{if(!a)return a;const A=Date.now(),c={customerName:"",customerPhone:"",customerEmail:"",organizationName:"",postcode:"",address1:"",address2:"",shippingMethod:"standard",prefDeliveryDate:"",comment:"",designRequirement:"",isCompleted:!1,...a.additionalInfo,...i,lastUpdated:A};return r==null||r.info("  ",{changes:i,hasCustomerInfo:!!(c.customerName&&c.customerPhone),hasAddressInfo:!!c.address1}),{...a,additionalInfo:c}})},completeAdditionalInfo(){t(i=>!i||!i.additionalInfo?i:(r==null||r.info("  ",{customerName:i.additionalInfo.customerName,hasAddress:!!i.additionalInfo.address1}),{...i,additionalInfo:{...i.additionalInfo,isCompleted:!0,lastUpdated:Date.now()}}))},toggleDebugMode(){t(i=>{if(!i)return i;const a=!i.isDebugMode;return r&&(a?(r.enable(),r.info("  ")):(r.info("  "),r.disable())),{...i,isDebugMode:a}})},getSelectionSummary(){var A,d,c,u,h,f,g,m,y,b;const i=hn({subscribe:n});if(!i)return null;const a={productId:i.productId,sessionId:i.sessionId,currentStep:i.currentStep,completedSteps:{product:((A=i.productSelection)==null?void 0:A.isCompleted)||!1,print:((d=i.printSelection)==null?void 0:d.isCompleted)||!1,addon:((c=i.addonSelection)==null?void 0:c.isCompleted)||!1,additional:((u=i.additionalInfo)==null?void 0:u.isCompleted)||!1},statistics:{totalQuantity:((h=i.productSelection)==null?void 0:h.totalQuantity)||0,selectedColors:((f=i.productSelection)==null?void 0:f.selectedColors.length)||0,printMethod:((g=i.printSelection)==null?void 0:g.currentMethod)||"none",addonCount:Object.keys(((m=i.addonSelection)==null?void 0:m.selectedAddons)||{}).length,hasCustomerInfo:!!((y=i.additionalInfo)!=null&&y.customerName&&((b=i.additionalInfo)!=null&&b.customerPhone))}};return r==null||r.info("  ",a),a},toEstimateStoreFormat(){const i=hn({subscribe:n});if(!i)return null;r==null||r.info("EstimateStore   ");const a={productSelection:i.productSelection,printSelection:i.printSelection,addonSelection:i.addonSelection,additionalInfo:i.additionalInfo,metadata:{sessionId:i.sessionId,lastUpdated:Date.now()}};return r==null||r.info("EstimateStore   ",{hasProductSelection:!!i.productSelection,hasPrintSelection:!!i.printSelection,hasAddonSelection:!!i.addonSelection,hasAdditionalInfo:!!i.additionalInfo}),a},toDBFormat(i){const a=hn({subscribe:n});if(!a)return null;try{const{FixedEstimateDBConverter:A}=require("../types/fixedEstimateTypes"),d=i||`EST_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;r==null||r.info("DB   ",{estimateId:d});const c=A.toDBFormat(a,d);return r==null||r.info("DB   ",{estimateId:d,hasProductSelection:!!c.productSelection,hasPrintSelection:!!c.printSelection,addonSelectionsCount:c.addonSelections.length,hasAdditionalInfo:!!c.additionalInfo}),c}catch(A){return r==null||r.error("DB   ",A),null}},fromDBFormat(i){try{const{FixedEstimateDBConverter:a}=require("../types/fixedEstimateTypes");r==null||r.info("DB    ");const A=a.fromDBFormat(i);return e(A),r==null||r.info("DB   ",{productId:A.productId,sessionId:A.sessionId,currentStep:A.currentStep}),!0}catch(a){return r==null||r.error("DB   ",a),!1}},validate(){const i=hn({subscribe:n});if(!i)return{isValid:!1,errors:["Store  ."]};try{const{FixedEstimateDBConverter:a}=require("../types/fixedEstimateTypes"),A=a.validateForDB(i);return r==null||r.info("  ",{isValid:A.isValid,errorCount:A.errors.length}),A.isValid||r==null||r.warn("  ",{errors:A.errors}),A}catch(a){return r==null||r.error("  ",a),{isValid:!1,errors:["    ."]}}},backup(){const i=hn({subscribe:n});if(!i)return null;const a={...i,backupTimestamp:Date.now()};return r==null||r.info("  ",{sessionId:i.sessionId,backupTimestamp:a.backupTimestamp}),a},restore(i){if(!i||!i.sessionId)return r==null||r.error("  "),!1;try{const{backupTimestamp:a,...A}=i;return e(A),r==null||r.info("    ",{sessionId:A.sessionId,backupTimestamp:a}),!0}catch(a){return r==null||r.error("  ",a),!1}}}}const ur=pF();async function SB(n,e){const{data:t,error:r}=await ft.from("products").select("process:processes( id, shop_id, name, description, image_url, created_at, updated_at, canvas_json)").eq("id",n).eq("shop",e).single();if(r)throw r;return t!=null&&t.process?t.process:null}async function EB(n){const{data:e,error:t}=await ft.from("process_print_areas").select("*").eq("process_id",n);if(t)throw t;return e||[]}function Ge(n,e,t){return(e=function(r){var o=function(s,i){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var A=a.call(s,i);if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(s)}(r,"string");return typeof o=="symbol"?o:o+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function mw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function We(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?mw(Object(t),!0).forEach(function(r){Ge(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):mw(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Un(n,e){if(n==null)return{};var t,r,o=function(i,a){if(i==null)return{};var A={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(a.indexOf(d)>=0)continue;A[d]=i[d]}return A}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function xA(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}let ww=class{constructor(){Ge(this,"browserShadowBlurConstant",1),Ge(this,"DPI",96),Ge(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),Ge(this,"perfLimitSizeTotal",2097152),Ge(this,"maxCacheSideLimit",4096),Ge(this,"minCacheSideLimit",256),Ge(this,"disableStyleCopyPaste",!1),Ge(this,"enableGLFiltering",!0),Ge(this,"textureSize",4096),Ge(this,"forceGLPutImageData",!1),Ge(this,"cachesBoundsOfCurve",!1),Ge(this,"fontPaths",{}),Ge(this,"NUM_FRACTION_DIGITS",4)}};const Gr=new class extends ww{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=We(We({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new ww,t=(n==null?void 0:n.reduce((r,o)=>(r[o]=e[o],r),{}))||e;this.configure(t)}},wA=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return console[n]("fabric",...t)};let Ni=class extends Error{constructor(e,t){super("fabric: ".concat(e),t)}},gF=class extends Ni{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},vF=class{},mF=class extends vF{testPrecision(e,t){const r="precision ".concat(t,` float;
void main(){}`),o=e.createShader(e.FRAGMENT_SHADER);return!!o&&(e.shaderSource(o,r),e.compileShader(o),!!e.getShaderParameter(o,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(t,r)),t.getExtension("WEBGL_lose_context").loseContext(),wA("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}};const wF={};let yw;const Gi=()=>yw||(yw={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new mF,dispose(){},copyPasteData:wF}),Yd=()=>Gi().document,p1=()=>Gi().window,FB=()=>{var n;return Math.max((n=Gr.devicePixelRatio)!==null&&n!==void 0?n:p1().devicePixelRatio,1)},ou=new class{constructor(){Ge(this,"charWidthsCache",{}),Ge(this,"boundsOfCurveCache",{})}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:r}=n;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const o=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((r+"").toLowerCase());return o[s]||(o[s]={}),o[s]}clearFontCache(n){(n=(n||"").toLowerCase())?this.charWidthsCache[n]&&delete this.charWidthsCache[n]:this.charWidthsCache={}}limitDimsByArea(n){const{perfLimitSizeTotal:e}=Gr,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},Q0="6.5.4";function Df(){}const qu=Math.PI/2,cp=2*Math.PI,g1=Math.PI/180,rs=Object.freeze([1,0,0,1,0,0]),v1=16,Wa=.4477152502,Tr="center",en="left",us="top",T0="bottom",Gn="right",hs="none",m1=/\r?\n/,IB="moving",tg="scaling",UB="rotating",w1="rotate",QB="skewing",zu="resizing",yF="modifyPoly",bF="modifyPath",up="changed",rg="scale",vs="scaleX",Zs="scaleY",Jd="skewX",Zd="skewY",lo="fill",fs="stroke",hp="modified",Zl="json",fv="svg",er=new class{constructor(){this[Zl]=new Map,this[fv]=new Map}has(n){return this[Zl].has(n)}getClass(n){const e=this[Zl].get(n);if(!e)throw new Ni("No class registered for ".concat(n));return e}setClass(n,e){e?this[Zl].set(e,n):(this[Zl].set(n.type,n),this[Zl].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[fv].get(n)}setSVGClass(n,e){this[fv].set(e??n.type.toLowerCase(),n)}},fp=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach(e=>e.abort()),n}cancelByCanvas(n){if(!n)return[];const e=this.filter(t=>{var r;return t.target===n||typeof t.target=="object"&&((r=t.target)===null||r===void 0?void 0:r.canvas)===n});return e.forEach(t=>t.abort()),e}cancelByTarget(n){if(!n)return[];const e=this.filter(t=>t.target===n);return e.forEach(t=>t.abort()),e}};let _F=class{constructor(){Ge(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(r=>{let[o,s]=r;this.on(o,s)}),()=>this.off(e);if(t){const r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(t),()=>this.off(r,t)}return()=>!1}once(e,t){if(typeof e=="object"){const r=[];return Object.entries(e).forEach(o=>{let[s,i]=o;r.push(this.once(s,i))}),()=>r.forEach(o=>o())}if(t){const r=this.on(e,function(){for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];t.call(this,...s),r()});return r}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const r=this.__eventListeners[e],o=r.indexOf(t);o>-1&&r.splice(o,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof e=="object"?Object.entries(e).forEach(r=>{let[o,s]=r;this._removeEventListener(o,s)}):this._removeEventListener(e,t)}fire(e,t){var r;if(!this.__eventListeners)return;const o=(r=this.__eventListeners[e])===null||r===void 0?void 0:r.concat();if(o)for(let s=0;s<o.length;s++)o[s].call(this,t||{})}};const dd=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},Sa=n=>{if(n===0)return 1;switch(Math.abs(n)/qu){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},Ea=n=>{if(n===0)return 0;const e=n/qu,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};let yt=class Vo{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Vo(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Vo(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Vo(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Vo(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Vo(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Vo(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Vo(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Vo(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Vo(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new Vo(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Vo(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new Vo(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:y1;const r=Ea(e),o=Sa(e),s=this.subtract(t);return new Vo(s.x*o-s.y*r,s.x*r+s.y*o).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Vo(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}};const y1=new yt(0,0),Nf=n=>!!n&&Array.isArray(n._objects);function TB(n){class e extends n{constructor(){super(...arguments),Ge(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const i=this._objects.push(...o);return o.forEach(a=>this._onObjectAdded(a)),i}insertAt(r){for(var o=arguments.length,s=new Array(o>1?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return this._objects.splice(r,0,...s),s.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const r=this._objects,o=[];for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return i.forEach(A=>{const d=r.indexOf(A);d!==-1&&(r.splice(d,1),o.push(A),this._onObjectRemoved(A))}),o}forEachObject(r){this.getObjects().forEach((o,s,i)=>r(o,s,i))}getObjects(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return o.length===0?[...this._objects]:this._objects.filter(i=>i.isType(...o))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,o){return!!this._objects.includes(r)||!!o&&this._objects.some(s=>s instanceof e&&s.contains(r,!0))}complexity(){return this._objects.reduce((r,o)=>r+=o.complexity?o.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(dd(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(dd(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,o){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==0){const i=this.findNewLowerIndex(r,s,o);return dd(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,o){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==this._objects.length-1){const i=this.findNewUpperIndex(r,s,o);return dd(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,o){return r!==this._objects[o]&&(dd(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,o,s){let i;if(s){i=o;for(let a=o-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){i=a;break}}else i=o-1;return i}findNewUpperIndex(r,o,s){let i;if(s){i=o;for(let a=o+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){i=a;break}}else i=o+1;return i}collectObjects(r){let{left:o,top:s,width:i,height:a}=r,{includeIntersecting:A=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],c=new yt(o,s),u=c.add(new yt(i,a));for(let h=this._objects.length-1;h>=0;h--){const f=this._objects[h];f.selectable&&f.visible&&(A&&f.intersectsWithRect(c,u)||f.isContainedWithinRect(c,u)||A&&f.containsPoint(c)||A&&f.containsPoint(u))&&d.push(f)}return d}}return e}let LB=class extends _F{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function Mf(n){return p1().requestAnimationFrame(n)}function BF(n){return p1().cancelAnimationFrame(n)}let xF=0;const yA=()=>xF++,bi=()=>{const n=Yd().createElement("canvas");if(!n||n.getContext===void 0)throw new Ni("Failed to create `canvas` element");return n},zF=()=>Yd().createElement("img"),Wi=n=>{const e=bi();return e.width=n.width,e.height=n.height,e},PB=(n,e,t)=>n.toDataURL("image/".concat(e),t),Jn=n=>n*g1,ul=n=>n/g1,CF=n=>n.every((e,t)=>e===rs[t]),ls=(n,e,t)=>new yt(n).transform(e,t),vi=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:r,y:o}=new yt(n[4],n[5]).transform(t,!0);return t[4]=-r,t[5]=-o,t},zo=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],b1=(n,e)=>n.reduceRight((t,r)=>r&&t?zo(r,t,e):r||t,void 0)||rs.concat(),kB=n=>{let[e,t]=n;return Math.atan2(t,e)},pp=n=>{const e=kB(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(t),o=(n[0]*n[3]-n[2]*n[1])/r,s=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:ul(e),scaleX:r,scaleY:o,skewX:ul(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},Ku=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function $u(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=Jn(n),o=Sa(r),s=Ea(r);return[o,s,-s,o,e?e-(o*e-s*t):0,t?t-(s*e+o*t):0]}const _1=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},OB=n=>Math.tan(Jn(n)),DB=n=>[1,0,OB(n),1,0,0],NB=n=>[1,OB(n),0,1,0,0],ng=n=>{let{scaleX:e=1,scaleY:t=1,flipX:r=!1,flipY:o=!1,skewX:s=0,skewY:i=0}=n,a=_1(r?-e:e,o?-t:t);return s&&(a=zo(a,DB(s),!0)),i&&(a=zo(a,NB(i),!0)),a},SF=n=>{const{translateX:e=0,translateY:t=0,angle:r=0}=n;let o=Ku(e,t);r&&(o=zo(o,$u({angle:r})));const s=ng(n);return CF(s)||(o=zo(o,s)),o},Hf=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,o){if(e&&e.aborted)return o(new gF("loadImage"));const s=zF();let i;e&&(i=function(A){s.src="",o(A)},e.addEventListener("abort",i,{once:!0}));const a=function(){s.onload=s.onerror=null,i&&(e==null||e.removeEventListener("abort",i)),r(s)};n?(s.onload=a,s.onerror=function(){i&&(e==null||e.removeEventListener("abort",i)),o(new Ni("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=n):a()})},Cu=function(n){let{signal:e,reviver:t=Df}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,o)=>{const s=[];e&&e.addEventListener("abort",o,{once:!0}),Promise.all(n.map(i=>er.getClass(i.type).fromObject(i,{signal:e}).then(a=>(t(i,a),s.push(a),a)))).then(r).catch(i=>{s.forEach(a=>{a.dispose&&a.dispose()}),o(i)}).finally(()=>{e&&e.removeEventListener("abort",o)})})},og=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,r)=>{const o=[];e&&e.addEventListener("abort",r,{once:!0});const s=Object.values(n).map(a=>a&&a.type&&er.has(a.type)?Cu([a],{signal:e}).then(A=>{let[d]=A;return o.push(d),d}):a),i=Object.keys(n);Promise.all(s).then(a=>a.reduce((A,d,c)=>(A[i[c]]=d,A),{})).then(t).catch(a=>{o.forEach(A=>{A.dispose&&A.dispose()}),r(a)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},ec=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in n&&(e[t]=n[t]),e),{})},B1=(n,e)=>Object.keys(n).reduce((t,r)=>(e(n[r],r,n)&&(t[r]=n[r]),t),{}),bw={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},pv=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),_w=(n,e,t,r)=>{n/=255,e/=255,t/=255;const o=Math.max(n,e,t),s=Math.min(n,e,t);let i,a;const A=(o+s)/2;if(o===s)i=a=0;else{const d=o-s;switch(a=A>.5?d/(2-o-s):d/(o+s),o){case n:i=(e-t)/d+(e<t?6:0);break;case e:i=(t-n)/d+2;break;case t:i=(n-e)/d+4}i/=6}return[Math.round(360*i),Math.round(100*a),Math.round(100*A),r]},Bw=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Lh=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),xw=n=>{let[e,t,r,o=1]=n;const s=Math.round(.3*e+.59*t+.11*r);return[s,s,s,o]};let Ps=class Do{constructor(e){if(Ge(this,"isUnrecognised",!1),e)if(e instanceof Do)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,r,o,s=1]=e;this.setSource([t,r,o,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in bw&&(e=bw[e]),e==="transparent"?[255,255,255,0]:Do.sourceFromHex(e)||Do.sourceFromRgb(e)||Do.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,r]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,r]=_w(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(r,"%)")}toHsla(){const[e,t,r,o]=_w(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(r,"%,").concat(o,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,r,o]=this.getSource();return"".concat(Lh(e)).concat(Lh(t)).concat(Lh(r)).concat(Lh(Math.round(255*o)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(xw(this.getSource())),this}toBlackWhite(e){const[t,,,r]=xw(this.getSource()),o=t<(e||127)?0:255;return this.setSource([o,o,o,r]),this}overlayWith(e){e instanceof Do||(e=new Do(e));const t=this.getSource(),r=e.getSource(),[o,s,i]=t.map((a,A)=>Math.round(.5*a+.5*r[A]));return this.setSource([o,s,i,t[3]]),this}static fromRgb(e){return Do.fromRgba(e)}static fromRgba(e){return new Do(Do.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[r,o,s]=t.slice(1,4).map(i=>{const a=parseFloat(i);return i.endsWith("%")?Math.round(2.55*a):a});return[r,o,s,Bw(t[4])]}}static fromHsl(e){return Do.fromHsla(e)}static fromHsla(e){return new Do(Do.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const r=(Do.parseAngletoDegrees(t[1])%360+360)%360/360,o=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let i,a,A;if(o===0)i=a=A=s;else{const d=s<=.5?s*(o+1):s+o-s*o,c=2*s-d;i=pv(c,d,r+1/3),a=pv(c,d,r),A=pv(c,d,r-1/3)}return[Math.round(255*i),Math.round(255*a),Math.round(255*A),Bw(t[4])]}static fromHex(e){return new Do(Do.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let r;r=t.length<=4?t.split("").map(A=>A+A):t.match(/.{2}/g);const[o,s,i,a=255]=r.map(A=>parseInt(A,16));return[o,s,i,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),r=parseFloat(t);return t.includes("rad")?ul(r):t.includes("turn")?360*r:r}};const Pn=(n,e)=>parseFloat(Number(n).toFixed(e)),Sd=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v1;const t=/\D{0,2}$/.exec(n),r=parseFloat(n),o=Gr.DPI;switch(t==null?void 0:t[0]){case"mm":return r*o/25.4;case"cm":return r*o/2.54;case"in":return r*o;case"pt":return r*o/72;case"pc":return r*o/72*12;case"em":return r*e;default:return r}},EF=n=>{const[e,t]=n.trim().split(" "),[r,o]=(s=e)&&s!==hs?[s.slice(1,4),s.slice(5,8)]:s===hs?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:r,alignY:o}},gp=n=>"matrix("+n.map(e=>Pn(e,Gr.NUM_FRACTION_DIGITS)).join(" ")+")",Su=function(n,e){let t,r,o=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new Ps(e),i=s.getAlpha();t=s.toRgb(),i!==1&&(r=i.toString())}else t="none";return o?"".concat(n,": ").concat(t,"; ").concat(r?"".concat(n,"-opacity: ").concat(r,"; "):""):"".concat(n,'="').concat(t,'" ').concat(r?"".concat(n,'-opacity="').concat(r,'" '):"")},Ws=n=>!!n&&n.toLive!==void 0,zw=n=>!!n&&typeof n.toObject=="function",Cw=n=>!!n&&n.offsetX!==void 0&&"source"in n,qA=n=>!!n&&"multiSelectionStacking"in n;function MB(n){const e=n&&gi(n);let t=0,r=0;if(!n||!e)return{left:t,top:r};let o=n;const s=e.documentElement,i=e.body||{scrollLeft:0,scrollTop:0};for(;o&&(o.parentNode||o.host)&&(o=o.parentNode||o.host,o===e?(t=i.scrollLeft||s.scrollLeft||0,r=i.scrollTop||s.scrollTop||0):(t+=o.scrollLeft||0,r+=o.scrollTop||0),o.nodeType!==1||o.style.position!=="fixed"););return{left:t,top:r}}const gi=n=>n.ownerDocument||null,HB=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},jB=function(n,e,t){let{width:r,height:o}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=o,s>1&&(n.setAttribute("width",(r*s).toString()),n.setAttribute("height",(o*s).toString()),e.scale(s,s))},L0=(n,e)=>{let{width:t,height:r}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),r&&(n.style.height=typeof r=="number"?"".concat(r,"px"):r)};function Sw(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=hs,n}let RB=class{constructor(e){Ge(this,"_originalCanvasStyle",void 0),Ge(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(r=e)&&r.getContext!==void 0?e:e&&Yd().getElementById(e)||bi();var r;if(t.hasAttribute("data-fabric"))throw new Ni("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e;const{el:o}=this.lower;o.classList.remove("lower-canvas"),o.removeAttribute("data-fabric"),o.setAttribute("width","".concat(t)),o.setAttribute("height","".concat(r)),o.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:r,ctx:o}=this.lower;jB(r,o,e,t)}setCSSDimensions(e){L0(this.lower.el,e)}calcOffset(){return function(e){var t;const r=e&&gi(e),o={left:0,top:0};if(!r)return o;const s=((t=HB(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};o.left+=parseInt(s.borderLeftWidth,10)||0,o.top+=parseInt(s.borderTopWidth,10)||0,o.left+=parseInt(s.paddingLeft,10)||0,o.top+=parseInt(s.paddingTop,10)||0;let i={left:0,top:0};const a=r.documentElement;e.getBoundingClientRect!==void 0&&(i=e.getBoundingClientRect());const A=MB(e);return{left:i.left+A.left-(a.clientLeft||0)+o.left,top:i.top+A.top-(a.clientTop||0)+o.top}}(this.lower.el)}dispose(){Gi().dispose(this.lower.el),delete this.lower}};const FF={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...rs]};let x1=class qB extends TB(LB){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return qB.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new RB(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];const s=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(wA("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?FB():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const o=We({width:this.width,height:this.height},e);this.elements.setDimensions(o,this.getRetinaScaling()),this.hasLostContext=!0,this.width=o.width,this.height=o.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const r=e,o=[...this.viewportTransform],s=ls(e,vi(o));o[0]=t,o[3]=t;const i=ls(s,o);o[4]+=r.x-i.x,o[5]+=r.y-i.y,this.setViewportTransform(o)}setZoom(e){this.zoomToPoint(new yt(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new yt(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=Mf(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,r=vi(this.viewportTransform),o=ls({x:0,y:0},r),s=ls({x:e,y:t},r),i=o.min(s),a=o.max(s);return this.vptCoords={tl:i,tr:new yt(a.x,i.y),bl:new yt(i.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(BF(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const r=this.viewportTransform,o=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),o&&(o._set("canvas",this),o.shouldCache(),o._transformDone=!0,o.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,o)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,o=t.length;r<o;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){const r=this["".concat(t,"Color")],o=this["".concat(t,"Image")],s=this.viewportTransform,i=this["".concat(t,"Vpt")];if(!r&&!o)return;const a=Ws(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?r.toLive(e):r,i&&e.transform(...s),a){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const A=r.gradientTransform||r.patternTransform;A&&e.transform(...A)}e.fill(),e.restore()}if(o){e.save();const{skipOffscreen:A}=this;this.skipOffscreen=i,i&&e.transform(...s),o.render(e),this.skipOffscreen=A,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new yt(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new yt(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new yt(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new yt(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new yt(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return ls(this.getCenterPoint(),vi(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Tr,Tr),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const r=this.clipPath,o=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return We(We(We({version:Q0},ec(this,t)),{},{objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,e,t))},this.__serializeBgOverlay(e,t)),o?{clipPath:o}:null)}_toObject(e,t,r){let o;this.includeDefaultValues||(o=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!o),s}__serializeBgOverlay(e,t){const r={},o=this.backgroundImage,s=this.overlayImage,i=this.backgroundColor,a=this.overlayColor;return Ws(i)?i.excludeFromExport||(r.background=i.toObject(t)):i&&(r.background=i),Ws(a)?a.excludeFromExport||(r.overlay=a.toObject(t)):a&&(r.overlay=a),o&&!o.excludeFromExport&&(r.backgroundImage=this._toObject(o,e,t)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,e,t)),r}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const r=t.width||"".concat(this.width),o=t.height||"".concat(this.height),s=Gr.NUM_FRACTION_DIGITS,i=t.viewBox;let a;if(i)a='viewBox="'.concat(i.x," ").concat(i.y," ").concat(i.width," ").concat(i.height,'" ');else if(this.svgViewportTransformation){const A=this.viewportTransform;a='viewBox="'.concat(Pn(-A[4]/A[0],s)," ").concat(Pn(-A[5]/A[3],s)," ").concat(Pn(this.width/A[0],s)," ").concat(Pn(this.height/A[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',o,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",Q0,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(yA()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Ws(t)){const r=this["".concat(e,"Vpt")],o=this.viewportTransform,s={isType:()=>!1,width:this.width/(r?o[0]:1),height:this.height/(r?o[3]:1)};return t.toSVG(s,{additionalTransform:r?gp(o):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},r=Gr.fontPaths;this._objects.forEach(function s(i){e.push(i),Nf(i)&&i._objects.forEach(s)}),e.forEach(s=>{if(!(i=s)||typeof i._renderText!="function")return;var i;const{styles:a,fontFamily:A}=s;!t[A]&&r[A]&&(t[A]=!0,a&&Object.values(a).forEach(d=>{Object.values(d).forEach(c=>{let{fontFamily:u=""}=c;!t[u]&&r[u]&&(t[u]=!0)})}))});const o=Object.keys(t).map(s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(r[s],`');
		}
`)).join("");return o?`	<style type="text/css"><![CDATA[
`.concat(o,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){const o=this[t];o&&!o.excludeFromExport&&o.toSVG&&e.push(o.toSVG(r))}_setSVGBgOverlayColor(e,t){const r=this["".concat(t,"Color")];if(r)if(Ws(r)){const o=r.repeat||"",s=this.width,i=this.height,a=this["".concat(t,"Vpt")]?gp(vi(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(i/2,')" x="').concat(r.offsetX-s/2,'" y="').concat(r.offsetY-i/2,'" width="').concat(o!=="repeat-y"&&o!=="no-repeat"||!Cw(r)?s:r.source.width,'" height="').concat(o!=="repeat-x"&&o!=="no-repeat"||!Cw(r)?i:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Ni("`json` is undefined"));const o=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:i,background:a,overlayImage:A,overlay:d,clipPath:c}=o,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Cu(s,{reviver:t,signal:r}),og({backgroundImage:i,backgroundColor:a,overlayImage:A,overlayColor:d,clipPath:c},{signal:r})]).then(h=>{let[f,g]=h;return this.clear(),this.add(...f),this.set(o),this.set(g),this.renderOnAddRemove=u,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=Wi(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:o=1,enableRetinaScaling:s=!1}=e,i=o*(s?this.getRetinaScaling():1);return PB(this.toCanvasElement(i,e),t,r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:r,left:o,top:s,filter:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,A=(r||this.height)*e,d=this.getZoom(),c=this.width,u=this.height,h=this.skipControlsDrawing,f=d*e,g=this.viewportTransform,m=[f,0,0,f,(g[4]-(o||0))*e,(g[5]-(s||0))*e],y=this.enableRetinaScaling,b=Wi({width:a,height:A}),S=i?this._objects.filter(F=>i(F)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=m,this.width=a,this.height=A,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(b.getContext("2d"),S),this.viewportTransform=g,this.width=c,this.height=u,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=h,b}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),fp.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};Ge(x1,"ownDefaults",FF);const IF=["touchstart","touchmove","touchend"],UF=n=>{const e=MB(n.target),t=function(r){const o=r.changedTouches;return o&&o[0]?o[0]:r}(n);return new yt(t.clientX+e.left,t.clientY+e.top)},P0=n=>IF.includes(n.type)||n.pointerType==="touch",k0=n=>{n.preventDefault(),n.stopPropagation()},xa=n=>{let e=0,t=0,r=0,o=0;for(let s=0,i=n.length;s<i;s++){const{x:a,y:A}=n[s];(a>r||!s)&&(r=a),(a<e||!s)&&(e=a),(A>o||!s)&&(o=A),(A<t||!s)&&(t=A)}return{left:e,top:t,width:r-e,height:o-t}},QF=["translateX","translateY","scaleX","scaleY"],TF=(n,e)=>vp(n,zo(e,n.calcOwnMatrix())),vp=(n,e)=>{const t=pp(e),{translateX:r,translateY:o,scaleX:s,scaleY:i}=t,a=Un(t,QF),A=new yt(r,o);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:s,scaleY:i}),n.setPositionByOrigin(A,Tr,Tr)},LF=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},KB=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),z1=(n,e,t)=>{const r=n/2,o=e/2,s=[new yt(-r,-o),new yt(r,-o),new yt(-r,o),new yt(r,o)].map(a=>a.transform(t)),i=xa(s);return new yt(i.width,i.height)},sg=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:rs;return zo(vi(arguments.length>1&&arguments[1]!==void 0?arguments[1]:rs),n)},Ed=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rs,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rs;return n.transform(sg(e,t))},PF=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rs,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:rs;return n.transform(sg(e,t),!0)},kF=(n,e,t)=>{const r=sg(e,t);return vp(n,zo(r,n.calcOwnMatrix())),r},$B=(n,e)=>{var t;const{transform:{target:r}}=e;(t=r.canvas)===null||t===void 0||t.fire("object:".concat(n),We(We({},e),{},{target:r})),r.fire(n,e)},OF={left:-.5,top:-.5,center:0,bottom:.5,right:.5},so=n=>typeof n=="string"?OF[n]:n-.5,mp="not-allowed";function VB(n){return so(n.originX)===so(Tr)&&so(n.originY)===so(Tr)}function Ew(n){return .5-so(n)}const wi=(n,e)=>n[e],GB=(n,e,t,r)=>({e:n,transform:e,pointer:new yt(t,r)});function WB(n,e){const t=n.getTotalAngle()+ul(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function C1(n,e,t,r,o){var s;let{target:i,corner:a}=n;const A=i.controls[a],d=((s=i.canvas)===null||s===void 0?void 0:s.getZoom())||1,c=i.padding/d,u=function(h,f,g,m){const y=h.getRelativeCenterPoint(),b=g!==void 0&&m!==void 0?h.translateToGivenOrigin(y,Tr,Tr,g,m):new yt(h.left,h.top);return(h.angle?f.rotate(-Jn(h.angle),y):f).subtract(b)}(i,new yt(r,o),e,t);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=A.offsetX,u.y-=A.offsetY,u}const DF=(n,e,t,r)=>{const{target:o,offsetX:s,offsetY:i}=e,a=t-s,A=r-i,d=!wi(o,"lockMovementX")&&o.left!==a,c=!wi(o,"lockMovementY")&&o.top!==A;return d&&o.set(en,a),c&&o.set(us,A),(d||c)&&$B(IB,GB(n,e,t,r)),d||c};class XB{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",o=this.strokeDashArray?this.strokeDashArray.join(" "):hs,s=this.strokeDashOffset?this.strokeDashOffset:"0",i=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",A=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",c=this.visible?"":" visibility: hidden;",u=e?"":this.getSvgFilter(),h=Su(lo,this.fill);return[Su(fs,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",o,"; ","stroke-linecap: ",i,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",A,"; ",h,"fill-rule: ",t,"; ","opacity: ",d,";",u,c].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e?this.calcTransformMatrix():this.calcOwnMatrix(),o='transform="'.concat(gp(r));return"".concat(o).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=o,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:r,withShadow:o,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=o?'style="'.concat(this.getSvgFilter(),'" '):"",A=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=A&&A.absolutePositioned,u=this.stroke,h=this.fill,f=this.shadow,g=[],m=e.indexOf("COMMON_PARTS");let y;A&&(A.clipPathId="CLIPPATH_".concat(yA()),y='<clipPath id="'.concat(A.clipPathId,`" >
`).concat(A.toClipPathSVG(r),`</clipPath>
`)),c&&g.push("<g ",a,this.getSvgCommons(),` >
`),g.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`);const b=[i,d,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[m]=b,Ws(h)&&g.push(h.toSVG(this)),Ws(u)&&g.push(u.toSVG(this)),f&&g.push(f.toSVG(this)),A&&g.push(y),g.push(e.join("")),g.push(`</g>
`),c&&g.push(`</g>
`),r?r(g.join("")):g.join("")}addPaintOrder(){return this.paintFirst!==lo?' paint-order="'.concat(this.paintFirst,'" '):""}}function ig(n){return new RegExp("^("+n.join("|")+")\\b","i")}var Fw;const hl=String.raw(Fw||(Fw=xA(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),NF=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+hl+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+hl+"))?\\s+(.*)"),MF={cx:en,x:en,r:"radius",cy:us,y:us,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},gv="font-size",vv="clip-path";ig(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);ig(["symbol","image","marker","pattern","view","svg"]);const Iw=ig(["symbol","g","a","svg","clipPath","defs"]),HF=new yt(1,0),YB=new yt,JB=(n,e)=>n.rotate(e),O0=(n,e)=>new yt(e).subtract(n),D0=n=>n.distanceFrom(YB),N0=(n,e)=>Math.atan2(su(n,e),RF(n,e)),jF=n=>N0(HF,n),S1=n=>n.eq(YB)?n:n.scalarDivide(D0(n)),ZB=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return S1(new yt(-n.y,n.x).scalarMultiply(e?1:-1))},su=(n,e)=>n.x*e.y-n.y*e.x,RF=(n,e)=>n.x*e.x+n.y*e.y,Uw=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const r=su(e,t),o=su(e,n),s=su(t,n);return r>=0?o>=0&&s<=0:!(o<=0&&s>=0)},Qw="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Tw=new RegExp("(?:\\s|^)"+Qw+Qw+"("+hl+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class za{constructor(e){const t=typeof e=="string"?za.parseShadow(e):e;Object.assign(this,za.ownDefaults,t),this.id=yA()}static parseShadow(e){const t=e.trim(),[,r=0,o=0,s=0]=(Tw.exec(t)||[]).map(i=>parseFloat(i)||0);return{color:(t.replace(Tw,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:o,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=JB(new yt(this.offsetX,this.offsetY),Jn(-e.angle)),r=new Ps(this.color);let o=40,s=40;return e.width&&e.height&&(o=100*Pn((Math.abs(t.x)+this.blur)/e.width,Gr.NUM_FRACTION_DIGITS)+20,s=100*Pn((Math.abs(t.y)+this.blur)/e.height,Gr.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(o,'%" width="').concat(100+2*o,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(Pn(this.blur?this.blur/2:0,Gr.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(Pn(t.x,Gr.NUM_FRACTION_DIGITS),'" dy="').concat(Pn(t.y,Gr.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=za.ownDefaults;return this.includeDefaultValues?e:B1(e,(r,o)=>r!==t[o])}static async fromObject(e){return new this(e)}}Ge(za,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),Ge(za,"type","shadow"),er.setClass(za,"shadow");const Md=(n,e,t)=>Math.max(n,Math.min(e,t)),qF=[us,en,vs,Zs,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Jd,Zd],Ua=[lo,fs,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],KF={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:en,originY:us,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:lo,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},$F=(n,e,t,r)=>-t*Math.cos(n/r*qu)+t+e,VF=()=>!1;class E1{constructor(e){let{startValue:t,byValue:r,duration:o=500,delay:s=0,easing:i=$F,onStart:a=Df,onChange:A=Df,onComplete:d=Df,abort:c=VF,target:u}=e;Ge(this,"_state","pending"),Ge(this,"durationProgress",0),Ge(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=o,this.delay=s,this.easing=i,this._onStart=a,this._onChange=A,this._onComplete=d,this._abort=c,this.target=u,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>Mf(e),this.delay):Mf(e)}tick(e){const t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;const{value:o,valueProgress:s}=this.calculate(r);this.value=Object.freeze(o),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),Mf(this.tick)))}register(){fp.push(this)}unregister(){fp.remove(this)}abort(){this._state="aborted",this.unregister()}}const GF=["startValue","endValue"];class WF extends E1{constructor(e){let{startValue:t=0,endValue:r=100}=e;super(We(We({},Un(e,GF)),{},{startValue:t,byValue:r-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const XF=["startValue","endValue"];class YF extends E1{constructor(e){let{startValue:t=[0],endValue:r=[100]}=e;super(We(We({},Un(e,XF)),{},{startValue:t,byValue:r.map((o,s)=>o-t[s])}))}calculate(e){const t=this.startValue.map((r,o)=>this.easing(e,r,this.byValue[o],this.duration,o));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const JF=["startValue","endValue","easing","onChange","onComplete","abort"],ZF=(n,e,t,r)=>e+t*(1-Math.cos(n/r*qu)),mv=n=>n&&((e,t,r)=>n(new Ps(e).toRgba(),t,r));class eI extends E1{constructor(e){let{startValue:t,endValue:r,easing:o=ZF,onChange:s,onComplete:i,abort:a}=e,A=Un(e,JF);const d=new Ps(t).getSource(),c=new Ps(r).getSource();super(We(We({},A),{},{startValue:d,byValue:c.map((u,h)=>u-d[h]),easing:o,onChange:mv(s),onComplete:mv(i),abort:mv(a)}))}calculate(e){const[t,r,o,s]=this.startValue.map((a,A)=>this.easing(e,a,this.byValue[A],this.duration,A)),i=[...[t,r,o].map(Math.round),Md(0,s,1)];return{value:i,valueProgress:i.map((a,A)=>this.byValue[A]!==0?Math.abs((a-this.startValue[A])/this.byValue[A]):0).find(a=>a!==0)||0}}}function e5(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new YF(n):new WF(n);return e.start(),e}function tI(n){const e=new eI(n);return e.start(),e}class Ln{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(o=>!this.includes(o))),this}static isPointContained(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(o||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(o||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{const s=O0(t,r),i=O0(t,e).divide(s);return o?Math.abs(i.x)===Math.abs(i.y):i.x===i.y&&i.x>=0&&i.x<=1}}static isPointInPolygon(e,t){const r=new yt(e).setX(Math.min(e.x-1,...t.map(s=>s.x)));let o=0;for(let s=0;s<t.length;s++){const i=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,r);if(i.includes(e))return!0;o+=+(i.status==="Intersection")}return o%2==1}static intersectLineLine(e,t,r,o){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],i=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,A=t.y-e.y,d=o.x-r.x,c=o.y-r.y,u=e.x-r.x,h=e.y-r.y,f=d*h-c*u,g=a*h-A*u,m=c*a-d*A;if(m!==0){const y=f/m,b=g/m;return(s||0<=y&&y<=1)&&(i||0<=b&&b<=1)?new Ln("Intersection").append(new yt(e.x+y*a,e.y+y*A)):new Ln}if(f===0||g===0){const y=s||i||Ln.isPointContained(e,r,o)||Ln.isPointContained(t,r,o)||Ln.isPointContained(r,e,t)||Ln.isPointContained(o,e,t);return new Ln(y?"Coincident":void 0)}return new Ln("Parallel")}static intersectSegmentLine(e,t,r,o){return Ln.intersectLineLine(e,t,r,o,!1,!0)}static intersectSegmentSegment(e,t,r,o){return Ln.intersectLineLine(e,t,r,o,!1,!1)}static intersectLinePolygon(e,t,r){let o=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new Ln,i=r.length;for(let a,A,d,c=0;c<i;c++){if(a=r[c],A=r[(c+1)%i],d=Ln.intersectLineLine(e,t,a,A,o,!1),d.status==="Coincident")return d;s.append(...d.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,r){return Ln.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){const r=new Ln,o=e.length,s=[];for(let i=0;i<o;i++){const a=e[i],A=e[(i+1)%o],d=Ln.intersectSegmentPolygon(a,A,t);d.status==="Coincident"?(s.push(d),r.append(a,A)):r.append(...d.points)}return s.length>0&&s.length===e.length?new Ln("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){const o=t.min(r),s=t.max(r),i=new yt(s.x,o.y),a=new yt(o.x,s.y);return Ln.intersectPolygonPolygon(e,[o,i,s,a])}}class rI extends LB{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?ls(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=ls(e,vi(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new yt(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:r,bl:o}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,r,o];if(this.group){const i=this.group.calcTransformMatrix();return s.map(a=>ls(a,i))}return s}intersectsWithRect(e,t){return Ln.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=Ln.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:r,top:o,width:s,height:i}=this.getBoundingRect();return r>=e.x&&r+s<=t.x&&o>=e.y&&o+i<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return Ln.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return xa(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(vs,e),this._set(Zs,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?ul(kB(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||rs.concat()}calcACoords(){const e=$u({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),o=Ku(t,r),s=zo(o,e),i=this._getTransformedDimensions(),a=i.x/2,A=i.y/2;return{tl:ls({x:-a,y:-A},s),tr:ls({x:a,y:-A},s),bl:ls({x:-a,y:A},s),br:ls({x:a,y:A},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,so(this.originX),so(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const r=this.transformMatrixKey(e),o=this.matrixCache;return o&&o.key.every((s,i)=>s===r[i])?o.value:(this.group&&(t=zo(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const r=this.getRelativeCenterPoint(),o={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=SF(o);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new yt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=We({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=t.strokeWidth;let o=r,s=0;this.strokeUniform&&(o=0,s=r);const i=t.width+o,a=t.height+o;let A;return A=t.skewX===0&&t.skewY===0?new yt(i*t.scaleX,a*t.scaleY):z1(i,a,ng(t)),A.scalarAdd(s)}translateToGivenOrigin(e,t,r,o,s){let i=e.x,a=e.y;const A=so(o)-so(t),d=so(s)-so(r);if(A||d){const c=this._getTransformedDimensions();i+=A*c.x,a+=d*c.y}return new yt(i,a)}translateToCenterPoint(e,t,r){if(t===Tr&&r===Tr)return e;const o=this.translateToGivenOrigin(e,t,r,Tr,Tr);return this.angle?o.rotate(Jn(this.angle),e):o}translateToOriginPoint(e,t,r){const o=this.translateToGivenOrigin(e,Tr,Tr,t,r);return this.angle?o.rotate(Jn(this.angle),e):o}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?ls(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new yt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){const o=this.translateToCenterPoint(e,t,r),s=this.translateToOriginPoint(o,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),en,us)}}const nI=["type"],oI=["extraParam"];let ha=class jf extends rI{static getDefaults(){return jf.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){wA("warn","Setting type has no effect",e)}constructor(e){super(),Ge(this,"_cacheContext",null),Object.assign(this,jf.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=bi(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,r=e.height,o=Gr.maxCacheSideLimit,s=Gr.minCacheSideLimit;if(t<=o&&r<=o&&t*r<=Gr.perfLimitSizeTotal)return t<s&&(e.width=s),r<s&&(e.height=s),e;const i=t/r,[a,A]=ou.limitDimsByArea(i),d=Md(s,a,o),c=Md(s,A,o);return t>d&&(e.zoomX/=t/d,e.width=d,e.capped=!0),r>c&&(e.zoomY/=r/c,e.height=c,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,o=t.y*e.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(o+2),zoomX:e.x,zoomY:e.y,x:r,y:o}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:r,height:o,zoomX:s,zoomY:i,x:a,y:A}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=r!==e.width||o!==e.height,c=this.zoomX!==s||this.zoomY!==i;if(!e||!t)return!1;if(d||c){r!==e.width||o!==e.height?(e.width=r,e.height=o):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const u=a/2,h=A/2;return this.cacheTranslationX=Math.round(e.width/2-u)+u,this.cacheTranslationY=Math.round(e.height/2-h)+h,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,i),this.zoomX=s,this.zoomY=i,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new yt(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=pp(this.calcTransformMatrix());return new yt(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==vs&&e!==Zs||(t=this._constrainScale(t)),e===vs&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof za||(t=new za(t));const r=this[e]!==t;return this[e]=t,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:r,cacheTranslationX:o,cacheTranslationY:s}=this,{width:i,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:r,cacheTranslationX:o,cacheTranslationY:s,width:i,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===fs&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,r){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(r,0,0),e.restore()}drawObject(e,t,r){const o=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,r),this.fill=o,this.stroke=s}createClipPathLayer(e,t){const r=Wi(t),o=r.getContext("2d");if(o.translate(t.cacheTranslationX,t.cacheTranslationY),o.scale(t.zoomX,t.zoomY),e._cacheCanvas=r,t.parentClipPaths.forEach(s=>{s.transform(o)}),t.parentClipPaths.push(e),e.absolutePositioned){const s=vi(this.calcTransformMatrix());o.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(o),e.drawObject(o,!0,t),r}_drawClipPath(e,t,r){if(!t)return;t._transformDone=!0;const o=this.createClipPathLayer(t,r);this.drawClipPathOnCache(e,t,o)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,r=this._cacheContext;return!(!t||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,t.width,t.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Ws(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(Ws(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,r=this.canvas,o=this.getCanvasRetinaScaling(),[s,,,i]=(r==null?void 0:r.viewportTransform)||rs,a=s*o,A=i*o,d=t.nonScaling?new yt(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*Gr.browserShadowBlurConstant*(a+A)*(d.x+d.y)/4,e.shadowOffsetX=t.offsetX*a*d.x,e.shadowOffsetY=t.offsetY*A*d.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Ws(t))return{offsetX:0,offsetY:0};const r=t.gradientTransform||t.patternTransform,o=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,o,s):e.transform(1,0,0,1,o,s),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:o,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===fs?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;const o=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),i=o.x/this.scaleX/s,a=o.y/this.scaleY/s,A=Wi({width:Math.ceil(i),height:Math.ceil(a)}),d=A.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(i,0),d.lineTo(i,a),d.lineTo(0,a),d.closePath(),d.translate(i/2,a/2),d.scale(o.zoomX/this.scaleX/s,o.zoomY/this.scaleY/s),this._applyPatternGradientTransform(d,t),d.fillStyle=t.toLive(e),d.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/o.zoomX,s*this.scaleY/o.zoomY),e.strokeStyle=(r=d.createPattern(A,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new yt(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(er.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=KB(this),r=this.group,o=this.shadow,s=Math.abs,i=e.enableRetinaScaling?FB():1,a=(e.multiplier||1)*i,A=e.canvasProvider||(S=>new x1(S,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&LF(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&kF(this,this.getViewportTransform()),this.setCoords();const d=bi(),c=this.getBoundingRect(),u=this.shadow,h=new yt;if(u){const S=u.blur,F=u.nonScaling?new yt(1,1):this.getObjectScaling();h.x=2*Math.round(s(u.offsetX)+S)*s(F.x),h.y=2*Math.round(s(u.offsetY)+S)*s(F.y)}const f=c.width+h.x,g=c.height+h.y;d.width=Math.ceil(f),d.height=Math.ceil(g);const m=A(d);e.format==="jpeg"&&(m.backgroundColor="#fff"),this.setPositionByOrigin(new yt(m.width/2,m.height/2),Tr,Tr);const y=this.canvas;m._objects=[this],this.set("canvas",m),this.setCoords();const b=m.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=o,r&&(this.group=r),this.set(t),this.setCoords(),m._objects=[],m.destroy(),b}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return PB(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:r,originY:o}=this;if(t){const{x:s,y:i}=this.getRelativeCenterPoint();this.originX=Tr,this.originY=Tr,this.left=s,this.top=i}if(this.set("angle",e),t){const{x:s,y:i}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,o);this.left=s,this.top=i,this.originX=r,this.originY=o}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){fp.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Gi().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((r,o)=>{let[s,i]=o;return r[s]=this._animate(s,i,t),r},{})}_animate(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=e.split("."),s=this.constructor.colorProperties.includes(o[o.length-1]),{abort:i,startValue:a,onChange:A,onComplete:d}=r,c=We(We({},r),{},{target:this,startValue:a??o.reduce((u,h)=>u[h],this),endValue:t,abort:i==null?void 0:i.bind(this),onChange:(u,h,f)=>{o.reduce((g,m,y)=>(y===o.length-1&&(g[m]=u),g[m]),this),A&&A(u,h,f)},onComplete:(u,h,f)=>{this.setCoords(),d&&d(u,h,f)}});return s?tI(c):e5(c)}isDescendantOf(e){const{parent:t,group:r}=this;return t===e||r===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),r=e.getAncestors();if(t.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let o,s=0;s<t.length;s++){if(o=t[s],o===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let i=0;i<r.length;i++){if(this===r[i])return{fork:[],otherFork:[e,...r.slice(0,i)],common:[this,...t]};if(o===r[i])return{fork:[this,...t.slice(0,s)],otherFork:[e,...r.slice(0,i)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const r=t.common[0]||this.canvas;if(!r)return;const o=t.fork.pop(),s=t.otherFork.pop(),i=r._objects.indexOf(o),a=r._objects.indexOf(s);return i>-1&&i>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(jf.customProperties,this.constructor.customProperties||[]);let t;const r=Gr.NUM_FRACTION_DIGITS,{clipPath:o,fill:s,stroke:i,shadow:a,strokeDashArray:A,left:d,top:c,originX:u,originY:h,width:f,height:g,strokeWidth:m,strokeLineCap:y,strokeDashOffset:b,strokeLineJoin:S,strokeUniform:F,strokeMiterLimit:k,scaleX:P,scaleY:te,angle:$,flipX:j,flipY:J,opacity:we,visible:D,backgroundColor:N,fillRule:Z,paintFirst:se,globalCompositeOperation:ce,skewX:re,skewY:pe}=this;o&&!o.excludeFromExport&&(t=o.toObject(e.concat("inverted","absolutePositioned")));const V=oe=>Pn(oe,r),K=We(We({},ec(this,e)),{},{type:this.constructor.type,version:Q0,originX:u,originY:h,left:V(d),top:V(c),width:V(f),height:V(g),fill:zw(s)?s.toObject():s,stroke:zw(i)?i.toObject():i,strokeWidth:V(m),strokeDashArray:A&&A.concat(),strokeLineCap:y,strokeDashOffset:b,strokeLineJoin:S,strokeUniform:F,strokeMiterLimit:V(k),scaleX:V(P),scaleY:V(te),angle:V($),flipX:j,flipY:J,opacity:V(we),shadow:a&&a.toObject(),visible:D,backgroundColor:N,fillRule:Z,paintFirst:se,globalCompositeOperation:ce,skewX:V(re),skewY:V(pe)},t?{clipPath:t}:null);return this.includeDefaultValues?K:this._removeDefaultValues(K)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),r=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return B1(e,(o,s)=>{if(s===en||s===us||s==="type")return!0;const i=r[s];return o!==i&&!(Array.isArray(o)&&Array.isArray(i)&&o.length===0&&i.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=Un(e,nI),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:o}=r,s=Un(r,oI);return og(t,s).then(i=>o?(delete i[o],new this(t[o],i)):new this(i))}static fromObject(e,t){return this._fromObject(e,t)}};Ge(ha,"stateProperties",qF),Ge(ha,"cacheProperties",Ua),Ge(ha,"ownDefaults",KF),Ge(ha,"type","FabricObject"),Ge(ha,"colorProperties",[lo,fs,"backgroundColor"]),Ge(ha,"customProperties",[]),er.setClass(ha),er.setClass(ha,"object");const tc=(n,e,t)=>(r,o,s,i)=>{const a=e(r,o,s,i);return a&&$B(n,We(We({},GB(r,o,s,i)),t)),a};function rc(n){return(e,t,r,o)=>{const{target:s,originX:i,originY:a}=t,A=s.getRelativeCenterPoint(),d=s.translateToOriginPoint(A,i,a),c=n(e,t,r,o);return s.setPositionByOrigin(d,t.originX,t.originY),c}}const Lw=tc(zu,rc((n,e,t,r)=>{const o=C1(e,e.originX,e.originY,t,r);if(so(e.originX)===so(Tr)||so(e.originX)===so(Gn)&&o.x<0||so(e.originX)===so(en)&&o.x>0){const{target:s}=e,i=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=VB(e)?2:1,A=s.width,d=Math.abs(o.x*a/s.scaleX)-i;return s.set("width",Math.max(d,1)),A!==s.width}return!1}));function sI(n,e,t,r,o){r=r||{};const s=this.sizeX||r.cornerSize||o.cornerSize,i=this.sizeY||r.cornerSize||o.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:o.transparentCorners,A=a?fs:lo,d=!a&&(r.cornerStrokeColor||o.cornerStrokeColor);let c,u=e,h=t;n.save(),n.fillStyle=r.cornerColor||o.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||o.cornerStrokeColor||"",s>i?(c=s,n.scale(1,i/s),h=t*s/i):i>s?(c=i,n.scale(s/i,1),u=e*i/s):c=s,n.beginPath(),n.arc(u,h,c/2,0,cp,!1),n[A](),d&&n.stroke(),n.restore()}function iI(n,e,t,r,o){r=r||{};const s=this.sizeX||r.cornerSize||o.cornerSize,i=this.sizeY||r.cornerSize||o.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:o.transparentCorners,A=a?fs:lo,d=!a&&(r.cornerStrokeColor||o.cornerStrokeColor),c=s/2,u=i/2;n.save(),n.fillStyle=r.cornerColor||o.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||o.cornerStrokeColor||"",n.translate(e,t);const h=o.getTotalAngle();n.rotate(Jn(h)),n["".concat(A,"Rect")](-c,-u,s,i),d&&n.strokeRect(-c,-u,s,i),n.restore()}class ci{constructor(e){Ge(this,"visible",!0),Ge(this,"actionName",rg),Ge(this,"angle",0),Ge(this,"x",0),Ge(this,"y",0),Ge(this,"offsetX",0),Ge(this,"offsetY",0),Ge(this,"sizeX",0),Ge(this,"sizeY",0),Ge(this,"touchSizeX",0),Ge(this,"touchSizeY",0),Ge(this,"cursorStyle","crosshair"),Ge(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,o){var s;let{tl:i,tr:a,br:A,bl:d}=o;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&Ln.isPointInPolygon(r,[i,a,A,d])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,o;return(r=(o=e._controlsVisibility)===null||o===void 0?void 0:o[t])!==null&&r!==void 0?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,o){return new yt(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,o,s,i){const a=b1([Ku(r,o),$u({angle:e}),_1((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new yt(-.5,-.5).transform(a),tr:new yt(.5,-.5).transform(a),br:new yt(.5,.5).transform(a),bl:new yt(-.5,.5).transform(a)}}render(e,t,r,o,s){((o=o||{}).cornerStyle||s.cornerStyle)==="circle"?sI.call(this,e,t,r,o,s):iI.call(this,e,t,r,o,s)}}const aI=(n,e,t)=>t.lockRotation?mp:e.cursorStyle,AI=tc(UB,rc((n,e,t,r)=>{let{target:o,ex:s,ey:i,theta:a,originX:A,originY:d}=e;const c=o.translateToOriginPoint(o.getRelativeCenterPoint(),A,d);if(wi(o,"lockRotation"))return!1;const u=Math.atan2(i-c.y,s-c.x),h=Math.atan2(r-c.y,t-c.x);let f=ul(h-u+a);if(o.snapAngle&&o.snapAngle>0){const m=o.snapAngle,y=o.snapThreshold||m,b=Math.ceil(f/m)*m,S=Math.floor(f/m)*m;Math.abs(f-S)<y?f=S:Math.abs(f-b)<y&&(f=b)}f<0&&(f=360+f),f%=360;const g=o.angle!==f;return o.angle=f,g}));function t5(n,e){const t=e.canvas,r=n[t.uniScaleKey];return t.uniformScaling&&!r||!t.uniformScaling&&r}function r5(n,e,t){const r=wi(n,"lockScalingX"),o=wi(n,"lockScalingY");if(r&&o||!e&&(r||o)&&t||r&&e==="x"||o&&e==="y")return!0;const{width:s,height:i,strokeWidth:a}=n;return s===0&&a===0&&e!=="y"||i===0&&a===0&&e!=="x"}const lI=["e","se","s","sw","w","nw","n","ne","e"],Vc=(n,e,t)=>{const r=t5(n,t);if(r5(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return mp;const o=WB(t,e);return"".concat(lI[o],"-resize")};function F1(n,e,t,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,i=o.by,a=t5(n,s);let A,d,c,u,h,f;if(r5(s,i,a))return!1;if(e.gestureScale)d=e.scaleX*e.gestureScale,c=e.scaleY*e.gestureScale;else{if(A=C1(e,e.originX,e.originY,t,r),h=i!=="y"?Math.sign(A.x||e.signX||1):1,f=i!=="x"?Math.sign(A.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=f),wi(s,"lockScalingFlip")&&(e.signX!==h||e.signY!==f))return!1;if(u=s._getTransformedDimensions(),a&&!i){const y=Math.abs(A.x)+Math.abs(A.y),{original:b}=e,S=y/(Math.abs(u.x*b.scaleX/s.scaleX)+Math.abs(u.y*b.scaleY/s.scaleY));d=b.scaleX*S,c=b.scaleY*S}else d=Math.abs(A.x*s.scaleX/u.x),c=Math.abs(A.y*s.scaleY/u.y);VB(e)&&(d*=2,c*=2),e.signX!==h&&i!=="y"&&(e.originX=Ew(e.originX),d*=-1,e.signX=h),e.signY!==f&&i!=="x"&&(e.originY=Ew(e.originY),c*=-1,e.signY=f)}const g=s.scaleX,m=s.scaleY;return i?(i==="x"&&s.set(vs,d),i==="y"&&s.set(Zs,c)):(!wi(s,"lockScalingX")&&s.set(vs,d),!wi(s,"lockScalingY")&&s.set(Zs,c)),g!==s.scaleX||m!==s.scaleY}const Ph=tc(tg,rc((n,e,t,r)=>F1(n,e,t,r))),dI=tc(tg,rc((n,e,t,r)=>F1(n,e,t,r,{by:"x"}))),cI=tc(tg,rc((n,e,t,r)=>F1(n,e,t,r,{by:"y"}))),uI=["target","ex","ey","skewingSide"],wv={x:{counterAxis:"y",scale:vs,skew:Jd,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Zs,skew:Zd,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},hI=["ns","nesw","ew","nwse"],fI=(n,e,t)=>{if(e.x!==0&&wi(t,"lockSkewingY")||e.y!==0&&wi(t,"lockSkewingX"))return mp;const r=WB(t,e)%4;return"".concat(hI[r],"-resize")};function n5(n,e,t,r,o){const{target:s}=t,{counterAxis:i,origin:a,lockSkewing:A,skew:d,flip:c}=wv[n];if(wi(s,A))return!1;const{origin:u,flip:h}=wv[i],f=so(t[u])*(s[h]?-1:1),g=-Math.sign(f)*(s[c]?-1:1),m=.5*-((s[d]===0&&C1(t,Tr,Tr,r,o)[n]>0||s[d]>0?1:-1)*g)+.5;return tc(QB,rc((b,S,F,k)=>function(P,te,$){let{target:j,ex:J,ey:we,skewingSide:D}=te,N=Un(te,uI);const{skew:Z}=wv[P],se=$.subtract(new yt(J,we)).divide(new yt(j.scaleX,j.scaleY))[P],ce=j[Z],re=N[Z],pe=Math.tan(Jn(re)),V=P==="y"?j._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:j._getTransformedDimensions({scaleX:1,scaleY:1}).y,K=2*se*D/Math.max(V,1)+pe,oe=ul(Math.atan(K));j.set(Z,oe);const ae=ce!==j[Z];if(ae&&P==="y"){const{skewX:x,scaleX:E}=j,I=j._getTransformedDimensions({skewY:ce}),L=j._getTransformedDimensions(),M=x!==0?I.x/L.x:1;M!==1&&j.set(vs,M*E)}return ae}(n,S,new yt(F,k))))(e,We(We({},t),{},{[a]:m,skewingSide:g}),r,o)}const pI=(n,e,t,r)=>n5("x",n,e,t,r),gI=(n,e,t,r)=>n5("y",n,e,t,r);function ag(n,e){return n[e.canvas.altActionKey]}const kh=(n,e,t)=>{const r=ag(n,t);return e.x===0?r?Jd:Zs:e.y===0?r?Zd:vs:""},gd=(n,e,t)=>ag(n,t)?fI(0,e,t):Vc(n,e,t),Pw=(n,e,t,r)=>ag(n,e.target)?gI(n,e,t,r):dI(n,e,t,r),kw=(n,e,t,r)=>ag(n,e.target)?pI(n,e,t,r):cI(n,e,t,r),o5=()=>({ml:new ci({x:-.5,y:0,cursorStyleHandler:gd,actionHandler:Pw,getActionName:kh}),mr:new ci({x:.5,y:0,cursorStyleHandler:gd,actionHandler:Pw,getActionName:kh}),mb:new ci({x:0,y:.5,cursorStyleHandler:gd,actionHandler:kw,getActionName:kh}),mt:new ci({x:0,y:-.5,cursorStyleHandler:gd,actionHandler:kw,getActionName:kh}),tl:new ci({x:-.5,y:-.5,cursorStyleHandler:Vc,actionHandler:Ph}),tr:new ci({x:.5,y:-.5,cursorStyleHandler:Vc,actionHandler:Ph}),bl:new ci({x:-.5,y:.5,cursorStyleHandler:Vc,actionHandler:Ph}),br:new ci({x:.5,y:.5,cursorStyleHandler:Vc,actionHandler:Ph}),mtr:new ci({x:0,y:-.5,actionHandler:AI,cursorStyleHandler:aI,offsetY:-40,withConnection:!0,actionName:w1})}),vI=()=>({mr:new ci({x:.5,y:0,actionHandler:Lw,cursorStyleHandler:gd,actionName:zu}),ml:new ci({x:-.5,y:0,actionHandler:Lw,cursorStyleHandler:gd,actionName:zu})}),mI=()=>We(We({},o5()),vI());class Eu extends ha{static getDefaults(){return We(We({},super.getDefaults()),Eu.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),Eu.ownDefaults),this.setOptions(e)}static createControls(){return{controls:o5()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,r=t.target,o=t.action;if(this===r&&o&&o.startsWith(rg))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let o=r.length-1;o>=0;o--){const[s,i]=r[o],a=this.controls[s];if(a.shouldActivate(s,this,e,t?i.touchCorner:i.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),r=Ku(t.x,t.y),o=$u({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=zo(r,o),i=zo(e,s),a=zo(i,[1/e[0],0,0,1/e[3],0,0]),A=this.group?pp(this.calcTransformMatrix()):void 0;A&&(A.scaleX=Math.abs(A.scaleX),A.scaleY=Math.abs(A.scaleY));const d=this._calculateCurrentDimensions(A),c={};return this.forEachControl((u,h)=>{const f=u.positionHandler(d,a,this,u);c[h]=Object.assign(f,this._calcCornerCoords(u,f))}),c}_calcCornerCoords(e,t){const r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),o=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/o[0],1/o[3]),e.rotate(Jn(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=We({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=o.borderColor,this._setLineDash(e,o.borderDashArray),this.strokeBorders(e,t),o.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:o}=this,s=We({hasBorders:r,hasControls:o},t),i=this.getViewportTransform(),a=s.hasBorders,A=s.hasControls,d=zo(i,this.calcTransformMatrix()),c=pp(d);e.save(),e.translate(c.translateX,c.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(c.angle-=180),e.rotate(Jn(this.group?c.angle:this.angle)),a&&this.drawBorders(e,c,t),A&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let o;if(r&&r.forActiveSelection||this.group){const s=z1(this.width,this.height,ng(t)),i=this.isStrokeAccountedForInDimensions()?y1:(this.strokeUniform?new yt().scalarAdd(this.canvas?this.canvas.getZoom():1):new yt(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);o=s.add(i).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else o=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,o,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((o,s)=>{o.withConnection&&o.getVisibility(this,s)&&(r=!0,e.moveTo(o.x*t.x,o.y*t.y),e.lineTo(o.x*t.x+o.offsetX,o.y*t.y+o.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:o,cornerDashArray:s,cornerColor:i}=this,a=We({cornerStrokeColor:o,cornerDashArray:s,cornerColor:i},t);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((A,d)=>{if(A.getVisibility(this,d)){const c=this.oCoords[d];A.render(e,c.x,c.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[r,o]=t;return this.setControlVisible(r,o)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);const o=this.width+4,s=this.height+4;return t.clearRect(-o/2,-s/2,o,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function s5(n,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),n}Ge(Eu,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class yo extends Eu{}s5(yo,[XB]),er.setClass(yo),er.setClass(yo,"object");const wI=(n,e,t,r)=>{const o=2*(r=Math.round(r))+1,{data:s}=n.getImageData(e-r,t-r,o,o);for(let i=3;i<s.length;i+=4)if(s[i]>0)return!1;return!0};class i5{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new yt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new yt(1/this.options.scaleX,1/this.options.scaleY):new yt(1,1)}createSideVector(e,t){const r=O0(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new yt(e);return t.y+=t.x*Math.tan(Jn(this.options.skewY)),t.x+=t.y*Math.tan(Jn(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const yI=new yt;class Fd extends i5{static getOrthogonalRotationFactor(e,t){const r=t?N0(e,t):jF(e);return Math.abs(r)<qu?-1:1}constructor(e,t,r,o){super(o),Ge(this,"AB",void 0),Ge(this,"AC",void 0),Ge(this,"alpha",void 0),Ge(this,"bisector",void 0),this.A=new yt(e),this.B=new yt(t),this.C=new yt(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=N0(this.AB,this.AC),this.bisector=S1(JB(this.AB.eq(yI)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(e,t),s=ZB(o),i=Fd.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,r*i)}projectBevel(){const e=[];return(this.alpha%cp==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),r=1/Math.sin(t/2),o=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),s=this.options.strokeUniform?D0(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return D0(o)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(o))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const r=[],o=new yt(Fd.getOrthogonalRotationFactor(this.bisector),Fd.getOrthogonalRotationFactor(new yt(this.bisector.y,this.bisector.x)));return[new yt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o),new yt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o)].forEach(s=>{Uw(s,e,t)&&r.push(this.A.add(s))}),r}projectRoundWithSkew(e,t){const r=[],{skewX:o,skewY:s,scaleX:i,scaleY:a,strokeUniform:A}=this.options,d=new yt(Math.tan(Jn(o)),Math.tan(Jn(s))),c=this.strokeProjectionMagnitude,u=A?c/a/Math.sqrt(1/a**2+1/i**2*d.y**2):c/Math.sqrt(1+d.y**2),h=new yt(Math.sqrt(Math.max(c**2-u**2,0)),u),f=A?c/Math.sqrt(1+d.x**2*(1/a)**2/(1/i+1/i*d.x*d.y)**2):c/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),g=new yt(f,Math.sqrt(Math.max(c**2-f**2,0)));return[g,g.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(m=>this.applySkew(A?m.multiply(this.strokeUniformScalar):m)).forEach(m=>{Uw(m,e,t)&&r.push(this.applySkew(this.A).add(m))}),r}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%cp==0,r=this.applySkew(this.A),o=e[t?0:2].subtract(r),s=e[t?1:0].subtract(r),i=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=su(o,i)>0,A=a?o:s,d=a?s:o;return this.isSkewed()?e.push(...this.projectRoundWithSkew(A,d)):e.push(...this.projectRoundNoSkew(A,d)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Ow extends i5{constructor(e,t,r){super(r),this.A=new yt(e),this.T=new yt(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(e,t);return this.scaleUnitVector(ZB(o),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new yt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new Fd(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new yt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(S1(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),o=this.A.add(r);e.push(o.add(t),o.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const bI=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const o=n.reduce((s,i)=>(s[s.length-1].eq(i)||s.push(new yt(i)),s),[new yt(n[0])]);if(o.length===1)t=!0;else if(!t){const s=o[0],i=((a,A)=>{for(let d=a.length-1;d>=0;d--)if(A(a[d],d,a))return d;return-1})(o,a=>!a.eq(s));o.splice(i+1)}return o.forEach((s,i,a)=>{let A,d;i===0?(d=a[1],A=t?s:a[a.length-1]):i===a.length-1?(A=a[i-1],d=t?s:a[0]):(A=a[i-1],d=a[i+1]),t&&a.length===1?r.push(...new Ow(s,s,e).project()):!t||i!==0&&i!==a.length-1?r.push(...new Fd(s,A,d,e).project()):r.push(...new Ow(s,i===0?d:A,e).project())}),r},I1=n=>{const e={};return Object.keys(n).forEach(t=>{e[t]={},Object.keys(n[t]).forEach(r=>{e[t][r]=We({},n[t][r])})}),e},_I=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),U1=n=>{const e=[];for(let t,r=0;r<n.length;r++)(t=BI(n,r))!==!1&&e.push(t);return e},BI=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const o=n.charCodeAt(e+1);if(56320>o||o>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},Q1=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},xI=(n,e)=>{const t=e.split(`
`),r=[];let o=-1,s={};n=I1(n);for(let i=0;i<t.length;i++){const a=U1(t[i]);if(n[i])for(let A=0;A<a.length;A++){o++;const d=n[i][A];d&&Object.keys(d).length>0&&(Q1(s,d,!0)?r.push({start:o,end:o+1,style:d}):r[r.length-1].end++),s=d||{}}else o+=a.length,s={}}return r},zI=(n,e)=>{if(!Array.isArray(n))return I1(n);const t=e.split(m1),r={};let o=-1,s=0;for(let i=0;i<t.length;i++){const a=U1(t[i]);for(let A=0;A<a.length;A++)o++,n[s]&&n[s].start<=o&&o<n[s].end&&(r[i]=r[i]||{},r[i][A]=We({},n[s].style),o===n[s].end-1&&s++)}return r},zA=["display","transform",lo,"fill-opacity","fill-rule","opacity",fs,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function Dw(n,e){const t=n.nodeName,r=n.getAttribute("class"),o=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let i;if(i=new RegExp("^"+t,"i"),e=e.replace(i,""),o&&e.length&&(i=new RegExp("#"+o+s,"i"),e=e.replace(i,"")),r&&e.length){const a=r.split(" ");for(let A=a.length;A--;)i=new RegExp("\\."+a[A]+s,"i"),e=e.replace(i,"")}return e.length===0}function CI(n,e){let t=!0;const r=Dw(n,e.pop());return r&&e.length&&(t=function(o,s){let i,a=!0;for(;o.parentElement&&o.parentElement.nodeType===1&&s.length;)a&&(i=s.pop()),a=Dw(o=o.parentElement,i);return s.length===0}(n,e)),r&&t&&e.length===0}const SI=n=>{var e;return(e=MF[n])!==null&&e!==void 0?e:n},EI=new RegExp("(".concat(hl,")"),"gi"),FI=n=>n.replace(EI," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Nw,Mw,Hw,jw,Rw,qw,Kw;const es="(".concat(hl,")"),II=String.raw(Nw||(Nw=xA(["(skewX)(",")"],["(skewX)\\(","\\)"])),es),UI=String.raw(Mw||(Mw=xA(["(skewY)(",")"],["(skewY)\\(","\\)"])),es),QI=String.raw(Hw||(Hw=xA(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),es,es,es),TI=String.raw(jw||(jw=xA(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),es,es),LI=String.raw(Rw||(Rw=xA(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),es,es),PI=String.raw(qw||(qw=xA(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),es,es,es,es,es,es),T1="(?:".concat(PI,"|").concat(LI,"|").concat(QI,"|").concat(TI,"|").concat(II,"|").concat(UI,")"),kI="(?:".concat(T1,"*)"),OI=String.raw(Kw||(Kw=xA(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),kI),DI=new RegExp(OI),NI=new RegExp(T1),MI=new RegExp(T1,"g");function M0(n){const e=[];if(!(n=FI(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!DI.test(n))return[...rs];for(const t of n.matchAll(MI)){const r=NI.exec(t[0]);if(!r)continue;let o=rs;const s=r.filter(g=>!!g),[,i,...a]=s,[A,d,c,u,h,f]=a.map(g=>parseFloat(g));switch(i){case"translate":o=Ku(A,d);break;case w1:o=$u({angle:A},{x:d,y:c});break;case rg:o=_1(A,d);break;case Jd:o=DB(A);break;case Zd:o=NB(A);break;case"matrix":o=[A,d,c,u,h,f]}e.push(o)}return b1(e)}function HI(n,e,t,r){const o=Array.isArray(e);let s,i=e;if(n!==lo&&n!==fs||e!==hs){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")i=e===hs?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")i=t&&t.transformMatrix?zo(t.transformMatrix,M0(e)):M0(e);else if(n==="visible")i=e!==hs&&e!=="hidden",t&&t.visible===!1&&(i=!1);else if(n==="opacity")i=parseFloat(e),t&&t.opacity!==void 0&&(i*=t.opacity);else if(n==="textAnchor")i=e==="start"?en:e==="end"?Gn:Tr;else if(n==="charSpacing")s=Sd(e,r)/r*1e3;else if(n==="paintFirst"){const a=e.indexOf(lo),A=e.indexOf(fs);i=lo,(a>-1&&A>-1&&A<a||a===-1&&A>-1)&&(i=fs)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";s=o?e.map(Sd):Sd(e,r)}}else i="";return!o&&isNaN(s)?i:s}function jI(n,e){const t=n.match(NF);if(!t)return;const r=t[1],o=t[3],s=t[4],i=t[5],a=t[6];r&&(e.fontStyle=r),o&&(e.fontWeight=isNaN(parseFloat(o))?o:parseFloat(o)),s&&(e.fontSize=Sd(s)),a&&(e.fontFamily=a),i&&(e.lineHeight=i==="normal"?1:i)}function RI(n,e){n.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[r,o]=t.split(":");e[r.trim().toLowerCase()]=o.trim()})}function qI(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?RI(t,e):function(r,o){Object.entries(r).forEach(s=>{let[i,a]=s;a!==void 0&&(o[i.toLowerCase()]=a)})}(t,e)),e}const KI={stroke:"strokeOpacity",fill:"fillOpacity"};function Qa(n,e,t){if(!n)return{};let r,o={},s=v1;n.parentNode&&Iw.test(n.parentNode.nodeName)&&(o=Qa(n.parentElement,e,t),o.fontSize&&(r=s=Sd(o.fontSize)));const i=We(We(We({},e.reduce((d,c)=>{const u=n.getAttribute(c);return u&&(d[c]=u),d},{})),function(d){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u={};for(const h in c)CI(d,h.split(" "))&&(u=We(We({},u),c[h]));return u}(n,t)),qI(n));i[vv]&&n.setAttribute(vv,i[vv]),i[gv]&&(r=Sd(i[gv],s),i[gv]="".concat(r));const a={};for(const d in i){const c=SI(d),u=HI(c,i[d],o,r);a[c]=u}a&&a.font&&jI(a.font,a);const A=We(We({},o),a);return Iw.test(n.nodeName)?A:function(d){const c=yo.getDefaults();return Object.entries(KI).forEach(u=>{let[h,f]=u;if(d[f]===void 0||d[h]==="")return;if(d[h]===void 0){if(!c[h])return;d[h]=c[h]}if(d[h].indexOf("url(")===0)return;const g=new Ps(d[h]);d[h]=g.setAlpha(Pn(g.getAlpha()*d[f],2)).toRgba()}),d}(A)}const $I=["left","top","width","height","visible"],a5=["rx","ry"];class pi extends yo{static getDefaults(){return We(We({},super.getDefaults()),pi.ownDefaults)}constructor(e){super(),Object.assign(this,pi.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:r}=this,o=-t/2,s=-r/2,i=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,r/2):0,A=i!==0||a!==0;e.beginPath(),e.moveTo(o+i,s),e.lineTo(o+t-i,s),A&&e.bezierCurveTo(o+t-Wa*i,s,o+t,s+Wa*a,o+t,s+a),e.lineTo(o+t,s+r-a),A&&e.bezierCurveTo(o+t,s+r-Wa*a,o+t-Wa*i,s+r,o+t-i,s+r),e.lineTo(o+i,s+r),A&&e.bezierCurveTo(o+Wa*i,s+r,o,s+r-Wa*a,o,s+r-a),e.lineTo(o,s+a),A&&e.bezierCurveTo(o,s+Wa*a,o+Wa*i,s,o+i,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...a5,...e])}_toSVG(){const{width:e,height:t,rx:r,ry:o}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(r,'" ry="').concat(o,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,r){const o=Qa(e,this.ATTRIBUTE_NAMES,r),{left:s=0,top:i=0,width:a=0,height:A=0,visible:d=!0}=o,c=Un(o,$I);return new this(We(We(We({},t),c),{},{left:s,top:i,width:a,height:A,visible:!!(d&&a&&A)}))}}Ge(pi,"type","Rect"),Ge(pi,"cacheProperties",[...Ua,...a5]),Ge(pi,"ownDefaults",{rx:0,ry:0}),Ge(pi,"ATTRIBUTE_NAMES",[...zA,"x","y","rx","ry","width","height"]),er.setClass(pi),er.setSVGClass(pi);const wa="initialization",wp="added",L1="removed",yp="imperative",A5=(n,e)=>{const{strokeUniform:t,strokeWidth:r,width:o,height:s,group:i}=e,a=i&&i!==n?sg(i.calcTransformMatrix(),n.calcTransformMatrix()):null,A=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),d=!e.isStrokeAccountedForInDimensions(),c=t&&d?PF(new yt(r,r),void 0,n.calcTransformMatrix()):y1,u=!t&&d?r:0,h=z1(o+u,s+u,b1([a,e.calcOwnMatrix()],!0)).add(c).scalarDivide(2);return[A.subtract(h),A.add(h)]};class Ag{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:r,strategy:o}=e;return t===wa||t===yp||!!r&&o!==r}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==wa&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:r,target:o}=t;if(r===yp&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:i,width:a,height:A}=xa(e.map(u=>A5(o,u)).reduce((u,h)=>u.concat(h),[])),d=new yt(a,A),c=new yt(s,i).add(d.scalarDivide(2));if(r===wa){const u=this.getInitialSize(t,{size:d,center:c});return{center:c,relativeCorrection:new yt(0,0),size:u}}return{center:c.transform(o.calcOwnMatrix()),size:d}}}Ge(Ag,"type","strategy");class H0 extends Ag{shouldPerformLayout(e){return!0}}Ge(H0,"type","fit-content"),er.setClass(H0);const VI=["strategy"],GI=["target","strategy","bubbles","prevStrategy"],l5="layoutManager";class Fu{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new H0;Ge(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=We(We({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:r}=t;return[hp,IB,zu,UB,tg,QB,up,yF,bF].map(o=>e.on(o,s=>this.performLayout(o===hp?{type:"object_modified",trigger:o,e:s,target:r}:{type:"object_modifying",trigger:o,e:s,target:r})))}subscribe(e,t){this.unsubscribe(e,t);const r=this.attachHandlers(e,t);this._subscriptions.set(e,r)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(r=>r()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:r}=e,{canvas:o}=t;if(r===wa||r===wp?this.subscribeTargets(e):r===L1&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),o&&o.fire("object:layout:before",{target:t,context:e}),r===yp&&e.deep){const s=Un(e,VI);t.forEachObject(i=>i.layoutManager&&i.layoutManager.performLayout(We(We({},s),{},{bubbles:!1,target:i})))}}getLayoutResult(e){const{target:t,strategy:r,type:o}=e,s=r.calcLayoutResult(e,t.getObjects());if(!s)return;const i=o===wa?new yt:t.getRelativeCenterPoint(),{center:a,correction:A=new yt,relativeCorrection:d=new yt}=s,c=i.subtract(a).add(A).transform(o===wa?rs:vi(t.calcOwnMatrix()),!0).add(d);return{result:s,prevCenter:i,nextCenter:a,offset:c}}commitLayout(e,t){const{target:r}=e,{result:{size:o},nextCenter:s}=t;var i,a;r.set({width:o.x,height:o.y}),this.layoutObjects(e,t),e.type===wa?r.set({left:(i=e.x)!==null&&i!==void 0?i:s.x+o.x*so(r.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+o.y*so(r.originY)}):(r.setPositionByOrigin(s,Tr,Tr),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,t){const{target:r}=e;r.forEachObject(o=>{o.group===r&&this.layoutObject(e,t,o)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:o}=t;r.set({left:r.left+o.x,top:r.top+o.y})}onAfterLayout(e,t){const{target:r,strategy:o,bubbles:s,prevStrategy:i}=e,a=Un(e,GI),{canvas:A}=r;r.fire("layout:after",{context:e,result:t}),A&&A.fire("object:layout:after",{context:e,result:t,target:r});const d=r.parent;s&&d!=null&&d.layoutManager&&((a.path||(a.path=[])).push(r),d.layoutManager.performLayout(We(We({},a),{},{target:d}))),r.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(r=>r())),e.clear()}toObject(){return{type:l5,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}er.setClass(Fu,l5);const WI=["type","objects","layoutManager"];class XI extends Fu{performLayout(){}}class il extends TB(yo){static getDefaults(){return We(We({},super.getDefaults()),il.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Ge(this,"_activeObjects",[]),Ge(this,"__objectSelectionTracker",void 0),Ge(this,"__objectSelectionDisposer",void 0),Object.assign(this,il.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(o=>{this.enterGroup(o,!1)}),this.layoutManager=(r=t.layoutManager)!==null&&r!==void 0?r:new Fu,this.layoutManager.performLayout({type:wa,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(wA("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(wA("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,r,o)=>this.canEnterGroup(t)&&o.indexOf(t)===r)}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const o=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...o);return this._onAfterObjectsChange(wp,o),s}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];const s=this._filterObjectsBeforeEnteringGroup(r),i=super.insertAt(e,...s);return this._onAfterObjectsChange(wp,s),i}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(L1,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const r=this[e];return super._set(e,t),e==="canvas"&&r!==t&&(this._objects||[]).forEach(o=>{o._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;const o=this._activeObjects;if(e)o.push(r),this._set("dirty",!0);else if(o.length>0){const s=o.indexOf(r);s>-1&&(o.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&vp(e,zo(vi(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(vp(e,zo(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const e=yo.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,r){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var o;const i=this._objects[s];(o=this.canvas)!==null&&o!==void 0&&o.preserveObjectStacking&&i.group!==this?(e.save(),e.transform(...vi(this.calcTransformMatrix())),i.render(e),e.restore()):i.group===this&&i.render(e)}this._drawClipPath(e,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(We({target:this,type:yp},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const r=this.includeDefaultValues;return this._objects.filter(function(o){return!o.excludeFromExport}).map(function(o){const s=o.includeDefaultValues;o.includeDefaultValues=r;const i=o[e||"toObject"](t);return o.includeDefaultValues=s,i})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return We(We(We({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=pi.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';const o=t.join("");return e?e(o):o}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(e);r&&t.push("		",r);for(let o=0;o<this._objects.length;o++)t.push("		",this._objects[o].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],r=this._createSVGBgRect(e);r&&t.push("	",r);for(let o=0;o<this._objects.length;o++)t.push("	",this._objects[o].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:r,objects:o=[],layoutManager:s}=e,i=Un(e,WI);return Promise.all([Cu(o,t),og(i,t)]).then(a=>{let[A,d]=a;const c=new this(A,We(We(We({},i),d),{},{layoutManager:new XI}));if(s){const u=er.getClass(s.type),h=er.getClass(s.strategy);c.layoutManager=new u(new h)}else c.layoutManager=new Fu;return c.layoutManager.subscribeTargets({type:wa,target:c,targets:c.getObjects()}),c.setCoords(),c})}}Ge(il,"type","Group"),Ge(il,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),er.setClass(il);const YI=(n,e)=>Math.min(e.width/n.width,e.height/n.height),JI=(n,e)=>Math.max(e.width/n.width,e.height/n.height),j0="\\s*,?\\s*",kc="".concat(j0,"(").concat(hl,")"),ZI="".concat(kc).concat(kc).concat(kc).concat(j0,"([01])").concat(j0,"([01])").concat(kc).concat(kc),eU={m:"l",M:"L"},tU=(n,e,t,r,o,s,i,a,A,d,c)=>{const u=Sa(n),h=Ea(n),f=Sa(e),g=Ea(e),m=t*o*f-r*s*g+i,y=r*o*f+t*s*g+a;return["C",d+A*(-t*o*h-r*s*u),c+A*(-r*o*h+t*s*u),m+A*(t*o*g+r*s*f),y+A*(r*o*g-t*s*f),m,y]},$w=(n,e,t,r)=>{const o=Math.atan2(e,n),s=Math.atan2(r,t);return s>=o?s-o:2*Math.PI-(o-s)};function Vw(n,e,t,r,o,s,i,a){let A;if(Gr.cachesBoundsOfCurve&&(A=[...arguments].join(),ou.boundsOfCurveCache[A]))return ou.boundsOfCurveCache[A];const d=Math.sqrt,c=Math.abs,u=[],h=[[0,0],[0,0]];let f=6*n-12*t+6*o,g=-3*n+9*t-9*o+3*i,m=3*t-3*n;for(let k=0;k<2;++k){if(k>0&&(f=6*e-12*r+6*s,g=-3*e+9*r-9*s+3*a,m=3*r-3*e),c(g)<1e-12){if(c(f)<1e-12)continue;const J=-m/f;0<J&&J<1&&u.push(J);continue}const P=f*f-4*m*g;if(P<0)continue;const te=d(P),$=(-f+te)/(2*g);0<$&&$<1&&u.push($);const j=(-f-te)/(2*g);0<j&&j<1&&u.push(j)}let y=u.length;const b=y,S=d5(n,e,t,r,o,s,i,a);for(;y--;){const{x:k,y:P}=S(u[y]);h[0][y]=k,h[1][y]=P}h[0][b]=n,h[1][b]=e,h[0][b+1]=i,h[1][b+1]=a;const F=[new yt(Math.min(...h[0]),Math.min(...h[1])),new yt(Math.max(...h[0]),Math.max(...h[1]))];return Gr.cachesBoundsOfCurve&&(ou.boundsOfCurveCache[A]=F),F}const rU=(n,e,t)=>{let[r,o,s,i,a,A,d,c]=t;const u=((h,f,g,m,y,b,S)=>{if(g===0||m===0)return[];let F=0,k=0,P=0;const te=Math.PI,$=S*g1,j=Ea($),J=Sa($),we=.5*(-J*h-j*f),D=.5*(-J*f+j*h),N=g**2,Z=m**2,se=D**2,ce=we**2,re=N*Z-N*se-Z*ce;let pe=Math.abs(g),V=Math.abs(m);if(re<0){const R=Math.sqrt(1-re/(N*Z));pe*=R,V*=R}else P=(y===b?-1:1)*Math.sqrt(re/(N*se+Z*ce));const K=P*pe*D/V,oe=-P*V*we/pe,ae=J*K-j*oe+.5*h,x=j*K+J*oe+.5*f;let E=$w(1,0,(we-K)/pe,(D-oe)/V),I=$w((we-K)/pe,(D-oe)/V,(-we-K)/pe,(-D-oe)/V);b===0&&I>0?I-=2*te:b===1&&I<0&&(I+=2*te);const L=Math.ceil(Math.abs(I/te*2)),M=[],H=I/L,q=8/3*Math.sin(H/4)*Math.sin(H/4)/Math.sin(H/2);let G=E+H;for(let R=0;R<L;R++)M[R]=tU(E,G,J,j,pe,V,ae,x,q,F,k),F=M[R][5],k=M[R][6],E=G,G+=H;return M})(d-n,c-e,o,s,a,A,i);for(let h=0,f=u.length;h<f;h++)u[h][1]+=n,u[h][2]+=e,u[h][3]+=n,u[h][4]+=e,u[h][5]+=n,u[h][6]+=e;return u},nU=n=>{let e=0,t=0,r=0,o=0;const s=[];let i,a=0,A=0;for(const d of n){const c=[...d];let u;switch(c[0]){case"l":c[1]+=e,c[2]+=t;case"L":e=c[1],t=c[2],u=["L",e,t];break;case"h":c[1]+=e;case"H":e=c[1],u=["L",e,t];break;case"v":c[1]+=t;case"V":t=c[1],u=["L",e,t];break;case"m":c[1]+=e,c[2]+=t;case"M":e=c[1],t=c[2],r=c[1],o=c[2],u=["M",e,t];break;case"c":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t,c[5]+=e,c[6]+=t;case"C":a=c[3],A=c[4],e=c[5],t=c[6],u=["C",c[1],c[2],a,A,e,t];break;case"s":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t;case"S":i==="C"?(a=2*e-a,A=2*t-A):(a=e,A=t),e=c[3],t=c[4],u=["C",a,A,c[1],c[2],e,t],a=u[3],A=u[4];break;case"q":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t;case"Q":a=c[1],A=c[2],e=c[3],t=c[4],u=["Q",a,A,e,t];break;case"t":c[1]+=e,c[2]+=t;case"T":i==="Q"?(a=2*e-a,A=2*t-A):(a=e,A=t),e=c[1],t=c[2],u=["Q",a,A,e,t];break;case"a":c[6]+=e,c[7]+=t;case"A":rU(e,t,c).forEach(h=>s.push(h)),e=c[6],t=c[7];break;case"z":case"Z":e=r,t=o,u=["Z"]}u?(s.push(u),i=u[0]):i=""}return s},bp=(n,e,t,r)=>Math.sqrt((t-n)**2+(r-e)**2),d5=(n,e,t,r,o,s,i,a)=>A=>{const d=A**3,c=(f=>3*f**2*(1-f))(A),u=(f=>3*f*(1-f)**2)(A),h=(f=>(1-f)**3)(A);return new yt(i*d+o*c+t*u+n*h,a*d+s*c+r*u+e*h)},c5=n=>n**2,u5=n=>2*n*(1-n),h5=n=>(1-n)**2,oU=(n,e,t,r,o,s,i,a)=>A=>{const d=c5(A),c=u5(A),u=h5(A),h=3*(u*(t-n)+c*(o-t)+d*(i-o)),f=3*(u*(r-e)+c*(s-r)+d*(a-s));return Math.atan2(f,h)},sU=(n,e,t,r,o,s)=>i=>{const a=c5(i),A=u5(i),d=h5(i);return new yt(o*a+t*A+n*d,s*a+r*A+e*d)},iU=(n,e,t,r,o,s)=>i=>{const a=1-i,A=2*(a*(t-n)+i*(o-t)),d=2*(a*(r-e)+i*(s-r));return Math.atan2(d,A)},Gw=(n,e,t)=>{let r=new yt(e,t),o=0;for(let s=1;s<=100;s+=1){const i=n(s/100);o+=bp(r.x,r.y,i.x,i.y),r=i}return o},aU=(n,e)=>{let t,r=0,o=0,s={x:n.x,y:n.y},i=We({},s),a=.01,A=0;const d=n.iterator,c=n.angleFinder;for(;o<e&&a>1e-4;)i=d(r),A=r,t=bp(s.x,s.y,i.x,i.y),t+o>e?(r-=a,a/=2):(s=i,r+=a,o+=t);return We(We({},i),{},{angle:c(A)})},f5=n=>{let e,t,r=0,o=0,s=0,i=0,a=0;const A=[];for(const d of n){const c={x:o,y:s,command:d[0],length:0};switch(d[0]){case"M":t=c,t.x=i=o=d[1],t.y=a=s=d[2];break;case"L":t=c,t.length=bp(o,s,d[1],d[2]),o=d[1],s=d[2];break;case"C":e=d5(o,s,d[1],d[2],d[3],d[4],d[5],d[6]),t=c,t.iterator=e,t.angleFinder=oU(o,s,d[1],d[2],d[3],d[4],d[5],d[6]),t.length=Gw(e,o,s),o=d[5],s=d[6];break;case"Q":e=sU(o,s,d[1],d[2],d[3],d[4]),t=c,t.iterator=e,t.angleFinder=iU(o,s,d[1],d[2],d[3],d[4]),t.length=Gw(e,o,s),o=d[3],s=d[4];break;case"Z":t=c,t.destX=i,t.destY=a,t.length=bp(o,s,i,a),o=i,s=a}r+=t.length,A.push(t)}return A.push({length:r,x:o,y:s}),A},AU=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:f5(n),r=0;for(;e-t[r].length>0&&r<t.length-2;)e-=t[r].length,r++;const o=t[r],s=e/o.length,i=n[r];switch(o.command){case"M":return{x:o.x,y:o.y,angle:0};case"Z":return We(We({},new yt(o.x,o.y).lerp(new yt(o.destX,o.destY),s)),{},{angle:Math.atan2(o.destY-o.y,o.destX-o.x)});case"L":return We(We({},new yt(o.x,o.y).lerp(new yt(i[1],i[2]),s)),{},{angle:Math.atan2(i[2]-o.y,i[1]-o.x)});case"C":case"Q":return aU(o,e)}},lU=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),Ww=new RegExp(ZI,"g"),dU=new RegExp(hl,"gi"),cU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},uU=n=>{var e;const t=[],r=(e=n.match(lU))!==null&&e!==void 0?e:[];for(const o of r){const s=o[0];if(s==="z"||s==="Z"){t.push([s]);continue}const i=cU[s.toLowerCase()];let a=[];if(s==="a"||s==="A"){Ww.lastIndex=0;for(let A=null;A=Ww.exec(o);)a.push(...A.slice(1))}else a=o.match(dU)||[];for(let A=0;A<a.length;A+=i){const d=new Array(i),c=eU[s];d[0]=A>0&&c?c:s;for(let u=0;u<i;u++)d[u+1]=parseFloat(a[A+u]);t.push(d)}}return t},hU=(n,e)=>n.map(t=>t.map((r,o)=>o===0||e===void 0?r:Pn(r,e)).join(" ")).join(" ");function R0(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(r=>{let[o,s]=r;return t.setProperty(o,s)}))}class fU extends RB{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),Ge(this,"upper",void 0),Ge(this,"container",void 0);const{el:o}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(o,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const i=this.createContainerElement();i.classList.add(r),o.parentNode&&o.parentNode.replaceChild(i,o),i.append(o,s),this.container=i}createUpperCanvas(){const{el:e}=this.lower,t=bi();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Yd().createElement("div");return e.setAttribute("data-fabric","wrapper"),R0(e,{position:"relative"}),Sw(e),e}applyCanvasStyle(e,t){const{styles:r,allowTouchScrolling:o}=t;R0(e,We(We({},r),{},{"touch-action":o?"manipulation":hs})),Sw(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:r,ctx:o}=this.upper;jB(r,o,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),L0(this.upper.el,e),L0(this.container,e)}cleanupDOM(e){const t=this.container,{el:r}=this.lower,{el:o}=this.upper;super.cleanupDOM(e),t.removeChild(o),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),Gi().dispose(this.upper.el),delete this.upper,delete this.container}}class lg extends x1{constructor(){super(...arguments),Ge(this,"targets",[]),Ge(this,"_hoveredTargets",[]),Ge(this,"_objectsToRender",void 0),Ge(this,"_currentTransform",null),Ge(this,"_groupSelector",null),Ge(this,"contextTopDirty",!1)}static getDefaults(){return We(We({},super.getDefaults()),lg.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new fU(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){const o=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+o,-r+o),s.transform(...this.viewportTransform);const i=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=i,s.restore();const a=Math.round(o*this.getRetinaScaling());return wI(s,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(r=>!!r&&e[r]===!0):e[t])}_shouldClearSelection(e,t){const r=this.getActiveObjects(),o=this._activeObject;return!!(!t||t&&o&&r.length>1&&r.indexOf(t)===-1&&o!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&o&&o!==t)}_shouldCenterTransform(e,t,r){if(!e)return;let o;return t===rg||t===vs||t===Zs||t===zu?o=this.centeredScaling||e.centeredScaling:t===w1&&(o=this.centeredRotation||e.centeredRotation),o?!r:r}_getOriginFromCorner(e,t){const r={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?r.x=Gn:["mr","tr","br"].includes(t)&&(r.x=en),["tl","mt","tr"].includes(t)?r.y=T0:["bl","mb","br"].includes(t)&&(r.y=us)),r}_setupCurrentTransform(e,t,r){var o;const s=t.group?Ed(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:i="",control:a}=t.getActiveControl()||{},A=r&&a?(o=a.getActionHandler(e,t,a))===null||o===void 0?void 0:o.bind(a):DF,d=((f,g,m,y)=>{if(!g||!f)return"drag";const b=y.controls[g];return b.getActionName(m,b,y)})(r,i,e,t),c=e[this.centeredKey],u=this._shouldCenterTransform(t,d,c)?{x:Tr,y:Tr}:this._getOriginFromCorner(t,i),h={target:t,action:d,actionHandler:A,actionPerformed:!1,corner:i,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:u.x,originY:u.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:Jn(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:c,original:We(We({},KB(t)),{},{originX:u.x,originY:u.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:r,deltaX:o,deltaY:s}=this._groupSelector,i=new yt(t,r).transform(this.viewportTransform),a=new yt(t+o,r+s).transform(this.viewportTransform),A=this.selectionLineWidth/2;let d=Math.min(i.x,a.x),c=Math.min(i.y,a.y),u=Math.max(i.x,a.x),h=Math.max(i.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(d,c,u-d,h-c)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,d+=A,c+=A,u-=A,h-=A,yo.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(d,c,u-d,h-c))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),r=this._activeObject,o=this.getActiveObjects();if(this.targets=[],r&&o.length>=1){if(r.findControl(t,P0(e))||o.length>1&&this.searchPossibleTargets([r],t))return r;if(r===this.searchPossibleTargets([r],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const i=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&i&&i!==r?(this.targets=s,r):i}return r}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords();const o=this.getZoom(),s=e.padding/o;if(s){const[i,a,A,d]=r,c=Math.atan2(a.y-i.y,a.x-i.x),u=Sa(c)*s,h=Ea(c)*s,f=u+h,g=u-h;r=[new yt(i.x-g,i.y-f),new yt(a.x+f,a.y-g),new yt(A.x+g,A.y+f),new yt(d.x-f,d.y+g)]}return Ln.isPointInPolygon(t,r)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,Ed(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let r=e.length;for(;r--;){const o=e[r];if(this._checkTarget(o,t)){if(Nf(o)&&o.subTargetCheck){const s=this._searchPossibleTargets(o._objects,t);s&&this.targets.push(s)}return o}}}searchPossibleTargets(e,t){const r=this._searchPossibleTargets(e,t);if(r&&Nf(r)&&r.interactive&&this.targets[0]){const o=this.targets;for(let s=o.length-1;s>0;s--){const i=o[s];if(!Nf(i)||!i.interactive)return i}return o[0]}return r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,o=r.getBoundingClientRect();let s=UF(e),i=o.width||0,a=o.height||0;i&&a||(us in o&&T0 in o&&(a=Math.abs(o.top-o.bottom)),Gn in o&&en in o&&(i=Math.abs(o.right-o.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=Ed(s,void 0,this.viewportTransform));const A=this.getRetinaScaling();A!==1&&(s.x/=A,s.y/=A);const d=i===0||a===0?new yt(1,1):new yt(r.width/i,r.height/a);return s.multiply(d)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=bi(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return qA(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let r=!1,o=!1;const s=this.getActiveObjects(),i=[],a=[];e.forEach(A=>{s.includes(A)||(r=!0,A.fire("deselected",{e:t,target:A}),a.push(A))}),s.forEach(A=>{e.includes(A)||(r=!0,A.fire("selected",{e:t,target:A}),i.push(A))}),e.length>0&&s.length>0?(o=!0,r&&this.fire("selection:updated",{e:t,selected:i,deselected:a})):s.length>0?(o=!0,this.fire("selection:created",{e:t,selected:i})):e.length>0&&(o=!0,this.fire("selection:cleared",{e:t,deselected:a})),o&&(this._objectsToRender=void 0)}setActiveObject(e,t){const r=this.getActiveObjects(),o=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),o}_setActiveObject(e,t){const r=this._activeObject;return r!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,qA(e)&&r!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const r=this._activeObject;return!!r&&!r.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),qA(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[r]});const o=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),o}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,r=t.target,o={e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",o),r.fire(hp,o))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;qA(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){const o=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,r);return e.set(o),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&qA(t)&&this._activeObject===t){const r=ec(e,["angle","flipX","flipY",en,vs,Zs,Jd,Zd,us]);return TF(e,t.calcOwnMatrix()),r}return{}}_setSVGObject(e,t,r){const o=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(o)}}Ge(lg,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class pU{constructor(e){Ge(this,"targets",[]),Ge(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:o}=e.getActiveObject()||{};o&&o.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),dd(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const gU=["target","oldTarget","fireCanvas","e"],Ss={passive:!1},ed=(n,e)=>{const t=n.getViewportPoint(e),r=n.getScenePoint(e);return{viewportPoint:t,scenePoint:r,pointer:t,absolutePointer:r}},Xa=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.addEventListener(...t)},$s=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.removeEventListener(...t)},vU={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class q0 extends lg{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),Ge(this,"_isClick",void 0),Ge(this,"textEditingManager",new pU(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove(Xa,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const r=this.upperCanvasEl,o=this._getEventPrefix();e(HB(r),"resize",this._onResize),e(r,o+"down",this._onMouseDown),e(r,"".concat(o,"move"),this._onMouseMove,Ss),e(r,"".concat(o,"out"),this._onMouseOut),e(r,"".concat(o,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel),e(r,"contextmenu",this._onContextMenu),e(r,"dblclick",this._onDoubleClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,Ss)}removeListeners(){this.addOrRemove($s,"remove");const e=this._getEventPrefix(),t=gi(this.upperCanvasEl);$s(t,"".concat(e,"up"),this._onMouseUp),$s(t,"touchend",this._onTouchEnd,Ss),$s(t,"".concat(e,"move"),this._onMouseMove,Ss),$s(t,"touchmove",this._onMouseMove,Ss),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,r=We({e},ed(this,e));this.fire("mouse:out",We(We({},r),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",We({},r)),this._hoveredTargets.forEach(o=>{this.fire("mouse:out",We(We({},r),{},{target:o})),o&&o.fire("mouseout",We({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",We({e},ed(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const r={e,target:t};return this.fire("dragstart",r),t.fire("dragstart",r),void Xa(this.upperCanvasEl,"drag",this._onDragProgress)}k0(e)}_renderDragEffects(e,t,r){let o=!1;const s=this._dropTarget;s&&s!==t&&s!==r&&(s.clearContextTop(),o=!0),t==null||t.clearContextTop(),r!==t&&(r==null||r.clearContextTop());const i=this.contextTop;i.save(),i.transform(...this.viewportTransform),t&&(i.save(),t.transform(i),t.renderDragSourceEffect(e),i.restore(),o=!0),r&&(i.save(),r.transform(i),r.renderDropTargetEffect(e),i.restore(),o=!0),i.restore(),o&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==hs,r=t?this._activeObject:void 0,o={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:r};$s(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",o),this._dragSource&&this._dragSource.fire("dragend",o),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:r,targets:o}=this.findDragTargets(e),s=this._dragSource,i={e,target:r,subTargets:o,dragSource:s,canDrop:!1,dropTarget:void 0};let a;this.fire(t,i),this._fireEnterLeaveEvents(r,i),r&&(r.canDrop(e)&&(a=r),r.fire(t,i));for(let A=0;A<o.length;A++){const d=o[A];d.canDrop(e)&&(a=d),d.fire(t,i)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:r}=this.findDragTargets(e),o={e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",o),this._fireEnterLeaveEvents(t,o)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:r}=this.findDragTargets(e),o=this._basicEventHandler("drop:before",We({e,target:t,subTargets:r,dragSource:this._dragSource},ed(this,e)));o.didDrop=!1,o.dropTarget=void 0,this._basicEventHandler("drop",o),this.fire("drop:after",o)}_onContextMenu(e){const t=this.findTarget(e),r=this.targets||[],o=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:r});return this.stopContextMenu&&k0(e),this._basicEventHandler("contextmenu",o),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||r&&this._target===r)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const o=this.upperCanvasEl,s=this._getEventPrefix(),i=gi(o);Xa(i,"touchend",this._onTouchEnd,Ss),t&&Xa(i,"touchmove",this._onMouseMove,Ss),$s(o,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();$s(t,"".concat(r,"move"),this._onMouseMove,Ss);const o=gi(t);Xa(o,"".concat(r,"up"),this._onMouseUp),Xa(o,"".concat(r,"move"),this._onMouseMove,Ss)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),r=gi(this.upperCanvasEl);$s(r,"touchend",this._onTouchEnd,Ss),$s(r,"touchmove",this._onMouseMove,Ss),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{Xa(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){const o=gi(this.upperCanvasEl);$s(o,"".concat(r,"up"),this._onMouseUp),$s(o,"".concat(r,"move"),this._onMouseMove,Ss),Xa(t,"".concat(r,"move"),this._onMouseMove,Ss)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const r=this._currentTransform,o=this._isClick,s=this._target,{button:i}=e;if(i)return(this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,A,d=!1;if(r&&(this._finalizeCurrentTransform(e),d=r.actionPerformed),!o){const c=s===this._activeObject;this.handleSelection(e),d||(d=this._shouldRender(s)||!c&&s===this._activeObject)}if(s){const c=s.findControl(this.getViewportPoint(e),P0(e)),{key:u,control:h}=c||{};if(A=u,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),d=!0;else if(h){const f=h.getMouseUpHandler(e,s,h);f&&(a=this.getScenePoint(e),f.call(h,e,r,a.x,a.y))}s.isMoving=!1}if(r&&(r.target!==s||r.corner!==A)){const c=r.target&&r.target.controls[r.corner],u=c&&c.getMouseUpHandler(e,r.target,c);a=a||this.getScenePoint(e),u&&u.call(c,e,r,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),d?this.requestRenderAll():o||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:r,subTargets:o=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let s=0;s<o.length;s++)o[s]!==r&&o[s].fire(e,t);return t}_handleEvent(e,t){const r=this._target,o=this.targets||[],s=We(We({e,target:r,subTargets:o},ed(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),s),r&&r.fire("mouse".concat(t),s);for(let i=0;i<o.length;i++)o[i]!==r&&o[i].fire("mouse".concat(t),s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let o=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,o=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const i=this.getScenePoint(e);this._groupSelector={x:i.x,y:i.y,deltaY:0,deltaX:0}}if(t){const i=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),P0(e));if(t===this._activeObject&&(a||!s)){this._setupCurrentTransform(e,t,i);const A=a?a.control:void 0,d=this.getScenePoint(e),c=A&&A.getMouseDownHandler(e,t,A);c&&c.call(A,e,this._currentTransform,d.x,d.y)}}o&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),o&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=Ed(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const r=this.findTarget(e);this._setCursorFromEvent(e,r),this._fireOverOutEvents(e,r)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const r=this._hoveredTarget,o=this._hoveredTargets,s=this.targets,i=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:r,fireCanvas:!0});for(let a=0;a<i;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:o[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const r=this._draggedoverTarget,o=this._hoveredTargets,s=this.targets,i=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("drag",We(We({},t),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let a=0;a<i;a++)this.fireSyntheticInOutEvents("drag",We(We({},t),{},{target:s[a],oldTarget:o[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:o,fireCanvas:s,e:i}=t,a=Un(t,gU);const{targetIn:A,targetOut:d,canvasIn:c,canvasOut:u}=vU[e],h=o!==r;if(o&&h){const f=We(We({},a),{},{e:i,target:o,nextTarget:r},ed(this,i));s&&this.fire(u,f),o.fire(d,f)}if(r&&h){const f=We(We({},a),{},{e:i,target:r,previousTarget:o},ed(this,i));s&&this.fire(c,f),r.fire(A,f)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),r=this._currentTransform,o=r.target,s=o.group?Ed(t,void 0,o.group.calcTransformMatrix()):t;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,s),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){const{action:o,actionHandler:s,target:i}=t,a=!!s&&s(e,t,r.x,r.y);a&&i.setCoords(),o==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let r=t.hoverCursor||this.hoverCursor;const o=qA(this._activeObject)?this._activeObject:null,s=(!o||t.group!==o)&&t.findControl(this.getViewportPoint(e));if(s){const i=s.control;this.setCursor(i.cursorStyleHandler(e,i,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(i=>{r=i.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,t){const r=this._activeObject,o=qA(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||o)&&(o||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e})&&!r.getActiveControl()){if(o){const s=r.getObjects();if(t===r){const i=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,i)||this.searchPossibleTargets(this._objects,i))||!t.selectable)return!1}t.group===r?(r.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(t),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{r.isEditing&&r.exitEditing();const s=new(er.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(r,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:r,deltaX:o,deltaY:s}=this._groupSelector,i=new yt(t,r),a=i.add(new yt(o,s)),A=i.min(a),d=i.max(a).subtract(A),c=this.collectObjects({left:A.x,top:A.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),u=i.eq(a)?c[0]?[c[0]]:[]:c.length>1?c.filter(h=>!h.onSelect({e})).reverse():c;if(u.length===1)this.setActiveObject(u[0],e);else if(u.length>1){const h=er.getClass("ActiveSelection");this.setActiveObject(new h(u,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const p5={x1:0,y1:0,x2:0,y2:0},mU=We(We({},p5),{},{r1:0,r2:0}),vd=(n,e)=>isNaN(n)&&typeof e=="number"?e:n,wU=/^(\d+\.\d+)%|(\d+)%$/;function g5(n){return n&&wU.test(n)}function v5(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(g5(n)?100:1):NaN;return Md(0,vd(t,e),1)}const yU=/\s*;\s*/,bU=/\s*:\s*/;function _U(n,e){let t,r;const o=n.getAttribute("style");if(o){const i=o.split(yU);i[i.length-1]===""&&i.pop();for(let a=i.length;a--;){const[A,d]=i[a].split(bU).map(c=>c.trim());A==="stop-color"?t=d:A==="stop-opacity"&&(r=d)}}const s=new Ps(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:v5(n.getAttribute("offset"),0),color:s.toRgb(),opacity:vd(parseFloat(r||n.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function BU(n,e){const t=[],r=n.getElementsByTagName("stop"),o=v5(e,1);for(let s=r.length;s--;)t.push(_U(r[s],o));return t}function m5(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function w5(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function ii(n,e){return n.getAttribute(e)}function xU(n,e){return function(t,r){let o,{width:s,height:i,gradientUnits:a}=r;return Object.keys(t).reduce((A,d)=>{const c=t[d];return c==="Infinity"?o=1:c==="-Infinity"?o=0:(o=typeof c=="string"?parseFloat(c):c,typeof c=="string"&&g5(c)&&(o*=.01,a==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(o*=s),d!=="y1"&&d!=="y2"||(o*=i)))),A[d]=o,A},{})}(m5(n)==="linear"?function(t){return{x1:ii(t,"x1")||0,y1:ii(t,"y1")||0,x2:ii(t,"x2")||"100%",y2:ii(t,"y2")||0}}(n):function(t){return{x1:ii(t,"fx")||ii(t,"cx")||"50%",y1:ii(t,"fy")||ii(t,"cy")||"50%",r1:0,x2:ii(t,"cx")||"50%",y2:ii(t,"cy")||"50%",r2:ii(t,"r")||"50%"}}(n),We(We({},e),{},{gradientUnits:w5(n)}))}class Oh{constructor(e){const{type:t="linear",gradientUnits:r="pixels",coords:o={},colorStops:s=[],offsetX:i=0,offsetY:a=0,gradientTransform:A,id:d}=e||{};Object.assign(this,{type:t,gradientUnits:r,coords:We(We({},t==="radial"?mU:p5),o),colorStops:s,offsetX:i,offsetY:a,gradientTransform:A,id:d?"".concat(d,"_").concat(yA()):yA()})}addColorStop(e){for(const t in e){const r=new Ps(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return We(We({},ec(this,e)),{},{type:this.type,coords:We({},this.coords),colorStops:this.colorStops.map(t=>We({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],o=this.gradientTransform?this.gradientTransform.concat():rs.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",i=this.colorStops.map(u=>We({},u)).sort((u,h)=>u.offset-h.offset);let a=-this.offsetX,A=-this.offsetY;var d;s==="objectBoundingBox"?(a/=e.width,A/=e.height):(a+=e.width/2,A+=e.height/2),(d=e)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,A-=e.pathOffset.y),o[4]-=a,o[5]-=A;const c=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(gp(o),'"'),""].join(" ");if(this.type==="linear"){const{x1:u,y1:h,x2:f,y2:g}=this.coords;r.push("<linearGradient ",c,' x1="',u,'" y1="',h,'" x2="',f,'" y2="',g,`">
`)}else if(this.type==="radial"){const{x1:u,y1:h,x2:f,y2:g,r1:m,r2:y}=this.coords,b=m>y;r.push("<radialGradient ",c,' cx="',b?u:f,'" cy="',b?h:g,'" r="',b?m:y,'" fx="',b?f:u,'" fy="',b?g:h,`">
`),b&&(i.reverse(),i.forEach(F=>{F.offset=1-F.offset}));const S=Math.min(m,y);if(S>0){const F=S/Math.max(m,y);i.forEach(k=>{k.offset+=F*(1-k.offset)})}}return i.forEach(u=>{let{color:h,offset:f,opacity:g}=u;r.push("<stop ",'offset="',100*f+"%",'" style="stop-color:',h,g!==void 0?";stop-opacity: "+g:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(e){const{x1:t,y1:r,x2:o,y2:s,r1:i,r2:a}=this.coords,A=this.type==="linear"?e.createLinearGradient(t,r,o,s):e.createRadialGradient(t,r,i,o,s,a);return this.colorStops.forEach(d=>{let{color:c,opacity:u,offset:h}=d;A.addColorStop(h,u!==void 0?new Ps(c).setAlpha(u).toRgba():c)}),A}static async fromObject(e){const{colorStops:t,gradientTransform:r}=e;return new this(We(We({},e),{},{colorStops:t?t.map(o=>We({},o)):void 0,gradientTransform:r?[...r]:void 0}))}static fromElement(e,t,r){const o=w5(e),s=t._findCenterFromElement();return new this(We({id:e.getAttribute("id")||void 0,type:m5(e),coords:xU(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:BU(e,r.opacity),gradientUnits:o,gradientTransform:M0(e.getAttribute("gradientTransform")||"")},o==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}Ge(Oh,"type","Gradient"),er.setClass(Oh,"gradient"),er.setClass(Oh,"linear"),er.setClass(Oh,"radial");const zU=["type","source","patternTransform"];class yv{get type(){return"pattern"}set type(e){wA("warn","Setting type has no effect",e)}constructor(e){Ge(this,"repeat","repeat"),Ge(this,"offsetX",0),Ge(this,"offsetY",0),Ge(this,"crossOrigin",""),this.id=yA(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:r}=this;return We(We({},ec(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:Pn(this.offsetX,Gr.NUM_FRACTION_DIGITS),offsetY:Pn(this.offsetY,Gr.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:r}=e;const{source:o,repeat:s,id:i}=this,a=vd(this.offsetX/t,0),A=vd(this.offsetY/r,0),d=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):vd(o.width/t,0),c=s==="repeat-x"||s==="no-repeat"?1+Math.abs(A||0):vd(o.height/r,0);return['<pattern id="SVGID_'.concat(i,'" x="').concat(a,'" y="').concat(A,'" width="').concat(d,'" height="').concat(c,'">'),'<image x="0" y="0" width="'.concat(o.width,'" height="').concat(o.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:r,source:o,patternTransform:s}=e,i=Un(e,zU);const a=await Hf(o,We(We({},t),{},{crossOrigin:i.crossOrigin}));return new this(We(We({},i),{},{patternTransform:s&&s.slice(0),source:a}))}}Ge(yv,"type","Pattern"),er.setClass(yv),er.setClass(yv,"pattern");const CU=["path","left","top"],SU=["d"];class KA extends yo{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:o,top:s}=t,i=Un(t,CU);super(),Object.assign(this,KA.ownDefaults),this.setOptions(i),this._setPath(e||[],!0),typeof o=="number"&&this.set(en,o),typeof s=="number"&&this.set(us,s)}_setPath(e,t){this.path=nU(Array.isArray(e)?e:uU(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new yt(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(const o of this.path)switch(o[0]){case"L":e.lineTo(o[1]+t,o[2]+r);break;case"M":e.moveTo(o[1]+t,o[2]+r);break;case"C":e.bezierCurveTo(o[1]+t,o[2]+r,o[3]+t,o[4]+r,o[5]+t,o[6]+r);break;case"Q":e.quadraticCurveTo(o[1]+t,o[2]+r,o[3]+t,o[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return We(We({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=hU(this.path,Gr.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=Gr.NUM_FRACTION_DIGITS;return" translate(".concat(Pn(-this.pathOffset.x,e),", ").concat(Pn(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:r,pathOffset:o}=this._calcDimensions();this.set({width:t,height:r,pathOffset:o}),e&&this.setPositionByOrigin(o,Tr,Tr)}_calcBoundsFromPath(){const e=[];let t=0,r=0,o=0,s=0;for(const i of this.path)switch(i[0]){case"L":o=i[1],s=i[2],e.push({x:t,y:r},{x:o,y:s});break;case"M":o=i[1],s=i[2],t=o,r=s;break;case"C":e.push(...Vw(o,s,i[1],i[2],i[3],i[4],i[5],i[6])),o=i[5],s=i[6];break;case"Q":e.push(...Vw(o,s,i[1],i[2],i[1],i[2],i[3],i[4])),o=i[3],s=i[4];break;case"Z":o=t,s=r}return xa(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return We(We({},e),{},{pathOffset:new yt(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){const o=Qa(e,this.ATTRIBUTE_NAMES,r),{d:s}=o;return new this(s,We(We(We({},Un(o,SU)),t),{},{left:void 0,top:void 0}))}}Ge(KA,"type","Path"),Ge(KA,"cacheProperties",[...Ua,"path","fillRule"]),Ge(KA,"ATTRIBUTE_NAMES",[...zA,"d"]),er.setClass(KA),er.setSVGClass(KA);const EU=["left","top","radius"],y5=["radius","startAngle","endAngle","counterClockwise"];class va extends yo{static getDefaults(){return We(We({},super.getDefaults()),va.ownDefaults)}constructor(e){super(),Object.assign(this,va.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Jn(this.startAngle),Jn(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(vs)}getRadiusY(){return this.get("radius")*this.get(Zs)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...y5,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,r=Jn(this.startAngle),o=Jn(this.endAngle),s=Sa(r)*t,i=Ea(r)*t,a=Sa(o)*t,A=Ea(o)*t,d=e>180?1:0,c=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(i," A ").concat(t," ").concat(t," 0 ").concat(d," ").concat(c," ").concat(a," ").concat(A,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,r){const o=Qa(e,this.ATTRIBUTE_NAMES,r),{left:s=0,top:i=0,radius:a=0}=o;return new this(We(We({},Un(o,EU)),{},{radius:a,left:s-a,top:i-a}))}static fromObject(e){return super._fromObject(e)}}Ge(va,"type","Circle"),Ge(va,"cacheProperties",[...Ua,...y5]),Ge(va,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),Ge(va,"ATTRIBUTE_NAMES",["cx","cy","r",...zA]),er.setClass(va),er.setSVGClass(va);const FU=["x1","y1","x2","y2"],IU=["x1","y1","x2","y2"],K0=["x1","x2","y1","y2"];class $A extends yo{constructor(){let[e,t,r,o]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,$A.ownDefaults),this.setOptions(s),this.x1=e,this.x2=r,this.y1=t,this.y2=o,this._setWidthHeight();const{left:i,top:a}=s;typeof i=="number"&&this.set(en,i),typeof a=="number"&&this.set(us,a)}_setWidthHeight(){const{x1:e,y1:t,x2:r,y2:o}=this;this.width=Math.abs(r-e),this.height=Math.abs(o-t);const{left:s,top:i,width:a,height:A}=xa([{x:e,y:t},{x:r,y:o}]),d=new yt(s+a/2,i+A/2);this.setPositionByOrigin(d,Tr,Tr)}_set(e,t){return super._set(e,t),K0.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const r=e.strokeStyle;var o;Ws(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(o=this.stroke)!==null&&o!==void 0?o:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new yt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return We(We({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:r,y2:o,width:s,height:i}=this,a=e<=t?-1:1,A=r<=o?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:A*i/2,y2:A*-i/2}}_toSVG(){const{x1:e,x2:t,y1:r,y2:o}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(t,'" y2="').concat(o,`" />
`)]}static async fromElement(e,t,r){const o=Qa(e,this.ATTRIBUTE_NAMES,r),{x1:s=0,y1:i=0,x2:a=0,y2:A=0}=o;return new this([s,i,a,A],Un(o,FU))}static fromObject(e){let{x1:t,y1:r,x2:o,y2:s}=e,i=Un(e,IU);return this._fromObject(We(We({},i),{},{points:[t,r,o,s]}),{extraParam:"points"})}}Ge($A,"type","Line"),Ge($A,"cacheProperties",[...Ua,...K0]),Ge($A,"ATTRIBUTE_NAMES",zA.concat(K0)),er.setClass($A),er.setSVGClass($A);class ZA extends yo{static getDefaults(){return We(We({},super.getDefaults()),ZA.ownDefaults)}constructor(e){super(),Object.assign(this,ZA.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}Ge(ZA,"type","Triangle"),Ge(ZA,"ownDefaults",{width:100,height:100}),er.setClass(ZA),er.setSVGClass(ZA);const b5=["rx","ry"];class ma extends yo{static getDefaults(){return We(We({},super.getDefaults()),ma.ownDefaults)}constructor(e){super(),Object.assign(this,ma.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(vs)}getRy(){return this.get("ry")*this.get(Zs)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...b5,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,cp,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){const o=Qa(e,this.ATTRIBUTE_NAMES,r);return o.left=(o.left||0)-o.rx,o.top=(o.top||0)-o.ry,new this(o)}}function UU(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let r=0;r<e.length;r+=2)t.push({x:parseFloat(e[r]),y:parseFloat(e[r+1])});return t}Ge(ma,"type","Ellipse"),Ge(ma,"cacheProperties",[...Ua,...b5]),Ge(ma,"ownDefaults",{rx:0,ry:0}),Ge(ma,"ATTRIBUTE_NAMES",[...zA,"cx","cy","rx","ry"]),er.setClass(ma),er.setSVGClass(ma);const QU=["left","top"],_5={exactBoundingBox:!1};class fi extends yo{static getDefaults(){return We(We({},super.getDefaults()),fi.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Ge(this,"strokeDiff",void 0),Object.assign(this,fi.ownDefaults),this.setOptions(t),this.points=e;const{left:r,top:o}=t;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(en,r),typeof o=="number"&&this.set(us,o)}isOpen(){return!0}_projectStrokeOnPoints(e){return bI(this.points,e,this.isOpen())}_calcDimensions(e){e=We({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(d=>d.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new yt,strokeOffset:new yt,strokeDiff:new yt};const r=xa(t),o=ng(We(We({},e),{},{scaleX:1,scaleY:1})),s=xa(this.points.map(d=>ls(d,o,!0))),i=new yt(this.scaleX,this.scaleY);let a=r.left+r.width/2,A=r.top+r.height/2;return this.exactBoundingBox&&(a-=A*Math.tan(Jn(this.skewX)),A-=a*Math.tan(Jn(this.skewY))),We(We({},r),{},{pathOffset:new yt(a,A),strokeOffset:new yt(s.left,s.top).subtract(new yt(r.left,r.top)).multiply(i),strokeDiff:new yt(r.width,r.height).subtract(new yt(s.width,s.height)).multiply(i)})}_findCenterFromElement(){const e=xa(this.points);return new yt(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:r,width:o,height:s,pathOffset:i,strokeOffset:a,strokeDiff:A}=this._calcDimensions();this.set({width:o,height:s,pathOffset:i,strokeOffset:a,strokeDiff:A}),e&&this.setPositionByOrigin(new yt(t+o/2,r+s/2),Tr,Tr)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new yt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let i;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,r;const{width:a,height:A}=this._calcDimensions(e);i=new yt((t=e.width)!==null&&t!==void 0?t:a,(r=e.height)!==null&&r!==void 0?r:A)}else{var o,s;i=new yt((o=e.width)!==null&&o!==void 0?o:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return i.multiply(new yt(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const r=this.initialized&&this[e]!==t,o=super._set(e,t);return this.exactBoundingBox&&r&&((e===vs||e===Zs)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),o}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return We(We({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:r,y:o}=t;return{x:r,y:o}})})}_toSVG(){const e=[],t=this.pathOffset.x,r=this.pathOffset.y,o=Gr.NUM_FRACTION_DIGITS;for(let s=0,i=this.points.length;s<i;s++)e.push(Pn(this.points[s].x-t,o),",",Pn(this.points[s].y-r,o)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,r=this.pathOffset.x,o=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-o);for(let s=0;s<t;s++){const i=this.points[s];e.lineTo(i.x-r,i.y-o)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){return new this(UU(e.getAttribute("points")),We(We({},Un(Qa(e,this.ATTRIBUTE_NAMES,r),QU)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}Ge(fi,"ownDefaults",_5),Ge(fi,"type","Polyline"),Ge(fi,"layoutProperties",[Jd,Zd,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),Ge(fi,"cacheProperties",[...Ua,"points"]),Ge(fi,"ATTRIBUTE_NAMES",[...zA]),er.setClass(fi),er.setSVGClass(fi);class Dh extends fi{isOpen(){return!1}}Ge(Dh,"ownDefaults",_5),Ge(Dh,"type","Polygon"),er.setClass(Dh),er.setSVGClass(Dh);const B5=["fontSize","fontWeight","fontFamily","fontStyle"],x5=["underline","overline","linethrough"],z5=[...B5,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],C5=[...z5,...x5,"textBackgroundColor","direction"],TU=[...B5,...x5,fs,"strokeWidth",lo,"deltaY","textBackgroundColor"],LU={_reNewline:m1,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:en,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:en,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Di="justify",_p="justify-left",iu="justify-right",au="justify-center";class S5 extends yo{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const r in t)for(const o in t[r])for(const s in t[r][o])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const r=t===void 0?this.styles:{0:this.styles[t]};for(const o in r)for(const s in r[o])if(r[o][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let r,o,s=0,i=!0,a=0;for(const A in t){r=0;for(const d in t[A]){const c=t[A][d]||{};s++,c[e]!==void 0?(o?c[e]!==o&&(i=!1):o=c[e],c[e]===this[e]&&delete c[e]):i=!1,Object.keys(c).length!==0?r++:delete t[A][d]}r===0&&delete t[A]}for(let A=0;A<this._textLines.length;A++)a+=this._textLines[A].length;i&&s===a&&(this[e]=o,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let r,o,s;for(o in t){for(s in r=t[o],r)delete r[s][e],Object.keys(r[s]).length===0&&delete r[s];Object.keys(r).length===0&&delete t[o]}}_extendStyles(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);const s=B1(We(We({},this._getStyleDeclaration(r,o)),t),i=>i!==void 0);this._setStyleDeclaration(r,o,s)}getSelectionStyles(e,t,r){const o=[];for(let s=e;s<(t||e);s++)o.push(this.getStyleAtPosition(s,r));return o}getStyleAtPosition(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,o):this._getStyleDeclaration(r,o)}setSelectionStyles(e,t,r){for(let o=t;o<(r||t);o++)this._extendStyles(o,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;const o=this.styles&&this.styles[e];return o&&(r=o[t])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(e,t){return We(We({},ec(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}Ge(S5,"_styleProperties",TU);const PU=/  +/g,kU=/"/g;function bv(n,e,t,r,o){return"		".concat(function(s,i){let{left:a,top:A,width:d,height:c}=i,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Gr.NUM_FRACTION_DIGITS;const h=Su(lo,s,!1),[f,g,m,y]=[a,A,d,c].map(b=>Pn(b,u));return"<rect ".concat(h,' x="').concat(f,'" y="').concat(g,'" width="').concat(m,'" height="').concat(y,'"></rect>')}(n,{left:e,top:t,width:r,height:o}),`
`)}const OU=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let _v;class Yo extends S5{static getDefaults(){return We(We({},super.getDefaults()),Yo.ownDefaults)}constructor(e,t){super(),Ge(this,"__charBounds",[]),Object.assign(this,Yo.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=f5(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Di)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,o,s,i,a;for(let A=0,d=this._textLines.length;A<d;A++)if((this.textAlign===Di||A!==d-1&&!this.isEndOfWrapping(A))&&(o=0,s=this._textLines[A],t=this.getLineWidth(A),t<this.width&&(a=this.textLines[A].match(this._reSpacesAndTabs)))){r=a.length,e=(this.width-t)/r;for(let c=0;c<=s.length;c++)i=this.__charBounds[A][c],this._reSpaceAndTab.test(s[c])?(i.width+=e,i.kernedWidth+=e,i.left+=o,o+=e):i.left+=o}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const r=t?this._unwrappedTextLines:this._textLines;let o;for(o=0;o<r.length;o++){if(e<=r[o].length)return{lineIndex:o,charIndex:e};e-=r[o].length+this.missingNewlineOffset(o,t)}return{lineIndex:o-1,charIndex:r[o-1].length<e?r[o-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===fs?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Tr:e.textBaseline="middle";break;case"ascender":e.textBaseline=us;break;case"descender":e.textBaseline=T0}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){const o=this.getLineWidth(t);o>e&&(e=o)}return e}_renderTextLine(e,t,r,o,s,i){this._renderChars(e,t,r,o,s,i)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,r=this._getLeftOffset();let o=this._getTopOffset();for(let s=0,i=this._textLines.length;s<i;s++){const a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){o+=a;continue}const A=this._textLines[s].length,d=this._getLineLeftOffset(s);let c,u,h=0,f=0,g=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let m=0;m<A;m++){const y=this.__charBounds[s][m];u=this.getValueOfPropertyAt(s,m,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=u,u&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):u!==g?(c=r+d+f,this.direction==="rtl"&&(c=this.width-c-h),e.fillStyle=g,g&&e.fillRect(c,o,h,a/this.lineHeight),f=y.left,h=y.width,g=u):h+=y.kernedWidth}u&&!this.path&&(c=r+d+f,this.direction==="rtl"&&(c=this.width-c-h),e.fillStyle=u,e.fillRect(c,o,h,a/this.lineHeight)),o+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,o){const s=ou.getFontCache(t),i=this._getFontDeclaration(t),a=r+e,A=r&&i===this._getFontDeclaration(o),d=t.fontSize/this.CACHE_FONT_SIZE;let c,u,h,f;if(r&&s[r]!==void 0&&(h=s[r]),s[e]!==void 0&&(f=c=s[e]),A&&s[a]!==void 0&&(u=s[a],f=u-h),c===void 0||h===void 0||u===void 0){const g=function(){return _v||(_v=Wi({width:0,height:0}).getContext("2d")),_v}();this._setTextStyles(g,t,!0),c===void 0&&(f=c=g.measureText(e).width,s[e]=c),h===void 0&&A&&r&&(h=g.measureText(r).width,s[r]=h),A&&u===void 0&&(u=g.measureText(a).width,s[a]=u,f=u-h)}return{width:c*d,kernedWidth:f*d}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,r,o=0;const s=this.pathSide===Gn,i=this.path,a=this._textLines[e],A=a.length,d=new Array(A);this.__charBounds[e]=d;for(let c=0;c<A;c++){const u=a[c];r=this._getGraphemeBox(u,e,c,t),d[c]=r,o+=r.kernedWidth,t=u}if(d[A]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},i&&i.segmentsInfo){let c=0;const u=i.segmentsInfo[i.segmentsInfo.length-1].length;switch(this.textAlign){case en:c=s?u-o:0;break;case Tr:c=(u-o)/2;break;case Gn:c=s?0:u-o}c+=this.pathStartOffset*(s?-1:1);for(let h=s?A-1:0;s?h>=0:h<A;s?h--:h++)r=d[h],c>u?c%=u:c<0&&(c+=u),this._setGraphemeOnPath(c,r),c+=r.kernedWidth}return{width:o,numOfSpaces:0}}_setGraphemeOnPath(e,t){const r=e+t.kernedWidth/2,o=this.path,s=AU(o.path,r,o.segmentsInfo);t.renderLeft=s.x-o.pathOffset.x,t.renderTop=s.y-o.pathOffset.y,t.angle=s.angle+(this.pathSide===Gn?Math.PI:0)}_getGraphemeBox(e,t,r,o,s){const i=this.getCompleteStyleDeclaration(t,r),a=o?this.getCompleteStyleDeclaration(t,r-1):{},A=this._measureChar(e,i,o,a);let d,c=A.kernedWidth,u=A.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),u+=d,c+=d);const h={width:u,left:0,height:i.fontSize,kernedWidth:c,deltaY:i.deltaY};if(r>0&&!s){const f=this.__charBounds[t][r-1];h.left=f.left+f.width+A.kernedWidth-A.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let r=1,o=this._textLines[e].length;r<o;r++)t=Math.max(this.getHeightOfChar(e,r),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let r=0,o=this._textLines.length;r<o;r++)e=this.getHeightOfLine(r),t+=r===o-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0;const o=this._getLeftOffset(),s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const A=this.getHeightOfLine(i),d=A/this.lineHeight,c=this._getLineLeftOffset(i);this._renderTextLine(t,e,this._textLines[i],o+c,s+r+d,i),r+=A}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(lo))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,o,s,i){const a=this.getHeightOfLine(i),A=this.textAlign.includes(Di),d=this.path,c=!A&&this.charSpacing===0&&this.isEmptyStyles(i)&&!d,u=this.direction==="ltr",h=this.direction==="ltr"?1:-1,f=t.direction;let g,m,y,b,S,F="",k=0;if(t.save(),f!==this.direction&&(t.canvas.setAttribute("dir",u?"ltr":"rtl"),t.direction=u?"ltr":"rtl",t.textAlign=u?en:Gn),s-=a*this._fontSizeFraction/this.lineHeight,c)return this._renderChar(e,t,i,0,r.join(""),o,s),void t.restore();for(let P=0,te=r.length-1;P<=te;P++)b=P===te||this.charSpacing||d,F+=r[P],y=this.__charBounds[i][P],k===0?(o+=h*(y.kernedWidth-y.width),k+=y.width):k+=y.kernedWidth,A&&!b&&this._reSpaceAndTab.test(r[P])&&(b=!0),b||(g=g||this.getCompleteStyleDeclaration(i,P),m=this.getCompleteStyleDeclaration(i,P+1),b=Q1(g,m,!1)),b&&(d?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,i,P,F,-k/2,0),t.restore()):(S=o,this._renderChar(e,t,i,P,F,S,s)),F="",g=m,o+=h*k,k=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,r=this.height+this.strokeWidth,o=Wi({width:t,height:r}),s=o.getContext("2d");return o.width=t,o.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,r),s.lineTo(0,r),s.closePath(),s.translate(t/2,r/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(o,"no-repeat")}handleFiller(e,t,r){let o,s;return Ws(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(o=-this.width/2,s=-this.height/2,e.translate(o,s),e[t]=this._applyPatternGradientTransformText(r),{offsetX:o,offsetY:s}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:o}=t;return e.lineWidth=o,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,o,s,i,a){const A=this._getStyleDeclaration(r,o),d=this.getCompleteStyleDeclaration(r,o),c=e==="fillText"&&d.fill,u=e==="strokeText"&&d.stroke&&d.strokeWidth;if(u||c){if(t.save(),t.font=this._getFontDeclaration(d),A.textBackgroundColor&&this._removeShadow(t),A.deltaY&&(a+=A.deltaY),c){const h=this._setFillStyles(t,d);t.fillText(s,i-h.offsetX,a-h.offsetY)}if(u){const h=this._setStrokeStyles(t,d);t.strokeText(s,i-h.offsetX,a-h.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){const o=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),i=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),a={fontSize:s*r.size,deltaY:i+s*r.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),r=this.width-t,o=this.textAlign,s=this.direction,i=this.isEndOfWrapping(e);let a=0;return o===Di||o===au&&!i||o===iu&&!i||o===_p&&!i?0:(o===Tr&&(a=r/2),o===Gn&&(a=r),o===au&&(a=r/2),o===iu&&(a=r),s==="rtl"&&(o===Gn||o===Di||o===iu?a=0:o===en||o===_p?a=-r:o!==Tr&&o!==au||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var o;return(o=this._getStyleDeclaration(e,t)[r])!==null&&o!==void 0?o:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset();const o=this._getLeftOffset(),s=this.path,i=this._getWidthOfCharSpacing(),a=this.offsets[t];for(let A=0,d=this._textLines.length;A<d;A++){const c=this.getHeightOfLine(A);if(!this[t]&&!this.styleHas(t,A)){r+=c;continue}const u=this._textLines[A],h=c/this.lineHeight,f=this._getLineLeftOffset(A);let g,m,y=0,b=0,S=this.getValueOfPropertyAt(A,0,t),F=this.getValueOfPropertyAt(A,0,lo);const k=r+h*(1-this._fontSizeFraction);let P=this.getHeightOfChar(A,0),te=this.getValueOfPropertyAt(A,0,"deltaY");for(let j=0,J=u.length;j<J;j++){const we=this.__charBounds[A][j];g=this.getValueOfPropertyAt(A,j,t),m=this.getValueOfPropertyAt(A,j,lo);const D=this.getHeightOfChar(A,j),N=this.getValueOfPropertyAt(A,j,"deltaY");if(s&&g&&m)e.save(),e.fillStyle=F,e.translate(we.renderLeft,we.renderTop),e.rotate(we.angle),e.fillRect(-we.kernedWidth/2,a*D+N,we.kernedWidth,this.fontSize/15),e.restore();else if((g!==S||m!==F||D!==P||N!==te)&&b>0){let Z=o+f+y;this.direction==="rtl"&&(Z=this.width-Z-b),S&&F&&(e.fillStyle=F,e.fillRect(Z,k+a*P+te,b,this.fontSize/15)),y=we.left,b=we.width,S=g,F=m,P=D,te=N}else b+=we.kernedWidth}let $=o+f+y;this.direction==="rtl"&&($=this.width-$-b),e.fillStyle=m,g&&m&&e.fillRect($,k+a*P+te,b-i,this.fontSize/15),r+=c}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:o=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const i=e.includes("'")||e.includes('"')||e.includes(",")||Yo.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,r,"".concat(s?this.CACHE_FONT_SIZE:o,"px"),i].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return U1(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),r=new Array(t.length),o=[`
`];let s=[];for(let i=0;i<t.length;i++)r[i]=this.graphemeSplit(t[i]),s=s.concat(r[i],o);return s.pop(),{_unwrappedLines:r,lines:t,graphemeText:s,graphemeLines:r}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return We(We({},super.toObject([...C5,...e])),{},{styles:xI(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:r}=this.constructor;super.set(e,t);let o=!1,s=!1;if(typeof e=="object")for(const i in e)i==="path"&&this.setPathInfo(),o=o||r.includes(i),s=s||i==="path";else o=r.includes(e),s=e==="path";return s&&this.setPathInfo(),o&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){const o=Qa(e,Yo.ATTRIBUTE_NAMES,r),s=We(We({},t),o),{textAnchor:i=en,textDecoration:a="",dx:A=0,dy:d=0,top:c=0,left:u=0,fontSize:h=v1,strokeWidth:f=1}=s,g=Un(s,OU),m=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),We({left:u+A,top:c+d,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:h},g)),y=m.getScaledHeight()/m.height,b=((m.height+m.strokeWidth)*m.lineHeight-m.height)*y,S=m.getScaledHeight()+b;let F=0;return i===Tr&&(F=m.getScaledWidth()/2),i===Gn&&(F=m.getScaledWidth()),m.set({left:m.left-F,top:m.top-(S-m.fontSize*(.07+m._fontSizeFraction))/m.lineHeight,strokeWidth:f}),m}static fromObject(e){return this._fromObject(We(We({},e),{},{styles:zI(e.styles||{},e.text)}),{extraParam:"text"})}}Ge(Yo,"textLayoutProperties",z5),Ge(Yo,"cacheProperties",[...Ua,...C5]),Ge(Yo,"ownDefaults",LU),Ge(Yo,"type","Text"),Ge(Yo,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),Ge(Yo,"ATTRIBUTE_NAMES",zA.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),s5(Yo,[class extends XB{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){return this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const r=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(kU,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],r=[];let o,s=n;this.backgroundColor&&r.push(...bv(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let i=0,a=this._textLines.length;i<a;i++)o=this._getLineLeftOffset(i),this.direction==="rtl"&&(o+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",i))&&this._setSVGTextLineBg(r,i,e+o,s),this._setSVGTextLineText(t,i,e+o,s),s+=this.getHeightOfLine(i);return{textSpans:t,textBgRects:r}}_createTextCharSpan(n,e,t,r){const o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(PU)),s=o?'style="'.concat(o,'"'):"",i=e.deltaY,a=i?' dy="'.concat(Pn(i,Gr.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(Pn(t,Gr.NUM_FRACTION_DIGITS),'" y="').concat(Pn(r,Gr.NUM_FRACTION_DIGITS),'" ').concat(a).concat(s,">").concat(_I(n),"</tspan>")}_setSVGTextLineText(n,e,t,r){const o=this.getHeightOfLine(e),s=this.textAlign.includes(Di),i=this._textLines[e];let a,A,d,c,u,h="",f=0;r+=o*(1-this._fontSizeFraction)/this.lineHeight;for(let g=0,m=i.length-1;g<=m;g++)u=g===m||this.charSpacing,h+=i[g],d=this.__charBounds[e][g],f===0?(t+=d.kernedWidth-d.width,f+=d.width):f+=d.kernedWidth,s&&!u&&this._reSpaceAndTab.test(i[g])&&(u=!0),u||(a=a||this.getCompleteStyleDeclaration(e,g),A=this.getCompleteStyleDeclaration(e,g+1),u=Q1(a,A,!0)),u&&(c=this._getStyleDeclaration(e,g),n.push(this._createTextCharSpan(h,c,t,r)),h="",a=A,this.direction==="rtl"?t-=f:t+=f,f=0)}_setSVGTextLineBg(n,e,t,r){const o=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let i,a=0,A=0,d=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let c=0;c<o.length;c++){const{left:u,width:h,kernedWidth:f}=this.__charBounds[e][c];i=this.getValueOfPropertyAt(e,c,"textBackgroundColor"),i!==d?(d&&n.push(...bv(d,t+A,r,a,s)),A=u,a=h,d=i):a+=f}i&&n.push(...bv(d,t+A,r,a,s))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const r=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:r,stroke:o,fill:s,fontSize:i,fontStyle:a,fontWeight:A,deltaY:d}=n,c=this.getSvgTextDecoration(n);return[o?Su(fs,o):"",r?"stroke-width: ".concat(r,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",i?"font-size: ".concat(i,"px; "):"",a?"font-style: ".concat(a,"; "):"",A?"font-weight: ".concat(A,"; "):"",c&&"text-decoration: ".concat(c,"; "),s?Su(lo,s):"",d?"baseline-shift: ".concat(-d,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(e=>n[e.replace("-","")]).join(" ")}}]),er.setClass(Yo),er.setSVGClass(Yo);class DU{constructor(e){Ge(this,"target",void 0),Ge(this,"__mouseDownInPlace",!1),Ge(this,"__dragStartFired",!1),Ge(this,"__isDraggingOver",!1),Ge(this,"__dragStartSelection",void 0),Ge(this,"__dragImageDisposer",void 0),Ge(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:o,selectionEnd:s}=t;const i=this.target,a=i.canvas,A=new yt(i.flipX?-1:1,i.flipY?-1:1),d=i._getCursorBoundaries(o),c=new yt(d.left+d.leftOffset,d.top+d.topOffset).multiply(A).transform(i.calcTransformMatrix()),u=a.getScenePoint(e).subtract(c),h=i.getCanvasRetinaScaling(),f=i.getBoundingRect(),g=c.subtract(new yt(f.left,f.top)),m=a.viewportTransform,y=g.add(u).transform(m,!0),b=i.backgroundColor,S=I1(i.styles);i.backgroundColor="";const F={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};i.setSelectionStyles(F,0,o),i.setSelectionStyles(F,s,i.text.length),i.dirty=!0;const k=i.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});i.backgroundColor=b,i.styles=S,i.dirty=!0,R0(k,{position:"fixed",left:"".concat(-k.width,"px"),border:hs,width:"".concat(k.width/h,"px"),height:"".concat(k.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{k.remove()},gi(e.target||this.target.hiddenTextarea).body.appendChild(k),(r=e.dataTransfer)===null||r===void 0||r.setDragImage(k,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,r=this.isActive();if(r&&e.dataTransfer){const o=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(o.selectionStart,o.selectionEnd).join(""),i=We({text:t.text,value:s},o);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(o.selectionStart,o.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,i)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:r}=e,o=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let s=(t=r.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!o){const i=this.target,a=i.canvas;let A=i.getSelectionStartFromPointer(r);const{styles:d}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},c=s[Math.max(0,s.length-1)],u=0;if(this.__dragStartSelection){const h=this.__dragStartSelection.selectionStart,f=this.__dragStartSelection.selectionEnd;A>h&&A<=f?A=h:A>f&&(A-=f-h),i.removeChars(h,f),delete this.__dragStartSelection}i._reNewline.test(c)&&(i._reNewline.test(i._text[A])||A===i._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=i,i.insertChars(s,d,A),a.setActiveObject(i),i.enterEditing(r),i.selectionStart=Math.min(A+u,i._text.length),i.selectionEnd=Math.min(i.selectionStart+s.length,i._text.length),i.hiddenTextarea.value=i.text,i._updateTextarea(),i.hiddenTextarea.focus(),i.fire(up,{index:A+u,action:"drop"}),a.fire("text:changed",{target:i}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const o=this.target,s=this.target.canvas,{selectionStart:i,selectionEnd:a}=this.__dragStartSelection,A=((r=t.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||hs;A===hs?(o.selectionStart=i,o.selectionEnd=a,o._updateTextarea(),o.hiddenTextarea.focus()):(o.clearContextTop(),A==="move"&&(o.removeChars(i,a),o.selectionStart=o.selectionEnd=i,o.hiddenTextarea&&(o.hiddenTextarea.value=o.text),o._updateTextarea(),o.fire(up,{index:i,action:"dragend"}),s.fire("text:changed",{target:o}),s.requestRenderAll()),o.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const Xw=/[ \n\.,;!\?\-]/;class NU extends Yo{constructor(){super(...arguments),Ge(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:o,onComplete:s}=e;return e5({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:o,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:i=>{this._currentCursorOpacity=i,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){const r=this._text;let o=e>0&&this._reSpace.test(r[e])&&(t===-1||!m1.test(r[e-1]))?e-1:e,s=r[o];for(;o>0&&o<r.length&&!Xw.test(s);)o+=t,s=r[o];return t===-1&&Xw.test(s)&&o++,o}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),r=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;gi(t).activeElement!==t&&t.focus();const r=this.getSelectionStartFromPointer(e),o=this.selectionStart,s=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&o!==s||o!==r&&s!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===o&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){const o=r.slice(0,e),s=this.graphemeSplit(o).length;if(e===t)return{selectionStart:s,selectionEnd:s};const i=r.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(i).length}}fromGraphemeToStringSelection(e,t,r){const o=r.slice(0,e).join("").length;return e===t?{selectionStart:o,selectionEnd:o}:{selectionStart:o,selectionEnd:o+r.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),o=r.lineIndex,s=r.charIndex,i=this.getValueOfPropertyAt(o,s,"fontSize")*this.lineHeight,a=t.leftOffset,A=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,c=d.width/A,u=d.height/A,h=c-i,f=u-i,g=new yt(t.left+a,t.top+t.topOffset+i).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new yt(d.clientWidth/c,d.clientHeight/u));return g.x<0&&(g.x=0),g.x>h&&(g.x=h),g.y<0&&(g.y=0),g.y>f&&(g.y=f),g.x+=this.canvas._offset.left,g.y+=this.canvas._offset.top,{left:"".concat(g.x,"px"),top:"".concat(g.y,"px"),fontSize:"".concat(i,"px"),charHeight:i}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(hp),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:i}=this.get2DCursorLocation(t,!0);if(r!==s){if(this.styles[r])for(let a=o;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[s])for(let a=i;a<this._unwrappedTextLines[s].length;a++){const A=this.styles[s][a];A&&(this.styles[r]||(this.styles[r]={}),this.styles[r][o+a-i]=A)}for(let a=r+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,r-s)}else if(this.styles[r]){const a=this.styles[r],A=i-o;for(let d=o;d<i;d++)delete a[d];for(const d in this.styles[r]){const c=parseInt(d,10);c>=i&&(a[c-A]=a[d],delete a[d])}}}shiftLineStyles(e,t){const r=Object.assign({},this.styles);for(const o in this.styles){const s=parseInt(o,10);s>e&&(this.styles[s+t]=r[s],r[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,r,o){const s={},i=this._unwrappedTextLines[e].length,a=i===t;let A=!1;r||(r=1),this.shiftLineStyles(e,r);const d=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const u in this.styles[e]){const h=parseInt(u,10);h>=t&&(A=!0,s[h-t]=this.styles[e][u],a&&t===0||delete this.styles[e][u])}let c=!1;for(A&&!a&&(this.styles[e+r]=s,c=!0),(c||i>t)&&r--;r>0;)o&&o[r-1]?this.styles[e+r]={0:We({},o[r-1])}:d?this.styles[e+r]={0:We({},d)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,o){this.styles||(this.styles={});const s=this.styles[e],i=s?We({},s):{};r||(r=1);for(const A in i){const d=parseInt(A,10);d>=t&&(s[d+r]=i[d],i[d-r]||delete s[d])}if(this._forceClearCache=!0,o){for(;r--;)Object.keys(o[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=We({},o[r]));return}if(!s)return;const a=s[t?t-1:1];for(;a&&r--;)this.styles[e][t+r]=We({},a)}insertNewStyleBlock(e,t,r){const o=this.get2DCursorLocation(t,!0),s=[0];let i,a=0;for(let A=0;A<e.length;A++)e[A]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(o.lineIndex,o.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),a&&this.insertNewlineStyleObject(o.lineIndex,o.charIndex+s[0],a),i=1;i<a;i++)s[i]>0?this.insertCharStyleObject(o.lineIndex+i,0,s[i],r):r&&this.styles[o.lineIndex+i]&&r[0]&&(this.styles[o.lineIndex+i][0]=r[0]),r=r&&r.slice(s[i]+1);s[i]>0&&this.insertCharStyleObject(o.lineIndex+i,0,s[i],r)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;o>r&&this.removeStyleFromTo(r,o);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,r,t),this._text=[...this._text.slice(0,r),...s,...this._text.slice(o)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=en:this._selectionDirection===Gn&&(this._selectionDirection=en,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===Gn?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=Gn:this._selectionDirection===en&&(this._selectionDirection=Gn,this.selectionStart=t),this.selectionEnd=r)}}class MU extends NU{initHiddenTextarea(){const e=this.canvas&&gi(this.canvas.getElement())||Yd(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(i=>{let[a,A]=i;return t.setAttribute(a,A)});const{top:r,left:o,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(o,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(i=>{let[a,A]=i;return t.addEventListener(a,this[A].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const r=()=>{this.updateFromTextArea(),this.fire(up),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void r();const o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,i=o.length,a=this.selectionStart,A=this.selectionEnd,d=a!==A;let c,u,h,f,g=i-s;const m=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=a>m.selectionStart;d?(u=this._text.slice(a,A),g+=A-a):i<s&&(u=y?this._text.slice(A+g,A):this._text.slice(a,a-g));const b=o.slice(m.selectionEnd-g,m.selectionEnd);if(u&&u.length&&(b.length&&(c=this.getSelectionStyles(a,a+1,!1),c=b.map(()=>c[0])),d?(h=a,f=A):y?(h=A-u.length,f=A):(h=A,f=A+u.length),this.removeStyleFromTo(h,f)),b.length){const{copyPasteData:S}=Gi();t&&b.join("")===S.copiedText&&!Gr.disableStyleCopyPaste&&(c=S.copiedTextStyle),this.insertNewStyleBlock(b,a,c)}r()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:r,selectionEnd:o}=t;this.compositionStart=r,this.compositionEnd=o,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Gi();e.copiedText=this.getSelectedText(),Gr.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r,o=this._getLineLeftOffset(e);return t>0&&(r=this.__charBounds[e][t-1],o+=r.left+r.width),o}getDownCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(r),s=o.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-r;const i=o.charIndex,a=this._getWidthBeforeCursor(s,i),A=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(i).length+A+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(r),s=o.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-r;const i=o.charIndex,a=this._getWidthBeforeCursor(s,i),A=this._getIndexOnLine(s-1,a),d=this._textLines[s].slice(0,i),c=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+A-d.length+(1-c)}_getIndexOnLine(e,t){const r=this._textLines[e];let o,s,i=this._getLineLeftOffset(e),a=0;for(let A=0,d=r.length;A<d;A++)if(o=this.__charBounds[e][A].width,i+=o,i>t){s=!0;const c=i-o,u=i,h=Math.abs(c-t);a=Math.abs(u-t)<h?A:A-1;break}return s||(a=r.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const r=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===Gn);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const o=this.text.length;this.selectionStart=Md(0,this.selectionStart,o),this.selectionEnd=Md(0,this.selectionEnd,o),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===en?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let o;if(e.altKey)o=this["findWordBoundary".concat(r)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=r==="Left"?-1:1,!0;o=this["findLineBoundary".concat(r)](this[t])}return o!==void 0&&this[t]!==o&&(this[t]=o,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=en,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===Gn&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=en,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const r="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===en&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=Gn,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=Gn,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Bv=n=>!!n.button;class HU extends MU{constructor(){super(...arguments),Ge(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new DU(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),k0(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!Bv(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!Bv(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:r}=e;const o=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||Bv(t)||o||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),r=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(vi(this.calcTransformMatrix())).add(new yt(-this._getLeftOffset(),-this._getTopOffset()));let r=0,o=0,s=0;for(let d=0;d<this._textLines.length&&r<=t.y;d++)r+=this.getHeightOfLine(d),s=d,d>0&&(o+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let i=Math.abs(this._getLineLeftOffset(s));const a=this._textLines[s].length,A=this.__charBounds[s];for(let d=0;d<a;d++){const c=i+A[d].kernedWidth;if(t.x<=c){Math.abs(t.x-c)<=Math.abs(t.x-i)&&o++;break}i=c,o++}return Math.min(this.flipX?a-o:o,this._text.length)}}const Nh="moveCursorUp",Mh="moveCursorDown",Hh="moveCursorLeft",jh="moveCursorRight",Rh="exitEditing",jU=We({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:Rh,27:Rh,33:Nh,34:Mh,35:jh,36:Hh,37:Hh,38:Nh,39:jh,40:Mh},keysMapRtl:{9:Rh,27:Rh,33:Nh,34:Mh,35:Hh,36:jh,37:jh,38:Nh,39:Hh,40:Mh},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class ya extends HU{static getDefaults(){return We(We({},super.getDefaults()),ya.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,We(We({},ya.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof q0&&this.canvas.textEditingManager.remove(this),t instanceof q0&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),o=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:r,top:o,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0;const{charIndex:o,lineIndex:s}=this.get2DCursorLocation(e);for(let d=0;d<s;d++)t+=this.getHeightOfLine(d);const i=this._getLineLeftOffset(s),a=this.__charBounds[s][o];a&&(r=a.left),this.charSpacing!==0&&o===this._textLines[s].length&&(r-=this._getWidthOfCharSpacing());const A={top:t,left:i+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===Gn||this.textAlign===Di||this.textAlign===iu?A.left*=-1:this.textAlign===en||this.textAlign===_p?A.left=i-(r>0?r:0):this.textAlign!==Tr&&this.textAlign!==au||(A.left=i-(r>0?r:0))),A}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const r=this.get2DCursorLocation(e),o=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,i=this.getValueOfPropertyAt(o,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),A=this.cursorWidth/a,d=this.getValueOfPropertyAt(o,s,"deltaY"),c=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(o)/this.lineHeight-i*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(o,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-A/2,top:c+t.top+d,width:A,height:i}}_renderCursor(e,t,r){const{color:o,opacity:s,left:i,top:a,width:A,height:d}=this.getCursorRenderingData(r,t);e.fillStyle=o,e.globalAlpha=s,e.fillRect(i,a,A,d)}renderSelection(e,t){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){const o=t.selectionStart,s=t.selectionEnd,i=this.textAlign.includes(Di),a=this.get2DCursorLocation(o),A=this.get2DCursorLocation(s),d=a.lineIndex,c=A.lineIndex,u=a.charIndex<0?0:a.charIndex,h=A.charIndex<0?0:A.charIndex;for(let f=d;f<=c;f++){const g=this._getLineLeftOffset(f)||0;let m=this.getHeightOfLine(f),y=0,b=0,S=0;if(f===d&&(b=this.__charBounds[d][u].left),f>=d&&f<c)S=i&&!this.isEndOfWrapping(f)?this.width:this.getLineWidth(f)||5;else if(f===c)if(h===0)S=this.__charBounds[c][h].left;else{const $=this._getWidthOfCharSpacing();S=this.__charBounds[c][h-1].left+this.__charBounds[c][h-1].width-$}y=m,(this.lineHeight<1||f===c&&this.lineHeight>1)&&(m/=this.lineHeight);let F=r.left+g+b,k=m,P=0;const te=S-b;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",k=1,P=m):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===Gn||this.textAlign===Di||this.textAlign===iu?F=this.width-F-te:this.textAlign===en||this.textAlign===_p?F=r.left+g-S:this.textAlign!==Tr&&this.textAlign!==au||(F=r.left+g-S)),e.fillRect(F,r.top+r.topOffset+P,te,k),r.topOffset+=y}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,lo)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}Ge(ya,"ownDefaults",jU),Ge(ya,"type","IText"),er.setClass(ya),er.setClass(ya,"i-text");class el extends ya{static getDefaults(){return We(We({},super.getDefaults()),el.ownDefaults)}constructor(e,t){super(e,We(We({},el.ownDefaults),t))}static createControls(){return{controls:mI()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Di)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,o=0;const s={};for(let i=0;i<e.graphemeLines.length;i++)e.graphemeText[o]===`
`&&i>0?(r=0,o++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[o])&&i>0&&(r++,o++),s[i]={line:t,offset:r},o+=e.graphemeLines[i].length,r+=e.graphemeLines[i].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];r&&(t=r.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,r=0,o=e+1,s=!1;const i=this._styleMap[e],a=this._styleMap[e+1];i&&(e=i.line,r=i.offset),a&&(o=a.line,s=o===e,t=a.offset);const A=e===void 0?this.styles:{line:this.styles[e]};for(const d in A)for(const c in A[d]){const u=parseInt(c,10);if(u>=r&&(!s||u<t))for(const h in A[d][c])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){const o=this._styleMap[e];super._setStyleDeclaration(o.line,o.offset+t,r)}_deleteStyleDeclaration(e,t){const r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const r=this.getGraphemeDataForRender(e),o=[];for(let s=0;s<r.wordsData.length;s++)o.push(...this._wrapLine(s,t,r));return this.isWrapping=!1,o}getGraphemeDataForRender(e){const t=this.splitByGrapheme,r=t?"":" ";let o=0;return{wordsData:e.map((s,i)=>{let a=0;const A=t?this.graphemeSplit(s):this.wordSplit(s);return A.length===0?[{word:[],width:0}]:A.map(d=>{const c=t?[d]:this.graphemeSplit(d),u=this._measureWord(c,i,a);return o=Math.max(u,o),a+=c.length+r.length,{word:c,width:u}})}),largestWordWidth:o}}_measureWord(e,t){let r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let i=0,a=e.length;i<a;i++)s+=this._getGraphemeBox(e[i],t,i+o,r,!0).kernedWidth,r=e[i];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let{largestWordWidth:o,wordsData:s}=r,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),A=this.splitByGrapheme,d=[],c=A?"":" ";let u=0,h=[],f=0,g=0,m=!0;t-=i;const y=Math.max(t,o,this.dynamicMinWidth),b=s[e];let S;for(f=0,S=0;S<b.length;S++){const{word:F,width:k}=b[S];f+=F.length,u+=g+k-a,u>y&&!m?(d.push(h),h=[],u=k,m=!0):u+=a,m||A||h.push(c),h=h.concat(F),g=A?0:this._measureWord([c],e,f),f++,m=!1}return S&&d.push(h),o+i>this.dynamicMinWidth&&(this.dynamicMinWidth=o-a+i),d}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),o=new Array(r.length);for(let s=0;s<r.length;s++)o[s]=r[s].join("");return t.lines=o,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const r=parseInt(t,10);if(this._textLines[r]){const o=this._styleMap[t].line;e.set("".concat(o),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}Ge(el,"type","Textbox"),Ge(el,"textLayoutProperties",[...ya.textLayoutProperties,"width"]),Ge(el,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),er.setClass(el);class Yw extends Ag{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:r}=e,{clipPath:o,group:s}=r;if(!o||!this.shouldPerformLayout(e))return;const{width:i,height:a}=xa(A5(r,o)),A=new yt(i,a);if(o.absolutePositioned)return{center:Ed(o.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:A};{const d=o.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:c=new yt,correction:u=new yt}=this.calcBoundingBox(t,e)||{};return{center:c.add(d),correction:u.subtract(d),size:A}}return{center:r.getRelativeCenterPoint().add(d),size:A}}}}Ge(Yw,"type","clip-path"),er.setClass(Yw);class Jw extends Ag{getInitialSize(e,t){let{target:r}=e,{size:o}=t;return new yt(r.width||o.x,r.height||o.y)}}Ge(Jw,"type","fixed"),er.setClass(Jw);class RU extends Fu{subscribeTargets(e){const t=e.target;e.targets.reduce((r,o)=>(o.parent&&r.add(o.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[t]})})}unsubscribeTargets(e){const t=e.target,r=t.getObjects();e.targets.reduce((o,s)=>(s.parent&&o.add(s.parent),o),new Set).forEach(o=>{!r.some(s=>s.parent===o)&&o.layoutManager.unsubscribeTargets({target:o,targets:[t]})})}}class tl extends il{static getDefaults(){return We(We({},super.getDefaults()),tl.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,tl.ownDefaults),this.setOptions(t);const{left:r,top:o,layoutManager:s}=t;this.groupInit(e,{left:r,top:o,layoutManager:s??new RU})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(o=>{const s=this._objects.findIndex(a=>a.isInFrontOf(o)),i=s===-1?this.size():s;this.insertAt(i,o)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(wA("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach(o=>{const{parent:s}=o;s&&r.add(s)}),e===L1?r.forEach(o=>{o._onAfterObjectsChange(wp,t)}):r.forEach(o=>{o._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const o=We(We({hasControls:!1},r),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,o);super._renderControls(e,t),e.restore()}}Ge(tl,"type","ActiveSelection"),Ge(tl,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),er.setClass(tl),er.setClass(tl,"activeSelection");class qU{constructor(){Ge(this,"resources",{})}applyFilters(e,t,r,o,s){const i=s.getContext("2d");if(!i)return;i.drawImage(t,0,0,r,o);const a={sourceWidth:r,sourceHeight:o,imageData:i.getImageData(0,0,r,o),originalEl:t,originalImageData:i.getImageData(0,0,r,o),canvasEl:s,ctx:i,filterBackend:this};e.forEach(d=>{d.applyTo(a)});const{imageData:A}=a;return A.width===r&&A.height===o||(s.width=A.width,s.height=A.height),i.putImageData(A,0,0),a}}class E5{constructor(){let{tileSize:e=Gr.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Ge(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),Ge(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const r=Wi({width:e,height:t}),o=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});o&&(o.clearColor(0,0,0,0),this.canvas=r,this.gl=o)}applyFilters(e,t,r,o,s,i){const a=this.gl,A=s.getContext("2d");if(!a||!A)return;let d;i&&(d=this.getCachedTexture(i,t));const c={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:r,sourceHeight:o,destinationWidth:r,destinationHeight:o,context:a,sourceTexture:this.createTexture(a,r,o,d?void 0:t),targetTexture:this.createTexture(a,r,o),originalTexture:d||this.createTexture(a,r,o,d?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},u=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,u),e.forEach(h=>{h&&h.applyTo(c)}),function(h){const f=h.targetCanvas,g=f.width,m=f.height,y=h.destinationWidth,b=h.destinationHeight;g===y&&m===b||(f.width=y,f.height=b)}(c),this.copyGLTo2D(a,c),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(c.sourceTexture),a.deleteTexture(c.targetTexture),a.deleteFramebuffer(u),A.setTransform(1,0,0,1,0,0),c}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,o,s){const{NEAREST:i,TEXTURE_2D:a,RGBA:A,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:c,TEXTURE_MAG_FILTER:u,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:f,TEXTURE_WRAP_T:g}=e,m=e.createTexture();return e.bindTexture(a,m),e.texParameteri(a,u,s||i),e.texParameteri(a,h,s||i),e.texParameteri(a,f,c),e.texParameteri(a,g,c),o?e.texImage2D(a,0,A,A,d,o):e.texImage2D(a,0,A,t,r,0,A,d,null),m}getCachedTexture(e,t,r){const{textureCache:o}=this;if(o[e])return o[e];{const s=this.createTexture(this.gl,t.width,t.height,t,r);return s&&(o[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const r=e.canvas,o=t.targetCanvas,s=o.getContext("2d");if(!s)return;s.translate(0,o.height),s.scale(1,-1);const i=r.height-o.height;s.drawImage(r,0,i,o.width,o.height,0,0,o.width,o.height)}copyGLTo2DPutImageData(e,t){const r=t.targetCanvas.getContext("2d"),o=t.destinationWidth,s=t.destinationHeight,i=o*s*4;if(!r)return;const a=new Uint8Array(this.imageBuffer,0,i),A=new Uint8ClampedArray(this.imageBuffer,0,i);e.readPixels(0,0,o,s,e.RGBA,e.UNSIGNED_BYTE,a);const d=new ImageData(A,o,s);r.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const r=e.getExtension("WEBGL_debug_renderer_info");if(r){const o=e.getParameter(r.UNMASKED_RENDERER_WEBGL),s=e.getParameter(r.UNMASKED_VENDOR_WEBGL);o&&(t.renderer=o.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let xv;function KU(){const{WebGLProbe:n}=Gi();return n.queryWebGL(bi()),Gr.enableGLFiltering&&n.isSupported(Gr.textureSize)?new E5({tileSize:Gr.textureSize}):new qU}function zv(){return!xv&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(xv=KU()),xv}const $U=["filters","resizeFilter","src","crossOrigin","type"],F5=["cropX","cropY"];class Zo extends yo{static getDefaults(){return We(We({},super.getDefaults()),Zo.ownDefaults)}constructor(e,t){super(),Ge(this,"_lastScaleX",1),Ge(this,"_lastScaleY",1),Ge(this,"_filterScalingX",1),Ge(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Zo.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(yA()),this.setElement(typeof e=="string"?(this.canvas&&gi(this.canvas.getElement())||Yd()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Zo.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=zv(!1);t instanceof E5&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&Gi().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(r=>{r&&t.push(r.toObject())}),We(We({},super.toObject([...F5,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,r=-this.width/2,o=-this.height/2;let s=[],i=[],a="",A="";if(!t)return[];if(this.hasCrop()){const d=yA();s.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+r+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(A=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(o-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(A).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,i=['	<rect x="'.concat(r,'" y="').concat(o,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=d}return s=this.paintFirst!==lo?s.concat(i,e):s.concat(e,i),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Hf(e,{crossOrigin:t,signal:r}).then(o=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(o)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),o=r.x,s=r.y,i=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||o>t&&s>t)return this._element=i,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=o,void(this._lastScaleY=s);const a=Wi(i),{width:A,height:d}=i;this._element=a,this._lastScaleX=e.scaleX=o,this._lastScaleY=e.scaleY=s,zv().applyFilters([e],i,A,d,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,r=t.naturalWidth||t.width,o=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=Wi({width:r,height:o});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,o),this._lastScaleX=1,this._lastScaleY=1);zv().applyFilters(e,this._originalElement,r,o,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const r=this._filterScalingX,o=this._filterScalingY,s=this.width,i=this.height,a=Math.max(this.cropX,0),A=Math.max(this.cropY,0),d=t.naturalWidth||t.width,c=t.naturalHeight||t.height,u=a*r,h=A*o,f=Math.min(s*r,d-u),g=Math.min(i*o,c-h),m=-s/2,y=-i/2,b=Math.min(s,d/r-a),S=Math.min(i,c/o-A);t&&e.drawImage(t,u,h,f,g,m,y,b,S)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){const e=EF(this.preserveAspectRatio||""),t=this.width,r=this.height,o={width:t,height:r};let s,i=this._element.width,a=this._element.height,A=1,d=1,c=0,u=0,h=0,f=0;return!e||e.alignX===hs&&e.alignY===hs?(A=t/i,d=r/a):(e.meetOrSlice==="meet"&&(A=d=YI(this._element,o),s=(t-i*A)/2,e.alignX==="Min"&&(c=-s),e.alignX==="Max"&&(c=s),s=(r-a*d)/2,e.alignY==="Min"&&(u=-s),e.alignY==="Max"&&(u=s)),e.meetOrSlice==="slice"&&(A=d=JI(this._element,o),s=i-t/A,e.alignX==="Mid"&&(h=s/2),e.alignX==="Max"&&(h=s),s=a-r/d,e.alignY==="Mid"&&(f=s/2),e.alignY==="Max"&&(f=s),i=t/A,a=r/d)),{width:i,height:a,scaleX:A,scaleY:d,offsetLeft:c,offsetTop:u,cropX:h,cropY:f}}static fromObject(e,t){let{filters:r,resizeFilter:o,src:s,crossOrigin:i,type:a}=e,A=Un(e,$U);return Promise.all([Hf(s,We(We({},t),{},{crossOrigin:i})),r&&Cu(r,t),o&&Cu([o],t),og(A,t)]).then(d=>{let[c,u=[],[h]=[],f={}]=d;return new this(c,We(We({},A),{},{src:s,filters:u,resizeFilter:h},f))})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return Hf(e,{crossOrigin:t,signal:r}).then(s=>new this(s,o))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const o=Qa(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(o["xlink:href"],t,o).catch(s=>(wA("log","Unable to parse Image",s),null))}}Ge(Zo,"type","Image"),Ge(Zo,"cacheProperties",[...Ua,...F5]),Ge(Zo,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),Ge(Zo,"CSS_CANVAS","canvas-img"),Ge(Zo,"ATTRIBUTE_NAMES",[...zA,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),er.setClass(Zo),er.setSVGClass(Zo);ig(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const dg=n=>n.webgl!==void 0,P1="precision highp float",VU=`
    `.concat(P1,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),GU=["type"],WU=["type"],XU=new RegExp(P1,"g");class co{get type(){return this.constructor.type}constructor(){let e=Un(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},GU);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return VU}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:o="highp"}}=Gi();o!=="highp"&&(t=t.replace(XU,P1.replace("highp",o)));const s=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!i||!a)throw new Ni("Vertex, fragment shader or program creation error");if(e.shaderSource(s,r),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Ni("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Ni("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.attachShader(a,s),e.attachShader(a,i),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Ni('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const A=this.getUniformLocations(e,a)||{};return A.uStepW=e.getUniformLocation(a,"uStepW"),A.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:A}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const r=this.constructor.uniformLocations,o={};for(let s=0;s<r.length;s++)o[r[s]]=e.getUniformLocation(t,r[s]);return o}sendAttributeData(e,t,r){const o=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const r=e.destinationWidth,o=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===o||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){dg(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,r=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:r}=e,o=Wi({width:t,height:r});e.helpLayer=o}}toObject(){const e=Object.keys(this.constructor.defaults||{});return We({type:this.type},e.reduce((t,r)=>(t[r]=this[r],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(Un(e,WU))}}Ge(co,"type","BaseFilter"),Ge(co,"uniformLocations",[]);const YU={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class qh extends co{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(YU[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const r=new Ps(this.color).getSource(),o=this.alpha,s=r[0]*o,i=r[1]*o,a=r[2]*o,A=1-o;for(let d=0;d<t.length;d+=4){const c=t[d],u=t[d+1],h=t[d+2];let f,g,m;switch(this.mode){case"multiply":f=c*s/255,g=u*i/255,m=h*a/255;break;case"screen":f=255-(255-c)*(255-s)/255,g=255-(255-u)*(255-i)/255,m=255-(255-h)*(255-a)/255;break;case"add":f=c+s,g=u+i,m=h+a;break;case"difference":f=Math.abs(c-s),g=Math.abs(u-i),m=Math.abs(h-a);break;case"subtract":f=c-s,g=u-i,m=h-a;break;case"darken":f=Math.min(c,s),g=Math.min(u,i),m=Math.min(h,a);break;case"lighten":f=Math.max(c,s),g=Math.max(u,i),m=Math.max(h,a);break;case"overlay":f=s<128?2*c*s/255:255-2*(255-c)*(255-s)/255,g=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,m=a<128?2*h*a/255:255-2*(255-h)*(255-a)/255;break;case"exclusion":f=s+c-2*s*c/255,g=i+u-2*i*u/255,m=a+h-2*a*h/255;break;case"tint":f=s+c*A,g=i+u*A,m=a+h*A}t[d]=f,t[d+1]=g,t[d+2]=m}}sendUniformData(e,t){const r=new Ps(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}}Ge(qh,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),Ge(qh,"type","BlendColor"),Ge(qh,"uniformLocations",["uColor"]),er.setClass(qh);const JU={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},ZU=["type","image"];class Kh extends co{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return JU[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:o},filterBackend:{resources:s}}=e;const i=this.image;s.blendImage||(s.blendImage=bi());const a=s.blendImage,A=a.getContext("2d");a.width!==r||a.height!==o?(a.width=r,a.height=o):A.clearRect(0,0,r,o),A.setTransform(i.scaleX,0,0,i.scaleY,i.left,i.top),A.drawImage(i.getElement(),0,0,r,o);const d=A.getImageData(0,0,r,o).data;for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],f=t[c+2],g=t[c+3],m=d[c],y=d[c+1],b=d[c+2],S=d[c+3];switch(this.mode){case"multiply":t[c]=u*m/255,t[c+1]=h*y/255,t[c+2]=f*b/255,t[c+3]=g*S/255;break;case"mask":t[c+3]=S}}}sendUniformData(e,t){const r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return We(We({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:r,image:o}=e,s=Un(e,ZU);return Zo.fromObject(o,t).then(i=>new this(We(We({},s),{},{image:i})))}}Ge(Kh,"type","BlendImage"),Ge(Kh,"defaults",{mode:"multiply",alpha:1}),Ge(Kh,"uniformLocations",["uTransformMatrix","uImage"]),er.setClass(Kh);class $h extends co{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){dg(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:r,filterBackend:{resources:o}}=e;const{width:s,height:i}=r;o.blurLayer1||(o.blurLayer1=bi(),o.blurLayer2=bi());const a=o.blurLayer1,A=o.blurLayer2;a.width===s&&a.height===i||(A.width=a.width=s,A.height=a.height=i);const d=a.getContext("2d"),c=A.getContext("2d"),u=15,h=.06*this.blur*.5;let f,g,m,y;for(d.putImageData(r,0,0),c.clearRect(0,0,s,i),y=-15;y<=u;y++)f=(Math.random()-.5)/4,g=y/u,m=h*g*s+f,c.globalAlpha=1-Math.abs(g),c.drawImage(a,m,f),d.drawImage(A,0,0),c.globalAlpha=1,c.clearRect(0,0,A.width,A.height);for(y=-15;y<=u;y++)f=(Math.random()-.5)/4,g=y/u,m=h*g*i+f,c.globalAlpha=1-Math.abs(g),c.drawImage(a,f,m),d.drawImage(A,0,0),c.globalAlpha=1,c.clearRect(0,0,A.width,A.height);t.drawImage(a,0,0);const b=t.getImageData(0,0,a.width,a.height);return d.globalAlpha=1,d.clearRect(0,0,a.width,a.height),b}sendUniformData(e,t){const r=this.chooseRightDelta();e.uniform2fv(t.uDelta,r)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const r=e*this.blur*.12;return this.horizontal?t[0]=r:t[1]=r,t}}Ge($h,"type","Blur"),Ge($h,"defaults",{blur:0}),Ge($h,"uniformLocations",["uDelta"]),er.setClass($h);class Vh extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.round(255*this.brightness);for(let o=0;o<t.length;o+=4)t[o]+=r,t[o+1]+=r,t[o+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}Ge(Vh,"type","Brightness"),Ge(Vh,"defaults",{brightness:0}),Ge(Vh,"uniformLocations",["uBrightness"]),er.setClass(Vh);const I5={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class md extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,r=this.matrix,o=this.colorsOnly;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],A=t[s+2];if(t[s]=i*r[0]+a*r[1]+A*r[2]+255*r[4],t[s+1]=i*r[5]+a*r[6]+A*r[7]+255*r[9],t[s+2]=i*r[10]+a*r[11]+A*r[12]+255*r[14],!o){const d=t[s+3];t[s]+=d*r[3],t[s+1]+=d*r[8],t[s+2]+=d*r[13],t[s+3]=i*r[15]+a*r[16]+A*r[17]+d*r[18]+255*r[19]}}}sendUniformData(e,t){const r=this.matrix,o=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,o),e.uniform4fv(t.uConstants,s)}toObject(){return We(We({},super.toObject()),{},{matrix:[...this.matrix]})}}function yl(n,e){var t;const r=(Ge(t=class extends md{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),Ge(t,"defaults",{colorsOnly:!1,matrix:e}),t);return er.setClass(r,n),r}Ge(md,"type","ColorMatrix"),Ge(md,"defaults",I5),Ge(md,"uniformLocations",["uColorMatrix","uConstants"]),er.setClass(md);yl("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);yl("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);yl("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);yl("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);yl("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);yl("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);yl("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class Zw extends co{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){dg(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(r=>er.getClass(r.type).fromObject(r,t))).then(r=>new this({subFilters:r}))}}Ge(Zw,"type","Composed"),er.setClass(Zw);class Gh extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(let s=0;s<t.length;s+=4)t[s]=o*(t[s]-128)+128,t[s+1]=o*(t[s+1]-128)+128,t[s+2]=o*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}Ge(Gh,"type","Contrast"),Ge(Gh,"defaults",{contrast:0}),Ge(Gh,"uniformLocations",["uContrast"]),er.setClass(Gh);const eQ={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class Wh extends co{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return eQ[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,r=t.data,o=this.matrix,s=Math.round(Math.sqrt(o.length)),i=Math.floor(s/2),a=t.width,A=t.height,d=e.ctx.createImageData(a,A),c=d.data,u=this.opaque?1:0;let h,f,g,m,y,b,S,F,k,P,te,$,j;for(te=0;te<A;te++)for(P=0;P<a;P++){for(y=4*(te*a+P),h=0,f=0,g=0,m=0,j=0;j<s;j++)for($=0;$<s;$++)S=te+j-i,b=P+$-i,S<0||S>=A||b<0||b>=a||(F=4*(S*a+b),k=o[j*s+$],h+=r[F]*k,f+=r[F+1]*k,g+=r[F+2]*k,u||(m+=r[F+3]*k));c[y]=h,c[y+1]=f,c[y+2]=g,c[y+3]=u?r[y+3]:m}e.imageData=d}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return We(We({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}Ge(Wh,"type","Convolute"),Ge(Wh,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),Ge(Wh,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),er.setClass(Wh);const U5="Gamma";class Xh extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.gamma,o=1/r[0],s=1/r[1],i=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let A=0;A<256;A++)a.r[A]=255*Math.pow(A/255,o),a.g[A]=255*Math.pow(A/255,s),a.b[A]=255*Math.pow(A/255,i);for(let A=0;A<t.length;A+=4)t[A]=a.r[t[A]],t[A+1]=a.g[t[A+1]],t[A+2]=a.b[t[A+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:U5,gamma:this.gamma.concat()}}}Ge(Xh,"type",U5),Ge(Xh,"defaults",{gamma:[1,1,1]}),Ge(Xh,"uniformLocations",["uGamma"]),er.setClass(Xh);const tQ={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class Yh extends co{applyTo2d(e){let{imageData:{data:t}}=e;for(let r,o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2];switch(this.mode){case"average":r=(s+i+a)/3;break;case"lightness":r=(Math.min(s,i,a)+Math.max(s,i,a))/2;break;case"luminosity":r=.21*s+.72*i+.07*a}t[o+2]=t[o+1]=t[o]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return tQ[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}Ge(Yh,"type","Grayscale"),Ge(Yh,"defaults",{mode:"average"}),Ge(Yh,"uniformLocations",["uMode"]),er.setClass(Yh);const rQ=We(We({},I5),{},{rotation:0});class Cv extends md{calculateMatrix(){const e=this.rotation*Math.PI,t=Sa(e),r=Ea(e),o=1/3,s=Math.sqrt(o)*r,i=1-t;this.matrix=[t+i/3,o*i-s,o*i+s,0,0,o*i+s,t+o*i,o*i-s,0,0,o*i-s,o*i+s,t+o*i,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}Ge(Cv,"type","HueRotation"),Ge(Cv,"defaults",rQ),er.setClass(Cv);class Jh extends co{applyTo2d(e){let{imageData:{data:t}}=e;for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2],this.alpha&&(t[r+3]=255-t[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}Ge(Jh,"type","Invert"),Ge(Jh,"defaults",{alpha:!1,invert:!0}),Ge(Jh,"uniformLocations",["uInvert","uAlpha"]),er.setClass(Jh);class Zh extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.noise;for(let o=0;o<t.length;o+=4){const s=(.5-Math.random())*r;t[o]+=s,t[o+1]+=s,t[o+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}Ge(Zh,"type","Noise"),Ge(Zh,"defaults",{noise:0}),Ge(Zh,"uniformLocations",["uNoise","uSeed"]),er.setClass(Zh);class ef extends co{applyTo2d(e){let{imageData:{data:t,width:r,height:o}}=e;for(let s=0;s<o;s+=this.blocksize)for(let i=0;i<r;i+=this.blocksize){const a=4*s*r+4*i,A=t[a],d=t[a+1],c=t[a+2],u=t[a+3];for(let h=s;h<Math.min(s+this.blocksize,o);h++)for(let f=i;f<Math.min(i+this.blocksize,r);f++){const g=4*h*r+4*f;t[g]=A,t[g+1]=d,t[g+2]=c,t[g+3]=u}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}Ge(ef,"type","Pixelate"),Ge(ef,"defaults",{blocksize:4}),Ge(ef,"uniformLocations",["uBlocksize"]),er.setClass(ef);class tf extends co{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=255*this.distance,o=new Ps(this.color).getSource(),s=[o[0]-r,o[1]-r,o[2]-r],i=[o[0]+r,o[1]+r,o[2]+r];for(let a=0;a<t.length;a+=4){const A=t[a],d=t[a+1],c=t[a+2];A>s[0]&&d>s[1]&&c>s[2]&&A<i[0]&&d<i[1]&&c<i[2]&&(t[a+3]=0)}}sendUniformData(e,t){const r=new Ps(this.color).getSource(),o=this.distance,s=[0+r[0]/255-o,0+r[1]/255-o,0+r[2]/255-o,1],i=[r[0]/255+o,r[1]/255+o,r[2]/255+o,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,i)}}Ge(tf,"type","RemoveColor"),Ge(tf,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),Ge(tf,"uniformLocations",["uLow","uHigh"]),er.setClass(tf);class rf extends co{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),o=new Array(r);for(let s=1;s<=r;s++)o[s-1]=e(s*t);return o}generateShader(e){const t=new Array(e);for(let r=1;r<=e;r++)t[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((r,o)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(o,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(o,`];
              sum += 2.0 * uTaps[`).concat(o,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){dg(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const r=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){const t=e.imageData,r=this.scaleX,o=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/o;const s=t.width,i=t.height,a=Math.round(s*r),A=Math.round(i*o);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,i,a,A):this.resizeType==="hermite"?this.hermiteFastResize(e,s,i,a,A):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,i,a,A):this.resizeType==="lanczos"?this.lanczosResize(e,s,i,a,A):new ImageData(a,A),e.imageData=d}sliceByTwo(e,t,r,o,s){const i=e.imageData,a=.5;let A=!1,d=!1,c=t*a,u=r*a;const h=e.filterBackend.resources;let f=0,g=0;const m=t;let y=0;h.sliceByTwo||(h.sliceByTwo=bi());const b=h.sliceByTwo;(b.width<1.5*t||b.height<r)&&(b.width=1.5*t,b.height=r);const S=b.getContext("2d");for(S.clearRect(0,0,1.5*t,r),S.putImageData(i,0,0),o=Math.floor(o),s=Math.floor(s);!A||!d;)t=c,r=u,o<Math.floor(c*a)?c=Math.floor(c*a):(c=o,A=!0),s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,d=!0),S.drawImage(b,f,g,t,r,m,y,c,u),f=m,g=y,y+=u;return S.getImageData(f,g,o,s)}lanczosResize(e,t,r,o,s){const i=e.imageData.data,a=e.ctx.createImageData(o,s),A=a.data,d=this.lanczosCreate(this.lanczosLobes),c=this.rcpScaleX,u=this.rcpScaleY,h=2/this.rcpScaleX,f=2/this.rcpScaleY,g=Math.ceil(c*this.lanczosLobes/2),m=Math.ceil(u*this.lanczosLobes/2),y={},b={x:0,y:0},S={x:0,y:0};return function F(k){let P,te,$,j,J,we,D,N,Z,se,ce;for(b.x=(k+.5)*c,S.x=Math.floor(b.x),P=0;P<s;P++){for(b.y=(P+.5)*u,S.y=Math.floor(b.y),J=0,we=0,D=0,N=0,Z=0,te=S.x-g;te<=S.x+g;te++)if(!(te<0||te>=t)){se=Math.floor(1e3*Math.abs(te-b.x)),y[se]||(y[se]={});for(let re=S.y-m;re<=S.y+m;re++)re<0||re>=r||(ce=Math.floor(1e3*Math.abs(re-b.y)),y[se][ce]||(y[se][ce]=d(Math.sqrt(Math.pow(se*h,2)+Math.pow(ce*f,2))/1e3)),$=y[se][ce],$>0&&(j=4*(re*t+te),J+=$,we+=$*i[j],D+=$*i[j+1],N+=$*i[j+2],Z+=$*i[j+3]))}j=4*(P*o+k),A[j]=we/J,A[j+1]=D/J,A[j+2]=N/J,A[j+3]=Z/J}return++k<o?F(k):a}(0)}bilinearFiltering(e,t,r,o,s){let i,a,A,d,c,u,h,f,g,m,y,b,S,F=0;const k=this.rcpScaleX,P=this.rcpScaleY,te=4*(t-1),$=e.imageData.data,j=e.ctx.createImageData(o,s),J=j.data;for(h=0;h<s;h++)for(f=0;f<o;f++)for(c=Math.floor(k*f),u=Math.floor(P*h),g=k*f-c,m=P*h-u,S=4*(u*t+c),y=0;y<4;y++)i=$[S+y],a=$[S+4+y],A=$[S+te+y],d=$[S+te+4+y],b=i*(1-g)*(1-m)+a*g*(1-m)+A*m*(1-g)+d*g*m,J[F++]=b;return j}hermiteFastResize(e,t,r,o,s){const i=this.rcpScaleX,a=this.rcpScaleY,A=Math.ceil(i/2),d=Math.ceil(a/2),c=e.imageData.data,u=e.ctx.createImageData(o,s),h=u.data;for(let f=0;f<s;f++)for(let g=0;g<o;g++){const m=4*(g+f*o);let y=0,b=0,S=0,F=0,k=0,P=0,te=0;const $=(f+.5)*a;for(let j=Math.floor(f*a);j<(f+1)*a;j++){const J=Math.abs($-(j+.5))/d,we=(g+.5)*i,D=J*J;for(let N=Math.floor(g*i);N<(g+1)*i;N++){let Z=Math.abs(we-(N+.5))/A;const se=Math.sqrt(D+Z*Z);se>1&&se<-1||(y=2*se*se*se-3*se*se+1,y>0&&(Z=4*(N+j*t),te+=y*c[Z+3],S+=y,c[Z+3]<255&&(y=y*c[Z+3]/250),F+=y*c[Z],k+=y*c[Z+1],P+=y*c[Z+2],b+=y))}}h[m]=F/b,h[m+1]=k/b,h[m+2]=P/b,h[m+3]=te/S}return u}}Ge(rf,"type","Resize"),Ge(rf,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),Ge(rf,"uniformLocations",["uDelta","uTaps"]),er.setClass(rf);class nf extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.saturation;for(let o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2],A=Math.max(s,i,a);t[o]+=A!==s?(A-s)*r:0,t[o+1]+=A!==i?(A-i)*r:0,t[o+2]+=A!==a?(A-a)*r:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}Ge(nf,"type","Saturation"),Ge(nf,"defaults",{saturation:0}),Ge(nf,"uniformLocations",["uSaturation"]),er.setClass(nf);class of extends co{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.vibrance;for(let o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2],A=Math.max(s,i,a),d=(s+i+a)/3,c=2*Math.abs(A-d)/255*r;t[o]+=A!==s?(A-s)*c:0,t[o+1]+=A!==i?(A-i)*c:0,t[o+2]+=A!==a?(A-a)*c:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}Ge(of,"type","Vibrance"),Ge(of,"defaults",{vibrance:0}),Ge(of,"uniformLocations",["uVibrance"]),er.setClass(of);yo.prototype.toObject=function(n){return function(e=[]){return n.call(this,["data",...e])}}(yo.prototype.toObject);class Q5{constructor(e,t){this.currentScale=1,this.SNAP_THRESHOLD=10,this.resizeTimeout=null,this.originalWidth=t.width,this.originalHeight=t.height,this.aspectRatio=this.originalHeight/this.originalWidth,this.containerElement=t.containerElement,this.containerElement.style.height=`${this.containerElement.offsetWidth*this.aspectRatio}px`,this.canvas=new q0(e,{width:this.originalWidth,height:this.originalHeight,controlsAboveOverlay:!0,preserveObjectStacking:!0,selection:!0}),this.setupResizeObserver(),this.setupSnapBehavior(),this.setupSelectionBehavior()}toOriginalCoordinate(e){return e/this.currentScale}toScaledCoordinate(e){return e*this.currentScale}setupResizeObserver(){this.resizeObserver=new ResizeObserver(this.handleResize.bind(this)),this.resizeObserver.observe(this.containerElement)}handleResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.updateCanvasSize(),this.canvas.requestRenderAll()},100)}updateCanvasSize(){const e=this.containerElement.offsetWidth,t=this.canvas.backgroundImage?this.canvas.backgroundImage.height/this.canvas.backgroundImage.width:this.canvas.overlayImage?this.canvas.overlayImage.height/this.canvas.overlayImage.width:this.aspectRatio,r=e*t;this.containerElement.style.height=`${r}px`;const o=e/this.originalWidth;this.currentScale=o,this.canvas.setDimensions({width:e,height:r}),this.canvas.setViewportTransform([o,0,0,o,0,0]),this.canvas.requestRenderAll()}setupSnapBehavior(){this.canvas.on("object:moving",e=>{var A;const t=e.target;if(!t||((A=t.data)==null?void 0:A.editType)==="print")return;const o=this.canvas.getObjects().filter(d=>{var c;return((c=d.data)==null?void 0:c.editType)==="print"});let s=null,i=null;const a={left:t.left/this.currentScale,right:(t.left+t.width*t.scaleX)/this.currentScale,top:t.top,bottom:t.top+t.height*t.scaleY,centerX:t.left+t.width*t.scaleX/2,centerY:t.top+t.height*t.scaleY/2};for(const d of o){const c={left:d.left/this.currentScale,right:(d.left+d.width*d.scaleX)/this.currentScale,top:d.top,bottom:d.top+d.height*d.scaleY,centerX:d.left+d.width*d.scaleX/2,centerY:d.top+d.height*d.scaleY/2};Math.abs(a.left-c.left)<this.SNAP_THRESHOLD?s=c.left:Math.abs(a.right-c.right)<this.SNAP_THRESHOLD?s=c.right-t.width*t.scaleX:Math.abs(a.centerX-c.centerX)<this.SNAP_THRESHOLD&&(s=c.centerX-t.width*t.scaleX/2),Math.abs(a.top-c.top)<this.SNAP_THRESHOLD?i=c.top:Math.abs(a.bottom-c.bottom)<this.SNAP_THRESHOLD?i=c.bottom-t.height*t.scaleY:Math.abs(a.centerY-c.centerY)<this.SNAP_THRESHOLD&&(i=c.centerY-t.height*t.scaleY/2)}s!==null&&t.set("left",s),i!==null&&t.set("top",i)})}setupSelectionBehavior(){this.canvas.on("selection:created",e=>{var r,o;const t=(r=e.selected)==null?void 0:r[0];((o=t==null?void 0:t.data)==null?void 0:o.editType)==="print"&&this.canvas.discardActiveObject()}),this.canvas.on("mouse:down",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&t.data.objectId&&this.onPrintAreaClick&&this.onPrintAreaClick(t.data.objectId)}),this.canvas.on("mouse:over",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&(this.canvas.defaultCursor="pointer")}),this.canvas.on("mouse:out",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&(this.canvas.defaultCursor="default")})}setPrintAreaClickListener(e){this.onPrintAreaClick=e}async setCanvasJSON(e){console.log("json",e),await this.canvas.loadFromJSON(e),this.canvas.requestRenderAll()}addEditableArea(e){if(e.type==="rect"){const t=new pi({left:e.properties.x,top:e.properties.y,width:e.properties.width,height:e.properties.height,fill:"rgba(0,216,255,0.3)",stroke:"rgba(0,203,239,1)",strokeWidth:1,cornerStyle:"circle",transparentCorners:!1,cornerColor:"rgba(0,203,239,0.5)",cornerSize:10,lockRotation:!0,hasControls:!0,data:{editType:e.properties.editType,objectId:e.properties.objectId}});return this.canvas.add(t),this.canvas.requestRenderAll(),t}}removeObject(e){const r=this.canvas.getObjects().find(o=>{var s;return((s=o.data)==null?void 0:s.objectId)===e});r&&(this.canvas.remove(r),this.canvas.requestRenderAll())}setSelectionListener(e){this.canvas.on("selection:created",t=>{var r;return e(((r=t.selected)==null?void 0:r[0])??null)}),this.canvas.on("selection:updated",t=>{var r;return e(((r=t.selected)==null?void 0:r[0])??null)}),this.canvas.on("selection:cleared",()=>e(null))}zoomToPoint(e,t){const s=Math.min(Math.max(t,.1),3),i=new yt(e.x,e.y);this.canvas.zoomToPoint(i,s),this.canvas.requestRenderAll()}getCurrentScale(){return this.currentScale}destroy(){var e;(e=this.resizeObserver)==null||e.disconnect(),this.canvas.dispose()}getCanvas(){return this.canvas}getObjects(){return this.canvas.getObjects()}getCanvasJson(){return this.canvas.toJSON()}getCanvasImage(){return this.canvas.toDataURL({format:"png",quality:1,multiplier:1})}async setImage(e){return new Promise((t,r)=>{const o=new Image;o.onload=()=>{const s={width:o.width,height:o.height,dataUrl:e},i=800;let a=o.width,A=o.height;(a>i||A>i)&&(a>A?(A=i*A/a,a=i):(a=i*a/A,A=i));const d=document.createElement("canvas");d.width=a,d.height=A;const c=d.getContext("2d");c==null||c.drawImage(o,0,0,a,A);const u=d.toDataURL("image/jpeg",.9);Zo.fromURL(u,{crossOrigin:"anonymous"}).then(h=>{const f=this.canvas.getWidth(),g=this.canvas.getHeight(),m=A/a,y=g/f;m>y?h.scaleToHeight(g):h.scaleToWidth(f),this.canvas.getObjects().filter(S=>{var F;return((F=S.data)==null?void 0:F.editType)==="print"}).forEach(async S=>{const F=S;F.absolutePositioned=!0,F.fill="transparent";const k=S.width/h.width,P=S.height/h.height,te=Math.max(k,P),$=h.width*te,j=h.height*te;h.left=S.left+(S.width-$)/2,h.top=S.top+(S.height-j)/2,h.scaleToWidth($),h.scaleToHeight(j),h.clipPath=F}),this.canvas.add(h),this.canvas.requestRenderAll(),t({thumbnail:{width:a,height:A,dataUrl:u},original:s})}).catch(r)},o.onerror=()=>{r(new Error("  "))},o.src=e})}async setOverlay(e){try{const t=await Zo.fromURL(e,{crossOrigin:"anonymous"});this.setBackgroundOverlaySize(t),this.canvas.overlayImage=t,this.canvas.renderAll()}catch(t){throw console.error("     :",t),t}}async setBackground(e){try{const t=await Zo.fromURL(e,{crossOrigin:"anonymous"});this.setBackgroundOverlaySize(t),this.canvas.backgroundImage=t,this.canvas.requestRenderAll()}catch(t){throw console.error("     :",t),t}}async setBackgroundOverlaySize(e){const t=this.containerElement.offsetWidth,r=t*(e.height/e.width);this.originalWidth=t,this.originalHeight=r,this.aspectRatio=r/t,this.containerElement.style.height=`${r}px`,e.scaleToWidth(t),e.scaleToHeight(r),e.set({top:0,left:0,originX:"left",originY:"top"})}updateObjectDisabled(e){const r=this.canvas.getObjects().find(o=>{var s;return((s=o.data)==null?void 0:s.objectId)===e});r&&(r.set("fill","#cccccc"),r.set("opacity",.5),r.set("stroke","#cccccc"),r.set("strokeWidth",0),r.set("evented",!1)),this.canvas.requestRenderAll()}updateAllObjectEnabled(){this.canvas.getObjects().forEach(t=>{t.set("fill","rgba(0,216,255,0.3)"),t.set("opacity",1),t.set("stroke","rgba(0,203,239,1)"),t.set("strokeWidth",1),t.set("evented",!0)}),this.canvas.requestRenderAll()}}async function nQ(n,e="estimates",t){try{console.log("   :",{name:n.name,size:n.size,type:n.type,folder:e});const r=iQ(n);if(!r.isValid)return console.error("   :",r.errors),{success:!1,error:r.errors.join(", ")};const o=Date.now(),s=Math.random().toString(36).substring(2,8),i=aQ(n.name),a=`${o}_${s}_${i}`,A=`${e}/${a}`;console.log("   :",{fileName:a,filePath:A});const{data:d,error:c}=await ft.storage.from("uploads").upload(A,n,{cacheControl:"3600",upsert:!1});if(c)return console.error(" Storage  :",c),{success:!1,error:`  : ${c.message}`};console.log(" Storage  :",d);const{data:u}=ft.storage.from("uploads").getPublicUrl(A);if(!u.publicUrl)return console.error("  URL  "),{success:!1,error:"  URL  ."};console.log("  URL  :",u.publicUrl);const h={id:s,name:n.name,size:n.size,type:n.type,url:u.publicUrl,path:A,uploadedAt:new Date().toISOString()};return console.log("   :",h),{success:!0,file:h}}catch(r){return console.error("      :",r),{success:!1,error:r instanceof Error?r.message:"    ."}}}async function oQ(n,e="estimates",t){console.log("    :",{count:n.length,folder:e});const r=[];for(let s=0;s<n.length;s++){const i=n[s];console.log(`  ${s+1}/${n.length}  :`,i.name);const a=await nQ(i,e);if(r.push(a),t){const A=s+1,d=n.length,c=Math.round(A/d*100);t(A,d,c)}a.success||console.warn(`    (${s+1}/${n.length}):`,{fileName:i.name,error:a.error})}const o=r.filter(s=>s.success).length;return console.log("    :",{total:n.length,success:o,failed:n.length-o}),r}async function sQ(n){try{console.log("   :",n);const{error:e}=await ft.storage.from("uploads").remove([n]);return e?(console.error("   :",e),!1):(console.log("   :",n),!0)}catch(e){return console.error("    :",e),!1}}async function ey(n,e,t){try{console.log(" estimate_simple_prints   :",{estimateId:n,objectId:e,fileCount:t.length});const{data:r,error:o}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n).eq("object_id",e).single();if(o&&o.code!=="PGRST116")return console.error("    :",o),{success:!1,error:`   : ${o.message}`};const s={files:t,updatedAt:new Date().toISOString(),totalFiles:t.length,totalSize:t.reduce((i,a)=>i+a.size,0)};if(r){const{error:i}=await ft.from("estimate_simple_prints").update({uploaded_files:s,updated_at:new Date().toISOString()}).eq("id",r.id);if(i)return console.error("   :",i),{success:!1,error:`  : ${i.message}`};console.log("    :",r.id)}else{const{error:i}=await ft.from("estimate_simple_prints").insert({estimate_id:n,object_id:e,title:` ${e}`,print_method:"file-upload",uploaded_files:s,price:0,original_price:0,discount_amount:0});if(i)return console.error("    :",i),{success:!1,error:`   : ${i.message}`};console.log("    ")}return{success:!0}}catch(r){return console.error(" estimate_simple_prints   :",r),{success:!1,error:r instanceof Error?r.message:"    ."}}}function iQ(n){const e=[];n.size>52428800&&e.push(`   .  50MB  . (: ${Math.round(n.size/1024/1024)}MB)`);const r=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","application/pdf","application/postscript","application/illustrator","image/vnd.adobe.photoshop"],o=[".jpg",".jpeg",".png",".gif",".webp",".svg",".pdf",".eps",".ai",".psd"],s=n.name.toLowerCase(),i=o.some(A=>s.endsWith(A)),a=r.includes(n.type);return!i&&!a&&e.push("   . ( : JPG, PNG, GIF, PDF, AI, EPS, PSD, SVG)"),n.name.length>255&&e.push("  . 255  ."),{isValid:e.length===0,errors:e}}function aQ(n){return n.replace(/[^-a-zA-Z0-9._-]/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"")}function AQ(n){if(n===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(n)/Math.log(e));return parseFloat((n/Math.pow(e,r)).toFixed(2))+" "+t[r]}async function lQ(n,e){var t;try{console.log(" estimate_simple_prints   :",{estimateId:n,objectId:e});const{data:r,error:o}=await ft.from("estimate_simple_prints").select("uploaded_files, file_metadata").eq("estimate_id",n).eq("object_id",e).single();if(o)return o.code==="PGRST116"?{success:!0,files:[]}:(console.error("    :",o),{success:!1,files:[],error:`   : ${o.message}`});const s=r==null?void 0:r.uploaded_files;let i=(s==null?void 0:s.files)||[];return console.log(" DB  :",{hasUploadedFiles:!!s,uploadedFilesType:typeof s,uploadedFilesHasFiles:!!(s!=null&&s.files),uploadedFilesLength:((t=s==null?void 0:s.files)==null?void 0:t.length)||0,hasFileMetadata:!!(r!=null&&r.file_metadata),fileMetadataType:typeof(r==null?void 0:r.file_metadata),fileMetadataLength:Array.isArray(r==null?void 0:r.file_metadata)?r.file_metadata.length:0}),i.length===0&&(r!=null&&r.file_metadata)&&(console.log(" uploaded_files  - file_metadata  "),i=(Array.isArray(r.file_metadata)?r.file_metadata:[]).map(A=>({id:Math.random().toString(36).substring(2,8),name:A.name||"",size:A.size||0,type:A.type||"",url:A.url||"#",path:A.path||"",uploadedAt:new Date().toISOString()})),console.log(" file_metadata   :",{fileCount:i.length,files:i.map(A=>({name:A.name,hasUrl:A.url!=="#"}))})),console.log("    :",{fileCount:i.length,source:i.length>0&&(s!=null&&s.files)?"uploaded_files":"file_metadata"}),{success:!0,files:i}}catch(r){return console.error("     :",r),{success:!1,files:[],error:r instanceof Error?r.message:"    ."}}}var dQ=ee('<div class="odz-absolute -odz-top-2 -odz-right-2 odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div>'),cQ=ee('<button><!> <div class="odz-text-center"><span> </span></div></button>'),uQ=ee('<div class="odz-mt-3 odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-lg odz-p-3"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-2"><svg class="odz-w-4 odz-h-4 odz-text-blue-500 odz-animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-blue-700"> </span></div> <div class="odz-w-full odz-bg-blue-200 odz-rounded-full odz-h-2"><div class="odz-bg-blue-600 odz-h-2 odz-rounded-full odz-transition-all odz-duration-300"></div></div></div>'),hQ=ee('<div class="odz-mt-3 odz-flex odz-items-center odz-gap-2 odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-red-700"> </span></div>'),fQ=ee('<a target="_blank" rel="noopener noreferrer" class="odz-p-1 odz-text-blue-600 hover:odz-text-blue-800 hover:odz-bg-blue-50 odz-rounded" title=" "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg></a>'),pQ=ee('<button class="odz-p-1 odz-text-gray-400 odz-cursor-not-allowed odz-rounded" disabled title="  .   ."><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"></path></svg></button>'),gQ=ee('<div class="odz-flex odz-items-center odz-justify-between odz-bg-white odz-border odz-border-gray-200 odz-rounded-lg odz-p-3"><div class="odz-flex odz-items-center odz-gap-2 odz-min-w-0 odz-flex-1"><svg class="odz-w-4 odz-h-4 odz-text-gray-500 odz-flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <div class="odz-min-w-0 odz-flex-1"><p class="odz-text-sm odz-font-medium odz-text-gray-900 odz-truncate"> </p> <p class="odz-text-xs odz-text-gray-500"> </p></div></div> <div class="odz-flex odz-items-center odz-gap-2"><!> <button class="odz-p-1 odz-text-red-600 hover:odz-text-red-800 hover:odz-bg-red-50 odz-rounded" title=" "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>'),vQ=ee('<div class="odz-mt-3"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3 odz-bg-green-50 odz-border odz-border-green-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-green-700"> </span></div> <div class="odz-space-y-2"></div></div>'),mQ=ee('<div class="odz-flex odz-items-center odz-gap-1 odz-text-xs odz-text-gray-600 odz-bg-gray-50 odz-px-2 odz-py-1 odz-rounded odz-min-w-0"><span class="odz-flex-shrink-0"></span> <span class="odz-truncate odz-min-w-0"> </span> <span class="odz-flex-shrink-0"> </span></div>'),wQ=ee('<div class="odz-mt-3 odz-flex odz-items-center odz-gap-2 odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-blue-700"> </span></div> <div class="odz-mt-2 odz-space-y-1"></div>',1),yQ=ee(`<div class="odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-100 odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-justify-between odz-mb-6"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-w-8 odz-h-8 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><span class="odz-text-white odz-font-bold odz-text-sm"></span></div> <div><h3 class="odz-text-lg odz-font-bold odz-text-gray-800"> </h3> <p class="odz-text-sm odz-text-gray-600">  </p></div></div> <button class="odz-w-8 odz-h-8 odz-flex odz-items-center odz-justify-center odz-text-gray-400 hover:odz-text-red-500
                                   hover:odz-bg-red-50 odz-rounded-full odz-transition-all odz-duration-200" aria-label="  "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="odz-mb-6"><div class="odz-block odz-text-sm odz-font-bold odz-text-gray-700 odz-mb-3"> </div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div></div> <div class="odz-mb-4"><label class="odz-block odz-text-sm odz-font-bold odz-text-gray-700 odz-mb-3">  </label> <div class="odz-relative"><input type="file" multiple accept="image/*,.pdf,.ai,.eps" class="odz-absolute odz-inset-0 odz-w-full odz-h-full odz-opacity-0 odz-cursor-pointer"> <div class="odz-bg-white odz-border-2 odz-border-dashed odz-border-gray-300 odz-rounded-xl odz-p-6
                                       hover:odz-border-red-300 hover:odz-bg-red-50 odz-transition-colors odz-duration-200"><div class="odz-text-center"><svg class="odz-w-8 odz-h-8 odz-text-gray-400 odz-mx-auto odz-mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <p class="odz-text-sm odz-text-gray-600 odz-mb-1">   </p> <p class="odz-text-xs odz-text-gray-500">, PDF, AI, EPS  </p></div></div></div> <!> <!> <!> <!></div></div>`),bQ=ee('<div class="odz-mt-2 odz-flex odz-items-center odz-gap-2 odz-text-xs odz-text-gray-500"><svg class="odz-w-3 odz-h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> <span> </span></div>'),_Q=ee(`<div><div class="odz-flex odz-items-center odz-gap-3 odz-mb-6"><div class="odz-w-10 odz-h-10 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-5 odz-h-5 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2c0-.552.448-1 1-1h8c.552 0 1 .448 1 1v2M7 4h10M7 4l-.5 14c-.051 1.096.846 2 1.5 2h8c.654 0 1.551-.904 1.5-2L17 4"></path></svg></div> <div><h2 class="odz-text-xl odz-font-bold odz-text-gray-800">  </h2> <p class="odz-text-sm odz-text-gray-600"> </p></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-4"></div> <div class="odz-mt-6"><div class="odz-bg-white odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-4"><div class="odz-w-8 odz-h-8 odz-bg-blue-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-4 odz-h-4 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div> <div><h3 class="odz-text-lg odz-font-bold odz-text-gray-800">  </h3> <p class="odz-text-sm odz-text-gray-600">    </p></div></div> <textarea class="odz-w-full odz-h-24 odz-p-4 odz-border-2 odz-border-gray-200 odz-rounded-xl
                           odz-resize-none odz-text-sm odz-text-gray-700
                           focus:odz-border-blue-400 focus:odz-ring-2 focus:odz-ring-blue-100 focus:odz-outline-none
                           placeholder:odz-text-gray-400 odz-transition-all odz-duration-200" placeholder=":    ,     ,     "></textarea> <!></div></div></div>`),BQ=ee('<div><div class="odz-text-center odz-text-gray-500 odz-py-10 odz-border odz-border-dashed odz-border-gray-300 odz-rounded-2xl"><svg class="odz-w-12 odz-h-12 odz-text-gray-300 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2c0-.552.448-1 1-1h8c.552 0 1 .448 1 1v2M7 4h10M7 4l-.5 14c-.051 1.096.846 2 1.5 2h8c.654 0 1.551-.904 1.5-2L17 4"></path></svg> <p class="odz-text-lg odz-font-medium odz-mb-2">  </p> <p class="odz-text-sm"><span class="lg:odz-hidden"> </span><span class="odz-hidden lg:odz-inline"> </span>      .</p></div></div>'),xQ=ee('<div class="odz-flex odz-flex-col odz-gap-6"><h1 class="odz-text-xl odz-font-bold odz-my-3 odz-flex odz-items-center odz-gap-5">  <span class="odz-text-sm odz-font-normal odz-text-gray-500">   .</span></h1> <div class="odz-flex odz-flex-col lg:odz-flex-row odz-gap-6"><div class="odz-flex-1 lg:odz-w-1/2"><div class="odz-relative odz-w-full odz-bg-gray-50 odz-border-2 odz-border-gray-200 odz-rounded-xl" style="min-width: 200px; min-height: 400px;"><canvas class="odz-absolute odz-top-0 odz-left-0 odz-w-full odz-h-full odz-rounded-xl" style="image-rendering: pixelated;"></canvas></div> <p class="odz-text-sm odz-text-gray-500 odz-mt-4">          .</p></div> <div class="odz-flex-1 lg:odz-w-1/2"><!></div></div></div>');function zQ(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=()=>Xr(Ls,"$shopStore",t);let i=pt(e,"productId",8),a=pt(e,"estimateId",8,void 0);pt(e,"idx",8,void 0),pt(e,"onComplete",8),pt(e,"onCancel",8,()=>{});let A=null,d=[],c=Ie(),u=Ie(),h=Ie(),f=Ie([]),g=Ie(!1);En(async()=>{let K=!1;try{await Promise.race([m(),new Promise((ae,x)=>setTimeout(()=>x(new Error("  timeout (10)")),1e4))]),K=!0}catch{}try{K&&(await Oi(),await new Promise(ae=>setTimeout(ae,100))),await y()}catch{}const oe=ae=>{ae.detail.productId===i()&&(console.log(" SimplePrint   :",i()),F())};return window.addEventListener("saveSimplePrintState",oe),()=>{window.removeEventListener("saveSimplePrintState",oe)}}),Eo(()=>{try{if(l(f).length>0){const K=l(f).map(x=>({objectId:x.objectId,title:x.title,printMethod:x.printMethod,savedFileInfo:x.savedFileInfo||x.uploadedFiles.map(E=>({name:E.name,size:E.size,type:E.type,url:E.url,path:E.path}))})),oe=o().estimateId||"temp",ae=`simplePrint_${i()}_${oe}`;sessionStorage.setItem(ae,JSON.stringify(K))}}catch{}l(h)&&l(h).destroy()});async function m(){await Oi();let K=0;const oe=50;for(;K<oe&&!l(u);)await new Promise(ae=>setTimeout(ae,100)),K++;if(!l(u))throw new Error("    .");try{if(A=await SB(i(),s().id),A!=null&&A.id&&(d=await EB(A.id)),A!=null&&A.canvas_json){const ae=typeof A.canvas_json=="string"?JSON.parse(A.canvas_json):A.canvas_json,x=ae.backgroundImage.width*ae.backgroundImage.scaleX,E=ae.backgroundImage.height*ae.backgroundImage.scaleY;_(h,new Q5(l(u),{width:x,height:E,containerElement:l(c)})),l(h).setPrintAreaClickListener(async I=>{k(I)}),await l(h).setCanvasJSON(ae),await new Promise(I=>setTimeout(I,200))}}catch(ae){throw ae}}async function y(){var K,oe;if(l(h)){let ae=0;const x=30;for(;ae<x;){try{if((((oe=(K=l(h)).getObjects)==null?void 0:oe.call(K))||[]).length>0)break}catch{}ae++,await new Promise(E=>setTimeout(E,100))}}try{const ae=a()||o().estimateId||"temp",x=ae!=="temp";let E=[];const I=`simplePrint_${i()}_${ae}`,L=sessionStorage.getItem(I);L&&(E=JSON.parse(L)),E&&Array.isArray(E)&&E.length>0&&(_(g,!0),_(f,E.map(M=>({objectId:M.objectId,title:M.title,printMethod:M.printMethod||"",uploadedFiles:[],savedFileInfo:M.savedFileInfo||[]}))),await b(),l(h)&&(await Oi(),await new Promise(M=>setTimeout(M,50)),P()),_(g,!1))}catch{_(g,!1)}}async function b(){for(const K of l(f))try{if(o().estimateId){const oe=await lQ(o().estimateId,K.objectId);if(oe.success&&oe.files.length>0){_(f,l(f).map(ae=>ae.objectId===K.objectId?{...ae,uploadedFiles:oe.files}:ae));continue}}if(K.savedFileInfo&&K.savedFileInfo.length>0){const oe=K.savedFileInfo.map(ae=>({id:Math.random().toString(36).substring(2,8),name:ae.name,size:ae.size,type:ae.type,url:ae.url||"#",path:ae.path||"",uploadedAt:new Date().toISOString()}));_(f,l(f).map(ae=>ae.objectId===K.objectId?{...ae,uploadedFiles:oe}:ae))}}catch{if(K.savedFileInfo&&K.savedFileInfo.length>0){const ae=K.savedFileInfo.map(x=>({id:Math.random().toString(36).substring(2,8),name:x.name,size:x.size,type:x.type,url:x.url||"#",path:x.path||"",uploadedAt:new Date().toISOString()}));_(f,l(f).map(x=>x.objectId===K.objectId?{...x,uploadedFiles:ae}:x))}}}async function S(K,oe){try{if(!await sQ(oe.path))throw new Error("Storage   .");if(_(f,l(f).map(x=>{var E;return x.objectId===K?{...x,uploadedFiles:x.uploadedFiles.filter(I=>I.id!==oe.id),savedFileInfo:(E=x.savedFileInfo)==null?void 0:E.filter(I=>I.name!==oe.name)}:x})),o().estimateId){const x=l(f).find(E=>E.objectId===K);x&&await ey(o().estimateId,K,x.uploadedFiles)}F()}catch(ae){_(f,l(f).map(x=>x.objectId===K?{...x,uploadError:`  : ${ae instanceof Error?ae.message:"   "}`}:x)),setTimeout(()=>{_(f,l(f).map(x=>x.objectId===K?{...x,uploadError:void 0}:x))},3e3)}}function F(){if(!l(g))try{const K=l(f).map(x=>({objectId:x.objectId,title:x.title,printMethod:x.printMethod,savedFileInfo:x.savedFileInfo||x.uploadedFiles.map(E=>({name:E.name,size:E.size,type:E.type,url:E.url,path:E.path}))})),oe=o().estimateId||"temp",ae=`simplePrint_${i()}_${oe}`;if(sessionStorage.setItem(ae,JSON.stringify(K)),typeof window<"u")try{const x=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.saveCurrentState"}});window.dispatchEvent(x)}catch{}}catch{}}function k(K){if(l(f).find(I=>I.objectId===K))return;const ae=d.find(I=>I.object_id===K),x=ae?ae.title:`${K} `,E={objectId:K,title:x,printMethod:"",uploadedFiles:[],isUploading:!1,uploadProgress:0,uploadError:void 0,savedFileInfo:[]};_(f,[...l(f),E]),P(),F()}function P(){if(l(h))try{l(h).updateAllObjectEnabled(),l(f).forEach(K=>{l(h).updateObjectDisabled(K.objectId)})}catch{}}function te(K){if(_(f,l(f).filter(oe=>oe.objectId!==K)),Et.cancelPrint(o().index,K),P(),F(),typeof window<"u")try{const oe=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.removePrintFromArea"}});window.dispatchEvent(oe)}catch{}}function $(K,oe){if(_(f,l(f).map(ae=>ae.objectId===K?{...ae,printMethod:oe}:ae)),F(),typeof window<"u")try{const ae=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.updatePrintMethod"}});window.dispatchEvent(ae)}catch{}}async function j(K,oe){const ae=Array.from(oe);_(f,l(f).map(x=>x.objectId===K?{...x,isUploading:!0,uploadProgress:0,uploadError:void 0}:x));try{const x=await oQ(ae,`estimates/${o().estimateId||"temp"}`,(M,H,q)=>{_(f,l(f).map(G=>G.objectId===K?{...G,uploadProgress:q}:G))}),E=x.filter(M=>M.success&&M.file).map(M=>M.file),I=x.filter(M=>!M.success);if(E.length>0&&o().estimateId){const M=await ey(o().estimateId,K,E);if(!M.success)throw new Error(M.error||"  .")}const L=ae.map(M=>({name:M.name,size:M.size,type:M.type}));if(_(f,l(f).map(M=>M.objectId===K?{...M,uploadedFiles:E,isUploading:!1,uploadProgress:100,uploadError:I.length>0?`${I.length}   `:void 0,savedFileInfo:L}:M)),F(),typeof window<"u")try{const M=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.handleFileUpload"}});window.dispatchEvent(M)}catch{}if(I.length>0){const M=I.map(H=>H.error).join(", ")}}catch(x){_(f,l(f).map(E=>E.objectId===K?{...E,isUploading:!1,uploadProgress:0,uploadError:x instanceof Error?x.message:"  ."}:E))}}function J(K){const ae=K.target.value;Et.update(x=>({...x,uploadMemo:ae}))}Zt(()=>(l(f),l(h),l(g)),()=>{l(f)&&l(h)&&!l(g)&&P()}),Zn(),qr();var we=xQ(),D=z(w(we),2),N=w(D),Z=w(N),se=w(Z);ts(se,K=>_(u,K),()=>l(u)),ts(Z,K=>_(c,K),()=>l(c));var ce=z(N,2),re=w(ce);{var pe=K=>{var oe=_Q(),ae=w(oe),x=z(w(ae),2),E=z(w(x),2),I=w(E),L=z(ae,2);Jt(L,5,()=>l(f),ar,(he,Be,be)=>{var Le=yQ(),Y=w(Le),O=w(Y),ve=w(O),xe=w(ve);xe.textContent=be+1;var me=z(ve,2),le=w(me),ze=w(le),ke=z(O,2),de=z(Y,2),Fe=z(w(de),2);Jt(Fe,4,()=>["","","",""," "],ar,(_e,Ue)=>{var Me=cQ();const je=it(()=>l(Be).printMethod===Ue);var At=w(Me);{var ut=tt=>{var rt=dQ();T(tt,rt)};Se(At,tt=>{l(je)&&tt(ut)})}var ht=z(At,2),Re=w(ht),Xe=w(Re);He(()=>{Ir(Me,`odz-group odz-relative odz-bg-white odz-border-2 odz-rounded-xl odz-p-3 odz-transition-all odz-duration-200
                                           ${(l(je)?"odz-border-red-400 odz-bg-gradient-to-br odz-from-red-50 odz-to-rose-50 odz-shadow-md odz-scale-105":"odz-border-gray-200 hover:odz-border-red-200 hover:odz-shadow-md hover:odz-scale-[1.02]")??""}`),Ir(Re,`odz-text-sm odz-font-semibold ${(l(je)?"odz-text-red-700":"odz-text-gray-700")??""}`),Qe(Xe,Ue)}),at("click",Me,()=>$(l(Be).objectId,Ue)),T(_e,Me)});var U=z(de,2),Ae=w(U),fe=z(Ae,2),Ce=w(fe),ge=z(fe,2);{var De=_e=>{var Ue=uQ(),Me=w(Ue),je=z(w(Me),2),At=w(je),ut=z(Me,2),ht=w(ut);He(()=>{Qe(At,`  ... ${l(Be).uploadProgress||0}%`),nr(ht,"style",`width: ${l(Be).uploadProgress||0}%`)}),T(_e,Ue)};Se(ge,_e=>{l(Be).isUploading&&_e(De)})}var Ne=z(ge,2);{var Ze=_e=>{var Ue=hQ(),Me=z(w(Ue),2),je=w(Me);He(()=>Qe(je,l(Be).uploadError)),T(_e,Ue)};Se(Ne,_e=>{l(Be).uploadError&&_e(Ze)})}var Oe=z(Ne,2);{var Ke=_e=>{var Ue=vQ(),Me=w(Ue),je=z(w(Me),2),At=w(je),ut=z(Me,2);Jt(ut,5,()=>l(Be).uploadedFiles,ar,(ht,Re)=>{var Xe=gQ(),tt=w(Xe),rt=z(w(tt),2),Bt=w(rt),nt=w(Bt),ot=z(Bt,2),xt=w(ot),Lt=z(tt,2),_t=w(Lt);{var vt=Ct=>{var Ft=fQ();He(()=>nr(Ft,"href",l(Re).url)),T(Ct,Ft)},Pt=Ct=>{var Ft=pQ();T(Ct,Ft)};Se(_t,Ct=>{l(Re).url&&l(Re).url!=="#"?Ct(vt):Ct(Pt,!1)})}var kt=z(_t,2);He(Ct=>{nr(Bt,"title",l(Re).name),Qe(nt,l(Re).name),Qe(xt,Ct)},[()=>AQ(l(Re).size)],it),at("click",kt,()=>S(l(Be).objectId,l(Re))),T(ht,Xe)}),He(()=>Qe(At,`${l(Be).uploadedFiles.length??""}  `)),T(_e,Ue)};Se(Oe,_e=>{l(Be).uploadedFiles.length>0&&_e(Ke)})}var Je=z(Oe,2);{var Te=_e=>{var Ue=wQ(),Me=gt(Ue),je=z(w(Me),2),At=w(je),ut=z(Me,2);Jt(ut,5,()=>l(Be).savedFileInfo,ar,(ht,Re)=>{var Xe=mQ(),tt=z(w(Xe),2),rt=w(tt),Bt=z(tt,2),nt=w(Bt);He(ot=>{nr(tt,"title",l(Re).name),Qe(rt,l(Re).name),Qe(nt,`(${ot??""}KB)`)},[()=>Math.round(l(Re).size/1024)],it),T(ht,Xe)}),He(()=>Qe(At,`  ${l(Be).savedFileInfo.length??""}    (  )`)),T(_e,Ue)};Se(Je,_e=>{l(Be).savedFileInfo&&l(Be).savedFileInfo.length>0&&l(Be).uploadedFiles.length===0&&_e(Te)})}He(()=>{Qe(ze,l(Be).title),nr(Ae,"for",`file-upload-${l(Be).objectId??""}`),nr(Ce,"id",`file-upload-${l(Be).objectId??""}`)}),at("click",ke,()=>te(l(Be).objectId)),at("change",Ce,_e=>j(l(Be).objectId,_e.target.files)),T(he,Le)});var M=z(L,2),H=w(M),q=z(w(H),2),G=z(q,2);{var R=he=>{var Be=bQ(),be=z(w(Be),2),Le=w(be);He(Y=>Qe(Le,`${Y??""} `),[()=>o().uploadMemo.trim().length],it),T(he,Be)};Se(G,he=>{o().uploadMemo&&o().uploadMemo.trim().length>0&&he(R)})}He(()=>Qe(I,`${l(f).length??""}  `)),br(q,()=>o().uploadMemo,he=>Kt(Et,lt(o).uploadMemo=he,lt(o))),at("input",q,J),T(K,oe)},V=K=>{var oe=BQ();T(K,oe)};Se(re,K=>{l(f).length>0?K(pe):K(V,!1)})}T(n,we),jr(),r()}const Au="uploads";function CQ(n){try{const e=n.match(/^data:(.+);base64,(.+)$/);if(!e||e.length!==3)return console.error("Invalid base64 data URL format"),null;const t=e[1],r=e[2],o=atob(r),s=new Array(o.length);for(let A=0;A<o.length;A++)s[A]=o.charCodeAt(A);const i=new Uint8Array(s);return{blob:new Blob([i],{type:t}),contentType:t}}catch(e){return console.error("Error converting base64 to Blob:",e),null}}function SQ(n){const e=n.lastIndexOf("."),t=e>0?n.substring(0,e):n,r=e>0?n.substring(e):"";let o=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"").replace(/\s+/g,"_").replace(/[<>:"/\\|?*]/g,"").replace(/_{2,}/g,"_").replace(/^_|_$/g,"").substring(0,200);o||(o=`file_${Date.now()}`);const s=r.replace(/[^\x00-\x7F]/g,"").toLowerCase();return o+s}async function EQ(n,e){var t;try{let r,o,s={};if(n instanceof File)o=n,s.contentType=n.type;else if(typeof n=="string"&&n.startsWith("data:")){const a=CQ(n);if(!a)throw new Error("Failed to convert base64 string to Blob.");o=a.blob,s.contentType=a.contentType}else throw new Error("Invalid data type provided. Must be a File object or a base64 data URL string.");if(console.log(`Uploading to bucket: ${Au}, path: ${e}, contentType: ${s.contentType}`),r=await ft.storage.from(Au).upload(e,o,{cacheControl:"3600",upsert:!0,contentType:s.contentType}),r.error)throw console.error("Supabase upload error:",r.error),r.error;if(!((t=r.data)!=null&&t.path))throw new Error("Upload successful but no path returned.");const{data:i}=ft.storage.from(Au).getPublicUrl(r.data.path);return i!=null&&i.publicUrl?(console.log("File uploaded successfully:",i.publicUrl),i.publicUrl):(console.warn("Could not get public URL after upload."),null)}catch(r){return console.error("Error in uploadImage function:",r),null}}async function FQ(n){if(!n)return console.error("deleteImage: filePath is required."),!1;console.log(`Attempting to delete file from bucket: ${Au}, path: ${n}`);try{const{data:e,error:t}=await ft.storage.from(Au).remove([n]);if(t)throw console.error("Supabase delete error:",t),t;return e&&e.length>0?(console.log(`File deleted successfully: ${n}`),!0):(console.warn(`File deletion response for ${n} was successful but no data returned. It might have already been deleted or the path was incorrect.`),!0)}catch(e){return console.error("Error in deleteImage function:",e),!1}}var IQ=ee('<th class="odz-bg-base-200"> </th>'),UQ=ee('<td><input class="odz-input odz-input-bordered odz-w-full odz-input-sm" type="text" placeholder=" "></td>'),QQ=ee('<tr><td><input type="checkbox" class="odz-checkbox"></td><th class="odz-text-sm odz-font-normal odz-whitespace-nowrap"> </th><!></tr>'),TQ=ee('<td><div class="odz-flex odz-gap-1"><input class="odz-input odz-input-bordered odz-w-full odz-input-sm" type="text" placeholder="  "> <button class="odz-btn odz-btn-secondary odz-btn-sm"></button></div></td>'),LQ=ee('<div class="odz-overflow-x-auto odz-mt-4"><table class="odz-table odz-table-zebra odz-w-full"><thead><tr><th class="odz-bg-base-200 odz-w-10"><input type="checkbox" class="odz-checkbox"></th><th class="odz-bg-base-200"></th><!></tr></thead><tbody><!><tr class="odz-bg-base-100"><td colspan="2" class="odz-font-bold">  </td><!></tr></tbody></table> <div class="odz-mt-4"><button class="odz-btn odz-btn-primary odz-w-full"></button></div></div>');function PQ(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=Ie(),i=Ie(),a=Ie(),A=Ie();let d=pt(e,"onComplete",8,()=>{}),c=pt(e,"nameSheet",28,()=>({})),u=Ie({});En(()=>{_(u,JSON.parse(JSON.stringify(c())))});let h=Ie({}),f=Ie({});function g(re){const pe={...l(h)};l(a).forEach(V=>{pe[V.id]=re}),_(h,pe)}function m(re){const pe=l(f)[re]||"",V={...l(u)};l(a).forEach(K=>{l(h)[K.id]&&(V[K.title]||(V[K.title]={}),V[K.title][l(y)[re]||re]=pe)}),_(u,V)}let y=Ie({});function b(re,pe,V,K,oe){l(u)[pe]||hr(u,l(u)[pe]={}),hr(u,l(u)[pe][K]=oe)}function S(){l(a).forEach(re=>{l(u)[re.title]||hr(u,l(u)[re.title]={}),l(A).forEach(pe=>{const V=l(y)[pe.objectId]||pe.objectId;l(u)[re.title][V]===void 0&&hr(u,l(u)[re.title][V]="")})}),c(JSON.parse(JSON.stringify(l(u)))),console.log("  :",c()),d()(c())}Zt(()=>o(),()=>{_(s,o().products[o().index])}),Zt(()=>l(s),()=>{var re;_(i,((re=l(s))==null?void 0:re.variants)||[])}),Zt(()=>l(i),()=>{_(a,[...l(i)].sort((re,pe)=>re.title.localeCompare(pe.title)))}),Zt(()=>l(s),()=>{var re;_(A,((re=l(s))==null?void 0:re.prints)||[])}),Zt(()=>(l(A),l(y),dp),()=>{l(A)&&l(A).length>0&&l(A).forEach(async re=>{if(re.objectId&&!l(y)[re.objectId])try{const pe=await dp(re.objectId);_(y,{...l(y),[re.objectId]:(pe==null?void 0:pe.title)||re.objectId})}catch{_(y,{...l(y),[re.objectId]:re.objectId})}})}),Zt(()=>(l(a),l(A),l(u),l(y),zn(c())),()=>{if(l(a).length>0&&l(A).length>0){const re={...l(u)};l(a).forEach(pe=>{re[pe.title]||(re[pe.title]={}),l(A).forEach(V=>{var oe;const K=l(y)[V.objectId]||V.objectId;re[pe.title][K]===void 0&&(re[pe.title][K]=((oe=c()[pe.title])==null?void 0:oe[K])||"")})}),_(u,re)}}),Zt(()=>(l(a),l(h)),()=>{l(a)&&l(a).length>0&&l(a).forEach(re=>{l(h)[re.id]===void 0&&_(h,{...l(h),[re.id]:!0})})}),Zn(),qr();var F=LQ(),k=w(F),P=w(k),te=w(P),$=w(te),j=w($),J=z($,2);Jt(J,1,()=>l(A),ar,(re,pe)=>{var V=IQ(),K=w(V);He(()=>Qe(K,l(y)[l(pe).objectId]||l(pe).objectId)),T(re,V)});var we=z(P),D=w(we);Jt(D,1,()=>l(a),ar,(re,pe)=>{var V=QQ(),K=w(V),oe=w(K),ae=z(K),x=w(ae),E=z(ae);Jt(E,1,()=>l(A),ar,(I,L)=>{var M=UQ(),H=w(M);He(()=>{var q;return Xm(H,((q=l(u)[l(pe).title])==null?void 0:q[l(y)[l(L).objectId]||l(L).objectId])||"")}),at("input",H,q=>b(l(pe).id,l(pe).title,l(L).objectId,l(y)[l(L).objectId]||l(L).objectId,q.target.value)),T(I,M)}),He(()=>Qe(x,l(pe).title)),m0(oe,()=>l(h)[l(pe).id],I=>hr(h,l(h)[l(pe).id]=I)),T(re,V)});var N=z(D),Z=z(w(N));Jt(Z,1,()=>l(A),ar,(re,pe)=>{var V=TQ(),K=w(V),oe=w(K),ae=z(oe,2);br(oe,()=>l(f)[l(pe).objectId],x=>hr(f,l(f)[l(pe).objectId]=x)),at("click",ae,()=>m(l(pe).objectId)),T(re,V)});var se=z(k,2),ce=w(se);He(re=>mu(j,re),[()=>Object.values(l(h)).every(re=>re)],it),at("change",j,re=>g(re.target.checked)),at("click",ce,S),T(n,F),jr(),r()}var kQ=ee('<span class="odz-text-info odz-inline-flex odz-items-center odz-gap-1"><!>  ...</span>'),OQ=ee('<span class="odz-text-success"> </span>'),DQ=ee('<span class="odz-text-error"> </span>'),NQ=ee('<span class="odz-text-gray-500"> </span>'),MQ=ee('<a target="_blank" rel="noopener noreferrer" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square odz-text-blue-600 hover:odz-text-blue-800 hover:odz-bg-blue-50" aria-label=" " title="   "><!></a>'),HQ=ee('<div class="odz-flex odz-items-center odz-gap-4 odz-p-3 odz-bg-base-200 odz-rounded-lg odz-relative"><div class="odz-flex-1 odz-min-w-0"><p class="odz-font-medium odz-truncate"> </p> <p class="odz-text-sm odz-text-base-content/70"><!> <!></p></div> <!> <button class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square" aria-label=" "><!></button></div>'),jQ=ee('<div class="odz-mt-4 odz-flex odz-flex-col odz-gap-2"></div>'),RQ=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button></form> <!></div></dialog>'),qQ=ee('<label for="nameSheet" class="odz-label odz-label-text odz-text-sm odz-mt-4 odz-ml-4 odz-font-bold">       .</label> <div class="odz-card-actions odz-p-4 odz-justify-start"><button class="odz-btn odz-btn-secondary odz-min-w-32"> </button></div> <!>',1),KQ=ee("<!>  ...",1),$Q=ee("<!>  ...",1),VQ=ee('<div class="odz-card odz-bg-base-100"><div class="odz-card-body odz-p-4"><h2 class="odz-card-title odz-text-base"> </h2> <div role="presentation"><div class="odz-flex odz-flex-col odz-items-center odz-gap-4"><svg xmlns="http://www.w3.org/2000/svg" class="odz-w-12 odz-h-12 odz-text-base-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <div class="odz-text-base-content"><p class="odz-font-medium">   </p> <label class="odz-btn odz-btn-primary odz-btn-sm odz-mt-2">  <input type="file" multiple class="odz-hidden" accept="image/*"></label></div></div></div> <!> <h2 class="odz-card-title odz-text-base odz-mt-4"> </h2> <textarea name="" id="" rows="5" class="odz-textarea odz-text-sm odz-textarea-bordered odz-textarea-lg odz-w-full odz-mt-4"></textarea></div> <!> <div class="odz-card-actions odz-p-4 odz-justify-center"><button class="odz-btn odz-btn-primary odz-min-w-32"><!></button></div></div>');function GQ(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Ls,"$shopStore",t),s=Ie(),i=Ie(),a=Ie();let A=pt(e,"fileUploadTitle",8," "),d=pt(e,"callback",8),c=pt(e,"uploadMemo",12,""),u=pt(e,"initialFiles",24,()=>[]),h=pt(e,"useNameSheet",8,!1),f=pt(e,"nameSheet",28,()=>({})),g=Ie([]),m=Ie(),y=Ie(!1),b=Ie(!1),S=Ie(!1);async function F(G){const R=Array.from(G);for(const he of R){const Be=crypto.randomUUID(),be=SQ(he.name),Le=`estimate-uploads/${o().id}/${Date.now()}-${be}`,Y={id:Be,file:he,status:"uploading",path:Le};_(g,[...l(g),Y]);try{const O=await EQ(he,Le);_(g,l(g).map(ve=>ve.id===Be?{...ve,status:O?"uploaded":"error",url:O,error:O?null:"Upload failed to return URL"}:ve))}catch(O){console.error("Upload error for file:",he.name,O),_(g,l(g).map(ve=>ve.id===Be?{...ve,status:"error",error:O.message||"Unknown upload error"}:ve))}}}function k(G){G.preventDefault(),_(y,!0)}function P(G){G.preventDefault(),_(y,!1)}function te(G){var he;G.preventDefault(),_(y,!1);const R=(he=G.dataTransfer)==null?void 0:he.files;R&&F(R)}function $(G){const R=G.target;R.files&&(F(R.files),R.value="")}async function j(G){const R=l(g).find(Be=>Be.id===G);if(!R)return;const he=[...l(g)];if(_(g,l(g).filter(Be=>Be.id!==G)),R.status==="uploaded"&&R.path)try{await FQ(R.path)||(console.warn(`Failed to delete file from storage: ${R.path}`),alert("   ."),_(g,he))}catch(Be){console.error("Error deleting file from storage:",Be),alert("     ."),_(g,he)}else R.status==="uploading"?console.log("Deleting an item that was still uploading."):console.log("Deleting an item not present in storage or in error state.")}function J(){_(b,!0);const G=l(g).filter(he=>he.status==="uploaded"&&he.url),R={uploadTitle:A(),uploadMemo:c(),files:G.map(he=>{var Be;return{name:((Be=he.file)==null?void 0:Be.name)||he.initialName||"Unknown File",url:he.url}})};try{d()(R,f())}catch(he){console.error("Error executing callback:",he),alert("     .")}finally{_(b,!1)}}En(()=>{console.log("upload component mounted"),u()&&u().length>0&&_(g,u().map(G=>({id:G.path||crypto.randomUUID(),file:null,initialName:G.name,status:"uploaded",url:G.url,path:G.path,error:null})))}),Zt(()=>l(g),()=>{_(s,l(g).every(G=>G.status==="uploaded"||G.status==="error"))}),Zt(()=>l(g),()=>{_(i,l(g).some(G=>G.status==="error"))}),Zt(()=>l(g),()=>{_(a,l(g).some(G=>G.status==="uploading"))}),Zn(),qr();var we=VQ(),D=w(we),N=z(w(D),2),Z=w(N),se=z(w(Z),2),ce=z(w(se),2),re=z(w(ce));ts(re,G=>_(m,G),()=>l(m));var pe=z(N,2);{var V=G=>{var R=jQ();Jt(R,5,()=>l(g),he=>he.id,(he,Be)=>{var be=HQ(),Le=w(be),Y=w(Le),O=w(Y),ve=z(Y,2),xe=w(ve);{var me=fe=>{var Ce=Wr();He(ge=>Qe(Ce,`${ge??""} MB -`),[()=>(l(Be).file.size/1024/1024).toFixed(2)],it),T(fe,Ce)};Se(xe,fe=>{l(Be).file&&fe(me)})}var le=z(xe,2);{var ze=fe=>{var Ce=kQ(),ge=w(Ce);zd(ge,{class:"odz-animate-spin odz-w-3 odz-h-3"}),T(fe,Ce)},ke=fe=>{var Ce=Nt(),ge=gt(Ce);{var De=Ze=>{var Oe=OQ();T(Ze,Oe)},Ne=Ze=>{var Oe=Nt(),Ke=gt(Oe);{var Je=_e=>{var Ue=DQ();He(()=>nr(Ue,"title",l(Be).error||"Unknown error")),T(_e,Ue)},Te=_e=>{var Ue=NQ();T(_e,Ue)};Se(Ke,_e=>{l(Be).status==="error"?_e(Je):_e(Te,!1)},!0)}T(Ze,Oe)};Se(ge,Ze=>{l(Be).status==="uploaded"?Ze(De):Ze(Ne,!1)},!0)}T(fe,Ce)};Se(le,fe=>{l(Be).status==="uploading"?fe(ze):fe(ke,!1)})}var de=z(Le,2);{var Fe=fe=>{var Ce=MQ(),ge=w(Ce);nE(ge,{class:"odz-w-5 odz-h-5"}),He(()=>nr(Ce,"href",l(Be).url)),T(fe,Ce)};Se(de,fe=>{l(Be).status==="uploaded"&&l(Be).url&&fe(Fe)})}var U=z(de,2),Ae=w(U);yu(Ae,{class:"odz-w-5 odz-h-5"}),He(()=>{var fe;Qe(O,((fe=l(Be).file)==null?void 0:fe.name)||l(Be).initialName||"Unknown File"),U.disabled=l(Be).status==="uploading"}),at("click",U,()=>j(l(Be).id)),T(he,be)}),T(G,R)};Se(pe,G=>{l(g)&&l(g).length>0&&G(V)})}var K=z(pe,2),oe=w(K),ae=z(K,2),x=z(D,2);{var E=G=>{var R=qQ(),he=z(gt(R),2),Be=w(he),be=z(he,2);{var Le=Y=>{var O=RQ(),ve=w(O),xe=w(ve),me=w(xe),le=z(xe,2);PQ(le,{get nameSheet(){return f()},onComplete:ze=>{f(ze),_(S,!1)}}),at("click",me,()=>_(S,!1)),T(Y,O)};Se(be,Y=>{l(S)&&Y(Le)})}at("click",Be,()=>_(S,!0)),T(G,R)};Se(x,G=>{h()&&G(E)})}var I=z(x,2),L=w(I),M=w(L);{var H=G=>{var R=Wr("");T(G,R)},q=G=>{var R=Nt(),he=gt(R);{var Be=Le=>{var Y=KQ(),O=gt(Y);zd(O,{class:"odz-animate-spin odz-mr-2"}),T(Le,Y)},be=Le=>{var Y=Nt(),O=gt(Y);{var ve=me=>{var le=$Q(),ze=gt(le);zd(ze,{class:"odz-animate-spin odz-mr-2"}),T(me,le)},xe=me=>{var le=Wr("");T(me,le)};Se(O,me=>{l(a)?me(ve):me(xe,!1)},!0)}T(Le,Y)};Se(he,Le=>{l(b)?Le(Be):Le(be,!1)},!0)}T(G,R)};Se(M,G=>{l(g).length===0&&!l(b)&&!l(a)?G(H):G(q,!1)})}He(()=>{Ir(N,`odz-border-2 odz-border-dashed odz-rounded-lg odz-p-5 odz-text-center odz-mt-4 odz-transition-colors ${(l(y)?"odz-border-primary odz-bg-primary/5":"odz-border-base-300")??""}`),Qe(oe,A()),nr(ae,"placeholder",A()),L.disabled=l(b)||l(a)}),at("change",re,$),at("dragover",N,k),at("dragleave",N,P),at("drop",N,te),br(ae,c),at("click",L,J),T(n,we),jr(),r()}async function WQ(n){const{data:e,error:t}=await ft.from("color_groups").select("*").eq("id",n).single();if(t)throw t;return e}var XQ=ee('<div class="odz-absolute odz-inset-0 odz-flex odz-items-center odz-justify-center"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>'),YQ=ee('<div class="odz-tooltip odz-tooltip-secondary"><button><!></button></div>'),JQ=ee('<div class="odz-mt-4"><h3 class="odz-text-sm odz-font-medium odz-mb-2">  </h3> <div class="odz-flex odz-items-center odz-gap-2"><input type="color" class="odz-h-10 odz-w-10 odz-p-0.5 odz-rounded-full odz-cursor-pointer odz-border odz-border-base-300 [&amp;::-webkit-color-swatch-wrapper]:odz-p-0 [&amp;::-webkit-color-swatch]:odz-rounded-full [&amp;::-moz-color-swatch]:odz-rounded-full"> <input type="text" placeholder="   " class="odz-input odz-input-bordered odz-flex-1"> <button class="odz-btn odz-btn-primary"></button></div></div>'),ZQ=ee('<div class="odz-flex odz-items-center odz-gap-2 odz-bg-base-200 odz-rounded-full odz-px-3 odz-py-1"><div class="odz-w-4 odz-h-4 odz-rounded-full"></div> <span class="odz-text-sm"> </span> <button class="odz-btn odz-btn-ghost odz-btn-xs odz-rounded-full"></button></div>'),eT=ee('<div class="odz-mt-4"><h3 class="odz-text-sm odz-font-medium odz-mb-2"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),tT=ee('<div class="odz-card odz-bg-base-100"><div class="odz-card-body odz-p-4"><h2 class="odz-card-title odz-text-base odz-mb-4">  <span class="odz-text-sm odz-font-normal"> </span></h2> <div class="odz-flex odz-flex-wrap odz-gap-2"></div> <!> <!></div> <div class="odz-card-actions odz-justify-end odz-p-5"><button class="odz-btn odz-btn-primary odz-w-full"></button></div></div> <!> <!>',1);function rT(n,e){Hr(e,!1);let t=pt(e,"colorGroupId",8,null),r=pt(e,"selectedTemplateId",8,null),o=pt(e,"callback",8),s=pt(e,"selectedColors",28,()=>[]),i=Ie(!1),a=Ie([]),A=Ie(0),d=Ie(!1),c=Ie("#000000"),u=Ie(""),h=Ie(!1),f=Ie("");async function g(){if(t()){_(i,!0);try{const V=await WQ(t());_(a,(V==null?void 0:V.colors)||[]),_(d,(V==null?void 0:V.use_custom)||!1)}finally{_(i,!1)}}}async function m(){if(!r())return;const V=await Gd(r());console.log({templateProduct:V}),_(A,Math.max(...V.template_product_variants.map(K=>K.color_count))),console.log({colorCount:l(A)})}function y(V){if(s().findIndex(oe=>oe.hex===V.hex)===-1){if(s().length>=l(A))return;s([...s(),V])}else s(s().filter(oe=>oe.hex!==V.hex))}function b(V){const K=V.replace("#",""),oe=parseInt(K.substr(0,2),16),ae=parseInt(K.substr(2,2),16),x=parseInt(K.substr(4,2),16);return(oe*299+ae*587+x*114)/1e3<128}function S(){if(s().length===0){_(h,!0),_(f,"  .");return}console.log("selectedColors",s()),o()(s())}En(async()=>{await g(),await m()}),qr();var F=tT(),k=gt(F),P=w(k),te=w(P),$=z(w(te)),j=w($),J=z(te,2);Jt(J,5,()=>l(a),ar,(V,K)=>{var oe=YQ(),ae=w(oe),x=w(ae);{var E=I=>{var L=XQ(),M=w(L);He(H=>nr(M,"stroke",H),[()=>b(l(K).hex)?"white":"black"],it),T(I,L)};Se(x,I=>{s().some(L=>L.hex===l(K).hex)&&I(E)})}He(I=>{nr(oe,"data-tip",l(K).name),Ir(ae,`odz-relative odz-w-10 odz-h-10 odz-rounded-full odz-transition-all odz-border hover:odz-scale-110 ${I??""}`),nr(ae,"style",`background-color: ${l(K).hex??""};`)},[()=>s().some(I=>I.hex===l(K).hex)?"odz-border-primary odz-scale-110":"odz-border"],it),at("click",ae,()=>y(l(K))),T(V,oe)});var we=z(J,2);{var D=V=>{var K=JQ(),oe=z(w(K),2),ae=w(oe),x=z(ae,2),E=z(x,2);br(ae,()=>l(c),I=>_(c,I)),br(x,()=>l(u),I=>_(u,I)),at("click",E,()=>{if(l(u).trim()){const I={name:l(u),hex:l(c)};y(I),_(u,""),_(c,"#000000")}}),T(V,K)};Se(we,V=>{l(d)&&V(D)})}var N=z(we,2);{var Z=V=>{var K=eT(),oe=z(w(K),2);Jt(oe,5,s,ar,(ae,x)=>{var E=ZQ(),I=w(E),L=z(I,2),M=w(L),H=z(L,2);He(()=>{nr(I,"style",`background-color: ${l(x).hex??""};`),Qe(M,l(x).name)}),at("click",H,()=>y(l(x))),T(ae,E)}),T(V,K)};Se(N,V=>{s().length>0&&V(Z)})}var se=z(P,2),ce=w(se),re=z(k,2);Xd(re,{get isLoading(){return l(i)}});var pe=z(re,2);Wd(pe,{get isOpen(){return l(h)},set isOpen(V){_(h,V)},get message(){return l(f)},set message(V){_(f,V)},$$legacy:!0}),He(()=>Qe(j,`(${s().length??""}/${l(A)??""}   .)`)),at("click",ce,S),T(n,F),jr()}var nT=ee('<li><button class="odz-btn odz-btn-ghost hover:odz-text-primary-focus"> </button></li>'),oT=ee('<div class="odz-text-sm odz-breadcrumbs odz-mb-6"><ul><li><button class="odz-btn odz-btn-ghost hover:odz-text-primary-focus"></button></li> <!></ul></div>'),sT=ee('<figure><img class="odz-h-48 odz-w-full odz-object-cover"></figure>'),iT=ee('<div class="odz-h-48 odz-bg-base-200 odz-flex odz-items-center odz-justify-center"><span class="odz-text-base-content/50"> </span></div>'),aT=ee('<p class="odz-text-sm odz-text-sm odz-text-base-content/70"> </p>'),AT=ee('<button class="odz-btn odz-btn-outline odz-w-full odz-mb-2"> </button>'),lT=ee('<div class="odz-card odz-bg-base-100 odz-shadow hover:odz-shadow-lg odz-rounded-lg odz-transition-shadow odz-cursor-pointer"><!> <div class="odz-card-body odz-p-5"><h2 class="odz-card-title odz-text-base"> </h2> <!></div> <div class="odz-card-actions odz-justify-end odz-p-5"><!> <button class="odz-btn odz-btn-primary odz-w-full"></button></div></div>'),dT=ee('<div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4"></div>'),cT=ee('<div class="p-4"><h1 class="odz-text-2xl odz-font-bold odz-mb-6"> </h1> <!> <!></div> <!>',1);function uT(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t);let s=pt(e,"objectId",12),i=pt(e,"isTemplateModal",12),a=pt(e,"updateObjectDisabled",8),A=pt(e,"selectedPrintIndex",12),d=pt(e,"productId",8,null),c=pt(e,"estimateId",8,void 0),u=Ie(!1),h=Ie(null),f=Ie([]),g=Ie([]),m=Ie(!1),y=Ie(!1),b=Ie(null),S="",F=Ie({uploads:null,memo:"",colors:null,uploadMemo:"",nameSheet:{}}),k=null;function P(ae){if(d()){const x=ae.products.findIndex(E=>{var I;return((I=E==null?void 0:E.product)==null?void 0:I.id)===d()});if(x!==-1)return x}return ae.index??0}async function te(ae){var I,L;const x=await BB(ae.id);if(_(f,await Ru(ae.id)),console.log("selectTemplate called:",{template:ae,selectedPrintIndex:A()}),_(h,{...x}),l(h).is_last){_(m,l(h).use_file_upload),_(y,l(h).use_color),_(b,l(h).color_group_id);const M=await Gd(l(h).id),H=o(),q=P(H),G=H.products[q],R=A()!==null?(I=G==null?void 0:G.prints)==null?void 0:I[A()]:(L=G==null?void 0:G.prints)==null?void 0:L.find(he=>he.objectId===s());k={...R?{...R}:{},parentTemplates:l(f),template:{...ae,templateProduct:M},objectId:s(),title:S},R!=null&&R.uploads?(hr(F,l(F).uploads=R.uploads),hr(F,l(F).nameSheet=R.nameSheet||{})):(hr(F,l(F).uploads=null),hr(F,l(F).nameSheet={})),R!=null&&R.colors?hr(F,l(F).colors=R.colors):hr(F,l(F).colors=null),l(m)||(k={...k,uploads:null,nameSheet:{}},hr(F,l(F).uploads=null),hr(F,l(F).nameSheet={})),l(y)||(k={...k,colors:null},hr(F,l(F).colors=null)),!l(m)&&!l(y)&&(await N(),D())}else{_(m,!1),_(y,!1);const M=await xB(ae.id);_(g,M)}}async function $(){j()}async function j(){var ae,x,E;_(u,!0),_(m,!1),_(y,!1),_(f,[]),k=null;try{if(A()!==null){const L=P(o()),M=o().products[L],H=(ae=M==null?void 0:M.prints)==null?void 0:ae[A()];H?(console.log({print:H}),H.uploads&&hr(F,l(F).uploads=H.uploads),H.colors&&hr(F,l(F).colors=H.colors),(x=H.uploads)!=null&&x.uploadMemo&&hr(F,l(F).uploadMemo=H.uploads.uploadMemo),H.nameSheet&&hr(F,l(F).nameSheet=H.nameSheet)):A(null)}const I=await dp(s());if(_(g,I.process_print_area_templates.map(({template:L})=>L)),S=I.title,A()!==null){const L=P(o()),M=o().products[L],H=(E=M==null?void 0:M.prints)==null?void 0:E[A()];H!=null&&H.template}}catch(I){console.error(I)}finally{console.log("isUpload",l(m)),_(u,!1)}}async function J(ae,x){if(_(m,!1),hr(F,l(F).uploads=ae),hr(F,l(F).nameSheet=x),!k){console.warn("selectUpload: pendingPrintData ");return}k={...k,uploads:ae,nameSheet:x},l(y)===!1&&(await N(),D())}async function we(ae){if(_(y,!1),hr(F,l(F).colors=ae),!k){console.warn("selectColor: pendingPrintData ");return}k={...k,colors:ae},await N(),D()}function D(){!l(m)&&!l(y)&&(i(!1),s(null),k=null,_(F,{uploads:null,memo:"",colors:null,uploadMemo:"",nameSheet:{}})),a()()}async function N(){var x;if(!k)return;Et.update(E=>{const I=P(E),L=[...E.products];if(!L[I])return E;const M=[...L[I].prints||[]];if(A()===null){const H=M.findIndex(q=>q.objectId===k.objectId);H!==-1?M[H]=k:M.push(k)}else M[A()]=k;return L[I]={...L[I],prints:M},{...E,products:L}});const ae=P(o());if(await Et.calculatePrintPrice(ae),await new Promise(E=>setTimeout(E,50)),typeof window<"u"&&d())try{const E=((x=o().products[ae])==null?void 0:x.prints)||[],I=c()||o().estimateId||"temp",L=`detailedPrint_${d()}_${I}`,M=JSON.stringify(E);window.sessionStorage.setItem(L,M),console.log(" Templates.svelte - SessionStorage :",{key:L,printsCount:E.length,productId:d(),estimateId:I,mode:c()?"Edit":"Create"});const H=new CustomEvent("detailedPrintUpdate",{detail:{productId:d(),timestamp:Date.now(),source:"Templates",estimateId:I}});window.dispatchEvent(H),console.log(" Templates.svelte -    :",{productId:d(),estimateId:I,timestamp:Date.now()})}catch(E){console.error(" Templates.svelte - SessionStorage  :",E)}console.log("Decision point - finalized",{selectedPrintIndex:A(),objectId:k.objectId}),k=null}En(async()=>{j()}),qr();var Z=cT(),se=gt(Z),ce=z(w(se),2);{var re=ae=>{var x=oT(),E=w(x),I=w(E),L=w(I),M=z(I,2);Jt(M,1,()=>l(f),ar,(H,q)=>{var G=nT(),R=w(G),he=w(R);He(()=>Qe(he,l(q).name)),at("click",R,Av(()=>te(l(q)))),T(H,G)}),at("click",L,Av(()=>$())),T(ae,x)};Se(ce,ae=>{l(h)&&ae(re)})}var pe=z(ce,2);{var V=ae=>{const x=it(()=>{var M;return(M=l(h))==null?void 0:M.file_upload_title}),E=it(()=>l(F).uploadMemo||""),I=it(()=>{var M;return((M=l(F).uploads)==null?void 0:M.files)||[]}),L=it(()=>{var M;return(M=l(h))==null?void 0:M.use_name_list});GQ(ae,{get fileUploadTitle(){return l(x)},callback:J,get uploadMemo(){return l(E)},get initialFiles(){return l(I)},get nameSheet(){return l(F).nameSheet},get useNameSheet(){return l(L)}})},K=ae=>{var x=Nt(),E=gt(x);{var I=M=>{const H=it(()=>{var G;return(G=l(h))==null?void 0:G.id}),q=it(()=>l(F).colors||[]);rT(M,{get colorGroupId(){return l(b)},get selectedTemplateId(){return l(H)},callback:we,get selectedColors(){return l(q)}})},L=M=>{var H=dT();Jt(H,5,()=>l(g),ar,(q,G)=>{var R=lT(),he=w(R);{var Be=de=>{var Fe=sT(),U=w(Fe);He(()=>{nr(U,"src",l(G).image_url),nr(U,"alt",l(G).name)}),T(de,Fe)},be=de=>{var Fe=iT();T(de,Fe)};Se(he,de=>{l(G).image_url?de(Be):de(be,!1)})}var Le=z(he,2),Y=w(Le),O=w(Y),ve=z(Y,2);{var xe=de=>{var Fe=aT(),U=w(Fe);He(()=>Qe(U,l(G).description)),T(de,Fe)};Se(ve,de=>{l(G).description&&de(xe)})}var me=z(Le,2),le=w(me);{var ze=de=>{var Fe=AT();at("click",Fe,Av(()=>window.open(l(G).detail_url,"_blank","width=800,height=600"))),T(de,Fe)};Se(le,de=>{l(G).detail_url&&de(ze)})}var ke=z(le,2);He(()=>Qe(O,l(G).name)),at("click",ke,()=>te(l(G))),T(q,R)}),T(M,H)};Se(E,M=>{l(y)?M(I):M(L,!1)},!0)}T(ae,x)};Se(pe,ae=>{l(m)?ae(V):ae(K,!1)})}var oe=z(se,2);Xd(oe,{get isLoading(){return l(u)},set isLoading(ae){_(u,ae)},$$legacy:!0}),T(n,Z),jr(),r()}var hT=ee('<div class="odz-alert odz-alert-error odz-flex odz-items-center odz-justify-between"><div class="odz-flex odz-items-center odz-gap-3"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div> <button class="odz-btn odz-btn-sm odz-btn-outline"> </button></div>'),fT=ee('<div class="odz-absolute odz-inset-0 odz-flex odz-items-center odz-justify-center"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-blue-500 odz-animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span class="odz-text-gray-600">  ...</span></div></div>'),pT=ee('<img class="odz-h-6 odz-w-6 odz-rounded-md odz-object-cover">'),gT=ee('<div class="odz-inline-flex odz-items-center odz-gap-2 odz-rounded-lg odz-border odz-border-slate-200 odz-bg-slate-50 odz-px-3 odz-py-2"><!> <span class="odz-text-xs odz-font-medium odz-text-slate-700"> </span></div>'),vT=ee('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"> </p> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),mT=ee('<span class="odz-inline-flex odz-items-center odz-gap-1 odz-rounded-full odz-bg-slate-100 odz-px-2 odz-py-1"><span class="odz-h-3.5 odz-w-3.5 odz-rounded-full odz-border odz-border-slate-300"></span> <span class="odz-text-[11px] odz-text-slate-600"> </span></span>'),wT=ee('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"></p> <div class="odz-flex odz-flex-wrap odz-gap-1.5"></div></div>'),yT=ee('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"></p> <div class="odz-flex odz-items-center odz-gap-2 odz-rounded-lg odz-border odz-border-slate-200 odz-bg-slate-50 odz-px-3 odz-py-2 odz-text-xs odz-text-slate-600"><svg class="odz-h-3.5 odz-w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828L18 9.828m-2.828-2.828L16 5l3 3-1.828 1.828m-2.828-2.828L9 5l3 3"></path></svg> <span> </span></div></div>'),bT=ee('<div class="odz-grid odz-gap-3 sm:odz-grid-cols-2"><!> <!></div>'),_T=ee('<div class="odz-rounded-2xl odz-border odz-border-slate-200 odz-bg-white odz-shadow-sm odz-transition-shadow hover:odz-shadow-md"><div class="odz-flex odz-items-start odz-justify-between odz-gap-4 odz-border-b odz-border-slate-100 odz-bg-slate-50 odz-rounded-t-2xl odz-px-5 odz-py-4"><div class="odz-space-y-1"><span class="odz-inline-flex odz-items-center odz-gap-2 odz-text-xs odz-font-semibold odz-text-slate-500"><span class="odz-inline-flex odz-h-5 odz-w-5 odz-items-center odz-justify-center odz-rounded-full odz-bg-slate-200 odz-text-[10px] odz-font-bold odz-text-slate-700"></span>  </span> <h3 class="odz-text-base odz-font-semibold odz-text-slate-900"> </h3></div> <div class="odz-flex odz-shrink-0 odz-items-center odz-gap-2"><button class="odz-btn odz-btn-xs odz-btn-outline"></button> <button class="odz-btn odz-btn-xs odz-btn-outline"></button></div></div> <div class="odz-space-y-4 odz-p-5"><!> <!></div></div>'),BT=ee('<div><div class="odz-flex odz-items-center odz-gap-3 odz-mb-6"><div class="odz-w-10 odz-h-10 odz-bg-blue-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-5 odz-h-5 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <div><h2 class="odz-text-xl odz-font-bold odz-text-gray-800">  </h2> <p class="odz-text-sm odz-text-gray-600"> </p></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-5"></div></div>'),xT=ee('<div><div class="odz-text-center odz-text-gray-500 odz-py-10 odz-border odz-border-dashed odz-border-gray-300 odz-rounded-2xl"><svg class="odz-w-12 odz-h-12 odz-text-gray-300 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg> <p class="odz-text-lg odz-font-medium odz-mb-2">  </p> <p class="odz-text-sm"><span class="lg:odz-hidden"> </span><span class="odz-hidden lg:odz-inline"> </span>         .</p></div></div>'),zT=ee('<div class="odz-mb-4"><h2 class="odz-text-lg odz-font-semibold"> </h2></div>'),CT=ee('<dialog id="detailed-print-template-modal" class="odz-modal odz-py-10 odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl max-h-100 overflow-y-auto"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button></form> <!> <!></div></dialog>'),ST=ee('<div class="odz-flex odz-flex-col odz-gap-6"><h1 class="odz-text-xl odz-font-bold odz-my-3 odz-flex odz-items-center odz-gap-5">   <span class="odz-text-sm odz-font-normal odz-text-gray-500">     .</span></h1> <!> <div class="odz-flex odz-flex-col lg:odz-flex-row odz-gap-6"><div class="odz-flex-1 lg:odz-w-1/2"><div><div class="odz-relative odz-w-full odz-bg-gray-50 odz-border-2 odz-border-gray-200 odz-rounded-xl" style="min-width: 200px; min-height: 400px;"><canvas class="odz-absolute odz-top-0 odz-left-0 odz-w-full odz-h-full odz-rounded-xl" style="image-rendering: pixelated;"></canvas> <!></div> <p class="odz-text-sm odz-text-gray-500">         .</p></div></div> <div class="odz-flex-1 lg:odz-w-1/2"><!></div></div></div> <!>',1);function ET(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Ls,"$shopStore",t),s=()=>Xr(Et,"$estimateStore",t);let i=pt(e,"productId",8),a=pt(e,"estimateId",8,void 0);pt(e,"onComplete",8),pt(e,"onCancel",8,()=>{});let A=null,d=[],c=Ie(),u=Ie(),h=Ie(),f=Ie(!0),g=Ie(null),m=Ie(!1),y=Ie(null),b=Ie(null),S=Ie(""),F=Ie(null),k=Ie([]),P=Ie(!1),te=Ie(""),$=Ie(!1),j=Ie(null),J=Ie(""),we=Ie(null),D=Ie(!1),N=Ie(!1),Z=Ie(!1);const se=".main-estimate-modal-box";function ce(){if(typeof window<"u")try{const U=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"DetailedPrint"}});window.dispatchEvent(U),console.log(" DetailedPrint -    :",{productId:i(),timestamp:Date.now()})}catch(U){console.error(" DetailedPrint -    :",U)}}En(async()=>{try{await M(),await re(),ae()}finally{_(N,!0)}}),Eo(()=>{var U;(U=l(h))==null||U.destroy(),L()});async function re(){try{_(f,!0),_(g,null),await pe(),await Oi(),ae()}catch(U){console.error("DetailedPrint initialize failed:",U),_(g,U instanceof Error?U.message:"   .")}finally{_(f,!1)}}async function pe(){await Oi();let U=0;const Ae=50;for(;!l(u)&&U<Ae;)await new Promise(De=>setTimeout(De,100)),U++;if(!l(u))throw new Error("    .");if(A=await SB(i(),o().id),A!=null&&A.id&&(d=await EB(A.id)),!(A!=null&&A.canvas_json))throw new Error("    .");const fe=typeof A.canvas_json=="string"?JSON.parse(A.canvas_json):A.canvas_json,Ce=fe.backgroundImage.width*fe.backgroundImage.scaleX,ge=fe.backgroundImage.height*fe.backgroundImage.scaleY;_(h,new Q5(l(u),{width:Ce,height:ge,containerElement:l(c)})),l(h).setPrintAreaClickListener(De=>{V(De)}),await l(h).setCanvasJSON(fe)}function V(U){var ge,De,Ne;if(!l(h))return;_(y,U),_(S,((ge=d.find(Ze=>Ze.object_id===U))==null?void 0:ge.title)||`${U} `);const fe=(((Ne=(De=l(h)).getObjects)==null?void 0:Ne.call(De))||[]).find(Ze=>{var Oe;return((Oe=Ze==null?void 0:Ze.data)==null?void 0:Oe.objectId)===U});fe?_(F,{x:Math.round(fe.left||0),y:Math.round(fe.top||0),width:Math.round((fe.width||0)*(fe.scaleX||1)),height:Math.round((fe.height||0)*(fe.scaleY||1))}):_(F,null);const Ce=l(k).findIndex(Ze=>Ze.objectId===U);_(b,Ce>=0?Ce:null),_(m,!0),K()}function K(){const U=document.querySelector(se);U&&(U.scrollTop=0)}function oe(U){if(!U)return;const Ae=s().products.findIndex(fe=>{var Ce;return((Ce=fe==null?void 0:fe.product)==null?void 0:Ce.id)===i()});if(Ae===-1){console.warn("DetailedPrint cancelPrint:     .",{productId:i()});return}Et.cancelPrint(Ae,U),ae(),L(),ce()}function ae(){l(h)&&(l(h).updateAllObjectEnabled(),l(k).forEach(U=>{U.objectId&&l(h).updateObjectDisabled(U.objectId)}))}function x(U){const Ae=l(k)[U];Ae!=null&&Ae.objectId&&(_(y,Ae.objectId),_(b,U),_(S,Ae.title||`${Ae.objectId} `),_(F,null),_(m,!0),K())}function E(){_(m,!1)}function I(){const U=a()||"temp";return`detailedPrint_${i()}_${U}`}function L(U){if(!(typeof window>"u"))try{const Ae=U??JSON.stringify(l(k)??[]),fe=I();window.sessionStorage.setItem(fe,Ae),_(te,Ae);try{_(we,JSON.parse(Ae)),console.log("DetailedPrint session ",{storageKey:fe,printsCount:Array.isArray(l(we))?l(we).length:"invalid"}),ce();try{ur.selectPrintMethod("detailed")}catch(Ce){console.warn("fixedEstimateStore selectPrintMethod :",Ce)}try{Hn.selectPrintMethod(i(),"detailed")}catch(Ce){console.warn("extendedProductDataStore selectPrintMethod :",Ce)}}catch(Ce){console.error("DetailedPrint fallback  :",Ce)}}catch(Ae){console.error("DetailedPrint session  :",Ae)}}async function M(){var ge,De,Ne,Ze,Oe,Ke,Je;if(typeof window>"u")return;const Ae=(a()||"temp")!=="temp";let fe=null,Ce=null;if(Ae&&console.log(" Edit mode detected - will use sessionStorage populated from DB"),!fe||fe.length===0){const Te=I();if(Ce=window.sessionStorage.getItem(Te),Ce)try{console.log(" Raw sessionStorage data:",Ce),fe=JSON.parse(Ce),console.log(" Parsed printsToRestore:",fe),console.log(" First print colors detail:",{exists:fe.length>0,colorsArray:(ge=fe[0])==null?void 0:ge.colors,colorsLength:(Ne=(De=fe[0])==null?void 0:De.colors)==null?void 0:Ne.length,colorsType:typeof((Ze=fe[0])==null?void 0:Ze.colors),isArray:Array.isArray((Oe=fe[0])==null?void 0:Oe.colors),allColors:(Je=(Ke=fe[0])==null?void 0:Ke.colors)==null?void 0:Je.map((_e,Ue)=>({idx:Ue,name:_e.name,hex:_e.hex}))}),console.log(" Using sessionStorage detailed prints:",{printsCount:fe.length,colorsPerPrint:fe.map((_e,Ue)=>{var Me;return{printIndex:Ue,colorsCount:((Me=_e.colors)==null?void 0:Me.length)||0,colors:_e.colors,objectId:_e.objectId}})})}catch(_e){console.error("Failed to parse sessionStorage prints:",_e)}}if(!(!fe||!Array.isArray(fe)))try{const Te=fe;_(we,[...Te]),_(k,[...Te]),console.log(" sessionFallbackPrints updated:",{printsCount:l(we).length,colors:l(we).map(Me=>Me.colors)});const Ue=hn(Et).products.findIndex(Me=>{var je;return((je=Me==null?void 0:Me.product)==null?void 0:je.id)===i()});if(_(te,Ce),Ue===-1){console.warn("DetailedPrint   :    .",{productId:i()}),_(j,Te),_(J,Ce),_($,!0);return}if(_($,!0),H(Te),await Oi(),Array.isArray(Te)&&Te.length>0){try{ur.selectPrintMethod("detailed")}catch(Me){console.warn("fixedEstimateStore selectPrintMethod  (restore):",Me)}try{Hn.selectPrintMethod(i(),"detailed")}catch(Me){console.warn("extendedProductDataStore selectPrintMethod  (restore):",Me)}ce()}}catch(Te){console.error("DetailedPrint   :",Te)}finally{l(j)||_($,!1)}}function H(U){if(!U||U.length===0)return;const Ae=s().products.findIndex(fe=>{var Ce;return((Ce=fe==null?void 0:fe.product)==null?void 0:Ce.id)===i()});if(Ae===-1){console.warn("DetailedPrint applyPrintsToStore:    .",{productId:i()});return}_(D,!0),console.log("DetailedPrint applyPrintsToStore ",{productId:i(),printsCount:U.length}),_(Z,!1),Et.update(fe=>{const Ce=[...fe.products];return Ce[Ae]={...Ce[Ae],prints:U},{...fe,products:Ce,index:Ae}}),_(te,JSON.stringify(U??[])),Oi().then(()=>{_(D,!1)})}Zt(()=>(l(we),s(),l(k)),()=>{var U;l(we)&&l(we).length>0&&(((U=s())==null?void 0:U.estimateId)||"temp")!=="temp"&&(_(k,[...l(we)]),console.log(" Edit  (reactive): Supabase DB  :",{printsCount:l(k).length,colors:l(k).map(Ce=>{var ge,De;return{colorsCount:((ge=Ce.colors)==null?void 0:ge.length)||0,colorNames:(De=Ce.colors)==null?void 0:De.map(Ne=>Ne.name)}})}))}),Zt(()=>(s(),l(we),zn(i())),()=>{var Ce;if(!((((Ce=s())==null?void 0:Ce.estimateId)||"temp")!=="temp"&&l(we)&&l(we).length>0)){const ge=s().products.find(Ne=>{var Ze;return((Ze=Ne==null?void 0:Ne.product)==null?void 0:Ze.id)===i()}),De=(ge==null?void 0:ge.prints)??[];De.length>0?_(k,[...De]):l(we)&&l(we).length>0&&_(k,[...l(we)])}}),Zt(()=>(l(j),s(),zn(i()),l(J),Oi),()=>{if(l(j)&&s().products.findIndex(fe=>{var Ce;return((Ce=fe==null?void 0:fe.product)==null?void 0:Ce.id)===i()})!==-1){const fe=l(j),Ce=l(J)||JSON.stringify(fe??[]);_($,!0),H(fe),_(te,Ce),_(j,null),_(J,""),Oi().then(()=>{_($,!1)})}}),Zt(()=>(l($),l(D),l(we),s(),zn(i())),()=>{var U;if(!l($)&&!l(D)&&((U=l(we))!=null&&U.length)){const Ae=s().products.find(Ce=>{var ge;return((ge=Ce==null?void 0:Ce.product)==null?void 0:ge.id)===i()}),fe=(Ae==null?void 0:Ae.prints)??[];(!fe||fe.length===0)&&H(l(we))}}),Zt(()=>(l(m),l($),l(D),l(k),l(te)),()=>{if(l(m)&&!l($)&&!l(D))try{JSON.stringify(l(k)??[])!==l(te)&&_(Z,!0)}catch(U){console.error("DetailedPrint    :",U)}}),Zt(()=>l(h),()=>{l(h)&&ae()}),Zt(()=>l(m),()=>{_(P,l(m))}),Zt(()=>(l(m),l(P),l(Z),l(N)),()=>{!l(m)&&l(P)&&(_(y,null),_(b,null),_(S,""),_(F,null),l(Z)&&l(N)&&L(),_(Z,!1),ae())}),Zt(()=>(l(N),l(m),l($),l(D),l(k),l(te)),()=>{if(l(N)&&!l(m)&&!l($)&&!l(D))try{const U=JSON.stringify(l(k)??[]);U!==l(te)&&L(U)}catch(U){console.error("DetailedPrint   :",U)}}),Zn(),qr();var q=ST(),G=gt(q),R=z(w(G),2);{var he=U=>{var Ae=hT(),fe=w(Ae),Ce=z(w(fe),2),ge=w(Ce),De=z(fe,2);He(()=>Qe(ge,l(g))),at("click",De,re),T(U,Ae)};Se(R,U=>{l(g)&&U(he)})}var Be=z(R,2),be=w(Be),Le=w(be),Y=w(Le),O=w(Y);ts(O,U=>_(u,U),()=>l(u));var ve=z(O,2);{var xe=U=>{var Ae=fT();T(U,Ae)};Se(ve,U=>{l(f)&&!l(g)&&U(xe)})}ts(Y,U=>_(c,U),()=>l(c));var me=z(be,2),le=w(me);{var ze=U=>{var Ae=BT(),fe=w(Ae),Ce=z(w(fe),2),ge=z(w(Ce),2),De=w(ge),Ne=z(fe,2);Jt(Ne,5,()=>l(k),ar,(Ze,Oe,Ke)=>{var Je=_T(),Te=w(Je),_e=w(Te),Ue=w(_e),Me=w(Ue);Me.textContent=Ke+1;var je=z(Ue,2),At=w(je),ut=z(_e,2),ht=w(ut),Re=z(ht,2),Xe=z(Te,2),tt=w(Xe);{var rt=ot=>{var xt=vT(),Lt=z(w(xt),2);Jt(Lt,5,()=>l(Oe).parentTemplates,ar,(_t,vt)=>{var Pt=gT(),kt=w(Pt);{var Ct=Tt=>{var Rt=pT();He(()=>{nr(Rt,"src",l(vt).image_url),nr(Rt,"alt",l(vt).name)}),T(Tt,Rt)};Se(kt,Tt=>{l(vt).image_url&&Tt(Ct)})}var Ft=z(kt,2),zt=w(Ft);He(()=>Qe(zt,l(vt).name)),T(_t,Pt)}),T(ot,xt)};Se(tt,ot=>{var xt;(xt=l(Oe).parentTemplates)!=null&&xt.length&&ot(rt)})}var Bt=z(tt,2);{var nt=ot=>{var xt=bT(),Lt=w(xt);{var _t=kt=>{var Ct=wT(),Ft=z(w(Ct),2);Jt(Ft,5,()=>l(Oe).colors,ar,(zt,Tt)=>{var Rt=mT(),Dt=w(Rt),Mt=z(Dt,2),Gt=w(Mt);He(()=>{nr(Dt,"style",`background-color: ${l(Tt).hex??""};`),Qe(Gt,l(Tt).name)}),T(zt,Rt)}),T(kt,Ct)};Se(Lt,kt=>{var Ct;(Ct=l(Oe).colors)!=null&&Ct.length&&kt(_t)})}var vt=z(Lt,2);{var Pt=kt=>{var Ct=yT(),Ft=z(w(Ct),2),zt=z(w(Ft),2),Tt=w(zt);He(()=>Qe(Tt,` ${l(Oe).uploads.files.length??""}`)),T(kt,Ct)};Se(vt,kt=>{var Ct,Ft;(Ft=(Ct=l(Oe).uploads)==null?void 0:Ct.files)!=null&&Ft.length&&kt(Pt)})}T(ot,xt)};Se(Bt,ot=>{var xt,Lt,_t;((xt=l(Oe).colors)!=null&&xt.length||(_t=(Lt=l(Oe).uploads)==null?void 0:Lt.files)!=null&&_t.length)&&ot(nt)})}He(()=>Qe(At,l(Oe).title)),at("click",ht,()=>x(Ke)),at("click",Re,()=>oe(l(Oe).objectId)),T(Ze,Je)}),He(()=>Qe(De,`${l(k).length??""}  `)),T(U,Ae)},ke=U=>{var Ae=xT();T(U,Ae)};Se(le,U=>{l(k).length>0?U(ze):U(ke,!1)})}var de=z(G,2);{var Fe=U=>{var Ae=CT(),fe=w(Ae),Ce=w(fe),ge=w(Ce),De=z(Ce,2);{var Ne=Oe=>{var Ke=zT(),Je=w(Ke),Te=w(Je);He(()=>Qe(Te,l(S))),T(Oe,Ke)};Se(De,Oe=>{l(S)&&Oe(Ne)})}var Ze=z(De,2);uT(Ze,{get productId(){return i()},get estimateId(){return a()},updateObjectDisabled:ae,get objectId(){return l(y)},set objectId(Oe){_(y,Oe)},get isTemplateModal(){return l(m)},set isTemplateModal(Oe){_(m,Oe)},get selectedPrintIndex(){return l(b)},set selectedPrintIndex(Oe){_(b,Oe)},$$legacy:!0}),at("click",ge,E),T(U,Ae)};Se(de,U=>{l(m)&&U(Fe)})}He(()=>Ir(Le,`odz-space-y-4 ${l(f)?"odz-opacity-50":""}`)),T(n,q),jr(),r()}var FT=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-gap-6 odz-py-10"><div class="odz-text-center"><h2 class="odz-text-xl odz-font-bold odz-mb-2"> </h2> <p class="odz-text-sm odz-text-gray-500">      </p></div> <div class="odz-bg-gray-50 odz-p-8 odz-rounded-lg odz-border-2 odz-border-dashed odz-border-gray-300"><p class="odz-text-gray-600 odz-text-center">    </p></div> <button class="odz-btn odz-btn-secondary odz-px-8"> </button></div>');function IT(n,e){let t=pt(e,"productId",8),r=pt(e,"onComplete",8);console.log("    - productId:",t());var o=FT(),s=z(w(o),4);at("click",s,function(...i){var a;(a=r())==null||a.apply(this,i)}),T(n,o)}var UT=ee('<p class="odz-text-[11px] odz-text-gray-400 odz-line-through odz-mt-1"> </p> <p class="odz-text-[11px] odz-text-emerald-600 odz-font-semibold odz-mt-0.5"> </p>',1),QT=ee('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p><!></p>',1),TT=ee('<p class="odz-mt-1 odz-text-[11px] odz-text-blue-600">   -  </p>'),LT=ee('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">     </p>'),PT=ee('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-400"></p> <!>',1),kT=ee('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">    </p>',1),OT=ee('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-400"></p> <p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">   </p>',1),DT=ee('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!></p>'),NT=ee('<span class="odz-text-blue-600">+ ( )</span>'),MT=ee("<span>+ ( )</span>"),HT=ee('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!> <!></p>'),jT=ee('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!> + ( )</p>'),RT=Xp('<svg class="odz-w-4 odz-h-4 sm:odz-w-5 sm:odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),qT=ee("<button><!> <span> </span></button>"),KT=ee('<div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-2.5"></div>'),$T=ee('<button class="odz-w-full odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-font-semibold odz-py-2.5 odz-px-4 odz-rounded-xl odz-transition-colors odz-duration-200 odz-flex odz-items-center odz-justify-center odz-gap-2"><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg> <span> </span></button>'),VT=ee('<div class="odz-mt-5 odz-border-t odz-border-gray-200/70 odz-pt-3.5"><!></div>'),GT=ee('<div class="odz-mt-5 odz-px-4"><div class="odz-sticky odz-bottom-4 md:odz-static md:odz-bottom-auto"><div class="odz-rounded-3xl odz-border odz-border-gray-200 odz-bg-white/90 odz-backdrop-blur-md odz-shadow-xl odz-p-4 sm:odz-p-5 lg:odz-p-6"><div class="odz-grid sm:odz-grid-cols-2 lg:odz-grid-cols-5 odz-gap-2.5 lg:odz-gap-3"><div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"> </span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p class="odz-mt-1 odz-text-xs odz-text-gray-500"> </p></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"> </span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-red-600"> </p> <!></div></div> <!></div></div></div>');function VA(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(ur,"$fixedEstimateStore",t),s=()=>Xr(Hn,"$extendedProductDataStore",t),i=Ie(),a=Ie(),A=Ie(),d=Ie(),c=Ie(),u=Ie(),h=Ie(),f=Ie(),g=Ie(),m=Ie(),y=Ie(),b=Ie(),S=Ie(),F=Ie(),k=Ie();let P=pt(e,"productId",8),te=pt(e,"showNextButton",8,!1),$=pt(e,"nextButtonText",8,"  "),j=pt(e,"onNext",8,void 0),J=pt(e,"estimateId",8,null),we=pt(e,"idx",8,null),D=pt(e,"buttonConfig",8,null),N=Ie(0),Z=Ie(null);function se(){var be,Le;if(((be=l(i))==null?void 0:be.productId)===P()&&l(i).printSelection&&l(i).printSelection.currentMethod!=="selection")return l(i).printSelection;if(typeof window<"u")try{let Y=null,O="";if(J()&&we()!==null){const ve=`fixedEstimate_${P()}_${J()}_${we()}`;Y=sessionStorage.getItem(ve),Y&&(O=ve),console.log(" resolvePrintSelection -    (estimateId + idx):",{exactKey:ve,hasData:!!Y})}if(!Y&&J()){const ve=`fixedEstimate_${P()}_${J()}`;Y=sessionStorage.getItem(ve),Y&&(O=ve)}if(!Y&&we()!==null){const ve=`fixedEstimate_${P()}_${we()}`;Y=sessionStorage.getItem(ve),Y&&(O=ve)}if(!Y){const ve=`fixedEstimate_${P()}`;Y=sessionStorage.getItem(ve),Y&&(O=ve)}if(Y||console.log(" resolvePrintSelection - sessionStorage     (, DB Store ):",{triedKeys:[`fixedEstimate_${P()}`,`fixedEstimate_${P()}_${we()}`,`fixedEstimate_${P()}_${J()}`],currentIdx:we(),currentEstimateId:J()}),Y){const ve=JSON.parse(Y);if(ve.printSelection&&ve.printSelection.currentMethod!=="selection")return ve.printSelection}}catch{}return(Le=l(A))!=null&&Le.printSelection&&l(A).printSelection.currentMethod!=="selection"?l(A).printSelection:null}async function ce(be,Le,Y,O){if((O||(Le?"detailed":"none"))!=="detailed")return null;if(typeof window<"u")try{const xe=J()||"temp",me=`detailedPrint_${P()}_${xe}`;let le=window.sessionStorage.getItem(me);if(!le&&we()!==null){const ze=`detailedPrint_${P()}_${xe}_${we()}`;le=window.sessionStorage.getItem(ze)}if(!le){const ze=`detailedPrint_${P()}`;le=window.sessionStorage.getItem(ze)}if(le){const ze=JSON.parse(le);if(console.log(" sessionStorage     ( ):",{key:me,parsedData:ze,dataLength:ze==null?void 0:ze.length,currentTab:"unknown"}),Array.isArray(ze)&&ze.length>0){const ke=Y;if(ke<=0)return null;let de=0;for(const Fe of ze){const U=await re(Fe,ke);U!==null?de+=U:Fe.price&&typeof Fe.price=="number"&&(de+=Fe.price,console.log("      ():",{title:Fe.title,fallbackPrice:Fe.price,currentTotal:de}))}if(de>0)return de}}}catch{}if(J()&&we()!==null)try{const me=(await Nd(J())).filter(le=>le.idx===we());if(me.length>0){const le=Y;if(le<=0)return null;let ze=0;for(const ke of me){const de={id:ke.id,template:{id:ke.template_id},colors:ke.colors||[],price:ke.price},Fe=await re(de,le);Fe!==null?ze+=Fe:(ze+=ke.price||0,console.log("   - DB   ():",{objectId:ke.object_id,dbPrice:ke.price}))}return ze}}catch{}if(be!=null&&be.printConfig){let xe=null;if(typeof be.printConfig=="string")try{xe=JSON.parse(be.printConfig)}catch{return null}else typeof be.printConfig=="object"&&be.printConfig!==null&&(xe=be.printConfig);if(xe){const me=["totalAmount","total","totalPrice","price","amount"];for(const ze of me){const ke=xe[ze];if(typeof ke=="number"&&!Number.isNaN(ke))return ke}const le=xe.summary;if(le&&typeof le=="object")for(const ze of me){const ke=le[ze];if(typeof ke=="number"&&!Number.isNaN(ke))return ke}}}return null}async function re(be,Le){var Y,O;try{if(!((Y=be.template)!=null&&Y.id))return null;let ve=be.template.templateProduct;if(ve||(ve=await Gd(be.template.id)),!(ve!=null&&ve.template_product_variants))return null;let xe;if(be.variant_id?(xe=ve.template_product_variants.find(ze=>ze.variant_id===be.variant_id),console.log(" STEP 4  (variant_id ):",{found:!!xe,selectedVariant:xe})):be.colors&&be.colors.length>0?(xe=ve.template_product_variants.find(ze=>ze.color_count===be.colors.length),console.log(" STEP 4  (  ):",{found:!!xe,selectedVariant:xe})):(xe=ve.template_product_variants[0],console.log(" STEP 4  ():",{selectedVariant:xe})),!xe)return null;const me=await mA(xe.variant_id);if(!me||!me.prices||me.prices.length===0)return null;const le=me.prices[0].amount;if(xe.min_quantity<=Le){let ze=le*Le;if((O=ve.product)!=null&&O.quantity_discounts&&ve.product.quantity_discounts.length>0){const ke=mi(Le,le,ve.product.quantity_discounts);if(ke.hasDiscount){const de=ke.discountedPrice*Le;return console.log(" =====   ( ) =====:",{discountedUnitPrice:ke.discountedPrice,quantity:Le,finalPrice:de}),de}}return ze}else{const ze=xe.plate_price||0;return console.log(" =====   (  , plate_price ) =====:",{min_quantity:xe.min_quantity,productQuantity:Le,platePrice:ze}),ze}}catch{return null}}function pe(be,Le,Y){if(typeof window>"u")return!1;try{const O=Le||"temp",ve=[Y!==null&&O?`detailedPrint_${be}_${O}_${Y}`:null,O?`detailedPrint_${be}_${O}`:null,`detailedPrint_${be}`].filter(Boolean);for(const xe of ve){const me=window.sessionStorage.getItem(xe);if(me)try{const le=JSON.parse(me);if(Array.isArray(le)&&le.length>0)return!0}catch{}}}catch{return!1}return!1}let V=Ie(0),K=Ie(!1),oe=Ie(null);En(()=>{if(typeof window<"u"){const be=ve=>{const{productId:xe,timestamp:me,source:le}=ve.detail;xe===P()&&(_(N,Date.now()),_(V,Date.now()))},Le=async ve=>{var de,Fe,U;const{productId:xe,addonId:me,selectedAddons:le,timestamp:ze,source:ke}=ve.detail;if(xe===P()){console.log(" SelectedProductSummary -     ():",{eventProductId:xe,addonId:me,selectedAddonsCount:Object.keys(le||{}).length,timestamp:ze,source:ke,currentProductId:P()}),await new Promise(ge=>setTimeout(ge,50));let Ae=hn(ur),fe=0;const Ce=5;for(;fe<Ce&&Ae;){const ge=(Fe=(de=Ae==null?void 0:Ae.addonSelection)==null?void 0:de.selectedAddons)==null?void 0:Fe[me];if(ge&&ge.variantId===ve.detail.variantId)break;console.log(` Store    (${fe+1}/${Ce}):`,{storeVariantId:ge==null?void 0:ge.variantId,expectedVariantId:ve.detail.variantId}),await new Promise(De=>setTimeout(De,25)),Ae=hn(ur),fe++}if(Ae&&l(c)&&l(A)){const ge=L(Ae,l(c),Date.now(),(U=Ae.addonSelection)==null?void 0:U.selectedAddons);_(S,ge)}_(N,Date.now()),_(V,Date.now())}},Y=ve=>{const{productId:xe,action:me,color:le,variantId:ze,oldQuantity:ke,newQuantity:de,newTotalQuantity:Fe,timestamp:U,source:Ae}=ve.detail;xe===P()&&(_(N,Date.now()),_(V,Date.now()))},O=async ve=>{const{productId:xe,toMethod:me,idx:le,estimateId:ze,source:ke}=ve.detail;xe===P()&&(_(Z,me||null),me&&ur.updatePrintSelection({currentMethod:me,isCompleted:me==="none",lastUpdated:Date.now()}),_(N,Date.now()),_(V,Date.now()),await new Promise(de=>setTimeout(de,100)),E(me))};return window.addEventListener("detailedPrintUpdate",be),window.addEventListener("addonSelectionUpdate",Le),window.addEventListener("productQuantityUpdate",Y),window.addEventListener("printAmountRecalc",O),setTimeout(()=>{_(V,Date.now())},100),()=>{window.removeEventListener("detailedPrintUpdate",be),window.removeEventListener("addonSelectionUpdate",Le),window.removeEventListener("productQuantityUpdate",Y),window.removeEventListener("printAmountRecalc",O)}}});let ae=Ie(null),x=!1;async function E(be){if(!x)try{x=!0,_(ae,await ce(l(u),l(K),l(c).totalQuantity,be))}catch{_(ae,null)}finally{x=!1}}let I=null;function L(be,Le,Y,O){var ze,ke,de;let ve=be;if(typeof window<"u"&&P())try{const Fe=hn(ur);Fe&&Fe.productId===P()&&(ve=Fe)}catch{}if(Y&&typeof window<"u"&&P())try{const Fe=hn(ur);Fe&&Fe.productId===P()&&(ve=Fe)}catch{}let xe=O||((ze=ve==null?void 0:ve.addonSelection)==null?void 0:ze.selectedAddons);if(typeof window<"u"&&Y)try{const Fe=hn(ur);if(Fe&&Fe.productId===P()){const U=(ke=Fe.addonSelection)==null?void 0:ke.selectedAddons;U&&Object.keys(U).length>0&&(xe=U)}}catch{}if(!xe||!((de=l(A))!=null&&de.addons))return 0;const me=Le.totalQuantity;let le=0;return Object.entries(xe).forEach(([Fe,U])=>{var Ze,Oe,Ke;if(!U||typeof U!="object"||!("productId"in U)||!("variantId"in U))return;const Ae=U,fe=l(A).addons.find(Je=>Je.id===Fe);if(!fe)return;const Ce=fe.items.find(Je=>Je.addon_product.id===Ae.productId);if(!Ce)return;(Ze=Ce.addon_product.variants)!=null&&Ze.map(Je=>{var Te,_e;return{id:Je.id,title:Je.title,price:(_e=(Te=Je.prices)==null?void 0:Te[0])==null?void 0:_e.amount}});let ge=(Oe=Ce.addon_product.variants)==null?void 0:Oe.find(Je=>Je.id===Ae.variantId);if(!ge){(Ke=Ce.addon_product.variants)==null||Ke.forEach((Je,Te)=>{});return}if(!ge.prices||ge.prices.length===0)return;const De=ge.prices[0].amount,Ne=De*me;le+=Ne,console.log("    ():",{addonName:fe.name,variantTitle:ge.title||Ce.addon_product.title,selectedVariantId:Ae.variantId,foundVariantId:ge.id,addonUnitPrice:De,totalQuantity:me,addonItemTotal:Ne,currentAddonTotal:le,calculationValid:ge.id===Ae.variantId})}),le}function M(be){var de,Fe;if(!((de=l(i))!=null&&de.productSelection)||!l(d)||l(i).productId!==P())return{totalQuantity:0,selectedColors:[],totalAmount:{originalTotal:0,discountedTotal:0,hasDiscount:!1}};const{quantityByVariant:Le,variantsByColor:Y={},variantDiscounts:O}=l(i).productSelection,ve=Object.values(Le||{}).reduce((U,Ae)=>U+Object.values(Ae||{}).reduce((fe,Ce)=>fe+Ce,0),0),xe=Object.keys(Le||{}).filter(U=>Object.values(Le[U]||{}).some(Ae=>Ae>0));let me=0,le=0,ze=!1;for(const U in Le||{})for(const Ae in Le[U]||{}){const fe=Le[U][Ae];if(fe>0){const Ce=(Fe=Y[U])==null?void 0:Fe.find(ge=>ge.id===Ae);if(Ce&&Ce.prices&&Ce.prices.length>0){const ge=Ce.prices[0].amount,De=O==null?void 0:O[Ae];me+=ge*fe,De!=null&&De.hasDiscount?(le+=De.discountedPrice*fe,ze=!0):le+=ge*fe}}}return{totalQuantity:ve,selectedColors:xe,totalAmount:{originalTotal:me,discountedTotal:ze?le:me,hasDiscount:ze}}}En(()=>{I=ur.subscribe(be=>{(be==null?void 0:be.productId)===P()&&_(N,Date.now())})}),Eo(()=>{I&&I()});function H(){j()&&j()()}function q(be){switch(be){case"arrow-left":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>';case"arrow-right":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>';case"check":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>';case"save":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>';default:return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>'}}function G(be,Le="normal"){const Y="odz-font-semibold odz-rounded-lg odz-transition-colors odz-duration-200 odz-flex odz-items-center odz-justify-center odz-gap-2",O=Le==="large"?"odz-py-3 odz-px-5 odz-text-base":"odz-py-2.5 odz-px-4 odz-text-sm";return be==="primary"?`${Y} ${O} odz-bg-red-600 hover:odz-bg-red-700 odz-text-white`:`${Y} ${O} odz-bg-gray-100 hover:odz-bg-gray-200 odz-text-gray-700 hover:odz-text-gray-800 odz-border odz-border-gray-300`}Zt(()=>o(),()=>{_(i,o())}),Zt(()=>s(),()=>{_(a,s())}),Zt(()=>(l(a),zn(P())),()=>{var be,Le;_(A,(Le=(be=l(a))==null?void 0:be.productDataCache)==null?void 0:Le[P()])}),Zt(()=>l(A),()=>{var be;_(d,(be=l(A))==null?void 0:be.product)}),Zt(()=>l(N),()=>{_(c,M(l(N)))}),Zt(()=>{},()=>{_(u,se())}),Zt(()=>l(u),()=>{var be;_(h,((be=l(u))==null?void 0:be.currentMethod)??"selection")}),Zt(()=>(l(V),l(Z),l(h),l(u),zn(P()),zn(J()),zn(we()),l(oe),l(K)),()=>{l(V);const be=l(Z)||l(h),Le=!!l(u),Y=pe(P(),J(),we());let O=!1;be==="detailed"?O=!0:be==="simple"||be==="none"?O=!1:be==="selection"&&(O=Y);const ve=`${be}|${Le}|${Y}`;ve!==l(oe)&&_(oe,ve),l(K)!==O&&_(K,O)}),Zt(()=>l(ae),()=>{_(f,l(ae)??0)}),Zt(()=>l(c),()=>{_(g,l(c).totalAmount.hasDiscount?l(c).totalAmount.discountedTotal:l(c).totalAmount.originalTotal)}),Zt(()=>l(c),()=>{_(m,l(c).totalAmount.hasDiscount?l(c).totalAmount.originalTotal-l(c).totalAmount.discountedTotal:0)}),Zt(()=>l(m),()=>{_(y,l(m)>0)}),Zt(()=>o(),()=>{var be,Le;_(b,(Le=(be=o())==null?void 0:be.addonSelection)==null?void 0:Le.selectedAddons)}),Zt(()=>(l(i),l(c),l(N),l(b)),()=>{_(S,L(l(i),l(c),l(N),l(b)))}),Zt(()=>(l(K),l(f),l(g),l(S)),()=>{_(F,l(K)&&l(f)>0?l(g)+l(f)+l(S):l(g)+l(S))}),Zt(()=>(l(u),l(K),l(c),l(N)),()=>{(l(u)||l(K)||l(c).totalQuantity||l(N))&&E()}),Zt(()=>{},()=>{}),Zt(()=>(zn(D()),zn(te())),()=>{_(k,D()||te())}),Zn(),qr();var R=Nt(),he=gt(R);{var Be=be=>{var Le=GT(),Y=w(Le),O=w(Y),ve=w(O),xe=w(ve),me=z(w(xe),2),le=w(me),ze=z(me,2),ke=w(ze),de=z(xe,2),Fe=z(w(de),2),U=w(Fe),Ae=z(Fe,2);{var fe=Re=>{var Xe=UT(),tt=gt(Xe),rt=w(tt),Bt=z(tt,2),nt=w(Bt);He((ot,xt)=>{Qe(rt,`${ot??""}`),Qe(nt,`-${xt??""} `)},[()=>vr(l(c).totalAmount.originalTotal),()=>vr(l(m))],it),T(Re,Xe)};Se(Ae,Re=>{l(y)&&Re(fe)})}var Ce=z(de,2),ge=z(w(Ce),2);{var De=Re=>{var Xe=QT(),tt=gt(Xe),rt=w(tt),Bt=z(tt,2),nt=w(Bt);{var ot=Lt=>{var _t=Wr("    .");T(Lt,_t)},xt=Lt=>{var _t=Wr("    .");T(Lt,_t)};Se(nt,Lt=>{l(f)>0?Lt(ot):Lt(xt,!1)})}He(Lt=>{Qe(rt,`${Lt??""}`),Ir(Bt,`odz-mt-1 odz-text-[11px] ${l(f)>0?"odz-text-gray-500":"odz-text-orange-500"}`)},[()=>vr(l(f))],it),T(Re,Xe)},Ne=Re=>{var Xe=PT(),tt=z(gt(Xe),2);{var rt=nt=>{var ot=TT();T(nt,ot)},Bt=nt=>{var ot=LT();T(nt,ot)};Se(tt,nt=>{(l(Z)||l(h))==="simple"?nt(rt):nt(Bt,!1)})}T(Re,Xe)};Se(ge,Re=>{l(K)?Re(De):Re(Ne,!1)})}var Ze=z(Ce,2),Oe=z(w(Ze),2);{var Ke=Re=>{var Xe=kT(),tt=gt(Xe),rt=w(tt);He(Bt=>Qe(rt,`${Bt??""}`),[()=>vr(l(S))],it),T(Re,Xe)},Je=Re=>{var Xe=OT();T(Re,Xe)};Se(Oe,Re=>{l(S)>0?Re(Ke):Re(Je,!1)})}var Te=z(Ze,2),_e=z(w(Te),2),Ue=w(_e),Me=z(_e,2);{var je=Re=>{var Xe=DT(),tt=w(Xe),rt=z(tt);{var Bt=nt=>{var ot=Wr();He(xt=>Qe(ot,`+ ${xt??""}`),[()=>vr(l(S))],it),T(nt,ot)};Se(rt,nt=>{l(S)>0&&nt(Bt)})}He((nt,ot)=>Qe(tt,`${nt??""} + ${ot??""} `),[()=>vr(l(g)),()=>vr(l(f))],it),T(Re,Xe)},At=Re=>{var Xe=Nt(),tt=gt(Xe);{var rt=nt=>{var ot=HT(),xt=w(ot),Lt=z(xt);{var _t=Ct=>{var Ft=Wr();He(zt=>Qe(Ft,`+  ${zt??""}`),[()=>vr(l(S))],it),T(Ct,Ft)};Se(Lt,Ct=>{l(S)>0&&Ct(_t)})}var vt=z(Lt,2);{var Pt=Ct=>{var Ft=NT();T(Ct,Ft)},kt=Ct=>{var Ft=MT();T(Ct,Ft)};Se(vt,Ct=>{l(h)==="simple"?Ct(Pt):Ct(kt,!1)})}He(Ct=>Qe(xt,` ${Ct??""} `),[()=>vr(l(g))],it),T(nt,ot)},Bt=nt=>{var ot=jT(),xt=w(ot),Lt=z(xt);{var _t=vt=>{var Pt=Wr();He(kt=>Qe(Pt,`+  ${kt??""}`),[()=>vr(l(S))],it),T(vt,Pt)};Se(Lt,vt=>{l(S)>0&&vt(_t)})}He(vt=>Qe(xt,` ${vt??""} `),[()=>vr(l(g))],it),T(nt,ot)};Se(tt,nt=>{l(K)?nt(Bt,!1):nt(rt)},!0)}T(Re,Xe)};Se(Me,Re=>{l(K)&&l(f)>0?Re(je):Re(At,!1)})}var ut=z(ve,2);{var ht=Re=>{var Xe=VT(),tt=w(Xe);{var rt=nt=>{var ot=KT();Jt(ot,5,()=>D().buttons,ar,(xt,Lt,_t)=>{var vt=qT(),Pt=w(vt);{var kt=zt=>{var Tt=RT(),Rt=w(Tt);g0(Rt,()=>q(l(Lt).icon),!0,!1),T(zt,Tt)};Se(Pt,zt=>{l(Lt).icon&&zt(kt)})}var Ct=z(Pt,2),Ft=w(Ct);He(zt=>{Ir(vt,zt),Qe(Ft,l(Lt).text)},[()=>`${D().type==="single"?"odz-w-full":_t===0?"odz-flex-1":"odz-flex-1 sm:odz-flex-[1.35]"} ${G(l(Lt).style,l(Lt).size||"normal")}`],it),at("click",vt,function(...zt){var Tt;(Tt=l(Lt).action)==null||Tt.apply(this,zt)}),T(xt,vt)}),T(nt,ot)},Bt=nt=>{var ot=$T(),xt=z(w(ot),2),Lt=w(xt);He(()=>Qe(Lt,$())),at("click",ot,H),T(nt,ot)};Se(tt,nt=>{D()?nt(rt):nt(Bt,!1)})}T(Re,Xe)};Se(ut,Re=>{l(k)&&Re(ht)})}He((Re,Xe)=>{Qe(le,`${l(c).totalQuantity??""}`),Qe(ke,`${l(c).selectedColors.length??""}  `),Qe(U,`${Re??""}`),Qe(Ue,`${Xe??""}`)},[()=>vr(l(g)),()=>vr(l(F))],it),T(be,Le)};Se(he,be=>{l(c).totalQuantity>0&&l(d)&&be(Be)})}T(n,R),jr(),r()}var WT=ee('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),XT=ee('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div> <button class="odz-mt-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-px-4 odz-py-2 odz-rounded-lg odz-text-sm"> </button></div>'),YT=ee('<div class="odz-flex odz-items-center odz-justify-center odz-gap-2"><div class="odz-w-1.5 odz-h-1.5 odz-bg-gray-400 odz-rounded-full"></div> <span class="odz-text-xs odz-text-gray-600"> </span></div>'),JT=ee(`<button class="odz-group odz-cursor-pointer odz-w-full odz-text-left"><div class="odz-relative odz-bg-white odz-border-2 odz-border-gray-200 odz-rounded-xl odz-p-6
                               odz-transition-all odz-duration-300 odz-shadow-sm
                               hover:odz-border-gray-300 hover:odz-shadow-lg hover:odz-scale-105"><div></div> <div class="odz-relative odz-z-10"><div class="odz-text-4xl odz-mb-4 odz-text-center"> </div> <h3 class="odz-text-lg odz-font-bold odz-text-gray-800 odz-text-center odz-mb-2"> </h3> <p class="odz-text-sm odz-text-gray-600 odz-text-center odz-mb-4"> </p> <div class="odz-space-y-2"></div></div> <div class="odz-relative odz-z-10 odz-mt-6"><div></div></div></div></button>`),ZT=ee('<div class="odz-flex odz-flex-col odz-gap-6 odz-p-4"><div class="odz-text-center odz-mb-6"><h1 class="odz-text-2xl odz-font-bold odz-text-gray-800 odz-mb-2">  </h1> <p class="odz-text-sm odz-text-gray-600">   </p></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4 odz-px-2"></div> <!></div>'),eL=ee('<div class="odz-relative"><!> <!></div>'),tL=ee('<div class="odz-relative"><!> <!></div>'),rL=ee('<div class="odz-relative"><!> <!></div>'),nL=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-gap-6 odz-py-16"><div class="odz-text-center"><div class="odz-text-6xl odz-mb-4"></div> <h2 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2">  </h2> <p class="odz-text-sm odz-text-gray-600">        </p></div> <div class="odz-w-full"><!></div></div>');function T5(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(ur,"$fixedEstimateStore",t),s=()=>Xr(Ls,"$shopStore",t),i=()=>Xr(Et,"$estimateStore",t),a=Ie();let A=pt(e,"productId",8),d=pt(e,"estimateId",8,void 0),c=pt(e,"idx",8,void 0),u=pt(e,"step",12,0),h=pt(e,"onNext",8,void 0),f=Ie(null),g=Ie(!1),m=Ie(null);function y(){var pe;if(typeof window<"u"&&d()&&A())try{let V=`fixedEstimate_${A()}_${d()}_${c()}`,K=window.sessionStorage.getItem(V);if(K||(V=`fixedEstimate_${A()}_${d()}`,K=window.sessionStorage.getItem(V)),K){const oe=JSON.parse(K);if((pe=oe.printSelection)!=null&&pe.currentMethod)return oe.printSelection.currentMethod}}catch{}return"selection"}let b=Ie(y()),S=null;const F=[{id:"simple",title:"  ",description:"   ",icon:"",features:[" ","  "," "],color:"from-green-500 to-emerald-600"},{id:"detailed",title:"  ",description:"  ",icon:"",features:[" "," "," /"],color:"from-blue-500 to-indigo-600"},{id:"self-design",title:" ",description:"  ",icon:"",features:[" "," "," "],color:"from-purple-500 to-pink-600"},{id:"none",title:"  ",description:"    ",icon:"",features:[" ","  "," "],color:"from-gray-500 to-slate-600"}];function k(pe){const V=pe;if(_(b,V),V!=="selection"&&Hn.selectPrintMethod(A(),V),V!=="selection"&&ur.selectPrintMethod(V),typeof window<"u"&&(V==="simple"||V==="none")){try{const K=d()||"temp";[`detailedPrint_${A()}_${K}`,`detailedPrint_${A()}_${K}_${c()}`,`detailedPrint_${A()}`].forEach(ae=>{try{sessionStorage.removeItem(ae)}catch{}})}catch(K){console.error(" detailedPrint    :",K)}d()&&c()!==null&&ft.from("estimate_prints").delete().eq("estimate_id",d()).eq("idx",c()).then(({error:K})=>{K?console.error(" estimate_prints  :",K):console.log(" estimate_prints   (/ )")})}if(typeof window<"u"&&V!=="selection"){const K=new CustomEvent("printAmountRecalc",{detail:{productId:A(),fromMethod:"unknown",toMethod:V,idx:c(),estimateId:d(),source:"printMethodChange"}});window.dispatchEvent(K)}V==="none"&&(u(0),Hn.completePrintSelection(A()),ur.completePrintSelection(),h()&&h()())}function P(){_(b,"selection"),Hn.updatePrintSelection(A(),{currentMethod:"selection",isCompleted:!1}),ur.updatePrintSelection({currentMethod:"selection",isCompleted:!1,lastUpdated:Date.now()})}function te(){_(b,"selection"),A()&&Hn.updatePrintSelection(A(),{currentMethod:"selection",isCompleted:!1})}function $(){u(0),Hn.completePrintSelection(A()),ur.completePrintSelection(),h()&&h()()}function j(pe){pe!=null&&pe.product&&Et.update(V=>{const K=[...V.products];let oe=K.findIndex(ae=>{var x;return((x=ae==null?void 0:ae.product)==null?void 0:x.id)===pe.product.id});if(oe===-1){const ae={product:pe.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:pe.addonProductsMap||{},productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0};K.push(ae),oe=K.length-1}else K[oe].prints||(K[oe]={...K[oe],prints:[]});return{...V,products:K,index:oe}})}async function J(pe=!1){var V,K;if(A()){_(g,!0),_(m,null);try{const oe=o().productSelection;if(pe&&oe&&oe.product&&oe.productId===A()){if(_(f,{product:oe.product,addons:oe.addons||[],addonItems:oe.addonItems||[]}),j(l(f)),typeof window<"u"&&d())try{const x=d(),E=`fixedEstimate_${A()}_${x}`,I=window.sessionStorage.getItem(E);if(I){const L=JSON.parse(I);(V=L.printSelection)!=null&&V.currentMethod&&(_(b,L.printSelection.currentMethod),console.log(" Edit  (print.svelte): sessionStorage   :",{currentMethod:l(b),key:E}))}}catch{}return}if(!pe){const x=Hn.restoreFromSession(A());if(x!=null&&x.isLoaded){_(f,x),j(l(f)),x.printSelection&&_(b,x.printSelection.currentMethod);return}}const ae=Hn.getProductData(A());ae!=null&&ae.isLoaded?(_(f,ae),j(l(f)),!pe&&ae.printSelection&&_(b,ae.printSelection.currentMethod)):(_(f,await Hn.loadIntegratedProductData(A(),s().id)),j(l(f))),(K=l(f))!=null&&K.process}catch(oe){_(m,oe instanceof Error?oe.message:"   .")}finally{_(g,!1)}}}function we(){const pe=Hn.getProductData(A());if(!(pe!=null&&pe.printSelection))return;const V=pe.printSelection;_(b,V.currentMethod)}function D(){S=Hn.subscribe(pe=>{const V=pe.productDataCache[A()];if(V!=null&&V.printSelection){const oe=V.printSelection.currentMethod;oe!==l(b)&&_(b,oe)}})}En(async()=>{var V,K,oe,ae,x,E,I;const pe=d()&&d()!=="temp";if(ur.initialize(A(),d(),c()),D(),await J(pe),!pe)we();else if(typeof window<"u"&&d())try{const L=d(),M=`fixedEstimate_${A()}_${L}`,H=window.sessionStorage.getItem(M);if(H){const q=JSON.parse(H);(V=q.printSelection)!=null&&V.currentMethod&&(_(b,q.printSelection.currentMethod),console.log(" Edit  (onMount): sessionStorage   :",{currentMethod:l(b),key:M}))}else(oe=(K=o())==null?void 0:K.printSelection)!=null&&oe.currentMethod&&_(b,o().printSelection.currentMethod)}catch{(x=(ae=o())==null?void 0:ae.printSelection)!=null&&x.currentMethod&&_(b,o().printSelection.currentMethod)}if(!pe){const L=i().products.find(H=>{var q;return((q=H==null?void 0:H.product)==null?void 0:q.id)===A()});if((!((E=l(f))!=null&&E.printSelection)||!l(f).printSelection.currentMethod||l(f).printSelection.currentMethod==="selection")&&(L!=null&&L.prints)&&L.prints.length>0)try{const H=L.prints[0],q=(H==null?void 0:H.method)??((I=H==null?void 0:H.parentTemplates)!=null&&I.length?"detailed":"simple");Hn.updatePrintSelection(A(),{currentMethod:q??l(b),selectedTemplate:H==null?void 0:H.template,selectedColors:H==null?void 0:H.colors,printConfig:H==null?void 0:H.config}),_(b,q??l(b)),console.log("      (currentMethod ):",{derivedMethod:q,fallbackMethod:l(b)})}catch{}}}),Eo(()=>{S&&S()}),Zt(()=>l(f),()=>{_(a,F.filter(pe=>{var V,K;return pe.id==="self-design"?((K=(V=l(f))==null?void 0:V.product)==null?void 0:K.self_design_enabled)===!0:!0}))}),Zt(()=>(l(b),l(a)),()=>{l(b)!=="selection"&&(l(a).some(V=>V.id===l(b))||_(b,"selection"))}),Zn(),qr();var N=Nt(),Z=gt(N);{var se=pe=>{var V=WT();T(pe,V)},ce=pe=>{var V=Nt(),K=gt(V);{var oe=x=>{var E=XT(),I=w(E),L=z(w(I),2),M=z(w(L),2),H=w(M),q=z(I,2);He(()=>Qe(H,l(m))),at("click",q,()=>J(d()&&d()!=="temp")),T(x,E)},ae=x=>{var E=Nt(),I=gt(E);{var L=H=>{var q=ZT(),G=z(w(q),2);Jt(G,5,()=>l(a),ar,(be,Le)=>{var Y=JT(),O=w(Y),ve=w(O),xe=z(ve,2),me=w(xe),le=w(me),ze=z(me,2),ke=w(ze),de=z(ze,2),Fe=w(de),U=z(de,2);Jt(U,5,()=>l(Le).features,ar,(Ce,ge)=>{var De=YT(),Ne=z(w(De),2),Ze=w(Ne);He(()=>Qe(Ze,l(ge))),T(Ce,De)});var Ae=z(xe,2),fe=w(Ae);He(()=>{Ir(ve,`odz-absolute odz-inset-0 odz-bg-gradient-to-br ${l(Le).color??""}
                                   odz-rounded-xl odz-opacity-0 group-hover:odz-opacity-10 odz-transition-opacity odz-duration-300`),Qe(le,l(Le).icon),Qe(ke,l(Le).title),Qe(Fe,l(Le).description),Ir(fe,`odz-w-full odz-bg-gradient-to-r ${l(Le).color??""}
                                          odz-text-white odz-font-semibold odz-py-2 odz-px-4 odz-rounded-lg
                                          odz-transition-all odz-duration-200 hover:odz-shadow-md
                                          group-hover:odz-shadow-lg odz-text-center`)}),at("click",Y,()=>k(l(Le).id)),T(be,Y)});var R=z(G,2);const he=it(()=>d()||null),Be=it(()=>c()!==void 0?c():null);VA(R,{get productId(){return A()},get estimateId(){return l(he)},get idx(){return l(Be)},buttonConfig:{type:"single",buttons:[{text:" ",action:()=>{if(typeof window<"u"){const be=new CustomEvent("changeTab",{detail:"product"});window.dispatchEvent(be)}},style:"secondary",icon:"arrow-left"}]}}),T(H,q)},M=H=>{var q=Nt(),G=gt(q);{var R=Be=>{var be=eL(),Le=w(be);zQ(Le,{get productId(){return A()},get estimateId(){return d()},get idx(){return c()},onComplete:$,onCancel:P});var Y=z(Le,2);const O=it(()=>d()||null),ve=it(()=>c()!==void 0?c():null);VA(Y,{get productId(){return A()},get estimateId(){return l(O)},get idx(){return l(ve)},buttonConfig:{type:"double",buttons:[{text:" ",action:P,style:"secondary",icon:"arrow-left"},{text:"",action:$,style:"primary",icon:"arrow-right",size:"large"}]}}),T(Be,be)},he=Be=>{var be=Nt(),Le=gt(be);{var Y=ve=>{var xe=tL(),me=w(xe);ET(me,{get productId(){return A()},get estimateId(){return d()},onComplete:$});var le=z(me,2);const ze=it(()=>d()||null),ke=it(()=>c()!==void 0?c():null);VA(le,{get productId(){return A()},get estimateId(){return l(ze)},get idx(){return l(ke)},buttonConfig:{type:"double",buttons:[{text:" ",action:P,style:"secondary",icon:"arrow-left"},{text:"",action:$,style:"primary",icon:"arrow-right",size:"large"}]}}),T(ve,xe)},O=ve=>{var xe=Nt(),me=gt(xe);{var le=ke=>{var de=rL(),Fe=w(de);IT(Fe,{get productId(){return A()},onComplete:$});var U=z(Fe,2);const Ae=it(()=>d()||null),fe=it(()=>c()!==void 0?c():null);VA(U,{get productId(){return A()},get estimateId(){return l(Ae)},get idx(){return l(fe)},buttonConfig:{type:"double",buttons:[{text:" ",action:P,style:"secondary",icon:"arrow-left"},{text:"",action:$,style:"primary",icon:"arrow-right",size:"large"}]}}),T(ke,de)},ze=ke=>{var de=Nt(),Fe=gt(de);{var U=Ae=>{var fe=nL(),Ce=z(w(fe),2),ge=w(Ce);const De=it(()=>d()||null),Ne=it(()=>c()!==void 0?c():null);VA(ge,{get productId(){return A()},get estimateId(){return l(De)},get idx(){return l(Ne)},buttonConfig:{type:"double",buttons:[{text:" ",action:P,style:"secondary",icon:"arrow-left"},{text:" ",action:$,style:"primary",icon:"arrow-right",size:"large"}]}}),T(Ae,fe)};Se(Fe,Ae=>{l(b)==="none"&&Ae(U)},!0)}T(ke,de)};Se(me,ke=>{l(b)==="self-design"?ke(le):ke(ze,!1)},!0)}T(ve,xe)};Se(Le,ve=>{l(b)==="detailed"?ve(Y):ve(O,!1)},!0)}T(Be,be)};Se(G,Be=>{l(b)==="simple"?Be(R):Be(he,!1)},!0)}T(H,q)};Se(I,H=>{l(b)==="selection"?H(L):H(M,!1)},!0)}T(x,E)};Se(K,x=>{l(m)?x(oe):x(ae,!1)},!0)}T(pe,V)};Se(Z,pe=>{l(g)?pe(se):pe(ce,!1)})}T(n,N),z_(e,"resetPrintTab",te);var re=jr({resetPrintTab:te});return r(),re}/*!
* html2canvas-pro 1.5.8 <https://yorickshan.github.io/html2canvas-pro/>
* Copyright (c) 2024 yorickshan <https://github.com/yorickshan>
* Released under MIT License
*//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var $0=function(n,e){return $0=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},$0(n,e)};function _i(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");$0(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var V0=function(){return V0=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},V0.apply(this,arguments)};function Xo(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,[])).next())})}function No(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,i;return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(d){return function(c){return A([d,c])}}function A(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=d[0]&2?o.return:d[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,d[1])).done)return s;switch(o=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){t.label=d[1];break}if(d[0]===6&&t.label<s[1]){t.label=s[1],s=d;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(d);break}s[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(c){d=[6,c],o=0}finally{r=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function sf(n,e,t){if(arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||e)}var Fa=function(){function n(e,t,r,o){this.left=e,this.top=t,this.width=r,this.height=o}return n.prototype.add=function(e,t,r,o){return new n(this.left+e,this.top+t,this.width+r,this.height+o)},n.fromClientRect=function(e,t){return new n(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},n.fromDOMRectList=function(e,t){var r=Array.from(t).find(function(o){return o.width!==0});return r?new n(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n}(),cg=function(n,e){return Fa.fromClientRect(n,e.getBoundingClientRect())},oL=function(n){var e=n.body,t=n.documentElement;if(!e||!t)throw new Error("Unable to get document size");var r=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),o=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new Fa(0,0,r,o)},ug=function(n){for(var e=[],t=0,r=n.length;t<r;){var o=n.charCodeAt(t++);if(o>=55296&&o<=56319&&t<r){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),t--)}else e.push(o)}return e},Vn=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],o=-1,s="";++o<t;){var i=n[o];i<=65535?r.push(i):(i-=65536,r.push((i>>10)+55296,i%1024+56320)),(o+1===t||r.length>16384)&&(s+=String.fromCharCode.apply(String,r),r.length=0)}return s},ty="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sL=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var af=0;af<ty.length;af++)sL[ty.charCodeAt(af)]=af;var ry="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Gc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Af=0;Af<ry.length;Af++)Gc[ry.charCodeAt(Af)]=Af;var iL=function(n){var e=n.length*.75,t=n.length,r,o=0,s,i,a,A;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),c=Array.isArray(d)?d:new Uint8Array(d);for(r=0;r<t;r+=4)s=Gc[n.charCodeAt(r)],i=Gc[n.charCodeAt(r+1)],a=Gc[n.charCodeAt(r+2)],A=Gc[n.charCodeAt(r+3)],c[o++]=s<<2|i>>4,c[o++]=(i&15)<<4|a>>2,c[o++]=(a&3)<<6|A&63;return d},aL=function(n){for(var e=n.length,t=[],r=0;r<e;r+=2)t.push(n[r+1]<<8|n[r]);return t},AL=function(n){for(var e=n.length,t=[],r=0;r<e;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},al=5,k1=11,Sv=2,lL=k1-al,L5=65536>>al,dL=1<<al,Ev=dL-1,cL=1024>>al,uL=L5+cL,hL=uL,fL=32,pL=hL+fL,gL=65536>>k1,vL=1<<lL,mL=vL-1,ny=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},wL=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},yL=function(n,e){var t=iL(n),r=Array.isArray(t)?AL(t):new Uint32Array(t),o=Array.isArray(t)?aL(t):new Uint16Array(t),s=24,i=ny(o,s/2,r[4]/2),a=r[5]===2?ny(o,(s+r[4])/2):wL(r,Math.ceil((s+r[4])/4));return new bL(r[0],r[1],r[2],r[3],i,a)},bL=function(){function n(e,t,r,o,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=o,this.index=s,this.data=i}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>al],t=(t<<Sv)+(e&Ev),this.data[t];if(e<=65535)return t=this.index[L5+(e-55296>>al)],t=(t<<Sv)+(e&Ev),this.data[t];if(e<this.highStart)return t=pL-gL+(e>>k1),t=this.index[t],t+=e>>al&mL,t=this.index[t],t=(t<<Sv)+(e&Ev),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),oy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_L=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var lf=0;lf<oy.length;lf++)_L[oy.charCodeAt(lf)]=lf;var BL="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",sy=50,xL=1,P5=2,k5=3,zL=4,CL=5,iy=7,O5=8,ay=9,lA=10,G0=11,Ay=12,W0=13,SL=14,Wc=15,X0=16,df=17,Oc=18,EL=19,ly=20,Y0=21,Dc=22,Fv=23,td=24,Es=25,Xc=26,Yc=27,rd=28,FL=29,GA=30,IL=31,cf=32,uf=33,J0=34,Z0=35,em=36,Iu=37,tm=38,Rf=39,qf=40,Iv=41,D5=42,UL=43,QL=[9001,65288],N5="!",Dr="",hf="",rm=yL(BL),la=[GA,em],nm=[xL,P5,k5,CL],M5=[lA,O5],dy=[Yc,Xc],TL=nm.concat(M5),cy=[tm,Rf,qf,J0,Z0],LL=[Wc,W0],PL=function(n,e){e===void 0&&(e="strict");var t=[],r=[],o=[];return n.forEach(function(s,i){var a=rm.get(s);if(a>sy?(o.push(!0),a-=sy):o.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return r.push(i),t.push(X0);if(a===zL||a===G0){if(i===0)return r.push(i),t.push(GA);var A=t[i-1];return TL.indexOf(A)===-1?(r.push(r[i-1]),t.push(A)):(r.push(i),t.push(GA))}if(r.push(i),a===IL)return t.push(e==="strict"?Y0:Iu);if(a===D5||a===FL)return t.push(GA);if(a===UL)return s>=131072&&s<=196605||s>=196608&&s<=262141?t.push(Iu):t.push(GA);t.push(a)}),[r,t,o]},Uv=function(n,e,t,r){var o=r[t];if(Array.isArray(n)?n.indexOf(o)!==-1:n===o)for(var s=t;s<=r.length;){s++;var i=r[s];if(i===e)return!0;if(i!==lA)break}if(o===lA)for(var s=t;s>0;){s--;var a=r[s];if(Array.isArray(n)?n.indexOf(a)!==-1:n===a)for(var A=t;A<=r.length;){A++;var i=r[A];if(i===e)return!0;if(i!==lA)break}if(a!==lA)break}return!1},uy=function(n,e){for(var t=n;t>=0;){var r=e[t];if(r===lA)t--;else return r}return 0},kL=function(n,e,t,r,o){if(t[r]===0)return Dr;var s=r-1;if(Array.isArray(o)&&o[s]===!0)return Dr;var i=s-1,a=s+1,A=e[s],d=i>=0?e[i]:0,c=e[a];if(A===P5&&c===k5)return Dr;if(nm.indexOf(A)!==-1)return N5;if(nm.indexOf(c)!==-1||M5.indexOf(c)!==-1)return Dr;if(uy(s,e)===O5)return hf;if(rm.get(n[s])===G0||(A===cf||A===uf)&&rm.get(n[a])===G0||A===iy||c===iy||A===ay||[lA,W0,Wc].indexOf(A)===-1&&c===ay||[df,Oc,EL,td,rd].indexOf(c)!==-1||uy(s,e)===Dc||Uv(Fv,Dc,s,e)||Uv([df,Oc],Y0,s,e)||Uv(Ay,Ay,s,e))return Dr;if(A===lA)return hf;if(A===Fv||c===Fv)return Dr;if(c===X0||A===X0)return hf;if([W0,Wc,Y0].indexOf(c)!==-1||A===SL||d===em&&LL.indexOf(A)!==-1||A===rd&&c===em||c===ly||la.indexOf(c)!==-1&&A===Es||la.indexOf(A)!==-1&&c===Es||A===Yc&&[Iu,cf,uf].indexOf(c)!==-1||[Iu,cf,uf].indexOf(A)!==-1&&c===Xc||la.indexOf(A)!==-1&&dy.indexOf(c)!==-1||dy.indexOf(A)!==-1&&la.indexOf(c)!==-1||[Yc,Xc].indexOf(A)!==-1&&(c===Es||[Dc,Wc].indexOf(c)!==-1&&e[a+1]===Es)||[Dc,Wc].indexOf(A)!==-1&&c===Es||A===Es&&[Es,rd,td].indexOf(c)!==-1)return Dr;if([Es,rd,td,df,Oc].indexOf(c)!==-1)for(var u=s;u>=0;){var h=e[u];if(h===Es)return Dr;if([rd,td].indexOf(h)!==-1)u--;else break}if([Yc,Xc].indexOf(c)!==-1)for(var u=[df,Oc].indexOf(A)!==-1?i:s;u>=0;){var h=e[u];if(h===Es)return Dr;if([rd,td].indexOf(h)!==-1)u--;else break}if(tm===A&&[tm,Rf,J0,Z0].indexOf(c)!==-1||[Rf,J0].indexOf(A)!==-1&&[Rf,qf].indexOf(c)!==-1||[qf,Z0].indexOf(A)!==-1&&c===qf||cy.indexOf(A)!==-1&&[ly,Xc].indexOf(c)!==-1||cy.indexOf(c)!==-1&&A===Yc||la.indexOf(A)!==-1&&la.indexOf(c)!==-1||A===td&&la.indexOf(c)!==-1||la.concat(Es).indexOf(A)!==-1&&c===Dc&&QL.indexOf(n[a])===-1||la.concat(Es).indexOf(c)!==-1&&A===Oc)return Dr;if(A===Iv&&c===Iv){for(var f=t[s],g=1;f>0&&(f--,e[f]===Iv);)g++;if(g%2!==0)return Dr}return A===cf&&c===uf?Dr:hf},OL=function(n,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=PL(n,e.lineBreak),r=t[0],o=t[1],s=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(o=o.map(function(a){return[Es,GA,D5].indexOf(a)!==-1?Iu:a}));var i=e.wordBreak==="keep-all"?s.map(function(a,A){return a&&n[A]>=19968&&n[A]<=40959}):void 0;return[r,o,i]},DL=function(){function n(e,t,r,o){this.codePoints=e,this.required=t===N5,this.start=r,this.end=o}return n.prototype.slice=function(){return Vn.apply(void 0,this.codePoints.slice(this.start,this.end))},n}(),NL=function(n,e){var t=ug(n),r=OL(t,e),o=r[0],s=r[1],i=r[2],a=t.length,A=0,d=0;return{next:function(){if(d>=a)return{done:!0,value:null};for(var c=Dr;d<a&&(c=kL(t,s,o,++d,i))===Dr;);if(c!==Dr||d===a){var u=new DL(t,c,A,d);return A=d,{value:u,done:!1}}return{done:!0,value:null}}}},ML=1,HL=2,Vu=4,hy=8,Bp=10,fy=47,lu=92,jL=9,RL=32,ff=34,Nc=61,qL=35,KL=36,$L=37,pf=39,gf=40,Mc=41,VL=95,ds=45,GL=33,WL=60,XL=62,YL=64,JL=91,ZL=93,eP=61,tP=123,vf=63,rP=125,py=124,nP=126,oP=128,gy=65533,Qv=42,rl=43,sP=44,iP=58,aP=59,Uu=46,AP=0,lP=8,dP=11,cP=14,uP=31,hP=127,Ti=-1,H5=48,j5=97,R5=101,fP=102,pP=117,gP=122,q5=65,K5=69,$5=70,vP=85,mP=90,Mo=function(n){return n>=H5&&n<=57},wP=function(n){return n>=55296&&n<=57343},nd=function(n){return Mo(n)||n>=q5&&n<=$5||n>=j5&&n<=fP},yP=function(n){return n>=j5&&n<=gP},bP=function(n){return n>=q5&&n<=mP},_P=function(n){return yP(n)||bP(n)},BP=function(n){return n>=oP},mf=function(n){return n===Bp||n===jL||n===RL},xp=function(n){return _P(n)||BP(n)||n===VL},vy=function(n){return xp(n)||Mo(n)||n===ds},xP=function(n){return n>=AP&&n<=lP||n===dP||n>=cP&&n<=uP||n===hP},sA=function(n,e){return n!==lu?!1:e!==Bp},wf=function(n,e,t){return n===ds?xp(e)||sA(e,t):xp(n)?!0:!!(n===lu&&sA(n,e))},Tv=function(n,e,t){return n===rl||n===ds?Mo(e)?!0:e===Uu&&Mo(t):Mo(n===Uu?e:n)},zP=function(n){var e=0,t=1;(n[e]===rl||n[e]===ds)&&(n[e]===ds&&(t=-1),e++);for(var r=[];Mo(n[e]);)r.push(n[e++]);var o=r.length?parseInt(Vn.apply(void 0,r),10):0;n[e]===Uu&&e++;for(var s=[];Mo(n[e]);)s.push(n[e++]);var i=s.length,a=i?parseInt(Vn.apply(void 0,s),10):0;(n[e]===K5||n[e]===R5)&&e++;var A=1;(n[e]===rl||n[e]===ds)&&(n[e]===ds&&(A=-1),e++);for(var d=[];Mo(n[e]);)d.push(n[e++]);var c=d.length?parseInt(Vn.apply(void 0,d),10):0;return t*(o+a*Math.pow(10,-i))*Math.pow(10,A*c)},CP={type:2},SP={type:3},EP={type:4},FP={type:13},IP={type:8},UP={type:21},QP={type:9},TP={type:10},LP={type:11},PP={type:12},kP={type:14},yf={type:23},OP={type:1},DP={type:25},NP={type:24},MP={type:26},HP={type:27},jP={type:28},RP={type:29},qP={type:31},om={type:32},V5=function(){function n(){this._value=[]}return n.prototype.write=function(e){this._value=this._value.concat(ug(e))},n.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==om;)e.push(t),t=this.consumeToken();return e},n.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case ff:return this.consumeStringToken(ff);case qL:var t=this.peekCodePoint(0),r=this.peekCodePoint(1),o=this.peekCodePoint(2);if(vy(t)||sA(r,o)){var s=wf(t,r,o)?HL:ML,i=this.consumeName();return{type:5,value:i,flags:s}}break;case KL:if(this.peekCodePoint(0)===Nc)return this.consumeCodePoint(),FP;break;case pf:return this.consumeStringToken(pf);case gf:return CP;case Mc:return SP;case Qv:if(this.peekCodePoint(0)===Nc)return this.consumeCodePoint(),kP;break;case rl:if(Tv(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case sP:return EP;case ds:var a=e,A=this.peekCodePoint(0),d=this.peekCodePoint(1);if(Tv(a,A,d))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(wf(a,A,d))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(A===ds&&d===XL)return this.consumeCodePoint(),this.consumeCodePoint(),NP;break;case Uu:if(Tv(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case fy:if(this.peekCodePoint(0)===Qv)for(this.consumeCodePoint();;){var c=this.consumeCodePoint();if(c===Qv&&(c=this.consumeCodePoint(),c===fy))return this.consumeToken();if(c===Ti)return this.consumeToken()}break;case iP:return MP;case aP:return HP;case WL:if(this.peekCodePoint(0)===GL&&this.peekCodePoint(1)===ds&&this.peekCodePoint(2)===ds)return this.consumeCodePoint(),this.consumeCodePoint(),DP;break;case YL:var u=this.peekCodePoint(0),h=this.peekCodePoint(1),f=this.peekCodePoint(2);if(wf(u,h,f)){var i=this.consumeName();return{type:7,value:i}}break;case JL:return jP;case lu:if(sA(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case ZL:return RP;case eP:if(this.peekCodePoint(0)===Nc)return this.consumeCodePoint(),IP;break;case tP:return LP;case rP:return PP;case pP:case vP:var g=this.peekCodePoint(0),m=this.peekCodePoint(1);return g===rl&&(nd(m)||m===vf)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case py:if(this.peekCodePoint(0)===Nc)return this.consumeCodePoint(),QP;if(this.peekCodePoint(0)===py)return this.consumeCodePoint(),UP;break;case nP:if(this.peekCodePoint(0)===Nc)return this.consumeCodePoint(),TP;break;case Ti:return om}return mf(e)?(this.consumeWhiteSpace(),qP):Mo(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):xp(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Vn(e)}},n.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},n.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},n.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},n.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();nd(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var r=!1;t===vf&&e.length<6;)e.push(t),t=this.consumeCodePoint(),r=!0;if(r){var o=parseInt(Vn.apply(void 0,e.map(function(A){return A===vf?H5:A})),16),s=parseInt(Vn.apply(void 0,e.map(function(A){return A===vf?$5:A})),16);return{type:30,start:o,end:s}}var i=parseInt(Vn.apply(void 0,e),16);if(this.peekCodePoint(0)===ds&&nd(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var a=[];nd(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();var s=parseInt(Vn.apply(void 0,a),16);return{type:30,start:i,end:s}}else return{type:30,start:i,end:i}},n.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===gf?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===gf?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},n.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ti)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===pf||t===ff){var r=this.consumeStringToken(this.consumeCodePoint());return r.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===Ti||this.peekCodePoint(0)===Mc)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),yf)}for(;;){var o=this.consumeCodePoint();if(o===Ti||o===Mc)return{type:22,value:Vn.apply(void 0,e)};if(mf(o))return this.consumeWhiteSpace(),this.peekCodePoint(0)===Ti||this.peekCodePoint(0)===Mc?(this.consumeCodePoint(),{type:22,value:Vn.apply(void 0,e)}):(this.consumeBadUrlRemnants(),yf);if(o===ff||o===pf||o===gf||xP(o))return this.consumeBadUrlRemnants(),yf;if(o===lu)if(sA(o,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),yf;else e.push(o)}},n.prototype.consumeWhiteSpace=function(){for(;mf(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===Mc||e===Ti)return;sA(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(e){for(var t=5e4,r="";e>0;){var o=Math.min(t,e);r+=Vn.apply(void 0,this._value.splice(0,o)),e-=o}return this._value.shift(),r},n.prototype.consumeStringToken=function(e){var t="",r=0;do{var o=this._value[r];if(o===Ti||o===void 0||o===e)return t+=this.consumeStringSlice(r),{type:0,value:t};if(o===Bp)return this._value.splice(0,r),OP;if(o===lu){var s=this._value[r+1];s!==Ti&&s!==void 0&&(s===Bp?(t+=this.consumeStringSlice(r),r=-1,this._value.shift()):sA(o,s)&&(t+=this.consumeStringSlice(r),t+=Vn(this.consumeEscapedCodePoint()),r=-1))}r++}while(!0)},n.prototype.consumeNumber=function(){var e=[],t=Vu,r=this.peekCodePoint(0);for((r===rl||r===ds)&&e.push(this.consumeCodePoint());Mo(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0);var o=this.peekCodePoint(1);if(r===Uu&&Mo(o))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=hy;Mo(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0),o=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((r===K5||r===R5)&&((o===rl||o===ds)&&Mo(s)||Mo(o)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=hy;Mo(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[zP(e),t]},n.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],r=e[1],o=this.peekCodePoint(0),s=this.peekCodePoint(1),i=this.peekCodePoint(2);if(wf(o,s,i)){var a=this.consumeName();return{type:15,number:t,flags:r,unit:a}}return o===$L?(this.consumeCodePoint(),{type:16,number:t,flags:r}):{type:17,number:t,flags:r}},n.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(nd(e)){for(var t=Vn(e);nd(this.peekCodePoint(0))&&t.length<6;)t+=Vn(this.consumeCodePoint());mf(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return r===0||wP(r)||r>1114111?gy:r}return e===Ti?gy:e},n.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(vy(t))e+=Vn(t);else if(sA(t,this.peekCodePoint(0)))e+=Vn(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},n}(),G5=function(){function n(e){this._tokens=e}return n.create=function(e){var t=new V5;return t.write(e),new n(t.read())},n.parseValue=function(e){return n.create(e).parseComponentValue()},n.parseValues=function(e){return n.create(e).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},n.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},n.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},r=this.consumeToken();;){if(r.type===32||$P(r,e))return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue()),r=this.consumeToken()}},n.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var r=this.consumeToken();if(r.type===32||r.type===3)return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?om:e},n.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},n}(),CA=function(n){return n.type===15},oo=function(n){return n.type===17},Mr=function(n){return n.type===20},KP=function(n){return n.type===0},sm=function(n,e){return Mr(n)&&n.value===e},W5=function(n){return n.type!==31},So=function(n){return n.type!==31&&n.type!==4},Ji=function(n){var e=[],t=[];return n.forEach(function(r){if(r.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}r.type!==31&&t.push(r)}),t.length&&e.push(t),e},$P=function(n,e){return e===11&&n.type===12||e===28&&n.type===29?!0:e===2&&n.type===3},bA=function(n){return n.type===17||n.type===15},Cn=function(n){return n.type===16||bA(n)},X5=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},Co={type:17,number:0,flags:Vu},O1={type:16,number:50,flags:Vu},dA={type:16,number:100,flags:Vu},Jc=function(n,e,t){var r=n[0],o=n[1];return[An(r,e),An(typeof o<"u"?o:r,t)]},An=function(n,e){if(n.type===16)return n.number/100*e;if(CA(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},Y5="deg",J5="grad",Z5="rad",ex="turn",hg={name:"angle",parse:function(n,e){if(e.type===15)switch(e.unit){case Y5:return Math.PI*e.number/180;case J5:return Math.PI/200*e.number;case Z5:return e.number;case ex:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},tx=function(n){return n.type===15&&(n.unit===Y5||n.unit===J5||n.unit===Z5||n.unit===ex)},rx=function(n){var e=n.filter(Mr).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[Co,Co];case"to top":case"bottom":return Xs(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[Co,dA];case"to right":case"left":return Xs(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[dA,dA];case"to bottom":case"top":return Xs(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[dA,Co];case"to left":case"right":return Xs(270)}return 0},Xs=function(n){return Math.PI*n/180},fA=function(n){return(255&n)===0},vo=function(n){var e=255&n,t=255&n>>8,r=255&n>>16,o=255&n>>24;return e<255?"rgba(".concat(o,",").concat(r,",").concat(t,",").concat(e/255,")"):"rgb(".concat(o,",").concat(r,",").concat(t,")")},Xi=function(n,e,t,r){return(n<<24|e<<16|t<<8|Math.round(r*255)<<0)>>>0},zp=function(n,e){if(n.type===17)return n.number;if(n.type===16){var t=e===3?1:255;return e===3?n.number/100*t:Math.round(n.number/100*t)}return 0},bl=function(n){return(n[0].type===20?n[0].value:"unknown")==="from"},jn=function(n,e,t){return Math.min(Math.max(n,e),t)},ms=function(n,e){return[n[0]*e[0]+n[1]*e[1]+n[2]*e[2],n[3]*e[0]+n[4]*e[1]+n[5]*e[2],n[6]*e[0]+n[7]*e[1]+n[8]*e[2]]},VP=function(n){return Xi(jn(Math.round(n[0]*255),0,255),jn(Math.round(n[1]*255),0,255),jn(Math.round(n[2]*255),0,255),jn(n[3],0,1))},D1=function(n){var e=n[0],t=n[1],r=n[2],o=n[3],s=_l([e,t,r]);return Xi(jn(Math.round(s[0]*255),0,255),jn(Math.round(s[1]*255),0,255),jn(Math.round(s[2]*255),0,255),o)},Gu=function(n){var e=SA([n[0],n[1],n[2]]);return D1([e[0],e[1],e[2],n[3]])},GP=function(n,e){if(bl(e.filter(So)))throw new Error("Relative color not supported for lab()");var t=fg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=_l(SA(vg([r,o,s])));return Xi(jn(Math.round(a[0]*255),0,255),jn(Math.round(a[1]*255),0,255),jn(Math.round(a[2]*255),0,255),i)},WP=function(n,e){if(bl(e.filter(So)))throw new Error("Relative color not supported for oklab()");var t=fg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=_l(SA(gg([r,o,s])));return Xi(jn(Math.round(a[0]*255),0,255),jn(Math.round(a[1]*255),0,255),jn(Math.round(a[2]*255),0,255),i)},XP=function(n,e){if(bl(e.filter(So)))throw new Error("Relative color not supported for oklch()");var t=sx(e),r=t[0],o=t[1],s=t[2],i=t[3],a=_l(SA(gg(pg([r,o,s]))));return Xi(jn(Math.round(a[0]*255),0,255),jn(Math.round(a[1]*255),0,255),jn(Math.round(a[2]*255),0,255),i)},YP=function(n,e){if(bl(e.filter(So)))throw new Error("Relative color not supported for lch()");var t=ox(e),r=t[0],o=t[1],s=t[2],i=t[3],a=_l(SA(vg(pg([r,o,s]))));return Xi(jn(Math.round(a[0]*255),0,255),jn(Math.round(a[1]*255),0,255),jn(Math.round(a[2]*255),0,255),i)},nx=function(n,e){var t=e.filter(So),r=t[0],o=t[1],s=t[2],i=t[3],a=(r.type===17?Xs(r.number):hg.parse(n,r))/(Math.PI*2),A=Cn(o)?o.number/100:0,d=Cn(s)?s.number/100:0,c=typeof i<"u"&&Cn(i)?An(i,1):1;return[a,A,d,c]},my=function(n,e){if(bl(e))throw new Error("Relative color not supported for hsl()");var t=nx(n,e),r=t[0],o=t[1],s=t[2],i=t[3],a=ax([r,o,s]);return Xi(a[0]*255,a[1]*255,a[2]*255,o===0?1:i)},ox=function(n){var e=n.filter(So),t=Cn(e[0])?e[0].number:0,r=Cn(e[1])?e[1].number:0,o=oo(e[2])||CA(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Cn(e[4])?An(e[4],1):1;return[t,r,o,s]},fg=function(n){var e=n.filter(So),t=e[0].type===16?e[0].number/100:oo(e[0])?e[0].number:0,r=e[1].type===16?e[1].number/100:oo(e[1])?e[1].number:0,o=oo(e[2])||CA(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Cn(e[4])?An(e[4],1):1;return[t,r,o,s]},sx=function(n){var e=n.filter(So),t=e[0].type===16?e[0].number/100:oo(e[0])?e[0].number:0,r=e[1].type===16?e[1].number/100:oo(e[1])?e[1].number:0,o=oo(e[2])||CA(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Cn(e[4])?An(e[4],1):1;return[t,r,o,s]},ix=function(n){return ms([1.0479297925449969,.022946870601609652,-.05019226628920524,.02962780877005599,.9904344267538799,-.017073799063418826,-.009243040646204504,.015055191490298152,.7518742814281371],n)},N1=function(n){return ms([.955473421488075,-.02309845494876471,.06325924320057072,-.0283697093338637,1.0099953980813041,.021041441191917323,.012314014864481998,-.020507649298898964,1.330365926242124],n)},Lv=function(n,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-n)*t*6+n:t<1/2?e:t<2/3?(e-n)*6*(2/3-t)+n:n},ax=function(n){var e=n[0],t=n[1],r=n[2];if(t===0)return[r*255,r*255,r*255];var o=r<=.5?r*(t+1):r+t-r*t,s=r*2-o,i=Lv(s,o,e+1/3),a=Lv(s,o,e),A=Lv(s,o,e-1/3);return[i,a,A]},pg=function(n){var e=n[0],t=n[1],r=n[2];return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},gg=function(n){var e=ms([1,.3963377773761749,.2158037573099136,1,-.1055613458156586,-.0638541728258133,1,-.0894841775298119,-1.2914855480194092],n),t=e.map(function(r){return Math.pow(r,3)});return ms([1.2268798758459243,-.5578149944602171,.2813910456659647,-.0405757452148008,1.112286803280317,-.0717110580655164,-.0763729366746601,-.4214933324022432,1.5869240198367816],t)},vg=function(n){var e=(n[0]+16)/116,t=n[1]/500+e,r=e-n[2]/200,o=24389/27,s=24/116,i=[(t>s?Math.pow(t,3):(116*t-16)/o)*.3457/.3585,n[0]>8?Math.pow(e,3):n[0]/o,(r>s?Math.pow(r,3):(116*r-16)/o)*(1-.3457-.3585)/.3585];return N1([i[0],i[1],i[2]])},JP=function(n,e){var t=e.filter(So);if(t.length===3){var r=t.map(zp),o=r[0],s=r[1],i=r[2],a=am([o/255,s/255,i/255]),A=im([a[0],a[1],a[2]]),d=A[0],c=A[1],u=A[2];return[d,c,u,1]}if(t.length===4){var h=t.map(zp),o=h[0],s=h[1],i=h[2],f=h[3],a=am([o/255,s/255,i/255]),g=im([a[0],a[1],a[2]]),d=g[0],c=g[1],u=g[2];return[d,c,u,f]}return[0,0,0,1]},ZP=function(n,e){var t=nx(n,e),r=t[0],o=t[1],s=t[2],i=t[3],a=am(ax([r,o,s])),A=im([a[0],a[1],a[2]]),d=A[0],c=A[1],u=A[2];return[d,c,u,i]},e6=function(n,e){var t=fg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=vg([r,o,s]),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},t6=function(n,e){var t=ox(e),r=t[0],o=t[1],s=t[2],i=t[3],a=vg(pg([r,o,s])),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},r6=function(n,e){var t=sx(e),r=t[0],o=t[1],s=t[2],i=t[3],a=gg(pg([r,o,s])),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},n6=function(n,e){var t=fg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=gg([r,o,s]),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},o6=function(n){return N1([n[0],n[1],n[2]])},wy=function(n){return n},s6=function(n){var e=ix([n[0],n[2],n[3]]),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},yy=function(n){return Gu([n[0],n[1],n[2],n[3]])},i6=function(n){var e=o6([n[0],n[1],n[2]]);return Gu([e[0],e[1],e[2],n[3]])},SA=function(n){return ms([3.2409699419045226,-1.537383177570094,-.4986107602930034,-.9692436362808796,1.8759675015077202,.04155505740717559,.05563007969699366,-.20397695888897652,1.0569715142428786],n)},im=function(n){return ms([.41239079926595934,.357584339383878,.1804807884018343,.21263900587151027,.715168678767756,.07219231536073371,.01933081871559182,.11919477979462598,.9505321522496607],n)},_l=function(n){return n.map(function(e){var t=e<0?-1:1,r=Math.abs(e);return r>.0031308?t*(1.055*Math.pow(r,1/2.4)-.055):12.92*e})},am=function(n){return n.map(function(e){var t=e<0?-1:1,r=Math.abs(e);return r<=.04045?e/12.92:t*Math.pow((r+.055)/1.055,2.4)})},a6=function(n){var e=_l(SA([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},A6=function(n){var e=SA([n[0],n[1],n[2]]),t=e[0],r=e[1],o=e[2];return[jn(Math.round(t*255),0,255),jn(Math.round(r*255),0,255),jn(Math.round(o*255),0,255),n[3]]},l6=function(n){return ms([.4865709486482162,.26566769316909306,.1982172852343625,.2289745640697488,.6917385218365064,.079286914093745,0,.04511338185890264,1.043944368900976],n)},d6=function(n){return ms([2.493496911941425,-.9313836179191239,-.40271078445071684,-.8294889695615747,1.7626640603183463,.023624685841943577,.03584583024378447,-.07617238926804182,.9568845240076872],n)},c6=function(n){return n.map(function(e){var t=e<0?-1:1,r=e*t;return r<=.04045?e/12.92:t*Math.pow((e+.055)/1.055,2.4)||0})},u6=function(n){return _l(n)},h6=function(n){var e=c6([n[0],n[1],n[2]]);return l6([e[0],e[1],e[2]])},f6=function(n){var e=u6(d6([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},p6=function(n){var e=h6([n[0],n[1],n[2]]);return Gu([e[0],e[1],e[2],n[3]])},g6=function(n){return ms([2.0415879038107465,-.5650069742788596,-.34473135077832956,-.9692436362808795,1.8759675015077202,.04155505740717557,.013444280632031142,-.11836239223101838,1.0151749943912054],n)},v6=function(n){return ms([.5766690429101305,.1855582379065463,.1882286462349947,.29734497525053605,.6273635662554661,.0752914584939978,.02703136138641234,.07068885253582723,.9913375368376388],n)},m6=function(n){var e=n.map(function(t){var r=t<0?-1:1,o=Math.abs(t);return r*Math.pow(o,2.19921875)});return[e[0],e[1],e[2]]},w6=function(n){var e=n.map(function(t){var r=t<0?-1:1,o=Math.abs(t);return r*Math.pow(o,.4547069271758437)});return[e[0],e[1],e[2]]},y6=function(n){var e=w6(g6([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},b6=function(n){var e=SA(v6(m6([n[0],n[1],n[2]])));return D1([e[0],e[1],e[2],n[3]])},_6=function(n){return ms([.7977666449006423,.13518129740053308,.0313477341283922,.2880748288194013,.711835234241873,8993693872564e-17,0,0,.8251046025104602],n)},B6=function(n){return ms([1.3457868816471583,-.25557208737979464,-.05110186497554526,-.5446307051249019,1.5082477428451468,.02052744743642139,0,0,1.2119675456389452],n)},x6=function(n){return n.map(function(e){return e<16/512?e/16:Math.pow(e,1.8)})},z6=function(n){return n.map(function(e){return e>1/512?Math.pow(e,1/1.8):e*16})},C6=function(n){var e=x6([n[0],n[1],n[2]]);return N1(_6([e[0],e[1],e[2]]))},S6=function(n){var e=z6(B6(ix([n[0],n[1],n[2]]))),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},E6=function(n){var e=C6([n[0],n[1],n[2]]);return Gu([e[0],e[1],e[2],n[3]])},Cp=1.09929682680944,Ax=.018053968510807,F6=function(n){return n.map(function(e){return e<Ax*4.5?e/4.5:Math.pow((e+Cp-1)/Cp,1/.45)})},I6=function(n){return n.map(function(e){return e>=Ax?Cp*Math.pow(e,.45)-(Cp-1):4.5*e})},U6=function(n){return ms([.6369580483012914,.14461690358620832,.1688809751641721,.2627002120112671,.6779980715188708,.05930171646986196,0,.028072693049087428,1.060985057710791],n)},Q6=function(n){return ms([1.716651187971268,-.355670783776392,-.25336628137366,-.666684351832489,1.616481236634939,.0157685458139111,.017639857445311,-.042770613257809,.942103121235474],n)},T6=function(n){var e=F6([n[0],n[1],n[2]]);return U6([e[0],e[1],e[2]])},L6=function(n){var e=I6(Q6([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},P6=function(n){var e=T6([n[0],n[1],n[2]]);return Gu([e[0],e[1],e[2],n[3]])},pA={name:"color",parse:function(n,e){if(e.type===18){var t=N6[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'.concat(e.name,'"'));return t(n,e.values)}if(e.type===5){var r=lx(e),o=r[0],s=r[1],i=r[2],a=r[3];return Xi(o,s,i,a)}if(e.type===20){var A=Ri[e.value.toUpperCase()];if(typeof A<"u")return A}return Ri.TRANSPARENT}},lx=function(n){if(n.value.length===3){var e=n.value.substring(0,1),t=n.value.substring(1,2),r=n.value.substring(2,3);return[parseInt(e+e,16),parseInt(t+t,16),parseInt(r+r,16),1]}if(n.value.length===4){var e=n.value.substring(0,1),t=n.value.substring(1,2),r=n.value.substring(2,3),o=n.value.substring(3,4);return[parseInt(e+e,16),parseInt(t+t,16),parseInt(r+r,16),parseInt(o+o,16)/255]}if(n.value.length===6){var e=n.value.substring(0,2),t=n.value.substring(2,4),r=n.value.substring(4,6);return[parseInt(e,16),parseInt(t,16),parseInt(r,16),1]}if(n.value.length===8){var e=n.value.substring(0,2),t=n.value.substring(2,4),r=n.value.substring(4,6),o=n.value.substring(6,8);return[parseInt(e,16),parseInt(t,16),parseInt(r,16),parseInt(o,16)/255]}return[0,0,0,1]},by=function(n,e){var t=e.filter(So);if(bl(t))throw new Error("Relative color not supported for rgb()");if(t.length===3){var r=t.map(zp),o=r[0],s=r[1],i=r[2];return Xi(o,s,i,1)}if(t.length===4){var a=t.map(zp),o=a[0],s=a[1],i=a[2],A=a[3];return Xi(o,s,i,A)}return 0},k6=function(n,e){var t=e.filter(So),r=t[0].type===20?t[0].value:"unknown",o=!bl(t);if(o){var s=r,i=_y[s];if(typeof i>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(s,'" for color() function'));var a=oo(t[1])?t[1].number:0,A=oo(t[2])?t[2].number:0,d=oo(t[3])?t[3].number:0,c=t.length>4&&t[4].type===6&&t[4].value==="/"&&oo(t[5])?t[5].number:1;return i([a,A,d,c])}else{var u=function(ce,re){if(oo(re))return re.number;var pe=function(x){return x==="r"||x==="x"?0:x==="g"||x==="y"?1:2};if(Mr(re)){var V=pe(re.value);return ce[V]}var K=function(x){for(var E=x.filter(So),I="(",L=0,M=E;L<M.length;L++){var H=M[L];I+=H.type===18&&H.name==="calc"?K(H.values):oo(H)?H.number:H.type===6||Mr(H)?H.value:""}return I+=")",I};if(re.type===18){var oe=re.values.filter(So);if(re.name==="calc"){var ae=K(oe).replace(/r|x/,ce[0].toString()).replace(/g|y/,ce[1].toString()).replace(/b|z/,ce[2].toString());return new Function("return "+ae)()}}return null},h=t[1].type===18?t[1].name:Mr(t[1])||t[1].type===5?"rgb":"unknown",f=Mr(t[2])?t[2].value:"unknown",g=t[1].type===18?t[1].values:Mr(t[1])?[t[1]]:[];if(Mr(t[1])){var m=Ri[t[1].value.toUpperCase()];if(typeof m>"u")throw new Error("Attempting to use unknown color in relative color 'from'");var y=Id(n,t[1].value),b=255&y,S=255&y>>8,F=255&y>>16,k=255&y>>24;g=[{type:17,number:k,flags:1},{type:17,number:F,flags:1},{type:17,number:S,flags:1},{type:17,number:b>1?b/255:b,flags:1}]}else if(t[1].type===5){var P=lx(t[1]),k=P[0],F=P[1],S=P[2],b=P[3];g=[{type:17,number:k,flags:1},{type:17,number:F,flags:1},{type:17,number:S,flags:1},{type:17,number:b>1?b/255:b,flags:1}]}if(g.length===0)throw new Error("Attempting to use unknown color in relative color 'from'");if(f==="unknown")throw new Error("Attempting to use unknown colorspace in relative color 'to'");var te=O6[h],$=D6[f],j=_y[f];if(typeof te>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(h,'" for color() function'));if(typeof $>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(f,'" for color() function'));var J=te(n,g),we=$(J),a=u(we,t[3]),A=u(we,t[4]),d=u(we,t[5]),c=t.length>6&&t[6].type===6&&t[6].value==="/"&&oo(t[7])?t[7].number:1;if(a===null||A===null||d===null)throw new Error("Invalid relative color in color() function");return j([a,A,d,c])}},_y={srgb:VP,"srgb-linear":D1,"display-p3":p6,"a98-rgb":b6,"prophoto-rgb":E6,xyz:yy,"xyz-d50":i6,"xyz-d65":yy,rec2020:P6},O6={rgb:JP,hsl:ZP,lab:e6,lch:t6,oklab:n6,oklch:r6},D6={srgb:a6,"srgb-linear":A6,"display-p3":f6,"a98-rgb":y6,"prophoto-rgb":S6,xyz:wy,"xyz-d50":s6,"xyz-d65":wy,rec2020:L6},N6={hsl:my,hsla:my,rgb:by,rgba:by,lch:YP,oklch:XP,oklab:WP,lab:GP,color:k6},Id=function(n,e){return pA.parse(n,G5.create(e).parseComponentValue())},Ri={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},M6={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(Mr(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},H6={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},mg=function(n,e){var t=pA.parse(n,e[0]),r=e[1];return r&&Cn(r)?{color:t,stop:r}:{color:t,stop:null}},By=function(n,e){var t=n[0],r=n[n.length-1];t.stop===null&&(t.stop=Co),r.stop===null&&(r.stop=dA);for(var o=[],s=0,i=0;i<n.length;i++){var a=n[i].stop;if(a!==null){var A=An(a,e);A>s?o.push(A):o.push(s),s=A}else o.push(null)}for(var d=null,i=0;i<o.length;i++){var c=o[i];if(c===null)d===null&&(d=i);else if(d!==null){for(var u=i-d,h=o[d-1],f=(c-h)/(u+1),g=1;g<=u;g++)o[d+g-1]=f*g;d=null}}return n.map(function(m,y){var b=m.color;return{color:b,stop:Math.max(Math.min(1,o[y]/e),0)}})},j6=function(n,e,t){var r=e/2,o=t/2,s=An(n[0],e)-r,i=o-An(n[1],t);return(Math.atan2(i,s)+Math.PI*2)%(Math.PI*2)},R6=function(n,e,t){var r=typeof n=="number"?n:j6(n,e,t),o=Math.abs(e*Math.sin(r))+Math.abs(t*Math.cos(r)),s=e/2,i=t/2,a=o/2,A=Math.sin(r-Math.PI/2)*a,d=Math.cos(r-Math.PI/2)*a;return[o,s-d,s+d,i-A,i+A]},li=function(n,e){return Math.sqrt(n*n+e*e)},xy=function(n,e,t,r,o){var s=[[0,0],[0,e],[n,0],[n,e]];return s.reduce(function(i,a){var A=a[0],d=a[1],c=li(t-A,r-d);return(o?c<i.optimumDistance:c>i.optimumDistance)?{optimumCorner:a,optimumDistance:c}:i},{optimumDistance:o?1/0:-1/0,optimumCorner:null}).optimumCorner},q6=function(n,e,t,r,o){var s=0,i=0;switch(n.size){case 0:n.shape===0?s=i=Math.min(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-o)):n.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-r)),i=Math.min(Math.abs(t),Math.abs(t-o)));break;case 2:if(n.shape===0)s=i=Math.min(li(e,t),li(e,t-o),li(e-r,t),li(e-r,t-o));else if(n.shape===1){var a=Math.min(Math.abs(t),Math.abs(t-o))/Math.min(Math.abs(e),Math.abs(e-r)),A=xy(r,o,e,t,!0),d=A[0],c=A[1];s=li(d-e,(c-t)/a),i=a*s}break;case 1:n.shape===0?s=i=Math.max(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-o)):n.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-r)),i=Math.max(Math.abs(t),Math.abs(t-o)));break;case 3:if(n.shape===0)s=i=Math.max(li(e,t),li(e,t-o),li(e-r,t),li(e-r,t-o));else if(n.shape===1){var a=Math.max(Math.abs(t),Math.abs(t-o))/Math.max(Math.abs(e),Math.abs(e-r)),u=xy(r,o,e,t,!1),d=u[0],c=u[1];s=li(d-e,(c-t)/a),i=a*s}break}return Array.isArray(n.size)&&(s=An(n.size[0],r),i=n.size.length===2?An(n.size[1],o):s),[s,i]},K6=function(n,e){var t=Xs(180),r=[];return Ji(e).forEach(function(o,s){if(s===0){var i=o[0];if(i.type===20&&i.value==="to"){t=rx(o);return}else if(tx(i)){t=hg.parse(n,i);return}}var a=mg(n,o);r.push(a)}),{angle:t,stops:r,type:1}},bf=function(n,e){var t=Xs(180),r=[];return Ji(e).forEach(function(o,s){if(s===0){var i=o[0];if(i.type===20&&["top","left","right","bottom"].indexOf(i.value)!==-1){t=rx(o);return}else if(tx(i)){t=(hg.parse(n,i)+Xs(270))%Xs(360);return}}var a=mg(n,o);r.push(a)}),{angle:t,stops:r,type:1}},$6=function(n,e){var t=Xs(180),r=[],o=1,s=0,i=3,a=[];return Ji(e).forEach(function(A,d){var c=A[0];if(d===0){if(Mr(c)&&c.value==="linear"){o=1;return}else if(Mr(c)&&c.value==="radial"){o=2;return}}if(c.type===18){if(c.name==="from"){var u=pA.parse(n,c.values[0]);r.push({stop:Co,color:u})}else if(c.name==="to"){var u=pA.parse(n,c.values[0]);r.push({stop:dA,color:u})}else if(c.name==="color-stop"){var h=c.values.filter(So);if(h.length===2){var u=pA.parse(n,h[1]),f=h[0];oo(f)&&r.push({stop:{type:16,number:f.number*100,flags:f.flags},color:u})}}}}),o===1?{angle:(t+Xs(180))%Xs(360),stops:r,type:o}:{size:i,shape:s,stops:r,position:a,type:o}},dx="closest-side",cx="farthest-side",ux="closest-corner",hx="farthest-corner",fx="circle",px="ellipse",gx="cover",vx="contain",V6=function(n,e){var t=0,r=3,o=[],s=[];return Ji(e).forEach(function(i,a){var A=!0;if(a===0){var d=!1;A=i.reduce(function(u,h){if(d)if(Mr(h))switch(h.value){case"center":return s.push(O1),u;case"top":case"left":return s.push(Co),u;case"right":case"bottom":return s.push(dA),u}else(Cn(h)||bA(h))&&s.push(h);else if(Mr(h))switch(h.value){case fx:return t=0,!1;case px:return t=1,!1;case"at":return d=!0,!1;case dx:return r=0,!1;case gx:case cx:return r=1,!1;case vx:case ux:return r=2,!1;case hx:return r=3,!1}else if(bA(h)||Cn(h))return Array.isArray(r)||(r=[]),r.push(h),!1;return u},A)}if(A){var c=mg(n,i);o.push(c)}}),{size:r,shape:t,stops:o,position:s,type:2}},_f=function(n,e){var t=0,r=3,o=[],s=[];return Ji(e).forEach(function(i,a){var A=!0;if(a===0?A=i.reduce(function(c,u){if(Mr(u))switch(u.value){case"center":return s.push(O1),!1;case"top":case"left":return s.push(Co),!1;case"right":case"bottom":return s.push(dA),!1}else if(Cn(u)||bA(u))return s.push(u),!1;return c},A):a===1&&(A=i.reduce(function(c,u){if(Mr(u))switch(u.value){case fx:return t=0,!1;case px:return t=1,!1;case vx:case dx:return r=0,!1;case cx:return r=1,!1;case ux:return r=2,!1;case gx:case hx:return r=3,!1}else if(bA(u)||Cn(u))return Array.isArray(r)||(r=[]),r.push(u),!1;return c},A)),A){var d=mg(n,i);o.push(d)}}),{size:r,shape:t,stops:o,position:s,type:2}},G6=function(n){return n.type===1},W6=function(n){return n.type===2},M1={name:"image",parse:function(n,e){if(e.type===22){var t={url:e.value,type:0};return n.cache.addImage(e.value),t}if(e.type===18){var r=mx[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported image function "'.concat(e.name,'"'));return r(n,e.values)}throw new Error("Unsupported image type ".concat(e.type))}};function X6(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!mx[n.name])}var mx={"linear-gradient":K6,"-moz-linear-gradient":bf,"-ms-linear-gradient":bf,"-o-linear-gradient":bf,"-webkit-linear-gradient":bf,"radial-gradient":V6,"-moz-radial-gradient":_f,"-ms-radial-gradient":_f,"-o-radial-gradient":_f,"-webkit-radial-gradient":_f,"-webkit-gradient":$6},Y6={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(r){return So(r)&&X6(r)}).map(function(r){return M1.parse(n,r)})}},J6={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(Mr(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},Z6={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,e){return Ji(e).map(function(t){return t.filter(Cn)}).map(X5)}},ek={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,e){return Ji(e).map(function(t){return t.filter(Mr).map(function(r){return r.value}).join(" ")}).map(tk)}},tk=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},Ud;(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})(Ud||(Ud={}));var rk={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,e){return Ji(e).map(function(t){return t.filter(nk)})}},nk=function(n){return Mr(n)||Cn(n)},wg=function(n){return{name:"border-".concat(n,"-color"),initialValue:"transparent",prefix:!1,type:3,format:"color"}},ok=wg("top"),sk=wg("right"),ik=wg("bottom"),ak=wg("left"),yg=function(n){return{name:"border-radius-".concat(n),initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return X5(t.filter(Cn))}}},Ak=yg("top-left"),lk=yg("top-right"),dk=yg("bottom-right"),ck=yg("bottom-left"),bg=function(n){return{name:"border-".concat(n,"-style"),initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},uk=bg("top"),hk=bg("right"),fk=bg("bottom"),pk=bg("left"),_g=function(n){return{name:"border-".concat(n,"-width"),initialValue:"0",type:0,prefix:!1,parse:function(e,t){return CA(t)?t.number:0}}},gk=_g("top"),vk=_g("right"),mk=_g("bottom"),wk=_g("left"),yk={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},bk={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},_k={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,e){return e.filter(Mr).reduce(function(t,r){return t|Bk(r.value)},0)}},Bk=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},xk={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},zk={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},Sp;(function(n){n.NORMAL="normal",n.STRICT="strict"})(Sp||(Sp={}));var Ck={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"strict":return Sp.STRICT;case"normal":default:return Sp.NORMAL}}},Sk={name:"line-height",initialValue:"normal",prefix:!1,type:4},zy=function(n,e){return Mr(n)&&n.value==="normal"?1.2*e:n.type===17?e*n.number:Cn(n)?An(n,e):e},Ek={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,e){return e.type===20&&e.value==="none"?null:M1.parse(n,e)}},Fk={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},Am={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Bg=function(n){return{name:"margin-".concat(n),initialValue:"0",prefix:!1,type:4}},Ik=Bg("top"),Uk=Bg("right"),Qk=Bg("bottom"),Tk=Bg("left"),Lk={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,e){return e.filter(Mr).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Pk={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},xg=function(n){return{name:"padding-".concat(n),initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},kk=xg("top"),Ok=xg("right"),Dk=xg("bottom"),Nk=xg("left"),Mk={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},Hk={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},jk={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&sm(e[0],"none")?[]:Ji(e).map(function(t){for(var r={color:Ri.TRANSPARENT,offsetX:Co,offsetY:Co,blur:Co},o=0,s=0;s<t.length;s++){var i=t[s];bA(i)?(o===0?r.offsetX=i:o===1?r.offsetY=i:r.blur=i,o++):r.color=pA.parse(n,i)}return r})}},Rk={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},qk={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=Vk[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'.concat(e.name,'"'));return t(e.values)}return null}},Kk=function(n){var e=n.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},$k=function(n){var e=n.filter(function(A){return A.type===17}).map(function(A){return A.number}),t=e[0],r=e[1];e[2],e[3];var o=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var i=e[12],a=e[13];return e[14],e[15],e.length===16?[t,r,o,s,i,a]:null},Vk={matrix:Kk,matrix3d:$k},Cy={type:16,number:50,flags:Vu},Gk=[Cy,Cy],Wk={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,e){var t=e.filter(Cn);return t.length!==2?Gk:[t[0],t[1]]}},Xk={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},du;(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(du||(du={}));var Yk={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-all":return du.BREAK_ALL;case"keep-all":return du.KEEP_ALL;case"normal":default:return du.NORMAL}}},Jk={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,e){if(e.type===20)return{auto:!0,order:0};if(oo(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},wx={name:"time",parse:function(n,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},Zk={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,e){return oo(e)?e.number:1}},eO={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},tO={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,e){return e.filter(Mr).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},rO={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,e){var t=[],r=[];return e.forEach(function(o){switch(o.type){case 20:case 0:t.push(o.value);break;case 17:t.push(o.number.toString());break;case 4:r.push(t.join(" ")),t.length=0;break}}),t.length&&r.push(t.join(" ")),r.map(function(o){return o.indexOf(" ")===-1?o:"'".concat(o,"'")})}},nO={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},oO={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,e){if(oo(e))return e.number;if(Mr(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},sO={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.filter(Mr).map(function(t){return t.value})}},iO={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},Ao=function(n,e){return(n&e)!==0},aO={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},AO={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var r=[],o=e.filter(W5),s=0;s<o.length;s++){var i=o[s],a=o[s+1];if(i.type===20){var A=a&&oo(a)?a.number:1;r.push({counter:i.value,increment:A})}}return r}},lO={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return[];for(var t=[],r=e.filter(W5),o=0;o<r.length;o++){var s=r[o],i=r[o+1];if(Mr(s)&&s.value!=="none"){var a=i&&oo(i)?i.number:0;t.push({counter:s.value,reset:a})}}return t}},dO={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,e){return e.filter(CA).map(function(t){return wx.parse(n,t)})}},cO={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var r=[],o=e.filter(KP);if(o.length%2!==0)return null;for(var s=0;s<o.length;s+=2){var i=o[s].value,a=o[s+1].value;r.push({open:i,close:a})}return r}},Sy=function(n,e,t){if(!n)return"";var r=n[Math.min(e,n.length-1)];return r?t?r.open:r.close:""},uO={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&sm(e[0],"none")?[]:Ji(e).map(function(t){for(var r={color:255,offsetX:Co,offsetY:Co,blur:Co,spread:Co,inset:!1},o=0,s=0;s<t.length;s++){var i=t[s];sm(i,"inset")?r.inset=!0:bA(i)?(o===0?r.offsetX=i:o===1?r.offsetY=i:o===2?r.blur=i:r.spread=i,o++):r.color=pA.parse(n,i)}return r})}},hO={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,e){var t=[0,1,2],r=[];return e.filter(Mr).forEach(function(o){switch(o.value){case"stroke":r.push(1);break;case"fill":r.push(0);break;case"markers":r.push(2);break}}),t.forEach(function(o){r.indexOf(o)===-1&&r.push(o)}),r}},fO={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},pO={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,e){return CA(e)?e.number:0}},gO={name:"objectFit",initialValue:"fill",prefix:!1,type:1,parse:function(n,e){return e.filter(Mr).reduce(function(t,r){return t|vO(r.value)},0)}},vO=function(n){switch(n){case"contain":return 2;case"cover":return 4;case"none":return 8;case"scale-down":return 16}return 0},mO=function(){function n(e,t){var r,o;this.animationDuration=Yt(e,dO,t.animationDuration),this.backgroundClip=Yt(e,M6,t.backgroundClip),this.backgroundColor=Yt(e,H6,t.backgroundColor),this.backgroundImage=Yt(e,Y6,t.backgroundImage),this.backgroundOrigin=Yt(e,J6,t.backgroundOrigin),this.backgroundPosition=Yt(e,Z6,t.backgroundPosition),this.backgroundRepeat=Yt(e,ek,t.backgroundRepeat),this.backgroundSize=Yt(e,rk,t.backgroundSize),this.borderTopColor=Yt(e,ok,t.borderTopColor),this.borderRightColor=Yt(e,sk,t.borderRightColor),this.borderBottomColor=Yt(e,ik,t.borderBottomColor),this.borderLeftColor=Yt(e,ak,t.borderLeftColor),this.borderTopLeftRadius=Yt(e,Ak,t.borderTopLeftRadius),this.borderTopRightRadius=Yt(e,lk,t.borderTopRightRadius),this.borderBottomRightRadius=Yt(e,dk,t.borderBottomRightRadius),this.borderBottomLeftRadius=Yt(e,ck,t.borderBottomLeftRadius),this.borderTopStyle=Yt(e,uk,t.borderTopStyle),this.borderRightStyle=Yt(e,hk,t.borderRightStyle),this.borderBottomStyle=Yt(e,fk,t.borderBottomStyle),this.borderLeftStyle=Yt(e,pk,t.borderLeftStyle),this.borderTopWidth=Yt(e,gk,t.borderTopWidth),this.borderRightWidth=Yt(e,vk,t.borderRightWidth),this.borderBottomWidth=Yt(e,mk,t.borderBottomWidth),this.borderLeftWidth=Yt(e,wk,t.borderLeftWidth),this.boxShadow=Yt(e,uO,t.boxShadow),this.color=Yt(e,yk,t.color),this.direction=Yt(e,bk,t.direction),this.display=Yt(e,_k,t.display),this.float=Yt(e,xk,t.cssFloat),this.fontFamily=Yt(e,rO,t.fontFamily),this.fontSize=Yt(e,nO,t.fontSize),this.fontStyle=Yt(e,iO,t.fontStyle),this.fontVariant=Yt(e,sO,t.fontVariant),this.fontWeight=Yt(e,oO,t.fontWeight),this.letterSpacing=Yt(e,zk,t.letterSpacing),this.lineBreak=Yt(e,Ck,t.lineBreak),this.lineHeight=Yt(e,Sk,t.lineHeight),this.listStyleImage=Yt(e,Ek,t.listStyleImage),this.listStylePosition=Yt(e,Fk,t.listStylePosition),this.listStyleType=Yt(e,Am,t.listStyleType),this.marginTop=Yt(e,Ik,t.marginTop),this.marginRight=Yt(e,Uk,t.marginRight),this.marginBottom=Yt(e,Qk,t.marginBottom),this.marginLeft=Yt(e,Tk,t.marginLeft),this.opacity=Yt(e,Zk,t.opacity);var s=Yt(e,Lk,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=Yt(e,Pk,t.overflowWrap),this.paddingTop=Yt(e,kk,t.paddingTop),this.paddingRight=Yt(e,Ok,t.paddingRight),this.paddingBottom=Yt(e,Dk,t.paddingBottom),this.paddingLeft=Yt(e,Nk,t.paddingLeft),this.paintOrder=Yt(e,hO,t.paintOrder),this.position=Yt(e,Hk,t.position),this.textAlign=Yt(e,Mk,t.textAlign),this.textDecorationColor=Yt(e,eO,(r=t.textDecorationColor)!==null&&r!==void 0?r:t.color),this.textDecorationLine=Yt(e,tO,(o=t.textDecorationLine)!==null&&o!==void 0?o:t.textDecoration),this.textShadow=Yt(e,jk,t.textShadow),this.textTransform=Yt(e,Rk,t.textTransform),this.transform=Yt(e,qk,t.transform),this.transformOrigin=Yt(e,Wk,t.transformOrigin),this.visibility=Yt(e,Xk,t.visibility),this.webkitTextStrokeColor=Yt(e,fO,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=Yt(e,pO,t.webkitTextStrokeWidth),this.wordBreak=Yt(e,Yk,t.wordBreak),this.zIndex=Yt(e,Jk,t.zIndex),this.objectFit=Yt(e,gO,t.objectFit)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return fA(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return Ao(this.display,4)||Ao(this.display,33554432)||Ao(this.display,268435456)||Ao(this.display,536870912)||Ao(this.display,67108864)||Ao(this.display,134217728)},n}(),wO=function(){function n(e,t){this.content=Yt(e,aO,t.content),this.quotes=Yt(e,cO,t.quotes)}return n}(),Ey=function(){function n(e,t){this.counterIncrement=Yt(e,AO,t.counterIncrement),this.counterReset=Yt(e,lO,t.counterReset)}return n}(),Yt=function(n,e,t){var r=new V5,o=t!==null&&typeof t<"u"?t.toString():e.initialValue;r.write(o);var s=new G5(r.read());switch(e.type){case 2:var i=s.parseComponentValue();return e.parse(n,Mr(i)?i.value:e.initialValue);case 0:return e.parse(n,s.parseComponentValue());case 1:return e.parse(n,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return hg.parse(n,s.parseComponentValue());case"color":return pA.parse(n,s.parseComponentValue());case"image":return M1.parse(n,s.parseComponentValue());case"length":var a=s.parseComponentValue();return bA(a)?a:Co;case"length-percentage":var A=s.parseComponentValue();return Cn(A)?A:Co;case"time":return wx.parse(n,s.parseComponentValue())}break}},yO="data-html2canvas-debug",bO=function(n){var e=n.getAttribute(yO);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},lm=function(n,e){var t=bO(n);return t===1||e===t},Zi=function(){function n(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,lm(t,3))debugger;this.styles=new mO(e,window.getComputedStyle(t,null)),um(t)&&(this.styles.animationDuration.some(function(r){return r>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=cg(this.context,t),lm(t,4)&&(this.flags|=16)}return n}(),_O="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Fy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Zc=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Bf=0;Bf<Fy.length;Bf++)Zc[Fy.charCodeAt(Bf)]=Bf;var BO=function(n){var e=n.length*.75,t=n.length,r,o=0,s,i,a,A;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),c=Array.isArray(d)?d:new Uint8Array(d);for(r=0;r<t;r+=4)s=Zc[n.charCodeAt(r)],i=Zc[n.charCodeAt(r+1)],a=Zc[n.charCodeAt(r+2)],A=Zc[n.charCodeAt(r+3)],c[o++]=s<<2|i>>4,c[o++]=(i&15)<<4|a>>2,c[o++]=(a&3)<<6|A&63;return d},xO=function(n){for(var e=n.length,t=[],r=0;r<e;r+=2)t.push(n[r+1]<<8|n[r]);return t},zO=function(n){for(var e=n.length,t=[],r=0;r<e;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},Al=5,H1=11,Pv=2,CO=H1-Al,yx=65536>>Al,SO=1<<Al,kv=SO-1,EO=1024>>Al,FO=yx+EO,IO=FO,UO=32,QO=IO+UO,TO=65536>>H1,LO=1<<CO,PO=LO-1,Iy=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},kO=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},OO=function(n,e){var t=BO(n),r=Array.isArray(t)?zO(t):new Uint32Array(t),o=Array.isArray(t)?xO(t):new Uint16Array(t),s=24,i=Iy(o,s/2,r[4]/2),a=r[5]===2?Iy(o,(s+r[4])/2):kO(r,Math.ceil((s+r[4])/4));return new DO(r[0],r[1],r[2],r[3],i,a)},DO=function(){function n(e,t,r,o,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=o,this.index=s,this.data=i}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Al],t=(t<<Pv)+(e&kv),this.data[t];if(e<=65535)return t=this.index[yx+(e-55296>>Al)],t=(t<<Pv)+(e&kv),this.data[t];if(e<this.highStart)return t=QO-TO+(e>>H1),t=this.index[t],t+=e>>Al&PO,t=this.index[t],t=(t<<Pv)+(e&kv),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),Uy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",NO=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var xf=0;xf<Uy.length;xf++)NO[Uy.charCodeAt(xf)]=xf;var MO=1,Ov=2,Dv=3,Qy=4,Ty=5,HO=7,Ly=8,Nv=9,Mv=10,Py=11,ky=12,Oy=13,Dy=14,Hv=15,jO=function(n){for(var e=[],t=0,r=n.length;t<r;){var o=n.charCodeAt(t++);if(o>=55296&&o<=56319&&t<r){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),t--)}else e.push(o)}return e},RO=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],o=-1,s="";++o<t;){var i=n[o];i<=65535?r.push(i):(i-=65536,r.push((i>>10)+55296,i%1024+56320)),(o+1===t||r.length>16384)&&(s+=String.fromCharCode.apply(String,r),r.length=0)}return s},qO=OO(_O),Vs="",jv="",KO=function(n){return qO.get(n)},$O=function(n,e,t){var r=t-2,o=e[r],s=e[t-1],i=e[t];if(s===Ov&&i===Dv)return Vs;if(s===Ov||s===Dv||s===Qy||i===Ov||i===Dv||i===Qy)return jv;if(s===Ly&&[Ly,Nv,Py,ky].indexOf(i)!==-1||(s===Py||s===Nv)&&(i===Nv||i===Mv)||(s===ky||s===Mv)&&i===Mv||i===Oy||i===Ty||i===HO||s===MO)return Vs;if(s===Oy&&i===Dy){for(;o===Ty;)o=e[--r];if(o===Dy)return Vs}if(s===Hv&&i===Hv){for(var a=0;o===Hv;)a++,o=e[--r];if(a%2===0)return Vs}return jv},VO=function(n){var e=jO(n),t=e.length,r=0,o=0,s=e.map(KO);return{next:function(){if(r>=t)return{done:!0,value:null};for(var i=Vs;r<t&&(i=$O(e,s,++r))===Vs;);if(i!==Vs||r===t){var a=RO.apply(null,e.slice(o,r));return o=r,{value:a,done:!1}}return{done:!0,value:null}}}},GO=function(n){for(var e=VO(n),t=[],r;!(r=e.next()).done;)r.value&&t.push(r.value.slice());return t},WO=function(n){var e=123;if(n.createRange){var t=n.createRange();if(t.getBoundingClientRect){var r=n.createElement("boundtest");r.style.height="".concat(e,"px"),r.style.display="block",n.body.appendChild(r),t.selectNode(r);var o=t.getBoundingClientRect(),s=Math.round(o.height);if(n.body.removeChild(r),s===e)return!0}}return!1},XO=function(n){var e=n.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",n.body.appendChild(e);var t=n.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var r=e.firstChild,o=ug(r.data).map(function(A){return Vn(A)}),s=0,i={},a=o.every(function(A,d){t.setStart(r,s),t.setEnd(r,s+A.length);var c=t.getBoundingClientRect();s+=A.length;var u=c.x>i.x||c.y>i.y;return i=c,d===0?!0:u});return n.body.removeChild(e),a},YO=function(){return typeof new Image().crossOrigin<"u"},JO=function(){return typeof new XMLHttpRequest().responseType=="string"},ZO=function(n){var e=new Image,t=n.createElement("canvas"),r=t.getContext("2d");if(!r)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},Ny=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},e8=function(n){var e=n.createElement("canvas"),t=100;e.width=t,e.height=t;var r=e.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,t,t);var o=new Image,s=e.toDataURL();o.src=s;var i=dm(t,t,0,0,o);return r.fillStyle="red",r.fillRect(0,0,t,t),My(i).then(function(a){r.drawImage(a,0,0);var A=r.getImageData(0,0,t,t).data;r.fillStyle="red",r.fillRect(0,0,t,t);var d=n.createElement("div");return d.style.backgroundImage="url(".concat(s,")"),d.style.height="".concat(t,"px"),Ny(A)?My(dm(t,t,0,0,d)):Promise.reject(!1)}).then(function(a){return r.drawImage(a,0,0),Ny(r.getImageData(0,0,t,t).data)}).catch(function(){return!1})},dm=function(n,e,t,r,o){var s="http://www.w3.org/2000/svg",i=document.createElementNS(s,"svg"),a=document.createElementNS(s,"foreignObject");return i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",t.toString()),a.setAttributeNS(null,"y",r.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),i.appendChild(a),a.appendChild(o),i},My=function(n){return new Promise(function(e,t){var r=new Image;r.onload=function(){return e(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(n)))})},xo={get SUPPORT_RANGE_BOUNDS(){var n=WO(document);return Object.defineProperty(xo,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=xo.SUPPORT_RANGE_BOUNDS&&XO(document);return Object.defineProperty(xo,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=ZO(document);return Object.defineProperty(xo,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?e8(document):Promise.resolve(!1);return Object.defineProperty(xo,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=YO();return Object.defineProperty(xo,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=JO();return Object.defineProperty(xo,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(xo,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(xo,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},cu=function(){function n(e,t){this.text=e,this.bounds=t}return n}(),t8=function(n,e,t,r){var o=o8(e,t),s=[],i=0;return o.forEach(function(a){if(t.textDecorationLine.length||a.trim().length>0)if(xo.SUPPORT_RANGE_BOUNDS){var A=Hy(r,i,a.length).getClientRects();if(A.length>1){var d=j1(a),c=0;d.forEach(function(h){s.push(new cu(h,Fa.fromDOMRectList(n,Hy(r,c+i,h.length).getClientRects()))),c+=h.length})}else s.push(new cu(a,Fa.fromDOMRectList(n,A)))}else{var u=r.splitText(a.length);s.push(new cu(a,r8(n,r))),r=u}else xo.SUPPORT_RANGE_BOUNDS||(r=r.splitText(a.length));i+=a.length}),s},r8=function(n,e){var t=e.ownerDocument;if(t){var r=t.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var o=e.parentNode;if(o){o.replaceChild(r,e);var s=cg(n,r);return r.firstChild&&o.replaceChild(r.firstChild,r),s}}return Fa.EMPTY},Hy=function(n,e,t){var r=n.ownerDocument;if(!r)throw new Error("Node has no owner document");var o=r.createRange();return o.setStart(n,e),o.setEnd(n,e+t),o},j1=function(n){if(xo.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(n)).map(function(t){return t.segment})}return GO(n)},n8=function(n,e){if(xo.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(n)).map(function(r){return r.segment})}return i8(n,e)},o8=function(n,e){return e.letterSpacing!==0?j1(n):n8(n,e)},s8=[32,160,4961,65792,65793,4153,4241],i8=function(n,e){for(var t=NL(n,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),r=[],o,s=function(){if(o.value){var i=o.value.slice(),a=ug(i),A="";a.forEach(function(d){s8.indexOf(d)===-1?A+=Vn(d):(A.length&&r.push(A),r.push(Vn(d)),A="")}),A.length&&r.push(A)}};!(o=t.next()).done;)s();return r},a8=function(){function n(e,t,r){this.text=A8(t.data,r.textTransform),this.textBounds=t8(e,this.text,r,t)}return n}(),A8=function(n,e){switch(e){case 1:return n.toLowerCase();case 3:return n.replace(l8,d8);case 2:return n.toUpperCase();default:return n}},l8=/(^|\s|:|-|\(|\))([a-z])/g,d8=function(n,e,t){return n.length>0?e+t.toUpperCase():n},bx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.src=r.currentSrc||r.src,o.intrinsicWidth=r.naturalWidth,o.intrinsicHeight=r.naturalHeight,o.context.cache.addImage(o.src),o}return e}(Zi),_x=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.canvas=r,o.intrinsicWidth=r.width,o.intrinsicHeight=r.height,o}return e}(Zi),Bx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this,s=new XMLSerializer,i=cg(t,r);return r.setAttribute("width","".concat(i.width,"px")),r.setAttribute("height","".concat(i.height,"px")),o.svg="data:image/svg+xml,".concat(encodeURIComponent(s.serializeToString(r))),o.intrinsicWidth=r.width.baseVal.value,o.intrinsicHeight=r.height.baseVal.value,o.context.cache.addImage(o.svg),o}return e}(Zi),xx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.value=r.value,o}return e}(Zi),cm=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.start=r.start,o.reversed=typeof r.reversed=="boolean"&&r.reversed===!0,o}return e}(Zi),c8=[{type:15,flags:0,unit:"px",number:3}],u8=[{type:16,flags:0,number:50}],h8=function(n){return n.width>n.height?new Fa(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new Fa(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},f8=function(n){var e=n.type===p8?new Array(n.value.length+1).join(""):n.value;return e.length===0?n.placeholder||"":e},Ep="checkbox",Fp="radio",p8="password",jy=707406591,R1=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;switch(o.type=r.type.toLowerCase(),o.checked=r.checked,o.value=f8(r),(o.type===Ep||o.type===Fp)&&(o.styles.backgroundColor=3739148031,o.styles.borderTopColor=o.styles.borderRightColor=o.styles.borderBottomColor=o.styles.borderLeftColor=2779096575,o.styles.borderTopWidth=o.styles.borderRightWidth=o.styles.borderBottomWidth=o.styles.borderLeftWidth=1,o.styles.borderTopStyle=o.styles.borderRightStyle=o.styles.borderBottomStyle=o.styles.borderLeftStyle=1,o.styles.backgroundClip=[0],o.styles.backgroundOrigin=[0],o.bounds=h8(o.bounds)),o.type){case Ep:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=c8;break;case Fp:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=u8;break}return o}return e}(Zi),zx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this,s=r.options[r.selectedIndex||0];return o.value=s&&s.text||"",o}return e}(Zi),Cx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.value=r.value,o}return e}(Zi),Sx=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;o.src=r.src,o.width=parseInt(r.width,10)||0,o.height=parseInt(r.height,10)||0,o.backgroundColor=o.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){o.tree=Fx(t,r.contentWindow.document.documentElement);var s=r.contentWindow.document.documentElement?Id(t,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):Ri.TRANSPARENT,i=r.contentWindow.document.body?Id(t,getComputedStyle(r.contentWindow.document.body).backgroundColor):Ri.TRANSPARENT;o.backgroundColor=fA(s)?fA(i)?o.styles.backgroundColor:i:s}}catch{}return o}return e}(Zi),g8=["OL","UL","MENU"],Kf=function(n,e,t,r){for(var o=e.firstChild,s=void 0;o;o=s)if(s=o.nextSibling,Ix(o)&&o.data.length>0)t.textNodes.push(new a8(n,o,t.styles));else if(wd(o))if(Lx(o)&&o.assignedNodes)o.assignedNodes().forEach(function(a){return Kf(n,a,t,r)});else{var i=Ex(n,o);i.styles.isVisible()&&(v8(o,i,r)?i.flags|=4:m8(i.styles)&&(i.flags|=2),g8.indexOf(o.tagName)!==-1&&(i.flags|=8),t.elements.push(i),o.slot,o.shadowRoot?Kf(n,o.shadowRoot,i,r):!Ip(o)&&!Ux(o)&&!Up(o)&&Kf(n,o,i,r))}},Ex=function(n,e){return hm(e)?new bx(n,e):Qx(e)?new _x(n,e):Ux(e)?new Bx(n,e):w8(e)?new xx(n,e):y8(e)?new cm(n,e):b8(e)?new R1(n,e):Up(e)?new zx(n,e):Ip(e)?new Cx(n,e):Tx(e)?new Sx(n,e):new Zi(n,e)},Fx=function(n,e){var t=Ex(n,e);return t.flags|=4,Kf(n,e,t,t),t},v8=function(n,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||q1(n)&&t.styles.isTransparent()},m8=function(n){return n.isPositioned()||n.isFloating()},Ix=function(n){return n.nodeType===Node.TEXT_NODE},wd=function(n){return n.nodeType===Node.ELEMENT_NODE},um=function(n){return wd(n)&&typeof n.style<"u"&&!$f(n)},$f=function(n){return typeof n.className=="object"},w8=function(n){return n.tagName==="LI"},y8=function(n){return n.tagName==="OL"},b8=function(n){return n.tagName==="INPUT"},_8=function(n){return n.tagName==="HTML"},Ux=function(n){return n.tagName==="svg"},q1=function(n){return n.tagName==="BODY"},Qx=function(n){return n.tagName==="CANVAS"},Ry=function(n){return n.tagName==="VIDEO"},hm=function(n){return n.tagName==="IMG"},Tx=function(n){return n.tagName==="IFRAME"},qy=function(n){return n.tagName==="STYLE"},B8=function(n){return n.tagName==="SCRIPT"},Ip=function(n){return n.tagName==="TEXTAREA"},Up=function(n){return n.tagName==="SELECT"},Lx=function(n){return n.tagName==="SLOT"},Ky=function(n){return n.tagName.indexOf("-")>0},x8=function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},n.prototype.pop=function(e){var t=this;e.forEach(function(r){return t.counters[r].pop()})},n.prototype.parse=function(e){var t=this,r=e.counterIncrement,o=e.counterReset,s=!0;r!==null&&r.forEach(function(a){var A=t.counters[a.counter];A&&a.increment!==0&&(s=!1,A.length||A.push(1),A[Math.max(0,A.length-1)]+=a.increment)});var i=[];return s&&o.forEach(function(a){var A=t.counters[a.counter];i.push(a.counter),A||(A=t.counters[a.counter]=[]),A.push(a.reset)}),i},n}(),$y={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},Vy={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},z8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},C8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},od=function(n,e,t,r,o,s){return n<e||n>t?Qu(n,o,s.length>0):r.integers.reduce(function(i,a,A){for(;n>=a;)n-=a,i+=r.values[A];return i},"")+s},Px=function(n,e,t,r){var o="";do t||n--,o=r(n)+o,n/=e;while(n*e>=e);return o},Kn=function(n,e,t,r,o){var s=t-e+1;return(n<0?"-":"")+(Px(Math.abs(n),s,r,function(i){return Vn(Math.floor(i%s)+e)})+o)},MA=function(n,e,t){t===void 0&&(t=". ");var r=e.length;return Px(Math.abs(n),r,!1,function(o){return e[Math.floor(o%r)]})+t},cd=1,tA=2,rA=4,eu=8,da=function(n,e,t,r,o,s){if(n<-9999||n>9999)return Qu(n,4,o.length>0);var i=Math.abs(n),a=o;if(i===0)return e[0]+a;for(var A=0;i>0&&A<=4;A++){var d=i%10;d===0&&Ao(s,cd)&&a!==""?a=e[d]+a:d>1||d===1&&A===0||d===1&&A===1&&Ao(s,tA)||d===1&&A===1&&Ao(s,rA)&&n>100||d===1&&A>1&&Ao(s,eu)?a=e[d]+(A>0?t[A-1]:"")+a:d===1&&A>0&&(a=t[A-1]+a),i=Math.floor(i/10)}return(n<0?r:"")+a},Gy="",Wy="",Xy="",Rv="",Qu=function(n,e,t){var r=t?". ":"",o=t?"":"",s=t?", ":"",i=t?" ":"";switch(e){case 0:return""+i;case 1:return""+i;case 2:return""+i;case 5:var a=Kn(n,48,57,!0,r);return a.length<4?"0".concat(a):a;case 4:return MA(n,"",o);case 6:return od(n,1,3999,$y,3,r).toLowerCase();case 7:return od(n,1,3999,$y,3,r);case 8:return Kn(n,945,969,!1,r);case 9:return Kn(n,97,122,!1,r);case 10:return Kn(n,65,90,!1,r);case 11:return Kn(n,1632,1641,!0,r);case 12:case 49:return od(n,1,9999,Vy,3,r);case 35:return od(n,1,9999,Vy,3,r).toLowerCase();case 13:return Kn(n,2534,2543,!0,r);case 14:case 30:return Kn(n,6112,6121,!0,r);case 15:return MA(n,"",o);case 16:return MA(n,"",o);case 17:case 48:return da(n,"",Gy,"",o,tA|rA|eu);case 47:return da(n,"",Wy,"",o,cd|tA|rA|eu);case 42:return da(n,"",Gy,"",o,tA|rA|eu);case 41:return da(n,"",Wy,"",o,cd|tA|rA|eu);case 26:return da(n,"","",Xy,o,0);case 25:return da(n,"","",Xy,o,cd|tA|rA);case 31:return da(n,"","",Rv,s,cd|tA|rA);case 33:return da(n,"","",Rv,s,0);case 32:return da(n,"","",Rv,s,cd|tA|rA);case 18:return Kn(n,2406,2415,!0,r);case 20:return od(n,1,19999,C8,3,r);case 21:return Kn(n,2790,2799,!0,r);case 22:return Kn(n,2662,2671,!0,r);case 22:return od(n,1,10999,z8,3,r);case 23:return MA(n,"");case 24:return MA(n,"");case 27:return Kn(n,3302,3311,!0,r);case 28:return MA(n,"",o);case 29:return MA(n,"",o);case 34:return Kn(n,3792,3801,!0,r);case 37:return Kn(n,6160,6169,!0,r);case 38:return Kn(n,4160,4169,!0,r);case 39:return Kn(n,2918,2927,!0,r);case 40:return Kn(n,1776,1785,!0,r);case 43:return Kn(n,3046,3055,!0,r);case 44:return Kn(n,3174,3183,!0,r);case 45:return Kn(n,3664,3673,!0,r);case 46:return Kn(n,3872,3881,!0,r);case 3:default:return Kn(n,48,57,!0,r)}},kx="data-html2canvas-ignore",Yy=function(){function n(e,t,r){if(this.context=e,this.options=r,this.scrolledElements=[],this.referenceElement=t,this.counters=new x8,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(e,t){var r=this,o=S8(e,t);if(!o.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,i=e.defaultView.pageYOffset,a=o.contentWindow,A=a.document,d=I8(o).then(function(){return Xo(r,void 0,void 0,function(){var u,h;return No(this,function(f){switch(f.label){case 0:return this.scrolledElements.forEach(L8),a&&(a.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(a.scrollY!==t.top||a.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-t.left,a.scrollY-t.top,0,0))),u=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the ".concat(this.referenceElement.nodeName," in the cloned document"))]:A.fonts&&A.fonts.ready?[4,A.fonts.ready]:[3,2];case 1:f.sent(),f.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,F8(A)]:[3,4];case 3:f.sent(),f.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(A,h)}).then(function(){return o})]:[2,o]}})})}),c=A.adoptNode(this.documentElement);return N8(c,A),A.open(),A.write("".concat(Q8(document.doctype),"<html></html>")),T8(this.referenceElement.ownerDocument,s,i),A.replaceChild(c,A.documentElement),A.close(),d},n.prototype.createElementClone=function(e){if(lm(e,2))debugger;if(Qx(e))return this.createCanvasClone(e);if(Ry(e))return this.createVideoClone(e);if(qy(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return hm(t)&&(hm(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),Ky(t)?this.createCustomElementClone(t):t},n.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return qv(e.style,t),t},n.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var r=[].slice.call(t.cssRules,0).reduce(function(s,i){return i&&typeof i.cssText=="string"?s+i.cssText:s},""),o=e.cloneNode(!1);return o.textContent=r,o}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},n.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var r=e.ownerDocument.createElement("img");try{return r.src=e.toDataURL(),r}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var o=e.cloneNode(!1);try{o.width=e.width,o.height=e.height;var s=e.getContext("2d"),i=o.getContext("2d",{willReadFrequently:!0});if(i)if(!this.options.allowTaint&&s)i.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var a=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(a){var A=a.getContextAttributes();(A==null?void 0:A.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}i.drawImage(e,0,0)}return o}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return o},n.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var r=t.getContext("2d");try{return r&&(r.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||r.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var o=e.ownerDocument.createElement("canvas");return o.width=e.offsetWidth,o.height=e.offsetHeight,o},n.prototype.appendChildNode=function(e,t,r){(!wd(t)||!B8(t)&&!t.hasAttribute(kx)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!wd(t)||!qy(t))&&e.appendChild(this.cloneNode(t,r))},n.prototype.cloneChildNodes=function(e,t,r){for(var o=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(wd(s)&&Lx(s)&&typeof s.assignedNodes=="function"){var i=s.assignedNodes();i.length&&i.forEach(function(a){return o.appendChildNode(t,a,r)})}else this.appendChildNode(t,s,r)},n.prototype.cloneNode=function(e,t){if(Ix(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var r=e.ownerDocument.defaultView;if(r&&wd(e)&&(um(e)||$f(e))){var o=this.createElementClone(e);o.style.transitionProperty="none";var s=r.getComputedStyle(e),i=r.getComputedStyle(e,":before"),a=r.getComputedStyle(e,":after");this.referenceElement===e&&um(o)&&(this.clonedReferenceElement=o),q1(o)&&O8(o);var A=this.counters.parse(new Ey(this.context,s)),d=this.resolvePseudoContent(e,o,i,uu.BEFORE);Ky(e)&&(t=!0),Ry(e)||this.cloneChildNodes(e,o,t),d&&o.insertBefore(d,o.firstChild);var c=this.resolvePseudoContent(e,o,a,uu.AFTER);return c&&o.appendChild(c),this.counters.pop(A),(s&&(this.options.copyStyles||$f(e))&&!Tx(e)||t)&&qv(s,o),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([o,e.scrollLeft,e.scrollTop]),(Ip(e)||Up(e))&&(Ip(o)||Up(o))&&(o.value=e.value),o}return e.cloneNode(!1)},n.prototype.resolvePseudoContent=function(e,t,r,o){var s=this;if(r){var i=r.content,a=t.ownerDocument;if(!(!a||!i||i==="none"||i==="-moz-alt-content"||r.display==="none")){this.counters.parse(new Ey(this.context,r));var A=new wO(this.context,r),d=a.createElement("html2canvaspseudoelement");qv(r,d),A.content.forEach(function(u){if(u.type===0)d.appendChild(a.createTextNode(u.value));else if(u.type===22){var h=a.createElement("img");h.src=u.value,h.style.opacity="1",d.appendChild(h)}else if(u.type===18){if(u.name==="attr"){var f=u.values.filter(Mr);f.length&&d.appendChild(a.createTextNode(e.getAttribute(f[0].value)||""))}else if(u.name==="counter"){var g=u.values.filter(So),m=g[0],y=g[1];if(m&&Mr(m)){var b=s.counters.getCounterValue(m.value),S=y&&Mr(y)?Am.parse(s.context,y.value):3;d.appendChild(a.createTextNode(Qu(b,S,!1)))}}else if(u.name==="counters"){var F=u.values.filter(So),m=F[0],k=F[1],y=F[2];if(m&&Mr(m)){var P=s.counters.getCounterValues(m.value),te=y&&Mr(y)?Am.parse(s.context,y.value):3,$=k&&k.type===0?k.value:"",j=P.map(function(D){return Qu(D,te,!1)}).join($);d.appendChild(a.createTextNode(j))}}}else if(u.type===20)switch(u.value){case"open-quote":d.appendChild(a.createTextNode(Sy(A.quotes,s.quoteDepth++,!0)));break;case"close-quote":d.appendChild(a.createTextNode(Sy(A.quotes,--s.quoteDepth,!1)));break;default:d.appendChild(a.createTextNode(u.value))}}),d.className="".concat(fm," ").concat(pm);var c=o===uu.BEFORE?" ".concat(fm):" ".concat(pm);return $f(t)?t.className.baseValue+=c:t.className+=c,d}}},n.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},n}(),uu;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(uu||(uu={}));var S8=function(n,e){var t=n.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(kx,"true"),n.body.appendChild(t),t},E8=function(n){return new Promise(function(e){if(n.complete){e();return}if(!n.src){e();return}n.onload=e,n.onerror=e})},F8=function(n){return Promise.all([].slice.call(n.images,0).map(E8))},I8=function(n){return new Promise(function(e,t){var r=n.contentWindow;if(!r)return t("No window assigned for iframe");var o=r.document;r.onload=n.onload=function(){r.onload=n.onload=null;var s=setInterval(function(){o.body.childNodes.length>0&&o.readyState==="complete"&&(clearInterval(s),e(n))},50)}})},U8=["all","d","content"],qv=function(n,e){for(var t=n.length-1;t>=0;t--){var r=n.item(t);U8.indexOf(r)===-1&&e.style.setProperty(r,n.getPropertyValue(r))}return e},Q8=function(n){var e="";return n&&(e+="<!DOCTYPE ",n.name&&(e+=n.name),n.internalSubset&&(e+=n.internalSubset),n.publicId&&(e+='"'.concat(n.publicId,'"')),n.systemId&&(e+='"'.concat(n.systemId,'"')),e+=">"),e},T8=function(n,e,t){n&&n.defaultView&&(e!==n.defaultView.pageXOffset||t!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(e,t)},L8=function(n){var e=n[0],t=n[1],r=n[2];e.scrollLeft=t,e.scrollTop=r},P8=":before",k8=":after",fm="___html2canvas___pseudoelement_before",pm="___html2canvas___pseudoelement_after",Jy=`{
    content: "" !important;
    display: none !important;
}`,O8=function(n){D8(n,".".concat(fm).concat(P8).concat(Jy,`
         .`).concat(pm).concat(k8).concat(Jy))},D8=function(n,e){var t=n.ownerDocument;if(t){var r=t.createElement("style");r.textContent=e,n.appendChild(r)}},N8=function(n,e){var t,r=e.createElement("base");r.href=e.baseURI;var o=n.getElementsByTagName("head").item(0);o==null||o.insertBefore(r,(t=o==null?void 0:o.firstChild)!==null&&t!==void 0?t:null)},Ox=function(){function n(){}return n.getOrigin=function(e){var t=n._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},n.isSameOrigin=function(e){return n.getOrigin(e)===n._origin},n.setContext=function(e){n._link=e.document.createElement("a"),n._origin=n.getOrigin(e.location.href)},n._origin="about:blank",n}(),M8=function(){function n(e,t){this.context=e,this._options=t,this._cache={}}return n.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||($v(e)||q8(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},n.prototype.match=function(e){return this._cache[e]},n.prototype.loadImage=function(e){return Xo(this,void 0,void 0,function(){var t,r,o,s,i=this;return No(this,function(a){switch(a.label){case 0:return t=Ox.isSameOrigin(e),r=!Kv(e)&&this._options.useCORS===!0&&xo.SUPPORT_CORS_IMAGES&&!t,o=!Kv(e)&&!t&&!$v(e)&&typeof this._options.proxy=="string"&&xo.SUPPORT_CORS_XHR&&!r,!t&&this._options.allowTaint===!1&&!Kv(e)&&!$v(e)&&!o&&!r?[2]:(s=e,o?[4,this.proxy(s)]:[3,2]);case 1:s=a.sent(),a.label=2;case 2:return this.context.logger.debug("Added image ".concat(e.substring(0,256))),[4,new Promise(function(A,d){var c=new Image;c.onload=function(){return A(c)},c.onerror=d,(K8(s)||r)&&(c.crossOrigin="anonymous"),c.src=s,c.complete===!0&&setTimeout(function(){return A(c)},500),i._options.imageTimeout>0&&setTimeout(function(){return d("Timed out (".concat(i._options.imageTimeout,"ms) loading image"))},i._options.imageTimeout)})];case 3:return[2,a.sent()]}})})},n.prototype.has=function(e){return typeof this._cache[e]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(e){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var o=e.substring(0,256);return new Promise(function(s,i){var a=xo.SUPPORT_RESPONSE_TYPE?"blob":"text",A=new XMLHttpRequest;A.onload=function(){if(A.status===200)if(a==="text")s(A.response);else{var u=new FileReader;u.addEventListener("load",function(){return s(u.result)},!1),u.addEventListener("error",function(h){return i(h)},!1),u.readAsDataURL(A.response)}else i("Failed to proxy resource ".concat(o," with status code ").concat(A.status))},A.onerror=i;var d=r.indexOf("?")>-1?"&":"?";if(A.open("GET","".concat(r).concat(d,"url=").concat(encodeURIComponent(e),"&responseType=").concat(a)),a!=="text"&&A instanceof XMLHttpRequest&&(A.responseType=a),t._options.imageTimeout){var c=t._options.imageTimeout;A.timeout=c,A.ontimeout=function(){return i("Timed out (".concat(c,"ms) proxying ").concat(o))}}A.send()})},n}(),H8=/^data:image\/svg\+xml/i,j8=/^data:image\/.*;base64,/i,R8=/^data:image\/.*/i,q8=function(n){return xo.SUPPORT_SVG_DRAWING||!$8(n)},Kv=function(n){return R8.test(n)},K8=function(n){return j8.test(n)},$v=function(n){return n.substr(0,4)==="blob"},$8=function(n){return n.substr(-3).toLowerCase()==="svg"||H8.test(n)},$t=function(){function n(e,t){this.type=0,this.x=e,this.y=t}return n.prototype.add=function(e,t){return new n(this.x+e,this.y+t)},n}(),sd=function(n,e,t){return new $t(n.x+(e.x-n.x)*t,n.y+(e.y-n.y)*t)},zf=function(){function n(e,t,r,o){this.type=1,this.start=e,this.startControl=t,this.endControl=r,this.end=o}return n.prototype.subdivide=function(e,t){var r=sd(this.start,this.startControl,e),o=sd(this.startControl,this.endControl,e),s=sd(this.endControl,this.end,e),i=sd(r,o,e),a=sd(o,s,e),A=sd(i,a,e);return t?new n(this.start,r,i,A):new n(A,a,s,this.end)},n.prototype.add=function(e,t){return new n(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n}(),Gs=function(n){return n.type===1},V8=function(){function n(e){var t=e.styles,r=e.bounds,o=Jc(t.borderTopLeftRadius,r.width,r.height),s=o[0],i=o[1],a=Jc(t.borderTopRightRadius,r.width,r.height),A=a[0],d=a[1],c=Jc(t.borderBottomRightRadius,r.width,r.height),u=c[0],h=c[1],f=Jc(t.borderBottomLeftRadius,r.width,r.height),g=f[0],m=f[1],y=[];y.push((s+A)/r.width),y.push((g+u)/r.width),y.push((i+m)/r.height),y.push((d+h)/r.height);var b=Math.max.apply(Math,y);b>1&&(s/=b,i/=b,A/=b,d/=b,u/=b,h/=b,g/=b,m/=b);var S=r.width-A,F=r.height-h,k=r.width-u,P=r.height-m,te=t.borderTopWidth,$=t.borderRightWidth,j=t.borderBottomWidth,J=t.borderLeftWidth,we=An(t.paddingTop,e.bounds.width),D=An(t.paddingRight,e.bounds.width),N=An(t.paddingBottom,e.bounds.width),Z=An(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||i>0?In(r.left+J/3,r.top+te/3,s-J/3,i-te/3,Zr.TOP_LEFT):new $t(r.left+J/3,r.top+te/3),this.topRightBorderDoubleOuterBox=s>0||i>0?In(r.left+S,r.top+te/3,A-$/3,d-te/3,Zr.TOP_RIGHT):new $t(r.left+r.width-$/3,r.top+te/3),this.bottomRightBorderDoubleOuterBox=u>0||h>0?In(r.left+k,r.top+F,u-$/3,h-j/3,Zr.BOTTOM_RIGHT):new $t(r.left+r.width-$/3,r.top+r.height-j/3),this.bottomLeftBorderDoubleOuterBox=g>0||m>0?In(r.left+J/3,r.top+P,g-J/3,m-j/3,Zr.BOTTOM_LEFT):new $t(r.left+J/3,r.top+r.height-j/3),this.topLeftBorderDoubleInnerBox=s>0||i>0?In(r.left+J*2/3,r.top+te*2/3,s-J*2/3,i-te*2/3,Zr.TOP_LEFT):new $t(r.left+J*2/3,r.top+te*2/3),this.topRightBorderDoubleInnerBox=s>0||i>0?In(r.left+S,r.top+te*2/3,A-$*2/3,d-te*2/3,Zr.TOP_RIGHT):new $t(r.left+r.width-$*2/3,r.top+te*2/3),this.bottomRightBorderDoubleInnerBox=u>0||h>0?In(r.left+k,r.top+F,u-$*2/3,h-j*2/3,Zr.BOTTOM_RIGHT):new $t(r.left+r.width-$*2/3,r.top+r.height-j*2/3),this.bottomLeftBorderDoubleInnerBox=g>0||m>0?In(r.left+J*2/3,r.top+P,g-J*2/3,m-j*2/3,Zr.BOTTOM_LEFT):new $t(r.left+J*2/3,r.top+r.height-j*2/3),this.topLeftBorderStroke=s>0||i>0?In(r.left+J/2,r.top+te/2,s-J/2,i-te/2,Zr.TOP_LEFT):new $t(r.left+J/2,r.top+te/2),this.topRightBorderStroke=s>0||i>0?In(r.left+S,r.top+te/2,A-$/2,d-te/2,Zr.TOP_RIGHT):new $t(r.left+r.width-$/2,r.top+te/2),this.bottomRightBorderStroke=u>0||h>0?In(r.left+k,r.top+F,u-$/2,h-j/2,Zr.BOTTOM_RIGHT):new $t(r.left+r.width-$/2,r.top+r.height-j/2),this.bottomLeftBorderStroke=g>0||m>0?In(r.left+J/2,r.top+P,g-J/2,m-j/2,Zr.BOTTOM_LEFT):new $t(r.left+J/2,r.top+r.height-j/2),this.topLeftBorderBox=s>0||i>0?In(r.left,r.top,s,i,Zr.TOP_LEFT):new $t(r.left,r.top),this.topRightBorderBox=A>0||d>0?In(r.left+S,r.top,A,d,Zr.TOP_RIGHT):new $t(r.left+r.width,r.top),this.bottomRightBorderBox=u>0||h>0?In(r.left+k,r.top+F,u,h,Zr.BOTTOM_RIGHT):new $t(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=g>0||m>0?In(r.left,r.top+P,g,m,Zr.BOTTOM_LEFT):new $t(r.left,r.top+r.height),this.topLeftPaddingBox=s>0||i>0?In(r.left+J,r.top+te,Math.max(0,s-J),Math.max(0,i-te),Zr.TOP_LEFT):new $t(r.left+J,r.top+te),this.topRightPaddingBox=A>0||d>0?In(r.left+Math.min(S,r.width-$),r.top+te,S>r.width+$?0:Math.max(0,A-$),Math.max(0,d-te),Zr.TOP_RIGHT):new $t(r.left+r.width-$,r.top+te),this.bottomRightPaddingBox=u>0||h>0?In(r.left+Math.min(k,r.width-J),r.top+Math.min(F,r.height-j),Math.max(0,u-$),Math.max(0,h-j),Zr.BOTTOM_RIGHT):new $t(r.left+r.width-$,r.top+r.height-j),this.bottomLeftPaddingBox=g>0||m>0?In(r.left+J,r.top+Math.min(P,r.height-j),Math.max(0,g-J),Math.max(0,m-j),Zr.BOTTOM_LEFT):new $t(r.left+J,r.top+r.height-j),this.topLeftContentBox=s>0||i>0?In(r.left+J+Z,r.top+te+we,Math.max(0,s-(J+Z)),Math.max(0,i-(te+we)),Zr.TOP_LEFT):new $t(r.left+J+Z,r.top+te+we),this.topRightContentBox=A>0||d>0?In(r.left+Math.min(S,r.width+J+Z),r.top+te+we,S>r.width+J+Z?0:A-J+Z,d-(te+we),Zr.TOP_RIGHT):new $t(r.left+r.width-($+D),r.top+te+we),this.bottomRightContentBox=u>0||h>0?In(r.left+Math.min(k,r.width-(J+Z)),r.top+Math.min(F,r.height+te+we),Math.max(0,u-($+D)),h-(j+N),Zr.BOTTOM_RIGHT):new $t(r.left+r.width-($+D),r.top+r.height-(j+N)),this.bottomLeftContentBox=g>0||m>0?In(r.left+J+Z,r.top+P,Math.max(0,g-(J+Z)),m-(j+N),Zr.BOTTOM_LEFT):new $t(r.left+J+Z,r.top+r.height-(j+N))}return n}(),Zr;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Zr||(Zr={}));var In=function(n,e,t,r,o){var s=4*((Math.sqrt(2)-1)/3),i=t*s,a=r*s,A=n+t,d=e+r;switch(o){case Zr.TOP_LEFT:return new zf(new $t(n,d),new $t(n,d-a),new $t(A-i,e),new $t(A,e));case Zr.TOP_RIGHT:return new zf(new $t(n,e),new $t(n+i,e),new $t(A,d-a),new $t(A,d));case Zr.BOTTOM_RIGHT:return new zf(new $t(A,e),new $t(A,e+a),new $t(n+i,d),new $t(n,d));case Zr.BOTTOM_LEFT:default:return new zf(new $t(A,d),new $t(A-i,d),new $t(n,e+a),new $t(n,e))}},Qp=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},G8=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},Tp=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},W8=function(){function n(e,t,r){this.offsetX=e,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return n}(),Cf=function(){function n(e,t){this.path=e,this.target=t,this.type=1}return n}(),X8=function(){function n(e){this.opacity=e,this.type=2,this.target=6}return n}(),Y8=function(n){return n.type===0},Dx=function(n){return n.type===1},J8=function(n){return n.type===2},Zy=function(n,e){return n.length===e.length?n.some(function(t,r){return t===e[r]}):!1},Z8=function(n,e,t,r,o){return n.map(function(s,i){switch(i){case 0:return s.add(e,t);case 1:return s.add(e+r,t);case 2:return s.add(e+r,t+o);case 3:return s.add(e,t+o)}return s})},Nx=function(){function n(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n}(),Mx=function(){function n(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new V8(this.container),this.container.styles.opacity<1&&this.effects.push(new X8(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,o=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new W8(r,o,s))}if(this.container.styles.overflowX!==0){var i=Qp(this.curves),a=Tp(this.curves);Zy(i,a)?this.effects.push(new Cf(i,6)):(this.effects.push(new Cf(i,2)),this.effects.push(new Cf(a,4)))}}return n.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,o=this.effects.slice(0);r;){var s=r.effects.filter(function(A){return!Dx(A)});if(t||r.container.styles.position!==0||!r.parent){if(t=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var i=Qp(r.curves),a=Tp(r.curves);Zy(i,a)||o.unshift(new Cf(a,6))}o.unshift.apply(o,s)}else o.unshift.apply(o,s);r=r.parent}return o.filter(function(A){return Ao(A.target,e)})},n}(),gm=function(n,e,t,r){n.container.elements.forEach(function(o){var s=Ao(o.flags,4),i=Ao(o.flags,2),a=new Mx(o,n);Ao(o.styles.display,2048)&&r.push(a);var A=Ao(o.flags,8)?[]:r;if(s||i){var d=s||o.styles.isPositioned()?t:e,c=new Nx(a);if(o.styles.isPositioned()||o.styles.opacity<1||o.styles.isTransformed()){var u=o.styles.zIndex.order;if(u<0){var h=0;d.negativeZIndex.some(function(g,m){return u>g.element.container.styles.zIndex.order?(h=m,!1):h>0}),d.negativeZIndex.splice(h,0,c)}else if(u>0){var f=0;d.positiveZIndex.some(function(g,m){return u>=g.element.container.styles.zIndex.order?(f=m+1,!1):f>0}),d.positiveZIndex.splice(f,0,c)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else o.styles.isFloating()?d.nonPositionedFloats.push(c):d.nonPositionedInlineLevel.push(c);gm(a,c,s?c:t,A)}else o.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),gm(a,e,t,A);Ao(o.flags,8)&&Hx(o,A)})},Hx=function(n,e){for(var t=n instanceof cm?n.start:1,r=n instanceof cm?n.reversed:!1,o=0;o<e.length;o++){var s=e[o];s.container instanceof xx&&typeof s.container.value=="number"&&s.container.value!==0&&(t=s.container.value),s.listValue=Qu(t,s.container.styles.listStyleType,!0),t+=r?-1:1}},eD=function(n){var e=new Mx(n,null),t=new Nx(e),r=[];return gm(e,t,t,r),Hx(e.container,r),t},eb=function(n,e){switch(e){case 0:return Ys(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return Ys(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return Ys(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return Ys(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},tD=function(n,e){switch(e){case 0:return Ys(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return Ys(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return Ys(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return Ys(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},rD=function(n,e){switch(e){case 0:return Ys(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return Ys(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return Ys(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return Ys(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},nD=function(n,e){switch(e){case 0:return Sf(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return Sf(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return Sf(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return Sf(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},Sf=function(n,e){var t=[];return Gs(n)?t.push(n.subdivide(.5,!1)):t.push(n),Gs(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},Ys=function(n,e,t,r){var o=[];return Gs(n)?o.push(n.subdivide(.5,!1)):o.push(n),Gs(t)?o.push(t.subdivide(.5,!0)):o.push(t),Gs(r)?o.push(r.subdivide(.5,!0).reverse()):o.push(r),Gs(e)?o.push(e.subdivide(.5,!1).reverse()):o.push(e),o},jx=function(n){var e=n.bounds,t=n.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},Lp=function(n){var e=n.styles,t=n.bounds,r=An(e.paddingLeft,t.width),o=An(e.paddingRight,t.width),s=An(e.paddingTop,t.width),i=An(e.paddingBottom,t.width);return t.add(r+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+r+o),-(e.borderTopWidth+e.borderBottomWidth+s+i))},oD=function(n,e){return n===0?e.bounds:n===2?Lp(e):jx(e)},sD=function(n,e){return n===0?e.bounds:n===2?Lp(e):jx(e)},Vv=function(n,e,t){var r=oD(ud(n.styles.backgroundOrigin,e),n),o=sD(ud(n.styles.backgroundClip,e),n),s=iD(ud(n.styles.backgroundSize,e),t,r),i=s[0],a=s[1],A=Jc(ud(n.styles.backgroundPosition,e),r.width-i,r.height-a),d=aD(ud(n.styles.backgroundRepeat,e),A,s,r,o),c=Math.round(r.left+A[0]),u=Math.round(r.top+A[1]);return i=Math.max(1,i),a=Math.max(1,a),[d,c,u,i,a]},id=function(n){return Mr(n)&&n.value===Ud.AUTO},Ef=function(n){return typeof n=="number"},iD=function(n,e,t){var r=e[0],o=e[1],s=e[2],i=n[0],a=n[1];if(!i)return[0,0];if(Cn(i)&&a&&Cn(a))return[An(i,t.width),An(a,t.height)];var A=Ef(s);if(Mr(i)&&(i.value===Ud.CONTAIN||i.value===Ud.COVER)){if(Ef(s)){var d=t.width/t.height;return d<s!=(i.value===Ud.COVER)?[t.width,t.width/s]:[t.height*s,t.height]}return[t.width,t.height]}var c=Ef(r),u=Ef(o),h=c||u;if(id(i)&&(!a||id(a))){if(c&&u)return[r,o];if(!A&&!h)return[t.width,t.height];if(h&&A){var f=c?r:o*s,g=u?o:r/s;return[f,g]}var m=c?r:t.width,y=u?o:t.height;return[m,y]}if(A){var b=0,S=0;return Cn(i)?b=An(i,t.width):Cn(a)&&(S=An(a,t.height)),id(i)?b=S*s:(!a||id(a))&&(S=b/s),[b,S]}var F=null,k=null;if(Cn(i)?F=An(i,t.width):a&&Cn(a)&&(k=An(a,t.height)),F!==null&&(!a||id(a))&&(k=c&&u?F/r*o:t.height),k!==null&&id(i)&&(F=c&&u?k/o*r:t.width),F!==null&&k!==null)return[F,k];throw new Error("Unable to calculate background-size for element")},ud=function(n,e){var t=n[e];return typeof t>"u"?n[0]:t},aD=function(n,e,t,r,o){var s=e[0],i=e[1],a=t[0],A=t[1];switch(n){case 2:return[new $t(Math.round(r.left),Math.round(r.top+i)),new $t(Math.round(r.left+r.width),Math.round(r.top+i)),new $t(Math.round(r.left+r.width),Math.round(A+r.top+i)),new $t(Math.round(r.left),Math.round(A+r.top+i))];case 3:return[new $t(Math.round(r.left+s),Math.round(r.top)),new $t(Math.round(r.left+s+a),Math.round(r.top)),new $t(Math.round(r.left+s+a),Math.round(r.height+r.top)),new $t(Math.round(r.left+s),Math.round(r.height+r.top))];case 1:return[new $t(Math.round(r.left+s),Math.round(r.top+i)),new $t(Math.round(r.left+s+a),Math.round(r.top+i)),new $t(Math.round(r.left+s+a),Math.round(r.top+i+A)),new $t(Math.round(r.left+s),Math.round(r.top+i+A))];default:return[new $t(Math.round(o.left),Math.round(o.top)),new $t(Math.round(o.left+o.width),Math.round(o.top)),new $t(Math.round(o.left+o.width),Math.round(o.height+o.top)),new $t(Math.round(o.left),Math.round(o.height+o.top))]}},AD="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",tb="Hidden Text",lD=function(){function n(e){this._data={},this._document=e}return n.prototype.parseMetrics=function(e,t){var r=this._document.createElement("div"),o=this._document.createElement("img"),s=this._document.createElement("span"),i=this._document.body;r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",i.appendChild(r),o.src=AD,o.width=1,o.height=1,o.style.margin="0",o.style.padding="0",o.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(tb)),r.appendChild(s),r.appendChild(o);var a=o.offsetTop-s.offsetTop+2;r.removeChild(s),r.appendChild(this._document.createTextNode(tb)),r.style.lineHeight="normal",o.style.verticalAlign="super";var A=o.offsetTop-r.offsetTop+2;return i.removeChild(r),{baseline:a,middle:A}},n.prototype.getMetrics=function(e,t){var r="".concat(e," ").concat(t);return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(e,t)),this._data[r]},n}(),Rx=function(){function n(e,t){this.context=e,this.options=t}return n}(),dD=1e4,cD=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o._activeEffects=[],o.canvas=r.canvas?r.canvas:document.createElement("canvas"),o.ctx=o.canvas.getContext("2d"),r.canvas||(o.canvas.width=Math.floor(r.width*r.scale),o.canvas.height=Math.floor(r.height*r.scale),o.canvas.style.width="".concat(r.width,"px"),o.canvas.style.height="".concat(r.height,"px")),o.fontMetrics=new lD(document),o.ctx.scale(o.options.scale,o.options.scale),o.ctx.translate(-r.x,-r.y),o.ctx.textBaseline="bottom",o._activeEffects=[],o.context.logger.debug("Canvas renderer initialized (".concat(r.width,"x").concat(r.height,") with scale ").concat(r.scale)),o}return e.prototype.applyEffects=function(t){for(var r=this;this._activeEffects.length;)this.popEffect();t.forEach(function(o){return r.applyEffect(o)})},e.prototype.applyEffect=function(t){this.ctx.save(),J8(t)&&(this.ctx.globalAlpha=t.opacity),Y8(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),Dx(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return Xo(this,void 0,void 0,function(){var r;return No(this,function(o){switch(o.label){case 0:return r=t.element.container.styles,r.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return Xo(this,void 0,void 0,function(){return No(this,function(r){switch(r.label){case 0:if(Ao(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,r,o){var s=this;if(r===0)navigator.userAgent.indexOf("Firefox")===-1?(this.ctx.textBaseline="ideographic",this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+t.bounds.height)):this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+o);else{var i=j1(t.text);i.reduce(function(a,A){return s.ctx.fillText(A,a,t.bounds.top+o),a+s.ctx.measureText(A).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var r=t.fontVariant.filter(function(i){return i==="normal"||i==="small-caps"}).join(""),o=gD(t.fontFamily).join(", "),s=CA(t.fontSize)?"".concat(t.fontSize.number).concat(t.fontSize.unit):"".concat(t.fontSize.number,"px");return[[t.fontStyle,r,t.fontWeight,s,o].join(" "),o,s]},e.prototype.renderTextNode=function(t,r){return Xo(this,void 0,void 0,function(){var o,s,i=this;return No(this,function(a){return o=this.createFontStyle(r)[0],this.ctx.font=o,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",s=r.paintOrder,t.textBounds.forEach(function(A){s.forEach(function(d){switch(d){case 0:i.ctx.fillStyle=vo(r.color),i.renderTextWithLetterSpacing(A,r.letterSpacing,r.fontSize.number);var c=r.textShadow;if(c.length&&A.text.trim().length&&(c.slice(0).reverse().forEach(function(h){i.ctx.shadowColor=vo(h.color),i.ctx.shadowOffsetX=h.offsetX.number*i.options.scale,i.ctx.shadowOffsetY=h.offsetY.number*i.options.scale,i.ctx.shadowBlur=h.blur.number,i.renderTextWithLetterSpacing(A,r.letterSpacing,r.fontSize.number)}),i.ctx.shadowColor="",i.ctx.shadowOffsetX=0,i.ctx.shadowOffsetY=0,i.ctx.shadowBlur=0),r.textDecorationLine.length){i.ctx.fillStyle=vo(r.textDecorationColor||r.color);var u=1;r.textDecorationLine.forEach(function(h){switch(h){case 1:i.ctx.fillRect(A.bounds.left,A.bounds.top+A.bounds.height-u,A.bounds.width,u);break;case 2:i.ctx.fillRect(A.bounds.left,A.bounds.top,A.bounds.width,u);break;case 3:i.ctx.fillRect(A.bounds.left,A.bounds.top+(A.bounds.height/2-u/2),A.bounds.width,u);break}})}break;case 1:r.webkitTextStrokeWidth&&A.text.trim().length&&(i.ctx.strokeStyle=vo(r.webkitTextStrokeColor),i.ctx.lineWidth=r.webkitTextStrokeWidth,i.ctx.lineJoin=window.chrome?"miter":"round",i.ctx.strokeText(A.text,A.bounds.left,A.bounds.top+A.bounds.height)),i.ctx.strokeStyle="",i.ctx.lineWidth=0,i.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,r,o){var s=o.naturalWidth||t.intrinsicWidth,i=o.naturalHeight||t.intrinsicHeight;if(o&&s>0&&i>0){var a=Lp(t),A=Tp(r);this.path(A),this.ctx.save(),this.ctx.clip();var d=0,c=0,u=s,h=i,f=a.left,g=a.top,m=a.width,y=a.height,b=t.styles.objectFit,S=m/y,F=u/h;if(b===2)F>S?(y=m/F,g+=(a.height-y)/2):(m=y*F,f+=(a.width-m)/2);else if(b===4)F>S?(u=h*S,d+=(s-u)/2):(h=u/S,c+=(i-h)/2);else if(b===8)u>m?(d+=(u-m)/2,u=m):(f+=(m-u)/2,m=u),h>y?(c+=(h-y)/2,h=y):(g+=(y-h)/2,y=h);else if(b===16){var k=F>S?m:y*F,P=u>m?u:m;k<P?F>S?(y=m/F,g+=(a.height-y)/2):(m=y*F,f+=(a.width-m)/2):(u>m?(d+=(u-m)/2,u=m):(f+=(m-u)/2,m=u),h>y?(c+=(h-y)/2,h=y):(g+=(y-h)/2,y=h))}this.ctx.drawImage(o,d,c,u,h,f,g,m,y),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return Xo(this,void 0,void 0,function(){var r,o,s,i,a,A,S,S,d,c,u,h,k,f,g,P,m,y,b,S,F,k,P;return No(this,function(te){switch(te.label){case 0:this.applyEffects(t.getEffects(4)),r=t.container,o=t.curves,s=r.styles,i=0,a=r.textNodes,te.label=1;case 1:return i<a.length?(A=a[i],[4,this.renderTextNode(A,s)]):[3,4];case 2:te.sent(),te.label=3;case 3:return i++,[3,1];case 4:if(!(r instanceof bx))return[3,8];te.label=5;case 5:return te.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return S=te.sent(),this.renderReplacedElement(r,o,S),[3,8];case 7:return te.sent(),this.context.logger.error("Error loading image ".concat(r.src)),[3,8];case 8:if(r instanceof _x&&this.renderReplacedElement(r,o,r.canvas),!(r instanceof Bx))return[3,12];te.label=9;case 9:return te.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return S=te.sent(),this.renderReplacedElement(r,o,S),[3,12];case 11:return te.sent(),this.context.logger.error("Error loading svg ".concat(r.svg.substring(0,255))),[3,12];case 12:return r instanceof Sx&&r.tree?(d=new e(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,d.render(r.tree)]):[3,14];case 13:c=te.sent(),r.width&&r.height&&this.ctx.drawImage(c,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),te.label=14;case 14:if(r instanceof R1&&(u=Math.min(r.bounds.width,r.bounds.height),r.type===Ep?r.checked&&(this.ctx.save(),this.path([new $t(r.bounds.left+u*.39363,r.bounds.top+u*.79),new $t(r.bounds.left+u*.16,r.bounds.top+u*.5549),new $t(r.bounds.left+u*.27347,r.bounds.top+u*.44071),new $t(r.bounds.left+u*.39694,r.bounds.top+u*.5649),new $t(r.bounds.left+u*.72983,r.bounds.top+u*.23),new $t(r.bounds.left+u*.84,r.bounds.top+u*.34085),new $t(r.bounds.left+u*.39363,r.bounds.top+u*.79)]),this.ctx.fillStyle=vo(jy),this.ctx.fill(),this.ctx.restore()):r.type===Fp&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+u/2,r.bounds.top+u/2,u/4,0,Math.PI*2,!0),this.ctx.fillStyle=vo(jy),this.ctx.fill(),this.ctx.restore())),uD(r)&&r.value.length){switch(h=this.createFontStyle(s),k=h[0],f=h[1],g=this.fontMetrics.getMetrics(k,f).baseline,this.ctx.font=k,this.ctx.fillStyle=vo(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=fD(r.styles.textAlign),P=Lp(r),m=0,r.styles.textAlign){case 1:m+=P.width/2;break;case 2:m+=P.width;break}y=P.add(m,0,0,-P.height/2+1),this.ctx.save(),this.path([new $t(P.left,P.top),new $t(P.left+P.width,P.top),new $t(P.left+P.width,P.top+P.height),new $t(P.left,P.top+P.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new cu(r.value,y),s.letterSpacing,g),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!Ao(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(b=r.styles.listStyleImage,b.type!==0)return[3,18];S=void 0,F=b.url,te.label=15;case 15:return te.trys.push([15,17,,18]),[4,this.context.cache.match(F)];case 16:return S=te.sent(),this.ctx.drawImage(S,r.bounds.left-(S.width+10),r.bounds.top),[3,18];case 17:return te.sent(),this.context.logger.error("Error loading list-style-image ".concat(F)),[3,18];case 18:return[3,20];case 19:t.listValue&&r.styles.listStyleType!==-1&&(k=this.createFontStyle(s)[0],this.ctx.font=k,this.ctx.fillStyle=vo(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",P=new Fa(r.bounds.left,r.bounds.top+An(r.styles.paddingTop,r.bounds.width),r.bounds.width,zy(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new cu(t.listValue,P),s.letterSpacing,zy(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),te.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return Xo(this,void 0,void 0,function(){var r,o,b,s,i,b,a,A,b,d,c,b,u,h,b,f,g,b,m,y,b;return No(this,function(S){switch(S.label){case 0:if(Ao(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:S.sent(),r=0,o=t.negativeZIndex,S.label=2;case 2:return r<o.length?(b=o[r],[4,this.renderStack(b)]):[3,5];case 3:S.sent(),S.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:S.sent(),s=0,i=t.nonInlineLevel,S.label=7;case 7:return s<i.length?(b=i[s],[4,this.renderNode(b)]):[3,10];case 8:S.sent(),S.label=9;case 9:return s++,[3,7];case 10:a=0,A=t.nonPositionedFloats,S.label=11;case 11:return a<A.length?(b=A[a],[4,this.renderStack(b)]):[3,14];case 12:S.sent(),S.label=13;case 13:return a++,[3,11];case 14:d=0,c=t.nonPositionedInlineLevel,S.label=15;case 15:return d<c.length?(b=c[d],[4,this.renderStack(b)]):[3,18];case 16:S.sent(),S.label=17;case 17:return d++,[3,15];case 18:u=0,h=t.inlineLevel,S.label=19;case 19:return u<h.length?(b=h[u],[4,this.renderNode(b)]):[3,22];case 20:S.sent(),S.label=21;case 21:return u++,[3,19];case 22:f=0,g=t.zeroOrAutoZIndexOrTransformedOrOpacity,S.label=23;case 23:return f<g.length?(b=g[f],[4,this.renderStack(b)]):[3,26];case 24:S.sent(),S.label=25;case 25:return f++,[3,23];case 26:m=0,y=t.positiveZIndex,S.label=27;case 27:return m<y.length?(b=y[m],[4,this.renderStack(b)]):[3,30];case 28:S.sent(),S.label=29;case 29:return m++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var r=this;t.forEach(function(o,s){var i=Gs(o)?o.start:o;s===0?r.ctx.moveTo(i.x,i.y):r.ctx.lineTo(i.x,i.y),Gs(o)&&r.ctx.bezierCurveTo(o.startControl.x,o.startControl.y,o.endControl.x,o.endControl.y,o.end.x,o.end.y)})},e.prototype.renderRepeat=function(t,r,o,s){this.path(t),this.ctx.fillStyle=r,this.ctx.translate(o,s),this.ctx.fill(),this.ctx.translate(-o,-s)},e.prototype.resizeImage=function(t,r,o){var s,i=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,a=i.createElement("canvas");a.width=Math.max(1,r),a.height=Math.max(1,o);var A=a.getContext("2d");return A.drawImage(t,0,0,t.width,t.height,0,0,r,o),a},e.prototype.renderBackgroundImage=function(t){return Xo(this,void 0,void 0,function(){var r,o,s,i,a,A;return No(this,function(d){switch(d.label){case 0:r=t.styles.backgroundImage.length-1,o=function(c){var u,h,f,g,m,N,V,K,ce,re,we,y,N,V,K,ce,re,b,S,F,k,P,te,$,j,J,we,D,N,Z,se,ce,re,pe,V,K,oe,ae,x,E,I,L,M,H;return No(this,function(q){switch(q.label){case 0:if(c.type!==0)return[3,5];u=void 0,h=c.url,q.label=1;case 1:return q.trys.push([1,3,,4]),[4,s.context.cache.match(h)];case 2:return u=q.sent(),[3,4];case 3:return q.sent(),s.context.logger.error("Error loading background-image ".concat(h)),[3,4];case 4:return u&&(f=isNaN(u.width)||u.width===0?1:u.width,g=isNaN(u.height)||u.height===0?1:u.height,m=Vv(t,r,[f,g,f/g]),N=m[0],V=m[1],K=m[2],ce=m[3],re=m[4],we=s.ctx.createPattern(s.resizeImage(u,ce,re),"repeat"),s.renderRepeat(N,we,V,K)),[3,6];case 5:G6(c)?(y=Vv(t,r,[null,null,null]),N=y[0],V=y[1],K=y[2],ce=y[3],re=y[4],b=R6(c.angle,ce,re),S=b[0],F=b[1],k=b[2],P=b[3],te=b[4],$=document.createElement("canvas"),$.width=ce,$.height=re,j=$.getContext("2d"),J=j.createLinearGradient(F,P,k,te),By(c.stops,S).forEach(function(G){return J.addColorStop(G.stop,vo(G.color))}),j.fillStyle=J,j.fillRect(0,0,ce,re),ce>0&&re>0&&(we=s.ctx.createPattern($,"repeat"),s.renderRepeat(N,we,V,K))):W6(c)&&(D=Vv(t,r,[null,null,null]),N=D[0],Z=D[1],se=D[2],ce=D[3],re=D[4],pe=c.position.length===0?[O1]:c.position,V=An(pe[0],ce),K=An(pe[pe.length-1],re),oe=q6(c,V,K,ce,re),ae=oe[0],x=oe[1],ae>0&&x>0&&(E=s.ctx.createRadialGradient(Z+V,se+K,0,Z+V,se+K,ae),By(c.stops,ae*2).forEach(function(G){return E.addColorStop(G.stop,vo(G.color))}),s.path(N),s.ctx.fillStyle=E,ae!==x?(I=t.bounds.left+.5*t.bounds.width,L=t.bounds.top+.5*t.bounds.height,M=x/ae,H=1/M,s.ctx.save(),s.ctx.translate(I,L),s.ctx.transform(1,0,0,M,0,0),s.ctx.translate(-I,-L),s.ctx.fillRect(Z,H*(se-L)+L,ce,re*H),s.ctx.restore()):s.ctx.fill())),q.label=6;case 6:return r--,[2]}})},s=this,i=0,a=t.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return i<a.length?(A=a[i],[5,o(A)]):[3,4];case 2:d.sent(),d.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,r,o){return Xo(this,void 0,void 0,function(){return No(this,function(s){return this.path(eb(o,r)),this.ctx.fillStyle=vo(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,r,o,s){return Xo(this,void 0,void 0,function(){var i,a;return No(this,function(A){switch(A.label){case 0:return r<3?[4,this.renderSolidBorder(t,o,s)]:[3,2];case 1:return A.sent(),[2];case 2:return i=tD(s,o),this.path(i),this.ctx.fillStyle=vo(t),this.ctx.fill(),a=rD(s,o),this.path(a),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return Xo(this,void 0,void 0,function(){var r,o,s,i,a,A,d,c,u=this;return No(this,function(h){switch(h.label){case 0:return this.applyEffects(t.getEffects(2)),r=t.container.styles,o=!fA(r.backgroundColor)||r.backgroundImage.length,s=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],i=hD(ud(r.backgroundClip,0),t.curves),o||r.boxShadow.length?(this.ctx.save(),this.path(i),this.ctx.clip(),fA(r.backgroundColor)||(this.ctx.fillStyle=vo(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(f){u.ctx.save();var g=Qp(t.curves),m=f.inset?0:dD,y=Z8(g,-m+(f.inset?1:-1)*f.spread.number,(f.inset?1:-1)*f.spread.number,f.spread.number*(f.inset?-2:2),f.spread.number*(f.inset?-2:2));f.inset?(u.path(g),u.ctx.clip(),u.mask(y)):(u.mask(g),u.ctx.clip(),u.path(y)),u.ctx.shadowOffsetX=f.offsetX.number+m,u.ctx.shadowOffsetY=f.offsetY.number,u.ctx.shadowColor=vo(f.color),u.ctx.shadowBlur=f.blur.number,u.ctx.fillStyle=f.inset?vo(f.color):"rgba(0,0,0,1)",u.ctx.fill(),u.ctx.restore()}),h.label=2;case 2:a=0,A=0,d=s,h.label=3;case 3:return A<d.length?(c=d[A],c.style!==0&&!fA(c.color)&&c.width>0?c.style!==2?[3,5]:[4,this.renderDashedDottedBorder(c.color,c.width,a,t.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return c.style!==3?[3,7]:[4,this.renderDashedDottedBorder(c.color,c.width,a,t.curves,3)];case 6:return h.sent(),[3,11];case 7:return c.style!==4?[3,9]:[4,this.renderDoubleBorder(c.color,c.width,a,t.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(c.color,a,t.curves)];case 10:h.sent(),h.label=11;case 11:a++,h.label=12;case 12:return A++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,r,o,s,i){return Xo(this,void 0,void 0,function(){var a,A,d,c,u,h,f,g,m,y,b,S,F,k,P,te,P,te;return No(this,function($){return this.ctx.save(),a=nD(s,o),A=eb(s,o),i===2&&(this.path(A),this.ctx.clip()),Gs(A[0])?(d=A[0].start.x,c=A[0].start.y):(d=A[0].x,c=A[0].y),Gs(A[1])?(u=A[1].end.x,h=A[1].end.y):(u=A[1].x,h=A[1].y),o===0||o===2?f=Math.abs(d-u):f=Math.abs(c-h),this.ctx.beginPath(),i===3?this.formatPath(a):this.formatPath(A.slice(0,2)),g=r<3?r*3:r*2,m=r<3?r*2:r,i===3&&(g=r,m=r),y=!0,f<=g*2?y=!1:f<=g*2+m?(b=f/(2*g+m),g*=b,m*=b):(S=Math.floor((f+m)/(g+m)),F=(f-S*g)/(S-1),k=(f-(S+1)*g)/S,m=k<=0||Math.abs(m-F)<Math.abs(m-k)?F:k),y&&(i===3?this.ctx.setLineDash([0,g+m]):this.ctx.setLineDash([g,m])),i===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=vo(t),this.ctx.stroke(),this.ctx.setLineDash([]),i===2&&(Gs(A[0])&&(P=A[3],te=A[0],this.ctx.beginPath(),this.formatPath([new $t(P.end.x,P.end.y),new $t(te.start.x,te.start.y)]),this.ctx.stroke()),Gs(A[1])&&(P=A[1],te=A[2],this.ctx.beginPath(),this.formatPath([new $t(P.end.x,P.end.y),new $t(te.start.x,te.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return Xo(this,void 0,void 0,function(){var r;return No(this,function(o){switch(o.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=vo(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=eD(t),[4,this.renderStack(r)];case 1:return o.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(Rx),uD=function(n){return n instanceof Cx||n instanceof zx?!0:n instanceof R1&&n.type!==Fp&&n.type!==Ep},hD=function(n,e){switch(n){case 0:return Qp(e);case 2:return G8(e);case 1:default:return Tp(e)}},fD=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},pD=["-apple-system","system-ui"],gD=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(e){return pD.indexOf(e)===-1}):n},vD=function(n){_i(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.canvas=r.canvas?r.canvas:document.createElement("canvas"),o.ctx=o.canvas.getContext("2d"),o.options=r,o.canvas.width=Math.floor(r.width*r.scale),o.canvas.height=Math.floor(r.height*r.scale),o.canvas.style.width="".concat(r.width,"px"),o.canvas.style.height="".concat(r.height,"px"),o.ctx.scale(o.options.scale,o.options.scale),o.ctx.translate(-r.x,-r.y),o.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized (".concat(r.width,"x").concat(r.height," at ").concat(r.x,",").concat(r.y,") with scale ").concat(r.scale)),o}return e.prototype.render=function(t){return Xo(this,void 0,void 0,function(){var r,o;return No(this,function(s){switch(s.label){case 0:return r=dm(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,mD(r)];case 1:return o=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=vo(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(o,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(Rx),mD=function(n){return new Promise(function(e,t){var r=new Image;r.onload=function(){e(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(n)))})},wD=function(){function n(e){var t=e.id,r=e.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,sf([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,sf([this.id,"".concat(this.getTime(),"ms")],e,!1))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,sf([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,sf([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.instances={},n}(),yD=function(){function n(e,t){var r;this.windowBounds=t,this.instanceName="#".concat(n.instanceCount++),this.logger=new wD({id:this.instanceName,enabled:e.logging}),this.cache=(r=e.cache)!==null&&r!==void 0?r:new M8(this,e)}return n.instanceCount=1,n}(),bD=function(n,e){return e===void 0&&(e={}),_D(n,e)};typeof window<"u"&&Ox.setContext(window);var _D=function(n,e){return Xo(void 0,void 0,void 0,function(){var t,r,o,s,i,a,A,d,c,u,h,f,g,m,y,b,S,F,k,P,$,te,$,j,J,we,D,N,Z,se,ce,re,pe,V,K,oe,ae,x,E,I;return No(this,function(L){switch(L.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=n.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(r=t.defaultView,!r)throw new Error("Document is not attached to a Window");return o={allowTaint:(j=e.allowTaint)!==null&&j!==void 0?j:!1,imageTimeout:(J=e.imageTimeout)!==null&&J!==void 0?J:15e3,proxy:e.proxy,useCORS:(we=e.useCORS)!==null&&we!==void 0?we:!1},s=V0({logging:(D=e.logging)!==null&&D!==void 0?D:!0,cache:e.cache},o),i={windowWidth:(N=e.windowWidth)!==null&&N!==void 0?N:r.innerWidth,windowHeight:(Z=e.windowHeight)!==null&&Z!==void 0?Z:r.innerHeight,scrollX:(se=e.scrollX)!==null&&se!==void 0?se:r.pageXOffset,scrollY:(ce=e.scrollY)!==null&&ce!==void 0?ce:r.pageYOffset},a=new Fa(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),A=new yD(s,a),d=(re=e.foreignObjectRendering)!==null&&re!==void 0?re:!1,c={allowTaint:(pe=e.allowTaint)!==null&&pe!==void 0?pe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:d,copyStyles:d},A.logger.debug("Starting document clone with size ".concat(a.width,"x").concat(a.height," scrolled to ").concat(-a.left,",").concat(-a.top)),u=new Yy(A,n,c),h=u.clonedReferenceElement,h?[4,u.toIFrame(t,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return f=L.sent(),g=q1(h)||_8(h)?oL(h.ownerDocument):cg(A,h),m=g.width,y=g.height,b=g.left,S=g.top,F=BD(A,h,e.backgroundColor),k={canvas:e.canvas,backgroundColor:F,scale:(K=(V=e.scale)!==null&&V!==void 0?V:r.devicePixelRatio)!==null&&K!==void 0?K:1,x:((oe=e.x)!==null&&oe!==void 0?oe:0)+b,y:((ae=e.y)!==null&&ae!==void 0?ae:0)+S,width:(x=e.width)!==null&&x!==void 0?x:Math.ceil(m),height:(E=e.height)!==null&&E!==void 0?E:Math.ceil(y)},d?(A.logger.debug("Document cloned, using foreign object rendering"),$=new vD(A,k),[4,$.render(h)]):[3,3];case 2:return P=L.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at ".concat(b,",").concat(S," with size ").concat(m,"x").concat(y," using computed rendering")),A.logger.debug("Starting DOM parsing"),te=Fx(A,h),F===te.styles.backgroundColor&&(te.styles.backgroundColor=Ri.TRANSPARENT),A.logger.debug("Starting renderer for element at ".concat(k.x,",").concat(k.y," with size ").concat(k.width,"x").concat(k.height)),$=new cD(A,k),[4,$.render(te)];case 4:P=L.sent(),L.label=5;case 5:return(!((I=e.removeContainer)!==null&&I!==void 0)||I)&&(Yy.destroy(f)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,P]}})})},BD=function(n,e,t){var r=e.ownerDocument,o=r.documentElement?Id(n,getComputedStyle(r.documentElement).backgroundColor):Ri.TRANSPARENT,s=r.body?Id(n,getComputedStyle(r.body).backgroundColor):Ri.TRANSPARENT,i=typeof t=="string"?Id(n,t):t===null?Ri.TRANSPARENT:4294967295;return e===r.documentElement?fA(o)?fA(s)?i:s:o:i};function ln(n){"@babel/helpers - typeof";return ln=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ln(n)}var Ho=Uint8Array,Ts=Uint16Array,K1=Int32Array,zg=new Ho([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Cg=new Ho([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),vm=new Ho([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),qx=function(n,e){for(var t=new Ts(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var o=new K1(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)o[s]=s-t[r]<<5|r;return{b:t,r:o}},Kx=qx(zg,2),$x=Kx.b,mm=Kx.r;$x[28]=258,mm[258]=28;var Vx=qx(Cg,0),xD=Vx.b,rb=Vx.r,wm=new Ts(32768);for(var Sn=0;Sn<32768;++Sn){var Ya=(Sn&43690)>>1|(Sn&21845)<<1;Ya=(Ya&52428)>>2|(Ya&13107)<<2,Ya=(Ya&61680)>>4|(Ya&3855)<<4,wm[Sn]=((Ya&65280)>>8|(Ya&255)<<8)>>1}var qi=function(n,e,t){for(var r=n.length,o=0,s=new Ts(e);o<r;++o)n[o]&&++s[n[o]-1];var i=new Ts(e);for(o=1;o<e;++o)i[o]=i[o-1]+s[o-1]<<1;var a;if(t){a=new Ts(1<<e);var A=15-e;for(o=0;o<r;++o)if(n[o])for(var d=o<<4|n[o],c=e-n[o],u=i[n[o]-1]++<<c,h=u|(1<<c)-1;u<=h;++u)a[wm[u]>>A]=d}else for(a=new Ts(r),o=0;o<r;++o)n[o]&&(a[o]=wm[i[n[o]-1]++]>>15-n[o]);return a},_A=new Ho(288);for(var Sn=0;Sn<144;++Sn)_A[Sn]=8;for(var Sn=144;Sn<256;++Sn)_A[Sn]=9;for(var Sn=256;Sn<280;++Sn)_A[Sn]=7;for(var Sn=280;Sn<288;++Sn)_A[Sn]=8;var Tu=new Ho(32);for(var Sn=0;Sn<32;++Sn)Tu[Sn]=5;var zD=qi(_A,9,0),CD=qi(_A,9,1),SD=qi(Tu,5,0),ED=qi(Tu,5,1),Gv=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},ai=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},Wv=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},$1=function(n){return(n+7)/8|0},Gx=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Ho(n.subarray(e,t))},FD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ui=function(n,e,t){var r=new Error(e||FD[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,ui),!t)throw r;return r},ID=function(n,e,t,r){var o=n.length,s=0;if(!o||e.f&&!e.l)return t||new Ho(0);var i=!t,a=i||e.i!=2,A=e.i;i&&(t=new Ho(o*3));var d=function(he){var Be=t.length;if(he>Be){var be=new Ho(Math.max(Be*2,he));be.set(t),t=be}},c=e.f||0,u=e.p||0,h=e.b||0,f=e.l,g=e.d,m=e.m,y=e.n,b=o*8;do{if(!f){c=ai(n,u,1);var S=ai(n,u+1,3);if(u+=3,S)if(S==1)f=CD,g=ED,m=9,y=5;else if(S==2){var te=ai(n,u,31)+257,$=ai(n,u+10,15)+4,j=te+ai(n,u+5,31)+1;u+=14;for(var J=new Ho(j),we=new Ho(19),D=0;D<$;++D)we[vm[D]]=ai(n,u+D*3,7);u+=$*3;for(var N=Gv(we),Z=(1<<N)-1,se=qi(we,N,1),D=0;D<j;){var ce=se[ai(n,u,Z)];u+=ce&15;var F=ce>>4;if(F<16)J[D++]=F;else{var re=0,pe=0;for(F==16?(pe=3+ai(n,u,3),u+=2,re=J[D-1]):F==17?(pe=3+ai(n,u,7),u+=3):F==18&&(pe=11+ai(n,u,127),u+=7);pe--;)J[D++]=re}}var V=J.subarray(0,te),K=J.subarray(te);m=Gv(V),y=Gv(K),f=qi(V,m,1),g=qi(K,y,1)}else ui(1);else{var F=$1(u)+4,k=n[F-4]|n[F-3]<<8,P=F+k;if(P>o){A&&ui(0);break}a&&d(h+k),t.set(n.subarray(F,P),h),e.b=h+=k,e.p=u=P*8,e.f=c;continue}if(u>b){A&&ui(0);break}}a&&d(h+131072);for(var oe=(1<<m)-1,ae=(1<<y)-1,x=u;;x=u){var re=f[Wv(n,u)&oe],E=re>>4;if(u+=re&15,u>b){A&&ui(0);break}if(re||ui(2),E<256)t[h++]=E;else if(E==256){x=u,f=null;break}else{var I=E-254;if(E>264){var D=E-257,L=zg[D];I=ai(n,u,(1<<L)-1)+$x[D],u+=L}var M=g[Wv(n,u)&ae],H=M>>4;M||ui(3),u+=M&15;var K=xD[H];if(H>3){var L=Cg[H];K+=Wv(n,u)&(1<<L)-1,u+=L}if(u>b){A&&ui(0);break}a&&d(h+131072);var q=h+I;if(h<K){var G=s-K,R=Math.min(K,q);for(G+h<0&&ui(3);h<R;++h)t[h]=r[G+h]}for(;h<q;++h)t[h]=t[h-K]}}e.l=f,e.p=x,e.b=h,e.f=c,f&&(c=1,e.m=m,e.d=g,e.n=y)}while(!c);return h!=t.length&&i?Gx(t,0,h):t.subarray(0,h)},ca=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},Hc=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},Xv=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var o=t.length,s=t.slice();if(!o)return{t:Xx,l:0};if(o==1){var i=new Ho(t[0].s+1);return i[t[0].s]=1,{t:i,l:1}}t.sort(function(P,te){return P.f-te.f}),t.push({s:-1,f:25001});var a=t[0],A=t[1],d=0,c=1,u=2;for(t[0]={s:-1,f:a.f+A.f,l:a,r:A};c!=o-1;)a=t[t[d].f<t[u].f?d++:u++],A=t[d!=c&&t[d].f<t[u].f?d++:u++],t[c++]={s:-1,f:a.f+A.f,l:a,r:A};for(var h=s[0].s,r=1;r<o;++r)s[r].s>h&&(h=s[r].s);var f=new Ts(h+1),g=ym(t[c-1],f,0);if(g>e){var r=0,m=0,y=g-e,b=1<<y;for(s.sort(function(te,$){return f[$.s]-f[te.s]||te.f-$.f});r<o;++r){var S=s[r].s;if(f[S]>e)m+=b-(1<<g-f[S]),f[S]=e;else break}for(m>>=y;m>0;){var F=s[r].s;f[F]<e?m-=1<<e-f[F]++-1:++r}for(;r>=0&&m;--r){var k=s[r].s;f[k]==e&&(--f[k],++m)}g=e}return{t:new Ho(f),l:g}},ym=function(n,e,t){return n.s==-1?Math.max(ym(n.l,e,t+1),ym(n.r,e,t+1)):e[n.s]=t},nb=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new Ts(++e),r=0,o=n[0],s=1,i=function(A){t[r++]=A},a=1;a<=e;++a)if(n[a]==o&&a!=e)++s;else{if(!o&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(o),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(o);s=1,o=n[a]}return{c:t.subarray(0,r),n:e}},jc=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},Wx=function(n,e,t){var r=t.length,o=$1(e+2);n[o]=r&255,n[o+1]=r>>8,n[o+2]=n[o]^255,n[o+3]=n[o+1]^255;for(var s=0;s<r;++s)n[o+s+4]=t[s];return(o+4+r)*8},ob=function(n,e,t,r,o,s,i,a,A,d,c){ca(e,c++,t),++o[256];for(var u=Xv(o,15),h=u.t,f=u.l,g=Xv(s,15),m=g.t,y=g.l,b=nb(h),S=b.c,F=b.n,k=nb(m),P=k.c,te=k.n,$=new Ts(19),j=0;j<S.length;++j)++$[S[j]&31];for(var j=0;j<P.length;++j)++$[P[j]&31];for(var J=Xv($,7),we=J.t,D=J.l,N=19;N>4&&!we[vm[N-1]];--N);var Z=d+5<<3,se=jc(o,_A)+jc(s,Tu)+i,ce=jc(o,h)+jc(s,m)+i+14+3*N+jc($,we)+2*$[16]+3*$[17]+7*$[18];if(A>=0&&Z<=se&&Z<=ce)return Wx(e,c,n.subarray(A,A+d));var re,pe,V,K;if(ca(e,c,1+(ce<se)),c+=2,ce<se){re=qi(h,f,0),pe=h,V=qi(m,y,0),K=m;var oe=qi(we,D,0);ca(e,c,F-257),ca(e,c+5,te-1),ca(e,c+10,N-4),c+=14;for(var j=0;j<N;++j)ca(e,c+3*j,we[vm[j]]);c+=3*N;for(var ae=[S,P],x=0;x<2;++x)for(var E=ae[x],j=0;j<E.length;++j){var I=E[j]&31;ca(e,c,oe[I]),c+=we[I],I>15&&(ca(e,c,E[j]>>5&127),c+=E[j]>>12)}}else re=zD,pe=_A,V=SD,K=Tu;for(var j=0;j<a;++j){var L=r[j];if(L>255){var I=L>>18&31;Hc(e,c,re[I+257]),c+=pe[I+257],I>7&&(ca(e,c,L>>23&31),c+=zg[I]);var M=L&31;Hc(e,c,V[M]),c+=K[M],M>3&&(Hc(e,c,L>>5&8191),c+=Cg[M])}else Hc(e,c,re[L]),c+=pe[L]}return Hc(e,c,re[256]),c+pe[256]},UD=new K1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),Xx=new Ho(0),QD=function(n,e,t,r,o,s){var i=s.z||n.length,a=new Ho(r+i+5*(1+Math.ceil(i/7e3))+o),A=a.subarray(r,a.length-o),d=s.l,c=(s.r||0)&7;if(e){c&&(A[0]=s.r>>3);for(var u=UD[e-1],h=u>>13,f=u&8191,g=(1<<t)-1,m=s.p||new Ts(32768),y=s.h||new Ts(g+1),b=Math.ceil(t/3),S=2*b,F=function(Le){return(n[Le]^n[Le+1]<<b^n[Le+2]<<S)&g},k=new K1(25e3),P=new Ts(288),te=new Ts(32),$=0,j=0,J=s.i||0,we=0,D=s.w||0,N=0;J+2<i;++J){var Z=F(J),se=J&32767,ce=y[Z];if(m[se]=ce,y[Z]=se,D<=J){var re=i-J;if(($>7e3||we>24576)&&(re>423||!d)){c=ob(n,A,0,k,P,te,j,we,N,J-N,c),we=$=j=0,N=J;for(var pe=0;pe<286;++pe)P[pe]=0;for(var pe=0;pe<30;++pe)te[pe]=0}var V=2,K=0,oe=f,ae=se-ce&32767;if(re>2&&Z==F(J-ae))for(var x=Math.min(h,re)-1,E=Math.min(32767,J),I=Math.min(258,re);ae<=E&&--oe&&se!=ce;){if(n[J+V]==n[J+V-ae]){for(var L=0;L<I&&n[J+L]==n[J+L-ae];++L);if(L>V){if(V=L,K=ae,L>x)break;for(var M=Math.min(ae,L-2),H=0,pe=0;pe<M;++pe){var q=J-ae+pe&32767,G=m[q],R=q-G&32767;R>H&&(H=R,ce=q)}}}se=ce,ce=m[se],ae+=se-ce&32767}if(K){k[we++]=268435456|mm[V]<<18|rb[K];var he=mm[V]&31,Be=rb[K]&31;j+=zg[he]+Cg[Be],++P[257+he],++te[Be],D=J+V,++$}else k[we++]=n[J],++P[n[J]]}}for(J=Math.max(J,D);J<i;++J)k[we++]=n[J],++P[n[J]];c=ob(n,A,d,k,P,te,j,we,N,J-N,c),d||(s.r=c&7|A[c/8|0]<<3,c-=7,s.h=y,s.p=m,s.i=J,s.w=D)}else{for(var J=s.w||0;J<i+d;J+=65535){var be=J+65535;be>=i&&(A[c/8|0]=d,be=i),c=Wx(A,c+1,n.subarray(J,be))}s.i=i}return Gx(a,0,r+$1(c)+o)},Yx=function(){var n=1,e=0;return{p:function(t){for(var r=n,o=e,s=t.length|0,i=0;i!=s;){for(var a=Math.min(i+2655,s);i<a;++i)o+=r+=t[i];r=(r&65535)+15*(r>>16),o=(o&65535)+15*(o>>16)}n=r,e=o},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},TD=function(n,e,t,r,o){if(!o&&(o={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),i=new Ho(s.length+n.length);i.set(s),i.set(n,s.length),n=i,o.w=s.length}return QD(n,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,o)},Jx=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},LD=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var o=Yx();o.p(e.dictionary),Jx(n,2,o.d())}},PD=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&ui(6,"invalid zlib data"),(n[1]>>5&1)==1&&ui(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function bm(n,e){e||(e={});var t=Yx();t.p(n);var r=TD(n,e,e.dictionary?6:2,4);return LD(r,e),Jx(r,r.length-4,t.d()),r}function kD(n,e){return ID(n.subarray(PD(n),-4),{i:2},e,e)}var OD=typeof TextDecoder<"u"&&new TextDecoder,DD=0;try{OD.decode(Xx,{stream:!0}),DD=1}catch{}var wr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Yv(){wr.console&&typeof wr.console.log=="function"&&wr.console.log.apply(wr.console,arguments)}var wn={log:Yv,warn:function(n){wr.console&&(typeof wr.console.warn=="function"?wr.console.warn.apply(wr.console,arguments):Yv.call(null,arguments))},error:function(n){wr.console&&(typeof wr.console.error=="function"?wr.console.error.apply(wr.console,arguments):Yv(n))}};function Jv(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){jA(r.response,e,t)},r.onerror=function(){wn.error("could not download file")},r.send()}function sb(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function Ff(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var hu,_m,jA=wr.saveAs||((typeof window>"u"?"undefined":ln(window))!=="object"||window!==wr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=wr.URL||wr.webkitURL,o=document.createElement("a");e=e||n.name||"download",o.download=e,o.rel="noopener",typeof n=="string"?(o.href=n,o.origin!==location.origin?sb(o.href)?Jv(n,e,t):Ff(o,o.target="_blank"):Ff(o)):(o.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){Ff(o)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(sb(n))Jv(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){Ff(r)})}else navigator.msSaveOrOpenBlob(function(o,s){return s===void 0?s={autoBom:!1}:ln(s)!=="object"&&(wn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return Jv(n,e,t);var o=n.type==="application/octet-stream",s=/constructor/i.test(wr.HTMLElement)||wr.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||o&&s)&&(typeof FileReader>"u"?"undefined":ln(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var c=a.result;c=i?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=c:location=c,r=null},a.readAsDataURL(n)}else{var A=wr.URL||wr.webkitURL,d=A.createObjectURL(n);r?r.location=d:location.href=d,r=null,setTimeout(function(){A.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function Zx(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var o=t[r].re,s=t[r].process,i=o.exec(n);i&&(e=s(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),A=this.g.toString(16),d=this.b.toString(16);return a.length==1&&(a="0"+a),A.length==1&&(A="0"+A),d.length==1&&(d="0"+d),"#"+a+A+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Zv(n,e){var t=n[0],r=n[1],o=n[2],s=n[3];t=Lo(t,r,o,s,e[0],7,-680876936),s=Lo(s,t,r,o,e[1],12,-389564586),o=Lo(o,s,t,r,e[2],17,606105819),r=Lo(r,o,s,t,e[3],22,-1044525330),t=Lo(t,r,o,s,e[4],7,-176418897),s=Lo(s,t,r,o,e[5],12,1200080426),o=Lo(o,s,t,r,e[6],17,-1473231341),r=Lo(r,o,s,t,e[7],22,-45705983),t=Lo(t,r,o,s,e[8],7,1770035416),s=Lo(s,t,r,o,e[9],12,-1958414417),o=Lo(o,s,t,r,e[10],17,-42063),r=Lo(r,o,s,t,e[11],22,-1990404162),t=Lo(t,r,o,s,e[12],7,1804603682),s=Lo(s,t,r,o,e[13],12,-40341101),o=Lo(o,s,t,r,e[14],17,-1502002290),t=Po(t,r=Lo(r,o,s,t,e[15],22,1236535329),o,s,e[1],5,-165796510),s=Po(s,t,r,o,e[6],9,-1069501632),o=Po(o,s,t,r,e[11],14,643717713),r=Po(r,o,s,t,e[0],20,-373897302),t=Po(t,r,o,s,e[5],5,-701558691),s=Po(s,t,r,o,e[10],9,38016083),o=Po(o,s,t,r,e[15],14,-660478335),r=Po(r,o,s,t,e[4],20,-405537848),t=Po(t,r,o,s,e[9],5,568446438),s=Po(s,t,r,o,e[14],9,-1019803690),o=Po(o,s,t,r,e[3],14,-187363961),r=Po(r,o,s,t,e[8],20,1163531501),t=Po(t,r,o,s,e[13],5,-1444681467),s=Po(s,t,r,o,e[2],9,-51403784),o=Po(o,s,t,r,e[7],14,1735328473),t=ko(t,r=Po(r,o,s,t,e[12],20,-1926607734),o,s,e[5],4,-378558),s=ko(s,t,r,o,e[8],11,-2022574463),o=ko(o,s,t,r,e[11],16,1839030562),r=ko(r,o,s,t,e[14],23,-35309556),t=ko(t,r,o,s,e[1],4,-1530992060),s=ko(s,t,r,o,e[4],11,1272893353),o=ko(o,s,t,r,e[7],16,-155497632),r=ko(r,o,s,t,e[10],23,-1094730640),t=ko(t,r,o,s,e[13],4,681279174),s=ko(s,t,r,o,e[0],11,-358537222),o=ko(o,s,t,r,e[3],16,-722521979),r=ko(r,o,s,t,e[6],23,76029189),t=ko(t,r,o,s,e[9],4,-640364487),s=ko(s,t,r,o,e[12],11,-421815835),o=ko(o,s,t,r,e[15],16,530742520),t=Oo(t,r=ko(r,o,s,t,e[2],23,-995338651),o,s,e[0],6,-198630844),s=Oo(s,t,r,o,e[7],10,1126891415),o=Oo(o,s,t,r,e[14],15,-1416354905),r=Oo(r,o,s,t,e[5],21,-57434055),t=Oo(t,r,o,s,e[12],6,1700485571),s=Oo(s,t,r,o,e[3],10,-1894986606),o=Oo(o,s,t,r,e[10],15,-1051523),r=Oo(r,o,s,t,e[1],21,-2054922799),t=Oo(t,r,o,s,e[8],6,1873313359),s=Oo(s,t,r,o,e[15],10,-30611744),o=Oo(o,s,t,r,e[6],15,-1560198380),r=Oo(r,o,s,t,e[13],21,1309151649),t=Oo(t,r,o,s,e[4],6,-145523070),s=Oo(s,t,r,o,e[11],10,-1120210379),o=Oo(o,s,t,r,e[2],15,718787259),r=Oo(r,o,s,t,e[9],21,-343485551),n[0]=cA(t,n[0]),n[1]=cA(r,n[1]),n[2]=cA(o,n[2]),n[3]=cA(s,n[3])}function Sg(n,e,t,r,o,s){return e=cA(cA(e,n),cA(r,s)),cA(e<<o|e>>>32-o,t)}function Lo(n,e,t,r,o,s,i){return Sg(e&t|~e&r,n,e,o,s,i)}function Po(n,e,t,r,o,s,i){return Sg(e&r|t&~r,n,e,o,s,i)}function ko(n,e,t,r,o,s,i){return Sg(e^t^r,n,e,o,s,i)}function Oo(n,e,t,r,o,s,i){return Sg(t^(e|~r),n,e,o,s,i)}function ez(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)Zv(r,ND(n.substring(e-64,e)));n=n.substring(e-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(Zv(r,o),e=0;e<16;e++)o[e]=0;return o[14]=8*t,Zv(r,o),r}function ND(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}hu=wr.atob.bind(wr),_m=wr.btoa.bind(wr);var ib="0123456789abcdef".split("");function MD(n){for(var e="",t=0;t<4;t++)e+=ib[n>>8*t+4&15]+ib[n>>8*t&15];return e}function HD(n){return String.fromCharCode((255&n)>>0,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function Bm(n){return ez(n).map(HD).join("")}var jD=function(n){for(var e=0;e<n.length;e++)n[e]=MD(n[e]);return n.join("")}(ez("hello"))!="5d41402abc4b2a76b9719d911017c592";function cA(n,e){if(jD){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function xm(n,e){var t,r,o,s;if(n!==t){for(var i=(o=n,s=1+(256/n.length>>0),new Array(s+1).join(o)),a=[],A=0;A<256;A++)a[A]=A;var d=0;for(A=0;A<256;A++){var c=a[A];d=(d+c+i.charCodeAt(A))%256,a[A]=a[d],a[d]=c}t=n,r=a}else a=r;var u=e.length,h=0,f=0,g="";for(A=0;A<u;A++)f=(f+(c=a[h=(h+1)%256]))%256,a[h]=a[f],a[f]=c,i=a[(a[h]+a[f])%256],g+=String.fromCharCode(e.charCodeAt(A)^i);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var ab={print:4,modify:8,copy:16,"annot-forms":32};function hd(n,e,t,r){this.v=1,this.r=2;var o=192;n.forEach(function(a){if(ab.perm!==void 0)throw new Error("Invalid permission: "+a);o+=ab[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),i=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^o)),this.encryptionKey=Bm(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=xm(this.encryptionKey,this.padding)}function fd(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var o=n.charCodeAt(r);o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?e+="#"+("0"+o.toString(16)).slice(-2):e+=n[r]}return e}function Ab(n){if(ln(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,o){if(o=o||!1,typeof t!="string"||typeof r!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[r,!!o],s},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),o=[];for(var s in e[t]){var i=e[t][s];try{i[0].apply(n,r)}catch(a){wr.console&&wn.error("jsPDF PubSub Error",a.message,a)}i[1]&&o.push(s)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Pp(n){if(!(this instanceof Pp))return new Pp(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function tz(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function WA(n,e,t,r,o){if(!(this instanceof WA))return new WA(n,e,t,r,o);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,tz.call(this,r,o)}function yd(n,e,t,r,o){if(!(this instanceof yd))return new yd(n,e,t,r,o);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,tz.call(this,r,o)}function gr(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],o=arguments[2],s=arguments[3],i=[],a=1,A=16,d="S",c=null;ln(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,o=n.format||o,s=n.compress||n.compressPdf||s,(c=n.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(A=n.floatPrecision),d=n.defaultPathOperation||"S"),i=n.filters||(s===!0?["FlateEncode"]:i),r=r||"mm",t=(""+(t||"P")).toLowerCase();var u=n.putOnlyUsedFonts||!1,h={},f={internal:{},__private__:{}};f.__private__.PubSub=Ab;var g="1.3",m=f.__private__.getPdfVersion=function(){return g};f.__private__.setPdfVersion=function(B){g=B};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};f.__private__.getPageFormats=function(){return y};var b=f.__private__.getPageFormat=function(B){return y[B]};o=o||"a4";var S={COMPAT:"compat",ADVANCED:"advanced"},F=S.COMPAT;function k(){this.saveGraphicsState(),O(new ot(Ne,0,0,-Ne,0,ka()*Ne).toString()+" cm"),this.setFontSize(this.getFontSize()/Ne),d="n",F=S.ADVANCED}function P(){this.restoreGraphicsState(),d="S",F=S.COMPAT}var te=f.__private__.combineFontStyleAndFontWeight=function(B,X){if(B=="bold"&&X=="normal"||B=="bold"&&X==400||B=="normal"&&X=="italic"||B=="bold"&&X=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return X&&(B=X==400||X==="normal"?B==="italic"?"italic":"normal":X!=700&&X!=="bold"||B!=="normal"?(X==700?"bold":X)+""+B:"bold"),B};f.advancedAPI=function(B){var X=F===S.COMPAT;return X&&k.call(this),typeof B!="function"||(B(this),X&&P.call(this)),this},f.compatAPI=function(B){var X=F===S.ADVANCED;return X&&P.call(this),typeof B!="function"||(B(this),X&&k.call(this)),this},f.isAdvancedAPI=function(){return F===S.ADVANCED};var $,j=function(B){if(F!==S.ADVANCED)throw new Error(B+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},J=f.roundToPrecision=f.__private__.roundToPrecision=function(B,X){var Pe=e||X;if(isNaN(B)||isNaN(Pe))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return B.toFixed(Pe).replace(/0+$/,"")};$=f.hpf=f.__private__.hpf=typeof A=="number"?function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return J(B,A)}:A==="smart"?function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return J(B,B>-1&&B<1?16:5)}:function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.hpf");return J(B,16)};var we=f.f2=f.__private__.f2=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.f2");return J(B,2)},D=f.__private__.f3=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.f3");return J(B,3)},N=f.scale=f.__private__.scale=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.scale");return F===S.COMPAT?B*Ne:F===S.ADVANCED?B:void 0},Z=function(B){return F===S.COMPAT?ka()-B:F===S.ADVANCED?B:void 0},se=function(B){return N(Z(B))};f.__private__.setPrecision=f.setPrecision=function(B){typeof parseInt(B,10)=="number"&&(e=parseInt(B,10))};var ce,re="00000000000000000000000000000000",pe=f.__private__.getFileId=function(){return re},V=f.__private__.setFileId=function(B){return re=B!==void 0&&/^[a-fA-F0-9]{32}$/.test(B)?B.toUpperCase():re.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),c!==null&&(Qn=new hd(c.userPermissions,c.userPassword,c.ownerPassword,re)),re};f.setFileId=function(B){return V(B),this},f.getFileId=function(){return pe()};var K=f.__private__.convertDateToPDFDate=function(B){var X=B.getTimezoneOffset(),Pe=X<0?"+":"-",qe=Math.floor(Math.abs(X/60)),st=Math.abs(X%60),bt=[Pe,I(qe),"'",I(st),"'"].join("");return["D:",B.getFullYear(),I(B.getMonth()+1),I(B.getDate()),I(B.getHours()),I(B.getMinutes()),I(B.getSeconds()),bt].join("")},oe=f.__private__.convertPDFDateToDate=function(B){var X=parseInt(B.substr(2,4),10),Pe=parseInt(B.substr(6,2),10)-1,qe=parseInt(B.substr(8,2),10),st=parseInt(B.substr(10,2),10),bt=parseInt(B.substr(12,2),10),Ot=parseInt(B.substr(14,2),10);return new Date(X,Pe,qe,st,bt,Ot,0)},ae=f.__private__.setCreationDate=function(B){var X;if(B===void 0&&(B=new Date),B instanceof Date)X=K(B);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(B))throw new Error("Invalid argument passed to jsPDF.setCreationDate");X=B}return ce=X},x=f.__private__.getCreationDate=function(B){var X=ce;return B==="jsDate"&&(X=oe(ce)),X};f.setCreationDate=function(B){return ae(B),this},f.getCreationDate=function(B){return x(B)};var E,I=f.__private__.padd2=function(B){return("0"+parseInt(B)).slice(-2)},L=f.__private__.padd2Hex=function(B){return("00"+(B=B.toString())).substr(B.length)},M=0,H=[],q=[],G=0,R=[],he=[],Be=!1,be=q,Le=function(){M=0,G=0,q=[],H=[],R=[],Ft=Pt(),zt=Pt()};f.__private__.setCustomOutputDestination=function(B){Be=!0,be=B};var Y=function(B){Be||(be=B)};f.__private__.resetCustomOutputDestination=function(){Be=!1,be=q};var O=f.__private__.out=function(B){return B=B.toString(),G+=B.length+1,be.push(B),be},ve=f.__private__.write=function(B){return O(arguments.length===1?B.toString():Array.prototype.join.call(arguments," "))},xe=f.__private__.getArrayBuffer=function(B){for(var X=B.length,Pe=new ArrayBuffer(X),qe=new Uint8Array(Pe);X--;)qe[X]=B.charCodeAt(X);return Pe},me=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];f.__private__.getStandardFonts=function(){return me};var le=n.fontSize||16;f.__private__.setFontSize=f.setFontSize=function(B){return le=F===S.ADVANCED?B/Ne:B,this};var ze,ke=f.__private__.getFontSize=f.getFontSize=function(){return F===S.COMPAT?le:le*Ne},de=n.R2L||!1;f.__private__.setR2L=f.setR2L=function(B){return de=B,this},f.__private__.getR2L=f.getR2L=function(){return de};var Fe,U=f.__private__.setZoomMode=function(B){var X=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(B))ze=B;else if(isNaN(B)){if(X.indexOf(B)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+B+'" is not recognized.');ze=B}else ze=parseInt(B,10)};f.__private__.getZoomMode=function(){return ze};var Ae,fe=f.__private__.setPageMode=function(B){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(B)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+B+'" is not recognized.');Fe=B};f.__private__.getPageMode=function(){return Fe};var Ce=f.__private__.setLayoutMode=function(B){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(B)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+B+'" is not recognized.');Ae=B};f.__private__.getLayoutMode=function(){return Ae},f.__private__.setDisplayMode=f.setDisplayMode=function(B,X,Pe){return U(B),Ce(X),fe(Pe),this};var ge={title:"",subject:"",author:"",keywords:"",creator:""};f.__private__.getDocumentProperty=function(B){if(Object.keys(ge).indexOf(B)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ge[B]},f.__private__.getDocumentProperties=function(){return ge},f.__private__.setDocumentProperties=f.setProperties=f.setDocumentProperties=function(B){for(var X in ge)ge.hasOwnProperty(X)&&B[X]&&(ge[X]=B[X]);return this},f.__private__.setDocumentProperty=function(B,X){if(Object.keys(ge).indexOf(B)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ge[B]=X};var De,Ne,Ze,Oe,Ke,Je={},Te={},_e=[],Ue={},Me={},je={},At={},ut=null,ht=0,Re=[],Xe=new Ab(f),tt=n.hotfixes||[],rt={},Bt={},nt=[],ot=function B(X,Pe,qe,st,bt,Ot){if(!(this instanceof B))return new B(X,Pe,qe,st,bt,Ot);isNaN(X)&&(X=1),isNaN(Pe)&&(Pe=0),isNaN(qe)&&(qe=0),isNaN(st)&&(st=1),isNaN(bt)&&(bt=0),isNaN(Ot)&&(Ot=0),this._matrix=[X,Pe,qe,st,bt,Ot]};Object.defineProperty(ot.prototype,"sx",{get:function(){return this._matrix[0]},set:function(B){this._matrix[0]=B}}),Object.defineProperty(ot.prototype,"shy",{get:function(){return this._matrix[1]},set:function(B){this._matrix[1]=B}}),Object.defineProperty(ot.prototype,"shx",{get:function(){return this._matrix[2]},set:function(B){this._matrix[2]=B}}),Object.defineProperty(ot.prototype,"sy",{get:function(){return this._matrix[3]},set:function(B){this._matrix[3]=B}}),Object.defineProperty(ot.prototype,"tx",{get:function(){return this._matrix[4]},set:function(B){this._matrix[4]=B}}),Object.defineProperty(ot.prototype,"ty",{get:function(){return this._matrix[5]},set:function(B){this._matrix[5]=B}}),Object.defineProperty(ot.prototype,"a",{get:function(){return this._matrix[0]},set:function(B){this._matrix[0]=B}}),Object.defineProperty(ot.prototype,"b",{get:function(){return this._matrix[1]},set:function(B){this._matrix[1]=B}}),Object.defineProperty(ot.prototype,"c",{get:function(){return this._matrix[2]},set:function(B){this._matrix[2]=B}}),Object.defineProperty(ot.prototype,"d",{get:function(){return this._matrix[3]},set:function(B){this._matrix[3]=B}}),Object.defineProperty(ot.prototype,"e",{get:function(){return this._matrix[4]},set:function(B){this._matrix[4]=B}}),Object.defineProperty(ot.prototype,"f",{get:function(){return this._matrix[5]},set:function(B){this._matrix[5]=B}}),Object.defineProperty(ot.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(ot.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(ot.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(ot.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),ot.prototype.join=function(B){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map($).join(B)},ot.prototype.multiply=function(B){var X=B.sx*this.sx+B.shy*this.shx,Pe=B.sx*this.shy+B.shy*this.sy,qe=B.shx*this.sx+B.sy*this.shx,st=B.shx*this.shy+B.sy*this.sy,bt=B.tx*this.sx+B.ty*this.shx+this.tx,Ot=B.tx*this.shy+B.ty*this.sy+this.ty;return new ot(X,Pe,qe,st,bt,Ot)},ot.prototype.decompose=function(){var B=this.sx,X=this.shy,Pe=this.shx,qe=this.sy,st=this.tx,bt=this.ty,Ot=Math.sqrt(B*B+X*X),Vt=(B/=Ot)*Pe+(X/=Ot)*qe;Pe-=B*Vt,qe-=X*Vt;var ir=Math.sqrt(Pe*Pe+qe*qe);return Vt/=ir,B*(qe/=ir)<X*(Pe/=ir)&&(B=-B,X=-X,Vt=-Vt,Ot=-Ot),{scale:new ot(Ot,0,0,ir,0,0),translate:new ot(1,0,0,1,st,bt),rotate:new ot(B,X,-X,B,0,0),skew:new ot(1,0,Vt,1,0,0)}},ot.prototype.toString=function(B){return this.join(" ")},ot.prototype.inversed=function(){var B=this.sx,X=this.shy,Pe=this.shx,qe=this.sy,st=this.tx,bt=this.ty,Ot=1/(B*qe-X*Pe),Vt=qe*Ot,ir=-X*Ot,Cr=-Pe*Ot,_r=B*Ot;return new ot(Vt,ir,Cr,_r,-Vt*st-Cr*bt,-ir*st-_r*bt)},ot.prototype.applyToPoint=function(B){var X=B.x*this.sx+B.y*this.shx+this.tx,Pe=B.x*this.shy+B.y*this.sy+this.ty;return new Cl(X,Pe)},ot.prototype.applyToRectangle=function(B){var X=this.applyToPoint(B),Pe=this.applyToPoint(new Cl(B.x+B.w,B.y+B.h));return new uc(X.x,X.y,Pe.x-X.x,Pe.y-X.y)},ot.prototype.clone=function(){var B=this.sx,X=this.shy,Pe=this.shx,qe=this.sy,st=this.tx,bt=this.ty;return new ot(B,X,Pe,qe,st,bt)},f.Matrix=ot;var xt=f.matrixMult=function(B,X){return X.multiply(B)},Lt=new ot(1,0,0,1,0,0);f.unitMatrix=f.identityMatrix=Lt;var _t=function(B,X){if(!Me[B]){var Pe=(X instanceof WA?"Sh":"P")+(Object.keys(Ue).length+1).toString(10);X.id=Pe,Me[B]=Pe,Ue[Pe]=X,Xe.publish("addPattern",X)}};f.ShadingPattern=WA,f.TilingPattern=yd,f.addShadingPattern=function(B,X){return j("addShadingPattern()"),_t(B,X),this},f.beginTilingPattern=function(B){j("beginTilingPattern()"),rh(B.boundingBox[0],B.boundingBox[1],B.boundingBox[2]-B.boundingBox[0],B.boundingBox[3]-B.boundingBox[1],B.matrix)},f.endTilingPattern=function(B,X){j("endTilingPattern()"),X.stream=he[E].join(`
`),_t(B,X),Xe.publish("endTilingPattern",X),nt.pop().restore()};var vt=f.__private__.newObject=function(){var B=Pt();return kt(B,!0),B},Pt=f.__private__.newObjectDeferred=function(){return M++,H[M]=function(){return G},M},kt=function(B,X){return X=typeof X=="boolean"&&X,H[B]=G,X&&O(B+" 0 obj"),B},Ct=f.__private__.newAdditionalObject=function(){var B={objId:Pt(),content:""};return R.push(B),B},Ft=Pt(),zt=Pt(),Tt=f.__private__.decodeColorString=function(B){var X=B.split(" ");if(X.length!==2||X[1]!=="g"&&X[1]!=="G")X.length===5&&(X[4]==="k"||X[4]==="K")&&(X=[(1-X[0])*(1-X[3]),(1-X[1])*(1-X[3]),(1-X[2])*(1-X[3]),"r"]);else{var Pe=parseFloat(X[0]);X=[Pe,Pe,Pe,"r"]}for(var qe="#",st=0;st<3;st++)qe+=("0"+Math.floor(255*parseFloat(X[st])).toString(16)).slice(-2);return qe},Rt=f.__private__.encodeColorString=function(B){var X;typeof B=="string"&&(B={ch1:B});var Pe=B.ch1,qe=B.ch2,st=B.ch3,bt=B.ch4,Ot=B.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Pe=="string"&&Pe.charAt(0)!=="#"){var Vt=new Zx(Pe);if(Vt.ok)Pe=Vt.toHex();else if(!/^\d*\.?\d*$/.test(Pe))throw new Error('Invalid color "'+Pe+'" passed to jsPDF.encodeColorString.')}if(typeof Pe=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Pe)&&(Pe="#"+Pe[1]+Pe[1]+Pe[2]+Pe[2]+Pe[3]+Pe[3]),typeof Pe=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Pe)){var ir=parseInt(Pe.substr(1),16);Pe=ir>>16&255,qe=ir>>8&255,st=255&ir}if(qe===void 0||bt===void 0&&Pe===qe&&qe===st)if(typeof Pe=="string")X=Pe+" "+Ot[0];else switch(B.precision){case 2:X=we(Pe/255)+" "+Ot[0];break;case 3:default:X=D(Pe/255)+" "+Ot[0]}else if(bt===void 0||ln(bt)==="object"){if(bt&&!isNaN(bt.a)&&bt.a===0)return X=["1.","1.","1.",Ot[1]].join(" ");if(typeof Pe=="string")X=[Pe,qe,st,Ot[1]].join(" ");else switch(B.precision){case 2:X=[we(Pe/255),we(qe/255),we(st/255),Ot[1]].join(" ");break;default:case 3:X=[D(Pe/255),D(qe/255),D(st/255),Ot[1]].join(" ")}}else if(typeof Pe=="string")X=[Pe,qe,st,bt,Ot[2]].join(" ");else switch(B.precision){case 2:X=[we(Pe),we(qe),we(st),we(bt),Ot[2]].join(" ");break;case 3:default:X=[D(Pe),D(qe),D(st),D(bt),Ot[2]].join(" ")}return X},Dt=f.__private__.getFilters=function(){return i},Mt=f.__private__.putStream=function(B){var X=(B=B||{}).data||"",Pe=B.filters||Dt(),qe=B.alreadyAppliedFilters||[],st=B.addLength1||!1,bt=X.length,Ot=B.objectId,Vt=function(To){return To};if(c!==null&&Ot===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(Vt=Qn.encryptor(Ot,0));var ir={};Pe===!0&&(Pe=["FlateEncode"]);var Cr=B.additionalKeyValues||[],_r=(ir=gr.API.processDataByFilters!==void 0?gr.API.processDataByFilters(X,Pe):{data:X,reverseChain:[]}).reverseChain+(Array.isArray(qe)?qe.join(" "):qe.toString());if(ir.data.length!==0&&(Cr.push({key:"Length",value:ir.data.length}),st===!0&&Cr.push({key:"Length1",value:bt})),_r.length!=0)if(_r.split("/").length-1==1)Cr.push({key:"Filter",value:_r});else{Cr.push({key:"Filter",value:"["+_r+"]"});for(var Rr=0;Rr<Cr.length;Rr+=1)if(Cr[Rr].key==="DecodeParms"){for(var Tn=[],Dn=0;Dn<ir.reverseChain.split("/").length-1;Dn+=1)Tn.push("null");Tn.push(Cr[Rr].value),Cr[Rr].value="["+Tn.join(" ")+"]"}}O("<<");for(var to=0;to<Cr.length;to++)O("/"+Cr[to].key+" "+Cr[to].value);O(">>"),ir.data.length!==0&&(O("stream"),O(Vt(ir.data)),O("endstream"))},Gt=f.__private__.putPage=function(B){var X=B.number,Pe=B.data,qe=B.objId,st=B.contentsObjId;kt(qe,!0),O("<</Type /Page"),O("/Parent "+B.rootDictionaryObjId+" 0 R"),O("/Resources "+B.resourceDictionaryObjId+" 0 R"),O("/MediaBox ["+parseFloat($(B.mediaBox.bottomLeftX))+" "+parseFloat($(B.mediaBox.bottomLeftY))+" "+$(B.mediaBox.topRightX)+" "+$(B.mediaBox.topRightY)+"]"),B.cropBox!==null&&O("/CropBox ["+$(B.cropBox.bottomLeftX)+" "+$(B.cropBox.bottomLeftY)+" "+$(B.cropBox.topRightX)+" "+$(B.cropBox.topRightY)+"]"),B.bleedBox!==null&&O("/BleedBox ["+$(B.bleedBox.bottomLeftX)+" "+$(B.bleedBox.bottomLeftY)+" "+$(B.bleedBox.topRightX)+" "+$(B.bleedBox.topRightY)+"]"),B.trimBox!==null&&O("/TrimBox ["+$(B.trimBox.bottomLeftX)+" "+$(B.trimBox.bottomLeftY)+" "+$(B.trimBox.topRightX)+" "+$(B.trimBox.topRightY)+"]"),B.artBox!==null&&O("/ArtBox ["+$(B.artBox.bottomLeftX)+" "+$(B.artBox.bottomLeftY)+" "+$(B.artBox.topRightX)+" "+$(B.artBox.topRightY)+"]"),typeof B.userUnit=="number"&&B.userUnit!==1&&O("/UserUnit "+B.userUnit),Xe.publish("putPage",{objId:qe,pageContext:Re[X],pageNumber:X,page:Pe}),O("/Contents "+st+" 0 R"),O(">>"),O("endobj");var bt=Pe.join(`
`);return F===S.ADVANCED&&(bt+=`
Q`),kt(st,!0),Mt({data:bt,filters:Dt(),objectId:st}),O("endobj"),qe},lr=f.__private__.putPages=function(){var B,X,Pe=[];for(B=1;B<=ht;B++)Re[B].objId=Pt(),Re[B].contentsObjId=Pt();for(B=1;B<=ht;B++)Pe.push(Gt({number:B,data:he[B],objId:Re[B].objId,contentsObjId:Re[B].contentsObjId,mediaBox:Re[B].mediaBox,cropBox:Re[B].cropBox,bleedBox:Re[B].bleedBox,trimBox:Re[B].trimBox,artBox:Re[B].artBox,userUnit:Re[B].userUnit,rootDictionaryObjId:Ft,resourceDictionaryObjId:zt}));kt(Ft,!0),O("<</Type /Pages");var qe="/Kids [";for(X=0;X<ht;X++)qe+=Pe[X]+" 0 R ";O(qe+"]"),O("/Count "+ht),O(">>"),O("endobj"),Xe.publish("postPutPages")},tr=function(B){Xe.publish("putFont",{font:B,out:O,newObject:vt,putStream:Mt}),B.isAlreadyPutted!==!0&&(B.objectNumber=vt(),O("<<"),O("/Type /Font"),O("/BaseFont /"+fd(B.postScriptName)),O("/Subtype /Type1"),typeof B.encoding=="string"&&O("/Encoding /"+B.encoding),O("/FirstChar 32"),O("/LastChar 255"),O(">>"),O("endobj"))},sr=function(){for(var B in Je)Je.hasOwnProperty(B)&&(u===!1||u===!0&&h.hasOwnProperty(B))&&tr(Je[B])},Ht=function(B){B.objectNumber=vt();var X=[];X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Form"}),X.push({key:"BBox",value:"["+[$(B.x),$(B.y),$(B.x+B.width),$(B.y+B.height)].join(" ")+"]"}),X.push({key:"Matrix",value:"["+B.matrix.toString()+"]"});var Pe=B.pages[1].join(`
`);Mt({data:Pe,additionalKeyValues:X,objectId:B.objectNumber}),O("endobj")},mr=function(){for(var B in rt)rt.hasOwnProperty(B)&&Ht(rt[B])},kr=function(B,X){var Pe,qe=[],st=1/(X-1);for(Pe=0;Pe<1;Pe+=st)qe.push(Pe);if(qe.push(1),B[0].offset!=0){var bt={offset:0,color:B[0].color};B.unshift(bt)}if(B[B.length-1].offset!=1){var Ot={offset:1,color:B[B.length-1].color};B.push(Ot)}for(var Vt="",ir=0,Cr=0;Cr<qe.length;Cr++){for(Pe=qe[Cr];Pe>B[ir+1].offset;)ir++;var _r=B[ir].offset,Rr=(Pe-_r)/(B[ir+1].offset-_r),Tn=B[ir].color,Dn=B[ir+1].color;Vt+=L(Math.round((1-Rr)*Tn[0]+Rr*Dn[0]).toString(16))+L(Math.round((1-Rr)*Tn[1]+Rr*Dn[1]).toString(16))+L(Math.round((1-Rr)*Tn[2]+Rr*Dn[2]).toString(16))}return Vt.trim()},Kr=function(B,X){X||(X=21);var Pe=vt(),qe=kr(B.colors,X),st=[];st.push({key:"FunctionType",value:"0"}),st.push({key:"Domain",value:"[0.0 1.0]"}),st.push({key:"Size",value:"["+X+"]"}),st.push({key:"BitsPerSample",value:"8"}),st.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),st.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Mt({data:qe,additionalKeyValues:st,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Pe}),O("endobj"),B.objectNumber=vt(),O("<< /ShadingType "+B.type),O("/ColorSpace /DeviceRGB");var bt="/Coords ["+$(parseFloat(B.coords[0]))+" "+$(parseFloat(B.coords[1]))+" ";B.type===2?bt+=$(parseFloat(B.coords[2]))+" "+$(parseFloat(B.coords[3])):bt+=$(parseFloat(B.coords[2]))+" "+$(parseFloat(B.coords[3]))+" "+$(parseFloat(B.coords[4]))+" "+$(parseFloat(B.coords[5])),O(bt+="]"),B.matrix&&O("/Matrix ["+B.matrix.toString()+"]"),O("/Function "+Pe+" 0 R"),O("/Extend [true true]"),O(">>"),O("endobj")},Sr=function(B,X){var Pe=Pt(),qe=vt();X.push({resourcesOid:Pe,objectOid:qe}),B.objectNumber=qe;var st=[];st.push({key:"Type",value:"/Pattern"}),st.push({key:"PatternType",value:"1"}),st.push({key:"PaintType",value:"1"}),st.push({key:"TilingType",value:"1"}),st.push({key:"BBox",value:"["+B.boundingBox.map($).join(" ")+"]"}),st.push({key:"XStep",value:$(B.xStep)}),st.push({key:"YStep",value:$(B.yStep)}),st.push({key:"Resources",value:Pe+" 0 R"}),B.matrix&&st.push({key:"Matrix",value:"["+B.matrix.toString()+"]"}),Mt({data:B.stream,additionalKeyValues:st,objectId:B.objectNumber}),O("endobj")},fr=function(B){var X;for(X in Ue)Ue.hasOwnProperty(X)&&(Ue[X]instanceof WA?Kr(Ue[X]):Ue[X]instanceof yd&&Sr(Ue[X],B))},Lr=function(B){for(var X in B.objectNumber=vt(),O("<<"),B)switch(X){case"opacity":O("/ca "+we(B[X]));break;case"stroke-opacity":O("/CA "+we(B[X]))}O(">>"),O("endobj")},xr=function(){var B;for(B in je)je.hasOwnProperty(B)&&Lr(je[B])},Ar=function(){for(var B in O("/XObject <<"),rt)rt.hasOwnProperty(B)&&rt[B].objectNumber>=0&&O("/"+B+" "+rt[B].objectNumber+" 0 R");Xe.publish("putXobjectDict"),O(">>")},pr=function(){Qn.oid=vt(),O("<<"),O("/Filter /Standard"),O("/V "+Qn.v),O("/R "+Qn.r),O("/U <"+Qn.toHexString(Qn.U)+">"),O("/O <"+Qn.toHexString(Qn.O)+">"),O("/P "+Qn.P),O(">>"),O("endobj")},Pr=function(){for(var B in O("/Font <<"),Je)Je.hasOwnProperty(B)&&(u===!1||u===!0&&h.hasOwnProperty(B))&&O("/"+B+" "+Je[B].objectNumber+" 0 R");O(">>")},gn=function(){if(Object.keys(Ue).length>0){for(var B in O("/Shading <<"),Ue)Ue.hasOwnProperty(B)&&Ue[B]instanceof WA&&Ue[B].objectNumber>=0&&O("/"+B+" "+Ue[B].objectNumber+" 0 R");Xe.publish("putShadingPatternDict"),O(">>")}},vn=function(B){if(Object.keys(Ue).length>0){for(var X in O("/Pattern <<"),Ue)Ue.hasOwnProperty(X)&&Ue[X]instanceof f.TilingPattern&&Ue[X].objectNumber>=0&&Ue[X].objectNumber<B&&O("/"+X+" "+Ue[X].objectNumber+" 0 R");Xe.publish("putTilingPatternDict"),O(">>")}},zr=function(){if(Object.keys(je).length>0){var B;for(B in O("/ExtGState <<"),je)je.hasOwnProperty(B)&&je[B].objectNumber>=0&&O("/"+B+" "+je[B].objectNumber+" 0 R");Xe.publish("putGStateDict"),O(">>")}},dr=function(B){kt(B.resourcesOid,!0),O("<<"),O("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Pr(),gn(),vn(B.objectOid),zr(),Ar(),O(">>"),O("endobj")},xn=function(){var B=[];sr(),xr(),mr(),fr(B),Xe.publish("putResources"),B.forEach(dr),dr({resourcesOid:zt,objectOid:Number.MAX_SAFE_INTEGER}),Xe.publish("postPutResources")},Fo=function(){Xe.publish("putAdditionalObjects");for(var B=0;B<R.length;B++){var X=R[B];kt(X.objId,!0),O(X.content),O("endobj")}Xe.publish("postPutAdditionalObjects")},io=function(B){Te[B.fontName]=Te[B.fontName]||{},Te[B.fontName][B.fontStyle]=B.id},bo=function(B,X,Pe,qe,st){var bt={id:"F"+(Object.keys(Je).length+1).toString(10),postScriptName:B,fontName:X,fontStyle:Pe,encoding:qe,isStandardFont:st||!1,metadata:{}};return Xe.publish("addFont",{font:bt,instance:this}),Je[bt.id]=bt,io(bt),bt.id},ns=function(B){for(var X=0,Pe=me.length;X<Pe;X++){var qe=bo.call(this,B[X][0],B[X][1],B[X][2],me[X][3],!0);u===!1&&(h[qe]=!0);var st=B[X][0].split("-");io({id:qe,fontName:st[0],fontStyle:st[1]||""})}Xe.publish("addFonts",{fonts:Je,dictionary:Te})},On=function(B){return B.foo=function(){try{return B.apply(this,arguments)}catch(qe){var X=qe.stack||"";~X.indexOf(" at ")&&(X=X.split(" at ")[1]);var Pe="Error in function "+X.split(`
`)[0].split("<")[0]+": "+qe.message;if(!wr.console)throw new Error(Pe);wr.console.error(Pe,qe),wr.alert&&alert(Pe)}},B.foo.bar=B,B.foo},Io=function(B,X){var Pe,qe,st,bt,Ot,Vt,ir,Cr,_r;if(st=(X=X||{}).sourceEncoding||"Unicode",Ot=X.outputEncoding,(X.autoencode||Ot)&&Je[De].metadata&&Je[De].metadata[st]&&Je[De].metadata[st].encoding&&(bt=Je[De].metadata[st].encoding,!Ot&&Je[De].encoding&&(Ot=Je[De].encoding),!Ot&&bt.codePages&&(Ot=bt.codePages[0]),typeof Ot=="string"&&(Ot=bt[Ot]),Ot)){for(ir=!1,Vt=[],Pe=0,qe=B.length;Pe<qe;Pe++)(Cr=Ot[B.charCodeAt(Pe)])?Vt.push(String.fromCharCode(Cr)):Vt.push(B[Pe]),Vt[Pe].charCodeAt(0)>>8&&(ir=!0);B=Vt.join("")}for(Pe=B.length;ir===void 0&&Pe!==0;)B.charCodeAt(Pe-1)>>8&&(ir=!0),Pe--;if(!ir)return B;for(Vt=X.noBOM?[]:[254,255],Pe=0,qe=B.length;Pe<qe;Pe++){if((_r=(Cr=B.charCodeAt(Pe))>>8)>>8)throw new Error("Character at position "+Pe+" of string '"+B+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Vt.push(_r),Vt.push(Cr-(_r<<8))}return String.fromCharCode.apply(void 0,Vt)},Wt=f.__private__.pdfEscape=f.pdfEscape=function(B,X){return Io(B,X).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},$r=f.__private__.beginPage=function(B){he[++ht]=[],Re[ht]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(B[0]),topRightY:Number(B[1])}},Uo(ht),Y(he[E])},Fn=function(B,X){var Pe,qe,st;switch(t=X||t,typeof B=="string"&&(Pe=b(B.toLowerCase()),Array.isArray(Pe)&&(qe=Pe[0],st=Pe[1])),Array.isArray(B)&&(qe=B[0]*Ne,st=B[1]*Ne),isNaN(qe)&&(qe=o[0],st=o[1]),(qe>14400||st>14400)&&(wn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),qe=Math.min(14400,qe),st=Math.min(14400,st)),o=[qe,st],t.substr(0,1)){case"l":st>qe&&(o=[st,qe]);break;case"p":qe>st&&(o=[st,qe])}$r(o),Yu(Ac),O(ri),dc!==0&&O(dc+" J"),cc!==0&&O(cc+" j"),Xe.publish("addPage",{pageNumber:ht})},ys=function(B){B>0&&B<=ht&&(he.splice(B,1),Re.splice(B,1),ht--,E>ht&&(E=ht),this.setPage(E))},Uo=function(B){B>0&&B<=ht&&(E=B)},bs=f.__private__.getNumberOfPages=f.getNumberOfPages=function(){return he.length-1},eo=function(B,X,Pe){var qe,st=void 0;return Pe=Pe||{},B=B!==void 0?B:Je[De].fontName,X=X!==void 0?X:Je[De].fontStyle,qe=B.toLowerCase(),Te[qe]!==void 0&&Te[qe][X]!==void 0?st=Te[qe][X]:Te[B]!==void 0&&Te[B][X]!==void 0?st=Te[B][X]:Pe.disableWarning===!1&&wn.warn("Unable to look up font label for font '"+B+"', '"+X+"'. Refer to getFontList() for available fonts."),st||Pe.noFallback||(st=Te.times[X])==null&&(st=Te.times.normal),st},ks=f.__private__.putInfo=function(){var B=vt(),X=function(qe){return qe};for(var Pe in c!==null&&(X=Qn.encryptor(B,0)),O("<<"),O("/Producer ("+Wt(X("jsPDF "+gr.version))+")"),ge)ge.hasOwnProperty(Pe)&&ge[Pe]&&O("/"+Pe.substr(0,1).toUpperCase()+Pe.substr(1)+" ("+Wt(X(ge[Pe]))+")");O("/CreationDate ("+Wt(X(ce))+")"),O(">>"),O("endobj")},Ci=f.__private__.putCatalog=function(B){var X=(B=B||{}).rootDictionaryObjId||Ft;switch(vt(),O("<<"),O("/Type /Catalog"),O("/Pages "+X+" 0 R"),ze||(ze="fullwidth"),ze){case"fullwidth":O("/OpenAction [3 0 R /FitH null]");break;case"fullheight":O("/OpenAction [3 0 R /FitV null]");break;case"fullpage":O("/OpenAction [3 0 R /Fit]");break;case"original":O("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Pe=""+ze;Pe.substr(Pe.length-1)==="%"&&(ze=parseInt(ze)/100),typeof ze=="number"&&O("/OpenAction [3 0 R /XYZ null null "+we(ze)+"]")}switch(Ae||(Ae="continuous"),Ae){case"continuous":O("/PageLayout /OneColumn");break;case"single":O("/PageLayout /SinglePage");break;case"two":case"twoleft":O("/PageLayout /TwoColumnLeft");break;case"tworight":O("/PageLayout /TwoColumnRight")}Fe&&O("/PageMode /"+Fe),Xe.publish("putCatalog"),O(">>"),O("endobj")},Si=f.__private__.putTrailer=function(){O("trailer"),O("<<"),O("/Size "+(M+1)),O("/Root "+M+" 0 R"),O("/Info "+(M-1)+" 0 R"),c!==null&&O("/Encrypt "+Qn.oid+" 0 R"),O("/ID [ <"+re+"> <"+re+"> ]"),O(">>")},EA=f.__private__.putHeader=function(){O("%PDF-"+g),O("%")},or=f.__private__.putXRef=function(){var B="0000000000";O("xref"),O("0 "+(M+1)),O("0000000000 65535 f ");for(var X=1;X<=M;X++)typeof H[X]=="function"?O((B+H[X]()).slice(-10)+" 00000 n "):H[X]!==void 0?O((B+H[X]).slice(-10)+" 00000 n "):O("0000000000 00000 n ")},on=f.__private__.buildDocument=function(){Le(),Y(q),Xe.publish("buildDocument"),EA(),lr(),Fo(),xn(),c!==null&&pr(),ks(),Ci();var B=G;return or(),Si(),O("startxref"),O(""+B),O("%%EOF"),Y(he[E]),q.join(`
`)},Qo=f.__private__.getBlob=function(B){return new Blob([xe(B)],{type:"application/pdf"})},Os=f.output=f.__private__.output=On(function(B,X){switch(typeof(X=X||{})=="string"?X={filename:X}:X.filename=X.filename||"generated.pdf",B){case void 0:return on();case"save":f.save(X.filename);break;case"arraybuffer":return xe(on());case"blob":return Qo(on());case"bloburi":case"bloburl":if(wr.URL!==void 0&&typeof wr.URL.createObjectURL=="function")return wr.URL&&wr.URL.createObjectURL(Qo(on()))||void 0;wn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Pe="",qe=on();try{Pe=_m(qe)}catch{Pe=_m(unescape(encodeURIComponent(qe)))}return"data:application/pdf;filename="+X.filename+";base64,"+Pe;case"pdfobjectnewwindow":if(Object.prototype.toString.call(wr)==="[object Window]"){var st="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';X.pdfObjectUrl&&(st=X.pdfObjectUrl,bt="");var Ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+st+'"'+bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(X)+");<\/script></body></html>",Vt=wr.open();return Vt!==null&&Vt.document.write(Ot),Vt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(wr)==="[object Window]"){var ir='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(X.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+X.filename+'" width="500px" height="400px" /></body></html>',Cr=wr.open();if(Cr!==null){Cr.document.write(ir);var _r=this;Cr.document.documentElement.querySelector("#pdfViewer").onload=function(){Cr.document.title=X.filename,Cr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(_r.output("bloburl"))}}return Cr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(wr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Rr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",X)+'"></iframe></body></html>',Tn=wr.open();if(Tn!==null&&(Tn.document.write(Rr),Tn.document.title=X.filename),Tn||typeof safari>"u")return Tn;break;case"datauri":case"dataurl":return wr.document.location.href=this.output("datauristring",X);default:return null}}),Ei=function(B){return Array.isArray(tt)===!0&&tt.indexOf(B)>-1};switch(r){case"pt":Ne=1;break;case"mm":Ne=72/25.4;break;case"cm":Ne=72/2.54;break;case"in":Ne=72;break;case"px":Ne=Ei("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ne=12;break;case"ex":Ne=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);Ne=r}var Qn=null;ae(),V();var ei=function(B){return c!==null?Qn.encryptor(B,0):function(X){return X}},Ta=f.__private__.getPageInfo=f.getPageInfo=function(B){if(isNaN(B)||B%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:Re[B].objId,pageNumber:B,pageContext:Re[B]}},yr=f.__private__.getPageInfoByObjId=function(B){if(isNaN(B)||B%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var X in Re)if(Re[X].objId===B)break;return Ta(X)},Qr=f.__private__.getCurrentPageInfo=f.getCurrentPageInfo=function(){return{objId:Re[E].objId,pageNumber:E,pageContext:Re[E]}};f.addPage=function(){return Fn.apply(this,arguments),this},f.setPage=function(){return Uo.apply(this,arguments),Y.call(this,he[E]),this},f.insertPage=function(B){return this.addPage(),this.movePage(E,B),this},f.movePage=function(B,X){var Pe,qe;if(B>X){Pe=he[B],qe=Re[B];for(var st=B;st>X;st--)he[st]=he[st-1],Re[st]=Re[st-1];he[X]=Pe,Re[X]=qe,this.setPage(X)}else if(B<X){Pe=he[B],qe=Re[B];for(var bt=B;bt<X;bt++)he[bt]=he[bt+1],Re[bt]=Re[bt+1];he[X]=Pe,Re[X]=qe,this.setPage(X)}return this},f.deletePage=function(){return ys.apply(this,arguments),this},f.__private__.text=f.text=function(B,X,Pe,qe,st){var bt,Ot,Vt,ir,Cr,_r,Rr,Tn,Dn,to=(qe=qe||{}).scope||this;if(typeof B=="number"&&typeof X=="number"&&(typeof Pe=="string"||Array.isArray(Pe))){var To=Pe;Pe=X,X=B,B=To}if(arguments[3]instanceof ot?(j("The transform parameter of text() with a Matrix value"),Dn=st):(Vt=arguments[4],ir=arguments[5],ln(Rr=arguments[3])==="object"&&Rr!==null||(typeof Vt=="string"&&(ir=Vt,Vt=null),typeof Rr=="string"&&(ir=Rr,Rr=null),typeof Rr=="number"&&(Vt=Rr,Rr=null),qe={flags:Rr,angle:Vt,align:ir})),isNaN(X)||isNaN(Pe)||B==null)throw new Error("Invalid arguments passed to jsPDF.text");if(B.length===0)return to;var ho="",ni=!1,Bs=typeof qe.lineHeightFactor=="number"?qe.lineHeightFactor:IA,Ui=to.internal.scaleFactor;function nh(bn){return bn=bn.split("	").join(Array(qe.TabLen||9).join(" ")),Wt(bn,Rr)}function gc(bn){for(var _n,qn=bn.concat(),ao=[],sa=qn.length;sa--;)typeof(_n=qn.shift())=="string"?ao.push(_n):Array.isArray(bn)&&(_n.length===1||_n[1]===void 0&&_n[2]===void 0)?ao.push(_n[0]):ao.push([_n[0],_n[1],_n[2]]);return ao}function vc(bn,_n){var qn;if(typeof bn=="string")qn=_n(bn)[0];else if(Array.isArray(bn)){for(var ao,sa,zc=bn.concat(),Ol=[],Ah=zc.length;Ah--;)typeof(ao=zc.shift())=="string"?Ol.push(_n(ao)[0]):Array.isArray(ao)&&typeof ao[0]=="string"&&(sa=_n(ao[0],ao[1],ao[2]),Ol.push([sa[0],sa[1],sa[2]]));qn=Ol}return qn}var El=!1,mc=!0;if(typeof B=="string")El=!0;else if(Array.isArray(B)){var wc=B.concat();Ot=[];for(var Fl,_o=wc.length;_o--;)(typeof(Fl=wc.shift())!="string"||Array.isArray(Fl)&&typeof Fl[0]!="string")&&(mc=!1);El=mc}if(El===!1)throw new Error('Type of text must be string or Array. "'+B+'" is not recognized.');typeof B=="string"&&(B=B.match(/[\r?\n]/)?B.split(/\r\n|\r|\n/g):[B]);var Il=le/to.internal.scaleFactor,Ul=Il*(Bs-1);switch(qe.baseline){case"bottom":Pe-=Ul;break;case"top":Pe+=Il-Ul;break;case"hanging":Pe+=Il-2*Ul;break;case"middle":Pe+=Il/2-Ul}if((_r=qe.maxWidth||0)>0&&(typeof B=="string"?B=to.splitTextToSize(B,_r):Object.prototype.toString.call(B)==="[object Array]"&&(B=B.reduce(function(bn,_n){return bn.concat(to.splitTextToSize(_n,_r))},[]))),bt={text:B,x:X,y:Pe,options:qe,mutex:{pdfEscape:Wt,activeFontKey:De,fonts:Je,activeFontSize:le}},Xe.publish("preProcessText",bt),B=bt.text,Vt=(qe=bt.options).angle,!(Dn instanceof ot)&&Vt&&typeof Vt=="number"){Vt*=Math.PI/180,qe.rotationDirection===0&&(Vt=-Vt),F===S.ADVANCED&&(Vt=-Vt);var Ql=Math.cos(Vt),yc=Math.sin(Vt);Dn=new ot(Ql,yc,-yc,Ql,0,0)}else Vt&&Vt instanceof ot&&(Dn=Vt);F!==S.ADVANCED||Dn||(Dn=Lt),(Cr=qe.charSpace||zl)!==void 0&&(ho+=$(N(Cr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Tn=qe.horizontalScale)!==void 0&&(ho+=$(100*Tn)+` Tz
`),qe.lang;var os=-1,jg=qe.renderingMode!==void 0?qe.renderingMode:qe.stroke,bc=to.internal.getCurrentPageInfo().pageContext;switch(jg){case 0:case!1:case"fill":os=0;break;case 1:case!0:case"stroke":os=1;break;case 2:case"fillThenStroke":os=2;break;case 3:case"invisible":os=3;break;case 4:case"fillAndAddForClipping":os=4;break;case 5:case"strokeAndAddPathForClipping":os=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":os=6;break;case 7:case"addToPathForClipping":os=7}var oh=bc.usedRenderingMode!==void 0?bc.usedRenderingMode:-1;os!==-1?ho+=os+` Tr
`:oh!==-1&&(ho+=`0 Tr
`),os!==-1&&(bc.usedRenderingMode=os),ir=qe.align||"left";var Ns,Tl=le*Bs,sh=to.internal.pageSize.getWidth(),ih=Je[De];Cr=qe.charSpace||zl,_r=qe.maxWidth||0,Rr=Object.assign({autoencode:!0,noBOM:!0},qe.flags);var Oa=[],TA=function(bn){return to.getStringUnitWidth(bn,{font:ih,charSpace:Cr,fontSize:le,doKerning:!1})*le/Ui};if(Object.prototype.toString.call(B)==="[object Array]"){var ss;Ot=gc(B),ir!=="left"&&(Ns=Ot.map(TA));var qo,Da=0;if(ir==="right"){X-=Ns[0],B=[],_o=Ot.length;for(var ra=0;ra<_o;ra++)ra===0?(qo=Ii(X),ss=ta(Pe)):(qo=N(Da-Ns[ra]),ss=-Tl),B.push([Ot[ra],qo,ss]),Da=Ns[ra]}else if(ir==="center"){X-=Ns[0]/2,B=[],_o=Ot.length;for(var na=0;na<_o;na++)na===0?(qo=Ii(X),ss=ta(Pe)):(qo=N((Da-Ns[na])/2),ss=-Tl),B.push([Ot[na],qo,ss]),Da=Ns[na]}else if(ir==="left"){B=[],_o=Ot.length;for(var Ll=0;Ll<_o;Ll++)B.push(Ot[Ll])}else if(ir==="justify"&&ih.encoding==="Identity-H"){B=[],_o=Ot.length,_r=_r!==0?_r:sh;for(var oa=0,Rn=0;Rn<_o;Rn++)if(ss=Rn===0?ta(Pe):-Tl,qo=Rn===0?Ii(X):oa,Rn<_o-1){var _c=N((_r-Ns[Rn])/(Ot[Rn].split(" ").length-1)),Ko=Ot[Rn].split(" ");B.push([Ko[0]+" ",qo,ss]),oa=0;for(var Ms=1;Ms<Ko.length;Ms++){var Pl=(TA(Ko[Ms-1]+" "+Ko[Ms])-TA(Ko[Ms]))*Ui+_c;Ms==Ko.length-1?B.push([Ko[Ms],Pl,0]):B.push([Ko[Ms]+" ",Pl,0]),oa-=Pl}}else B.push([Ot[Rn],qo,ss]);B.push(["",oa,0])}else{if(ir!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(B=[],_o=Ot.length,_r=_r!==0?_r:sh,Rn=0;Rn<_o;Rn++)ss=Rn===0?ta(Pe):-Tl,qo=Rn===0?Ii(X):0,Rn<_o-1?Oa.push($(N((_r-Ns[Rn])/(Ot[Rn].split(" ").length-1)))):Oa.push(0),B.push([Ot[Rn],qo,ss])}}var ah=typeof qe.R2L=="boolean"?qe.R2L:de;ah===!0&&(B=vc(B,function(bn,_n,qn){return[bn.split("").reverse().join(""),_n,qn]})),bt={text:B,x:X,y:Pe,options:qe,mutex:{pdfEscape:Wt,activeFontKey:De,fonts:Je,activeFontSize:le}},Xe.publish("postProcessText",bt),B=bt.text,ni=bt.mutex.isHex||!1;var Bc=Je[De].encoding;Bc!=="WinAnsiEncoding"&&Bc!=="StandardEncoding"||(B=vc(B,function(bn,_n,qn){return[nh(bn),_n,qn]})),Ot=gc(B),B=[];for(var LA,PA,Na,kA=0,kl=1,OA=Array.isArray(Ot[0])?kl:kA,Ma="",xc=function(bn,_n,qn){var ao="";return qn instanceof ot?(qn=typeof qe.angle=="number"?xt(qn,new ot(1,0,0,1,bn,_n)):xt(new ot(1,0,0,1,bn,_n),qn),F===S.ADVANCED&&(qn=xt(new ot(1,0,0,-1,0,0),qn)),ao=qn.join(" ")+` Tm
`):ao=$(bn)+" "+$(_n)+` Td
`,ao},Hs=0;Hs<Ot.length;Hs++){switch(Ma="",OA){case kl:Na=(ni?"<":"(")+Ot[Hs][0]+(ni?">":")"),LA=parseFloat(Ot[Hs][1]),PA=parseFloat(Ot[Hs][2]);break;case kA:Na=(ni?"<":"(")+Ot[Hs]+(ni?">":")"),LA=Ii(X),PA=ta(Pe)}Oa!==void 0&&Oa[Hs]!==void 0&&(Ma=Oa[Hs]+` Tw
`),Hs===0?B.push(Ma+xc(LA,PA,Dn)+Na):OA===kA?B.push(Ma+Na):OA===kl&&B.push(Ma+xc(LA,PA,Dn)+Na)}B=OA===kA?B.join(` Tj
T* `):B.join(` Tj
`),B+=` Tj
`;var js=`BT
/`;return js+=De+" "+le+` Tf
`,js+=$(le*Bs)+` TL
`,js+=UA+`
`,js+=ho,js+=B,O(js+="ET"),h[De]=!0,to};var Yr=f.__private__.clip=f.clip=function(B){return O(B==="evenodd"?"W*":"W"),this};f.clipEvenOdd=function(){return Yr("evenodd")},f.__private__.discardPath=f.discardPath=function(){return O("n"),this};var cn=f.__private__.isValidStyle=function(B){var X=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(B)!==-1&&(X=!0),X};f.__private__.setDefaultPathOperation=f.setDefaultPathOperation=function(B){return cn(B)&&(d=B),this};var _s=f.__private__.getStyle=f.getStyle=function(B){var X=d;switch(B){case"D":case"S":X="S";break;case"F":X="f";break;case"FD":case"DF":X="B";break;case"f":case"f*":case"B":case"B*":X=B}return X},ti=f.close=function(){return O("h"),this};f.stroke=function(){return O("S"),this},f.fill=function(B){return Ds("f",B),this},f.fillEvenOdd=function(B){return Ds("f*",B),this},f.fillStroke=function(B){return Ds("B",B),this},f.fillStrokeEvenOdd=function(B){return Ds("B*",B),this};var Ds=function(B,X){ln(X)==="object"?ic(X,B):O(B)},Fi=function(B){B===null||F===S.ADVANCED&&B===void 0||(B=_s(B),O(B))};function sc(B,X,Pe,qe,st){var bt=new yd(X||this.boundingBox,Pe||this.xStep,qe||this.yStep,this.gState,st||this.matrix);bt.stream=this.stream;var Ot=B+"$$"+this.cloneIndex+++"$$";return _t(Ot,bt),bt}var ic=function(B,X){var Pe=Me[B.key],qe=Ue[Pe];if(qe instanceof WA)O("q"),O(kg(X)),qe.gState&&f.setGState(qe.gState),O(B.matrix.toString()+" cm"),O("/"+Pe+" sh"),O("Q");else if(qe instanceof yd){var st=new ot(1,0,0,-1,0,ka());B.matrix&&(st=st.multiply(B.matrix||Lt),Pe=sc.call(qe,B.key,B.boundingBox,B.xStep,B.yStep,st).id),O("q"),O("/Pattern cs"),O("/"+Pe+" scn"),qe.gState&&f.setGState(qe.gState),O(X),O("Q")}},kg=function(B){switch(B){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},ac=f.moveTo=function(B,X){return O($(N(B))+" "+$(se(X))+" m"),this},FA=f.lineTo=function(B,X){return O($(N(B))+" "+$(se(X))+" l"),this},La=f.curveTo=function(B,X,Pe,qe,st,bt){return O([$(N(B)),$(se(X)),$(N(Pe)),$(se(qe)),$(N(st)),$(se(bt)),"c"].join(" ")),this};f.__private__.line=f.line=function(B,X,Pe,qe,st){if(isNaN(B)||isNaN(X)||isNaN(Pe)||isNaN(qe)||!cn(st))throw new Error("Invalid arguments passed to jsPDF.line");return F===S.COMPAT?this.lines([[Pe-B,qe-X]],B,X,[1,1],st||"S"):this.lines([[Pe-B,qe-X]],B,X,[1,1]).stroke()},f.__private__.lines=f.lines=function(B,X,Pe,qe,st,bt){var Ot,Vt,ir,Cr,_r,Rr,Tn,Dn,to,To,ho,ni;if(typeof B=="number"&&(ni=Pe,Pe=X,X=B,B=ni),qe=qe||[1,1],bt=bt||!1,isNaN(X)||isNaN(Pe)||!Array.isArray(B)||!Array.isArray(qe)||!cn(st)||typeof bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(ac(X,Pe),Ot=qe[0],Vt=qe[1],Cr=B.length,To=X,ho=Pe,ir=0;ir<Cr;ir++)(_r=B[ir]).length===2?(To=_r[0]*Ot+To,ho=_r[1]*Vt+ho,FA(To,ho)):(Rr=_r[0]*Ot+To,Tn=_r[1]*Vt+ho,Dn=_r[2]*Ot+To,to=_r[3]*Vt+ho,To=_r[4]*Ot+To,ho=_r[5]*Vt+ho,La(Rr,Tn,Dn,to,To,ho));return bt&&ti(),Fi(st),this},f.path=function(B){for(var X=0;X<B.length;X++){var Pe=B[X],qe=Pe.c;switch(Pe.op){case"m":ac(qe[0],qe[1]);break;case"l":FA(qe[0],qe[1]);break;case"c":La.apply(this,qe);break;case"h":ti()}}return this},f.__private__.rect=f.rect=function(B,X,Pe,qe,st){if(isNaN(B)||isNaN(X)||isNaN(Pe)||isNaN(qe)||!cn(st))throw new Error("Invalid arguments passed to jsPDF.rect");return F===S.COMPAT&&(qe=-qe),O([$(N(B)),$(se(X)),$(N(Pe)),$(N(qe)),"re"].join(" ")),Fi(st),this},f.__private__.triangle=f.triangle=function(B,X,Pe,qe,st,bt,Ot){if(isNaN(B)||isNaN(X)||isNaN(Pe)||isNaN(qe)||isNaN(st)||isNaN(bt)||!cn(Ot))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Pe-B,qe-X],[st-Pe,bt-qe],[B-st,X-bt]],B,X,[1,1],Ot,!0),this},f.__private__.roundedRect=f.roundedRect=function(B,X,Pe,qe,st,bt,Ot){if(isNaN(B)||isNaN(X)||isNaN(Pe)||isNaN(qe)||isNaN(st)||isNaN(bt)||!cn(Ot))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Vt=4/3*(Math.SQRT2-1);return st=Math.min(st,.5*Pe),bt=Math.min(bt,.5*qe),this.lines([[Pe-2*st,0],[st*Vt,0,st,bt-bt*Vt,st,bt],[0,qe-2*bt],[0,bt*Vt,-st*Vt,bt,-st,bt],[2*st-Pe,0],[-st*Vt,0,-st,-bt*Vt,-st,-bt],[0,2*bt-qe],[0,-bt*Vt,st*Vt,-bt,st,-bt]],B+st,X,[1,1],Ot,!0),this},f.__private__.ellipse=f.ellipse=function(B,X,Pe,qe,st){if(isNaN(B)||isNaN(X)||isNaN(Pe)||isNaN(qe)||!cn(st))throw new Error("Invalid arguments passed to jsPDF.ellipse");var bt=4/3*(Math.SQRT2-1)*Pe,Ot=4/3*(Math.SQRT2-1)*qe;return ac(B+Pe,X),La(B+Pe,X-Ot,B+bt,X-qe,B,X-qe),La(B-bt,X-qe,B-Pe,X-Ot,B-Pe,X),La(B-Pe,X+Ot,B-bt,X+qe,B,X+qe),La(B+bt,X+qe,B+Pe,X+Ot,B+Pe,X),Fi(st),this},f.__private__.circle=f.circle=function(B,X,Pe,qe){if(isNaN(B)||isNaN(X)||isNaN(Pe)||!cn(qe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(B,X,Pe,Pe,qe)},f.setFont=function(B,X,Pe){return Pe&&(X=te(X,Pe)),De=eo(B,X,{disableWarning:!1}),this};var Og=f.__private__.getFont=f.getFont=function(){return Je[eo.apply(f,arguments)]};f.__private__.getFontList=f.getFontList=function(){var B,X,Pe={};for(B in Te)if(Te.hasOwnProperty(B))for(X in Pe[B]=[],Te[B])Te[B].hasOwnProperty(X)&&Pe[B].push(X);return Pe},f.addFont=function(B,X,Pe,qe,st){var bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&bt.indexOf(arguments[3])!==-1?st=arguments[3]:arguments[3]&&bt.indexOf(arguments[3])==-1&&(Pe=te(Pe,qe)),st=st||"Identity-H",bo.call(this,B,X,Pe,st)};var IA,Ac=n.lineWidth||.200025,xl=f.__private__.getLineWidth=f.getLineWidth=function(){return Ac},Yu=f.__private__.setLineWidth=f.setLineWidth=function(B){return Ac=B,O($(N(B))+" w"),this};f.__private__.setLineDash=gr.API.setLineDash=gr.API.setLineDashPattern=function(B,X){if(B=B||[],X=X||0,isNaN(X)||!Array.isArray(B))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return B=B.map(function(Pe){return $(N(Pe))}).join(" "),X=$(N(X)),O("["+B+"] "+X+" d"),this};var Ju=f.__private__.getLineHeight=f.getLineHeight=function(){return le*IA};f.__private__.getLineHeight=f.getLineHeight=function(){return le*IA};var Zu=f.__private__.setLineHeightFactor=f.setLineHeightFactor=function(B){return typeof(B=B||1.15)=="number"&&(IA=B),this},eh=f.__private__.getLineHeightFactor=f.getLineHeightFactor=function(){return IA};Zu(n.lineHeight);var Ii=f.__private__.getHorizontalCoordinate=function(B){return N(B)},ta=f.__private__.getVerticalCoordinate=function(B){return F===S.ADVANCED?B:Re[E].mediaBox.topRightY-Re[E].mediaBox.bottomLeftY-N(B)},Dg=f.__private__.getHorizontalCoordinateString=f.getHorizontalCoordinateString=function(B){return $(Ii(B))},Pa=f.__private__.getVerticalCoordinateString=f.getVerticalCoordinateString=function(B){return $(ta(B))},ri=n.strokeColor||"0 G";f.__private__.getStrokeColor=f.getDrawColor=function(){return Tt(ri)},f.__private__.setStrokeColor=f.setDrawColor=function(B,X,Pe,qe){return ri=Rt({ch1:B,ch2:X,ch3:Pe,ch4:qe,pdfColorType:"draw",precision:2}),O(ri),this};var lc=n.fillColor||"0 g";f.__private__.getFillColor=f.getFillColor=function(){return Tt(lc)},f.__private__.setFillColor=f.setFillColor=function(B,X,Pe,qe){return lc=Rt({ch1:B,ch2:X,ch3:Pe,ch4:qe,pdfColorType:"fill",precision:2}),O(lc),this};var UA=n.textColor||"0 g",Ng=f.__private__.getTextColor=f.getTextColor=function(){return Tt(UA)};f.__private__.setTextColor=f.setTextColor=function(B,X,Pe,qe){return UA=Rt({ch1:B,ch2:X,ch3:Pe,ch4:qe,pdfColorType:"text",precision:3}),this};var zl=n.charSpace,Mg=f.__private__.getCharSpace=f.getCharSpace=function(){return parseFloat(zl||0)};f.__private__.setCharSpace=f.setCharSpace=function(B){if(isNaN(B))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return zl=B,this};var dc=0;f.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},f.__private__.setLineCap=f.setLineCap=function(B){var X=f.CapJoinStyles[B];if(X===void 0)throw new Error("Line cap style of '"+B+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return dc=X,O(X+" J"),this};var cc=0;f.__private__.setLineJoin=f.setLineJoin=function(B){var X=f.CapJoinStyles[B];if(X===void 0)throw new Error("Line join style of '"+B+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return cc=X,O(X+" j"),this},f.__private__.setLineMiterLimit=f.__private__.setMiterLimit=f.setLineMiterLimit=f.setMiterLimit=function(B){if(B=B||0,isNaN(B))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return O($(N(B))+" M"),this},f.GState=Pp,f.setGState=function(B){(B=typeof B=="string"?je[At[B]]:th(null,B)).equals(ut)||(O("/"+B.id+" gs"),ut=B)};var th=function(B,X){if(!B||!At[B]){var Pe=!1;for(var qe in je)if(je.hasOwnProperty(qe)&&je[qe].equals(X)){Pe=!0;break}if(Pe)X=je[qe];else{var st="GS"+(Object.keys(je).length+1).toString(10);je[st]=X,X.id=st}return B&&(At[B]=X.id),Xe.publish("addGState",X),X}};f.addGState=function(B,X){return th(B,X),this},f.saveGraphicsState=function(){return O("q"),_e.push({key:De,size:le,color:UA}),this},f.restoreGraphicsState=function(){O("Q");var B=_e.pop();return De=B.key,le=B.size,UA=B.color,ut=null,this},f.setCurrentTransformationMatrix=function(B){return O(B.toString()+" cm"),this},f.comment=function(B){return O("#"+B),this};var Cl=function(B,X){var Pe=B||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Pe},set:function(bt){isNaN(bt)||(Pe=parseFloat(bt))}});var qe=X||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return qe},set:function(bt){isNaN(bt)||(qe=parseFloat(bt))}});var st="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return st},set:function(bt){st=bt.toString()}}),this},uc=function(B,X,Pe,qe){Cl.call(this,B,X),this.type="rect";var st=Pe||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return st},set:function(Ot){isNaN(Ot)||(st=parseFloat(Ot))}});var bt=qe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return bt},set:function(Ot){isNaN(Ot)||(bt=parseFloat(Ot))}}),this},hc=function(){this.page=ht,this.currentPage=E,this.pages=he.slice(0),this.pagesContext=Re.slice(0),this.x=Ze,this.y=Oe,this.matrix=Ke,this.width=QA(E),this.height=ka(E),this.outputDestination=be,this.id="",this.objectNumber=-1};hc.prototype.restore=function(){ht=this.page,E=this.currentPage,Re=this.pagesContext,he=this.pages,Ze=this.x,Oe=this.y,Ke=this.matrix,fc(E,this.width),pc(E,this.height),be=this.outputDestination};var rh=function(B,X,Pe,qe,st){nt.push(new hc),ht=E=0,he=[],Ze=B,Oe=X,Ke=st,$r([Pe,qe])},Hg=function(B){if(Bt[B])nt.pop().restore();else{var X=new hc,Pe="Xo"+(Object.keys(rt).length+1).toString(10);X.id=Pe,Bt[B]=Pe,rt[Pe]=X,Xe.publish("addFormObject",X),nt.pop().restore()}};for(var Sl in f.beginFormObject=function(B,X,Pe,qe,st){return rh(B,X,Pe,qe,st),this},f.endFormObject=function(B){return Hg(B),this},f.doFormObject=function(B,X){var Pe=rt[Bt[B]];return O("q"),O(X.toString()+" cm"),O("/"+Pe.id+" Do"),O("Q"),this},f.getFormObject=function(B){var X=rt[Bt[B]];return{x:X.x,y:X.y,width:X.width,height:X.height,matrix:X.matrix}},f.save=function(B,X){return B=B||"generated.pdf",(X=X||{}).returnPromise=X.returnPromise||!1,X.returnPromise===!1?(jA(Qo(on()),B),typeof jA.unload=="function"&&wr.setTimeout&&setTimeout(jA.unload,911),this):new Promise(function(Pe,qe){try{var st=jA(Qo(on()),B);typeof jA.unload=="function"&&wr.setTimeout&&setTimeout(jA.unload,911),Pe(st)}catch(bt){qe(bt.message)}})},gr.API)gr.API.hasOwnProperty(Sl)&&(Sl==="events"&&gr.API.events.length?function(B,X){var Pe,qe,st;for(st=X.length-1;st!==-1;st--)Pe=X[st][0],qe=X[st][1],B.subscribe.apply(B,[Pe].concat(typeof qe=="function"?[qe]:qe))}(Xe,gr.API.events):f[Sl]=gr.API[Sl]);var QA=f.getPageWidth=function(B){return(Re[B=B||E].mediaBox.topRightX-Re[B].mediaBox.bottomLeftX)/Ne},fc=f.setPageWidth=function(B,X){Re[B].mediaBox.topRightX=X*Ne+Re[B].mediaBox.bottomLeftX},ka=f.getPageHeight=function(B){return(Re[B=B||E].mediaBox.topRightY-Re[B].mediaBox.bottomLeftY)/Ne},pc=f.setPageHeight=function(B,X){Re[B].mediaBox.topRightY=X*Ne+Re[B].mediaBox.bottomLeftY};return f.internal={pdfEscape:Wt,getStyle:_s,getFont:Og,getFontSize:ke,getCharSpace:Mg,getTextColor:Ng,getLineHeight:Ju,getLineHeightFactor:eh,getLineWidth:xl,write:ve,getHorizontalCoordinate:Ii,getVerticalCoordinate:ta,getCoordinateString:Dg,getVerticalCoordinateString:Pa,collections:{},newObject:vt,newAdditionalObject:Ct,newObjectDeferred:Pt,newObjectDeferredBegin:kt,getFilters:Dt,putStream:Mt,events:Xe,scaleFactor:Ne,pageSize:{getWidth:function(){return QA(E)},setWidth:function(B){fc(E,B)},getHeight:function(){return ka(E)},setHeight:function(B){pc(E,B)}},encryptionOptions:c,encryption:Qn,getEncryptor:ei,output:Os,getNumberOfPages:bs,pages:he,out:O,f2:we,f3:D,getPageInfo:Ta,getPageInfoByObjId:yr,getCurrentPageInfo:Qr,getPDFVersion:m,Point:Cl,Rectangle:uc,Matrix:ot,hasHotfix:Ei},Object.defineProperty(f.internal.pageSize,"width",{get:function(){return QA(E)},set:function(B){fc(E,B)},enumerable:!0,configurable:!0}),Object.defineProperty(f.internal.pageSize,"height",{get:function(){return ka(E)},set:function(B){pc(E,B)},enumerable:!0,configurable:!0}),ns.call(f,me),De="F1",Fn(o,t),Xe.publish("initialized"),f}hd.prototype.lsbFirstWord=function(n){return String.fromCharCode(n>>0&255,n>>8&255,n>>16&255,n>>24&255)},hd.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},hd.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},hd.prototype.processOwnerPassword=function(n,e){return xm(Bm(e).substr(0,5),n)},hd.prototype.encryptor=function(n,e){var t=Bm(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return xm(t,r)}},Pp.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||ln(n)!==ln(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},gr.API={events:[]},gr.version="3.0.0";var Mn=gr.API,V1=1,Bl=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ad=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Br=function(n){return n.toFixed(2)},Ja=function(n){return n.toFixed(5)};Mn.__acroform__={};var ws=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},lb=function(n){return n*V1},ki=function(n){var e=new nz,t=rr.internal.getHeight(n)||0,r=rr.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Br(r)),Number(Br(t))],e},RD=Mn.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|=1<<e},qD=Mn.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&=~(1<<e)},KD=Mn.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},Wn=Mn.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return KD(n,e-1)},Xn=Mn.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return RD(n,e-1)},Yn=Mn.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return qD(n,e-1)},$D=Mn.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,o=n[0],s=n[1],i=n[2],a=n[3],A={};return A.lowerLeft_X=t(o)||0,A.lowerLeft_Y=r(s+a)||0,A.upperRight_X=t(o+i)||0,A.upperRight_Y=r(s)||0,[Number(Br(A.lowerLeft_X)),Number(Br(A.lowerLeft_Y)),Number(Br(A.upperRight_X)),Number(Br(A.upperRight_Y))]},VD=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=zm(n,t),o=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+o+" "+Br(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=ki(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},zm=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},o=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");o=n.multiline?o.map(function(D){return D.split(`
`)}):o.map(function(D){return[D]});var s=t,i=rr.internal.getHeight(n)||0;i=i<0?-i:i;var a=rr.internal.getWidth(n)||0;a=a<0?-a:a;var A=function(D,N,Z){if(D+1<o.length){var se=N+" "+o[D+1][0];return If(se,n,Z).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var d,c,u=If("3",n,s).height,h=n.multiline?i-s:(i-u)/2,f=h+=2,g=0,m=0,y=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+If(e,n,s=12).width+", FieldWidth:"+a+`
`;break}for(var b="",S=0,F=0;F<o.length;F++)if(o.hasOwnProperty(F)){var k=!1;if(o[F].length!==1&&y!==o[F].length-1){if((u+2)*(S+2)+2>i)continue e;b+=o[F][y],k=!0,m=F,F--}else{b=(b+=o[F][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var P=parseInt(F),te=A(P,b,s),$=F>=o.length-1;if(te&&!$){b+=" ",y=0;continue}if(te||$){if($)m=P;else if(n.multiline&&(u+2)*(S+2)+2>i)continue e}else{if(!n.multiline||(u+2)*(S+2)+2>i)continue e;m=P}}for(var j="",J=g;J<=m;J++){var we=o[J];if(n.multiline){if(J===m){j+=we[y]+" ",y=(y+1)%we.length;continue}if(J===g){j+=we[we.length-1]+" ";continue}}j+=we[0]+" "}switch(j=j.substr(j.length-1)==" "?j.substr(0,j.length-1):j,c=If(j,n,s).width,n.textAlign){case"right":d=a-c-2;break;case"center":d=(a-c)/2;break;case"left":default:d=2}e+=Br(d)+" "+Br(f)+` Td
`,e+="("+Bl(j)+`) Tj
`,e+=-Br(d)+` 0 Td
`,f=-(s+2),c=0,g=k?m:m+1,S++,b=""}break}return r.text=e,r.fontSize=s,r},If=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),o=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:o}},GD={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},WD=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},XD=function(n,e){for(var t in n)if(n.hasOwnProperty(t)){var r=t,o=n[t];e.internal.newObjectDeferredBegin(o.objId,!0),ln(o)==="object"&&typeof o.putStream=="function"&&o.putStream(),delete n[r]}},YD=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(Bi.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(GD)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");V1=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new oz,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];s.objId=void 0,s.hasAnnotation&&WD(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,o){var s=!r;for(var i in r||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(i)){var a=r[i],A=[],d=a.Rect;if(a.Rect&&(a.Rect=$D(a.Rect,o)),o.internal.newObjectDeferredBegin(a.objId,!0),a.DA=rr.createDefaultAppearanceStream(a),ln(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(A=a.getKeyValueListForStream()),a.Rect=d,a.hasAppearanceStream&&!a.appearanceStreamContent){var c=VD(a);A.push({key:"AP",value:"<</N "+c+">>"}),o.internal.acroformPlugin.xForms.push(c)}if(a.appearanceStreamContent){var u="";for(var h in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(h)){var f=a.appearanceStreamContent[h];if(u+="/"+h+" ",u+="<<",Object.keys(f).length>=1||Array.isArray(f)){for(var i in f)if(f.hasOwnProperty(i)){var g=f[i];typeof g=="function"&&(g=g.call(o,a)),u+="/"+i+" "+g+" ",o.internal.acroformPlugin.xForms.indexOf(g)>=0||o.internal.acroformPlugin.xForms.push(g)}}else typeof(g=f)=="function"&&(g=g.call(o,a)),u+="/"+i+" "+g,o.internal.acroformPlugin.xForms.indexOf(g)>=0||o.internal.acroformPlugin.xForms.push(g);u+=">>"}A.push({key:"AP",value:`<<
`+u+">>"})}o.internal.putStream({additionalKeyValues:A,objectId:a.objId}),o.internal.out("endobj")}s&&XD(o.internal.acroformPlugin.xForms,o)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},rz=Mn.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(i){return i};if(Array.isArray(n)){for(var o="[",s=0;s<n.length;s++)switch(s!==0&&(o+=" "),ln(n[s])){case"boolean":case"number":case"object":o+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),o+="("+Bl(r(n[s].toString()))+")"):o+=n[s].toString()}return o+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},e0=function(n,e,t){var r=function(o){return o};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),n="("+Bl(r(n))+")"},Mi=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Mi.prototype.toString=function(){return this.objId+" 0 R"},Mi.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Mi.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],o=this[r];o&&(Array.isArray(o)?n.push({key:r,value:rz(o,this.objId,this.scope)}):o instanceof Mi?(o.scope=this.scope,n.push({key:r,value:o.objId+" 0 R"})):typeof o!="function"&&n.push({key:r,value:o}))}return n};var nz=function(){Mi.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};ws(nz,Mi);var oz=function(){Mi.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+Bl(t(n))+")"}},set:function(t){n=t}})};ws(oz,Mi);var Bi=function n(){Mi.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');e=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Wn(e,3)},set:function(b){b?this.F=Xn(e,3):this.F=Yn(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');t=b}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(b){r=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(b){r[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(b){r[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(b){r[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(b){r[3]=b}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof kp)return;s="FieldObject"+n.FieldNum++}var b=function(S){return S};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Bl(b(s))+")"},set:function(b){s=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(b){s=b}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(b){i=b}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(b){a=b}});var A=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return A},set:function(b){A=b}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/V1:d},set:function(b){d=b}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof kp||this instanceof ll))return e0(u,this.objId,this.scope)},set:function(b){b=b.toString(),u=b}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof wo?h:e0(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=this instanceof wo?b:b.substr(0,1)==="("?ad(b.substr(1,b.length-2)):ad(b)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof wo?ad(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof wo?"/"+b:b}});var f=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(f)return f},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(f)return this instanceof wo?f:e0(f,this.objId,this.scope)},set:function(b){b=b.toString(),f=this instanceof wo?b:b.substr(0,1)==="("?ad(b.substr(1,b.length-2)):ad(b)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof wo?ad(f.substr(1,f.length-1)):f},set:function(b){b=b.toString(),f=this instanceof wo?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,m=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return m},set:function(b){b=!!b,m=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(b){g=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,1)},set:function(b){b?this.Ff=Xn(this.Ff,1):this.Ff=Yn(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,2)},set:function(b){b?this.Ff=Xn(this.Ff,2):this.Ff=Yn(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,3)},set:function(b){b?this.Ff=Xn(this.Ff,3):this.Ff=Yn(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};ws(Bi,Mi);var Qd=function(){Bi.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return rz(e,this.objId,this.scope)},set:function(t){var r,o;o=[],typeof(r=t)=="string"&&(o=function(s,i,a){a||(a=1);for(var A,d=[];A=i.exec(s);)d.push(A[a]);return d}(r,/\((.*?)\)/g)),e=o}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,18)},set:function(t){t?this.Ff=Xn(this.Ff,18):this.Ff=Yn(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Xn(this.Ff,19):this.Ff=Yn(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,20)},set:function(t){t?(this.Ff=Xn(this.Ff,20),e.sort()):this.Ff=Yn(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,22)},set:function(t){t?this.Ff=Xn(this.Ff,22):this.Ff=Yn(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,23)},set:function(t){t?this.Ff=Xn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,27)},set:function(t){t?this.Ff=Xn(this.Ff,27):this.Ff=Yn(this.Ff,27)}}),this.hasAppearanceStream=!1};ws(Qd,Bi);var Td=function(){Qd.call(this),this.fontName="helvetica",this.combo=!1};ws(Td,Qd);var Ld=function(){Td.call(this),this.combo=!0};ws(Ld,Td);var Vf=function(){Ld.call(this),this.edit=!0};ws(Vf,Ld);var wo=function(){Bi.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,15)},set:function(t){t?this.Ff=Xn(this.Ff,15):this.Ff=Yn(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,16)},set:function(t){t?this.Ff=Xn(this.Ff,16):this.Ff=Yn(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,17)},set:function(t){t?this.Ff=Xn(this.Ff,17):this.Ff=Yn(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,26)},set:function(t){t?this.Ff=Xn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,o=[];for(r in o.push("<<"),e)o.push("/"+r+" ("+Bl(t(e[r]))+")");return o.push(">>"),o.join(`
`)}},set:function(t){ln(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};ws(wo,Bi);var Gf=function(){wo.call(this),this.pushButton=!0};ws(Gf,wo);var Pd=function(){wo.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};ws(Pd,wo);var kp=function(){var n,e;Bi.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(o){e=o}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(a){return a};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var s,i=[];for(s in i.push("<<"),r)i.push("/"+s+" ("+Bl(o(r[s]))+")");return i.push(">>"),i.join(`
`)},set:function(o){ln(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(o){t=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(o){t="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=rr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ws(kp,Bi),Pd.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},Pd.prototype.createOption=function(n){var e=new kp;return e.Parent=this,e.optionName=n,this.Kids.push(e),JD.call(this.scope,e),e};var Wf=function(){wo.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=rr.CheckBox.createAppearanceStream()};ws(Wf,wo);var ll=function(){Bi.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,13)},set:function(e){e?this.Ff=Xn(this.Ff,13):this.Ff=Yn(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,21)},set:function(e){e?this.Ff=Xn(this.Ff,21):this.Ff=Yn(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,23)},set:function(e){e?this.Ff=Xn(this.Ff,23):this.Ff=Yn(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,24)},set:function(e){e?this.Ff=Xn(this.Ff,24):this.Ff=Yn(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,25)},set:function(e){e?this.Ff=Xn(this.Ff,25):this.Ff=Yn(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,26)},set:function(e){e?this.Ff=Xn(this.Ff,26):this.Ff=Yn(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ws(ll,Bi);var Xf=function(){ll.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Wn(this.Ff,14)},set:function(n){n?this.Ff=Xn(this.Ff,14):this.Ff=Yn(this.Ff,14)}}),this.password=!0};ws(Xf,ll);var rr={CheckBox:{createAppearanceStream:function(){return{N:{On:rr.CheckBox.YesNormal},D:{On:rr.CheckBox.YesPushDown,Off:rr.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color),s=zm(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Br(rr.internal.getWidth(n))+" "+Br(rr.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+Br(s.fontSize)+" Tf "+o),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=ki(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),o=[],s=rr.internal.getHeight(n),i=rr.internal.getWidth(n),a=zm(n,n.caption);return o.push("1 g"),o.push("0 0 "+Br(i)+" "+Br(s)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+Br(i-1)+" "+Br(s-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+t+" "+Br(a.fontSize)+" Tf "+r),o.push(a.text),o.push("ET"),o.push("Q"),e.stream=o.join(`
`),e},OffPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Br(rr.internal.getWidth(n))+" "+Br(rr.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:rr.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=rr.RadioButton.Circle.YesNormal,e.D[n]=rr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=ki(n);e.scope=n.scope;var t=[],r=rr.internal.getWidth(n)<=rr.internal.getHeight(n)?rr.internal.getWidth(n)/4:rr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=rr.internal.Bezier_C,s=Number((r*o).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+Ja(rr.internal.getWidth(n)/2)+" "+Ja(rr.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=[],r=rr.internal.getWidth(n)<=rr.internal.getHeight(n)?rr.internal.getWidth(n)/4:rr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*rr.internal.Bezier_C).toFixed(5)),i=Number((r*rr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ja(rr.internal.getWidth(n)/2)+" "+Ja(rr.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+Ja(rr.internal.getWidth(n)/2)+" "+Ja(rr.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=[],r=rr.internal.getWidth(n)<=rr.internal.getHeight(n)?rr.internal.getWidth(n)/4:rr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*rr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+Ja(rr.internal.getWidth(n)/2)+" "+Ja(rr.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:rr.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=rr.RadioButton.Cross.YesNormal,e.D[n]=rr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=ki(n);e.scope=n.scope;var t=[],r=rr.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Br(rr.internal.getWidth(n)-2)+" "+Br(rr.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Br(r.x1.x)+" "+Br(r.x1.y)+" m"),t.push(Br(r.x2.x)+" "+Br(r.x2.y)+" l"),t.push(Br(r.x4.x)+" "+Br(r.x4.y)+" m"),t.push(Br(r.x3.x)+" "+Br(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=rr.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+Br(rr.internal.getWidth(n))+" "+Br(rr.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Br(rr.internal.getWidth(n)-2)+" "+Br(rr.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(Br(t.x1.x)+" "+Br(t.x1.y)+" m"),r.push(Br(t.x2.x)+" "+Br(t.x2.y)+" l"),r.push(Br(t.x4.x)+" "+Br(t.x4.y)+" m"),r.push(Br(t.x3.x)+" "+Br(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=ki(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Br(rr.internal.getWidth(n))+" "+Br(rr.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};rr.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=rr.internal.getWidth(n),t=rr.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},rr.internal.getWidth=function(n){var e=0;return ln(n)==="object"&&(e=lb(n.Rect[2])),e},rr.internal.getHeight=function(n){var e=0;return ln(n)==="object"&&(e=lb(n.Rect[3])),e};var JD=Mn.addField=function(n){if(YD(this,n),!(n instanceof Bi))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};Mn.AcroFormChoiceField=Qd,Mn.AcroFormListBox=Td,Mn.AcroFormComboBox=Ld,Mn.AcroFormEditBox=Vf,Mn.AcroFormButton=wo,Mn.AcroFormPushButton=Gf,Mn.AcroFormRadioButton=Pd,Mn.AcroFormCheckBox=Wf,Mn.AcroFormTextField=ll,Mn.AcroFormPasswordField=Xf,Mn.AcroFormAppearance=rr,Mn.AcroForm={ChoiceField:Qd,ListBox:Td,ComboBox:Ld,EditBox:Vf,Button:wo,PushButton:Gf,RadioButton:Pd,CheckBox:Wf,TextField:ll,PasswordField:Xf,Appearance:rr},gr.AcroForm={ChoiceField:Qd,ListBox:Td,ComboBox:Ld,EditBox:Vf,Button:wo,PushButton:Gf,RadioButton:Pd,CheckBox:Wf,TextField:ll,PasswordField:Xf,Appearance:rr};gr.AcroForm;function sz(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){n.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(D,N){var Z,se,ce,re,pe,V=e;if((N=N||e)==="RGBA"||D.data!==void 0&&D.data instanceof Uint8ClampedArray&&"height"in D&&"width"in D)return"RGBA";if(te(D))for(pe in t)for(ce=t[pe],Z=0;Z<ce.length;Z+=1){for(re=!0,se=0;se<ce[Z].length;se+=1)if(ce[Z][se]!==void 0&&ce[Z][se]!==D[se]){re=!1;break}if(re===!0){V=pe;break}}else for(pe in t)for(ce=t[pe],Z=0;Z<ce.length;Z+=1){for(re=!0,se=0;se<ce[Z].length;se+=1)if(ce[Z][se]!==void 0&&ce[Z][se]!==D.charCodeAt(se)){re=!1;break}if(re===!0){V=pe;break}}return V===e&&N!==e&&(V=N),V},o=function D(N){for(var Z=this.internal.write,se=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);N.objectId=this.internal.newObject();var re=[];if(re.push({key:"Type",value:"/XObject"}),re.push({key:"Subtype",value:"/Image"}),re.push({key:"Width",value:N.width}),re.push({key:"Height",value:N.height}),N.colorSpace===y.INDEXED?re.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(N.palette.length/3-1)+" "+("sMask"in N&&N.sMask!==void 0?N.objectId+2:N.objectId+1)+" 0 R]"}):(re.push({key:"ColorSpace",value:"/"+N.colorSpace}),N.colorSpace===y.DEVICE_CMYK&&re.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),re.push({key:"BitsPerComponent",value:N.bitsPerComponent}),"decodeParameters"in N&&N.decodeParameters!==void 0&&re.push({key:"DecodeParms",value:"<<"+N.decodeParameters+">>"}),"transparency"in N&&Array.isArray(N.transparency)){for(var pe="",V=0,K=N.transparency.length;V<K;V++)pe+=N.transparency[V]+" "+N.transparency[V]+" ";re.push({key:"Mask",value:"["+pe+"]"})}N.sMask!==void 0&&re.push({key:"SMask",value:N.objectId+1+" 0 R"});var oe=N.filter!==void 0?["/"+N.filter]:void 0;if(se({data:N.data,additionalKeyValues:re,alreadyAppliedFilters:oe,objectId:N.objectId}),Z("endobj"),"sMask"in N&&N.sMask!==void 0){var ae="/Predictor "+N.predictor+" /Colors 1 /BitsPerComponent "+N.bitsPerComponent+" /Columns "+N.width,x={width:N.width,height:N.height,colorSpace:"DeviceGray",bitsPerComponent:N.bitsPerComponent,decodeParameters:ae,data:N.sMask};"filter"in N&&(x.filter=N.filter),D.call(this,x)}if(N.colorSpace===y.INDEXED){var E=this.internal.newObject();se({data:j(new Uint8Array(N.palette)),objectId:E}),Z("endobj")}},s=function(){var D=this.internal.collections.addImage_images;for(var N in D)o.call(this,D[N])},i=function(){var D,N=this.internal.collections.addImage_images,Z=this.internal.write;for(var se in N)Z("/I"+(D=N[se]).index,D.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",i))},A=function(){var D=this.internal.collections.addImage_images;return a.call(this),D},d=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(D){return typeof n["process"+D.toUpperCase()]=="function"},u=function(D){return ln(D)==="object"&&D.nodeType===1},h=function(D,N){if(D.nodeName==="IMG"&&D.hasAttribute("src")){var Z=""+D.getAttribute("src");if(Z.indexOf("data:image/")===0)return hu(unescape(Z).split("base64,").pop());var se=n.loadFile(Z,!0);if(se!==void 0)return se}if(D.nodeName==="CANVAS"){if(D.width===0||D.height===0)throw new Error("Given canvas must have data. Canvas width: "+D.width+", height: "+D.height);var ce;switch(N){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;case"JPEG":case"JPG":default:ce="image/jpeg"}return hu(D.toDataURL(ce,1).split("base64,").pop())}},f=function(D){var N=this.internal.collections.addImage_images;if(N){for(var Z in N)if(D===N[Z].alias)return N[Z]}},g=function(D,N,Z){return D||N||(D=-96,N=-96),D<0&&(D=-1*Z.width*72/D/this.internal.scaleFactor),N<0&&(N=-1*Z.height*72/N/this.internal.scaleFactor),D===0&&(D=N*Z.width/Z.height),N===0&&(N=D*Z.height/Z.width),[D,N]},m=function(D,N,Z,se,ce,re){var pe=g.call(this,Z,se,ce),V=this.internal.getCoordinateString,K=this.internal.getVerticalCoordinateString,oe=A.call(this);if(Z=pe[0],se=pe[1],oe[ce.index]=ce,re){re*=Math.PI/180;var ae=Math.cos(re),x=Math.sin(re),E=function(L){return L.toFixed(4)},I=[E(ae),E(x),E(-1*x),E(ae),0,0,"cm"]}this.internal.write("q"),re?(this.internal.write([1,"0","0",1,V(D),K(N+se),"cm"].join(" ")),this.internal.write(I.join(" ")),this.internal.write([V(Z),"0","0",V(se),"0","0","cm"].join(" "))):this.internal.write([V(Z),"0","0",V(se),V(D),K(N+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},y=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=n.__addimage__.sHashCode=function(D){var N,Z,se=0;if(typeof D=="string")for(Z=D.length,N=0;N<Z;N++)se=(se<<5)-se+D.charCodeAt(N),se|=0;else if(te(D))for(Z=D.byteLength/2,N=0;N<Z;N++)se=(se<<5)-se+D[N],se|=0;return se},F=n.__addimage__.validateStringAsBase64=function(D){(D=D||"").toString().trim();var N=!0;return D.length===0&&(N=!1),D.length%4!=0&&(N=!1),/^[A-Za-z0-9+/]+$/.test(D.substr(0,D.length-2))===!1&&(N=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(D.substr(-2))===!1&&(N=!1),N},k=n.__addimage__.extractImageFromDataUrl=function(D){var N=(D=D||"").split("base64,"),Z=null;if(N.length===2){var se=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(N[0]);Array.isArray(se)&&(Z={mimeType:se[1],charset:se[2],data:N[1]})}return Z},P=n.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};n.__addimage__.isArrayBuffer=function(D){return P()&&D instanceof ArrayBuffer};var te=n.__addimage__.isArrayBufferView=function(D){return P()&&typeof Uint32Array<"u"&&(D instanceof Int8Array||D instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&D instanceof Uint8ClampedArray||D instanceof Int16Array||D instanceof Uint16Array||D instanceof Int32Array||D instanceof Uint32Array||D instanceof Float32Array||D instanceof Float64Array)},$=n.__addimage__.binaryStringToUint8Array=function(D){for(var N=D.length,Z=new Uint8Array(N),se=0;se<N;se++)Z[se]=D.charCodeAt(se);return Z},j=n.__addimage__.arrayBufferToBinaryString=function(D){for(var N="",Z=te(D)?D:new Uint8Array(D),se=0;se<Z.length;se+=8192)N+=String.fromCharCode.apply(null,Z.subarray(se,se+8192));return N};n.addImage=function(){var D,N,Z,se,ce,re,pe,V,K;if(typeof arguments[1]=="number"?(N=e,Z=arguments[1],se=arguments[2],ce=arguments[3],re=arguments[4],pe=arguments[5],V=arguments[6],K=arguments[7]):(N=arguments[1],Z=arguments[2],se=arguments[3],ce=arguments[4],re=arguments[5],pe=arguments[6],V=arguments[7],K=arguments[8]),ln(D=arguments[0])==="object"&&!u(D)&&"imageData"in D){var oe=D;D=oe.imageData,N=oe.format||N||e,Z=oe.x||Z||0,se=oe.y||se||0,ce=oe.w||oe.width||ce,re=oe.h||oe.height||re,pe=oe.alias||pe,V=oe.compression||V,K=oe.rotation||oe.angle||K}var ae=this.internal.getFilters();if(V===void 0&&ae.indexOf("FlateEncode")!==-1&&(V="SLOW"),isNaN(Z)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var x=J.call(this,D,N,pe,V);return m.call(this,Z,se,ce,re,x,K),this};var J=function(D,N,Z,se){var ce,re,pe;if(typeof D=="string"&&r(D)===e){D=unescape(D);var V=we(D,!1);(V!==""||(V=n.loadFile(D,!0))!==void 0)&&(D=V)}if(u(D)&&(D=h(D,N)),N=r(D,N),!c(N))throw new Error("addImage does not support files of type '"+N+"', please ensure that a plugin for '"+N+"' support is added.");if(((pe=Z)==null||pe.length===0)&&(Z=function(K){return typeof K=="string"||te(K)?S(K):te(K.data)?S(K.data):null}(D)),(ce=f.call(this,Z))||(P()&&(D instanceof Uint8Array||N==="RGBA"||(re=D,D=$(D))),ce=this["process"+N.toUpperCase()](D,d.call(this),Z,function(K){return K&&typeof K=="string"&&(K=K.toUpperCase()),K in n.image_compression?K:b.NONE}(se),re)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},we=n.__addimage__.convertBase64ToBinaryString=function(D,N){var Z;N=typeof N!="boolean"||N;var se,ce="";if(typeof D=="string"){se=(Z=k(D))!==null?Z.data:D;try{ce=hu(se)}catch(re){if(N)throw F(se)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+re.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return ce};n.getImageProperties=function(D){var N,Z,se="";if(u(D)&&(D=h(D)),typeof D=="string"&&r(D)===e&&((se=we(D,!1))===""&&(se=n.loadFile(D)||""),D=se),Z=r(D),!c(Z))throw new Error("addImage does not support files of type '"+Z+"', please ensure that a plugin for '"+Z+"' support is added.");if(!P()||D instanceof Uint8Array||(D=$(D)),!(N=this["process"+Z.toUpperCase()](D)))throw new Error("An unknown error occurred whilst processing the image");return N.fileType=Z,N}})(gr.API),function(n){var e=function(t){if(t!==void 0&&t!="")return!0};gr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,o,s,i=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,A=this.internal.getPageInfoByObjId(t.objId),d=t.pageContext.annotations,c=!1,u=0;u<d.length&&!c;u++)switch((r=d[u]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){r=d[h];var f=this.internal.pdfEscape,g=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var m=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(m.objId),S=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(o="/Rect ["+i(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+i(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+f(b(r.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+A.objId+" 0 R",s+=" /T ("+f(b(S))+") >>",m.content=s;var F=m.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+i(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+i(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+F,r.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(m.objId,"0 R",y.objId,"0 R");break;case"freetext":o="/Rect ["+i(r.bounds.x)+" "+a(r.bounds.y)+" "+i(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var k=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+f(g(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var P=this.annotations._nameMap[r.options.name];r.options.pageNumber=P.page,r.options.top=P.y}else r.options.top||(r.options.top=0);if(o="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+f(g(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var te=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+te+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,o,s,i){var a=this.internal.getCurrentPageInfo(),A=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:A(t),y:d(r),w:A(t+o),h:d(r+s)},options:i,type:"link"})},n.textWithLink=function(t,r,o,s){var i,a,A=this.getTextWidth(t),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var c=this.splitTextToSize(t,a).length;i=Math.ceil(d*c)}else a=A,i=d;return this.text(t,r,o,s),o+=.2*d,s.align==="center"&&(r-=A/2),s.align==="right"&&(r-=A),this.link(r,o-d,a,i,s),A},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}}(gr.API),function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(m){return e[m.charCodeAt(0)]!==void 0},i=n.__arabicParser__.isArabicLetter=function(m){return typeof m=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(m)},a=n.__arabicParser__.isArabicEndLetter=function(m){return i(m)&&s(m)&&e[m.charCodeAt(0)].length<=2},A=n.__arabicParser__.isArabicAlfLetter=function(m){return i(m)&&o.indexOf(m.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(m){return i(m)&&s(m)&&e[m.charCodeAt(0)].length>=1};var d=n.__arabicParser__.arabicLetterHasFinalForm=function(m){return i(m)&&s(m)&&e[m.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(m){return i(m)&&s(m)&&e[m.charCodeAt(0)].length>=3};var c=n.__arabicParser__.arabicLetterHasMedialForm=function(m){return i(m)&&s(m)&&e[m.charCodeAt(0)].length==4},u=n.__arabicParser__.resolveLigatures=function(m){var y=0,b=t,S="",F=0;for(y=0;y<m.length;y+=1)b[m.charCodeAt(y)]!==void 0?(F++,typeof(b=b[m.charCodeAt(y)])=="number"&&(S+=String.fromCharCode(b),b=t,F=0),y===m.length-1&&(b=t,S+=m.charAt(y-(F-1)),y-=F-1,F=0)):(b=t,S+=m.charAt(y-F),y-=F,F=0);return S};n.__arabicParser__.isArabicDiacritic=function(m){return m!==void 0&&r[m.charCodeAt(0)]!==void 0};var h=n.__arabicParser__.getCorrectForm=function(m,y,b){return i(m)?s(m)===!1?-1:!d(m)||!i(y)&&!i(b)||!i(b)&&a(y)||a(m)&&!i(y)||a(m)&&A(y)||a(m)&&a(y)?0:c(m)&&i(y)&&!a(y)&&i(b)&&d(b)?3:a(m)||!i(b)?1:2:-1},f=function(m){var y=0,b=0,S=0,F="",k="",P="",te=(m=m||"").split("\\s+"),$=[];for(y=0;y<te.length;y+=1){for($.push(""),b=0;b<te[y].length;b+=1)F=te[y][b],k=te[y][b-1],P=te[y][b+1],i(F)?(S=h(F,k,P),$[y]+=S!==-1?String.fromCharCode(e[F.charCodeAt(0)][S]):F):$[y]+=F;$[y]=u($[y])}return $.join(" ")},g=n.__arabicParser__.processArabic=n.processArabic=function(){var m,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var S=0;for(b=[],S=0;S<y.length;S+=1)Array.isArray(y[S])?b.push([f(y[S][0]),y[S][1],y[S][2]]):b.push([f(y[S])]);m=b}else m=f(y);return typeof arguments[0]=="string"?m:(arguments[0].text=m,arguments[0])};n.events.push(["preProcessText",g])}(gr.API),gr.API.autoPrint=function(n){var e;switch((n=n||{}).variant=n.variant||"non-conform",n.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(a){o=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(a){i=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var o;if((t=t||"2d")!=="2d")return null;for(o in r)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=r[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(gr.API),function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var A=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return A},set:function(m){A=m}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(m){d=m}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(m){c=m}});var u=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return u},set:function(m){u=m}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(m){h=m}});var f=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return f},set:function(m){f=m}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(m){g=m}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(A){return r.call(this),this.internal.__cell__.headerFunction=typeof A=="function"?A:void 0,this},n.getTextDimensions=function(A,d){r.call(this);var c=(d=d||{}).fontSize||this.getFontSize(),u=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,f=0,g=0,m=0,y=this;if(!Array.isArray(A)&&typeof A!="string"){if(typeof A!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");A=String(A)}var b=d.maxWidth;b>0?typeof A=="string"?A=this.splitTextToSize(A,b):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(F,k){return F.concat(y.splitTextToSize(k,b))},[])):A=Array.isArray(A)?A:[A];for(var S=0;S<A.length;S++)f<(m=this.getStringUnitWidth(A[S],{font:u})*c)&&(f=m);return f!==0&&(g=A.length),{w:f/=h,h:Math.max((g*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/h,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var A=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(A.left,A.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=n.cell=function(){var A;A=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,u=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,f=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===A.lineNumber?(A.x=(d.x||0)+(d.width||0),A.y=d.y||0):d.y+d.height+A.height+u.bottom>this.getPageHeight()?(this.cellAddPage(),A.y=u.top,f&&h&&(this.printHeaderRow(A.lineNumber,!0),A.y+=h[0].height)):A.y=d.y+d.height||A.y),A.text[0]!==void 0&&(this.rect(A.x,A.y,A.width,A.height,t===!0?"FD":void 0),A.align==="right"?this.text(A.text,A.x+A.width-c,A.y+c,{align:"right",baseline:"top"}):A.align==="center"?this.text(A.text,A.x+A.width/2,A.y+c,{align:"center",baseline:"top",maxWidth:A.width-c-c}):this.text(A.text,A.x+c,A.y+c,{align:"left",baseline:"top",maxWidth:A.width-c-c})),this.internal.__cell__.lastCell=A,this};n.table=function(A,d,c,u,h){if(r.call(this),!c)throw new Error("No data for PDF table.");var f,g,m,y,b=[],S=[],F=[],k={},P={},te=[],$=[],j=(h=h||{}).autoSize||!1,J=h.printHeaders!==!1,we=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,D=h.margins||Object.assign({width:this.getPageWidth()},e),N=typeof h.padding=="number"?h.padding:3,Z=h.headerBackgroundColor||"#c8c8c8",se=h.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=J,this.internal.__cell__.margins=D,this.internal.__cell__.table_font_size=we,this.internal.__cell__.padding=N,this.internal.__cell__.headerBackgroundColor=Z,this.internal.__cell__.headerTextColor=se,this.setFontSize(we),u==null)S=b=Object.keys(c[0]),F=b.map(function(){return"left"});else if(Array.isArray(u)&&ln(u[0])==="object")for(b=u.map(function(oe){return oe.name}),S=u.map(function(oe){return oe.prompt||oe.name||""}),F=u.map(function(oe){return oe.align||"left"}),f=0;f<u.length;f+=1)P[u[f].name]=u[f].width*(19.049976/25.4);else Array.isArray(u)&&typeof u[0]=="string"&&(S=b=u,F=b.map(function(){return"left"}));if(j||Array.isArray(u)&&typeof u[0]=="string")for(f=0;f<b.length;f+=1){for(k[y=b[f]]=c.map(function(oe){return oe[y]}),this.setFont(void 0,"bold"),te.push(this.getTextDimensions(S[f],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=k[y],this.setFont(void 0,"normal"),m=0;m<g.length;m+=1)te.push(this.getTextDimensions(g[m],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);P[y]=Math.max.apply(null,te)+N+N,te=[]}if(J){var ce={};for(f=0;f<b.length;f+=1)ce[b[f]]={},ce[b[f]].text=S[f],ce[b[f]].align=F[f];var re=a.call(this,ce,P);$=b.map(function(oe){return new s(A,d,P[oe],re,ce[oe].text,void 0,ce[oe].align)}),this.setTableHeaderRow($),this.printHeaderRow(1,!1)}var pe=u.reduce(function(oe,ae){return oe[ae.name]=ae.align,oe},{});for(f=0;f<c.length;f+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:f,data:c[f]},this);var V=a.call(this,c[f],P);for(m=0;m<b.length;m+=1){var K=c[f][b[m]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:f,col:m,data:K},this),i.call(this,new s(A,d,P[b[m]],V,K,f+2,pe[b[m]]))}}return this.internal.__cell__.table_x=A,this.internal.__cell__.table_y=d,this};var a=function(A,d){var c=this.internal.__cell__.padding,u=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(A).map(function(f){var g=A[f];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,d[f]-c-c)},this).map(function(f){return this.getLineHeightFactor()*f.length*u/h+c+c},this).reduce(function(f,g){return Math.max(f,g)},0)};n.setTableHeaderRow=function(A){r.call(this),this.internal.__cell__.tableHeaderRow=A},n.printHeaderRow=function(A,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var u=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(u[0],u[1],u[2],u[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],f=0;f<this.internal.__cell__.tableHeaderRow.length;f+=1){c=this.internal.__cell__.tableHeaderRow[f].clone(),d&&(c.y=this.internal.__cell__.margins.top||0,h.push(c)),c.lineNumber=A;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,c),this.setTextColor(g)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}}(gr.API);var iz={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},az=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Cm=sz(az),Az=[100,200,300,400,500,600,700,800,900],ZD=sz(Az);function Sm(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return iz[s=s||"normal"]?s:"normal"}(n.style),r=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(n.weight),o=function(s){return typeof Cm[s=s||"normal"]=="number"?s:"normal"}(n.stretch);return{family:e,style:t,weight:r,stretch:o,src:n.src||[],ref:n.ref||{name:e,style:[o,t,r].join(" ")}}}function db(n,e,t,r){var o;for(o=t;o>=0&&o<e.length;o+=r)if(n[e[o]])return n[e[o]];for(o=t;o>=0&&o<e.length;o-=r)if(n[e[o]])return n[e[o]]}var eN={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},cb={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function ub(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function tN(n,e,t){for(var r=(t=t||{}).defaultFontFamily||"times",o=Object.assign({},eN,t.genericFontFamilies||{}),s=null,i=null,a=0;a<e.length;++a)if(o[(s=Sm(e[a])).family]&&(s.family=o[s.family]),n.hasOwnProperty(s.family)){i=n[s.family];break}if(!(i=i||n[r]))throw new Error("Could not find a font-family for the rule '"+ub(s)+"' and default family '"+r+"'.");if(i=function(A,d){if(d[A])return d[A];var c=Cm[A],u=c<=Cm.normal?-1:1,h=db(d,az,c,u);if(!h)throw new Error("Could not find a matching font-stretch value for "+A);return h}(s.stretch,i),i=function(A,d){if(d[A])return d[A];for(var c=iz[A],u=0;u<c.length;++u)if(d[c[u]])return d[c[u]];throw new Error("Could not find a matching font-style for "+A)}(s.style,i),!(i=function(A,d){if(d[A])return d[A];if(A===400&&d[500])return d[500];if(A===500&&d[400])return d[400];var c=ZD[A],u=db(d,Az,c,A<400?-1:1);if(!u)throw new Error("Could not find a matching font-weight for value "+A);return u}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+ub(s)+"'.");return i}function hb(n){return n.trimLeft()}function rN(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function nN(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var Uf,fb,pb,t0=["times"];(function(n){var e,t,r,o,s,i,a,A,d,c=function(x){return x=x||{},this.isStrokeTransparent=x.isStrokeTransparent||!1,this.strokeOpacity=x.strokeOpacity||1,this.strokeStyle=x.strokeStyle||"#000000",this.fillStyle=x.fillStyle||"#000000",this.isFillTransparent=x.isFillTransparent||!1,this.fillOpacity=x.fillOpacity||1,this.font=x.font||"10px sans-serif",this.textBaseline=x.textBaseline||"alphabetic",this.textAlign=x.textAlign||"left",this.lineWidth=x.lineWidth||1,this.lineJoin=x.lineJoin||"miter",this.lineCap=x.lineCap||"butt",this.path=x.path||[],this.transform=x.transform!==void 0?x.transform.clone():new A,this.globalCompositeOperation=x.globalCompositeOperation||"normal",this.globalAlpha=x.globalAlpha||1,this.clip_path=x.clip_path||[],this.currentPoint=x.currentPoint||new i,this.miterLimit=x.miterLimit||10,this.lastPoint=x.lastPoint||new i,this.lineDashOffset=x.lineDashOffset||0,this.lineDash=x.lineDash||[],this.margin=x.margin||[0,0,0,0],this.prevPageLastElemOffset=x.prevPageLastElemOffset||0,this.ignoreClearRect=typeof x.ignoreClearRect!="boolean"||x.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new u(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,a=this.internal.Rectangle,A=this.internal.Matrix,d=new c}]);var u=function(x){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var E=x;Object.defineProperty(this,"pdf",{get:function(){return E}});var I=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return I},set:function(Y){I=!!Y}});var L=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return L},set:function(Y){L=!!Y}});var M=0;Object.defineProperty(this,"posX",{get:function(){return M},set:function(Y){isNaN(Y)||(M=Y)}});var H=0;Object.defineProperty(this,"posY",{get:function(){return H},set:function(Y){isNaN(Y)||(H=Y)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Y){var O;typeof Y=="number"?O=[Y,Y,Y,Y]:((O=new Array(4))[0]=Y[0],O[1]=Y.length>=2?Y[1]:O[0],O[2]=Y.length>=3?Y[2]:O[0],O[3]=Y.length>=4?Y[3]:O[1]),d.margin=O}});var q=!1;Object.defineProperty(this,"autoPaging",{get:function(){return q},set:function(Y){q=Y}});var G=0;Object.defineProperty(this,"lastBreak",{get:function(){return G},set:function(Y){G=Y}});var R=[];Object.defineProperty(this,"pageBreaks",{get:function(){return R},set:function(Y){R=Y}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Y){Y instanceof c&&(d=Y)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Y){d.path=Y}});var he=[];Object.defineProperty(this,"ctxStack",{get:function(){return he},set:function(Y){he=Y}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Y){var O;O=h(Y),this.ctx.fillStyle=O.style,this.ctx.isFillTransparent=O.a===0,this.ctx.fillOpacity=O.a,this.pdf.setFillColor(O.r,O.g,O.b,{a:O.a}),this.pdf.setTextColor(O.r,O.g,O.b,{a:O.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Y){var O=h(Y);this.ctx.strokeStyle=O.style,this.ctx.isStrokeTransparent=O.a===0,this.ctx.strokeOpacity=O.a,O.a===0?this.pdf.setDrawColor(255,255,255):(O.a,this.pdf.setDrawColor(O.r,O.g,O.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Y){["butt","round","square"].indexOf(Y)!==-1&&(this.ctx.lineCap=Y,this.pdf.setLineCap(Y))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Y){isNaN(Y)||(this.ctx.lineWidth=Y,this.pdf.setLineWidth(Y))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Y){["bevel","round","miter"].indexOf(Y)!==-1&&(this.ctx.lineJoin=Y,this.pdf.setLineJoin(Y))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Y){isNaN(Y)||(this.ctx.miterLimit=Y,this.pdf.setMiterLimit(Y))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Y){this.ctx.textBaseline=Y}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Y){["right","end","center","left","start"].indexOf(Y)!==-1&&(this.ctx.textAlign=Y)}});var Be=null;function be(Y,O){if(Be===null){var ve=function(xe){var me=[];return Object.keys(xe).forEach(function(le){xe[le].forEach(function(ze){var ke=null;switch(ze){case"bold":ke={family:le,weight:"bold"};break;case"italic":ke={family:le,style:"italic"};break;case"bolditalic":ke={family:le,weight:"bold",style:"italic"};break;case"":case"normal":ke={family:le}}ke!==null&&(ke.ref={name:le,style:ze},me.push(ke))})}),me}(Y.getFontList());Be=function(xe){for(var me={},le=0;le<xe.length;++le){var ze=Sm(xe[le]),ke=ze.family,de=ze.stretch,Fe=ze.style,U=ze.weight;me[ke]=me[ke]||{},me[ke][de]=me[ke][de]||{},me[ke][de][Fe]=me[ke][de][Fe]||{},me[ke][de][Fe][U]=ze}return me}(ve.concat(O))}return Be}var Le=null;Object.defineProperty(this,"fontFaces",{get:function(){return Le},set:function(Y){Be=null,Le=Y}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Y){var O;if(this.ctx.font=Y,(O=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Y))!==null){var ve=O[1],xe=(O[2],O[3]),me=O[4],le=(O[5],O[6]),ze=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(me)[2];me=Math.floor(ze==="px"?parseFloat(me)*this.pdf.internal.scaleFactor:ze==="em"?parseFloat(me)*this.pdf.getFontSize():parseFloat(me)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(me);var ke=function(ge){var De,Ne,Ze=[],Oe=ge.trim();if(Oe==="")return t0;if(Oe in cb)return[cb[Oe]];for(;Oe!=="";){switch(Ne=null,De=(Oe=hb(Oe)).charAt(0)){case'"':case"'":Ne=rN(Oe.substring(1),De);break;default:Ne=nN(Oe)}if(Ne===null||(Ze.push(Ne[0]),(Oe=hb(Ne[1]))!==""&&Oe.charAt(0)!==","))return t0;Oe=Oe.replace(/^,/,"")}return Ze}(le);if(this.fontFaces){var de=tN(be(this.pdf,this.fontFaces),ke.map(function(ge){return{family:ge,stretch:"normal",weight:xe,style:ve}}));this.pdf.setFont(de.ref.name,de.ref.style)}else{var Fe="";(xe==="bold"||parseInt(xe,10)>=700||ve==="bold")&&(Fe="bold"),ve==="italic"&&(Fe+="italic"),Fe.length===0&&(Fe="normal");for(var U="",Ae={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},fe=0;fe<ke.length;fe++){if(this.pdf.internal.getFont(ke[fe],Fe,{noFallback:!0,disableWarning:!0})!==void 0){U=ke[fe];break}if(Fe==="bolditalic"&&this.pdf.internal.getFont(ke[fe],"bold",{noFallback:!0,disableWarning:!0})!==void 0)U=ke[fe],Fe="bold";else if(this.pdf.internal.getFont(ke[fe],"normal",{noFallback:!0,disableWarning:!0})!==void 0){U=ke[fe],Fe="normal";break}}if(U===""){for(var Ce=0;Ce<ke.length;Ce++)if(Ae[ke[Ce]]){U=Ae[ke[Ce]];break}}U=U===""?"Times":U,this.pdf.setFont(U,Fe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Y){this.ctx.globalCompositeOperation=Y}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Y){this.ctx.globalAlpha=Y}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Y){this.ctx.lineDashOffset=Y,ae.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Y){this.ctx.lineDash=Y,ae.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Y){this.ctx.ignoreClearRect=!!Y}})};u.prototype.setLineDash=function(x){this.lineDash=x},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){k.call(this,"fill",!1)},u.prototype.stroke=function(){k.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(x,E){if(isNaN(x)||isNaN(E))throw wn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var I=this.ctx.transform.applyToPoint(new i(x,E));this.path.push({type:"mt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(x,E)},u.prototype.closePath=function(){var x=new i(0,0),E=0;for(E=this.path.length-1;E!==-1;E--)if(this.path[E].type==="begin"&&ln(this.path[E+1])==="object"&&typeof this.path[E+1].x=="number"){x=new i(this.path[E+1].x,this.path[E+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(x.x,x.y)},u.prototype.lineTo=function(x,E){if(isNaN(x)||isNaN(E))throw wn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var I=this.ctx.transform.applyToPoint(new i(x,E));this.path.push({type:"lt",x:I.x,y:I.y}),this.ctx.lastPoint=new i(I.x,I.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},u.prototype.quadraticCurveTo=function(x,E,I,L){if(isNaN(I)||isNaN(L)||isNaN(x)||isNaN(E))throw wn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var M=this.ctx.transform.applyToPoint(new i(I,L)),H=this.ctx.transform.applyToPoint(new i(x,E));this.path.push({type:"qct",x1:H.x,y1:H.y,x:M.x,y:M.y}),this.ctx.lastPoint=new i(M.x,M.y)},u.prototype.bezierCurveTo=function(x,E,I,L,M,H){if(isNaN(M)||isNaN(H)||isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L))throw wn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var q=this.ctx.transform.applyToPoint(new i(M,H)),G=this.ctx.transform.applyToPoint(new i(x,E)),R=this.ctx.transform.applyToPoint(new i(I,L));this.path.push({type:"bct",x1:G.x,y1:G.y,x2:R.x,y2:R.y,x:q.x,y:q.y}),this.ctx.lastPoint=new i(q.x,q.y)},u.prototype.arc=function(x,E,I,L,M,H){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L)||isNaN(M))throw wn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(H=!!H,!this.ctx.transform.isIdentity){var q=this.ctx.transform.applyToPoint(new i(x,E));x=q.x,E=q.y;var G=this.ctx.transform.applyToPoint(new i(0,I)),R=this.ctx.transform.applyToPoint(new i(0,0));I=Math.sqrt(Math.pow(G.x-R.x,2)+Math.pow(G.y-R.y,2))}Math.abs(M-L)>=2*Math.PI&&(L=0,M=2*Math.PI),this.path.push({type:"arc",x,y:E,radius:I,startAngle:L,endAngle:M,counterclockwise:H})},u.prototype.arcTo=function(x,E,I,L,M){throw new Error("arcTo not implemented.")},u.prototype.rect=function(x,E,I,L){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L))throw wn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(x,E),this.lineTo(x+I,E),this.lineTo(x+I,E+L),this.lineTo(x,E+L),this.lineTo(x,E),this.lineTo(x+I,E),this.lineTo(x,E)},u.prototype.fillRect=function(x,E,I,L){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L))throw wn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!f.call(this)){var M={};this.lineCap!=="butt"&&(M.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(M.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(x,E,I,L),this.fill(),M.hasOwnProperty("lineCap")&&(this.lineCap=M.lineCap),M.hasOwnProperty("lineJoin")&&(this.lineJoin=M.lineJoin)}},u.prototype.strokeRect=function(x,E,I,L){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L))throw wn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect(x,E,I,L),this.stroke())},u.prototype.clearRect=function(x,E,I,L){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L))throw wn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(x,E,I,L))},u.prototype.save=function(x){x=typeof x!="boolean"||x;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("q");if(this.pdf.setPage(E),x){this.ctx.fontSize=this.pdf.internal.getFontSize();var L=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=L}},u.prototype.restore=function(x){x=typeof x!="boolean"||x;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,I=0;I<this.pdf.internal.getNumberOfPages();I++)this.pdf.setPage(I+1),this.pdf.internal.out("Q");this.pdf.setPage(E),x&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(x){var E,I,L,M;if(x.isCanvasGradient===!0&&(x=x.getColor()),!x)return{r:0,g:0,b:0,a:0,style:x};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(x))E=0,I=0,L=0,M=0;else{var H=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(x);if(H!==null)E=parseInt(H[1]),I=parseInt(H[2]),L=parseInt(H[3]),M=1;else if((H=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(x))!==null)E=parseInt(H[1]),I=parseInt(H[2]),L=parseInt(H[3]),M=parseFloat(H[4]);else{if(M=1,typeof x=="string"&&x.charAt(0)!=="#"){var q=new Zx(x);x=q.ok?q.toHex():"#000000"}x.length===4?(E=x.substring(1,2),E+=E,I=x.substring(2,3),I+=I,L=x.substring(3,4),L+=L):(E=x.substring(1,3),I=x.substring(3,5),L=x.substring(5,7)),E=parseInt(E,16),I=parseInt(I,16),L=parseInt(L,16)}}return{r:E,g:I,b:L,a:M,style:x}},f=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};u.prototype.fillText=function(x,E,I,L){if(isNaN(E)||isNaN(I)||typeof x!="string")throw wn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(L=isNaN(L)?void 0:L,!f.call(this)){var M=V(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;N.call(this,{text:x,x:E,y:I,scale:H,angle:M,align:this.textAlign,maxWidth:L})}},u.prototype.strokeText=function(x,E,I,L){if(isNaN(E)||isNaN(I)||typeof x!="string")throw wn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){L=isNaN(L)?void 0:L;var M=V(this.ctx.transform.rotation),H=this.ctx.transform.scaleX;N.call(this,{text:x,x:E,y:I,scale:H,renderingMode:"stroke",angle:M,align:this.textAlign,maxWidth:L})}},u.prototype.measureText=function(x){if(typeof x!="string")throw wn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var E=this.pdf,I=this.pdf.internal.scaleFactor,L=E.internal.getFontSize(),M=E.getStringUnitWidth(x)*L/E.internal.scaleFactor,H=function(q){var G=(q=q||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return G}}),this};return new H({width:M*=Math.round(96*I/72*1e4)/1e4})},u.prototype.scale=function(x,E){if(isNaN(x)||isNaN(E))throw wn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var I=new A(x,0,0,E,0,0);this.ctx.transform=this.ctx.transform.multiply(I)},u.prototype.rotate=function(x){if(isNaN(x))throw wn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var E=new A(Math.cos(x),Math.sin(x),-Math.sin(x),Math.cos(x),0,0);this.ctx.transform=this.ctx.transform.multiply(E)},u.prototype.translate=function(x,E){if(isNaN(x)||isNaN(E))throw wn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var I=new A(1,0,0,1,x,E);this.ctx.transform=this.ctx.transform.multiply(I)},u.prototype.transform=function(x,E,I,L,M,H){if(isNaN(x)||isNaN(E)||isNaN(I)||isNaN(L)||isNaN(M)||isNaN(H))throw wn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var q=new A(x,E,I,L,M,H);this.ctx.transform=this.ctx.transform.multiply(q)},u.prototype.setTransform=function(x,E,I,L,M,H){x=isNaN(x)?1:x,E=isNaN(E)?0:E,I=isNaN(I)?0:I,L=isNaN(L)?1:L,M=isNaN(M)?0:M,H=isNaN(H)?0:H,this.ctx.transform=new A(x,E,I,L,M,H)};var m=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(x,E,I,L,M,H,q,G,R){var he=this.pdf.getImageProperties(x),Be=1,be=1,Le=1,Y=1;L!==void 0&&G!==void 0&&(Le=G/L,Y=R/M,Be=he.width/L*G/L,be=he.height/M*R/M),H===void 0&&(H=E,q=I,E=0,I=0),L!==void 0&&G===void 0&&(G=L,R=M),L===void 0&&G===void 0&&(G=he.width,R=he.height);for(var O,ve=this.ctx.transform.decompose(),xe=V(ve.rotate.shx),me=new A,le=(me=(me=(me=me.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale)).applyToRectangle(new a(H-E*Le,q-I*Y,L*Be,M*be)),ze=y.call(this,le),ke=[],de=0;de<ze.length;de+=1)ke.indexOf(ze[de])===-1&&ke.push(ze[de]);if(F(ke),this.autoPaging)for(var Fe=ke[0],U=ke[ke.length-1],Ae=Fe;Ae<U+1;Ae++){this.pdf.setPage(Ae);var fe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Ce=Ae===1?this.posY+this.margin[0]:this.margin[0],ge=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],De=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ne=Ae===1?0:ge+(Ae-2)*De;if(this.ctx.clip_path.length!==0){var Ze=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(O,this.posX+this.margin[3],-Ne+Ce+this.ctx.prevPageLastElemOffset),P.call(this,"fill",!0),this.path=Ze}var Oe=JSON.parse(JSON.stringify(le));Oe=S([Oe],this.posX+this.margin[3],-Ne+Ce+this.ctx.prevPageLastElemOffset)[0];var Ke=(Ae>Fe||Ae<U)&&m.call(this);Ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],fe,De,null).clip().discardPath()),this.pdf.addImage(x,"JPEG",Oe.x,Oe.y,Oe.w,Oe.h,null,null,xe),Ke&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(x,"JPEG",le.x,le.y,le.w,le.h,null,null,xe)};var y=function(x,E,I){var L=[];E=E||this.pdf.internal.pageSize.width,I=I||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var M=this.posY+this.ctx.prevPageLastElemOffset;switch(x.type){default:case"mt":case"lt":L.push(Math.floor((x.y+M)/I)+1);break;case"arc":L.push(Math.floor((x.y+M-x.radius)/I)+1),L.push(Math.floor((x.y+M+x.radius)/I)+1);break;case"qct":var H=K(this.ctx.lastPoint.x,this.ctx.lastPoint.y,x.x1,x.y1,x.x,x.y);L.push(Math.floor((H.y+M)/I)+1),L.push(Math.floor((H.y+H.h+M)/I)+1);break;case"bct":var q=oe(this.ctx.lastPoint.x,this.ctx.lastPoint.y,x.x1,x.y1,x.x2,x.y2,x.x,x.y);L.push(Math.floor((q.y+M)/I)+1),L.push(Math.floor((q.y+q.h+M)/I)+1);break;case"rect":L.push(Math.floor((x.y+M)/I)+1),L.push(Math.floor((x.y+x.h+M)/I)+1)}for(var G=0;G<L.length;G+=1)for(;this.pdf.internal.getNumberOfPages()<L[G];)b.call(this);return L},b=function(){var x=this.fillStyle,E=this.strokeStyle,I=this.font,L=this.lineCap,M=this.lineWidth,H=this.lineJoin;this.pdf.addPage(),this.fillStyle=x,this.strokeStyle=E,this.font=I,this.lineCap=L,this.lineWidth=M,this.lineJoin=H},S=function(x,E,I){for(var L=0;L<x.length;L++)switch(x[L].type){case"bct":x[L].x2+=E,x[L].y2+=I;case"qct":x[L].x1+=E,x[L].y1+=I;case"mt":case"lt":case"arc":default:x[L].x+=E,x[L].y+=I}return x},F=function(x){return x.sort(function(E,I){return E-I})},k=function(x,E){for(var I,L,M=this.fillStyle,H=this.strokeStyle,q=this.lineCap,G=this.lineWidth,R=Math.abs(G*this.ctx.transform.scaleX),he=this.lineJoin,Be=JSON.parse(JSON.stringify(this.path)),be=JSON.parse(JSON.stringify(this.path)),Le=[],Y=0;Y<be.length;Y++)if(be[Y].x!==void 0)for(var O=y.call(this,be[Y]),ve=0;ve<O.length;ve+=1)Le.indexOf(O[ve])===-1&&Le.push(O[ve]);for(var xe=0;xe<Le.length;xe++)for(;this.pdf.internal.getNumberOfPages()<Le[xe];)b.call(this);if(F(Le),this.autoPaging)for(var me=Le[0],le=Le[Le.length-1],ze=me;ze<le+1;ze++){this.pdf.setPage(ze),this.fillStyle=M,this.strokeStyle=H,this.lineCap=q,this.lineWidth=R,this.lineJoin=he;var ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],de=ze===1?this.posY+this.margin[0]:this.margin[0],Fe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],U=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ae=ze===1?0:Fe+(ze-2)*U;if(this.ctx.clip_path.length!==0){var fe=this.path;I=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(I,this.posX+this.margin[3],-Ae+de+this.ctx.prevPageLastElemOffset),P.call(this,x,!0),this.path=fe}if(L=JSON.parse(JSON.stringify(Be)),this.path=S(L,this.posX+this.margin[3],-Ae+de+this.ctx.prevPageLastElemOffset),E===!1||ze===0){var Ce=(ze>me||ze<le)&&m.call(this);Ce&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ke,U,null).clip().discardPath()),P.call(this,x,E),Ce&&this.pdf.restoreGraphicsState()}this.lineWidth=G}else this.lineWidth=R,P.call(this,x,E),this.lineWidth=G;this.path=Be},P=function(x,E){if((x!=="stroke"||E||!g.call(this))&&(x==="stroke"||E||!f.call(this))){for(var I,L,M=[],H=this.path,q=0;q<H.length;q++){var G=H[q];switch(G.type){case"begin":M.push({begin:!0});break;case"close":M.push({close:!0});break;case"mt":M.push({start:G,deltas:[],abs:[]});break;case"lt":var R=M.length;if(H[q-1]&&!isNaN(H[q-1].x)&&(I=[G.x-H[q-1].x,G.y-H[q-1].y],R>0)){for(;R>=0;R--)if(M[R-1].close!==!0&&M[R-1].begin!==!0){M[R-1].deltas.push(I),M[R-1].abs.push(G);break}}break;case"bct":I=[G.x1-H[q-1].x,G.y1-H[q-1].y,G.x2-H[q-1].x,G.y2-H[q-1].y,G.x-H[q-1].x,G.y-H[q-1].y],M[M.length-1].deltas.push(I);break;case"qct":var he=H[q-1].x+2/3*(G.x1-H[q-1].x),Be=H[q-1].y+2/3*(G.y1-H[q-1].y),be=G.x+2/3*(G.x1-G.x),Le=G.y+2/3*(G.y1-G.y),Y=G.x,O=G.y;I=[he-H[q-1].x,Be-H[q-1].y,be-H[q-1].x,Le-H[q-1].y,Y-H[q-1].x,O-H[q-1].y],M[M.length-1].deltas.push(I);break;case"arc":M.push({deltas:[],abs:[],arc:!0}),Array.isArray(M[M.length-1].abs)&&M[M.length-1].abs.push(G)}}L=E?null:x==="stroke"?"stroke":"fill";for(var ve=!1,xe=0;xe<M.length;xe++)if(M[xe].arc)for(var me=M[xe].abs,le=0;le<me.length;le++){var ze=me[le];ze.type==="arc"?j.call(this,ze.x,ze.y,ze.radius,ze.startAngle,ze.endAngle,ze.counterclockwise,void 0,E,!ve):Z.call(this,ze.x,ze.y),ve=!0}else if(M[xe].close===!0)this.pdf.internal.out("h"),ve=!1;else if(M[xe].begin!==!0){var ke=M[xe].start.x,de=M[xe].start.y;se.call(this,M[xe].deltas,ke,de),ve=!0}L&&J.call(this,L),E&&we.call(this)}},te=function(x){var E=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,I=E*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return x-I;case"top":return x+E-I;case"hanging":return x+E-2*I;case"middle":return x+E/2-I;case"ideographic":return x;case"alphabetic":default:return x}},$=function(x){return x+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var x=function(){};return x.colorStops=[],x.addColorStop=function(E,I){this.colorStops.push([E,I])},x.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},x.isCanvasGradient=!0,x},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var j=function(x,E,I,L,M,H,q,G,R){for(var he=re.call(this,I,L,M,H),Be=0;Be<he.length;Be++){var be=he[Be];Be===0&&(R?D.call(this,be.x1+x,be.y1+E):Z.call(this,be.x1+x,be.y1+E)),ce.call(this,x,E,be.x2,be.y2,be.x3,be.y3,be.x4,be.y4)}G?we.call(this):J.call(this,q)},J=function(x){switch(x){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},we=function(){this.pdf.clip(),this.pdf.discardPath()},D=function(x,E){this.pdf.internal.out(t(x)+" "+r(E)+" m")},N=function(x){var E;switch(x.align){case"right":case"end":E="right";break;case"center":E="center";break;case"left":case"start":default:E="left"}var I=this.pdf.getTextDimensions(x.text),L=te.call(this,x.y),M=$.call(this,L)-I.h,H=this.ctx.transform.applyToPoint(new i(x.x,L)),q=this.ctx.transform.decompose(),G=new A;G=(G=(G=G.multiply(q.translate)).multiply(q.skew)).multiply(q.scale);for(var R,he,Be,be=this.ctx.transform.applyToRectangle(new a(x.x,L,I.w,I.h)),Le=G.applyToRectangle(new a(x.x,M,I.w,I.h)),Y=y.call(this,Le),O=[],ve=0;ve<Y.length;ve+=1)O.indexOf(Y[ve])===-1&&O.push(Y[ve]);if(F(O),this.autoPaging)for(var xe=O[0],me=O[O.length-1],le=xe;le<me+1;le++){this.pdf.setPage(le);var ze=le===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],de=this.pdf.internal.pageSize.height-this.margin[2],Fe=de-this.margin[0],U=this.pdf.internal.pageSize.width-this.margin[1],Ae=U-this.margin[3],fe=le===1?0:ke+(le-2)*Fe;if(this.ctx.clip_path.length!==0){var Ce=this.path;R=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=S(R,this.posX+this.margin[3],-1*fe+ze),P.call(this,"fill",!0),this.path=Ce}var ge=S([JSON.parse(JSON.stringify(Le))],this.posX+this.margin[3],-fe+ze+this.ctx.prevPageLastElemOffset)[0];x.scale>=.01&&(he=this.pdf.internal.getFontSize(),this.pdf.setFontSize(he*x.scale),Be=this.lineWidth,this.lineWidth=Be*x.scale);var De=this.autoPaging!=="text";if(De||ge.y+ge.h<=de){if(De||ge.y>=ze&&ge.x<=U){var Ne=De?x.text:this.pdf.splitTextToSize(x.text,x.maxWidth||U-ge.x)[0],Ze=S([JSON.parse(JSON.stringify(be))],this.posX+this.margin[3],-fe+ze+this.ctx.prevPageLastElemOffset)[0],Oe=De&&(le>xe||le<me)&&m.call(this);Oe&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ae,Fe,null).clip().discardPath()),this.pdf.text(Ne,Ze.x,Ze.y,{angle:x.angle,align:E,renderingMode:x.renderingMode}),Oe&&this.pdf.restoreGraphicsState()}}else ge.y<de&&(this.ctx.prevPageLastElemOffset+=de-ge.y);x.scale>=.01&&(this.pdf.setFontSize(he),this.lineWidth=Be)}else x.scale>=.01&&(he=this.pdf.internal.getFontSize(),this.pdf.setFontSize(he*x.scale),Be=this.lineWidth,this.lineWidth=Be*x.scale),this.pdf.text(x.text,H.x+this.posX,H.y+this.posY,{angle:x.angle,align:E,renderingMode:x.renderingMode,maxWidth:x.maxWidth}),x.scale>=.01&&(this.pdf.setFontSize(he),this.lineWidth=Be)},Z=function(x,E,I,L){I=I||0,L=L||0,this.pdf.internal.out(t(x+I)+" "+r(E+L)+" l")},se=function(x,E,I){return this.pdf.lines(x,E,I,null,null)},ce=function(x,E,I,L,M,H,q,G){this.pdf.internal.out([e(o(I+x)),e(s(L+E)),e(o(M+x)),e(s(H+E)),e(o(q+x)),e(s(G+E)),"c"].join(" "))},re=function(x,E,I,L){for(var M=2*Math.PI,H=Math.PI/2;E>I;)E-=M;var q=Math.abs(I-E);q<M&&L&&(q=M-q);for(var G=[],R=L?-1:1,he=E;q>1e-5;){var Be=he+R*Math.min(q,H);G.push(pe.call(this,x,he,Be)),q-=Math.abs(Be-he),he=Be}return G},pe=function(x,E,I){var L=(I-E)/2,M=x*Math.cos(L),H=x*Math.sin(L),q=M,G=-H,R=q*q+G*G,he=R+q*M+G*H,Be=4/3*(Math.sqrt(2*R*he)-he)/(q*H-G*M),be=q-Be*G,Le=G+Be*q,Y=be,O=-Le,ve=L+E,xe=Math.cos(ve),me=Math.sin(ve);return{x1:x*Math.cos(E),y1:x*Math.sin(E),x2:be*xe-Le*me,y2:be*me+Le*xe,x3:Y*xe-O*me,y3:Y*me+O*xe,x4:x*Math.cos(I),y4:x*Math.sin(I)}},V=function(x){return 180*x/Math.PI},K=function(x,E,I,L,M,H){var q=x+.5*(I-x),G=E+.5*(L-E),R=M+.5*(I-M),he=H+.5*(L-H),Be=Math.min(x,M,q,R),be=Math.max(x,M,q,R),Le=Math.min(E,H,G,he),Y=Math.max(E,H,G,he);return new a(Be,Le,be-Be,Y-Le)},oe=function(x,E,I,L,M,H,q,G){var R,he,Be,be,Le,Y,O,ve,xe,me,le,ze,ke,de,Fe=I-x,U=L-E,Ae=M-I,fe=H-L,Ce=q-M,ge=G-H;for(he=0;he<41;he++)xe=(O=(Be=x+(R=he/40)*Fe)+R*((Le=I+R*Ae)-Be))+R*(Le+R*(M+R*Ce-Le)-O),me=(ve=(be=E+R*U)+R*((Y=L+R*fe)-be))+R*(Y+R*(H+R*ge-Y)-ve),he==0?(le=xe,ze=me,ke=xe,de=me):(le=Math.min(le,xe),ze=Math.min(ze,me),ke=Math.max(ke,xe),de=Math.max(de,me));return new a(Math.round(le),Math.round(ze),Math.round(ke-le),Math.round(de-ze))},ae=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var x,E,I=(x=this.ctx.lineDash,E=this.ctx.lineDashOffset,JSON.stringify({lineDash:x,lineDashOffset:E}));this.prevLineDash!==I&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=I)}}})(gr.API),function(n){var e=function(s){var i,a,A,d,c,u,h,f,g,m;for(a=[],A=0,d=(s+=i="\0\0\0\0".slice(s.length%4||4)).length;d>A;A+=4)(c=(s.charCodeAt(A)<<24)+(s.charCodeAt(A+1)<<16)+(s.charCodeAt(A+2)<<8)+s.charCodeAt(A+3))!==0?(u=(c=((c=((c=((c=(c-(m=c%85))/85)-(g=c%85))/85)-(f=c%85))/85)-(h=c%85))/85)%85,a.push(u+33,h+33,f+33,g+33,m+33)):a.push(122);return function(y,b){for(var S=b;S>0;S--)y.pop()}(a,i.length),String.fromCharCode.apply(String,a)+"~>"},t=function(s){var i,a,A,d,c,u=String,h="length",f=255,g="charCodeAt",m="slice",y="replace";for(s[m](-2),s=s[m](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),A=[],d=0,c=(s+=i="uuuuu"[m](s[h]%5||5))[h];c>d;d+=5)a=52200625*(s[g](d)-33)+614125*(s[g](d+1)-33)+7225*(s[g](d+2)-33)+85*(s[g](d+3)-33)+(s[g](d+4)-33),A.push(f&a>>24,f&a>>16,f&a>>8,f&a);return function(b,S){for(var F=S;F>0;F--)b.pop()}(A,i[h]),u.fromCharCode.apply(u,A)},r=function(s){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),i.test(s)===!1)return"";for(var a="",A=0;A<s.length;A+=2)a+=String.fromCharCode("0x"+(s[A]+s[A+1]));return a},o=function(s){for(var i=new Uint8Array(s.length),a=s.length;a--;)i[a]=s.charCodeAt(a);return s=(i=bm(i)).reduce(function(A,d){return A+String.fromCharCode(d)},"")};n.processDataByFilters=function(s,i){var a=0,A=s||"",d=[];for(typeof(i=i||[])=="string"&&(i=[i]),a=0;a<i.length;a+=1)switch(i[a]){case"ASCII85Decode":case"/ASCII85Decode":A=t(A),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=r(A),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=A.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=o(A),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[a]+'" is not implemented')}return{data:A,reverseChain:d.reverse().join(" ")}}}(gr.API),function(n){n.loadFile=function(e,t,r){return function(o,s,i){s=s!==!1,i=typeof i=="function"?i:function(){};var a=void 0;try{a=function(A,d,c){var u=new XMLHttpRequest,h=0,f=function(g){var m=g.length,y=[],b=String.fromCharCode;for(h=0;h<m;h+=1)y.push(b(255&g.charCodeAt(h)));return y.join("")};if(u.open("GET",A,!d),u.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(u.onload=function(){u.status===200?c(f(this.responseText)):c(void 0)}),u.send(null),d&&u.status===200)return f(u.responseText)}(o,s,i)}catch{}return a}(e,t,r)},n.loadImageFile=n.loadFile}(gr.API),function(n){function e(){return(wr.html2canvas?Promise.resolve(wr.html2canvas):cs(()=>import("./html2canvas.esm.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function t(){return(wr.DOMPurify?Promise.resolve(wr.DOMPurify):cs(()=>import("./purify.es.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var r=function(i){var a=ln(i);return a==="undefined"?"undefined":a==="string"||i instanceof String?"string":a==="number"||i instanceof Number?"number":a==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":a==="object"?"object":"unknown"},o=function(i,a){var A=document.createElement(i);for(var d in a.className&&(A.className=a.className),a.innerHTML&&a.dompurify&&(A.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)A.style[d]=a.style[d];return A},s=function i(a){var A=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),d=i.convert(Promise.resolve(),A);return d=(d=d.setProgress(1,i,1,[i])).set(a)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(i,a){return i.__proto__=a||s.prototype,i},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(i,a){return this.then(function(){switch(a=a||function(A){switch(r(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i)){case"string":return this.then(t).then(function(A){return this.set({src:o("div",{innerHTML:i,dompurify:A})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},s.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function A(d,c){for(var u=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),h=d.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(A(h,c));return d.nodeType===1&&(d.nodeName==="CANVAS"?(u.width=d.width,u.height=d.height,u.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(u.value=d.value),u.addEventListener("load",function(){u.scrollTop=d.scrollTop,u.scrollLeft=d.scrollLeft},!0)),u}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(a){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,a(this.prop.container,A)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(a){var A=this.opt.jsPDF,d=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,u=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete u.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var f=d[h],g=f.src.find(function(m){return m.format==="truetype"});g&&A.addFont(g.url,f.ref.name,f.ref.style)}return u.windowHeight=u.windowHeight||0,u.windowHeight=u.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):u.windowHeight,A.context2d.save(!0),a(this.prop.container,u)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(i,a,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(i,a):this.outputPdf(i,a)},s.prototype.outputPdf=function(i,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,a)})},s.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},s.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(i){if(r(i)!=="object")return this;var a=Object.keys(i||{}).map(function(A){if(A in s.template.prop)return function(){this.prop[A]=i[A]};switch(A){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[A]=i[A]}}},this);return this.then(function(){return this.thenList(a)})},s.prototype.get=function(i,a){return this.then(function(){var A=i in s.template.prop?this.prop[i]:this.opt[i];return a?a(A):A})},s.prototype.setMargin=function(i){return this.then(function(){switch(r(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},s.prototype.setPageSize=function(i){function a(A,d){return Math.floor(A*d/72*96)}return this.then(function(){(i=i||gr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:a(i.inner.width,i.k),height:a(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},s.prototype.setProgress=function(i,a,A,d){return i!=null&&(this.progress.val=i),a!=null&&(this.progress.state=a),A!=null&&(this.progress.n=A),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(i,a,A,d){return this.setProgress(i?this.progress.val+i:null,a||null,A?this.progress.n+A:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(i,a){var A=this;return this.thenCore(i,a,function(d,c){return A.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(u){return A.updateProgress(null,d),u}).then(d,c).then(function(u){return A.updateProgress(1),u})})},s.prototype.thenCore=function(i,a,A){A=A||Promise.prototype.then,i&&(i=i.bind(this)),a&&(a=a.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),c=A.call(d,i,a);return s.convert(c,this.__proto__)},s.prototype.thenExternal=function(i,a){return Promise.prototype.then.call(this,i,a)},s.prototype.thenList=function(i){var a=this;return i.forEach(function(A){a=a.thenCore(A)}),a},s.prototype.catch=function(i){i&&(i=i.bind(this));var a=Promise.prototype.catch.call(this,i);return s.convert(a,this)},s.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},s.prototype.error=function(i){return this.then(function(){throw new Error(i)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,gr.getPageSize=function(i,a,A){if(ln(i)==="object"){var d=i;i=d.orientation,a=d.unit||a,A=d.format||A}a=a||"mm",A=A||"a4",i=(""+(i||"P")).toLowerCase();var c,u=(""+A).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+a}var f,g=0,m=0;if(h.hasOwnProperty(u))g=h[u][1]/c,m=h[u][0]/c;else try{g=A[1],m=A[0]}catch{throw new Error("Invalid format: "+A)}if(i==="p"||i==="portrait")i="p",m>g&&(f=m,m=g,g=f);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",g>m&&(f=m,m=g,g=f)}return{width:m,height:g,unit:a,k:c,orientation:i}},n.html=function(i,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(Sm):null;var A=new s(a);return a.worker?A:A.from(i).doCallback()}}(gr.API),gr.API.addJS=function(n){return pb=n,this.internal.events.subscribe("postPutResources",function(){Uf=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Uf+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),fb=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+pb+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Uf!==void 0&&fb!==void 0&&this.internal.out("/Names <</JavaScript "+Uf+" 0 R>>")}),this},function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=t.outline.render().split(/\r\n/),s=0;s<o.length;s++){var i=o[s],a=r.exec(i);if(a!=null){var A=a[1];t.internal.newObjectDeferredBegin(A,!1)}t.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,c=[];for(s=0;s<d;s++){var u=t.internal.newObject();c.push(u);var h=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var f=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<c.length;s++)t.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+f+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,o,s){var i={title:o,options:s,children:[]};return r==null&&(r=this.root),r.children.push(i),i},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var o=0;o<r.children.length;o++)this.genIds_r(r.children[o])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var i=r.children[s];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var a=this.count=this.count_r({count:0},i);if(a>0&&this.line("/Count "+a),i.options&&i.options.pageNumber){var A=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+A.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,o){for(var s=0;s<o.children.length;s++)r.count++,this.count_r(r,o.children[s]);return r.count}}])}(gr.API),function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,o,s,i,a){var A,d=this.decode.DCT_DECODE,c=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=i||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(A=function(u){for(var h,f=256*u.charCodeAt(4)+u.charCodeAt(5),g=u.length,m={width:0,height:0,numcomponents:1},y=4;y<g;y+=2){if(y+=f,e.indexOf(u.charCodeAt(y+1))!==-1){h=256*u.charCodeAt(y+5)+u.charCodeAt(y+6),m={width:256*u.charCodeAt(y+7)+u.charCodeAt(y+8),height:h,numcomponents:u.charCodeAt(y+9)};break}f=256*u.charCodeAt(y+2)+u.charCodeAt(y+3)}return m}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}c={data:t,width:A.width,height:A.height,colorSpace:a,bitsPerComponent:8,filter:d,index:r,alias:o}}return c}}(gr.API);var Ad,Qf,gb,vb,mb,oN=function(){var n,e,t;function r(s){var i,a,A,d,c,u,h,f,g,m,y,b,S,F;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},u=null;;){switch(i=this.readUInt32(),g=(function(){var k,P;for(P=[],k=0;k<4;++k)P.push(String.fromCharCode(this.data[this.pos++]));return P}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":u&&this.animation.frames.push(u),this.pos+=4,u={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),d=this.readUInt16()||100,u.delay=1e3*c/d,u.disposeOp=this.data[this.pos++],u.blendOp=this.data[this.pos++],u.data=[];break;case"IDAT":case"fdAT":for(g==="fdAT"&&(this.pos+=4,i-=4),s=(u!=null?u.data:void 0)||this.imgData,b=0;0<=i?b<i:b>i;0<=i?++b:--b)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((m=A-this.transparency.indexed.length)>0)for(S=0;0<=m?S<m:S>m;0<=m?++S:--S)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":h=(y=this.read(i)).indexOf(0),f=String.fromCharCode.apply(String,y.slice(0,h)),this.text[f]=String.fromCharCode.apply(String,y.slice(h+1));break;case"IEND":return u&&this.animation.frames.push(u),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(F=this.colorType)===4||F===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(s){var i,a;for(a=[],i=0;0<=s?i<s:i>s;0<=s?++i:--i)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(s){var i=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*i),A=0,d=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function c(u,h,f,g){var m,y,b,S,F,k,P,te,$,j,J,we,D,N,Z,se,ce,re,pe,V,K,oe=Math.ceil((d.width-u)/f),ae=Math.ceil((d.height-h)/g),x=d.width==oe&&d.height==ae;for(N=i*oe,we=x?a:new Uint8Array(N*ae),k=s.length,D=0,y=0;D<ae&&A<k;){switch(s[A++]){case 0:for(S=ce=0;ce<N;S=ce+=1)we[y++]=s[A++];break;case 1:for(S=re=0;re<N;S=re+=1)m=s[A++],F=S<i?0:we[y-i],we[y++]=(m+F)%256;break;case 2:for(S=pe=0;pe<N;S=pe+=1)m=s[A++],b=(S-S%i)/i,Z=D&&we[(D-1)*N+b*i+S%i],we[y++]=(Z+m)%256;break;case 3:for(S=V=0;V<N;S=V+=1)m=s[A++],b=(S-S%i)/i,F=S<i?0:we[y-i],Z=D&&we[(D-1)*N+b*i+S%i],we[y++]=(m+Math.floor((F+Z)/2))%256;break;case 4:for(S=K=0;K<N;S=K+=1)m=s[A++],b=(S-S%i)/i,F=S<i?0:we[y-i],D===0?Z=se=0:(Z=we[(D-1)*N+b*i+S%i],se=b&&we[(D-1)*N+(b-1)*i+S%i]),P=F+Z-se,te=Math.abs(P-F),j=Math.abs(P-Z),J=Math.abs(P-se),$=te<=j&&te<=J?F:j<=J?Z:se,we[y++]=(m+$)%256;break;default:throw new Error("Invalid filter algorithm: "+s[A-1])}if(!x){var E=((h+D*g)*d.width+u)*i,I=D*N;for(S=0;S<oe;S+=1){for(var L=0;L<i;L+=1)a[E++]=we[I++];E+=(f-1)*i}}D++}}return s=kD(s),d.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),a},r.prototype.decodePalette=function(){var s,i,a,A,d,c,u,h,f;for(a=this.palette,c=this.transparency.indexed||[],d=new Uint8Array((c.length||0)+a.length),A=0,s=0,i=u=0,h=a.length;u<h;i=u+=3)d[A++]=a[i],d[A++]=a[i+1],d[A++]=a[i+2],d[A++]=(f=c[s++])!=null?f:255;return d},r.prototype.copyToImageData=function(s,i){var a,A,d,c,u,h,f,g,m,y,b;if(A=this.colors,m=null,a=this.hasAlphaChannel,this.palette.length&&(m=(b=this._decodedPalette)!=null?b:this._decodedPalette=this.decodePalette(),A=4,a=!0),g=(d=s.data||s).length,u=m||i,c=h=0,A===1)for(;c<g;)f=m?4*i[c/4]:h,y=u[f++],d[c++]=y,d[c++]=y,d[c++]=y,d[c++]=a?u[f++]:255,h=f;else for(;c<g;)f=m?4*i[c/4]:h,d[c++]=u[f++],d[c++]=u[f++],d[c++]=u[f++],d[c++]=a?u[f++]:255,h=f},r.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var o=function(){if(Object.prototype.toString.call(wr)==="[object Window]"){try{e=wr.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return o(),n=function(s){var i;if(o()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(i=new Image).src=e.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(s){var i,a,A,d,c,u,h,f;if(this.animation){for(f=[],a=c=0,u=(h=this.animation.frames).length;c<u;a=++c)i=h[a],A=s.createImageData(i.width,i.height),d=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(A,d),i.imageData=A,f.push(i.image=n(A));return f}},r.prototype.renderFrame=function(s,i){var a,A,d;return a=(A=this.animation.frames)[i],d=A[i-1],i===0&&s.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?s.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&s.putImageData(d.imageData,d.xOffset,d.yOffset),a.blendOp===0&&s.clearRect(a.xOffset,a.yOffset,a.width,a.height),s.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(s){var i,a,A,d,c,u,h=this;return a=0,u=this.animation,d=u.numFrames,A=u.frames,c=u.numPlays,(i=function(){var f,g;if(f=a++%d,g=A[f],h.renderFrame(s,f),d>1&&a/d<c)return h.animation._timeout=setTimeout(i,g.delay)})()},r.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},r.prototype.render=function(s){var i,a;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,i=s.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(a=i.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),i.putImageData(a,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function sN(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,o=n[e++],s=o>>7,i=1<<(7&o)+1;n[e++],n[e++];var a=null,A=null;s&&(a=e,A=i,e+=3*i);var d=!0,c=[],u=0,h=null,f=0,g=null;for(this.width=t,this.height=r;d&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,g=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((D=n[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var m=n[e++];u=n[e++]|n[e++]<<8,h=n[e++],!(1&m)&&(h=null),f=m>>2&7,e++;break;case 254:for(;;){if(!((D=n[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var y=n[e++]|n[e++]<<8,b=n[e++]|n[e++]<<8,S=n[e++]|n[e++]<<8,F=n[e++]|n[e++]<<8,k=n[e++],P=k>>6&1,te=1<<(7&k)+1,$=a,j=A,J=!1;k>>7&&(J=!0,$=e,j=te,e+=3*te);var we=e;for(e++;;){var D;if(!((D=n[e++])>=0))throw Error("Invalid block size");if(D===0)break;e+=D}c.push({x:y,y:b,width:S,height:F,has_local_palette:J,palette_offset:$,palette_size:j,data_offset:we,data_length:e-we,transparent_index:h,interlaced:!!P,delay:u,disposal:f});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return g},this.frameInfo=function(N){if(N<0||N>=c.length)throw new Error("Frame index out of range.");return c[N]},this.decodeAndBlitFrameBGRA=function(N,Z){var se=this.frameInfo(N),ce=se.width*se.height,re=new Uint8Array(ce);wb(n,se.data_offset,re,ce);var pe=se.palette_offset,V=se.transparent_index;V===null&&(V=256);var K=se.width,oe=t-K,ae=K,x=4*(se.y*t+se.x),E=4*((se.y+se.height)*t+se.x),I=x,L=4*oe;se.interlaced===!0&&(L+=4*t*7);for(var M=8,H=0,q=re.length;H<q;++H){var G=re[H];if(ae===0&&(ae=K,(I+=L)>=E&&(L=4*oe+4*t*(M-1),I=x+(K+oe)*(M<<1),M>>=1)),G===V)I+=4;else{var R=n[pe+3*G],he=n[pe+3*G+1],Be=n[pe+3*G+2];Z[I++]=Be,Z[I++]=he,Z[I++]=R,Z[I++]=255}--ae}},this.decodeAndBlitFrameRGBA=function(N,Z){var se=this.frameInfo(N),ce=se.width*se.height,re=new Uint8Array(ce);wb(n,se.data_offset,re,ce);var pe=se.palette_offset,V=se.transparent_index;V===null&&(V=256);var K=se.width,oe=t-K,ae=K,x=4*(se.y*t+se.x),E=4*((se.y+se.height)*t+se.x),I=x,L=4*oe;se.interlaced===!0&&(L+=4*t*7);for(var M=8,H=0,q=re.length;H<q;++H){var G=re[H];if(ae===0&&(ae=K,(I+=L)>=E&&(L=4*oe+4*t*(M-1),I=x+(K+oe)*(M<<1),M>>=1)),G===V)I+=4;else{var R=n[pe+3*G],he=n[pe+3*G+1],Be=n[pe+3*G+2];Z[I++]=R,Z[I++]=he,Z[I++]=Be,Z[I++]=255}--ae}}}function wb(n,e,t,r){for(var o=n[e++],s=1<<o,i=s+1,a=i+1,A=o+1,d=(1<<A)-1,c=0,u=0,h=0,f=n[e++],g=new Int32Array(4096),m=null;;){for(;c<16&&f!==0;)u|=n[e++]<<c,c+=8,f===1?f=n[e++]:--f;if(c<A)break;var y=u&d;if(u>>=A,c-=A,y!==s){if(y===i)break;for(var b=y<a?y:m,S=0,F=b;F>s;)F=g[F]>>8,++S;var k=F;if(h+S+(b!==y?1:0)>r)return void wn.log("Warning, gif stream longer than expected.");t[h++]=k;var P=h+=S;for(b!==y&&(t[h++]=k),F=b;S--;)F=g[F],t[--P]=255&F,F>>=8;m!==null&&a<4096&&(g[a++]=m<<8|k,a>=d+1&&A<12&&(++A,d=d<<1|1)),m=y}else a=i+1,d=(1<<(A=o+1))-1,m=null}return h!==r&&wn.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function r0(n){var e,t,r,o,s,i=Math.floor,a=new Array(64),A=new Array(64),d=new Array(64),c=new Array(64),u=new Array(65535),h=new Array(65535),f=new Array(64),g=new Array(64),m=[],y=0,b=7,S=new Array(64),F=new Array(64),k=new Array(64),P=new Array(256),te=new Array(2048),$=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],j=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],we=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],D=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],N=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Z=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function re(x,E){for(var I=0,L=0,M=new Array,H=1;H<=16;H++){for(var q=1;q<=x[H];q++)M[E[L]]=[],M[E[L]][0]=I,M[E[L]][1]=H,L++,I++;I*=2}return M}function pe(x){for(var E=x[0],I=x[1]-1;I>=0;)E&1<<I&&(y|=1<<b),I--,--b<0&&(y==255?(V(255),V(0)):V(y),b=7,y=0)}function V(x){m.push(x)}function K(x){V(x>>8&255),V(255&x)}function oe(x,E,I,L,M){for(var H,q=M[0],G=M[240],R=function(me,le){var ze,ke,de,Fe,U,Ae,fe,Ce,ge,De,Ne=0;for(ge=0;ge<8;++ge){ze=me[Ne],ke=me[Ne+1],de=me[Ne+2],Fe=me[Ne+3],U=me[Ne+4],Ae=me[Ne+5],fe=me[Ne+6];var Ze=ze+(Ce=me[Ne+7]),Oe=ze-Ce,Ke=ke+fe,Je=ke-fe,Te=de+Ae,_e=de-Ae,Ue=Fe+U,Me=Fe-U,je=Ze+Ue,At=Ze-Ue,ut=Ke+Te,ht=Ke-Te;me[Ne]=je+ut,me[Ne+4]=je-ut;var Re=.707106781*(ht+At);me[Ne+2]=At+Re,me[Ne+6]=At-Re;var Xe=.382683433*((je=Me+_e)-(ht=Je+Oe)),tt=.5411961*je+Xe,rt=1.306562965*ht+Xe,Bt=.707106781*(ut=_e+Je),nt=Oe+Bt,ot=Oe-Bt;me[Ne+5]=ot+tt,me[Ne+3]=ot-tt,me[Ne+1]=nt+rt,me[Ne+7]=nt-rt,Ne+=8}for(Ne=0,ge=0;ge<8;++ge){ze=me[Ne],ke=me[Ne+8],de=me[Ne+16],Fe=me[Ne+24],U=me[Ne+32],Ae=me[Ne+40],fe=me[Ne+48];var xt=ze+(Ce=me[Ne+56]),Lt=ze-Ce,_t=ke+fe,vt=ke-fe,Pt=de+Ae,kt=de-Ae,Ct=Fe+U,Ft=Fe-U,zt=xt+Ct,Tt=xt-Ct,Rt=_t+Pt,Dt=_t-Pt;me[Ne]=zt+Rt,me[Ne+32]=zt-Rt;var Mt=.707106781*(Dt+Tt);me[Ne+16]=Tt+Mt,me[Ne+48]=Tt-Mt;var Gt=.382683433*((zt=Ft+kt)-(Dt=vt+Lt)),lr=.5411961*zt+Gt,tr=1.306562965*Dt+Gt,sr=.707106781*(Rt=kt+vt),Ht=Lt+sr,mr=Lt-sr;me[Ne+40]=mr+lr,me[Ne+24]=mr-lr,me[Ne+8]=Ht+tr,me[Ne+56]=Ht-tr,Ne++}for(ge=0;ge<64;++ge)De=me[ge]*le[ge],f[ge]=De>0?De+.5|0:De-.5|0;return f}(x,E),he=0;he<64;++he)g[$[he]]=R[he];var Be=g[0]-I;I=g[0],Be==0?pe(L[0]):(pe(L[h[H=32767+Be]]),pe(u[H]));for(var be=63;be>0&&g[be]==0;)be--;if(be==0)return pe(q),I;for(var Le,Y=1;Y<=be;){for(var O=Y;g[Y]==0&&Y<=be;)++Y;var ve=Y-O;if(ve>=16){Le=ve>>4;for(var xe=1;xe<=Le;++xe)pe(G);ve&=15}H=32767+g[Y],pe(M[(ve<<4)+h[H]]),pe(u[H]),Y++}return be!=63&&pe(q),I}function ae(x){x=Math.min(Math.max(x,1),100),s!=x&&(function(E){for(var I=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],L=0;L<64;L++){var M=i((I[L]*E+50)/100);M=Math.min(Math.max(M,1),255),a[$[L]]=M}for(var H=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],q=0;q<64;q++){var G=i((H[q]*E+50)/100);G=Math.min(Math.max(G,1),255),A[$[q]]=G}for(var R=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],he=0,Be=0;Be<8;Be++)for(var be=0;be<8;be++)d[he]=1/(a[$[he]]*R[Be]*R[be]*8),c[he]=1/(A[$[he]]*R[Be]*R[be]*8),he++}(x<50?Math.floor(5e3/x):Math.floor(200-2*x)),s=x)}this.encode=function(x,E){E&&ae(E),m=new Array,y=0,b=7,K(65496),K(65504),K(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),K(1),K(1),V(0),V(0),function(){K(65499),K(132),V(0);for(var ke=0;ke<64;ke++)V(a[ke]);V(1);for(var de=0;de<64;de++)V(A[de])}(),function(ke,de){K(65472),K(17),V(8),K(de),K(ke),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)}(x.width,x.height),function(){K(65476),K(418),V(0);for(var ke=0;ke<16;ke++)V(j[ke+1]);for(var de=0;de<=11;de++)V(J[de]);V(16);for(var Fe=0;Fe<16;Fe++)V(we[Fe+1]);for(var U=0;U<=161;U++)V(D[U]);V(1);for(var Ae=0;Ae<16;Ae++)V(N[Ae+1]);for(var fe=0;fe<=11;fe++)V(Z[fe]);V(17);for(var Ce=0;Ce<16;Ce++)V(se[Ce+1]);for(var ge=0;ge<=161;ge++)V(ce[ge])}(),K(65498),K(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0);var I=0,L=0,M=0;y=0,b=7,this.encode.displayName="_encode_";for(var H,q,G,R,he,Be,be,Le,Y,O=x.data,ve=x.width,xe=x.height,me=4*ve,le=0;le<xe;){for(H=0;H<me;){for(he=me*le+H,be=-1,Le=0,Y=0;Y<64;Y++)Be=he+(Le=Y>>3)*me+(be=4*(7&Y)),le+Le>=xe&&(Be-=me*(le+1+Le-xe)),H+be>=me&&(Be-=H+be-me+4),q=O[Be++],G=O[Be++],R=O[Be++],S[Y]=(te[q]+te[G+256>>0]+te[R+512>>0]>>16)-128,F[Y]=(te[q+768>>0]+te[G+1024>>0]+te[R+1280>>0]>>16)-128,k[Y]=(te[q+1280>>0]+te[G+1536>>0]+te[R+1792>>0]>>16)-128;I=oe(S,d,I,e,r),L=oe(F,c,L,t,o),M=oe(k,c,M,t,o),H+=32}le+=8}if(b>=0){var ze=[];ze[1]=b+1,ze[0]=(1<<b+1)-1,pe(ze)}return K(65497),new Uint8Array(m)},n=n||50,function(){for(var x=String.fromCharCode,E=0;E<256;E++)P[E]=x(E)}(),e=re(j,J),t=re(N,Z),r=re(we,D),o=re(se,ce),function(){for(var x=1,E=2,I=1;I<=15;I++){for(var L=x;L<E;L++)h[32767+L]=I,u[32767+L]=[],u[32767+L][1]=I,u[32767+L][0]=L;for(var M=-(E-1);M<=-x;M++)h[32767+M]=I,u[32767+M]=[],u[32767+M][1]=I,u[32767+M][0]=E-1+M;x<<=1,E<<=1}}(),function(){for(var x=0;x<256;x++)te[x]=19595*x,te[x+256>>0]=38470*x,te[x+512>>0]=7471*x+32768,te[x+768>>0]=-11059*x,te[x+1024>>0]=-21709*x,te[x+1280>>0]=32768*x+8421375,te[x+1536>>0]=-27439*x,te[x+1792>>0]=-5329*x}(),ae(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ai(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function yb(n){function e(j){if(!j)throw Error("assert :P")}function t(j,J,we){for(var D=0;4>D;D++)if(j[J+D]!=we.charCodeAt(D))return!0;return!1}function r(j,J,we,D,N){for(var Z=0;Z<N;Z++)j[J+Z]=we[D+Z]}function o(j,J,we,D){for(var N=0;N<D;N++)j[J+N]=we}function s(j){return new Int32Array(j)}function i(j,J){for(var we=[],D=0;D<j;D++)we.push(new J);return we}function a(j,J){var we=[];return function D(N,Z,se){for(var ce=se[Z],re=0;re<ce&&(N.push(se.length>Z+1?[]:new J),!(se.length<Z+1));re++)D(N[re],Z+1,se)}(we,0,j),we}var A=function(){var j=this;function J(p,v){for(var C=1<<v-1>>>0;p&C;)C>>>=1;return C?(p&C-1)+C:p}function we(p,v,C,Q,W){e(!(Q%C));do p[v+(Q-=C)]=W;while(0<Q)}function D(p,v,C,Q,W){if(e(2328>=W),512>=W)var ne=s(512);else if((ne=s(W))==null)return 0;return function(ie,ue,ye,Ee,$e,dt){var ct,et,Ut=ue,wt=1<<ye,Ve=s(16),Ye=s(16);for(e($e!=0),e(Ee!=null),e(ie!=null),e(0<ye),et=0;et<$e;++et){if(15<Ee[et])return 0;++Ve[Ee[et]]}if(Ve[0]==$e)return 0;for(Ye[1]=0,ct=1;15>ct;++ct){if(Ve[ct]>1<<ct)return 0;Ye[ct+1]=Ye[ct]+Ve[ct]}for(et=0;et<$e;++et)ct=Ee[et],0<Ee[et]&&(dt[Ye[ct]++]=et);if(Ye[15]==1)return(Ee=new N).g=0,Ee.value=dt[0],we(ie,Ut,1,wt,Ee),wt;var St,Qt=-1,It=wt-1,Xt=0,jt=1,cr=1,qt=1<<ye;for(et=0,ct=1,$e=2;ct<=ye;++ct,$e<<=1){if(jt+=cr<<=1,0>(cr-=Ve[ct]))return 0;for(;0<Ve[ct];--Ve[ct])(Ee=new N).g=ct,Ee.value=dt[et++],we(ie,Ut+Xt,$e,qt,Ee),Xt=J(Xt,ct)}for(ct=ye+1,$e=2;15>=ct;++ct,$e<<=1){if(jt+=cr<<=1,0>(cr-=Ve[ct]))return 0;for(;0<Ve[ct];--Ve[ct]){if(Ee=new N,(Xt&It)!=Qt){for(Ut+=qt,St=1<<(Qt=ct)-ye;15>Qt&&!(0>=(St-=Ve[Qt]));)++Qt,St<<=1;wt+=qt=1<<(St=Qt-ye),ie[ue+(Qt=Xt&It)].g=St+ye,ie[ue+Qt].value=Ut-ue-Qt}Ee.g=ct-ye,Ee.value=dt[et++],we(ie,Ut+(Xt>>ye),$e,qt,Ee),Xt=J(Xt,ct)}}return jt!=2*Ye[15]-1?0:wt}(p,v,C,Q,W,ne)}function N(){this.value=this.g=0}function Z(){this.value=this.g=0}function se(){this.G=i(5,N),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(_o,Z)}function ce(p,v,C,Q){e(p!=null),e(v!=null),e(2147483648>Q),p.Ca=254,p.I=0,p.b=-8,p.Ka=0,p.oa=v,p.pa=C,p.Jd=v,p.Yc=C+Q,p.Zc=4<=Q?C+Q-4+1:C,H(p)}function re(p,v){for(var C=0;0<v--;)C|=G(p,128)<<v;return C}function pe(p,v){var C=re(p,v);return q(p)?-C:C}function V(p,v,C,Q){var W,ne=0;for(e(p!=null),e(v!=null),e(4294967288>Q),p.Sb=Q,p.Ra=0,p.u=0,p.h=0,4<Q&&(Q=4),W=0;W<Q;++W)ne+=v[C+W]<<8*W;p.Ra=ne,p.bb=Q,p.oa=v,p.pa=C}function K(p){for(;8<=p.u&&p.bb<p.Sb;)p.Ra>>>=8,p.Ra+=p.oa[p.pa+p.bb]<<Ql-8>>>0,++p.bb,p.u-=8;I(p)&&(p.h=1,p.u=0)}function oe(p,v){if(e(0<=v),!p.h&&v<=Ul){var C=E(p)&Il[v];return p.u+=v,K(p),C}return p.h=1,p.u=0}function ae(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function x(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function E(p){return p.Ra>>>(p.u&Ql-1)>>>0}function I(p){return e(p.bb<=p.Sb),p.h||p.bb==p.Sb&&p.u>Ql}function L(p,v){p.u=v,p.h=I(p)}function M(p){p.u>=yc&&(e(p.u>=yc),K(p))}function H(p){e(p!=null&&p.oa!=null),p.pa<p.Zc?(p.I=(p.oa[p.pa++]|p.I<<8)>>>0,p.b+=8):(e(p!=null&&p.oa!=null),p.pa<p.Yc?(p.b+=8,p.I=p.oa[p.pa++]|p.I<<8):p.Ka?p.b=0:(p.I<<=8,p.b+=8,p.Ka=1))}function q(p){return re(p,1)}function G(p,v){var C=p.Ca;0>p.b&&H(p);var Q=p.b,W=C*v>>>8,ne=(p.I>>>Q>W)+0;for(ne?(C-=W,p.I-=W+1<<Q>>>0):C=W+1,Q=C,W=0;256<=Q;)W+=8,Q>>=8;return Q=7^W+os[Q],p.b-=Q,p.Ca=(C<<Q)-1,ne}function R(p,v,C){p[v+0]=C>>24&255,p[v+1]=C>>16&255,p[v+2]=C>>8&255,p[v+3]=C>>0&255}function he(p,v){return p[v+0]<<0|p[v+1]<<8}function Be(p,v){return he(p,v)|p[v+2]<<16}function be(p,v){return he(p,v)|he(p,v+2)<<16}function Le(p,v){var C=1<<v;return e(p!=null),e(0<v),p.X=s(C),p.X==null?0:(p.Mb=32-v,p.Xa=v,1)}function Y(p,v){e(p!=null),e(v!=null),e(p.Xa==v.Xa),r(v.X,0,p.X,0,1<<v.Xa)}function O(){this.X=[],this.Xa=this.Mb=0}function ve(p,v,C,Q){e(C!=null),e(Q!=null);var W=C[0],ne=Q[0];return W==0&&(W=(p*ne+v/2)/v),ne==0&&(ne=(v*W+p/2)/p),0>=W||0>=ne?0:(C[0]=W,Q[0]=ne,1)}function xe(p,v){return p+(1<<v)-1>>>v}function me(p,v){return((4278255360&p)+(4278255360&v)>>>0&4278255360)+((16711935&p)+(16711935&v)>>>0&16711935)>>>0}function le(p,v){j[v]=function(C,Q,W,ne,ie,ue,ye){var Ee;for(Ee=0;Ee<ie;++Ee){var $e=j[p](ue[ye+Ee-1],W,ne+Ee);ue[ye+Ee]=me(C[Q+Ee],$e)}}}function ze(){this.ud=this.hd=this.jd=0}function ke(p,v){return((4278124286&(p^v))>>>1)+(p&v)>>>0}function de(p){return 0<=p&&256>p?p:0>p?0:255<p?255:void 0}function Fe(p,v){return de(p+(p-v+.5>>1))}function U(p,v,C){return Math.abs(v-C)-Math.abs(p-C)}function Ae(p,v,C,Q,W,ne,ie){for(Q=ne[ie-1],C=0;C<W;++C)ne[ie+C]=Q=me(p[v+C],Q)}function fe(p,v,C,Q,W){var ne;for(ne=0;ne<C;++ne){var ie=p[v+ne],ue=ie>>8&255,ye=16711935&(ye=(ye=16711935&ie)+((ue<<16)+ue));Q[W+ne]=(4278255360&ie)+ye>>>0}}function Ce(p,v){v.jd=p>>0&255,v.hd=p>>8&255,v.ud=p>>16&255}function ge(p,v,C,Q,W,ne){var ie;for(ie=0;ie<Q;++ie){var ue=v[C+ie],ye=ue>>>8,Ee=ue,$e=255&($e=($e=ue>>>16)+((p.jd<<24>>24)*(ye<<24>>24)>>>5));Ee=255&(Ee=(Ee=Ee+((p.hd<<24>>24)*(ye<<24>>24)>>>5))+((p.ud<<24>>24)*($e<<24>>24)>>>5)),W[ne+ie]=(4278255360&ue)+($e<<16)+Ee}}function De(p,v,C,Q,W){j[v]=function(ne,ie,ue,ye,Ee,$e,dt,ct,et){for(ye=dt;ye<ct;++ye)for(dt=0;dt<et;++dt)Ee[$e++]=W(ue[Q(ne[ie++])])},j[p]=function(ne,ie,ue,ye,Ee,$e,dt){var ct=8>>ne.b,et=ne.Ea,Ut=ne.K[0],wt=ne.w;if(8>ct)for(ne=(1<<ne.b)-1,wt=(1<<ct)-1;ie<ue;++ie){var Ve,Ye=0;for(Ve=0;Ve<et;++Ve)Ve&ne||(Ye=Q(ye[Ee++])),$e[dt++]=W(Ut[Ye&wt]),Ye>>=ct}else j["VP8LMapColor"+C](ye,Ee,Ut,wt,$e,dt,ie,ue,et)}}function Ne(p,v,C,Q,W){for(C=v+C;v<C;){var ne=p[v++];Q[W++]=ne>>16&255,Q[W++]=ne>>8&255,Q[W++]=ne>>0&255}}function Ze(p,v,C,Q,W){for(C=v+C;v<C;){var ne=p[v++];Q[W++]=ne>>16&255,Q[W++]=ne>>8&255,Q[W++]=ne>>0&255,Q[W++]=ne>>24&255}}function Oe(p,v,C,Q,W){for(C=v+C;v<C;){var ne=(ie=p[v++])>>16&240|ie>>12&15,ie=ie>>0&240|ie>>28&15;Q[W++]=ne,Q[W++]=ie}}function Ke(p,v,C,Q,W){for(C=v+C;v<C;){var ne=(ie=p[v++])>>16&248|ie>>13&7,ie=ie>>5&224|ie>>3&31;Q[W++]=ne,Q[W++]=ie}}function Je(p,v,C,Q,W){for(C=v+C;v<C;){var ne=p[v++];Q[W++]=ne>>0&255,Q[W++]=ne>>8&255,Q[W++]=ne>>16&255}}function Te(p,v,C,Q,W,ne){if(ne==0)for(C=v+C;v<C;)R(Q,((ne=p[v++])[0]>>24|ne[1]>>8&65280|ne[2]<<8&16711680|ne[3]<<24)>>>0),W+=32;else r(Q,W,p,v,C)}function _e(p,v){j[v][0]=j[p+"0"],j[v][1]=j[p+"1"],j[v][2]=j[p+"2"],j[v][3]=j[p+"3"],j[v][4]=j[p+"4"],j[v][5]=j[p+"5"],j[v][6]=j[p+"6"],j[v][7]=j[p+"7"],j[v][8]=j[p+"8"],j[v][9]=j[p+"9"],j[v][10]=j[p+"10"],j[v][11]=j[p+"11"],j[v][12]=j[p+"12"],j[v][13]=j[p+"13"],j[v][14]=j[p+"0"],j[v][15]=j[p+"0"]}function Ue(p){return p==Kg||p==$g||p==fh||p==Vg}function Me(){this.eb=[],this.size=this.A=this.fb=0}function je(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function At(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Me,this.f.kb=new je,this.sd=null}function ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function ht(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Re(p){return alert("todo:WebPSamplerProcessPlane"),p.T}function Xe(p,v){var C=p.T,Q=v.ba.f.RGBA,W=Q.eb,ne=Q.fb+p.ka*Q.A,ie=qs[v.ba.S],ue=p.y,ye=p.O,Ee=p.f,$e=p.N,dt=p.ea,ct=p.W,et=v.cc,Ut=v.dc,wt=v.Mc,Ve=v.Nc,Ye=p.ka,St=p.ka+p.T,Qt=p.U,It=Qt+1>>1;for(Ye==0?ie(ue,ye,null,null,Ee,$e,dt,ct,Ee,$e,dt,ct,W,ne,null,null,Qt):(ie(v.ec,v.fc,ue,ye,et,Ut,wt,Ve,Ee,$e,dt,ct,W,ne-Q.A,W,ne,Qt),++C);Ye+2<St;Ye+=2)et=Ee,Ut=$e,wt=dt,Ve=ct,$e+=p.Rc,ct+=p.Rc,ne+=2*Q.A,ie(ue,(ye+=2*p.fa)-p.fa,ue,ye,et,Ut,wt,Ve,Ee,$e,dt,ct,W,ne-Q.A,W,ne,Qt);return ye+=p.fa,p.j+St<p.o?(r(v.ec,v.fc,ue,ye,Qt),r(v.cc,v.dc,Ee,$e,It),r(v.Mc,v.Nc,dt,ct,It),C--):1&St||ie(ue,ye,null,null,Ee,$e,dt,ct,Ee,$e,dt,ct,W,ne+Q.A,null,null,Qt),C}function tt(p,v,C){var Q=p.F,W=[p.J];if(Q!=null){var ne=p.U,ie=v.ba.S,ue=ie==hh||ie==fh;v=v.ba.f.RGBA;var ye=[0],Ee=p.ka;ye[0]=p.T,p.Kb&&(Ee==0?--ye[0]:(--Ee,W[0]-=p.width),p.j+p.ka+p.T==p.o&&(ye[0]=p.o-p.j-Ee));var $e=v.eb;Ee=v.fb+Ee*v.A,p=_n(Q,W[0],p.width,ne,ye,$e,Ee+(ue?0:3),v.A),e(C==ye),p&&Ue(ie)&&js($e,Ee,ue,ne,ye,v.A)}return 0}function rt(p){var v=p.ma,C=v.ba.S,Q=11>C,W=C==ch||C==uh||C==hh||C==qg||C==12||Ue(C);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!mc(v.Oa,p,W?11:12))return 0;if(W&&Ue(C)&&Ot(),p.da)alert("todo:use_scaling");else{if(Q){if(v.Ib=Re,p.Kb){if(C=p.U+1>>1,v.memory=s(p.U+2*C),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+p.U,v.Mc=v.cc,v.Nc=v.dc+C,v.Ib=Xe,Ot()}}else alert("todo:EmitYUV");W&&(v.Jb=tt,Q&&st())}if(Q&&!p2){for(p=0;256>p;++p)lC[p]=89858*(p-128)+gh>>ph,uC[p]=-22014*(p-128)+gh,cC[p]=-45773*(p-128),dC[p]=113618*(p-128)+gh>>ph;for(p=Sc;p<Xg;++p)v=76283*(p-16)+gh>>ph,hC[p-Sc]=Bs(v,255),fC[p-Sc]=Bs(v+8>>4,15);p2=1}return 1}function Bt(p){var v=p.ma,C=p.U,Q=p.T;return e(!(1&p.ka)),0>=C||0>=Q?0:(C=v.Ib(p,v),v.Jb!=null&&v.Jb(p,v,C),v.Dc+=C,1)}function nt(p){p.ma.memory=null}function ot(p,v,C,Q){return oe(p,8)!=47?0:(v[0]=oe(p,14)+1,C[0]=oe(p,14)+1,Q[0]=oe(p,1),oe(p,3)!=0?0:!p.h)}function xt(p,v){if(4>p)return p+1;var C=p-2>>1;return(2+(1&p)<<C)+oe(v,C)+1}function Lt(p,v){return 120<v?v-120:1<=(C=((C=Wz[v-1])>>4)*p+(8-(15&C)))?C:1;var C}function _t(p,v,C){var Q=E(C),W=p[v+=255&Q].g-8;return 0<W&&(L(C,C.u+8),Q=E(C),v+=p[v].value,v+=Q&(1<<W)-1),L(C,C.u+p[v].g),p[v].value}function vt(p,v,C){return C.g+=p.g,C.value+=p.value<<v>>>0,e(8>=C.g),p.g}function Pt(p,v,C){var Q=p.xc;return e((v=Q==0?0:p.vc[p.md*(C>>Q)+(v>>Q)])<p.Wb),p.Ya[v]}function kt(p,v,C,Q){var W=p.ab,ne=p.c*v,ie=p.C;v=ie+v;var ue=C,ye=Q;for(Q=p.Ta,C=p.Ua;0<W--;){var Ee=p.gc[W],$e=ie,dt=v,ct=ue,et=ye,Ut=(ye=Q,ue=C,Ee.Ea);switch(e($e<dt),e(dt<=Ee.nc),Ee.hc){case 2:oh(ct,et,(dt-$e)*Ut,ye,ue);break;case 0:var wt=$e,Ve=dt,Ye=ye,St=ue,Qt=(qt=Ee).Ea;wt==0&&(jg(ct,et,null,null,1,Ye,St),Ae(ct,et+1,0,0,Qt-1,Ye,St+1),et+=Qt,St+=Qt,++wt);for(var It=1<<qt.b,Xt=It-1,jt=xe(Qt,qt.b),cr=qt.K,qt=qt.w+(wt>>qt.b)*jt;wt<Ve;){var Jr=cr,sn=qt,Vr=1;for(bc(ct,et,Ye,St-Qt,1,Ye,St);Vr<Qt;){var Or=(Vr&~Xt)+It;Or>Qt&&(Or=Qt),(0,Oa[Jr[sn++]>>8&15])(ct,et+ +Vr,Ye,St+Vr-Qt,Or-Vr,Ye,St+Vr),Vr=Or}et+=Qt,St+=Qt,++wt&Xt||(qt+=jt)}dt!=Ee.nc&&r(ye,ue-Ut,ye,ue+(dt-$e-1)*Ut,Ut);break;case 1:for(Ut=ct,Ve=et,Qt=(ct=Ee.Ea)-(St=ct&~(Ye=(et=1<<Ee.b)-1)),wt=xe(ct,Ee.b),It=Ee.K,Ee=Ee.w+($e>>Ee.b)*wt;$e<dt;){for(Xt=It,jt=Ee,cr=new ze,qt=Ve+St,Jr=Ve+ct;Ve<qt;)Ce(Xt[jt++],cr),TA(cr,Ut,Ve,et,ye,ue),Ve+=et,ue+=et;Ve<Jr&&(Ce(Xt[jt++],cr),TA(cr,Ut,Ve,Qt,ye,ue),Ve+=Qt,ue+=Qt),++$e&Ye||(Ee+=wt)}break;case 3:if(ct==ye&&et==ue&&0<Ee.b){for(Ve=ye,ct=Ut=ue+(dt-$e)*Ut-(St=(dt-$e)*xe(Ee.Ea,Ee.b)),et=ye,Ye=ue,wt=[],St=(Qt=St)-1;0<=St;--St)wt[St]=et[Ye+St];for(St=Qt-1;0<=St;--St)Ve[ct+St]=wt[St];Ns(Ee,$e,dt,ye,Ut,ye,ue)}else Ns(Ee,$e,dt,ct,et,ye,ue)}ue=Q,ye=C}ye!=C&&r(Q,C,ue,ye,ne)}function Ct(p,v){var C=p.V,Q=p.Ba+p.c*p.C,W=v-p.C;if(e(v<=p.l.o),e(16>=W),0<W){var ne=p.l,ie=p.Ta,ue=p.Ua,ye=ne.width;if(kt(p,W,C,Q),W=ue=[ue],e((C=p.C)<(Q=v)),e(ne.v<ne.va),Q>ne.o&&(Q=ne.o),C<ne.j){var Ee=ne.j-C;C=ne.j,W[0]+=Ee*ye}if(C>=Q?C=0:(W[0]+=4*ne.v,ne.ka=C-ne.j,ne.U=ne.va-ne.v,ne.T=Q-C,C=1),C){if(ue=ue[0],11>(C=p.ca).S){var $e=C.f.RGBA,dt=(Q=C.S,W=ne.U,ne=ne.T,Ee=$e.eb,$e.A),ct=ne;for($e=$e.fb+p.Ma*$e.A;0<ct--;){var et=ie,Ut=ue,wt=W,Ve=Ee,Ye=$e;switch(Q){case dh:ss(et,Ut,wt,Ve,Ye);break;case ch:qo(et,Ut,wt,Ve,Ye);break;case Kg:qo(et,Ut,wt,Ve,Ye),js(Ve,Ye,0,wt,1,0);break;case i2:na(et,Ut,wt,Ve,Ye);break;case uh:Te(et,Ut,wt,Ve,Ye,1);break;case $g:Te(et,Ut,wt,Ve,Ye,1),js(Ve,Ye,0,wt,1,0);break;case hh:Te(et,Ut,wt,Ve,Ye,0);break;case fh:Te(et,Ut,wt,Ve,Ye,0),js(Ve,Ye,1,wt,1,0);break;case qg:Da(et,Ut,wt,Ve,Ye);break;case Vg:Da(et,Ut,wt,Ve,Ye),bn(Ve,Ye,wt,1,0);break;case a2:ra(et,Ut,wt,Ve,Ye);break;default:e(0)}ue+=ye,$e+=dt}p.Ma+=ne}else alert("todo:EmitRescaledRowsYUVA");e(p.Ma<=C.height)}}p.C=v,e(p.C<=p.i)}function Ft(p){var v;if(0<p.ua)return 0;for(v=0;v<p.Wb;++v){var C=p.Ya[v].G,Q=p.Ya[v].H;if(0<C[1][Q[1]+0].g||0<C[2][Q[2]+0].g||0<C[3][Q[3]+0].g)return 0}return 1}function zt(p,v,C,Q,W,ne){if(p.Z!=0){var ie=p.qd,ue=p.rd;for(e(ja[p.Z]!=null);v<C;++v)ja[p.Z](ie,ue,Q,W,Q,W,ne),ie=Q,ue=W,W+=ne;p.qd=ie,p.rd=ue}}function Tt(p,v){var C=p.l.ma,Q=C.Z==0||C.Z==1?p.l.j:p.C;if(Q=p.C<Q?Q:p.C,e(v<=p.l.o),v>Q){var W=p.l.width,ne=C.ca,ie=C.tb+W*Q,ue=p.V,ye=p.Ba+p.c*Q,Ee=p.gc;e(p.ab==1),e(Ee[0].hc==3),sh(Ee[0],Q,v,ue,ye,ne,ie),zt(C,Q,v,ne,ie,W)}p.C=p.Ma=v}function Rt(p,v,C,Q,W,ne,ie){var ue=p.$/Q,ye=p.$%Q,Ee=p.m,$e=p.s,dt=C+p.$,ct=dt;W=C+Q*W;var et=C+Q*ne,Ut=280+$e.ua,wt=p.Pb?ue:16777216,Ve=0<$e.ua?$e.Wa:null,Ye=$e.wc,St=dt<et?Pt($e,ye,ue):null;e(p.C<ne),e(et<=W);var Qt=!1;e:for(;;){for(;Qt||dt<et;){var It=0;if(ue>=wt){var Xt=dt-C;e((wt=p).Pb),wt.wd=wt.m,wt.xd=Xt,0<wt.s.ua&&Y(wt.s.Wa,wt.s.vb),wt=ue+Yz}if(ye&Ye||(St=Pt($e,ye,ue)),e(St!=null),St.Qb&&(v[dt]=St.qb,Qt=!0),!Qt)if(M(Ee),St.jc){It=Ee,Xt=v;var jt=dt,cr=St.pd[E(It)&_o-1];e(St.jc),256>cr.g?(L(It,It.u+cr.g),Xt[jt]=cr.value,It=0):(L(It,It.u+cr.g-256),e(256<=cr.value),It=cr.value),It==0&&(Qt=!0)}else It=_t(St.G[0],St.H[0],Ee);if(Ee.h)break;if(Qt||256>It){if(!Qt)if(St.nd)v[dt]=(St.qb|It<<8)>>>0;else{if(M(Ee),Qt=_t(St.G[1],St.H[1],Ee),M(Ee),Xt=_t(St.G[2],St.H[2],Ee),jt=_t(St.G[3],St.H[3],Ee),Ee.h)break;v[dt]=(jt<<24|Qt<<16|It<<8|Xt)>>>0}if(Qt=!1,++dt,++ye>=Q&&(ye=0,++ue,ie!=null&&ue<=ne&&!(ue%16)&&ie(p,ue),Ve!=null))for(;ct<dt;)It=v[ct++],Ve.X[(506832829*It&4294967295)>>>Ve.Mb]=It}else if(280>It){if(It=xt(It-256,Ee),Xt=_t(St.G[4],St.H[4],Ee),M(Ee),Xt=Lt(Q,Xt=xt(Xt,Ee)),Ee.h)break;if(dt-C<Xt||W-dt<It)break e;for(jt=0;jt<It;++jt)v[dt+jt]=v[dt+jt-Xt];for(dt+=It,ye+=It;ye>=Q;)ye-=Q,++ue,ie!=null&&ue<=ne&&!(ue%16)&&ie(p,ue);if(e(dt<=W),ye&Ye&&(St=Pt($e,ye,ue)),Ve!=null)for(;ct<dt;)It=v[ct++],Ve.X[(506832829*It&4294967295)>>>Ve.Mb]=It}else{if(!(It<Ut))break e;for(Qt=It-280,e(Ve!=null);ct<dt;)It=v[ct++],Ve.X[(506832829*It&4294967295)>>>Ve.Mb]=It;It=dt,e(!(Qt>>>(Xt=Ve).Xa)),v[It]=Xt.X[Qt],Qt=!0}Qt||e(Ee.h==I(Ee))}if(p.Pb&&Ee.h&&dt<W)e(p.m.h),p.a=5,p.m=p.wd,p.$=p.xd,0<p.s.ua&&Y(p.s.vb,p.s.Wa);else{if(Ee.h)break e;ie!=null&&ie(p,ue>ne?ne:ue),p.a=0,p.$=dt-C}return 1}return p.a=3,0}function Dt(p){e(p!=null),p.vc=null,p.yc=null,p.Ya=null;var v=p.Wa;v!=null&&(v.X=null),p.vb=null,e(p!=null)}function Mt(){var p=new Hg;return p==null?null:(p.a=0,p.xb=d2,_e("Predictor","VP8LPredictors"),_e("Predictor","VP8LPredictors_C"),_e("PredictorAdd","VP8LPredictorsAdd"),_e("PredictorAdd","VP8LPredictorsAdd_C"),oh=fe,TA=ge,ss=Ne,qo=Ze,Da=Oe,ra=Ke,na=Je,j.VP8LMapColor32b=Tl,j.VP8LMapColor8b=ih,p)}function Gt(p,v,C,Q,W){var ne=1,ie=[p],ue=[v],ye=Q.m,Ee=Q.s,$e=null,dt=0;e:for(;;){if(C)for(;ne&&oe(ye,1);){var ct=ie,et=ue,Ut=Q,wt=1,Ve=Ut.m,Ye=Ut.gc[Ut.ab],St=oe(Ve,2);if(Ut.Oc&1<<St)ne=0;else{switch(Ut.Oc|=1<<St,Ye.hc=St,Ye.Ea=ct[0],Ye.nc=et[0],Ye.K=[null],++Ut.ab,e(4>=Ut.ab),St){case 0:case 1:Ye.b=oe(Ve,3)+2,wt=Gt(xe(Ye.Ea,Ye.b),xe(Ye.nc,Ye.b),0,Ut,Ye.K),Ye.K=Ye.K[0];break;case 3:var Qt,It=oe(Ve,8)+1,Xt=16<It?0:4<It?1:2<It?2:3;if(ct[0]=xe(Ye.Ea,Xt),Ye.b=Xt,Qt=wt=Gt(It,1,0,Ut,Ye.K)){var jt,cr=It,qt=Ye,Jr=1<<(8>>qt.b),sn=s(Jr);if(sn==null)Qt=0;else{var Vr=qt.K[0],Or=qt.w;for(sn[0]=qt.K[0][0],jt=1;jt<1*cr;++jt)sn[jt]=me(Vr[Or+jt],sn[jt-1]);for(;jt<4*Jr;++jt)sn[jt]=0;qt.K[0]=null,qt.K[0]=sn,Qt=1}}wt=Qt;break;case 2:break;default:e(0)}ne=wt}}if(ie=ie[0],ue=ue[0],ne&&oe(ye,1)&&!(ne=1<=(dt=oe(ye,4))&&11>=dt)){Q.a=3;break e}var mn;if(mn=ne)t:{var un,Er,ro,is=Q,no=ie,as=ue,an=dt,zs=C,Cs=is.m,fo=is.s,Bo=[null],$o=1,Ks=0,Qi=Xz[an];r:for(;;){if(zs&&oe(Cs,1)){var po=oe(Cs,3)+2,aa=xe(no,po),DA=xe(as,po),Dl=aa*DA;if(!Gt(aa,DA,0,is,Bo))break r;for(Bo=Bo[0],fo.xc=po,un=0;un<Dl;++un){var Ra=Bo[un]>>8&65535;Bo[un]=Ra,Ra>=$o&&($o=Ra+1)}}if(Cs.h)break r;for(Er=0;5>Er;++Er){var Nn=A2[Er];!Er&&0<an&&(Nn+=1<<an),Ks<Nn&&(Ks=Nn)}var Yg=i($o*Qi,N),m2=$o,w2=i(m2,se);if(w2==null)var mh=null;else e(65536>=m2),mh=w2;var Ec=s(Ks);if(mh==null||Ec==null||Yg==null){is.a=1;break r}var wh=Yg;for(un=ro=0;un<$o;++un){var si=mh[un],Nl=si.G,Ml=si.H,y2=0,yh=1,b2=0;for(Er=0;5>Er;++Er){Nn=A2[Er],Nl[Er]=wh,Ml[Er]=ro,!Er&&0<an&&(Nn+=1<<an);o:{var bh,Jg=Nn,_h=is,Fc=Ec,vC=wh,mC=ro,Zg=0,qa=_h.m,wC=oe(qa,1);if(o(Fc,0,0,Jg),wC){var yC=oe(qa,1)+1,bC=oe(qa,1),_2=oe(qa,bC==0?1:8);Fc[_2]=1,yC==2&&(Fc[_2=oe(qa,8)]=1);var Bh=1}else{var B2=s(19),x2=oe(qa,4)+4;if(19<x2){_h.a=3;var xh=0;break o}for(bh=0;bh<x2;++bh)B2[Gz[bh]]=oe(qa,3);var ev=void 0,Ic=void 0,z2=_h,_C=B2,zh=Jg,C2=Fc,tv=0,Ka=z2.m,S2=8,E2=i(128,N);n:for(;D(E2,0,7,_C,19);){if(oe(Ka,1)){var BC=2+2*oe(Ka,3);if((ev=2+oe(Ka,BC))>zh)break n}else ev=zh;for(Ic=0;Ic<zh&&ev--;){M(Ka);var F2=E2[0+(127&E(Ka))];L(Ka,Ka.u+F2.g);var Hl=F2.value;if(16>Hl)C2[Ic++]=Hl,Hl!=0&&(S2=Hl);else{var xC=Hl==16,I2=Hl-16,zC=$z[I2],U2=oe(Ka,Kz[I2])+zC;if(Ic+U2>zh)break n;for(var CC=xC?S2:0;0<U2--;)C2[Ic++]=CC}}tv=1;break n}tv||(z2.a=3),Bh=tv}(Bh=Bh&&!qa.h)&&(Zg=D(vC,mC,8,Fc,Jg)),Bh&&Zg!=0?xh=Zg:(_h.a=3,xh=0)}if(xh==0)break r;if(yh&&Vz[Er]==1&&(yh=wh[ro].g==0),y2+=wh[ro].g,ro+=xh,3>=Er){var Uc,rv=Ec[0];for(Uc=1;Uc<Nn;++Uc)Ec[Uc]>rv&&(rv=Ec[Uc]);b2+=rv}}if(si.nd=yh,si.Qb=0,yh&&(si.qb=(Nl[3][Ml[3]+0].value<<24|Nl[1][Ml[1]+0].value<<16|Nl[2][Ml[2]+0].value)>>>0,y2==0&&256>Nl[0][Ml[0]+0].value&&(si.Qb=1,si.qb+=Nl[0][Ml[0]+0].value<<8)),si.jc=!si.Qb&&6>b2,si.jc){var Ch,Aa=si;for(Ch=0;Ch<_o;++Ch){var $a=Ch,Va=Aa.pd[$a],Sh=Aa.G[0][Aa.H[0]+$a];256<=Sh.value?(Va.g=Sh.g+256,Va.value=Sh.value):(Va.g=0,Va.value=0,$a>>=vt(Sh,8,Va),$a>>=vt(Aa.G[1][Aa.H[1]+$a],16,Va),$a>>=vt(Aa.G[2][Aa.H[2]+$a],0,Va),vt(Aa.G[3][Aa.H[3]+$a],24,Va))}}}fo.vc=Bo,fo.Wb=$o,fo.Ya=mh,fo.yc=Yg,mn=1;break t}mn=0}if(!(ne=mn)){Q.a=3;break e}if(0<dt){if(Ee.ua=1<<dt,!Le(Ee.Wa,dt)){Q.a=1,ne=0;break e}}else Ee.ua=0;var nv=Q,Q2=ie,SC=ue,ov=nv.s,sv=ov.xc;if(nv.c=Q2,nv.i=SC,ov.md=xe(Q2,sv),ov.wc=sv==0?-1:(1<<sv)-1,C){Q.xb=oC;break e}if(($e=s(ie*ue))==null){Q.a=1,ne=0;break e}ne=(ne=Rt(Q,$e,0,ie,ue,ue,null))&&!ye.h;break e}return ne?(W!=null?W[0]=$e:(e($e==null),e(C)),Q.$=0,C||Dt(Ee)):Dt(Ee),ne}function lr(p,v){var C=p.c*p.i,Q=C+v+16*v;return e(p.c<=v),p.V=s(Q),p.V==null?(p.Ta=null,p.Ua=0,p.a=1,0):(p.Ta=p.V,p.Ua=p.Ba+C+v,1)}function tr(p,v){var C=p.C,Q=v-C,W=p.V,ne=p.Ba+p.c*C;for(e(v<=p.l.o);0<Q;){var ie=16<Q?16:Q,ue=p.l.ma,ye=p.l.width,Ee=ye*ie,$e=ue.ca,dt=ue.tb+ye*C,ct=p.Ta,et=p.Ua;kt(p,ie,W,ne),qn(ct,et,$e,dt,Ee),zt(ue,C,C+ie,$e,dt,ye),Q-=ie,W+=ie*p.c,C+=ie}e(C==v),p.C=p.Ma=v}function sr(){this.ub=this.yd=this.td=this.Rb=0}function Ht(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function mr(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function kr(){this.Yb=function(){var p=[];return function v(C,Q,W){for(var ne=W[Q],ie=0;ie<ne&&(C.push(W.length>Q+1?[]:0),!(W.length<Q+1));ie++)v(C[ie],Q+1,W)}(p,0,[3,11]),p}()}function Kr(){this.jb=s(3),this.Wc=a([4,8],kr),this.Xc=a([4,17],kr)}function Sr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function fr(){this.ld=this.La=this.dd=this.tc=0}function Lr(){this.Na=this.la=0}function xr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ar(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function pr(){this.uc=this.M=this.Nb=0,this.wa=Array(new fr),this.Y=0,this.ya=Array(new Ar),this.aa=0,this.l=new vn}function Pr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function gn(){this.cb=this.a=0,this.sc="",this.m=new ae,this.Od=new sr,this.Kc=new Ht,this.ed=new Sr,this.Qa=new mr,this.Ic=this.$c=this.Aa=0,this.D=new pr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,ae),this.ia=0,this.pb=i(4,xr),this.Pa=new Kr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Pr),this.Hd=0,this.rb=Array(new Lr),this.sb=0,this.wa=Array(new fr),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ar),this.L=this.aa=0,this.gd=a([4,2],fr),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function vn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function zr(){var p=new gn;return p!=null&&(p.a=0,p.sc="OK",p.cb=0,p.Xb=0,Cc||(Cc=io)),p}function dr(p,v,C){return p.a==0&&(p.a=v,p.sc=C,p.cb=0),0}function xn(p,v,C){return 3<=C&&p[v+0]==157&&p[v+1]==1&&p[v+2]==42}function Fo(p,v){if(p==null)return 0;if(p.a=0,p.sc="OK",v==null)return dr(p,2,"null VP8Io passed to VP8GetHeaders()");var C=v.data,Q=v.w,W=v.ha;if(4>W)return dr(p,7,"Truncated header.");var ne=C[Q+0]|C[Q+1]<<8|C[Q+2]<<16,ie=p.Od;if(ie.Rb=!(1&ne),ie.td=ne>>1&7,ie.yd=ne>>4&1,ie.ub=ne>>5,3<ie.td)return dr(p,3,"Incorrect keyframe parameters.");if(!ie.yd)return dr(p,4,"Frame not displayable.");Q+=3,W-=3;var ue=p.Kc;if(ie.Rb){if(7>W)return dr(p,7,"cannot parse picture header");if(!xn(C,Q,W))return dr(p,3,"Bad code word");ue.c=16383&(C[Q+4]<<8|C[Q+3]),ue.Td=C[Q+4]>>6,ue.i=16383&(C[Q+6]<<8|C[Q+5]),ue.Ud=C[Q+6]>>6,Q+=7,W-=7,p.za=ue.c+15>>4,p.Ub=ue.i+15>>4,v.width=ue.c,v.height=ue.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,o((ne=p.Pa).jb,0,255,ne.jb.length),e((ne=p.Qa)!=null),ne.Cb=0,ne.Bb=0,ne.Fb=1,o(ne.Zb,0,0,ne.Zb.length),o(ne.Lb,0,0,ne.Lb)}if(ie.ub>W)return dr(p,7,"bad partition length");ce(ne=p.m,C,Q,ie.ub),Q+=ie.ub,W-=ie.ub,ie.Rb&&(ue.Ld=q(ne),ue.Kd=q(ne)),ue=p.Qa;var ye,Ee=p.Pa;if(e(ne!=null),e(ue!=null),ue.Cb=q(ne),ue.Cb){if(ue.Bb=q(ne),q(ne)){for(ue.Fb=q(ne),ye=0;4>ye;++ye)ue.Zb[ye]=q(ne)?pe(ne,7):0;for(ye=0;4>ye;++ye)ue.Lb[ye]=q(ne)?pe(ne,6):0}if(ue.Bb)for(ye=0;3>ye;++ye)Ee.jb[ye]=q(ne)?re(ne,8):255}else ue.Bb=0;if(ne.Ka)return dr(p,3,"cannot parse segment header");if((ue=p.ed).zd=q(ne),ue.Tb=re(ne,6),ue.wb=re(ne,3),ue.Pc=q(ne),ue.Pc&&q(ne)){for(Ee=0;4>Ee;++Ee)q(ne)&&(ue.vd[Ee]=pe(ne,6));for(Ee=0;4>Ee;++Ee)q(ne)&&(ue.od[Ee]=pe(ne,6))}if(p.L=ue.Tb==0?0:ue.zd?1:2,ne.Ka)return dr(p,3,"cannot parse filter header");var $e=W;if(W=ye=Q,Q=ye+$e,ue=$e,p.Xb=(1<<re(p.m,2))-1,$e<3*(Ee=p.Xb))C=7;else{for(ye+=3*Ee,ue-=3*Ee,$e=0;$e<Ee;++$e){var dt=C[W+0]|C[W+1]<<8|C[W+2]<<16;dt>ue&&(dt=ue),ce(p.Jc[+$e],C,ye,dt),ye+=dt,ue-=dt,W+=3}ce(p.Jc[+Ee],C,ye,ue),C=ye<Q?0:5}if(C!=0)return dr(p,C,"cannot parse partitions");for(C=re(ye=p.m,7),W=q(ye)?pe(ye,4):0,Q=q(ye)?pe(ye,4):0,ue=q(ye)?pe(ye,4):0,Ee=q(ye)?pe(ye,4):0,ye=q(ye)?pe(ye,4):0,$e=p.Qa,dt=0;4>dt;++dt){if($e.Cb){var ct=$e.Zb[dt];$e.Fb||(ct+=C)}else{if(0<dt){p.pb[dt]=p.pb[0];continue}ct=C}var et=p.pb[dt];et.Sc[0]=Gg[Bs(ct+W,127)],et.Sc[1]=Wg[Bs(ct+0,127)],et.Eb[0]=2*Gg[Bs(ct+Q,127)],et.Eb[1]=101581*Wg[Bs(ct+ue,127)]>>16,8>et.Eb[1]&&(et.Eb[1]=8),et.Qc[0]=Gg[Bs(ct+Ee,117)],et.Qc[1]=Wg[Bs(ct+ye,127)],et.lc=ct+ye}if(!ie.Rb)return dr(p,4,"Not a key frame.");for(q(ne),ie=p.Pa,C=0;4>C;++C){for(W=0;8>W;++W)for(Q=0;3>Q;++Q)for(ue=0;11>ue;++ue)Ee=G(ne,rC[C][W][Q][ue])?re(ne,8):eC[C][W][Q][ue],ie.Wc[C][W].Yb[Q][ue]=Ee;for(W=0;17>W;++W)ie.Xc[C][W]=ie.Wc[C][nC[W]]}return p.kc=q(ne),p.kc&&(p.Bd=re(ne,8)),p.cb=1}function io(p,v,C,Q,W,ne,ie){var ue=v[W].Yb[C];for(C=0;16>W;++W){if(!G(p,ue[C+0]))return W;for(;!G(p,ue[C+1]);)if(ue=v[++W].Yb[0],C=0,W==16)return 16;var ye=v[W+1].Yb;if(G(p,ue[C+2])){var Ee=p,$e=0;if(G(Ee,(ct=ue)[(dt=C)+3]))if(G(Ee,ct[dt+6])){for(ue=0,dt=2*($e=G(Ee,ct[dt+8]))+(ct=G(Ee,ct[dt+9+$e])),$e=0,ct=Jz[dt];ct[ue];++ue)$e+=$e+G(Ee,ct[ue]);$e+=3+(8<<dt)}else G(Ee,ct[dt+7])?($e=7+2*G(Ee,165),$e+=G(Ee,145)):$e=5+G(Ee,159);else $e=G(Ee,ct[dt+4])?3+G(Ee,ct[dt+5]):2;ue=ye[2]}else $e=1,ue=ye[1];ye=ie+Zz[W],0>(Ee=p).b&&H(Ee);var dt,ct=Ee.b,et=(dt=Ee.Ca>>1)-(Ee.I>>ct)>>31;--Ee.b,Ee.Ca+=et,Ee.Ca|=1,Ee.I-=(dt+1&et)<<ct,ne[ye]=(($e^et)-et)*Q[(0<W)+0]}return 16}function bo(p){var v=p.rb[p.sb-1];v.la=0,v.Na=0,o(p.zc,0,0,p.zc.length),p.ja=0}function ns(p,v){if(p==null)return 0;if(v==null)return dr(p,2,"NULL VP8Io parameter in VP8Decode().");if(!p.cb&&!Fo(p,v))return 0;if(e(p.cb),v.ac==null||v.ac(v)){v.ob&&(p.L=0);var C=vh[p.L];if(p.L==2?(p.yb=0,p.zb=0):(p.yb=v.v-C>>4,p.zb=v.j-C>>4,0>p.yb&&(p.yb=0),0>p.zb&&(p.zb=0)),p.Va=v.o+15+C>>4,p.Hb=v.va+15+C>>4,p.Hb>p.za&&(p.Hb=p.za),p.Va>p.Ub&&(p.Va=p.Ub),0<p.L){var Q=p.ed;for(C=0;4>C;++C){var W;if(p.Qa.Cb){var ne=p.Qa.Lb[C];p.Qa.Fb||(ne+=Q.Tb)}else ne=Q.Tb;for(W=0;1>=W;++W){var ie=p.gd[C][W],ue=ne;if(Q.Pc&&(ue+=Q.vd[0],W&&(ue+=Q.od[0])),0<(ue=0>ue?0:63<ue?63:ue)){var ye=ue;0<Q.wb&&(ye=4<Q.wb?ye>>2:ye>>1)>9-Q.wb&&(ye=9-Q.wb),1>ye&&(ye=1),ie.dd=ye,ie.tc=2*ue+ye,ie.ld=40<=ue?2:15<=ue?1:0}else ie.tc=0;ie.La=W}}}C=0}else dr(p,6,"Frame setup failed"),C=p.a;if(C=C==0){if(C){p.$c=0,0<p.Aa||(p.Ic=gC);e:{C=p.Ic,Q=4*(ye=p.za);var Ee=32*ye,$e=ye+1,dt=0<p.L?ye*(0<p.Aa?2:1):0,ct=(p.Aa==2?2:1)*ye;if((ie=Q+832+(W=3*(16*C+vh[p.L])/2*Ee)+(ne=p.Fa!=null&&0<p.Fa.length?p.Kc.c*p.Kc.i:0))!=ie)C=0;else{if(ie>p.Vb){if(p.Vb=0,p.Ec=s(ie),p.Fc=0,p.Ec==null){C=dr(p,1,"no memory during frame initialization.");break e}p.Vb=ie}ie=p.Ec,ue=p.Fc,p.Ac=ie,p.Bc=ue,ue+=Q,p.Gd=i(Ee,Pr),p.Hd=0,p.rb=i($e+1,Lr),p.sb=1,p.wa=dt?i(dt,fr):null,p.Y=0,p.D.Nb=0,p.D.wa=p.wa,p.D.Y=p.Y,0<p.Aa&&(p.D.Y+=ye),e(!0),p.oc=ie,p.pc=ue,ue+=832,p.ya=i(ct,Ar),p.aa=0,p.D.ya=p.ya,p.D.aa=p.aa,p.Aa==2&&(p.D.aa+=ye),p.R=16*ye,p.B=8*ye,ye=(Ee=vh[p.L])*p.R,Ee=Ee/2*p.B,p.sa=ie,p.ta=ue+ye,p.qa=p.sa,p.ra=p.ta+16*C*p.R+Ee,p.Ha=p.qa,p.Ia=p.ra+8*C*p.B+Ee,p.$c=0,ue+=W,p.mb=ne?ie:null,p.nb=ne?ue:null,e(ue+ne<=p.Fc+p.Vb),bo(p),o(p.Ac,p.Bc,0,Q),C=1}}if(C){if(v.ka=0,v.y=p.sa,v.O=p.ta,v.f=p.qa,v.N=p.ra,v.ea=p.Ha,v.Vd=p.Ia,v.fa=p.R,v.Rc=p.B,v.F=null,v.J=0,!Ah){for(C=-255;255>=C;++C)ao[255+C]=0>C?-C:C;for(C=-1020;1020>=C;++C)sa[1020+C]=-128>C?-128:127<C?127:C;for(C=-112;112>=C;++C)zc[112+C]=-16>C?-16:15<C?15:C;for(C=-255;510>=C;++C)Ol[255+C]=0>C?0:255<C?255:C;Ah=1}Ll=ks,oa=ys,_c=Uo,Ko=bs,Ms=eo,Rn=Fn,Pl=lc,ah=UA,Bc=Mg,LA=dc,PA=Ng,Na=zl,kA=cc,kl=th,OA=eh,Ma=Ii,xc=ta,Hs=Dg,oi[0]=cn,oi[1]=Si,oi[2]=Qr,oi[3]=Yr,oi[4]=_s,oi[5]=Ds,oi[6]=ti,oi[7]=Fi,oi[8]=ic,oi[9]=sc,Ha[0]=Ei,Ha[1]=or,Ha[2]=on,Ha[3]=Qo,Ha[4]=Qn,Ha[5]=ei,Ha[6]=Ta,ia[0]=La,ia[1]=EA,ia[2]=kg,ia[3]=ac,ia[4]=IA,ia[5]=Og,ia[6]=Ac,C=1}else C=0}C&&(C=function(et,Ut){for(et.M=0;et.M<et.Va;++et.M){var wt,Ve=et.Jc[et.M&et.Xb],Ye=et.m,St=et;for(wt=0;wt<St.za;++wt){var Qt=Ye,It=St,Xt=It.Ac,jt=It.Bc+4*wt,cr=It.zc,qt=It.ya[It.aa+wt];if(It.Qa.Bb?qt.$b=G(Qt,It.Pa.jb[0])?2+G(Qt,It.Pa.jb[2]):G(Qt,It.Pa.jb[1]):qt.$b=0,It.kc&&(qt.Ad=G(Qt,It.Bd)),qt.Za=!G(Qt,145)+0,qt.Za){var Jr=qt.Ob,sn=0;for(It=0;4>It;++It){var Vr,Or=cr[0+It];for(Vr=0;4>Vr;++Vr){Or=tC[Xt[jt+Vr]][Or];for(var mn=l2[G(Qt,Or[0])];0<mn;)mn=l2[2*mn+G(Qt,Or[mn])];Or=-mn,Xt[jt+Vr]=Or}r(Jr,sn,Xt,jt,4),sn+=4,cr[0+It]=Or}}else Or=G(Qt,156)?G(Qt,128)?1:3:G(Qt,163)?2:0,qt.Ob[0]=Or,o(Xt,jt,Or,4),o(cr,0,Or,4);qt.Dd=G(Qt,142)?G(Qt,114)?G(Qt,183)?1:3:2:0}if(St.m.Ka)return dr(et,7,"Premature end-of-partition0 encountered.");for(;et.ja<et.za;++et.ja){if(St=Ve,Qt=(Ye=et).rb[Ye.sb-1],Xt=Ye.rb[Ye.sb+Ye.ja],wt=Ye.ya[Ye.aa+Ye.ja],jt=Ye.kc?wt.Ad:0)Qt.la=Xt.la=0,wt.Za||(Qt.Na=Xt.Na=0),wt.Hc=0,wt.Gc=0,wt.ia=0;else{var un,Er;if(Qt=Xt,Xt=St,jt=Ye.Pa.Xc,cr=Ye.ya[Ye.aa+Ye.ja],qt=Ye.pb[cr.$b],It=cr.ad,Jr=0,sn=Ye.rb[Ye.sb-1],Or=Vr=0,o(It,Jr,0,384),cr.Za)var ro=0,is=jt[3];else{mn=s(16);var no=Qt.Na+sn.Na;if(no=Cc(Xt,jt[1],no,qt.Eb,0,mn,0),Qt.Na=sn.Na=(0<no)+0,1<no)Ll(mn,0,It,Jr);else{var as=mn[0]+3>>3;for(mn=0;256>mn;mn+=16)It[Jr+mn]=as}ro=1,is=jt[0]}var an=15&Qt.la,zs=15&sn.la;for(mn=0;4>mn;++mn){var Cs=1&zs;for(as=Er=0;4>as;++as)an=an>>1|(Cs=(no=Cc(Xt,is,no=Cs+(1&an),qt.Sc,ro,It,Jr))>ro)<<7,Er=Er<<2|(3<no?3:1<no?2:It[Jr+0]!=0),Jr+=16;an>>=4,zs=zs>>1|Cs<<7,Vr=(Vr<<8|Er)>>>0}for(is=an,ro=zs>>4,un=0;4>un;un+=2){for(Er=0,an=Qt.la>>4+un,zs=sn.la>>4+un,mn=0;2>mn;++mn){for(Cs=1&zs,as=0;2>as;++as)no=Cs+(1&an),an=an>>1|(Cs=0<(no=Cc(Xt,jt[2],no,qt.Qc,0,It,Jr)))<<3,Er=Er<<2|(3<no?3:1<no?2:It[Jr+0]!=0),Jr+=16;an>>=2,zs=zs>>1|Cs<<5}Or|=Er<<4*un,is|=an<<4<<un,ro|=(240&zs)<<un}Qt.la=is,sn.la=ro,cr.Hc=Vr,cr.Gc=Or,cr.ia=43690&Or?0:qt.ia,jt=!(Vr|Or)}if(0<Ye.L&&(Ye.wa[Ye.Y+Ye.ja]=Ye.gd[wt.$b][wt.Za],Ye.wa[Ye.Y+Ye.ja].La|=!jt),St.Ka)return dr(et,7,"Premature end-of-file encountered.")}if(bo(et),Ye=Ut,St=1,wt=(Ve=et).D,Qt=0<Ve.L&&Ve.M>=Ve.zb&&Ve.M<=Ve.Va,Ve.Aa==0)e:{if(wt.M=Ve.M,wt.uc=Qt,vc(Ve,wt),St=1,wt=(Er=Ve.D).Nb,Qt=(Or=vh[Ve.L])*Ve.R,Xt=Or/2*Ve.B,mn=16*wt*Ve.R,as=8*wt*Ve.B,jt=Ve.sa,cr=Ve.ta-Qt+mn,qt=Ve.qa,It=Ve.ra-Xt+as,Jr=Ve.Ha,sn=Ve.Ia-Xt+as,zs=(an=Er.M)==0,Vr=an>=Ve.Va-1,Ve.Aa==2&&vc(Ve,Er),Er.uc)for(Cs=(no=Ve).D.M,e(no.D.uc),Er=no.yb;Er<no.Hb;++Er){ro=Er,is=Cs;var fo=(Bo=(Nn=no).D).Nb;un=Nn.R;var Bo=Bo.wa[Bo.Y+ro],$o=Nn.sa,Ks=Nn.ta+16*fo*un+16*ro,Qi=Bo.dd,po=Bo.tc;if(po!=0)if(e(3<=po),Nn.L==1)0<ro&&Ma($o,Ks,un,po+4),Bo.La&&Hs($o,Ks,un,po),0<is&&OA($o,Ks,un,po+4),Bo.La&&xc($o,Ks,un,po);else{var aa=Nn.B,DA=Nn.qa,Dl=Nn.ra+8*fo*aa+8*ro,Ra=Nn.Ha,Nn=Nn.Ia+8*fo*aa+8*ro;fo=Bo.ld,0<ro&&(ah($o,Ks,un,po+4,Qi,fo),LA(DA,Dl,Ra,Nn,aa,po+4,Qi,fo)),Bo.La&&(Na($o,Ks,un,po,Qi,fo),kl(DA,Dl,Ra,Nn,aa,po,Qi,fo)),0<is&&(Pl($o,Ks,un,po+4,Qi,fo),Bc(DA,Dl,Ra,Nn,aa,po+4,Qi,fo)),Bo.La&&(PA($o,Ks,un,po,Qi,fo),kA(DA,Dl,Ra,Nn,aa,po,Qi,fo))}}if(Ve.ia&&alert("todo:DitherRow"),Ye.put!=null){if(Er=16*an,an=16*(an+1),zs?(Ye.y=Ve.sa,Ye.O=Ve.ta+mn,Ye.f=Ve.qa,Ye.N=Ve.ra+as,Ye.ea=Ve.Ha,Ye.W=Ve.Ia+as):(Er-=Or,Ye.y=jt,Ye.O=cr,Ye.f=qt,Ye.N=It,Ye.ea=Jr,Ye.W=sn),Vr||(an-=Or),an>Ye.o&&(an=Ye.o),Ye.F=null,Ye.J=null,Ve.Fa!=null&&0<Ve.Fa.length&&Er<an&&(Ye.J=pc(Ve,Ye,Er,an-Er),Ye.F=Ve.mb,Ye.F==null&&Ye.F.length==0)){St=dr(Ve,3,"Could not decode alpha data.");break e}Er<Ye.j&&(Or=Ye.j-Er,Er=Ye.j,e(!(1&Or)),Ye.O+=Ve.R*Or,Ye.N+=Ve.B*(Or>>1),Ye.W+=Ve.B*(Or>>1),Ye.F!=null&&(Ye.J+=Ye.width*Or)),Er<an&&(Ye.O+=Ye.v,Ye.N+=Ye.v>>1,Ye.W+=Ye.v>>1,Ye.F!=null&&(Ye.J+=Ye.v),Ye.ka=Er-Ye.j,Ye.U=Ye.va-Ye.v,Ye.T=an-Er,St=Ye.put(Ye))}wt+1!=Ve.Ic||Vr||(r(Ve.sa,Ve.ta-Qt,jt,cr+16*Ve.R,Qt),r(Ve.qa,Ve.ra-Xt,qt,It+8*Ve.B,Xt),r(Ve.Ha,Ve.Ia-Xt,Jr,sn+8*Ve.B,Xt))}if(!St)return dr(et,6,"Output aborted.")}return 1}(p,v)),v.bc!=null&&v.bc(v),C&=1}return C?(p.cb=0,C):0}function On(p,v,C,Q,W){W=p[v+C+32*Q]+(W>>3),p[v+C+32*Q]=-256&W?0>W?0:255:W}function Io(p,v,C,Q,W,ne){On(p,v,0,C,Q+W),On(p,v,1,C,Q+ne),On(p,v,2,C,Q-ne),On(p,v,3,C,Q-W)}function Wt(p){return(20091*p>>16)+p}function $r(p,v,C,Q){var W,ne=0,ie=s(16);for(W=0;4>W;++W){var ue=p[v+0]+p[v+8],ye=p[v+0]-p[v+8],Ee=(35468*p[v+4]>>16)-Wt(p[v+12]),$e=Wt(p[v+4])+(35468*p[v+12]>>16);ie[ne+0]=ue+$e,ie[ne+1]=ye+Ee,ie[ne+2]=ye-Ee,ie[ne+3]=ue-$e,ne+=4,v++}for(W=ne=0;4>W;++W)ue=(p=ie[ne+0]+4)+ie[ne+8],ye=p-ie[ne+8],Ee=(35468*ie[ne+4]>>16)-Wt(ie[ne+12]),On(C,Q,0,0,ue+($e=Wt(ie[ne+4])+(35468*ie[ne+12]>>16))),On(C,Q,1,0,ye+Ee),On(C,Q,2,0,ye-Ee),On(C,Q,3,0,ue-$e),ne++,Q+=32}function Fn(p,v,C,Q){var W=p[v+0]+4,ne=35468*p[v+4]>>16,ie=Wt(p[v+4]),ue=35468*p[v+1]>>16;Io(C,Q,0,W+ie,p=Wt(p[v+1]),ue),Io(C,Q,1,W+ne,p,ue),Io(C,Q,2,W-ne,p,ue),Io(C,Q,3,W-ie,p,ue)}function ys(p,v,C,Q,W){$r(p,v,C,Q),W&&$r(p,v+16,C,Q+4)}function Uo(p,v,C,Q){oa(p,v+0,C,Q,1),oa(p,v+32,C,Q+128,1)}function bs(p,v,C,Q){var W;for(p=p[v+0]+4,W=0;4>W;++W)for(v=0;4>v;++v)On(C,Q,v,W,p)}function eo(p,v,C,Q){p[v+0]&&Ko(p,v+0,C,Q),p[v+16]&&Ko(p,v+16,C,Q+4),p[v+32]&&Ko(p,v+32,C,Q+128),p[v+48]&&Ko(p,v+48,C,Q+128+4)}function ks(p,v,C,Q){var W,ne=s(16);for(W=0;4>W;++W){var ie=p[v+0+W]+p[v+12+W],ue=p[v+4+W]+p[v+8+W],ye=p[v+4+W]-p[v+8+W],Ee=p[v+0+W]-p[v+12+W];ne[0+W]=ie+ue,ne[8+W]=ie-ue,ne[4+W]=Ee+ye,ne[12+W]=Ee-ye}for(W=0;4>W;++W)ie=(p=ne[0+4*W]+3)+ne[3+4*W],ue=ne[1+4*W]+ne[2+4*W],ye=ne[1+4*W]-ne[2+4*W],Ee=p-ne[3+4*W],C[Q+0]=ie+ue>>3,C[Q+16]=Ee+ye>>3,C[Q+32]=ie-ue>>3,C[Q+48]=Ee-ye>>3,Q+=64}function Ci(p,v,C){var Q,W=v-32,ne=xs,ie=255-p[W-1];for(Q=0;Q<C;++Q){var ue,ye=ne,Ee=ie+p[v-1];for(ue=0;ue<C;++ue)p[v+ue]=ye[Ee+p[W+ue]];v+=32}}function Si(p,v){Ci(p,v,4)}function EA(p,v){Ci(p,v,8)}function or(p,v){Ci(p,v,16)}function on(p,v){var C;for(C=0;16>C;++C)r(p,v+32*C,p,v-32,16)}function Qo(p,v){var C;for(C=16;0<C;--C)o(p,v,p[v-1],16),v+=32}function Os(p,v,C){var Q;for(Q=0;16>Q;++Q)o(v,C+32*Q,p,16)}function Ei(p,v){var C,Q=16;for(C=0;16>C;++C)Q+=p[v-1+32*C]+p[v+C-32];Os(Q>>5,p,v)}function Qn(p,v){var C,Q=8;for(C=0;16>C;++C)Q+=p[v-1+32*C];Os(Q>>4,p,v)}function ei(p,v){var C,Q=8;for(C=0;16>C;++C)Q+=p[v+C-32];Os(Q>>4,p,v)}function Ta(p,v){Os(128,p,v)}function yr(p,v,C){return p+2*v+C+2>>2}function Qr(p,v){var C,Q=v-32;for(Q=new Uint8Array([yr(p[Q-1],p[Q+0],p[Q+1]),yr(p[Q+0],p[Q+1],p[Q+2]),yr(p[Q+1],p[Q+2],p[Q+3]),yr(p[Q+2],p[Q+3],p[Q+4])]),C=0;4>C;++C)r(p,v+32*C,Q,0,Q.length)}function Yr(p,v){var C=p[v-1],Q=p[v-1+32],W=p[v-1+64],ne=p[v-1+96];R(p,v+0,16843009*yr(p[v-1-32],C,Q)),R(p,v+32,16843009*yr(C,Q,W)),R(p,v+64,16843009*yr(Q,W,ne)),R(p,v+96,16843009*yr(W,ne,ne))}function cn(p,v){var C,Q=4;for(C=0;4>C;++C)Q+=p[v+C-32]+p[v-1+32*C];for(Q>>=3,C=0;4>C;++C)o(p,v+32*C,Q,4)}function _s(p,v){var C=p[v-1+0],Q=p[v-1+32],W=p[v-1+64],ne=p[v-1-32],ie=p[v+0-32],ue=p[v+1-32],ye=p[v+2-32],Ee=p[v+3-32];p[v+0+96]=yr(Q,W,p[v-1+96]),p[v+1+96]=p[v+0+64]=yr(C,Q,W),p[v+2+96]=p[v+1+64]=p[v+0+32]=yr(ne,C,Q),p[v+3+96]=p[v+2+64]=p[v+1+32]=p[v+0+0]=yr(ie,ne,C),p[v+3+64]=p[v+2+32]=p[v+1+0]=yr(ue,ie,ne),p[v+3+32]=p[v+2+0]=yr(ye,ue,ie),p[v+3+0]=yr(Ee,ye,ue)}function ti(p,v){var C=p[v+1-32],Q=p[v+2-32],W=p[v+3-32],ne=p[v+4-32],ie=p[v+5-32],ue=p[v+6-32],ye=p[v+7-32];p[v+0+0]=yr(p[v+0-32],C,Q),p[v+1+0]=p[v+0+32]=yr(C,Q,W),p[v+2+0]=p[v+1+32]=p[v+0+64]=yr(Q,W,ne),p[v+3+0]=p[v+2+32]=p[v+1+64]=p[v+0+96]=yr(W,ne,ie),p[v+3+32]=p[v+2+64]=p[v+1+96]=yr(ne,ie,ue),p[v+3+64]=p[v+2+96]=yr(ie,ue,ye),p[v+3+96]=yr(ue,ye,ye)}function Ds(p,v){var C=p[v-1+0],Q=p[v-1+32],W=p[v-1+64],ne=p[v-1-32],ie=p[v+0-32],ue=p[v+1-32],ye=p[v+2-32],Ee=p[v+3-32];p[v+0+0]=p[v+1+64]=ne+ie+1>>1,p[v+1+0]=p[v+2+64]=ie+ue+1>>1,p[v+2+0]=p[v+3+64]=ue+ye+1>>1,p[v+3+0]=ye+Ee+1>>1,p[v+0+96]=yr(W,Q,C),p[v+0+64]=yr(Q,C,ne),p[v+0+32]=p[v+1+96]=yr(C,ne,ie),p[v+1+32]=p[v+2+96]=yr(ne,ie,ue),p[v+2+32]=p[v+3+96]=yr(ie,ue,ye),p[v+3+32]=yr(ue,ye,Ee)}function Fi(p,v){var C=p[v+0-32],Q=p[v+1-32],W=p[v+2-32],ne=p[v+3-32],ie=p[v+4-32],ue=p[v+5-32],ye=p[v+6-32],Ee=p[v+7-32];p[v+0+0]=C+Q+1>>1,p[v+1+0]=p[v+0+64]=Q+W+1>>1,p[v+2+0]=p[v+1+64]=W+ne+1>>1,p[v+3+0]=p[v+2+64]=ne+ie+1>>1,p[v+0+32]=yr(C,Q,W),p[v+1+32]=p[v+0+96]=yr(Q,W,ne),p[v+2+32]=p[v+1+96]=yr(W,ne,ie),p[v+3+32]=p[v+2+96]=yr(ne,ie,ue),p[v+3+64]=yr(ie,ue,ye),p[v+3+96]=yr(ue,ye,Ee)}function sc(p,v){var C=p[v-1+0],Q=p[v-1+32],W=p[v-1+64],ne=p[v-1+96];p[v+0+0]=C+Q+1>>1,p[v+2+0]=p[v+0+32]=Q+W+1>>1,p[v+2+32]=p[v+0+64]=W+ne+1>>1,p[v+1+0]=yr(C,Q,W),p[v+3+0]=p[v+1+32]=yr(Q,W,ne),p[v+3+32]=p[v+1+64]=yr(W,ne,ne),p[v+3+64]=p[v+2+64]=p[v+0+96]=p[v+1+96]=p[v+2+96]=p[v+3+96]=ne}function ic(p,v){var C=p[v-1+0],Q=p[v-1+32],W=p[v-1+64],ne=p[v-1+96],ie=p[v-1-32],ue=p[v+0-32],ye=p[v+1-32],Ee=p[v+2-32];p[v+0+0]=p[v+2+32]=C+ie+1>>1,p[v+0+32]=p[v+2+64]=Q+C+1>>1,p[v+0+64]=p[v+2+96]=W+Q+1>>1,p[v+0+96]=ne+W+1>>1,p[v+3+0]=yr(ue,ye,Ee),p[v+2+0]=yr(ie,ue,ye),p[v+1+0]=p[v+3+32]=yr(C,ie,ue),p[v+1+32]=p[v+3+64]=yr(Q,C,ie),p[v+1+64]=p[v+3+96]=yr(W,Q,C),p[v+1+96]=yr(ne,W,Q)}function kg(p,v){var C;for(C=0;8>C;++C)r(p,v+32*C,p,v-32,8)}function ac(p,v){var C;for(C=0;8>C;++C)o(p,v,p[v-1],8),v+=32}function FA(p,v,C){var Q;for(Q=0;8>Q;++Q)o(v,C+32*Q,p,8)}function La(p,v){var C,Q=8;for(C=0;8>C;++C)Q+=p[v+C-32]+p[v-1+32*C];FA(Q>>4,p,v)}function Og(p,v){var C,Q=4;for(C=0;8>C;++C)Q+=p[v+C-32];FA(Q>>3,p,v)}function IA(p,v){var C,Q=4;for(C=0;8>C;++C)Q+=p[v-1+32*C];FA(Q>>3,p,v)}function Ac(p,v){FA(128,p,v)}function xl(p,v,C){var Q=p[v-C],W=p[v+0],ne=3*(W-Q)+Rg[1020+p[v-2*C]-p[v+C]],ie=lh[112+(ne+4>>3)];p[v-C]=xs[255+Q+lh[112+(ne+3>>3)]],p[v+0]=xs[255+W-ie]}function Yu(p,v,C,Q){var W=p[v+0],ne=p[v+C];return Rs[255+p[v-2*C]-p[v-C]]>Q||Rs[255+ne-W]>Q}function Ju(p,v,C,Q){return 4*Rs[255+p[v-C]-p[v+0]]+Rs[255+p[v-2*C]-p[v+C]]<=Q}function Zu(p,v,C,Q,W){var ne=p[v-3*C],ie=p[v-2*C],ue=p[v-C],ye=p[v+0],Ee=p[v+C],$e=p[v+2*C],dt=p[v+3*C];return 4*Rs[255+ue-ye]+Rs[255+ie-Ee]>Q?0:Rs[255+p[v-4*C]-ne]<=W&&Rs[255+ne-ie]<=W&&Rs[255+ie-ue]<=W&&Rs[255+dt-$e]<=W&&Rs[255+$e-Ee]<=W&&Rs[255+Ee-ye]<=W}function eh(p,v,C,Q){var W=2*Q+1;for(Q=0;16>Q;++Q)Ju(p,v+Q,C,W)&&xl(p,v+Q,C)}function Ii(p,v,C,Q){var W=2*Q+1;for(Q=0;16>Q;++Q)Ju(p,v+Q*C,1,W)&&xl(p,v+Q*C,1)}function ta(p,v,C,Q){var W;for(W=3;0<W;--W)eh(p,v+=4*C,C,Q)}function Dg(p,v,C,Q){var W;for(W=3;0<W;--W)Ii(p,v+=4,C,Q)}function Pa(p,v,C,Q,W,ne,ie,ue){for(ne=2*ne+1;0<W--;){if(Zu(p,v,C,ne,ie))if(Yu(p,v,C,ue))xl(p,v,C);else{var ye=p,Ee=v,$e=C,dt=ye[Ee-2*$e],ct=ye[Ee-$e],et=ye[Ee+0],Ut=ye[Ee+$e],wt=ye[Ee+2*$e],Ve=27*(St=Rg[1020+3*(et-ct)+Rg[1020+dt-Ut]])+63>>7,Ye=18*St+63>>7,St=9*St+63>>7;ye[Ee-3*$e]=xs[255+ye[Ee-3*$e]+St],ye[Ee-2*$e]=xs[255+dt+Ye],ye[Ee-$e]=xs[255+ct+Ve],ye[Ee+0]=xs[255+et-Ve],ye[Ee+$e]=xs[255+Ut-Ye],ye[Ee+2*$e]=xs[255+wt-St]}v+=Q}}function ri(p,v,C,Q,W,ne,ie,ue){for(ne=2*ne+1;0<W--;){if(Zu(p,v,C,ne,ie))if(Yu(p,v,C,ue))xl(p,v,C);else{var ye=p,Ee=v,$e=C,dt=ye[Ee-$e],ct=ye[Ee+0],et=ye[Ee+$e],Ut=lh[112+((wt=3*(ct-dt))+4>>3)],wt=lh[112+(wt+3>>3)],Ve=Ut+1>>1;ye[Ee-2*$e]=xs[255+ye[Ee-2*$e]+Ve],ye[Ee-$e]=xs[255+dt+wt],ye[Ee+0]=xs[255+ct-Ut],ye[Ee+$e]=xs[255+et-Ve]}v+=Q}}function lc(p,v,C,Q,W,ne){Pa(p,v,C,1,16,Q,W,ne)}function UA(p,v,C,Q,W,ne){Pa(p,v,1,C,16,Q,W,ne)}function Ng(p,v,C,Q,W,ne){var ie;for(ie=3;0<ie;--ie)ri(p,v+=4*C,C,1,16,Q,W,ne)}function zl(p,v,C,Q,W,ne){var ie;for(ie=3;0<ie;--ie)ri(p,v+=4,1,C,16,Q,W,ne)}function Mg(p,v,C,Q,W,ne,ie,ue){Pa(p,v,W,1,8,ne,ie,ue),Pa(C,Q,W,1,8,ne,ie,ue)}function dc(p,v,C,Q,W,ne,ie,ue){Pa(p,v,1,W,8,ne,ie,ue),Pa(C,Q,1,W,8,ne,ie,ue)}function cc(p,v,C,Q,W,ne,ie,ue){ri(p,v+4*W,W,1,8,ne,ie,ue),ri(C,Q+4*W,W,1,8,ne,ie,ue)}function th(p,v,C,Q,W,ne,ie,ue){ri(p,v+4,1,W,8,ne,ie,ue),ri(C,Q+4,1,W,8,ne,ie,ue)}function Cl(){this.ba=new At,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new ht,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function uc(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function hc(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function rh(){this.ua=0,this.Wa=new O,this.vb=new O,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new se,this.yc=new N}function Hg(){this.xb=this.a=0,this.l=new vn,this.ca=new At,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new x,this.Pb=0,this.wd=new x,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new rh,this.ab=0,this.gc=i(4,hc),this.Oc=0}function Sl(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new vn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function QA(p,v,C,Q,W,ne,ie){for(p=p==null?0:p[v+0],v=0;v<ie;++v)W[ne+v]=p+C[Q+v]&255,p=W[ne+v]}function fc(p,v,C,Q,W,ne,ie){var ue;if(p==null)QA(null,null,C,Q,W,ne,ie);else for(ue=0;ue<ie;++ue)W[ne+ue]=p[v+ue]+C[Q+ue]&255}function ka(p,v,C,Q,W,ne,ie){if(p==null)QA(null,null,C,Q,W,ne,ie);else{var ue,ye=p[v+0],Ee=ye,$e=ye;for(ue=0;ue<ie;++ue)Ee=$e+(ye=p[v+ue])-Ee,$e=C[Q+ue]+(-256&Ee?0>Ee?0:255:Ee)&255,Ee=ye,W[ne+ue]=$e}}function pc(p,v,C,Q){var W=v.width,ne=v.o;if(e(p!=null&&v!=null),0>C||0>=Q||C+Q>ne)return null;if(!p.Cc){if(p.ga==null){var ie;if(p.ga=new Sl,(ie=p.ga==null)||(ie=v.width*v.o,e(p.Gb.length==0),p.Gb=s(ie),p.Uc=0,p.Gb==null?ie=0:(p.mb=p.Gb,p.nb=p.Uc,p.rc=null,ie=1),ie=!ie),!ie){ie=p.ga;var ue=p.Fa,ye=p.P,Ee=p.qc,$e=p.mb,dt=p.nb,ct=ye+1,et=Ee-1,Ut=ie.l;if(e(ue!=null&&$e!=null&&v!=null),ja[0]=null,ja[1]=QA,ja[2]=fc,ja[3]=ka,ie.ca=$e,ie.tb=dt,ie.c=v.width,ie.i=v.height,e(0<ie.c&&0<ie.i),1>=Ee)v=0;else if(ie.$a=ue[ye+0]>>0&3,ie.Z=ue[ye+0]>>2&3,ie.Lc=ue[ye+0]>>4&3,ye=ue[ye+0]>>6&3,0>ie.$a||1<ie.$a||4<=ie.Z||1<ie.Lc||ye)v=0;else if(Ut.put=Bt,Ut.ac=rt,Ut.bc=nt,Ut.ma=ie,Ut.width=v.width,Ut.height=v.height,Ut.Da=v.Da,Ut.v=v.v,Ut.va=v.va,Ut.j=v.j,Ut.o=v.o,ie.$a)e:{e(ie.$a==1),v=Mt();t:for(;;){if(v==null){v=0;break e}if(e(ie!=null),ie.mc=v,v.c=ie.c,v.i=ie.i,v.l=ie.l,v.l.ma=ie,v.l.width=ie.c,v.l.height=ie.i,v.a=0,V(v.m,ue,ct,et),!Gt(ie.c,ie.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&Ft(v.s)?(ie.ic=1,ue=v.c*v.i,v.Ta=null,v.Ua=0,v.V=s(ue),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(ie.ic=0,v=lr(v,ie.c)),!v))break t;v=1;break e}ie.mc=null,v=0}else v=et>=ie.c*ie.i;ie=!v}if(ie)return null;p.ga.Lc!=1?p.Ga=0:Q=ne-C}e(p.ga!=null),e(C+Q<=ne);e:{if(v=(ue=p.ga).c,ne=ue.l.o,ue.$a==0){if(ct=p.rc,et=p.Vc,Ut=p.Fa,ye=p.P+1+C*v,Ee=p.mb,$e=p.nb+C*v,e(ye<=p.P+p.qc),ue.Z!=0)for(e(ja[ue.Z]!=null),ie=0;ie<Q;++ie)ja[ue.Z](ct,et,Ut,ye,Ee,$e,v),ct=Ee,et=$e,$e+=v,ye+=v;else for(ie=0;ie<Q;++ie)r(Ee,$e,Ut,ye,v),ct=Ee,et=$e,$e+=v,ye+=v;p.rc=ct,p.Vc=et}else{if(e(ue.mc!=null),v=C+Q,e((ie=ue.mc)!=null),e(v<=ie.i),ie.C>=v)v=1;else if(ue.ic||st(),ue.ic){ue=ie.V,ct=ie.Ba,et=ie.c;var wt=ie.i,Ve=(Ut=1,ye=ie.$/et,Ee=ie.$%et,$e=ie.m,dt=ie.s,ie.$),Ye=et*wt,St=et*v,Qt=dt.wc,It=Ve<St?Pt(dt,Ee,ye):null;e(Ve<=Ye),e(v<=wt),e(Ft(dt));t:for(;;){for(;!$e.h&&Ve<St;){if(Ee&Qt||(It=Pt(dt,Ee,ye)),e(It!=null),M($e),256>(wt=_t(It.G[0],It.H[0],$e)))ue[ct+Ve]=wt,++Ve,++Ee>=et&&(Ee=0,++ye<=v&&!(ye%16)&&Tt(ie,ye));else{if(!(280>wt)){Ut=0;break t}wt=xt(wt-256,$e);var Xt,jt=_t(It.G[4],It.H[4],$e);if(M($e),!(Ve>=(jt=Lt(et,jt=xt(jt,$e)))&&Ye-Ve>=wt)){Ut=0;break t}for(Xt=0;Xt<wt;++Xt)ue[ct+Ve+Xt]=ue[ct+Ve+Xt-jt];for(Ve+=wt,Ee+=wt;Ee>=et;)Ee-=et,++ye<=v&&!(ye%16)&&Tt(ie,ye);Ve<St&&Ee&Qt&&(It=Pt(dt,Ee,ye))}e($e.h==I($e))}Tt(ie,ye>v?v:ye);break t}!Ut||$e.h&&Ve<Ye?(Ut=0,ie.a=$e.h?5:3):ie.$=Ve,v=Ut}else v=Rt(ie,ie.V,ie.Ba,ie.c,ie.i,v,tr);if(!v){Q=0;break e}}C+Q>=ne&&(p.Cc=1),Q=1}if(!Q)return null;if(p.Cc&&((Q=p.ga)!=null&&(Q.mc=null),p.ga=null,0<p.Ga))return alert("todo:WebPDequantizeLevels"),null}return p.nb+C*W}function B(p,v,C,Q,W,ne){for(;0<W--;){var ie,ue=p,ye=v+(C?1:0),Ee=p,$e=v+(C?0:3);for(ie=0;ie<Q;++ie){var dt=Ee[$e+4*ie];dt!=255&&(dt*=32897,ue[ye+4*ie+0]=ue[ye+4*ie+0]*dt>>23,ue[ye+4*ie+1]=ue[ye+4*ie+1]*dt>>23,ue[ye+4*ie+2]=ue[ye+4*ie+2]*dt>>23)}v+=ne}}function X(p,v,C,Q,W){for(;0<Q--;){var ne;for(ne=0;ne<C;++ne){var ie=p[v+2*ne+0],ue=15&(Ee=p[v+2*ne+1]),ye=4369*ue,Ee=(240&Ee|Ee>>4)*ye>>16;p[v+2*ne+0]=(240&ie|ie>>4)*ye>>16&240|(15&ie|ie<<4)*ye>>16>>4&15,p[v+2*ne+1]=240&Ee|ue}v+=W}}function Pe(p,v,C,Q,W,ne,ie,ue){var ye,Ee,$e=255;for(Ee=0;Ee<W;++Ee){for(ye=0;ye<Q;++ye){var dt=p[v+ye];ne[ie+4*ye]=dt,$e&=dt}v+=C,ie+=ue}return $e!=255}function qe(p,v,C,Q,W){var ne;for(ne=0;ne<W;++ne)C[Q+ne]=p[v+ne]>>8}function st(){js=B,bn=X,_n=Pe,qn=qe}function bt(p,v,C){j[p]=function(Q,W,ne,ie,ue,ye,Ee,$e,dt,ct,et,Ut,wt,Ve,Ye,St,Qt){var It,Xt=Qt-1>>1,jt=ue[ye+0]|Ee[$e+0]<<16,cr=dt[ct+0]|et[Ut+0]<<16;e(Q!=null);var qt=3*jt+cr+131074>>2;for(v(Q[W+0],255&qt,qt>>16,wt,Ve),ne!=null&&(qt=3*cr+jt+131074>>2,v(ne[ie+0],255&qt,qt>>16,Ye,St)),It=1;It<=Xt;++It){var Jr=ue[ye+It]|Ee[$e+It]<<16,sn=dt[ct+It]|et[Ut+It]<<16,Vr=jt+Jr+cr+sn+524296,Or=Vr+2*(Jr+cr)>>3;qt=Or+jt>>1,jt=(Vr=Vr+2*(jt+sn)>>3)+Jr>>1,v(Q[W+2*It-1],255&qt,qt>>16,wt,Ve+(2*It-1)*C),v(Q[W+2*It-0],255&jt,jt>>16,wt,Ve+(2*It-0)*C),ne!=null&&(qt=Vr+cr>>1,jt=Or+sn>>1,v(ne[ie+2*It-1],255&qt,qt>>16,Ye,St+(2*It-1)*C),v(ne[ie+2*It+0],255&jt,jt>>16,Ye,St+(2*It+0)*C)),jt=Jr,cr=sn}1&Qt||(qt=3*jt+cr+131074>>2,v(Q[W+Qt-1],255&qt,qt>>16,wt,Ve+(Qt-1)*C),ne!=null&&(qt=3*cr+jt+131074>>2,v(ne[ie+Qt-1],255&qt,qt>>16,Ye,St+(Qt-1)*C)))}}function Ot(){qs[dh]=sC,qs[ch]=c2,qs[i2]=iC,qs[uh]=u2,qs[hh]=h2,qs[qg]=f2,qs[a2]=aC,qs[Kg]=c2,qs[$g]=u2,qs[fh]=h2,qs[Vg]=f2}function Vt(p){return p&-16384?0>p?0:255:p>>AC}function ir(p,v){return Vt((19077*p>>8)+(26149*v>>8)-14234)}function Cr(p,v,C){return Vt((19077*p>>8)-(6419*v>>8)-(13320*C>>8)+8708)}function _r(p,v){return Vt((19077*p>>8)+(33050*v>>8)-17685)}function Rr(p,v,C,Q,W){Q[W+0]=ir(p,C),Q[W+1]=Cr(p,v,C),Q[W+2]=_r(p,v)}function Tn(p,v,C,Q,W){Q[W+0]=_r(p,v),Q[W+1]=Cr(p,v,C),Q[W+2]=ir(p,C)}function Dn(p,v,C,Q,W){var ne=Cr(p,v,C);v=ne<<3&224|_r(p,v)>>3,Q[W+0]=248&ir(p,C)|ne>>5,Q[W+1]=v}function to(p,v,C,Q,W){var ne=240&_r(p,v)|15;Q[W+0]=240&ir(p,C)|Cr(p,v,C)>>4,Q[W+1]=ne}function To(p,v,C,Q,W){Q[W+0]=255,Rr(p,v,C,Q,W+1)}function ho(p,v,C,Q,W){Tn(p,v,C,Q,W),Q[W+3]=255}function ni(p,v,C,Q,W){Rr(p,v,C,Q,W),Q[W+3]=255}function Bs(p,v){return 0>p?0:p>v?v:p}function Ui(p,v,C){j[p]=function(Q,W,ne,ie,ue,ye,Ee,$e,dt){for(var ct=$e+(-2&dt)*C;$e!=ct;)v(Q[W+0],ne[ie+0],ue[ye+0],Ee,$e),v(Q[W+1],ne[ie+0],ue[ye+0],Ee,$e+C),W+=2,++ie,++ye,$e+=2*C;1&dt&&v(Q[W+0],ne[ie+0],ue[ye+0],Ee,$e)}}function nh(p,v,C){return C==0?p==0?v==0?6:5:v==0?4:0:C}function gc(p,v,C,Q,W){switch(p>>>30){case 3:oa(v,C,Q,W,0);break;case 2:Rn(v,C,Q,W);break;case 1:Ko(v,C,Q,W)}}function vc(p,v){var C,Q,W=v.M,ne=v.Nb,ie=p.oc,ue=p.pc+40,ye=p.oc,Ee=p.pc+584,$e=p.oc,dt=p.pc+600;for(C=0;16>C;++C)ie[ue+32*C-1]=129;for(C=0;8>C;++C)ye[Ee+32*C-1]=129,$e[dt+32*C-1]=129;for(0<W?ie[ue-1-32]=ye[Ee-1-32]=$e[dt-1-32]=129:(o(ie,ue-32-1,127,21),o(ye,Ee-32-1,127,9),o($e,dt-32-1,127,9)),Q=0;Q<p.za;++Q){var ct=v.ya[v.aa+Q];if(0<Q){for(C=-1;16>C;++C)r(ie,ue+32*C-4,ie,ue+32*C+12,4);for(C=-1;8>C;++C)r(ye,Ee+32*C-4,ye,Ee+32*C+4,4),r($e,dt+32*C-4,$e,dt+32*C+4,4)}var et=p.Gd,Ut=p.Hd+Q,wt=ct.ad,Ve=ct.Hc;if(0<W&&(r(ie,ue-32,et[Ut].y,0,16),r(ye,Ee-32,et[Ut].f,0,8),r($e,dt-32,et[Ut].ea,0,8)),ct.Za){var Ye=ie,St=ue-32+16;for(0<W&&(Q>=p.za-1?o(Ye,St,et[Ut].y[15],4):r(Ye,St,et[Ut+1].y,0,4)),C=0;4>C;C++)Ye[St+128+C]=Ye[St+256+C]=Ye[St+384+C]=Ye[St+0+C];for(C=0;16>C;++C,Ve<<=2)Ye=ie,St=ue+g2[C],oi[ct.Ob[C]](Ye,St),gc(Ve,wt,16*+C,Ye,St)}else if(Ye=nh(Q,W,ct.Ob[0]),Ha[Ye](ie,ue),Ve!=0)for(C=0;16>C;++C,Ve<<=2)gc(Ve,wt,16*+C,ie,ue+g2[C]);for(C=ct.Gc,Ye=nh(Q,W,ct.Dd),ia[Ye](ye,Ee),ia[Ye]($e,dt),Ve=wt,Ye=ye,St=Ee,255&(ct=C>>0)&&(170&ct?_c(Ve,256,Ye,St):Ms(Ve,256,Ye,St)),ct=$e,Ve=dt,255&(C>>=8)&&(170&C?_c(wt,320,ct,Ve):Ms(wt,320,ct,Ve)),W<p.Ub-1&&(r(et[Ut].y,0,ie,ue+480,16),r(et[Ut].f,0,ye,Ee+224,8),r(et[Ut].ea,0,$e,dt+224,8)),C=8*ne*p.B,et=p.sa,Ut=p.ta+16*Q+16*ne*p.R,wt=p.qa,ct=p.ra+8*Q+C,Ve=p.Ha,Ye=p.Ia+8*Q+C,C=0;16>C;++C)r(et,Ut+C*p.R,ie,ue+32*C,16);for(C=0;8>C;++C)r(wt,ct+C*p.B,ye,Ee+32*C,8),r(Ve,Ye+C*p.B,$e,dt+32*C,8)}}function El(p,v,C,Q,W,ne,ie,ue,ye){var Ee=[0],$e=[0],dt=0,ct=ye!=null?ye.kd:0,et=ye??new uc;if(p==null||12>C)return 7;et.data=p,et.w=v,et.ha=C,v=[v],C=[C],et.gb=[et.gb];e:{var Ut=v,wt=C,Ve=et.gb;if(e(p!=null),e(wt!=null),e(Ve!=null),Ve[0]=0,12<=wt[0]&&!t(p,Ut[0],"RIFF")){if(t(p,Ut[0]+8,"WEBP")){Ve=3;break e}var Ye=be(p,Ut[0]+4);if(12>Ye||4294967286<Ye){Ve=3;break e}if(ct&&Ye>wt[0]-8){Ve=7;break e}Ve[0]=Ye,Ut[0]+=12,wt[0]-=12}Ve=0}if(Ve!=0)return Ve;for(Ye=0<et.gb[0],C=C[0];;){e:{var St=p;wt=v,Ve=C;var Qt=Ee,It=$e,Xt=Ut=[0];if((qt=dt=[dt])[0]=0,8>Ve[0])Ve=7;else{if(!t(St,wt[0],"VP8X")){if(be(St,wt[0]+4)!=10){Ve=3;break e}if(18>Ve[0]){Ve=7;break e}var jt=be(St,wt[0]+8),cr=1+Be(St,wt[0]+12);if(2147483648<=cr*(St=1+Be(St,wt[0]+15))){Ve=3;break e}Xt!=null&&(Xt[0]=jt),Qt!=null&&(Qt[0]=cr),It!=null&&(It[0]=St),wt[0]+=18,Ve[0]-=18,qt[0]=1}Ve=0}}if(dt=dt[0],Ut=Ut[0],Ve!=0)return Ve;if(wt=!!(2&Ut),!Ye&&dt)return 3;if(ne!=null&&(ne[0]=!!(16&Ut)),ie!=null&&(ie[0]=wt),ue!=null&&(ue[0]=0),ie=Ee[0],Ut=$e[0],dt&&wt&&ye==null){Ve=0;break}if(4>C){Ve=7;break}if(Ye&&dt||!Ye&&!dt&&!t(p,v[0],"ALPH")){C=[C],et.na=[et.na],et.P=[et.P],et.Sa=[et.Sa];e:{jt=p,Ve=v,Ye=C;var qt=et.gb;Qt=et.na,It=et.P,Xt=et.Sa,cr=22,e(jt!=null),e(Ye!=null),St=Ve[0];var Jr=Ye[0];for(e(Qt!=null),e(Xt!=null),Qt[0]=null,It[0]=null,Xt[0]=0;;){if(Ve[0]=St,Ye[0]=Jr,8>Jr){Ve=7;break e}var sn=be(jt,St+4);if(4294967286<sn){Ve=3;break e}var Vr=8+sn+1&-2;if(cr+=Vr,0<qt&&cr>qt){Ve=3;break e}if(!t(jt,St,"VP8 ")||!t(jt,St,"VP8L")){Ve=0;break e}if(Jr[0]<Vr){Ve=7;break e}t(jt,St,"ALPH")||(Qt[0]=jt,It[0]=St+8,Xt[0]=sn),St+=Vr,Jr-=Vr}}if(C=C[0],et.na=et.na[0],et.P=et.P[0],et.Sa=et.Sa[0],Ve!=0)break}C=[C],et.Ja=[et.Ja],et.xa=[et.xa];e:if(qt=p,Ve=v,Ye=C,Qt=et.gb[0],It=et.Ja,Xt=et.xa,jt=Ve[0],St=!t(qt,jt,"VP8 "),cr=!t(qt,jt,"VP8L"),e(qt!=null),e(Ye!=null),e(It!=null),e(Xt!=null),8>Ye[0])Ve=7;else{if(St||cr){if(qt=be(qt,jt+4),12<=Qt&&qt>Qt-12){Ve=3;break e}if(ct&&qt>Ye[0]-8){Ve=7;break e}It[0]=qt,Ve[0]+=8,Ye[0]-=8,Xt[0]=cr}else Xt[0]=5<=Ye[0]&&qt[jt+0]==47&&!(qt[jt+4]>>5),It[0]=Ye[0];Ve=0}if(C=C[0],et.Ja=et.Ja[0],et.xa=et.xa[0],v=v[0],Ve!=0)break;if(4294967286<et.Ja)return 3;if(ue==null||wt||(ue[0]=et.xa?2:1),ie=[ie],Ut=[Ut],et.xa){if(5>C){Ve=7;break}ue=ie,ct=Ut,wt=ne,p==null||5>C?p=0:5<=C&&p[v+0]==47&&!(p[v+4]>>5)?(Ye=[0],qt=[0],Qt=[0],V(It=new x,p,v,C),ot(It,Ye,qt,Qt)?(ue!=null&&(ue[0]=Ye[0]),ct!=null&&(ct[0]=qt[0]),wt!=null&&(wt[0]=Qt[0]),p=1):p=0):p=0}else{if(10>C){Ve=7;break}ue=Ut,p==null||10>C||!xn(p,v+3,C-3)?p=0:(ct=p[v+0]|p[v+1]<<8|p[v+2]<<16,wt=16383&(p[v+7]<<8|p[v+6]),p=16383&(p[v+9]<<8|p[v+8]),1&ct||3<(ct>>1&7)||!(ct>>4&1)||ct>>5>=et.Ja||!wt||!p?p=0:(ie&&(ie[0]=wt),ue&&(ue[0]=p),p=1))}if(!p||(ie=ie[0],Ut=Ut[0],dt&&(Ee[0]!=ie||$e[0]!=Ut)))return 3;ye!=null&&(ye[0]=et,ye.offset=v-ye.w,e(4294967286>v-ye.w),e(ye.offset==ye.ha-C));break}return Ve==0||Ve==7&&dt&&ye==null?(ne!=null&&(ne[0]|=et.na!=null&&0<et.na.length),Q!=null&&(Q[0]=ie),W!=null&&(W[0]=Ut),0):Ve}function mc(p,v,C){var Q=v.width,W=v.height,ne=0,ie=0,ue=Q,ye=W;if(v.Da=p!=null&&0<p.Da,v.Da&&(ue=p.cd,ye=p.bd,ne=p.v,ie=p.j,11>C||(ne&=-2,ie&=-2),0>ne||0>ie||0>=ue||0>=ye||ne+ue>Q||ie+ye>W))return 0;if(v.v=ne,v.j=ie,v.va=ne+ue,v.o=ie+ye,v.U=ue,v.T=ye,v.da=p!=null&&0<p.da,v.da){if(!ve(ue,ye,C=[p.ib],ne=[p.hb]))return 0;v.ib=C[0],v.hb=ne[0]}return v.ob=p!=null&&p.ob,v.Kb=p==null||!p.Sd,v.da&&(v.ob=v.ib<3*Q/4&&v.hb<3*W/4,v.Kb=0),1}function wc(p){if(p==null)return 2;if(11>p.S){var v=p.f.RGBA;v.fb+=(p.height-1)*v.A,v.A=-v.A}else v=p.f.kb,p=p.height,v.O+=(p-1)*v.fa,v.fa=-v.fa,v.N+=(p-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(p-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(p-1)*v.lb,v.lb=-v.lb);return 0}function Fl(p,v,C,Q){if(Q==null||0>=p||0>=v)return 2;if(C!=null){if(C.Da){var W=C.cd,ne=C.bd,ie=-2&C.v,ue=-2&C.j;if(0>ie||0>ue||0>=W||0>=ne||ie+W>p||ue+ne>v)return 2;p=W,v=ne}if(C.da){if(!ve(p,v,W=[C.ib],ne=[C.hb]))return 2;p=W[0],v=ne[0]}}Q.width=p,Q.height=v;e:{var ye=Q.width,Ee=Q.height;if(p=Q.S,0>=ye||0>=Ee||!(p>=dh&&13>p))p=2;else{if(0>=Q.Rd&&Q.sd==null){ie=ne=W=v=0;var $e=(ue=ye*v2[p])*Ee;if(11>p||(ne=(Ee+1)/2*(v=(ye+1)/2),p==12&&(ie=(W=ye)*Ee)),(Ee=s($e+2*ne+ie))==null){p=1;break e}Q.sd=Ee,11>p?((ye=Q.f.RGBA).eb=Ee,ye.fb=0,ye.A=ue,ye.size=$e):((ye=Q.f.kb).y=Ee,ye.O=0,ye.fa=ue,ye.Fd=$e,ye.f=Ee,ye.N=0+$e,ye.Ab=v,ye.Cd=ne,ye.ea=Ee,ye.W=0+$e+ne,ye.Db=v,ye.Ed=ne,p==12&&(ye.F=Ee,ye.J=0+$e+2*ne),ye.Tc=ie,ye.lb=W)}if(v=1,W=Q.S,ne=Q.width,ie=Q.height,W>=dh&&13>W)if(11>W)p=Q.f.RGBA,v&=(ue=Math.abs(p.A))*(ie-1)+ne<=p.size,v&=ue>=ne*v2[W],v&=p.eb!=null;else{p=Q.f.kb,ue=(ne+1)/2,$e=(ie+1)/2,ye=Math.abs(p.fa),Ee=Math.abs(p.Ab);var dt=Math.abs(p.Db),ct=Math.abs(p.lb),et=ct*(ie-1)+ne;v&=ye*(ie-1)+ne<=p.Fd,v&=Ee*($e-1)+ue<=p.Cd,v=(v&=dt*($e-1)+ue<=p.Ed)&ye>=ne&Ee>=ue&dt>=ue,v&=p.y!=null,v&=p.f!=null,v&=p.ea!=null,W==12&&(v&=ct>=ne,v&=et<=p.Tc,v&=p.F!=null)}else v=0;p=v?0:2}}return p!=0||C!=null&&C.fd&&(p=wc(Q)),p}var _o=64,Il=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ul=24,Ql=32,yc=8,os=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];le("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(p){return p},j.Predictor2=function(p,v,C){return v[C+0]},j.Predictor3=function(p,v,C){return v[C+1]},j.Predictor4=function(p,v,C){return v[C-1]},j.Predictor5=function(p,v,C){return ke(ke(p,v[C+1]),v[C+0])},j.Predictor6=function(p,v,C){return ke(p,v[C-1])},j.Predictor7=function(p,v,C){return ke(p,v[C+0])},j.Predictor8=function(p,v,C){return ke(v[C-1],v[C+0])},j.Predictor9=function(p,v,C){return ke(v[C+0],v[C+1])},j.Predictor10=function(p,v,C){return ke(ke(p,v[C-1]),ke(v[C+0],v[C+1]))},j.Predictor11=function(p,v,C){var Q=v[C+0];return 0>=U(Q>>24&255,p>>24&255,(v=v[C-1])>>24&255)+U(Q>>16&255,p>>16&255,v>>16&255)+U(Q>>8&255,p>>8&255,v>>8&255)+U(255&Q,255&p,255&v)?Q:p},j.Predictor12=function(p,v,C){var Q=v[C+0];return(de((p>>24&255)+(Q>>24&255)-((v=v[C-1])>>24&255))<<24|de((p>>16&255)+(Q>>16&255)-(v>>16&255))<<16|de((p>>8&255)+(Q>>8&255)-(v>>8&255))<<8|de((255&p)+(255&Q)-(255&v)))>>>0},j.Predictor13=function(p,v,C){var Q=v[C-1];return(Fe((p=ke(p,v[C+0]))>>24&255,Q>>24&255)<<24|Fe(p>>16&255,Q>>16&255)<<16|Fe(p>>8&255,Q>>8&255)<<8|Fe(p>>0&255,Q>>0&255))>>>0};var jg=j.PredictorAdd0;j.PredictorAdd1=Ae,le("Predictor2","PredictorAdd2"),le("Predictor3","PredictorAdd3"),le("Predictor4","PredictorAdd4"),le("Predictor5","PredictorAdd5"),le("Predictor6","PredictorAdd6"),le("Predictor7","PredictorAdd7"),le("Predictor8","PredictorAdd8"),le("Predictor9","PredictorAdd9"),le("Predictor10","PredictorAdd10"),le("Predictor11","PredictorAdd11"),le("Predictor12","PredictorAdd12"),le("Predictor13","PredictorAdd13");var bc=j.PredictorAdd2;De("ColorIndexInverseTransform","MapARGB","32b",function(p){return p>>8&255},function(p){return p}),De("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(p){return p},function(p){return p>>8&255});var oh,Ns=j.ColorIndexInverseTransform,Tl=j.MapARGB,sh=j.VP8LColorIndexInverseTransformAlpha,ih=j.MapAlpha,Oa=j.VP8LPredictorsAdd=[];Oa.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var TA,ss,qo,Da,ra,na,Ll,oa,Rn,_c,Ko,Ms,Pl,ah,Bc,LA,PA,Na,kA,kl,OA,Ma,xc,Hs,js,bn,_n,qn,ao=s(511),sa=s(2041),zc=s(225),Ol=s(767),Ah=0,Rg=sa,lh=zc,xs=Ol,Rs=ao,dh=0,ch=1,i2=2,uh=3,hh=4,qg=5,a2=6,Kg=7,$g=8,fh=9,Vg=10,Kz=[2,3,7],$z=[3,3,11],A2=[280,256,256,256,40],Vz=[0,1,1,1,0],Gz=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Wz=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Xz=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Yz=8,Gg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Wg=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Cc=null,Jz=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zz=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],l2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],eC=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],tC=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],rC=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],nC=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ha=[],oi=[],ia=[],oC=1,d2=2,ja=[],qs=[];bt("UpsampleRgbLinePair",Rr,3),bt("UpsampleBgrLinePair",Tn,3),bt("UpsampleRgbaLinePair",ni,4),bt("UpsampleBgraLinePair",ho,4),bt("UpsampleArgbLinePair",To,4),bt("UpsampleRgba4444LinePair",to,2),bt("UpsampleRgb565LinePair",Dn,2);var sC=j.UpsampleRgbLinePair,iC=j.UpsampleBgrLinePair,c2=j.UpsampleRgbaLinePair,u2=j.UpsampleBgraLinePair,h2=j.UpsampleArgbLinePair,f2=j.UpsampleRgba4444LinePair,aC=j.UpsampleRgb565LinePair,ph=16,gh=1<<ph-1,Sc=-227,Xg=482,AC=6,p2=0,lC=s(256),dC=s(256),cC=s(256),uC=s(256),hC=s(Xg-Sc),fC=s(Xg-Sc);Ui("YuvToRgbRow",Rr,3),Ui("YuvToBgrRow",Tn,3),Ui("YuvToRgbaRow",ni,4),Ui("YuvToBgraRow",ho,4),Ui("YuvToArgbRow",To,4),Ui("YuvToRgba4444Row",to,2),Ui("YuvToRgb565Row",Dn,2);var g2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],vh=[0,2,8],pC=[8,7,6,4,4,2,2,2,1,1,1,1],gC=1;this.WebPDecodeRGBA=function(p,v,C,Q,W){var ne=ch,ie=new Cl,ue=new At;ie.ba=ue,ue.S=ne,ue.width=[ue.width],ue.height=[ue.height];var ye=ue.width,Ee=ue.height,$e=new ut;if($e==null||p==null)var dt=2;else e($e!=null),dt=El(p,v,C,$e.width,$e.height,$e.Pd,$e.Qd,$e.format,null);if(dt!=0?ye=0:(ye!=null&&(ye[0]=$e.width[0]),Ee!=null&&(Ee[0]=$e.height[0]),ye=1),ye){ue.width=ue.width[0],ue.height=ue.height[0],Q!=null&&(Q[0]=ue.width),W!=null&&(W[0]=ue.height);e:{if(Q=new vn,(W=new uc).data=p,W.w=v,W.ha=C,W.kd=1,v=[0],e(W!=null),((p=El(W.data,W.w,W.ha,null,null,null,v,null,W))==0||p==7)&&v[0]&&(p=4),(v=p)==0){if(e(ie!=null),Q.data=W.data,Q.w=W.w+W.offset,Q.ha=W.ha-W.offset,Q.put=Bt,Q.ac=rt,Q.bc=nt,Q.ma=ie,W.xa){if((p=Mt())==null){ie=1;break e}if(function(ct,et){var Ut=[0],wt=[0],Ve=[0];t:for(;;){if(ct==null)return 0;if(et==null)return ct.a=2,0;if(ct.l=et,ct.a=0,V(ct.m,et.data,et.w,et.ha),!ot(ct.m,Ut,wt,Ve)){ct.a=3;break t}if(ct.xb=d2,et.width=Ut[0],et.height=wt[0],!Gt(Ut[0],wt[0],1,ct,null))break t;return 1}return e(ct.a!=0),0}(p,Q)){if(Q=(v=Fl(Q.width,Q.height,ie.Oa,ie.ba))==0){t:{Q=p;r:for(;;){if(Q==null){Q=0;break t}if(e(Q.s.yc!=null),e(Q.s.Ya!=null),e(0<Q.s.Wb),e((C=Q.l)!=null),e((W=C.ma)!=null),Q.xb!=0){if(Q.ca=W.ba,Q.tb=W.tb,e(Q.ca!=null),!mc(W.Oa,C,uh)){Q.a=2;break r}if(!lr(Q,C.width)||C.da)break r;if((C.da||Ue(Q.ca.S))&&st(),11>Q.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Q.ca.f.kb.F!=null&&st()),Q.Pb&&0<Q.s.ua&&Q.s.vb.X==null&&!Le(Q.s.vb,Q.s.Wa.Xa)){Q.a=1;break r}Q.xb=0}if(!Rt(Q,Q.V,Q.Ba,Q.c,Q.i,C.o,Ct))break r;W.Dc=Q.Ma,Q=1;break t}e(Q.a!=0),Q=0}Q=!Q}Q&&(v=p.a)}else v=p.a}else{if((p=new zr)==null){ie=1;break e}if(p.Fa=W.na,p.P=W.P,p.qc=W.Sa,Fo(p,Q)){if((v=Fl(Q.width,Q.height,ie.Oa,ie.ba))==0){if(p.Aa=0,C=ie.Oa,e((W=p)!=null),C!=null){if(0<(ye=0>(ye=C.Md)?0:100<ye?255:255*ye/100)){for(Ee=$e=0;4>Ee;++Ee)12>(dt=W.pb[Ee]).lc&&(dt.ia=ye*pC[0>dt.lc?0:dt.lc]>>3),$e|=dt.ia;$e&&(alert("todo:VP8InitRandom"),W.ia=1)}W.Ga=C.Id,100<W.Ga?W.Ga=100:0>W.Ga&&(W.Ga=0)}ns(p,Q)||(v=p.a)}}else v=p.a}v==0&&ie.Oa!=null&&ie.Oa.fd&&(v=wc(ie.ba))}ie=v}ne=ie!=0?null:11>ne?ue.f.RGBA.eb:ue.f.kb.y}else ne=null;return ne};var v2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(j,J){for(var we="",D=0;D<4;D++)we+=String.fromCharCode(j[J++]);return we}function c(j,J){return(j[J+0]<<0|j[J+1]<<8|j[J+2]<<16)>>>0}function u(j,J){return(j[J+0]<<0|j[J+1]<<8|j[J+2]<<16|j[J+3]<<24)>>>0}new A;var h=[0],f=[0],g=[],m=new A,y=n,b=function(j,J){var we={},D=0,N=!1,Z=0,se=0;if(we.frames=[],!function(E,I,L,M){for(var H=0;H<M;H++)if(E[I+H]!=L.charCodeAt(H))return!0;return!1}(j,J,"RIFF",4)){var ce,re;for(u(j,J+=4),J+=8;J<j.length;){var pe=d(j,J),V=u(j,J+=4);J+=4;var K=V+(1&V);switch(pe){case"VP8 ":case"VP8L":we.frames[D]===void 0&&(we.frames[D]={}),(x=we.frames[D]).src_off=N?se:J-8,x.src_size=Z+V+8,D++,N&&(N=!1,Z=0,se=0);break;case"VP8X":(x=we.header={}).feature_flags=j[J];var oe=J+4;x.canvas_width=1+c(j,oe),oe+=3,x.canvas_height=1+c(j,oe),oe+=3;break;case"ALPH":N=!0,Z=K+8,se=J-8;break;case"ANIM":(x=we.header).bgcolor=u(j,J),oe=J+4,x.loop_count=(ce=j)[(re=oe)+0]<<0|ce[re+1]<<8,oe+=2;break;case"ANMF":var ae,x;(x=we.frames[D]={}).offset_x=2*c(j,J),J+=3,x.offset_y=2*c(j,J),J+=3,x.width=1+c(j,J),J+=3,x.height=1+c(j,J),J+=3,x.duration=c(j,J),J+=3,ae=j[J++],x.dispose=1&ae,x.blend=ae>>1&1}pe!="ANMF"&&(J+=K)}return we}}(y,0);b.response=y,b.rgbaoutput=!0,b.dataurl=!1;var S=b.header?b.header:null,F=b.frames?b.frames:null;if(S){S.loop_counter=S.loop_count,h=[S.canvas_height],f=[S.canvas_width];for(var k=0;k<F.length&&F[k].blend!=0;k++);}var P=F[0],te=m.WebPDecodeRGBA(y,P.src_off,P.src_size,f,h);P.rgba=te,P.imgwidth=f[0],P.imgheight=h[0];for(var $=0;$<f[0]*h[0]*4;$++)g[$]=te[$];return this.width=f,this.height=h,this.data=g,this}(function(n){var e=function(){return typeof bm=="function"},t=function(h,f,g,m){var y=4,b=i;switch(m){case n.image_compression.FAST:y=1,b=s;break;case n.image_compression.MEDIUM:y=6,b=a;break;case n.image_compression.SLOW:y=9,b=A}h=r(h,f,g,b);var S=bm(h,{level:y});return n.__addimage__.arrayBufferToBinaryString(S)},r=function(h,f,g,m){for(var y,b,S,F=h.length/f,k=new Uint8Array(h.length+F),P=c(),te=0;te<F;te+=1){if(S=te*f,y=h.subarray(S,S+f),m)k.set(m(y,g,b),S+te);else{for(var $,j=P.length,J=[];$<j;$+=1)J[$]=P[$](y,g,b);var we=u(J.concat());k.set(J[we],S+te)}b=y}return k},o=function(h){var f=Array.apply([],h);return f.unshift(0),f},s=function(h,f){var g,m=[],y=h.length;m[0]=1;for(var b=0;b<y;b+=1)g=h[b-f]||0,m[b+1]=h[b]-g+256&255;return m},i=function(h,f,g){var m,y=[],b=h.length;y[0]=2;for(var S=0;S<b;S+=1)m=g&&g[S]||0,y[S+1]=h[S]-m+256&255;return y},a=function(h,f,g){var m,y,b=[],S=h.length;b[0]=3;for(var F=0;F<S;F+=1)m=h[F-f]||0,y=g&&g[F]||0,b[F+1]=h[F]+256-(m+y>>>1)&255;return b},A=function(h,f,g){var m,y,b,S,F=[],k=h.length;F[0]=4;for(var P=0;P<k;P+=1)m=h[P-f]||0,y=g&&g[P]||0,b=g&&g[P-f]||0,S=d(m,y,b),F[P+1]=h[P]-S+256&255;return F},d=function(h,f,g){if(h===f&&f===g)return h;var m=Math.abs(f-g),y=Math.abs(h-g),b=Math.abs(h+f-g-g);return m<=y&&m<=b?h:y<=b?f:g},c=function(){return[o,s,i,a,A]},u=function(h){var f=h.map(function(g){return g.reduce(function(m,y){return m+Math.abs(y)},0)});return f.indexOf(Math.min.apply(null,f))};n.processPNG=function(h,f,g,m){var y,b,S,F,k,P,te,$,j,J,we,D,N,Z,se,ce=this.decode.FLATE_DECODE,re="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(S=new oN(h)).imgData,b=S.bits,y=S.colorSpace,k=S.colors,[4,6].indexOf(S.colorType)!==-1){if(S.bits===8){j=($=S.pixelBitlength==32?new Uint32Array(S.decodePixels().buffer):S.pixelBitlength==16?new Uint16Array(S.decodePixels().buffer):new Uint8Array(S.decodePixels().buffer)).length,we=new Uint8Array(j*S.colors),J=new Uint8Array(j);var pe,V=S.pixelBitlength-S.bits;for(Z=0,se=0;Z<j;Z++){for(N=$[Z],pe=0;pe<V;)we[se++]=N>>>pe&255,pe+=S.bits;J[Z]=N>>>pe&255}}if(S.bits===16){j=($=new Uint32Array(S.decodePixels().buffer)).length,we=new Uint8Array(j*(32/S.pixelBitlength)*S.colors),J=new Uint8Array(j*(32/S.pixelBitlength)),D=S.colors>1,Z=0,se=0;for(var K=0;Z<j;)N=$[Z++],we[se++]=N>>>0&255,D&&(we[se++]=N>>>16&255,N=$[Z++],we[se++]=N>>>0&255),J[K++]=N>>>16&255;b=8}m!==n.image_compression.NONE&&e()?(h=t(we,S.width*S.colors,S.colors,m),te=t(J,S.width,1,m)):(h=we,te=J,ce=void 0)}if(S.colorType===3&&(y=this.color_spaces.INDEXED,P=S.palette,S.transparency.indexed)){var oe=S.transparency.indexed,ae=0;for(Z=0,j=oe.length;Z<j;++Z)ae+=oe[Z];if((ae/=255)===j-1&&oe.indexOf(0)!==-1)F=[oe.indexOf(0)];else if(ae!==j){for($=S.decodePixels(),J=new Uint8Array($.length),Z=0,j=$.length;Z<j;Z++)J[Z]=oe[$[Z]];te=t(J,S.width,1)}}var x=function(E){var I;switch(E){case n.image_compression.FAST:I=11;break;case n.image_compression.MEDIUM:I=13;break;case n.image_compression.SLOW:I=14;break;default:I=12}return I}(m);return ce===this.decode.FLATE_DECODE&&(re="/Predictor "+x+" "),re+="/Colors "+k+" /BitsPerComponent "+b+" /Columns "+S.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(te&&this.__addimage__.isArrayBuffer(te)||this.__addimage__.isArrayBufferView(te))&&(te=this.__addimage__.arrayBufferToBinaryString(te)),{alias:g,data:h,index:f,filter:ce,decodeParameters:re,transparency:F,palette:P,sMask:te,predictor:x,width:S.width,height:S.height,bitsPerComponent:b,colorSpace:y}}}})(gr.API),function(n){n.processGIF89A=function(e,t,r,o){var s=new sN(e),i=s.width,a=s.height,A=[];s.decodeAndBlitFrameRGBA(0,A);var d={data:A,width:i,height:a},c=new r0(100).encode(d,100);return n.processJPEG.call(this,c,t,r,o)},n.processGIF87A=n.processGIF89A}(gr.API),Ai.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:o,green:r,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ai.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){wn.log("bit decode error:"+t)}},Ai.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<e;o++)for(var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+8*o*4,a=0;a<8&&8*o+a<this.width;a++){var A=this.palette[s>>7-a&1];this.data[i+4*a]=A.blue,this.data[i+4*a+1]=A.green,this.data[i+4*a+2]=A.red,this.data[i+4*a+3]=255}t!==0&&(this.pos+=4-t)}},Ai.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<n;o++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+2*o*4,a=s>>4,A=15&s,d=this.palette[a];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*o+1>=this.width)break;d=this.palette[A],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},Ai.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;if(o<this.palette.length){var i=this.palette[o];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},Ai.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,A=(s>>10&e)/e*255|0,d=s>>15?255:0,c=r*this.width*4+4*o;this.data[c]=A,this.data[c+1]=a,this.data[c+2]=i,this.data[c+3]=d}this.pos+=n}},Ai.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,A=(i>>5&t)/t*255|0,d=(i>>11)/e*255|0,c=o*this.width*4+4*s;this.data[c]=d,this.data[c+1]=A,this.data[c+2]=a,this.data[c+3]=255}this.pos+=n}},Ai.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*t;this.data[i]=s,this.data[i+1]=o,this.data[i+2]=r,this.data[i+3]=255}this.pos+=this.width%4}},Ai.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=o,this.data[a+2]=r,this.data[a+3]=i}},Ai.prototype.getData=function(){return this.data},function(n){n.processBMP=function(e,t,r,o){var s=new Ai(e,!1),i=s.width,a=s.height,A={data:s.getData(),width:i,height:a},d=new r0(100).encode(A,100);return n.processJPEG.call(this,d,t,r,o)}}(gr.API),yb.prototype.getData=function(){return this.data},function(n){n.processWEBP=function(e,t,r,o){var s=new yb(e),i=s.width,a=s.height,A={data:s.getData(),width:i,height:a},d=new r0(100).encode(A,100);return n.processJPEG.call(this,d,t,r,o)}}(gr.API),gr.API.processRGBA=function(n,e,t){for(var r=n.data,o=r.length,s=new Uint8Array(o/4*3),i=new Uint8Array(o/4),a=0,A=0,d=0;d<o;d+=4){var c=r[d],u=r[d+1],h=r[d+2],f=r[d+3];s[a++]=c,s[a++]=u,s[a++]=h,i[A++]=f}var g=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:g,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},gr.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ad=gr.API,Qf=Ad.getCharWidthsArray=function(n,e){var t,r,o=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:o.metadata.Unicode.widths,A=a.fof?a.fof:1,d=e.kerning?e.kerning:o.metadata.Unicode.kerning,c=d.fof?d.fof:1,u=e.doKerning!==!1,h=0,f=n.length,g=0,m=a[0]||A,y=[];for(t=0;t<f;t++)r=n.charCodeAt(t),typeof o.metadata.widthOfString=="function"?y.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(r))+i*(1e3/s)||0)/1e3):(h=u&&ln(d[r])==="object"&&!isNaN(parseInt(d[r][g],10))?d[r][g]/c:0,y.push((a[r]||m)/A+h)),g=r;return y},gb=Ad.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),o=e.charSpace||this.internal.getCharSpace();return Ad.processArabic&&(n=Ad.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,o)/t:Qf.apply(this,arguments).reduce(function(s,i){return s+i},0)},vb=function(n,e,t,r){for(var o=[],s=0,i=n.length,a=0;s!==i&&a+e[s]<t;)a+=e[s],s++;o.push(n.slice(0,s));var A=s;for(a=0;s!==i;)a+e[s]>r&&(o.push(n.slice(A,s)),a=0,A=s),a+=e[s],s++;return A!==s&&o.push(n.slice(A,s)),o},mb=function(n,e,t){t||(t={});var r,o,s,i,a,A,d,c=[],u=[c],h=t.textIndent||0,f=0,g=0,m=n.split(" "),y=Qf.apply(this,[" ",t])[0];if(A=t.lineIndent===-1?m[0].length+2:t.lineIndent||0){var b=Array(A).join(" "),S=[];m.map(function(k){(k=k.split(/\s*\n/)).length>1?S=S.concat(k.map(function(P,te){return(te&&P.length?`
`:"")+P})):S.push(k[0])}),m=S,A=gb.apply(this,[b,t])}for(s=0,i=m.length;s<i;s++){var F=0;if(r=m[s],A&&r[0]==`
`&&(r=r.substr(1),F=1),h+f+(g=(o=Qf.apply(this,[r,t])).reduce(function(k,P){return k+P},0))>e||F){if(g>e){for(a=vb.apply(this,[r,o,e-(h+f),e]),c.push(a.shift()),c=[a.pop()];a.length;)u.push([a.shift()]);g=o.slice(r.length-(c[0]?c[0].length:0)).reduce(function(k,P){return k+P},0)}else c=[r];u.push(c),h=g+A,f=y}else c.push(r),h+=f+g,f=y}return d=A?function(k,P){return(P?b:"")+k.join(" ")}:function(k){return k.join(" ")},u.map(d)},Ad.splitTextToSize=function(n,e,t){var r,o=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var u=this.internal.getFont(c.fontName,c.fontStyle);return u.metadata.Unicode?{widths:u.metadata.Unicode.widths||{0:1},kerning:u.metadata.Unicode.kerning||{}}:{font:u.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/o;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/o:0,s.lineIndent=t.lineIndent;var a,A,d=[];for(a=0,A=r.length;a<A;a++)d=d.concat(mb.apply(this,[r[a],i,s]));return d},function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},r={},o=0;o<e.length;o++)t[e[o]]="0123456789abcdef"[o],r["0123456789abcdef"[o]]=e[o];var s=function(u){return"0x"+parseInt(u,10).toString(16)},i=n.__fontmetrics__.compress=function(u){var h,f,g,m,y=["{"];for(var b in u){if(h=u[b],isNaN(parseInt(b,10))?f="'"+b+"'":(b=parseInt(b,10),f=(f=s(b).slice(2)).slice(0,-1)+r[f.slice(-1)]),typeof h=="number")h<0?(g=s(h).slice(3),m="-"):(g=s(h).slice(2),m=""),g=m+g.slice(0,-1)+r[g.slice(-1)];else{if(ln(h)!=="object")throw new Error("Don't know what to do with value type "+ln(h)+".");g=i(h)}y.push(f+g)}return y.push("}"),y.join("")},a=n.__fontmetrics__.uncompress=function(u){if(typeof u!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,f,g,m,y={},b=1,S=y,F=[],k="",P="",te=u.length-1,$=1;$<te;$+=1)(m=u[$])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(m):m=="{"?(F.push([S,g]),S={},g=void 0):m=="}"?((f=F.pop())[0][f[1]]=S,g=void 0,S=f[0]):m=="-"?b=-1:g===void 0?t.hasOwnProperty(m)?(k+=t[m],g=parseInt(k,16)*b,b=1,k=""):k+=m:t.hasOwnProperty(m)?(P+=t[m],S[g]=parseInt(P,16)*b,b=1,g=void 0,P=""):P+=m;return y},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},c={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(u){var h=u.font,f=c.Unicode[h.postScriptName];f&&(h.metadata.Unicode={},h.metadata.Unicode.widths=f.widths,h.metadata.Unicode.kerning=f.kerning);var g=d.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(gr.API),function(n){var e=function(t){for(var r=t.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=t.charCodeAt(s);return o};n.API.events.push(["addFont",function(t){var r=void 0,o=t.font,s=t.instance;if(!o.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(r=s.existsFileInVFS(o.postScriptName)===!1?s.loadFile(o.postScriptName):s.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(i,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(hu(a)),i.metadata=n.API.TTFFont.open(a),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(o,r)}}])}(gr),function(n){function e(){return(wr.canvg?Promise.resolve(wr.canvg):cs(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}gr.API.addSvgAsImage=function(t,r,o,s,i,a,A,d){if(isNaN(r)||isNaN(o))throw wn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(i))throw wn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return e().then(function(g){return g.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(g){return g.render(h)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),r,o,s,i,A,d)})}}(),gr.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var o=0;o<this.internal.pages[r].length;o++)this.internal.pages[r][o]=this.internal.pages[r][o].replace(e,t);return this},gr.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,o,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(i),A=[],d=0,c=0,u=0;function h(g,m){var y,b=!1;for(y=0;y<g.length;y+=1)g[y]===m&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var f=a.length;for(u=0;u<f;u+=1)t[a[u]].value=t[a[u]].defaultValue,t[a[u]].explicitSet=!1}if(ln(n)==="object"){for(o in n)if(s=n[o],h(a,o)&&s!==void 0){if(t[o].type==="boolean"&&typeof s=="boolean")t[o].value=s;else if(t[o].type==="name"&&h(t[o].valueSet,s))t[o].value=s;else if(t[o].type==="integer"&&Number.isInteger(s))t[o].value=s;else if(t[o].type==="array"){for(d=0;d<s.length;d+=1)if(r=!0,s[d].length===1&&typeof s[d][0]=="number")A.push(String(s[d]-1));else if(s[d].length>1){for(c=0;c<s[d].length;c+=1)typeof s[d][c]!="number"&&(r=!1);r===!0&&A.push([s[d][0]-1,s[d][1]-1].join(" "))}t[o].value="["+A.join(" ")+"]"}else t[o].value=t[o].defaultValue;t[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,m=[];for(g in t)t[g].explicitSet===!0&&(t[g].type==="name"?m.push("/"+g+" /"+t[g].value):m.push("/"+g+" "+t[g].value));m.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+m.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),A=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+i.length+a.length+o.length+A.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(o+s+i+a+A),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(gr.API),function(n){var e=n.API,t=e.pdfEscape16=function(s,i){for(var a,A=i.metadata.Unicode.widths,d=["","0","00","000","0000"],c=[""],u=0,h=s.length;u<h;++u){if(a=i.metadata.characterToGlyph(s.charCodeAt(u)),i.metadata.glyIdsUsed.push(a),i.metadata.toUnicode[a]=s.charCodeAt(u),A.indexOf(a)==-1&&(A.push(a),A.push([parseInt(i.metadata.widthOfGlyph(a),10)])),a=="0")return c.join("");a=a.toString(16),c.push(d[4-a.length],a)}return c.join("")},r=function(s){var i,a,A,d,c,u,h;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,A=[],u=0,h=(a=Object.keys(s).sort(function(f,g){return f-g})).length;u<h;u++)i=a[u],A.length>=100&&(c+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar`,A=[]),s[i]!==void 0&&s[i]!==null&&typeof s[i].toString=="function"&&(d=("0000"+s[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),A.push("<"+i+"><"+d+">"));return A.length&&(c+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(i){var a=i.font,A=i.out,d=i.newObject,c=i.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var u=a.metadata.Unicode.widths,h=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),f="",g=0;g<h.length;g++)f+=String.fromCharCode(h[g]);var m=d();c({data:f,addLength1:!0,objectId:m}),A("endobj");var y=d();c({data:r(a.metadata.toUnicode),addLength1:!0,objectId:y}),A("endobj");var b=d();A("<<"),A("/Type /FontDescriptor"),A("/FontName /"+fd(a.fontName)),A("/FontFile2 "+m+" 0 R"),A("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),A("/Flags "+a.metadata.flags),A("/StemV "+a.metadata.stemV),A("/ItalicAngle "+a.metadata.italicAngle),A("/Ascent "+a.metadata.ascender),A("/Descent "+a.metadata.decender),A("/CapHeight "+a.metadata.capHeight),A(">>"),A("endobj");var S=d();A("<<"),A("/Type /Font"),A("/BaseFont /"+fd(a.fontName)),A("/FontDescriptor "+b+" 0 R"),A("/W "+n.API.PDFObject.convert(u)),A("/CIDToGIDMap /Identity"),A("/DW 1000"),A("/Subtype /CIDFontType2"),A("/CIDSystemInfo"),A("<<"),A("/Supplement 0"),A("/Registry (Adobe)"),A("/Ordering ("+a.encoding+")"),A(">>"),A(">>"),A("endobj"),a.objectNumber=d(),A("<<"),A("/Type /Font"),A("/Subtype /Type0"),A("/ToUnicode "+y+" 0 R"),A("/BaseFont /"+fd(a.fontName)),A("/Encoding /"+a.encoding),A("/DescendantFonts ["+S+" 0 R]"),A(">>"),A("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(i){var a=i.font,A=i.out,d=i.newObject,c=i.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var u=a.metadata.rawData,h="",f=0;f<u.length;f++)h+=String.fromCharCode(u[f]);var g=d();c({data:h,addLength1:!0,objectId:g}),A("endobj");var m=d();c({data:r(a.metadata.toUnicode),addLength1:!0,objectId:m}),A("endobj");var y=d();A("<<"),A("/Descent "+a.metadata.decender),A("/CapHeight "+a.metadata.capHeight),A("/StemV "+a.metadata.stemV),A("/Type /FontDescriptor"),A("/FontFile2 "+g+" 0 R"),A("/Flags 96"),A("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),A("/FontName /"+fd(a.fontName)),A("/ItalicAngle "+a.metadata.italicAngle),A("/Ascent "+a.metadata.ascender),A(">>"),A("endobj"),a.objectNumber=d();for(var b=0;b<a.metadata.hmtx.widths.length;b++)a.metadata.hmtx.widths[b]=parseInt(a.metadata.hmtx.widths[b]*(1e3/a.metadata.head.unitsPerEm));A("<</Subtype/TrueType/Type/Font/ToUnicode "+m+" 0 R/BaseFont/"+fd(a.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),A("endobj"),a.isAlreadyPutted=!0}})(s)}]);var o=function(s){var i,a=s.text||"",A=s.x,d=s.y,c=s.options||{},u=s.mutex||{},h=u.pdfEscape,f=u.activeFontKey,g=u.fonts,m=f,y="",b=0,S="",F=g[m].encoding;if(g[m].encoding!=="Identity-H")return{text:a,x:A,y:d,options:c,mutex:u};for(S=a,m=f,Array.isArray(a)&&(S=a[0]),b=0;b<S.length;b+=1)g[m].metadata.hasOwnProperty("cmap")&&(i=g[m].metadata.cmap.unicode.codeMap[S[b].charCodeAt(0)]),i||S[b].charCodeAt(0)<256&&g[m].metadata.hasOwnProperty("Unicode")?y+=S[b]:y+="";var k="";return parseInt(m.slice(1))<14||F==="WinAnsiEncoding"?k=h(y,m).split("").map(function(P){return P.charCodeAt(0).toString(16)}).join(""):F==="Identity-H"&&(k=t(y,g[m])),u.isHex=!0,{text:k,x:A,y:d,options:c,mutex:u}};e.events.push(["postProcessText",function(s){var i=s.text||"",a=[],A={text:i,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?a.push([o(Object.assign({},A,{text:i[d][0]})).text,i[d][1],i[d][2]]):a.push(o(Object.assign({},A,{text:i[d]})).text);s.text=a}else s.text=o(Object.assign({},A,{text:i})).text}])}(gr),function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(gr.API),function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var o,s,i,a,A,d,c,u=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],f=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},m={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),S=!1,F=0;this.__bidiEngine__={};var k=function(D){var N=D.charCodeAt(),Z=N>>8,se=m[Z];return se!==void 0?u[256*se+(255&N)]:Z===252||Z===253?"AL":b.test(Z)?"L":Z===8?"R":"N"},P=function(D){for(var N,Z=0;Z<D.length;Z++){if((N=k(D.charAt(Z)))==="L")return!1;if(N==="R")return!0}return!1},te=function(D,N,Z,se){var ce,re,pe,V,K=N[se];switch(K){case"L":case"R":S=!1;break;case"N":case"AN":break;case"EN":S&&(K="AN");break;case"AL":S=!0,K="R";break;case"WS":K="N";break;case"CS":se<1||se+1>=N.length||(ce=Z[se-1])!=="EN"&&ce!=="AN"||(re=N[se+1])!=="EN"&&re!=="AN"?K="N":S&&(re="AN"),K=re===ce?re:"N";break;case"ES":K=(ce=se>0?Z[se-1]:"B")==="EN"&&se+1<N.length&&N[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&Z[se-1]==="EN"){K="EN";break}if(S){K="N";break}for(pe=se+1,V=N.length;pe<V&&N[pe]==="ET";)pe++;K=pe<V&&N[pe]==="EN"?"EN":"N";break;case"NSM":if(i&&!a){for(V=N.length,pe=se+1;pe<V&&N[pe]==="NSM";)pe++;if(pe<V){var oe=D[se],ae=oe>=1425&&oe<=2303||oe===64286;if(ce=N[pe],ae&&(ce==="R"||ce==="AL")){K="R";break}}}K=se<1||(ce=N[se-1])==="B"?"N":Z[se-1];break;case"B":S=!1,o=!0,K=F;break;case"S":s=!0,K="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":S=!1;break;case"BN":K="N"}return K},$=function(D,N,Z){var se=D.split("");return Z&&j(se,Z,{hiLevel:F}),se.reverse(),N&&N.reverse(),se.join("")},j=function(D,N,Z){var se,ce,re,pe,V,K=-1,oe=D.length,ae=0,x=[],E=F?f:h,I=[];for(S=!1,o=!1,s=!1,ce=0;ce<oe;ce++)I[ce]=k(D[ce]);for(re=0;re<oe;re++){if(V=ae,x[re]=te(D,I,x,re),se=240&(ae=E[V][g[x[re]]]),ae&=15,N[re]=pe=E[ae][5],se>0)if(se===16){for(ce=K;ce<re;ce++)N[ce]=1;K=-1}else K=-1;if(E[ae][6])K===-1&&(K=re);else if(K>-1){for(ce=K;ce<re;ce++)N[ce]=pe;K=-1}I[re]==="B"&&(N[re]=0),Z.hiLevel|=pe}s&&function(L,M,H){for(var q=0;q<H;q++)if(L[q]==="S"){M[q]=F;for(var G=q-1;G>=0&&L[G]==="WS";G--)M[G]=F}}(I,N,oe)},J=function(D,N,Z,se,ce){if(!(ce.hiLevel<D)){if(D===1&&F===1&&!o)return N.reverse(),void(Z&&Z.reverse());for(var re,pe,V,K,oe=N.length,ae=0;ae<oe;){if(se[ae]>=D){for(V=ae+1;V<oe&&se[V]>=D;)V++;for(K=ae,pe=V-1;K<pe;K++,pe--)re=N[K],N[K]=N[pe],N[pe]=re,Z&&(re=Z[K],Z[K]=Z[pe],Z[pe]=re);ae=V}ae++}}},we=function(D,N,Z){var se=D.split(""),ce={hiLevel:F};return Z||(Z=[]),j(se,Z,ce),function(re,pe,V){if(V.hiLevel!==0&&c)for(var K,oe=0;oe<re.length;oe++)pe[oe]===1&&(K=y.indexOf(re[oe]))>=0&&(re[oe]=y[K+1])}(se,Z,ce),J(2,se,N,Z,ce),J(1,se,N,Z,ce),se.join("")};return this.__bidiEngine__.doBidiReorder=function(D,N,Z){if(function(ce,re){if(re)for(var pe=0;pe<ce.length;pe++)re[pe]=pe;a===void 0&&(a=P(ce)),d===void 0&&(d=P(ce))}(D,N),i||!A||d)if(i&&A&&a^d)F=a?1:0,D=$(D,N,Z);else if(!i&&A&&d)F=a?1:0,D=we(D,N,Z),D=$(D,N);else if(!i||a||A||d){if(i&&!A&&a^d)D=$(D,N),a?(F=0,D=we(D,N,Z)):(F=1,D=we(D,N,Z),D=$(D,N));else if(i&&a&&!A&&d)F=1,D=we(D,N,Z),D=$(D,N);else if(!i&&!A&&a^d){var se=c;a?(F=1,D=we(D,N,Z),F=0,c=!1,D=we(D,N,Z),c=se):(F=0,D=we(D,N,Z),D=$(D,N),F=1,c=!1,D=we(D,N,Z),c=se,D=$(D,N))}}else F=0,D=we(D,N,Z);else F=a?1:0,D=we(D,N,Z);return D},this.__bidiEngine__.setOptions=function(D){D&&(i=D.isInputVisual,A=D.isOutputVisual,a=D.isInputRtl,d=D.isOutputRtl,c=D.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var o=r.text,s=(r.x,r.y,r.options||{}),i=(r.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(o)==="[object Array]"){var a=0;for(i=[],a=0;a<o.length;a+=1)Object.prototype.toString.call(o[a])==="[object Array]"?i.push([t.doBidiReorder(o[a][0]),o[a][1],o[a][2]]):i.push([t.doBidiReorder(o[a])]);r.text=i}else r.text=t.doBidiReorder(o);t.setOptions({isInputVisual:!0})}])}(gr),gr.API.TTFFont=function(){function n(e){var t;if(this.rawData=e,t=this.contents=new BA(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new yN(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new iN(this.contents),this.head=new AN(this),this.name=new hN(this),this.cmap=new lz(this),this.toUnicode={},this.hhea=new lN(this),this.maxp=new fN(this),this.hmtx=new pN(this),this.post=new cN(this),this.os2=new dN(this),this.loca=new wN(this),this.glyf=new gN(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,o,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,a,A,d;for(d=[],i=0,a=(A=this.bbox).length;i<a;i++)e=A[i],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(o=this.post.italic_angle),32768&(t=o>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var o,s,i,a;for(i=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)o=e.charCodeAt(s),i+=this.widthOfGlyph(this.characterToGlyph(o))+r*(1e3/t)||0;return i*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n}();var xi,BA=function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,o;for(o=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)o.push(this.writeByte(e.charCodeAt(t)));return o},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,o,s,i,a,A;return e=this.readByte(),t=this.readByte(),r=this.readByte(),o=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),A=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^o)+16777216*(255^s)+65536*(255^i)+256*(255^a)+(255^A)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*o+16777216*s+65536*i+256*a+A},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,o,s;for(s=[],r=0,o=e.length;r<o;r++)t=e[r],s.push(this.writeByte(t));return s},n}(),iN=function(){var n;function e(t){var r,o,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},o=0,s=this.tableCount;0<=s?o<s:o>s;o=0<=s?++o:--o)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,o,s,i,a,A,d,c,u,h,f,g,m;for(m in f=Object.keys(t).length,A=Math.log(2),u=16*Math.floor(Math.log(f)/A),i=Math.floor(u/A),c=16*f-u,(o=new BA).writeInt(this.scalarType),o.writeShort(f),o.writeShort(u),o.writeShort(i),o.writeShort(c),s=16*f,d=o.pos+s,a=null,g=[],t)for(h=t[m],o.writeString(m),o.writeInt(n(h)),o.writeInt(d),o.writeInt(h.length),g=g.concat(h),m==="head"&&(a=d),d+=h.length;d%4;)g.push(0),d++;return o.write(g),r=2981146554-n(o.data),o.pos=a+8,o.writeUInt32(r),o.data},n=function(t){var r,o,s,i;for(t=dz.call(t);t.length%4;)t.push(0);for(s=new BA(t),o=0,r=0,i=t.length;r<i;r=r+=4)o+=s.readUInt32();return 4294967295&o},e}(),aN={}.hasOwnProperty,ea=function(n,e){for(var t in e)aN.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};xi=function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n}();var AN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new BA).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),bb=function(){function n(e,t){var r,o,s,i,a,A,d,c,u,h,f,g,m,y,b,S,F;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),u=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(A=0;A<256;++A)this.codeMap[A]=e.readByte();break;case 4:for(f=e.readUInt16(),h=f/2,e.pos+=6,s=function(){var k,P;for(P=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)P.push(e.readUInt16());return P}(),e.pos+=2,m=function(){var k,P;for(P=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)P.push(e.readUInt16());return P}(),d=function(){var k,P;for(P=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)P.push(e.readUInt16());return P}(),c=function(){var k,P;for(P=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)P.push(e.readUInt16());return P}(),o=(this.length-e.pos+this.offset)/2,a=function(){var k,P;for(P=[],A=k=0;0<=o?k<o:k>o;A=0<=o?++k:--k)P.push(e.readUInt16());return P}(),A=b=0,F=s.length;b<F;A=++b)for(y=s[A],r=S=g=m[A];g<=y?S<=y:S>=y;r=g<=y?++S:--S)c[A]===0?i=r+d[A]:(i=a[c[A]/2+(r-g)-(h-A)]||0)!==0&&(i+=d[A]),this.codeMap[r]=65535&i}e.pos=u}return n.encode=function(e,t){var r,o,s,i,a,A,d,c,u,h,f,g,m,y,b,S,F,k,P,te,$,j,J,we,D,N,Z,se,ce,re,pe,V,K,oe,ae,x,E,I,L,M,H,q,G,R,he,Be;switch(se=new BA,i=Object.keys(e).sort(function(be,Le){return be-Le}),t){case"macroman":for(m=0,y=function(){var be=[];for(g=0;g<256;++g)be.push(0);return be}(),S={0:0},s={},ce=0,K=i.length;ce<K;ce++)S[G=e[o=i[ce]]]==null&&(S[G]=++m),s[o]={old:e[o],new:S[e[o]]},y[o]=S[e[o]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(y),{charMap:s,subtable:se.data,maxGlyphID:m+1};case"unicode":for(N=[],u=[],F=0,S={},r={},b=d=null,re=0,oe=i.length;re<oe;re++)S[P=e[o=i[re]]]==null&&(S[P]=++F),r[o]={old:P,new:S[P]},a=S[P]-o,b!=null&&a===d||(b&&u.push(b),N.push(o),d=a),b=o;for(b&&u.push(b),u.push(65535),N.push(65535),we=2*(J=N.length),j=2*Math.pow(Math.log(J)/Math.LN2,2),h=Math.log(j/2)/Math.LN2,$=2*J-j,A=[],te=[],f=[],g=pe=0,ae=N.length;pe<ae;g=++pe){if(D=N[g],c=u[g],D===65535){A.push(0),te.push(0);break}if(D-(Z=r[D].new)>=32768)for(A.push(0),te.push(2*(f.length+J-g)),o=V=D;D<=c?V<=c:V>=c;o=D<=c?++V:--V)f.push(r[o].new);else A.push(Z-D),te.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*J+2*f.length),se.writeUInt16(0),se.writeUInt16(we),se.writeUInt16(j),se.writeUInt16(h),se.writeUInt16($),H=0,x=u.length;H<x;H++)o=u[H],se.writeUInt16(o);for(se.writeUInt16(0),q=0,E=N.length;q<E;q++)o=N[q],se.writeUInt16(o);for(R=0,I=A.length;R<I;R++)a=A[R],se.writeUInt16(a);for(he=0,L=te.length;he<L;he++)k=te[he],se.writeUInt16(k);for(Be=0,M=f.length;Be<M;Be++)m=f[Be],se.writeUInt16(m);return{charMap:r,subtable:se.data,maxGlyphID:F+1}}},n}(),lz=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,o,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)r=new bb(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var o,s;return r==null&&(r="macroman"),o=bb.encode(t,r),(s=new BA).writeUInt16(0),s.writeUInt16(1),o.table=s.data.concat(o.subtable),o},e}(),lN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),dN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,o;for(o=[],r=0;r<10;++r)o.push(t.readByte());return o}(),this.charRange=function(){var r,o;for(o=[],r=0;r<4;++r)o.push(t.readInt());return o}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,o;for(o=[],r=0;r<2;r=++r)o.push(t.readInt());return o}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),cN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="post",e.prototype.parse=function(t){var r,o,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var i;for(o=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return o=t.readUInt16(),this.offsets=t.read(o);case 196608:break;case 262144:return this.map=(function(){var a,A,d;for(d=[],i=a=0,A=this.file.maxp.numGlyphs;0<=A?a<A:a>A;i=0<=A?++a:--a)d.push(t.readUInt32());return d}).call(this)}},e}(),uN=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},hN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="name",e.prototype.parse=function(t){var r,o,s,i,a,A,d,c,u,h,f;for(t.pos=this.offset,t.readShort(),r=t.readShort(),A=t.readShort(),o=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)o.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+A+t.readShort()});for(d={},i=u=0,h=o.length;u<h;i=++u)s=o[i],t.pos=s.offset,c=t.readString(s.length),a=new uN(c,s),d[f=s.nameID]==null&&(d[f]=[]),d[s.nameID].push(a);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),fN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),pN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,o,s,i,a,A,d;for(t.pos=this.offset,this.metrics=[],r=0,A=this.file.hhea.numberOfMetrics;0<=A?r<A:r>A;r=0<=A?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,u;for(u=[],r=c=0;0<=s?c<s:c>s;r=0<=s?++c:--c)u.push(t.readInt16());return u}(),this.widths=(function(){var c,u,h,f;for(f=[],c=0,u=(h=this.metrics).length;c<u;c++)i=h[c],f.push(i.advance);return f}).call(this),o=this.widths[this.widths.length-1],d=[],r=a=0;0<=s?a<s:a>s;r=0<=s?++a:--a)d.push(this.widths.push(o));return d},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),dz=[].slice,gN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,o,s,i,a,A,d,c,u,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,o=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+o,a=(A=new BA(r.read(s))).readShort(),c=A.readShort(),h=A.readShort(),d=A.readShort(),u=A.readShort(),this.cache[t]=a===-1?new mN(A,c,h,d,u):new vN(A,a,c,h,d,u),this.cache[t]))},e.prototype.encode=function(t,r,o){var s,i,a,A,d;for(a=[],i=[],A=0,d=r.length;A<d;A++)s=t[r[A]],i.push(a.length),s&&(a=a.concat(s.encode(o)));return i.push(a.length),{table:a,offsets:i}},e}(),vN=function(){function n(e,t,r,o,s,i){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=o,this.xMax=s,this.yMax=i,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n}(),mN=function(){function n(e,t,r,o,s){var i,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=o,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;a=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&a;)i.pos+=1&a?4:2,128&a?i.pos+=8:64&a?i.pos+=4:8&a&&(i.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new BA(dz.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n}(),wN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return ea(e,xi),e.prototype.tag="loca",e.prototype.parse=function(t){var r,o;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],o=0,s=this.length;o<s;o+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],o=0,s=this.length;o<s;o+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var o=new Uint32Array(this.offsets.length),s=0,i=0,a=0;a<o.length;++a)if(o[a]=s,i<r.length&&r[i]==a){++i,o[a]=s;var A=this.offsets[a],d=this.offsets[a+1]-A;d>0&&(s+=d)}for(var c=new Array(4*o.length),u=0;u<o.length;++u)c[4*u+3]=255&o[u],c[4*u+2]=(65280&o[u])>>8,c[4*u+1]=(16711680&o[u])>>16,c[4*u]=(4278190080&o[u])>>24;return c},e}(),yN=function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,o,s;for(t in o=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[t],e[t]=o[r];return e},n.prototype.glyphsFor=function(e){var t,r,o,s,i,a,A;for(o={},i=0,a=e.length;i<a;i++)o[s=e[i]]=this.font.glyf.glyphFor(s);for(s in t=[],o)(r=o[s])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(s in A=this.glyphsFor(t))r=A[s],o[s]=r;return o},n.prototype.encode=function(e,t){var r,o,s,i,a,A,d,c,u,h,f,g,m,y,b;for(o in r=lz.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),f={0:0},b=r.charMap)f[(A=b[o]).old]=A.new;for(g in h=r.maxGlyphID,i)g in f||(f[g]=h++);return c=function(S){var F,k;for(F in k={},S)k[S[F]]=F;return k}(f),u=Object.keys(c).sort(function(S,F){return S-F}),m=function(){var S,F,k;for(k=[],S=0,F=u.length;S<F;S++)a=u[S],k.push(c[a]);return k}(),s=this.font.glyf.encode(i,m,f),d=this.font.loca.encode(s.offsets,m),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},n}();gr.API.PDFObject=function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,o,s,i;if(Array.isArray(t))return"["+function(){var a,A,d;for(d=[],a=0,A=t.length;a<A;a++)r=t[a],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(o in s=["<<"],t)i=t[o],s.push("/"+o+" "+e.convert(i));return s.push(">>"),s.join(`
`)}return""+t},e}();var bN=ee('<tr><td class="odz-text-xs"></td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td> </td></tr>'),_N=ee('<tr><td></td><td colspan="5" class="odz-text-xs"> <!> <!></td><td> </td></tr>'),BN=ee('<tr><td></td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td> </td></tr>'),xN=ee("<!> <!> <!>",1),zN=ee('<tr><td></td><td class="odz-text-xs">[]  </td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td> </td></tr>'),CN=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl odz-p-8 odz-print-area"><h1 class="odz-text-center odz-text-3xl odz-font-bold odz-mb-8"></h1> <table class="odz-table odz-w-full odz-border odz-border-gray-400"><tbody><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200 odz-w-32"> </td><td>101-86-83287</td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td>()</td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"> </td><td colspan="3">  22 19-15</td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td></td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td></td><td class="odz-font-bold odz-bg-base-200"></td><td>02-6499-2267</td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td colspan="3"><div class="odz-flex odz-justify-between"><span></span> <span></span></div></td></tr></tbody></table> <div class="odz-my-4"><div class="odz-font-bold">  (+)</div> <div class="odz-text-right"> </div></div> <table class="odz-table odz-table-bordered odz-w-full"><thead><tr class="odz-bg-base-200"><th></th><th>/</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><!><!><tr><td colspan="3" class="odz-text-center odz-font-bold"></td><td class="odz-font-bold"> </td><td class="odz-font-bold"></td><td class="odz-font-bold"> </td><td class="odz-font-bold"> </td></tr></tbody></table> <div class="odz-mt-4 odz-p-4 odz-bg-base-200 odz-rounded"><div class="odz-font-bold odz-mb-2"></div> <ul class="odz-list-disc odz-list-inside odz-text-sm"><li>   20 (   )</li> <li>      .</li> <li>   .</li> <li>   .</li> <li>       ,  .</li></ul></div> <div class="odz-flex odz-justify-end odz-gap-2 odz-mt-6 print:odz-hidden"><button class="odz-btn odz-btn-primary"></button> <button class="odz-btn odz-btn-secondary">PDF </button> <button class="odz-btn"></button></div></div></dialog>');function SN(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t);let s=pt(e,"isOpen",12);function i(){s(!1)}function a(){window.print()}console.log("paper estimateStore",o());const A=new Date,d=`${A.getFullYear()} ${String(A.getMonth()+1).padStart(2,"0")} ${String(A.getDate()).padStart(2,"0")}`;async function c(){const oe=document.querySelector(".odz-print-area");if(oe)try{const ae=oe.querySelector(".print\\:odz-hidden");let x="";ae&&(x=ae.style.display,ae.style.display="none");const E=oe.scrollHeight,I=oe.scrollWidth,L=oe.scrollTop;oe.scrollTop=0;const M=await bD(oe,{useCORS:!0,scale:2,x:0,y:0,width:I,height:E,backgroundColor:"#ffffff",logging:!1,allowTaint:!0,windowHeight:E});oe.scrollTop=L,ae&&(ae.style.display=x);const H=M.toDataURL("image/png",1),q=new gr({orientation:"portrait",unit:"mm",format:"a4"}),G=q.internal.pageSize.getWidth(),R=q.internal.pageSize.getHeight(),he=10,Be=G-he*2,be=R-he*2,Le=M.height/M.width;let O=Be*Le;if(O>be){const ve=Math.ceil(O/be),xe=M.height/O,me=be*xe;for(let le=0;le<ve;le++){le>0&&q.addPage();const ze=-le*me/xe;q.addImage(H,"PNG",he,ze+he,Be,M.height*(Be/M.width))}}else q.addImage(H,"PNG",he,he,Be,O);q.save(".pdf")}catch(ae){console.error("PDF    :",ae)}}qr();var u=CN(),h=w(u),f=z(w(h),2),g=w(f),m=w(g),y=z(w(m),3);y.textContent=d;var b=z(f,2),S=z(w(b),2),F=w(S),k=z(b,2),P=z(w(k)),te=w(P);Jt(te,1,()=>o().products,ar,(oe,ae,x)=>{var E=xN(),I=gt(E);Jt(I,1,()=>l(ae).variants,ar,(G,R,he)=>{var Be=bN();const be=it(()=>l(R).prices[0].amount),Le=it(()=>l(ae).variants.reduce((De,Ne)=>De+(Ne.quantity||0),0)),Y=it(()=>{var De;return(De=l(ae).discountInfo)!=null&&De.hasDiscount?(l(ae).discountInfo.originalAmount-l(ae).discountInfo.discountAmount)/l(Le):l(be)}),O=it(()=>l(Y)*l(R).quantity);var ve=w(Be);ve.textContent=`${x+1}-${he+1}`;var xe=z(ve),me=w(xe),le=z(xe),ze=w(le),ke=z(le),de=w(ke),Fe=z(ke),U=w(Fe),Ae=z(Fe),fe=w(Ae),Ce=z(Ae),ge=w(Ce);He((De,Ne)=>{Qe(me,l(ae).product.title),Qe(ze,l(R).title||""),Qe(de,l(R).quantity),Qe(U,De),Qe(fe,Ne),Qe(ge,Ne)},[()=>vr(l(Y)),()=>vr(l(O))],it),T(G,Be)});var L=z(I,2);{var M=G=>{var R=Nt(),he=gt(R);Jt(he,1,()=>l(ae).prints,ar,(Be,be)=>{var Le=_N(),Y=z(w(Le)),O=w(Y),ve=z(O);{var xe=de=>{var Fe=Wr();He(U=>Qe(Fe,`- ${U??""}`),[()=>l(be).parentTemplates.map(U=>U.name).join(" > ")],it),T(de,Fe)};Se(ve,de=>{l(be).parentTemplates&&de(xe)})}var me=z(ve,2);{var le=de=>{var Fe=Wr();He(()=>Qe(Fe,`- ${l(be).colors.length??""}`)),T(de,Fe)};Se(me,de=>{l(be).colors&&de(le)})}var ze=z(Y),ke=w(ze);He(de=>{Qe(O,`: ${l(be).title??""} `),Qe(ke,de)},[()=>vr(l(be).price||0)],it),T(Be,Le)}),T(G,R)};Se(L,G=>{l(ae).prints&&l(ae).prints.length>0&&G(M)})}var H=z(L,2);{var q=G=>{var R=Nt(),he=gt(R);Jt(he,1,()=>Object.entries(l(ae).addons),ar,(Be,be)=>{let Le=()=>l(be)[1];var Y=Nt();const O=it(()=>l(ae).addonProductsMap[Le().productId]),ve=it(()=>{var le,ze;return(ze=(le=l(O))==null?void 0:le.variants)==null?void 0:ze.find(ke=>ke.id===Le().variantId)});var xe=gt(Y);{var me=le=>{var ze=BN(),ke=z(w(ze)),de=w(ke),Fe=z(ke),U=w(Fe),Ae=z(Fe),fe=w(Ae),Ce=z(Ae),ge=w(Ce),De=z(Ce),Ne=w(De),Ze=z(De),Oe=w(Ze);He((Ke,Je)=>{Qe(de,`[] ${l(O).title??""}`),Qe(U,l(ve).title||""),Qe(fe,l(ae).quantity),Qe(ge,Ke),Qe(Ne,Je),Qe(Oe,Je)},[()=>vr(l(ve).prices[0].amount),()=>vr(l(ve).prices[0].amount*l(ae).quantity)],it),T(le,ze)};Se(xe,le=>{l(O)&&l(ve)&&le(me)})}T(Be,Y)}),T(G,R)};Se(H,G=>{l(ae).addons&&l(ae).addonProductsMap&&Object.keys(l(ae).addons).length>0&&G(q)})}T(oe,E)});var $=z(te);{var j=oe=>{var ae=zN(),x=z(w(ae),6),E=w(x);He(I=>Qe(E,I),[()=>vr(o().totalAdditionalAmount)],it),T(oe,ae)};Se($,oe=>{o().totalAdditionalAmount>0&&oe(j)})}var J=z($),we=z(w(J)),D=w(we),N=z(we,2),Z=w(N),se=z(N),ce=w(se),re=z(k,4),pe=w(re),V=z(pe,2),K=z(V,2);He((oe,ae)=>{Qe(F,` (  ${oe??""} )`),Qe(D,`${o().totalQuantity??""}`),Qe(Z,ae),Qe(ce,oe)},[()=>vr(o().totalAmount),()=>vr(o().totalProductAmount+o().totalPrintAmount+o().totalAddonAmount+o().totalAdditionalAmount)],it),at("click",pe,a),at("click",V,c),at("click",K,i),T(n,u),jr(),r()}var EN=ee("<!> <button> </button>",1),FN=ee("<button> </button>"),IN=ee('<div class="odz-flex odz-flex-wrap odz-gap-1.5"></div>'),UN=ee('<div class="odz-flex odz-justify-center odz-items-center odz-h-32"><div class="odz-loading odz-loading-spinner odz-loading-md"></div></div>'),QN=ee('<div class="odz-text-error odz-text-center odz-py-4"> </div>'),TN=ee('<div class="odz-text-center odz-py-4 odz-text-gray-500">  .</div>'),LN=ee('<img class="odz-w-12 odz-h-12 odz-object-cover odz-rounded odz-flex-shrink-0">'),PN=ee('<div class="odz-w-12 odz-h-12 odz-bg-gray-100 odz-rounded odz-flex odz-items-center odz-justify-center odz-flex-shrink-0"><span class="odz-text-gray-400 odz-text-xs"></span></div>'),kN=ee('<div class="odz-flex odz-items-center odz-gap-3 odz-p-2 odz-bg-base-100 odz-rounded-lg odz-border odz-border-gray-100 hover:odz-bg-gray-50"><!> <div class="odz-flex-1 odz-min-w-0"><h3 class="odz-text-sm odz-font-medium odz-truncate"> </h3> <div class="odz-text-xs odz-text-gray-500"><!></div></div> <button class="odz-btn odz-btn-primary odz-btn-xs odz-flex-shrink-0"></button></div>'),ON=ee('<div class="odz-flex odz-justify-center odz-items-center odz-py-3"><div class="odz-loading odz-loading-spinner odz-loading-sm"></div></div>'),DN=ee('<div class="odz-flex odz-flex-col odz-gap-2"></div> <!>',1),NN=ee('<div class="odz-fixed odz-inset-0 odz-bg-black odz-bg-opacity-50 odz-flex odz-items-center odz-justify-center odz-z-50"><div class="odz-bg-white odz-rounded-lg odz-w-full odz-max-w-2xl odz-mx-4 odz-max-h-[80vh] odz-overflow-hidden odz-flex odz-flex-col"><div class="odz-p-4 odz-border-b odz-flex odz-justify-between odz-items-center"><h2 class="odz-text-lg odz-font-bold"> </h2> <button class="odz-btn odz-btn-ghost odz-btn-sm"><!></button></div> <div class="odz-p-3 odz-border-b odz-space-y-3"><div class="odz-relative"><input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full odz-pl-10 odz-input-sm"> <!></div> <div class="odz-flex odz-items-center odz-gap-1.5 odz-text-xs odz-text-gray-500"><button></button> <!></div> <!></div> <div class="odz-flex-1 odz-overflow-y-auto odz-p-3"><!></div></div></div>');function G1(n,e){Hr(e,!1);const t=Ie();let r=pt(e,"addProduct",8),o=pt(e,"isProductSearchOpen",12),s=pt(e,"productType",8,""),i=pt(e,"excludeNoProcess",8,!1),a=Ie(""),A=Ie([]),d=Ie([]),c=Ie(""),u=Ie([]),h=Ie(!1),f=Ie(null),g,m=!0,y=1;const b=20;let S=Ie();En(async()=>{document.body.style.overflow="hidden",window.scrollTo(0,0),document.querySelectorAll('.odz-modal-box, .odz-overflow-y-auto, [style*="overflow"]').forEach(he=>{he instanceof HTMLElement&&(he.scrollTop=0)});try{_(d,await W_()),await F()}catch(he){console.error("     :",he)}}),Eo(()=>{document.body.style.overflow=""});async function F(){_(h,!0),_(f,null);try{const{products:R,total:he}=await Pf("",void 0,1,b,s(),i());_(A,R),m=l(A).length<he}catch(R){console.error("    :",R),_(f,"    .")}finally{_(h,!1)}}async function k(){if(!(l(h)||!m)){_(h,!0),y++;try{const{products:R,total:he}=await Pf(l(a),l(c),y,b,s(),i());R.length>0?(_(A,[...l(A),...R]),m=l(A).length<he):m=!1}catch(R){console.error("     :",R),_(f,"    .")}finally{_(h,!1)}}}async function P(){if(!l(a).trim()&&!l(c)){await F();return}_(h,!0),_(f,null),y=1,_(A,[]);try{const{products:R,total:he}=await Pf(l(a),l(c),1,b,s(),i());_(A,R),m=l(A).length<he}catch(R){console.error("    :",R),_(f,"    .")}finally{_(h,!1)}}function te(){clearTimeout(g),g=setTimeout(P,300)}function $(R){_(c,R.id),_(u,[...l(u),R]),P()}function j(R){_(u,l(u).slice(0,R+1)),_(c,l(u)[R].id),P()}function J(R){r()(R.id)}function we(){o(!1),_(a,""),_(c,""),_(u,[]),_(A,[]),_(f,null),y=1,m=!0}function D(){if(!l(S))return;const{scrollTop:R,scrollHeight:he,clientHeight:Be}=l(S);he-R<=Be*1.5&&k()}Zt(()=>(l(u),l(d)),()=>{var R;_(t,l(u).length===0?l(d):((R=l(u)[l(u).length-1])==null?void 0:R.children)||[])}),Zn(),qr();var N=NN(),Z=w(N),se=w(Z),ce=z(w(se),2),re=w(ce);ju(re,{class:"odz-w-5 odz-h-5"});var pe=z(se,2),V=w(pe),K=w(V),oe=z(K,2);J_(oe,{class:"odz-absolute odz-left-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-w-4 odz-h-4 odz-text-gray-400"});var ae=z(V,2),x=w(ae),E=z(x,2);Jt(E,1,()=>l(u),ar,(R,he,Be)=>{var be=EN(),Le=gt(be);rE(Le,{class:"odz-w-3 odz-h-3"});var Y=z(Le,2),O=w(Y);He(()=>{Ir(Y,`hover:odz-text-primary odz-transition-colors ${(Be===l(u).length-1?"odz-text-gray-900 odz-font-medium":"")??""}`),Qe(O,l(he).name)}),at("click",Y,()=>j(Be)),T(R,be)});var I=z(ae,2);{var L=R=>{var he=IN();Jt(he,5,()=>l(t),ar,(Be,be)=>{var Le=FN(),Y=w(Le);He(()=>{Ir(Le,`odz-px-3 odz-py-1 odz-text-xs odz-rounded-full odz-transition-all odz-duration-200
                ${(l(c)===l(be).id?"odz-bg-primary odz-text-primary-content odz-shadow-sm":"odz-bg-gray-100 odz-text-gray-600 hover:odz-bg-gray-200 hover:odz-text-gray-800")??""}`),Qe(Y,l(be).name)}),at("click",Le,()=>$(l(be))),T(Be,Le)}),T(R,he)};Se(I,R=>{l(t).length>0&&R(L)})}var M=z(pe,2),H=w(M);{var q=R=>{var he=UN();T(R,he)},G=R=>{var he=Nt(),Be=gt(he);{var be=Y=>{var O=QN(),ve=w(O);He(()=>Qe(ve,l(f))),T(Y,O)},Le=Y=>{var O=Nt(),ve=gt(O);{var xe=le=>{var ze=TN();T(le,ze)},me=le=>{var ze=DN(),ke=gt(ze);Jt(ke,5,()=>l(A),ar,(U,Ae)=>{var fe=kN(),Ce=w(fe);{var ge=Me=>{var je=LN();He(()=>{nr(je,"src",l(Ae).thumbnail),nr(je,"alt",l(Ae).title)}),T(Me,je)},De=Me=>{var je=PN();T(Me,je)};Se(Ce,Me=>{l(Ae).thumbnail?Me(ge):Me(De,!1)})}var Ne=z(Ce,2),Ze=w(Ne),Oe=w(Ze),Ke=z(Ze,2),Je=w(Ke);{var Te=Me=>{var je=Nt(),At=gt(je);{var ut=Re=>{var Xe=Wr();He(tt=>Qe(Xe,`${tt??""}`),[()=>vr(l(Ae).variants[0].prices[0].amount)],it),T(Re,Xe)},ht=Re=>{var Xe=Wr();He(tt=>Qe(Xe,`${tt??""} ~`),[()=>vr(Math.min(...l(Ae).variants.map(tt=>tt.prices[0].amount)))],it),T(Re,Xe)};Se(At,Re=>{l(Ae).variants.length===1?Re(ut):Re(ht,!1)})}T(Me,je)},_e=Me=>{var je=Wr("  ");T(Me,je)};Se(Je,Me=>{l(Ae).variants&&l(Ae).variants.length>0?Me(Te):Me(_e,!1)})}var Ue=z(Ne,2);He(()=>Qe(Oe,l(Ae).title)),at("click",Ue,()=>J(l(Ae))),T(U,fe)});var de=z(ke,2);{var Fe=U=>{var Ae=ON();T(U,Ae)};Se(de,U=>{l(h)&&l(A).length>0&&U(Fe)})}T(le,ze)};Se(ve,le=>{l(A).length===0&&(l(a)||l(c))?le(xe):le(me,!1)},!0)}T(Y,O)};Se(Be,Y=>{l(f)?Y(be):Y(Le,!1)},!0)}T(R,he)};Se(H,R=>{l(h)&&l(A).length===0?R(q):R(G,!1)})}ts(M,R=>_(S,R),()=>l(S)),He(()=>Ir(x,`hover:odz-text-primary odz-transition-colors ${(l(u).length===0?"odz-text-gray-900 odz-font-medium":"")??""}`)),at("click",ce,we),br(K,()=>l(a),R=>_(a,R)),at("input",K,te),at("click",x,()=>{_(u,[]),_(c,""),P()}),at("scroll",M,D),T(n,N),jr()}var MN=ee('<div class="odz-text-sm odz-text-gray-600 odz-mt-1"> </div>'),HN=ee('<div class="odz-flex odz-items-center odz-justify-between odz-p-3 odz-bg-white odz-rounded-lg odz-border odz-border-gray-200"><div class="odz-flex-1"><div class="odz-font-semibold odz-text-gray-800"> </div> <!></div> <div class="odz-text-right"><div class="odz-font-bold odz-text-lg odz-text-gray-800"> </div></div></div>'),jN=ee('<div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border odz-mt-6"><div class="odz-card-body odz-p-3"><h2 class="odz-text-lg odz-font-bold odz-mb-4 odz-flex odz-items-center odz-gap-2"></h2> <div class="odz-space-y-3"></div> <div class="odz-divider odz-my-4"></div> <div class="odz-flex odz-justify-between odz-items-center odz-p-3 odz-bg-white odz-rounded-lg odz-border odz-border-gray-200"><span class="odz-font-bold odz-text-lg odz-text-gray-800"> </span> <span class="odz-font-bold odz-text-xl odz-text-gray-800"> </span></div></div></div>');function RN(n,e){Hr(e,!1);const t=Ie();let r=pt(e,"additionalCosts",24,()=>[]);pt(e,"isEditable",8,!0),Zt(()=>zn(r()),()=>{_(t,r().reduce((a,A)=>a+Number(A.amount),0))}),Zn(),qr();var o=Nt(),s=gt(o);{var i=a=>{var A=jN(),d=w(A),c=z(w(d),2);Jt(c,5,r,g=>g.id,(g,m)=>{var y=HN(),b=w(y),S=w(b),F=w(S),k=z(S,2);{var P=J=>{var we=MN(),D=w(we);He(()=>Qe(D,l(m).description)),T(J,we)};Se(k,J=>{l(m).description&&J(P)})}var te=z(b,2),$=w(te),j=w($);He(J=>{Qe(F,l(m).name),Qe(j,`+${J??""}`)},[()=>vr(Number(l(m).amount))],it),T(g,y)});var u=z(c,4),h=z(w(u),2),f=w(h);He(g=>Qe(f,`+${g??""}`),[()=>vr(l(t))],it),T(a,A)};Se(s,a=>{r().length>0&&a(i)})}T(n,o),jr()}var qN=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-12 odz-bg-gray-50 odz-rounded-lg"><div class="odz-text-6xl odz-mb-4"></div> <h3 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2"> </h3> <p class="odz-text-sm odz-text-gray-600 odz-mb-6">      </p> <button class="odz-btn odz-btn-primary odz-gap-2"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>  </button></div>'),KN=ee("<div><!></div>"),$N=ee("<div><!></div>"),VN=ee("<div></div>"),GN=ee('<div class="odz-mt-5"><div role="tablist" class="odz-tabs odz-tabs-boxed"><button role="tab"></button> <button role="tab"></button></div></div> <!>',1),WN=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-12"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-text-lg odz-font-medium odz-mt-4">   ...</p> <p class="odz-text-sm odz-text-gray-500 odz-mt-2"> ,  ,    .</p></div>'),XN=ee('<button class="odz-btn odz-btn-primary"><!>  </button>'),YN=ee('<div><h2 class="odz-text-2xl odz-font-bold odz-mb-4"> </h2> <!> <div class="odz-flex odz-justify-end odz-mt-4"><!></div> <!></div>'),JN=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-8"><div class="odz-loading odz-loading-spinner odz-loading-md odz-text-primary"></div> <p class="odz-text-base odz-font-medium odz-mt-3">   ...</p></div>'),ZN=ee('<span class="odz-badge odz-badge-warning"> </span>'),eM=ee('<div class="odz-flex odz-items-center odz-gap-2"><span> </span> <!></div>'),tM=ee('<div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="password-input"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input id="password-input" type="password" class="odz-input odz-input-bordered odz-w-full" placeholder="     "> <label class="odz-label" for="password-input"><span class="odz-label-text-alt">     .  !</span></label></div>'),rM=ee(`<div class="odz-flex odz-justify-between odz-items-center odz-mb-4"><h2 class="odz-text-lg odz-font-bold odz-flex odz-items-center odz-gap-1">  <div class="odz-flex odz-items-center odz-gap-1"><!> <span class="odz-text-xs odz-text-gray-500 odz-ml-1">  </span></div></h2> <!></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4"><div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder="   . ) ' 000  '" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder="  " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <div class="odz-flex odz-gap-2"><input type="text" placeholder="010" class="odz-input odz-input-bordered odz-w-1/4" maxlength="3"> <input type="text" placeholder="0000" class="odz-input odz-input-bordered odz-w-1/4" maxlength="4"> <input type="text" placeholder="0000" class="odz-input odz-input-bordered odz-w-1/4" maxlength="4"> <span class="odz-text-xs odz-self-center">   ,     .</span></div></div></div> <div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="address-section"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!>  </span></label> <div class="odz-flex odz-gap-2 odz-mb-2"><input type="text" id="postcode" placeholder="" readonly="" class="odz-input odz-input-bordered odz-w-1/4"> <button class="odz-btn odz-btn-secondary"></button> <button class="odz-btn odz-btn-outline"> </button></div> <input type="text" id="address1" placeholder=" " class="odz-input odz-input-bordered odz-w-full odz-mb-2"> <input type="text" id="address2" placeholder=" " class="odz-input odz-input-bordered odz-w-full"> <p class="odz-text-xs odz-mt-1">       .</p></div> <div class="odz-form-control odz-w-full odz-mt-4"><div class="odz-flex odz-gap-4 odz-items-center"><button class="odz-btn odz-btn-outline odz-flex-1"></button> <p class="odz-text-xs">      .</p></div></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4 odz-mt-4"><div class="odz-form-control odz-w-full"><label class="odz-label" for="shipping-method"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <select id="shipping-method" class="odz-select odz-select-bordered odz-w-full"><option disabled selected>==   ==</option><option></option><option></option><option></option></select></div> <div class="odz-form-control odz-w-full"><label class="odz-label" for="pref-delivery-date"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"></span></label> <input id="pref-delivery-date" type="date" class="odz-input odz-input-bordered odz-w-full"> <label class="odz-label" for="pref-delivery-date-note"><span class="odz-label-text-alt">        .</span></label></div></div> <!> <div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="request-notes"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"> </span></label> <textarea id="request-notes" class="odz-textarea odz-textarea-bordered odz-h-24 odz-w-full" placeholder="   ."></textarea></div> <div class="odz-flex odz-justify-end odz-gap-3 odz-mt-6"><button type="button" class="odz-btn odz-btn-outline odz-btn-secondary"><!>  </button> <button class="odz-btn odz-w-full odz-btn-primary md:odz-w-auto disabled:bg-primary/50 disabled:odz-bg-secondary/20"><!> <!></button></div>`,1),nM=ee('<!> <!> <div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border odz-mt-6"><div class="odz-card-body odz-p-3"><!></div></div>',1),oM=ee('<div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-ml-3 odz-text-lg odz-font-medium">  ...</span></div>'),sM=ee('<div class="odz-text-xs odz-text-gray-400 odz-line-through"> </div> <div class="odz-text-xs odz-text-green-600 odz-font-medium"> </div>',1),iM=ee('<div class="odz-text-xs odz-text-gray-400"> </div>'),aM=ee('<span class="odz-text-gray-400"></span>'),AM=ee('<div class="odz-grid odz-grid-cols-2 md:odz-grid-cols-5 odz-gap-3 md:odz-gap-4 odz-p-4 md:odz-p-6 odz-bg-white"><div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"> </div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400">1  </div></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <!></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"><!></div> <div class="odz-text-xs odz-text-blue-600">   -  </div></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400">    </div></div> <div class="odz-text-center md:odz-col-span-1 odz-col-span-2"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"> </div> <div class="odz-text-3xl md:odz-text-2xl odz-font-bold odz-text-red-600 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400"> <!> <!></div></div></div> <div class="odz-flex odz-gap-4 odz-p-4 odz-bg-gray-50 odz-border-t"><button class="odz-btn odz-btn-outline odz-flex-1 odz-text-gray-600 odz-border-gray-300 hover:odz-bg-gray-100">  </button> <button class="odz-btn odz-btn-error odz-flex-1 odz-text-white odz-bg-red-600 hover:odz-bg-red-700 disabled:odz-bg-gray-400 disabled:odz-text-gray-200"><!></button></div>',1),lM=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><h3 class="odz-text-lg odz-font-bold"> </h3> <div class="odz-space-y-4 odz-py-4"><div><ul class="odz-list-disc odz-ml-5 odz-space-y-2"><li>                     </li> <li>   .       .</li> <li>( :   22 19-15 3)</li></ul></div> <div><table class="odz-table odz-table-zebra odz-w-full"><tbody><tr><td>*Name:</td><td></td></tr><tr><td>*Country:</td><td></td></tr><tr><td>*ZipCode:</td><td></td></tr><tr><td>*Address:</td><td></td></tr><tr><td>*Tel.No.():</td><td></td></tr><tr><td>*E-mail:</td><td></td></tr></tbody></table></div></div> <div class="odz-modal-action"><button class="odz-btn"></button></div></div></dialog>'),dM=ee('<!> <div class="odz-sticky odz-bottom-0 odz-left-0 odz-right-0 odz-mt-6 odz-bg-white odz-border-t odz-shadow-lg"><!></div> <!> <!> <!> <!>',1);function cM(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=()=>Xr(Ls,"$shopStore",t),i=()=>Xr(sl,"$customerStore",t);let a=pt(e,"productId",12),A=pt(e,"isEstimateModal",12),d=pt(e,"estimate",12),c=Ie(null),u=Ie(!1),h=Ie(""),f=Ie(""),g=Ie(0),m=Ie(!1),y=Ie(""),b=Ie(""),S=Ie(""),F=!1,k=Ie(!1),P=Ie(""),te=Ie(""),$=Ie(""),j=Ie(),J=Ie(),we=Ie(),D=Ie(""),N=Ie(!1),Z=Ie(!0),se=Ie([]),ce=Ie(!1);function re(){if(_(g,0),Kt(Et,lt(o).estimateName=d().name||"",lt(o)),Kt(Et,lt(o).organizationName=d().organization_name||"",lt(o)),Kt(Et,lt(o).orderName=d().order_name||"",lt(o)),Kt(Et,lt(o).orderPhone=d().order_phone||"",lt(o)),Kt(Et,lt(o).postcode=d().postcode||"",lt(o)),Kt(Et,lt(o).address1=d().address1||"",lt(o)),Kt(Et,lt(o).address2=d().address2||"",lt(o)),Kt(Et,lt(o).comment=d().comment||"",lt(o)),Kt(Et,lt(o).shippingMethod=d().shipping_method||"",lt(o)),Kt(Et,lt(o).prefDeliveryDate=d().pref_delivery_date||"",lt(o)),Kt(Et,lt(o).estDeliveryDate=d().est_delivery_date||"",lt(o)),Kt(Et,lt(o).uploadMemo=d().upload_memo||"",lt(o)),Kt(Et,lt(o).designUploads=d().design_uploads&&typeof d().design_uploads=="object"&&Array.isArray(d().design_uploads.files)?d().design_uploads.files.map(de=>de.url):[],lt(o)),Kt(Et,lt(o).designConfirm=d().design_confirm||"",lt(o)),o().prefDeliveryDate&&_(D,new Date(o().prefDeliveryDate).toISOString().split("T")[0]),_(y,d().postcode||""),_(b,d().address1||""),_(S,d().address2||""),_(Z,Cd(d().status)),d().order_phone){const de=d().order_phone;de.length>=3&&_(P,de.slice(0,3)),de.length>=7&&_(te,de.slice(3,7)),de.length>=11&&_($,de.slice(7,11))}H(d().id)}function pe(de){a(o().products[de].product.id),Kt(Et,lt(o).index=de,lt(o)),_(g,1)}function V(){var de,Fe;if(_(g,1),(!a()||a().trim()==="")&&(o().products.length>0&&o().index>=0&&((Fe=(de=o().products[o().index])==null?void 0:de.product)!=null&&Fe.id)?(a(o().products[o().index].product.id),console.log("   productId :",a())):console.log(" productId     ")),typeof window<"u"&&a()){const U=`extended-product-data-cache-${a()}`;try{const Ae=window.sessionStorage.getItem(U);if(Ae){const fe=JSON.parse(Ae);fe.printSelection&&!fe.printSelection.isCompleted&&(fe.printSelection.currentMethod="selection",window.sessionStorage.setItem(U,JSON.stringify(fe)),console.log("     "))}}catch(Ae){console.warn("     :",Ae)}}}function K(){if(!o().products||o().products.length===0||o().index<0||!o().products[o().index]){_(u,!0),_(h," "),_(f,"  .");return}if(o().products[o().index].variants.length<1){_(u,!0),_(h," "),_(f,"1   .");return}if(o().products[o().index].variants.some(Fe=>Fe.quantity===0)){_(u,!0),_(h," "),_(f," 1  ");return}_(g,2)}function oe(){_(m,!0)}function ae(){return F?Promise.resolve():new Promise(de=>{const Fe=document.createElement("script");Fe.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",Fe.onload=()=>{F=!0,de()},document.head.appendChild(Fe)})}async function x(){await ae(),new window.daum.Postcode({oncomplete(de){if(_(y,de.zonecode),_(b,de.roadAddress||de.jibunAddress),de.userSelectedType==="R"){let Fe="";de.bname!==""&&/[||]$/g.test(de.bname)&&(Fe+=de.bname),de.buildingName!==""&&de.apartment==="Y"&&(Fe+=Fe!==""?", "+de.buildingName:de.buildingName),Fe!==""&&_(b,l(b)+(" ("+Fe+")"))}}}).open()}function E(){_(k,!0)}function I(de,Fe){const U=de.target;U.value.length>=parseInt(U.getAttribute("maxlength")||"0")&&Fe&&Fe.focus()}function L(de){return de?de.length<4?{valid:!1,message:"  4  ."}:{valid:!0,message:""}:{valid:!1,message:" ."}}async function M(){var de,Fe,U,Ae,fe,Ce,ge,De,Ne,Ze,Oe,Ke,Je,Te,_e,Ue,Me,je,At,ut;try{if(!o().estimateName||!o().organizationName||!o().orderName||!o().orderPhone||!o().shippingMethod){_(u,!0),_(h,"  "),_(f,", ,    .");return}if(!s().customer_id){const Xe=L(o().password);if(!Xe.valid){_(u,!0),_(h," "),_(f,Xe.message);return}}const ht={name:o().estimateName,organization_name:o().organizationName,order_name:o().orderName,order_phone:o().orderPhone,postcode:l(y),address1:l(b),address2:l(S),comment:o().comment,password:s().customer_id?null:o().password,shipping_method:o().shippingMethod,pref_delivery_date:o().prefDeliveryDate,upload_memo:o().uploadMemo,sess:s().sess,customer_id:s().customer_id,mall_type:i().mallType,shop_id:s().id};let Re;if((de=d())!=null&&de.id){Re=await Dd(d().id,ht);const Xe=await xu(d().id);for(const rt of Xe)rt.id&&await Z_(rt.id);const tt=await Nd(d().id);for(const rt of tt)rt.id&&await tB(rt.id);for(let rt=0;rt<o().products.length;rt++)await hB(d().id,rt)}else Re=await s1(ht);if(!Re.id)throw new Error("  .");for(let Xe=0;Xe<o().products.length;Xe++){const tt=o().products[Xe],rt=tt.discountInfo,Bt=rt==null?void 0:rt.discountDetails;for(const nt of tt.variants)if(nt.quantity>0){const ot=nt.prices[0].amount;let xt=ot,Lt=0;const _t=tt.variants.reduce((Ct,Ft)=>Ct+(Ft.quantity||0),0),vt=mi(_t,ot,tt.product.quantity_discounts);vt.hasDiscount&&(xt=vt.discountedPrice,Lt=vt.discountAmount);const Pt=tt.prints&&tt.prints.length>0?"detailed":tt.simplePrints&&tt.simplePrints.length>0?"simple":"none",kt={estimate_id:Re.id,product_id:tt.product.id,variant_id:nt.id,quantity:nt.quantity,idx:Xe,price:xt,original_price:ot,discount_amount:Lt,discount_type:((Fe=vt==null?void 0:vt.discountInfo)==null?void 0:Fe.type)||null,discount_value:((U=vt==null?void 0:vt.discountInfo)==null?void 0:U.value)||null,discount_direction:((Ae=vt==null?void 0:vt.discountInfo)==null?void 0:Ae.direction)||null,discount_min_quantity:((fe=vt==null?void 0:vt.discountInfo)==null?void 0:fe.min_quantity)||null,discount_max_quantity:((Ce=vt==null?void 0:vt.discountInfo)==null?void 0:Ce.max_quantity)||null,print_type:Pt};await i1(kt)}if(tt.prints&&tt.prints.length>0)for(const nt of tt.prints){const ot={estimate_id:Re.id,idx:Xe,template_id:nt.template.id,variant_id:nt.variant_id,price:nt.price||0,colors:nt.colors||null,uploads:nt.uploads||null,name_sheet:nt.nameSheet||null,object_id:nt.objectId||null,original_price:((ge=nt.discountInfo)==null?void 0:ge.originalPrice)||null,discount_amount:((De=nt.discountInfo)==null?void 0:De.discountAmount)||null,discount_type:((Ze=(Ne=nt.discountInfo)==null?void 0:Ne.discountDetails)==null?void 0:Ze.type)||null,discount_value:((Ke=(Oe=nt.discountInfo)==null?void 0:Oe.discountDetails)==null?void 0:Ke.value)||null,discount_direction:((Te=(Je=nt.discountInfo)==null?void 0:Je.discountDetails)==null?void 0:Te.direction)||null,discount_min_quantity:((Ue=(_e=nt.discountInfo)==null?void 0:_e.discountDetails)==null?void 0:Ue.min_quantity)||null,discount_max_quantity:((je=(Me=nt.discountInfo)==null?void 0:Me.discountDetails)==null?void 0:je.max_quantity)||null};await a1(ot)}if(tt.addons)for(const[nt,ot]of Object.entries(tt.addons)){if(!ot.variantId||ot.variantId.trim()===""){console.warn("  variantId    :",ot);continue}let xt=0;if(tt.addonProductsMap&&tt.addonProductsMap[ot.productId]){const vt=tt.addonProductsMap[ot.productId].variants.find(Pt=>Pt.id===ot.variantId);vt&&vt.prices&&vt.prices.length>0&&(xt=vt.prices[0].amount)}const Lt={estimate_id:Re.id,idx:Xe,addon_id:nt,selected_product_id:ot.productId,selected_variant_id:ot.variantId,price:xt,quantity:tt.quantity||0};await c1(Lt)}}console.log(" Estimate    ..."),await h1(Re.id),console.log(" Estimate    "),_(u,!0),_(h,(At=d())!=null&&At.id?"  ":"  "),_(f,(ut=d())!=null&&ut.id?"  .":s().customer_id?"  .":"  .      ."),A(!1),i().mallType==="godo5"&&(window.location.href="/odiz/odiz_list.php")}catch(ht){console.error("    :",ht),_(u,!0),_(h," "),_(f,"    .  .")}}En(()=>{var de,Fe;if(Kt(Et,lt(o).index=o().products.length,lt(o)),(de=d())!=null&&de.id){re();const U=Zp(d().id,Ae=>{d(Ae),_(Z,Cd(Ae.status))});return()=>{U.unsubscribe()}}else a()&&q(a());if(!((Fe=d())!=null&&Fe.id)&&i())if(Kt(Et,lt(o).orderName=i().name,lt(o)),Kt(Et,lt(o).orderPhone=i().phone.replace(/-/g,""),lt(o)),_(b,i().address1),_(S,i().address2),_(y,i().postcode),i().phone){const U=i().phone.replace(/-/g,"");Kt(Et,lt(o).orderPhone=U,lt(o)),U.length>=3&&_(P,U.slice(0,3)),U.length>=7&&_(te,U.slice(3,7)),U.length>=11&&_($,U.slice(7,11))}else Kt(Et,lt(o).orderPhone="",lt(o));ae()});async function H(de){var Fe;_(ce,!0);try{const U=await xu(de),Ae=await Nd(de),fe=await eg(de);_(se,await u1(de));const Ce=[],ge={};for(const _e of U)if(_e.product_id&&_e.product){const Ue=_e.idx||0;if(ge[Ue]||(ge[Ue]={product:_e.product,variants:[],quantity:0,prints:[],addons:{}}),_e.variant_id&&_e.quantity){const Me={id:_e.variant_id,quantity:_e.quantity,prices:[{amount:_e.price||0}],thumbnail:((Fe=_e.variant)==null?void 0:Fe.thumbnail)||null,title:_e.variant_title||` ${_e.variant_id.substring(0,4)}`};ge[Ue].variants.push(Me),ge[Ue].quantity+=_e.quantity}}const De=[];for(const _e of Ae)if(_e.template_id&&_e.estimate_id){const Ue=_e.idx||0;if(ge[Ue]){const Me=(async()=>{try{const je=await Ru(_e.template_id);let At=null;try{At=await Gd(_e.template_id)}catch(Re){console.warn("templateProduct  :",Re)}const ht={template:{id:_e.template_id,name:je.length>0&&je[je.length-1].name||"",templateProduct:At},parentTemplates:je,price:_e.price||0,colors:_e.colors?JSON.parse(_e.colors):[],uploads:_e.uploads?JSON.parse(_e.uploads):null,nameSheet:_e.name_sheet?typeof _e.name_sheet=="string"?JSON.parse(_e.name_sheet):_e.name_sheet:null,title:je.length>0?je[0].name:"",objectId:_e.object_id||null,variant_id:_e.variant_id||null,discountInfo:_e.original_price?{originalPrice:_e.original_price,discountAmount:_e.discount_amount||0,discountDetails:_e.discount_type?{type:_e.discount_type,value:_e.discount_value||0,direction:_e.discount_direction||null,min_quantity:_e.discount_min_quantity||null,max_quantity:_e.discount_max_quantity||null}:void 0,hasDiscount:(_e.discount_amount||0)>0}:void 0};ge[Ue].prints.push(ht)}catch(je){console.error("    :",je);const ut={template:{id:_e.template_id,name:"",templateProduct:null},parentTemplates:[],price:_e.price||0,colors:_e.colors?JSON.parse(_e.colors):[],uploads:_e.uploads?JSON.parse(_e.uploads):null,title:"",objectId:_e.object_id||null,variant_id:_e.variant_id||null,nameSheet:_e.name_sheet?typeof _e.name_sheet=="string"?JSON.parse(_e.name_sheet):_e.name_sheet:null,discountInfo:_e.original_price?{originalPrice:_e.original_price,discountAmount:_e.discount_amount||0,discountDetails:_e.discount_type?{type:_e.discount_type,value:_e.discount_value||0,direction:_e.discount_direction||null,min_quantity:_e.discount_min_quantity||null,max_quantity:_e.discount_max_quantity||null}:void 0,hasDiscount:(_e.discount_amount||0)>0}:void 0};ge[Ue].prints.push(ut)}})();De.push(Me)}}await Promise.all(De),fe.forEach(_e=>{const Ue=_e.idx||0;ge[Ue]?(ge[Ue].addons||(ge[Ue].addons={}),ge[Ue].addons[_e.addon_id]={productId:_e.selected_product_id,variantId:_e.selected_variant_id||""}):console.log(`productGroups[${Ue}]  `)});const Ne=[];for(const _e in ge){const Ue=ge[_e];if(Ue.product&&Object.keys(Ue.addons||{}).length>0){const Me=(async()=>{try{const je=await Hu(Ue.product.id);Ue.addonProductsMap={},je.forEach(At=>{At.items.forEach(ut=>{var ht,Re,Xe;ut.addon_product&&((Xe=(Re=(ht=ut.addon_product.variants)==null?void 0:ht[0])==null?void 0:Re.prices)!=null&&Xe[0])&&(Ue.addonProductsMap[ut.addon_product.id]={price:ut.addon_product.variants[0].prices[0].amount,title:ut.addon_product.title,variants:ut.addon_product.variants})})})}catch(je){console.error(`idx ${_e}    :`,je),Ue.addonProductsMap={}}})();Ne.push(Me)}Ce.push(Ue)}await Promise.all(Ne),F_(Et,{...o(),products:Ce,index:(Ce.length>0,0)});const Ze=Ce.reduce((_e,Ue)=>_e+Ue.quantity,0),Oe=Ce.reduce((_e,Ue)=>_e+(Ue.variants||[]).reduce((Me,je)=>{const At=je.quantity||0;return Me+je.prices[0].amount*At},0),0),Ke=Ce.reduce((_e,Ue)=>_e+(Ue.prints||[]).reduce((Me,je)=>Me+(je.price||0),0),0),Je=Ce.reduce((_e,Ue)=>{if(!Ue.addons||Object.keys(Ue.addons).length===0||!Ue.addonProductsMap)return _e;const Me=Ue.quantity||0,je=Object.values(Ue.addons).reduce((At,ut)=>{const ht=Ue.addonProductsMap[ut.productId];if(ht&&ut.variantId){const Re=ht.variants.find(Xe=>Xe.id===ut.variantId);if(Re&&Re.prices&&Re.prices.length>0){const Xe=Re.prices[0].amount*Me;return At+Xe}}return At},0);return _e+je},0),Te=l(se).reduce((_e,Ue)=>_e+Number(Ue.amount),0);Kt(Et,lt(o).totalQuantity=Ze,lt(o)),Kt(Et,lt(o).totalProductAmount=Oe,lt(o)),Kt(Et,lt(o).totalPrintAmount=Ke,lt(o)),Kt(Et,lt(o).totalAddonAmount=Je,lt(o)),Kt(Et,lt(o).totalAdditionalAmount=Te,lt(o)),Kt(Et,lt(o).totalAmount=Oe+Ke+Je+Te,lt(o)),setTimeout(()=>{Et.updateTotalAmounts()},200)}catch(U){console.error("     :",U),Kt(Et,lt(o).products=[],lt(o))}finally{_(ce,!1)}}function q(de){_(N,!1),a(de),Kt(Et,lt(o).index=o().products.length,lt(o)),_(g,1)}Zt(()=>(l(k),l(m),l(c)),()=>{var de;(l(k)||l(m))&&(_(c,(de=document.getElementById("estimate-modal"))==null?void 0:de.querySelector(".odz-modal-box")),l(c)&&hr(c,l(c).scrollTop=0))}),Zt(()=>(o(),l(P),l(te),l($)),()=>{if(o().orderPhone&&!l(P)&&!l(te)&&!l($)){const de=o().orderPhone;de.length>=3&&_(P,de.slice(0,3)),de.length>=7&&_(te,de.slice(3,7)),de.length>=11&&_($,de.slice(7,11))}}),Zt(()=>(l(P),l(te),l($)),()=>{Kt(Et,lt(o).orderPhone=`${l(P)}${l(te)}${l($)}`,lt(o))}),Zt(()=>(l(u),l(c)),()=>{var de;l(u)&&(_(c,(de=document.getElementById("estimate-modal"))==null?void 0:de.querySelector(".odz-modal-box")),l(c)&&hr(c,l(c).scrollTop=0))}),Zt(()=>l(D),()=>{l(D)&&Kt(Et,lt(o).prefDeliveryDate=new Date(l(D)).toISOString(),lt(o))}),Zn(),qr();var G=dM(),R=gt(G);{var he=de=>{var Fe=GN(),U=gt(Fe),Ae=w(U),fe=w(Ae),Ce=z(fe,2),ge=z(U,2);{var De=Ze=>{var Oe=KN(),Ke=w(Oe);{var Je=_e=>{cF(_e,{get productId(){return a()},get step(){return l(g)},set step(Ue){_(g,Ue)},$$legacy:!0})},Te=_e=>{var Ue=qN(),Me=z(w(Ue),6);at("click",Me,()=>_(N,!0)),T(_e,Ue)};Se(Ke,_e=>{a()&&a().trim()!==""?_e(Je):_e(Te,!1)})}T(Ze,Oe)},Ne=Ze=>{var Oe=Nt(),Ke=gt(Oe);{var Je=_e=>{var Ue=$N(),Me=w(Ue);T5(Me,{get productId(){return a()},get step(){return l(g)},set step(je){_(g,je)},$$legacy:!0}),T(_e,Ue)},Te=_e=>{var Ue=Nt(),Me=gt(Ue);{var je=At=>{var ut=VN();T(At,ut)};Se(Me,At=>{l(g)===3&&At(je)},!0)}T(_e,Ue)};Se(Ke,_e=>{l(g)===2?_e(Je):_e(Te,!1)},!0)}T(Ze,Oe)};Se(ge,Ze=>{l(g)===1?Ze(De):Ze(Ne,!1)})}He(()=>{Ir(fe,`odz-tab ${(l(g)===1?"odz-tab-active":"")??""}`),Ir(Ce,`odz-tab ${(l(g)===2?"odz-tab-active":"")??""}`)}),at("click",fe,V),at("click",Ce,K),T(de,Fe)},Be=de=>{var Fe=nM(),U=gt(Fe);{var Ae=Je=>{var Te=WN();T(Je,Te)},fe=Je=>{var Te=YN(),_e=z(w(Te),2);zB(_e,{onSelectProduct:pe,get isEditable(){return l(Z)},set isEditable(ut){_(Z,ut)},$$legacy:!0});var Ue=z(_e,2),Me=w(Ue);{var je=ut=>{var ht=XN(),Re=w(ht);bu(Re,{class:"odz-w-5 odz-h-5 odz-mr-2"}),at("click",ht,()=>_(N,!0)),T(ut,ht)};Se(Me,ut=>{l(Z)&&ut(je)})}var At=z(Ue,2);RN(At,{get additionalCosts(){return l(se)},get isEditable(){return l(Z)}}),T(Je,Te)};Se(U,Je=>{l(ce)?Je(Ae):Je(fe,!1)})}var Ce=z(U,2);{var ge=Je=>{G1(Je,{addProduct:q,productType:"godo",get isProductSearchOpen(){return l(N)},set isProductSearchOpen(Te){_(N,Te)},$$legacy:!0})};Se(Ce,Je=>{l(N)&&Je(ge)})}var De=z(Ce,2),Ne=w(De),Ze=w(Ne);{var Oe=Je=>{var Te=JN();T(Je,Te)},Ke=Je=>{var Te=rM(),_e=gt(Te),Ue=w(_e),Me=z(w(Ue)),je=w(Me);Ga(je,{class:"odz-text-error",size:10});var At=z(Ue,2);{var ut=or=>{var on=eM(),Qo=w(on),Os=w(Qo),Ei=z(Qo,2);{var Qn=ei=>{var Ta=ZN();T(ei,Ta)};Se(Ei,ei=>{l(Z)||ei(Qn)})}He(()=>{Ir(Qo,`odz-badge odz-badge-${(d().status==="pending"?"warning":d().status==="progress"?"info":d().status==="completed"?"success":"error")??""}`),Qe(Os,d().status==="pending"?"":d().status==="progress"?"":d().status==="completed"?"":"")}),T(or,on)};Se(At,or=>{var on;(on=d())!=null&&on.id&&or(ut)})}var ht=z(_e,2),Re=w(ht),Xe=w(Re),tt=w(Xe),rt=w(tt);Ga(rt,{class:"odz-text-error",size:12});var Bt=z(Xe,2),nt=z(Re,2),ot=w(nt),xt=w(ot),Lt=w(xt);Ga(Lt,{class:"odz-text-error",size:12});var _t=z(ot,2),vt=z(nt,2),Pt=w(vt),kt=w(Pt),Ct=w(kt);Ga(Ct,{class:"odz-text-error",size:12});var Ft=z(Pt,2),zt=z(vt,2),Tt=w(zt),Rt=w(Tt),Dt=w(Rt);Ga(Dt,{class:"odz-text-error",size:12});var Mt=z(Tt,2),Gt=w(Mt);ts(Gt,or=>_(j,or),()=>l(j));var lr=z(Gt,2);ts(lr,or=>_(J,or),()=>l(J));var tr=z(lr,2);ts(tr,or=>_(we,or),()=>l(we));var sr=z(ht,2),Ht=w(sr),mr=w(Ht),kr=w(mr);Ga(kr,{class:"odz-text-error",size:12});var Kr=z(Ht,2),Sr=w(Kr),fr=z(Sr,2),Lr=z(fr,2),xr=z(Kr,2),Ar=z(xr,2),pr=z(sr,4),Pr=w(pr),gn=w(Pr),vn=w(gn),zr=w(vn);Ga(zr,{class:"odz-text-error",size:12});var dr=z(gn,2);He(()=>{o(),ip(()=>{l(Z)})});var xn=w(dr);xn.value=((xn.__value="")==null,"");var Fo=z(xn);Fo.value=(Fo.__value="delivery")==null?"":"delivery";var io=z(Fo);io.value=(io.__value="pickup")==null?"":"pickup";var bo=z(io);bo.value=(bo.__value="quick")==null?"":"quick";var ns=z(Pr,2),On=z(w(ns),2),Io=z(pr,2);{var Wt=or=>{var on=tM(),Qo=w(on),Os=w(Qo),Ei=w(Os);Ga(Ei,{class:"odz-text-error",size:12});var Qn=z(Qo,2);He(()=>Qn.readOnly=!l(Z)),br(Qn,()=>o().password,ei=>Kt(Et,lt(o).password=ei,lt(o))),T(or,on)};Se(Io,or=>{s().customer_id||or(Wt)})}var $r=z(Io,2),Fn=z(w($r),2),ys=z($r,2),Uo=w(ys),bs=w(Uo);vw(bs,{class:"odz-w-5 odz-h-5 odz-mr-2"});var eo=z(Uo,2),ks=w(eo);vw(ks,{class:"odz-w-5 odz-h-5 odz-mr-2"});var Ci=z(ks,2);{var Si=or=>{var on=Wr(" ");T(or,on)},EA=or=>{var on=Wr(" ");T(or,on)};Se(Ci,or=>{var on;(on=d())!=null&&on.id?or(Si):or(EA,!1)})}He(or=>{Bt.readOnly=!l(Z),_t.readOnly=!l(Z),Ft.readOnly=!l(Z),Gt.readOnly=!l(Z),lr.readOnly=!l(Z),tr.readOnly=!l(Z),xr.readOnly=!l(Z),Ar.readOnly=!l(Z),dr.disabled=!l(Z),On.disabled=!l(Z),nr(On,"min",or),Fn.readOnly=!l(Z),eo.disabled=!l(Z)},[()=>new Date().toISOString().split("T")[0]],it),br(Bt,()=>o().estimateName,or=>Kt(Et,lt(o).estimateName=or,lt(o))),br(_t,()=>o().organizationName,or=>Kt(Et,lt(o).organizationName=or,lt(o))),br(Ft,()=>o().orderName,or=>Kt(Et,lt(o).orderName=or,lt(o))),br(Gt,()=>l(P),or=>_(P,or)),at("input",Gt,or=>I(or,l(J))),br(lr,()=>l(te),or=>_(te,or)),at("input",lr,or=>I(or,l(we))),br(tr,()=>l($),or=>_($,or)),at("input",tr,or=>I(or)),br(Sr,()=>l(y),or=>_(y,or)),at("click",fr,x),at("click",Lr,E),br(xr,()=>l(b),or=>_(b,or)),br(Ar,()=>l(S),or=>_(S,or)),ap(dr,()=>o().shippingMethod,or=>Kt(Et,lt(o).shippingMethod=or,lt(o))),br(On,()=>l(D),or=>_(D,or)),br(Fn,()=>o().comment,or=>Kt(Et,lt(o).comment=or,lt(o))),at("click",Uo,oe),at("click",eo,M),T(Je,Te)};Se(Ze,Je=>{l(ce)?Je(Oe):Je(Ke,!1)})}T(de,Fe)};Se(R,de=>{l(g)>0?de(he):de(Be,!1)})}var be=z(R,2),Le=w(be);{var Y=de=>{var Fe=oM();T(de,Fe)},O=de=>{var Fe=AM(),U=gt(Fe),Ae=w(U),fe=z(w(Ae),2),Ce=w(fe),ge=z(Ae,2),De=z(w(ge),2),Ne=w(De),Ze=z(De,2);{var Oe=Ft=>{var zt=sM();const Tt=it(()=>o().products.reduce((tr,sr)=>{var Ht;return tr+(((Ht=sr.discountInfo)==null?void 0:Ht.originalAmount)||0)},0)),Rt=it(()=>o().products.reduce((tr,sr)=>{var Ht;return tr+(((Ht=sr.discountInfo)==null?void 0:Ht.discountAmount)||0)},0));var Dt=gt(zt),Mt=w(Dt),Gt=z(Dt,2),lr=w(Gt);He((tr,sr)=>{Qe(Mt,`${tr??""}`),Qe(lr,`-${sr??""} `)},[()=>vr(l(Tt)),()=>vr(l(Rt))],it),T(Ft,zt)},Ke=Ft=>{var zt=iM();T(Ft,zt)};Se(Ze,Ft=>{o().products.some(zt=>{var Tt;return(Tt=zt.discountInfo)==null?void 0:Tt.hasDiscount})?Ft(Oe):Ft(Ke,!1)})}var Je=z(ge,2),Te=z(w(Je),2),_e=w(Te);{var Ue=Ft=>{var zt=aM();T(Ft,zt)},Me=Ft=>{var zt=Wr();He(Tt=>Qe(zt,`${Tt??""}`),[()=>vr(o().totalPrintAmount)],it),T(Ft,zt)};Se(_e,Ft=>{o().totalPrintAmount===0?Ft(Ue):Ft(Me,!1)})}var je=z(Je,2),At=z(w(je),2),ut=w(At),ht=z(je,2),Re=z(w(ht),2),Xe=w(Re),tt=z(Re,2),rt=w(tt),Bt=z(rt);{var nt=Ft=>{var zt=Wr("+ ( )");T(Ft,zt)};Se(Bt,Ft=>{o().totalPrintAmount>0&&Ft(nt)})}var ot=z(Bt,2);{var xt=Ft=>{var zt=Wr();He(Tt=>Qe(zt,`+ ${Tt??""}`),[()=>vr(o().totalAdditionalAmount)],it),T(Ft,zt)};Se(ot,Ft=>{o().totalAdditionalAmount>0&&Ft(xt)})}var Lt=z(U,2),_t=w(Lt),vt=z(_t,2),Pt=w(vt);{var kt=Ft=>{var zt=Wr("  ");T(Ft,zt)},Ct=Ft=>{var zt=Wr("  ");T(Ft,zt)};Se(Pt,Ft=>{var zt;(zt=d())!=null&&zt.id?Ft(kt):Ft(Ct,!1)})}He((Ft,zt,Tt)=>{Qe(Ce,`${o().totalQuantity||0}`),Qe(Ne,`${Ft??""}`),Qe(ut,`${zt??""}`),Qe(Xe,`${Tt??""}`),Qe(rt,` ${Ft??""} + 
          ${zt??""} `),vt.disabled=!l(Z)},[()=>vr(o().totalProductAmount),()=>vr(o().totalAddonAmount),()=>vr(o().totalAmount)],it),at("click",_t,()=>_(g,Math.max(0,l(g)-1))),at("click",vt,M),T(de,Fe)};Se(Le,de=>{l(ce)?de(Y):de(O,!1)})}var ve=z(be,2);{var xe=de=>{var Fe=lM(),U=w(Fe),Ae=z(w(U),4),fe=w(Ae);at("click",fe,()=>_(k,!1)),T(de,Fe)};Se(ve,de=>{l(k)&&de(xe)})}var me=z(ve,2);{var le=de=>{SN(de,{get isOpen(){return l(m)},set isOpen(Fe){_(m,Fe)},$$legacy:!0})};Se(me,de=>{l(m)&&de(le)})}var ze=z(me,2);Wd(ze,{get isOpen(){return l(u)},set isOpen(de){_(u,de)},get title(){return l(h)},set title(de){_(h,de)},get message(){return l(f)},set message(de){_(f,de)},$$legacy:!0});var ke=z(ze,2);Xd(ke,{get isLoading(){return l(ce)},set isLoading(de){_(ce,de)},$$legacy:!0}),T(n,G),jr(),r()}var uM=ee('<div class="odz-alert odz-alert-error"> </div>'),hM=ee('<div class="odz-mb-4"><!></div>'),fM=ee('<div class="odz-border odz-rounded odz-p-2 odz-text-center"><img class="odz-max-w-full odz-mx-auto odz-mb-2 odz-object-contain"></div>'),pM=ee('<div><h4 class="odz-font-semibold odz-mb-2"> </h4> <div class="odz-flex odz-flex-col odz-justify-center"></div></div>'),gM=ee('<p class="odz-text-base odz-font-semibold odz-mb-3"> </p>'),vM=ee('<div class="odz-border odz-rounded-lg odz-p-2 odz-w-full sm:odz-w-48 md:odz-w-56 odz-flex odz-items-center odz-gap-3"><img class="odz-w-12 odz-h-12 odz-object-cover odz-rounded odz-flex-shrink-0"> <div class="odz-flex-grow odz-min-w-0"><p class="odz-text-xs odz-font-medium odz-truncate"> </p> <p class="odz-text-xs odz-text-gray-500"> </p></div></div>'),mM=ee('<div class="odz-mb-4"><!> <div class="odz-flex odz-flex-wrap odz-gap-3"></div></div>'),wM=ee('<div class="odz-border odz-rounded odz-p-2 odz-text-center"><img class="odz-max-w-full odz-mx-auto odz-mb-2 odz-object-contain"></div>'),yM=ee('<div class="odz-flex odz-flex-col odz-justify-center"></div>'),bM=ee('<p class="odz-text-xs odz-text-gray-500">     .</p>'),_M=ee('<div class="odz-mb-2"><h6 class="odz-font-medium odz-text-sm odz-mb-2"> </h6> <!></div>'),BM=ee('<div class="odz-mb-6 odz-p-4 odz-border odz-rounded-lg"><h5 class="odz-font-medium odz-text-base odz-mb-3"> </h5> <!> <!></div>'),xM=ee("<div></div>"),zM=ee('<p class="odz-text-center odz-text-gray-500 odz-py-4">   .</p>'),CM=ee('<div class="odz-mt-4"><!></div>'),SM=ee('<div class="odz-chat odz-chat-end"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1">[]</div> <div class="odz-chat-bubble odz-text-sm odz-chat-bubble-success odz-chat-bubble-outline"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),EM=ee('<div class="odz-chat odz-chat-end"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1"></div> <div class="odz-chat-bubble odz-chat-bubble-secondary odz-chat-bubble-outline"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),FM=ee('<div class="odz-chat odz-chat-start"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1"> </div> <div class="odz-chat-bubble odz-chat-bubble-gray"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),IM=ee('<p class="odz-text-center odz-text-sm odz-text-gray-500">  .</p>'),UM=ee('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),QM=ee('<div role="alert" class="odz-alert odz-alert-warning"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span> :    .</span></div>'),TM=ee('<div role="alert" class="odz-alert odz-alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),LM=ee('<div role="alert" class="odz-alert odz-alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),PM=ee('<div role="alert" class="odz-alert odz-alert-secondary"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),kM=ee('<div role="alert" class="odz-alert odz-alert-success odz-alert-outline"><span> :   .</span></div>'),OM=ee('<button class="odz-btn odz-btn-success"> </button> <button class="odz-btn odz-btn-error"> </button>',1),DM=ee('<div class="odz-space-y-6"><!> <!> <!> <!></div> <div class="odz-divider odz-my-6"></div> <div class="odz-space-y-4"><div class="odz-max-h-60 odz-overflow-y-auto odz-p-2 odz-bg-base-200 odz-rounded-lg odz-space-y-3"></div> <div class="odz-flex odz-gap-2 odz-items-center"><input type="text" placeholder=" ..." class="odz-input odz-input-bordered odz-flex-grow"> <button class="odz-btn odz-btn-primary"><!> </button></div></div> <div class="odz-mt-6"><!></div> <div class="odz-modal-action odz-mt-6"><button class="odz-btn"></button> <!></div>',1),NM=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button> <h3 class="odz-font-bold odz-text-lg odz-mb-4"> </h3> <!></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),MM=ee('<div class="odz-flex odz-gap-4"><label class="odz-label odz-cursor-pointer odz-gap-1"><span class="odz-label-text odz-text-xs odz-whitespace-nowrap"></span> <input type="radio" class="odz-radio odz-radio-sm"></label> <label class="odz-label odz-cursor-pointer odz-gap-1"><span class="odz-label-text odz-text-xs odz-whitespace-nowrap"></span> <input type="radio" class="odz-radio odz-radio-sm"></label></div>'),HM=ee('<input type="checkbox" class="odz-checkbox odz-checkbox-sm">'),jM=ee('<div class="odz-form-control"><label class="odz-label odz-cursor-pointer odz-gap-4"><span class="odz-label-text odz-text-xs"> </span> <!></label></div>'),RM=ee('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>   ...',1),qM=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><h3 class="odz-font-bold odz-text-lg">    </h3> <p class="odz-py-4 odz-text-sm">       .</p> <div class="odz-form-control odz-mb-4"><label class="odz-label odz-cursor-pointer"><span class="odz-label-text odz-font-semibold"> .</span> <input type="checkbox" class="odz-checkbox odz-checkbox-primary"></label></div> <div class="odz-space-y-2 odz-border-t odz-border-b odz-py-4 odz-max-h-60 odz-overflow-y-auto"></div> <div class="odz-modal-action odz-mt-6"><button class="odz-btn"></button> <button class="odz-btn odz-btn-primary"><!></button></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),KM=ee('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>  ...',1),$M=ee('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box"><h3 class="odz-font-bold odz-text-lg odz-mb-4">   </h3> <textarea class="odz-textarea odz-textarea-bordered odz-w-full odz-h-32" placeholder="   ..."></textarea> <div class="odz-modal-action odz-mt-4"><button class="odz-btn"></button> <button class="odz-btn odz-btn-error"><!></button></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),VM=ee("<!> <!> <!> <!>",1);function GM(n,e){Hr(e,!1);let t=pt(e,"estimateId",8),r=pt(e,"isOpen",12),o=Ie(null),s=Ie(!0),i=Ie(null),a=Ie({}),A=Ie([]),d=Ie(""),c=Ie(""),u=null,h=null,f=null,g=Ie(!1),m=Ie(""),y=Ie(""),b=Ie([]),S=Ie(""),F=Ie(!1),k=Ie(),P=Ie(!1),te=Ie(""),$=Ie(!1),j=Ie(!1),J=Ie([!1,!1,!1,!1,!1,!1,!1]),we=Ie(!1),D=Ie(!1);const N=["     .","          .","    .","    ,    ?","           .","   , ,       .","    ? ( ,  3 )"];function Z(Y){if(!Y)return null;try{return typeof Y=="object"&&Y!==null?Y:JSON.parse(Y)}catch(O){return console.error("Failed to parse JSON:",O,"Input:",Y),null}}async function se(){await Oi(),l(k)&&hr(k,l(k).scrollTop=l(k).scrollHeight)}function ce(){var O;if(!l(o))return;if((O=l(o).estimate)!=null&&O.design_uploads){const ve=typeof l(o).estimate.design_uploads=="string"?Z(l(o).estimate.design_uploads):l(o).estimate.design_uploads;ve&&Array.isArray(ve.files)?_(A,ve.files.map(xe=>({url:xe.url,name:xe.name}))):_(A,[]),_(d,(ve==null?void 0:ve.topHTML)||""),_(c,(ve==null?void 0:ve.bottomHTML)||"")}else _(A,[]),_(d,""),_(c,"");const Y={};l(o).items.length>0&&(l(o).items.forEach(ve=>{const xe=ve.idx??0;Y[xe]||(Y[xe]={items:[],prints:[]}),Y[xe].items.push(ve)}),l(o).prints.forEach(ve=>{const xe=ve.idx??0;Y[xe]||(console.warn(`Print found for idx ${xe} but no corresponding item group exists.`),Y[xe]={items:[],prints:[]});const me=typeof ve.design_uploads=="string"?Z(ve.design_uploads):ve.design_uploads;ve.parsed_uploads=(me==null?void 0:me.files)||[],Y[xe].prints.find(ze=>ze.id===ve.id)||Y[xe].prints.push(ve)})),_(a,Y),console.log("Processed and grouped data:",l(a)),Object.entries(l(a)).forEach(([ve,xe])=>{console.log(`idx ${ve}: ${xe.prints.length} print(s)`,xe.prints.map(me=>{var le;return{id:me.id,parsed_uploads_count:(le=me.parsed_uploads)==null?void 0:le.length}}))})}En(async()=>{if(!t()){_(i," ID  ."),_(s,!1);return}_(s,!0),_(i,null);try{const[Y,O]=await Promise.all([A1(t()),oB(t())]);_(o,Y),_(b,O),console.log("Fetched initial details in component:",l(o)),console.log("Fetched initial comments in component:",l(b)),ce(),u=Zp(t(),ve=>{console.log("Received estimate update:",ve),l(o)&&(hr(o,l(o).estimate={...l(o).estimate,...ve}),ce())}),console.log("Subscribed to estimate changes:",u),h=l1(t(),ve=>{console.log("Received comment update payload:",ve),ve.eventType==="INSERT"&&ve.new?_(b,[...l(b),ve.new]):ve.eventType==="DELETE"&&ve.old?_(b,l(b).filter(xe=>xe.id!==ve.old.id)):ve.eventType==="UPDATE"&&ve.new&&_(b,l(b).map(xe=>{var me;return xe.id===((me=ve.new)==null?void 0:me.id)?{...xe,...ve.new}:xe})),se()}),console.log("Subscribed to comment changes:",h),f=d1(t(),ve=>{if(console.log("Received print update payload:",ve),l(o)){let xe=!1;if(ve.eventType==="INSERT"&&ve.new)hr(o,l(o).prints=[...l(o).prints,ve.new]),xe=!0;else if(ve.eventType==="DELETE"&&ve.old){const me=l(o).prints.length;hr(o,l(o).prints=l(o).prints.filter(le=>le.id!==ve.old.id)),l(o).prints.length<me&&(xe=!0)}else if(ve.eventType==="UPDATE"&&ve.new){const me=l(o).prints.findIndex(le=>{var ze;return le.id===((ze=ve.new)==null?void 0:ze.id)});me!==-1&&(hr(o,l(o).prints[me]={...l(o).prints[me],...ve.new}),xe=!0)}xe&&(ce(),console.log("Prints array updated, re-processed data"))}}),console.log("Subscribed to print changes:",f),se()}catch(Y){console.error("Error loading initial data or subscribing:",Y),_(i,"        .")}finally{_(s,!1)}}),Eo(()=>{u&&(console.log("Unsubscribing from estimate changes"),u.unsubscribe()),h&&(console.log("Unsubscribing from comment changes"),h.unsubscribe()),f&&(console.log("Unsubscribing from print changes"),f.unsubscribe())});function re(){r(!1)}function pe(){_(J,Array(N.length).fill(!1)),_(we,!1),_(j,!0)}function V(){_(j,!1)}function K(){for(let Y=0;Y<N.length-1;Y++)hr(J,l(J)[Y]=l(we));_(J,[...l(J)]),console.log({confirmationChecks:l(J)})}function oe(Y,O){hr(J,l(J)[Y]=O),Y<N.length-1&&_(we,l(J).slice(0,-1).every(ve=>ve===!0)),_(J,[...l(J)])}function ae(){_(te,""),_(P,!0)}function x(){_(P,!1)}async function E(){var xe,me;if(!l(te).trim()){_(m," "),_(y,"   ."),_(g,!0);return}if(!((me=(xe=l(o))==null?void 0:xe.estimate)!=null&&me.id))return;const Y=l(o).estimate.id;_($,!0);let O=null,ve=null;try{try{await Of({estimate_id:Y,comment:`[] ${l(te)}`,system:!1,writer:"customer"}),console.log("Rejection comment added successfully.")}catch(le){throw O=le,console.error("Error adding rejection comment:",O),new Error("     .")}try{await Dd(Y,{design_confirm:"processing"}),console.log("Estimate status updated to processing.")}catch(le){throw ve=le,console.error("Error updating estimate status after rejection:",ve),new Error("    .")}x(),re()}catch(le){console.error("Error during rejection process:",le),_(m,""),_(y,le.message||"     ."),_(g,!0)}finally{_($,!1)}}async function I(){var me,le;if(!((le=(me=l(o))==null?void 0:me.estimate)!=null&&le.id))return;const Y=l(o).estimate.id,O=l(J)[N.length-1];_(D,!0);let ve=null,xe=null;try{await Dd(Y,{design_confirm:"completed",use_reorder:O,...l(o).estimate.auto_complete_on_approval?{status:"completed"}:{}}),console.log(`Estimate status updated to completed with use_reorder: ${O}.`);try{await Of({estimate_id:Y,comment:"",system:!0,writer:"customer"}),console.log("System comment added successfully with writer as customer.")}catch(ze){xe=ze,console.error("Error adding system comment after approval:",xe)}}catch(ze){ve=ze,console.error("Error approving design:",ve)}finally{_(D,!1),ve?(_(m,""),_(y,"      ."),_(g,!0)):xe?(_(m,""),_(y," ,      ."),_(g,!0)):(V(),re())}}async function L(){var Y,O;if(!(!l(S).trim()||!((O=(Y=l(o))==null?void 0:Y.estimate)!=null&&O.id))){_(F,!0);try{await Of({estimate_id:l(o).estimate.id,comment:l(S),system:!1,writer:"customer"}),_(S,"")}catch(ve){console.error("Error sending comment:",ve),_(m,""),_(y,"    ."),_(g,!0)}finally{_(F,!1)}}}function M(Y){if(!Y)return"";try{return new Date(Y).toLocaleString("ko-KR",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Y}}qr();var H=VM(),q=gt(H);{var G=Y=>{var O=NM(),ve=w(O),xe=w(ve),me=z(xe,2),le=w(me),ze=z(me,2);{var ke=Ae=>{Xd(Ae,{get isLoading(){return l(s)},set isLoading(fe){_(s,fe)},$$legacy:!0})},de=Ae=>{var fe=Nt(),Ce=gt(fe);{var ge=Ne=>{var Ze=uM(),Oe=w(Ze);He(()=>Qe(Oe,l(i))),T(Ne,Ze)},De=Ne=>{var Ze=Nt(),Oe=gt(Ze);{var Ke=Je=>{var Te=DM(),_e=gt(Te),Ue=w(_e);{var Me=Dt=>{var Mt=hM(),Gt=w(Mt);g0(Gt,()=>l(d),!1,!1),T(Dt,Mt)};Se(Ue,Dt=>{l(d)&&Dt(Me)})}var je=z(Ue,2);{var At=Dt=>{var Mt=pM(),Gt=z(w(Mt),2);Jt(Gt,5,()=>l(A),ar,(lr,tr)=>{var sr=fM(),Ht=w(sr);He(()=>{nr(Ht,"src",l(tr).url),nr(Ht,"alt",l(tr).name)}),T(lr,sr)}),T(Dt,Mt)};Se(je,Dt=>{l(A).length>0&&Dt(At)})}var ut=z(je,2);{var ht=Dt=>{var Mt=xM();Jt(Mt,5,()=>Object.entries(l(a)),ar,(Gt,lr)=>{let tr=()=>l(lr)[0],sr=()=>l(lr)[1];var Ht=BM(),mr=w(Ht),kr=w(mr),Kr=z(mr,2);{var Sr=xr=>{var Ar=mM(),pr=w(Ar);{var Pr=vn=>{var zr=gM(),dr=w(zr);He(()=>Qe(dr,sr().items[0].product.title)),T(vn,zr)};Se(pr,vn=>{var zr;(zr=sr().items[0].product)!=null&&zr.title&&vn(Pr)})}var gn=z(pr,2);Jt(gn,5,()=>sr().items,ar,(vn,zr)=>{var dr=vM(),xn=w(dr),Fo=z(xn,2),io=w(Fo),bo=w(io),ns=z(io,2),On=w(ns);He(()=>{var Io,Wt,$r;nr(xn,"src",((Io=l(zr).variant)==null?void 0:Io.thumbnail)||l(zr).thumbnail||"/placeholder.png"),nr(xn,"alt",l(zr).variant_title||((Wt=l(zr).variant)==null?void 0:Wt.title)),Qe(bo,l(zr).variant_title||(($r=l(zr).variant)==null?void 0:$r.title)||"  "),Qe(On,`${l(zr).quantity??""}`)}),T(vn,dr)}),T(xr,Ar)};Se(Kr,xr=>{sr().items.length>0&&xr(Sr)})}var fr=z(Kr,2);{var Lr=xr=>{var Ar=_M();const pr=it(()=>sr().prints[0]),Pr=it(()=>{var dr;return((dr=l(pr))==null?void 0:dr.parsed_uploads)||[]});var gn=z(w(Ar),2);{var vn=dr=>{var xn=yM();Jt(xn,5,()=>l(Pr),ar,(Fo,io)=>{var bo=wM(),ns=w(bo);He(()=>{nr(ns,"src",l(io).url),nr(ns,"alt",l(io).name)}),T(Fo,bo)}),T(dr,xn)},zr=dr=>{var xn=bM();T(dr,xn)};Se(gn,dr=>{l(Pr).length>0?dr(vn):dr(zr,!1)})}T(xr,Ar)};Se(fr,xr=>{sr().prints.length>0&&xr(Lr)})}He(xr=>{nr(Ht,"data-idx",tr()),Qe(kr,` ${xr??""}`)},[()=>Number(tr())+1],it),T(Gt,Ht)}),T(Dt,Mt)},Re=Dt=>{var Mt=Nt(),Gt=gt(Mt);{var lr=tr=>{var sr=zM();T(tr,sr)};Se(Gt,tr=>{l(A).length===0&&tr(lr)},!0)}T(Dt,Mt)};Se(ut,Dt=>{Object.keys(l(a)).length>0?Dt(ht):Dt(Re,!1)})}var Xe=z(ut,2);{var tt=Dt=>{var Mt=CM(),Gt=w(Mt);g0(Gt,()=>l(c),!1,!1),T(Dt,Mt)};Se(Xe,Dt=>{l(c)&&Dt(tt)})}var rt=z(_e,4),Bt=w(rt);Jt(Bt,5,()=>l(b),Dt=>Dt.id,(Dt,Mt)=>{var Gt=Nt(),lr=gt(Gt);{var tr=Ht=>{var mr=SM(),kr=z(w(mr),2),Kr=w(kr),Sr=z(Kr),fr=w(Sr);He(Lr=>{Qe(Kr,`${l(Mt).comment??""} `),Qe(fr,Lr)},[()=>M(l(Mt).created_at)],it),T(Ht,mr)},sr=Ht=>{var mr=Nt(),kr=gt(mr);{var Kr=fr=>{var Lr=EM(),xr=z(w(Lr),2),Ar=w(xr),pr=z(Ar),Pr=w(pr);He(gn=>{Qe(Ar,`${l(Mt).comment??""} `),Qe(Pr,gn)},[()=>M(l(Mt).created_at)],it),T(fr,Lr)},Sr=fr=>{var Lr=FM(),xr=w(Lr),Ar=w(xr),pr=z(xr,2),Pr=w(pr),gn=z(Pr),vn=w(gn);He(zr=>{Qe(Ar,l(Mt).writer||""),Qe(Pr,`${l(Mt).comment??""} `),Qe(vn,zr)},[()=>M(l(Mt).created_at)],it),T(fr,Lr)};Se(kr,fr=>{l(Mt).writer==="customer"?fr(Kr):fr(Sr,!1)},!0)}T(Ht,mr)};Se(lr,Ht=>{l(Mt).system?Ht(tr):Ht(sr,!1)})}T(Dt,Gt)},Dt=>{var Mt=IM();T(Dt,Mt)}),ts(Bt,Dt=>_(k,Dt),()=>l(k));var nt=z(Bt,2),ot=w(nt),xt=z(ot,2),Lt=w(xt);{var _t=Dt=>{var Mt=UM();T(Dt,Mt)};Se(Lt,Dt=>{l(F)&&Dt(_t)})}var vt=z(rt,2),Pt=w(vt);{var kt=Dt=>{var Mt=QM();T(Dt,Mt)},Ct=Dt=>{var Mt=Nt(),Gt=gt(Mt);{var lr=sr=>{var Ht=TM();T(sr,Ht)},tr=sr=>{var Ht=Nt(),mr=gt(Ht);{var kr=Sr=>{var fr=LM();T(Sr,fr)},Kr=Sr=>{var fr=Nt(),Lr=gt(fr);{var xr=pr=>{var Pr=PM();T(pr,Pr)},Ar=pr=>{var Pr=Nt(),gn=gt(Pr);{var vn=zr=>{var dr=kM();T(zr,dr)};Se(gn,zr=>{var dr,xn;((xn=(dr=l(o))==null?void 0:dr.estimate)==null?void 0:xn.design_confirm)==="completed"&&zr(vn)},!0)}T(pr,Pr)};Se(Lr,pr=>{var Pr,gn;((gn=(Pr=l(o))==null?void 0:Pr.estimate)==null?void 0:gn.design_confirm)==="confirming"?pr(xr):pr(Ar,!1)},!0)}T(Sr,fr)};Se(mr,Sr=>{var fr,Lr;((Lr=(fr=l(o))==null?void 0:fr.estimate)==null?void 0:Lr.design_confirm)==="processing"?Sr(kr):Sr(Kr,!1)},!0)}T(sr,Ht)};Se(Gt,sr=>{var Ht,mr;((mr=(Ht=l(o))==null?void 0:Ht.estimate)==null?void 0:mr.design_confirm)==="waiting"?sr(lr):sr(tr,!1)},!0)}T(Dt,Mt)};Se(Pt,Dt=>{var Mt,Gt;((Gt=(Mt=l(o))==null?void 0:Mt.estimate)==null?void 0:Gt.design_confirm)==="none"?Dt(kt):Dt(Ct,!1)})}var Ft=z(vt,2),zt=w(Ft),Tt=z(zt,2);{var Rt=Dt=>{var Mt=OM(),Gt=gt(Mt),lr=z(Gt,2);He(()=>{Gt.disabled=l(D),lr.disabled=l(D)}),at("click",Gt,pe),at("click",lr,ae),T(Dt,Mt)};Se(Tt,Dt=>{var Mt,Gt;((Gt=(Mt=l(o))==null?void 0:Mt.estimate)==null?void 0:Gt.design_confirm)==="confirming"&&Dt(Rt)})}He(Dt=>{ot.disabled=l(F),xt.disabled=Dt,zt.disabled=l(D)},[()=>l(F)||!l(S).trim()],it),br(ot,()=>l(S),Dt=>_(S,Dt)),at("keydown",ot,Dt=>Dt.key==="Enter"&&!Dt.isComposing&&L()),at("click",xt,L),at("click",zt,re),T(Je,Te)};Se(Oe,Je=>{l(o)&&Je(Ke)},!0)}T(Ne,Ze)};Se(Ce,Ne=>{l(i)?Ne(ge):Ne(De,!1)},!0)}T(Ae,fe)};Se(ze,Ae=>{l(s)?Ae(ke):Ae(de,!1)})}var Fe=z(ve,2),U=w(Fe);He(()=>{var Ae,fe;return Qe(le,`  - ${((fe=(Ae=l(o))==null?void 0:Ae.estimate)==null?void 0:fe.name)||""}`)}),at("click",xe,re),at("click",U,re),T(Y,O)};Se(q,Y=>{r()&&Y(G)})}var R=z(q,2);{var he=Y=>{var O=qM(),ve=w(O),xe=z(w(ve),4),me=w(xe),le=z(w(me),2),ze=z(xe,2);Jt(ze,5,()=>N,ar,(De,Ne,Ze)=>{var Oe=jM(),Ke=w(Oe),Je=w(Ke),Te=w(Je),_e=z(Je,2);{var Ue=je=>{var At=MM(),ut=w(At),ht=z(w(ut),2);nr(ht,"name",`reorder-${Ze??""}`);var Re=z(ut,2),Xe=z(w(Re),2);nr(Xe,"name",`reorder-${Ze??""}`),He(()=>{mu(ht,l(J)[Ze]),mu(Xe,!l(J)[Ze])}),at("change",ht,tt=>oe(Ze,tt.target.checked)),at("change",Xe,tt=>oe(Ze,!tt.target.checked)),T(je,At)},Me=je=>{var At=HM();m0(At,()=>l(J)[Ze],ut=>hr(J,l(J)[Ze]=ut)),at("change",At,ut=>oe(Ze,ut.target.checked)),T(je,At)};Se(_e,je=>{Ze===6?je(Ue):je(Me,!1)})}He(()=>Qe(Te,l(Ne))),T(De,Oe)});var ke=z(ze,2),de=w(ke),Fe=z(de,2),U=w(Fe);{var Ae=De=>{var Ne=RM();T(De,Ne)},fe=De=>{var Ne=Wr("");T(De,Ne)};Se(U,De=>{l(D)?De(Ae):De(fe,!1)})}var Ce=z(ve,2),ge=w(Ce);He(()=>{de.disabled=l(D),Fe.disabled=!l(we)||l(D)}),m0(le,()=>l(we),De=>_(we,De)),at("change",le,K),at("click",de,V),at("click",Fe,I),at("click",ge,V),T(Y,O)};Se(R,Y=>{l(j)&&Y(he)})}var Be=z(R,2);{var be=Y=>{var O=$M(),ve=w(O),xe=z(w(ve),2),me=z(xe,2),le=w(me),ze=z(le,2),ke=w(ze);{var de=fe=>{var Ce=KM();T(fe,Ce)},Fe=fe=>{var Ce=Wr(" ");T(fe,Ce)};Se(ke,fe=>{l($)?fe(de):fe(Fe,!1)})}var U=z(ve,2),Ae=w(U);He(fe=>{xe.disabled=l($),le.disabled=l($),ze.disabled=fe},[()=>l($)||!l(te).trim()],it),br(xe,()=>l(te),fe=>_(te,fe)),at("click",le,x),at("click",ze,E),at("click",Ae,x),T(Y,O)};Se(Be,Y=>{l(P)&&Y(be)})}var Le=z(Be,2);Wd(Le,{get isOpen(){return l(g)},set isOpen(Y){_(g,Y)},get title(){return l(m)},set title(Y){_(m,Y)},get message(){return l(y)},set message(Y){_(y,Y)},$$legacy:!0}),T(n,H),jr()}function cz(n,e){return function(){return n.apply(e,arguments)}}const{toString:WM}=Object.prototype,{getPrototypeOf:W1}=Object,{iterator:Eg,toStringTag:uz}=Symbol,Fg=(n=>e=>{const t=WM.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),zi=n=>(n=n.toLowerCase(),e=>Fg(e)===n),Ig=n=>e=>typeof e===n,{isArray:nc}=Array,Lu=Ig("undefined");function XM(n){return n!==null&&!Lu(n)&&n.constructor!==null&&!Lu(n.constructor)&&ps(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const hz=zi("ArrayBuffer");function YM(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&hz(n.buffer),e}const JM=Ig("string"),ps=Ig("function"),fz=Ig("number"),Ug=n=>n!==null&&typeof n=="object",ZM=n=>n===!0||n===!1,Yf=n=>{if(Fg(n)!=="object")return!1;const e=W1(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(uz in n)&&!(Eg in n)},e7=zi("Date"),t7=zi("File"),r7=zi("Blob"),n7=zi("FileList"),o7=n=>Ug(n)&&ps(n.pipe),s7=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ps(n.append)&&((e=Fg(n))==="formdata"||e==="object"&&ps(n.toString)&&n.toString()==="[object FormData]"))},i7=zi("URLSearchParams"),[a7,A7,l7,d7]=["ReadableStream","Request","Response","Headers"].map(zi),c7=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wu(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,o;if(typeof n!="object"&&(n=[n]),nc(n))for(r=0,o=n.length;r<o;r++)e.call(null,n[r],r,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),i=s.length;let a;for(r=0;r<i;r++)a=s[r],e.call(null,n[a],a,n)}}function pz(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,o;for(;r-- >0;)if(o=t[r],e===o.toLowerCase())return o;return null}const nl=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,gz=n=>!Lu(n)&&n!==nl;function Em(){const{caseless:n}=gz(this)&&this||{},e={},t=(r,o)=>{const s=n&&pz(e,o)||o;Yf(e[s])&&Yf(r)?e[s]=Em(e[s],r):Yf(r)?e[s]=Em({},r):nc(r)?e[s]=r.slice():e[s]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&Wu(arguments[r],t);return e}const u7=(n,e,t,{allOwnKeys:r}={})=>(Wu(e,(o,s)=>{t&&ps(o)?n[s]=cz(o,t):n[s]=o},{allOwnKeys:r}),n),h7=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),f7=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},p7=(n,e,t,r)=>{let o,s,i;const a={};if(e=e||{},n==null)return e;do{for(o=Object.getOwnPropertyNames(n),s=o.length;s-- >0;)i=o[s],(!r||r(i,n,e))&&!a[i]&&(e[i]=n[i],a[i]=!0);n=t!==!1&&W1(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},g7=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},v7=n=>{if(!n)return null;if(nc(n))return n;let e=n.length;if(!fz(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},m7=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&W1(Uint8Array)),w7=(n,e)=>{const r=(n&&n[Eg]).call(n);let o;for(;(o=r.next())&&!o.done;){const s=o.value;e.call(n,s[0],s[1])}},y7=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},b7=zi("HTMLFormElement"),_7=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,o){return r.toUpperCase()+o}),_b=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),B7=zi("RegExp"),vz=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Wu(t,(o,s)=>{let i;(i=e(o,s,n))!==!1&&(r[s]=i||o)}),Object.defineProperties(n,r)},x7=n=>{vz(n,(e,t)=>{if(ps(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ps(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},z7=(n,e)=>{const t={},r=o=>{o.forEach(s=>{t[s]=!0})};return nc(n)?r(n):r(String(n).split(e)),t},C7=()=>{},S7=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function E7(n){return!!(n&&ps(n.append)&&n[uz]==="FormData"&&n[Eg])}const F7=n=>{const e=new Array(10),t=(r,o)=>{if(Ug(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const s=nc(r)?[]:{};return Wu(r,(i,a)=>{const A=t(i,o+1);!Lu(A)&&(s[a]=A)}),e[o]=void 0,s}}return r};return t(n,0)},I7=zi("AsyncFunction"),U7=n=>n&&(Ug(n)||ps(n))&&ps(n.then)&&ps(n.catch),mz=((n,e)=>n?setImmediate:e?((t,r)=>(nl.addEventListener("message",({source:o,data:s})=>{o===nl&&s===t&&r.length&&r.shift()()},!1),o=>{r.push(o),nl.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ps(nl.postMessage)),Q7=typeof queueMicrotask<"u"?queueMicrotask.bind(nl):typeof process<"u"&&process.nextTick||mz,T7=n=>n!=null&&ps(n[Eg]),mt={isArray:nc,isArrayBuffer:hz,isBuffer:XM,isFormData:s7,isArrayBufferView:YM,isString:JM,isNumber:fz,isBoolean:ZM,isObject:Ug,isPlainObject:Yf,isReadableStream:a7,isRequest:A7,isResponse:l7,isHeaders:d7,isUndefined:Lu,isDate:e7,isFile:t7,isBlob:r7,isRegExp:B7,isFunction:ps,isStream:o7,isURLSearchParams:i7,isTypedArray:m7,isFileList:n7,forEach:Wu,merge:Em,extend:u7,trim:c7,stripBOM:h7,inherits:f7,toFlatObject:p7,kindOf:Fg,kindOfTest:zi,endsWith:g7,toArray:v7,forEachEntry:w7,matchAll:y7,isHTMLForm:b7,hasOwnProperty:_b,hasOwnProp:_b,reduceDescriptors:vz,freezeMethods:x7,toObjectSet:z7,toCamelCase:_7,noop:C7,toFiniteNumber:S7,findKey:pz,global:nl,isContextDefined:gz,isSpecCompliantForm:E7,toJSONObject:F7,isAsyncFn:I7,isThenable:U7,setImmediate:mz,asap:Q7,isIterable:T7};function Fr(n,e,t,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}mt.inherits(Fr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:mt.toJSONObject(this.config),code:this.code,status:this.status}}});const wz=Fr.prototype,yz={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{yz[n]={value:n}});Object.defineProperties(Fr,yz);Object.defineProperty(wz,"isAxiosError",{value:!0});Fr.from=(n,e,t,r,o,s)=>{const i=Object.create(wz);return mt.toFlatObject(n,i,function(A){return A!==Error.prototype},a=>a!=="isAxiosError"),Fr.call(i,n.message,e,t,r,o),i.cause=n,i.name=n.name,s&&Object.assign(i,s),i};const L7=null;function Fm(n){return mt.isPlainObject(n)||mt.isArray(n)}function bz(n){return mt.endsWith(n,"[]")?n.slice(0,-2):n}function Bb(n,e,t){return n?n.concat(e).map(function(o,s){return o=bz(o),!t&&s?"["+o+"]":o}).join(t?".":""):e}function P7(n){return mt.isArray(n)&&!n.some(Fm)}const k7=mt.toFlatObject(mt,{},null,function(e){return/^is[A-Z]/.test(e)});function Qg(n,e,t){if(!mt.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=mt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!mt.isUndefined(y[m])});const r=t.metaTokens,o=t.visitor||c,s=t.dots,i=t.indexes,A=(t.Blob||typeof Blob<"u"&&Blob)&&mt.isSpecCompliantForm(e);if(!mt.isFunction(o))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(mt.isDate(g))return g.toISOString();if(!A&&mt.isBlob(g))throw new Fr("Blob is not supported. Use a Buffer instead.");return mt.isArrayBuffer(g)||mt.isTypedArray(g)?A&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function c(g,m,y){let b=g;if(g&&!y&&typeof g=="object"){if(mt.endsWith(m,"{}"))m=r?m:m.slice(0,-2),g=JSON.stringify(g);else if(mt.isArray(g)&&P7(g)||(mt.isFileList(g)||mt.endsWith(m,"[]"))&&(b=mt.toArray(g)))return m=bz(m),b.forEach(function(F,k){!(mt.isUndefined(F)||F===null)&&e.append(i===!0?Bb([m],k,s):i===null?m:m+"[]",d(F))}),!1}return Fm(g)?!0:(e.append(Bb(y,m,s),d(g)),!1)}const u=[],h=Object.assign(k7,{defaultVisitor:c,convertValue:d,isVisitable:Fm});function f(g,m){if(!mt.isUndefined(g)){if(u.indexOf(g)!==-1)throw Error("Circular reference detected in "+m.join("."));u.push(g),mt.forEach(g,function(b,S){(!(mt.isUndefined(b)||b===null)&&o.call(e,b,mt.isString(S)?S.trim():S,m,h))===!0&&f(b,m?m.concat(S):[S])}),u.pop()}}if(!mt.isObject(n))throw new TypeError("data must be an object");return f(n),e}function xb(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function X1(n,e){this._pairs=[],n&&Qg(n,this,e)}const _z=X1.prototype;_z.append=function(e,t){this._pairs.push([e,t])};_z.toString=function(e){const t=e?function(r){return e.call(this,r,xb)}:xb;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function O7(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Bz(n,e,t){if(!e)return n;const r=t&&t.encode||O7;mt.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let s;if(o?s=o(e,t):s=mt.isURLSearchParams(e)?e.toString():new X1(e,t).toString(r),s){const i=n.indexOf("#");i!==-1&&(n=n.slice(0,i)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class zb{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){mt.forEach(this.handlers,function(r){r!==null&&e(r)})}}const xz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},D7=typeof URLSearchParams<"u"?URLSearchParams:X1,N7=typeof FormData<"u"?FormData:null,M7=typeof Blob<"u"?Blob:null,H7={isBrowser:!0,classes:{URLSearchParams:D7,FormData:N7,Blob:M7},protocols:["http","https","file","blob","url","data"]},Y1=typeof window<"u"&&typeof document<"u",Im=typeof navigator=="object"&&navigator||void 0,j7=Y1&&(!Im||["ReactNative","NativeScript","NS"].indexOf(Im.product)<0),R7=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",q7=Y1&&window.location.href||"http://localhost",K7=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Y1,hasStandardBrowserEnv:j7,hasStandardBrowserWebWorkerEnv:R7,navigator:Im,origin:q7},Symbol.toStringTag,{value:"Module"})),jo={...K7,...H7};function $7(n,e){return Qg(n,new jo.classes.URLSearchParams,Object.assign({visitor:function(t,r,o,s){return jo.isNode&&mt.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function V7(n){return mt.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function G7(n){const e={},t=Object.keys(n);let r;const o=t.length;let s;for(r=0;r<o;r++)s=t[r],e[s]=n[s];return e}function zz(n){function e(t,r,o,s){let i=t[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),A=s>=t.length;return i=!i&&mt.isArray(o)?o.length:i,A?(mt.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r,!a):((!o[i]||!mt.isObject(o[i]))&&(o[i]=[]),e(t,r,o[i],s)&&mt.isArray(o[i])&&(o[i]=G7(o[i])),!a)}if(mt.isFormData(n)&&mt.isFunction(n.entries)){const t={};return mt.forEachEntry(n,(r,o)=>{e(V7(r),o,t,0)}),t}return null}function W7(n,e,t){if(mt.isString(n))try{return(e||JSON.parse)(n),mt.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Xu={transitional:xz,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",o=r.indexOf("application/json")>-1,s=mt.isObject(e);if(s&&mt.isHTMLForm(e)&&(e=new FormData(e)),mt.isFormData(e))return o?JSON.stringify(zz(e)):e;if(mt.isArrayBuffer(e)||mt.isBuffer(e)||mt.isStream(e)||mt.isFile(e)||mt.isBlob(e)||mt.isReadableStream(e))return e;if(mt.isArrayBufferView(e))return e.buffer;if(mt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return $7(e,this.formSerializer).toString();if((a=mt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const A=this.env&&this.env.FormData;return Qg(a?{"files[]":e}:e,A&&new A,this.formSerializer)}}return s||o?(t.setContentType("application/json",!1),W7(e)):e}],transformResponse:[function(e){const t=this.transitional||Xu.transitional,r=t&&t.forcedJSONParsing,o=this.responseType==="json";if(mt.isResponse(e)||mt.isReadableStream(e))return e;if(e&&mt.isString(e)&&(r&&!this.responseType||o)){const i=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?Fr.from(a,Fr.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:jo.classes.FormData,Blob:jo.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};mt.forEach(["delete","get","head","post","put","patch"],n=>{Xu.headers[n]={}});const X7=mt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Y7=n=>{const e={};let t,r,o;return n&&n.split(`
`).forEach(function(i){o=i.indexOf(":"),t=i.substring(0,o).trim().toLowerCase(),r=i.substring(o+1).trim(),!(!t||e[t]&&X7[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},Cb=Symbol("internals");function Rc(n){return n&&String(n).trim().toLowerCase()}function Jf(n){return n===!1||n==null?n:mt.isArray(n)?n.map(Jf):String(n)}function J7(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Z7=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function n0(n,e,t,r,o){if(mt.isFunction(r))return r.call(this,e,t);if(o&&(e=t),!!mt.isString(e)){if(mt.isString(r))return e.indexOf(r)!==-1;if(mt.isRegExp(r))return r.test(e)}}function eH(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function tH(n,e){const t=mt.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(o,s,i){return this[r].call(this,e,o,s,i)},configurable:!0})})}let gs=class{constructor(e){e&&this.set(e)}set(e,t,r){const o=this;function s(a,A,d){const c=Rc(A);if(!c)throw new Error("header name must be a non-empty string");const u=mt.findKey(o,c);(!u||o[u]===void 0||d===!0||d===void 0&&o[u]!==!1)&&(o[u||A]=Jf(a))}const i=(a,A)=>mt.forEach(a,(d,c)=>s(d,c,A));if(mt.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(mt.isString(e)&&(e=e.trim())&&!Z7(e))i(Y7(e),t);else if(mt.isObject(e)&&mt.isIterable(e)){let a={},A,d;for(const c of e){if(!mt.isArray(c))throw TypeError("Object iterator must return a key-value pair");a[d=c[0]]=(A=a[d])?mt.isArray(A)?[...A,c[1]]:[A,c[1]]:c[1]}i(a,t)}else e!=null&&s(t,e,r);return this}get(e,t){if(e=Rc(e),e){const r=mt.findKey(this,e);if(r){const o=this[r];if(!t)return o;if(t===!0)return J7(o);if(mt.isFunction(t))return t.call(this,o,r);if(mt.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Rc(e),e){const r=mt.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||n0(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let o=!1;function s(i){if(i=Rc(i),i){const a=mt.findKey(r,i);a&&(!t||n0(r,r[a],a,t))&&(delete r[a],o=!0)}}return mt.isArray(e)?e.forEach(s):s(e),o}clear(e){const t=Object.keys(this);let r=t.length,o=!1;for(;r--;){const s=t[r];(!e||n0(this,this[s],s,e,!0))&&(delete this[s],o=!0)}return o}normalize(e){const t=this,r={};return mt.forEach(this,(o,s)=>{const i=mt.findKey(r,s);if(i){t[i]=Jf(o),delete t[s];return}const a=e?eH(s):String(s).trim();a!==s&&delete t[s],t[a]=Jf(o),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return mt.forEach(this,(r,o)=>{r!=null&&r!==!1&&(t[o]=e&&mt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[Cb]=this[Cb]={accessors:{}}).accessors,o=this.prototype;function s(i){const a=Rc(i);r[a]||(tH(o,i),r[a]=!0)}return mt.isArray(e)?e.forEach(s):s(e),this}};gs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);mt.reduceDescriptors(gs.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});mt.freezeMethods(gs);function o0(n,e){const t=this||Xu,r=e||t,o=gs.from(r.headers);let s=r.data;return mt.forEach(n,function(a){s=a.call(t,s,o.normalize(),e?e.status:void 0)}),o.normalize(),s}function Cz(n){return!!(n&&n.__CANCEL__)}function oc(n,e,t){Fr.call(this,n??"canceled",Fr.ERR_CANCELED,e,t),this.name="CanceledError"}mt.inherits(oc,Fr,{__CANCEL__:!0});function Sz(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Fr("Request failed with status code "+t.status,[Fr.ERR_BAD_REQUEST,Fr.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function rH(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function nH(n,e){n=n||10;const t=new Array(n),r=new Array(n);let o=0,s=0,i;return e=e!==void 0?e:1e3,function(A){const d=Date.now(),c=r[s];i||(i=d),t[o]=A,r[o]=d;let u=s,h=0;for(;u!==o;)h+=t[u++],u=u%n;if(o=(o+1)%n,o===s&&(s=(s+1)%n),d-i<e)return;const f=c&&d-c;return f?Math.round(h*1e3/f):void 0}}function oH(n,e){let t=0,r=1e3/e,o,s;const i=(d,c=Date.now())=>{t=c,o=null,s&&(clearTimeout(s),s=null),n.apply(null,d)};return[(...d)=>{const c=Date.now(),u=c-t;u>=r?i(d,c):(o=d,s||(s=setTimeout(()=>{s=null,i(o)},r-u)))},()=>o&&i(o)]}const Op=(n,e,t=3)=>{let r=0;const o=nH(50,250);return oH(s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,A=i-r,d=o(A),c=i<=a;r=i;const u={loaded:i,total:a,progress:a?i/a:void 0,bytes:A,rate:d||void 0,estimated:d&&a&&c?(a-i)/d:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(u)},t)},Sb=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},Eb=n=>(...e)=>mt.asap(()=>n(...e)),sH=jo.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,jo.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(jo.origin),jo.navigator&&/(msie|trident)/i.test(jo.navigator.userAgent)):()=>!0,iH=jo.hasStandardBrowserEnv?{write(n,e,t,r,o,s){const i=[n+"="+encodeURIComponent(e)];mt.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),mt.isString(r)&&i.push("path="+r),mt.isString(o)&&i.push("domain="+o),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function aH(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function AH(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Ez(n,e,t){let r=!aH(e);return n&&(r||t==!1)?AH(n,e):e}const Fb=n=>n instanceof gs?{...n}:n;function fl(n,e){e=e||{};const t={};function r(d,c,u,h){return mt.isPlainObject(d)&&mt.isPlainObject(c)?mt.merge.call({caseless:h},d,c):mt.isPlainObject(c)?mt.merge({},c):mt.isArray(c)?c.slice():c}function o(d,c,u,h){if(mt.isUndefined(c)){if(!mt.isUndefined(d))return r(void 0,d,u,h)}else return r(d,c,u,h)}function s(d,c){if(!mt.isUndefined(c))return r(void 0,c)}function i(d,c){if(mt.isUndefined(c)){if(!mt.isUndefined(d))return r(void 0,d)}else return r(void 0,c)}function a(d,c,u){if(u in e)return r(d,c);if(u in n)return r(void 0,d)}const A={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(d,c,u)=>o(Fb(d),Fb(c),u,!0)};return mt.forEach(Object.keys(Object.assign({},n,e)),function(c){const u=A[c]||o,h=u(n[c],e[c],c);mt.isUndefined(h)&&u!==a||(t[c]=h)}),t}const Fz=n=>{const e=fl({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:s,headers:i,auth:a}=e;e.headers=i=gs.from(i),e.url=Bz(Ez(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let A;if(mt.isFormData(t)){if(jo.hasStandardBrowserEnv||jo.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((A=i.getContentType())!==!1){const[d,...c]=A?A.split(";").map(u=>u.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...c].join("; "))}}if(jo.hasStandardBrowserEnv&&(r&&mt.isFunction(r)&&(r=r(e)),r||r!==!1&&sH(e.url))){const d=o&&s&&iH.read(s);d&&i.set(o,d)}return e},lH=typeof XMLHttpRequest<"u",dH=lH&&function(n){return new Promise(function(t,r){const o=Fz(n);let s=o.data;const i=gs.from(o.headers).normalize();let{responseType:a,onUploadProgress:A,onDownloadProgress:d}=o,c,u,h,f,g;function m(){f&&f(),g&&g(),o.cancelToken&&o.cancelToken.unsubscribe(c),o.signal&&o.signal.removeEventListener("abort",c)}let y=new XMLHttpRequest;y.open(o.method.toUpperCase(),o.url,!0),y.timeout=o.timeout;function b(){if(!y)return;const F=gs.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),P={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:F,config:n,request:y};Sz(function($){t($),m()},function($){r($),m()},P),y=null}"onloadend"in y?y.onloadend=b:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(b)},y.onabort=function(){y&&(r(new Fr("Request aborted",Fr.ECONNABORTED,n,y)),y=null)},y.onerror=function(){r(new Fr("Network Error",Fr.ERR_NETWORK,n,y)),y=null},y.ontimeout=function(){let k=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const P=o.transitional||xz;o.timeoutErrorMessage&&(k=o.timeoutErrorMessage),r(new Fr(k,P.clarifyTimeoutError?Fr.ETIMEDOUT:Fr.ECONNABORTED,n,y)),y=null},s===void 0&&i.setContentType(null),"setRequestHeader"in y&&mt.forEach(i.toJSON(),function(k,P){y.setRequestHeader(P,k)}),mt.isUndefined(o.withCredentials)||(y.withCredentials=!!o.withCredentials),a&&a!=="json"&&(y.responseType=o.responseType),d&&([h,g]=Op(d,!0),y.addEventListener("progress",h)),A&&y.upload&&([u,f]=Op(A),y.upload.addEventListener("progress",u),y.upload.addEventListener("loadend",f)),(o.cancelToken||o.signal)&&(c=F=>{y&&(r(!F||F.type?new oc(null,n,y):F),y.abort(),y=null)},o.cancelToken&&o.cancelToken.subscribe(c),o.signal&&(o.signal.aborted?c():o.signal.addEventListener("abort",c)));const S=rH(o.url);if(S&&jo.protocols.indexOf(S)===-1){r(new Fr("Unsupported protocol "+S+":",Fr.ERR_BAD_REQUEST,n));return}y.send(s||null)})},cH=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,o;const s=function(d){if(!o){o=!0,a();const c=d instanceof Error?d:this.reason;r.abort(c instanceof Fr?c:new oc(c instanceof Error?c.message:c))}};let i=e&&setTimeout(()=>{i=null,s(new Fr(`timeout ${e} of ms exceeded`,Fr.ETIMEDOUT))},e);const a=()=>{n&&(i&&clearTimeout(i),i=null,n.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),n=null)};n.forEach(d=>d.addEventListener("abort",s));const{signal:A}=r;return A.unsubscribe=()=>mt.asap(a),A}},uH=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,o;for(;r<t;)o=r+e,yield n.slice(r,o),r=o},hH=async function*(n,e){for await(const t of fH(n))yield*uH(t,e)},fH=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},Ib=(n,e,t,r)=>{const o=hH(n,e);let s=0,i,a=A=>{i||(i=!0,r&&r(A))};return new ReadableStream({async pull(A){try{const{done:d,value:c}=await o.next();if(d){a(),A.close();return}let u=c.byteLength;if(t){let h=s+=u;t(h)}A.enqueue(new Uint8Array(c))}catch(d){throw a(d),d}},cancel(A){return a(A),o.return()}},{highWaterMark:2})},Tg=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Iz=Tg&&typeof ReadableStream=="function",pH=Tg&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Uz=(n,...e)=>{try{return!!n(...e)}catch{return!1}},gH=Iz&&Uz(()=>{let n=!1;const e=new Request(jo.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),Ub=64*1024,Um=Iz&&Uz(()=>mt.isReadableStream(new Response("").body)),Dp={stream:Um&&(n=>n.body)};Tg&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Dp[e]&&(Dp[e]=mt.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new Fr(`Response type '${e}' is not supported`,Fr.ERR_NOT_SUPPORT,r)})})})(new Response);const vH=async n=>{if(n==null)return 0;if(mt.isBlob(n))return n.size;if(mt.isSpecCompliantForm(n))return(await new Request(jo.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(mt.isArrayBufferView(n)||mt.isArrayBuffer(n))return n.byteLength;if(mt.isURLSearchParams(n)&&(n=n+""),mt.isString(n))return(await pH(n)).byteLength},mH=async(n,e)=>{const t=mt.toFiniteNumber(n.getContentLength());return t??vH(e)},wH=Tg&&(async n=>{let{url:e,method:t,data:r,signal:o,cancelToken:s,timeout:i,onDownloadProgress:a,onUploadProgress:A,responseType:d,headers:c,withCredentials:u="same-origin",fetchOptions:h}=Fz(n);d=d?(d+"").toLowerCase():"text";let f=cH([o,s&&s.toAbortSignal()],i),g;const m=f&&f.unsubscribe&&(()=>{f.unsubscribe()});let y;try{if(A&&gH&&t!=="get"&&t!=="head"&&(y=await mH(c,r))!==0){let P=new Request(e,{method:"POST",body:r,duplex:"half"}),te;if(mt.isFormData(r)&&(te=P.headers.get("content-type"))&&c.setContentType(te),P.body){const[$,j]=Sb(y,Op(Eb(A)));r=Ib(P.body,Ub,$,j)}}mt.isString(u)||(u=u?"include":"omit");const b="credentials"in Request.prototype;g=new Request(e,{...h,signal:f,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:b?u:void 0});let S=await fetch(g);const F=Um&&(d==="stream"||d==="response");if(Um&&(a||F&&m)){const P={};["status","statusText","headers"].forEach(J=>{P[J]=S[J]});const te=mt.toFiniteNumber(S.headers.get("content-length")),[$,j]=a&&Sb(te,Op(Eb(a),!0))||[];S=new Response(Ib(S.body,Ub,$,()=>{j&&j(),m&&m()}),P)}d=d||"text";let k=await Dp[mt.findKey(Dp,d)||"text"](S,n);return!F&&m&&m(),await new Promise((P,te)=>{Sz(P,te,{data:k,headers:gs.from(S.headers),status:S.status,statusText:S.statusText,config:n,request:g})})}catch(b){throw m&&m(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new Fr("Network Error",Fr.ERR_NETWORK,n,g),{cause:b.cause||b}):Fr.from(b,b&&b.code,n,g)}}),Qm={http:L7,xhr:dH,fetch:wH};mt.forEach(Qm,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Qb=n=>`- ${n}`,yH=n=>mt.isFunction(n)||n===null||n===!1,Qz={getAdapter:n=>{n=mt.isArray(n)?n:[n];const{length:e}=n;let t,r;const o={};for(let s=0;s<e;s++){t=n[s];let i;if(r=t,!yH(t)&&(r=Qm[(i=String(t)).toLowerCase()],r===void 0))throw new Fr(`Unknown adapter '${i}'`);if(r)break;o[i||"#"+s]=r}if(!r){const s=Object.entries(o).map(([a,A])=>`adapter ${a} `+(A===!1?"is not supported by the environment":"is not available in the build"));let i=e?s.length>1?`since :
`+s.map(Qb).join(`
`):" "+Qb(s[0]):"as no adapter specified";throw new Fr("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:Qm};function s0(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new oc(null,n)}function Tb(n){return s0(n),n.headers=gs.from(n.headers),n.data=o0.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Qz.getAdapter(n.adapter||Xu.adapter)(n).then(function(r){return s0(n),r.data=o0.call(n,n.transformResponse,r),r.headers=gs.from(r.headers),r},function(r){return Cz(r)||(s0(n),r&&r.response&&(r.response.data=o0.call(n,n.transformResponse,r.response),r.response.headers=gs.from(r.response.headers))),Promise.reject(r)})}const Tz="1.9.0",Lg={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Lg[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Lb={};Lg.transitional=function(e,t,r){function o(s,i){return"[Axios v"+Tz+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,a)=>{if(e===!1)throw new Fr(o(i," has been removed"+(t?" in "+t:"")),Fr.ERR_DEPRECATED);return t&&!Lb[i]&&(Lb[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,i,a):!0}};Lg.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function bH(n,e,t){if(typeof n!="object")throw new Fr("options must be an object",Fr.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let o=r.length;for(;o-- >0;){const s=r[o],i=e[s];if(i){const a=n[s],A=a===void 0||i(a,s,n);if(A!==!0)throw new Fr("option "+s+" must be "+A,Fr.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Fr("Unknown option "+s,Fr.ERR_BAD_OPTION)}}const Zf={assertOptions:bH,validators:Lg},Li=Zf.validators;let dl=class{constructor(e){this.defaults=e||{},this.interceptors={request:new zb,response:new zb}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const s=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=fl(this.defaults,t);const{transitional:r,paramsSerializer:o,headers:s}=t;r!==void 0&&Zf.assertOptions(r,{silentJSONParsing:Li.transitional(Li.boolean),forcedJSONParsing:Li.transitional(Li.boolean),clarifyTimeoutError:Li.transitional(Li.boolean)},!1),o!=null&&(mt.isFunction(o)?t.paramsSerializer={serialize:o}:Zf.assertOptions(o,{encode:Li.function,serialize:Li.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),Zf.assertOptions(t,{baseUrl:Li.spelling("baseURL"),withXsrfToken:Li.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&mt.merge(s.common,s[t.method]);s&&mt.forEach(["delete","get","head","post","put","patch","common"],g=>{delete s[g]}),t.headers=gs.concat(i,s);const a=[];let A=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(t)===!1||(A=A&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const d=[];this.interceptors.response.forEach(function(m){d.push(m.fulfilled,m.rejected)});let c,u=0,h;if(!A){const g=[Tb.bind(this),void 0];for(g.unshift.apply(g,a),g.push.apply(g,d),h=g.length,c=Promise.resolve(t);u<h;)c=c.then(g[u++],g[u++]);return c}h=a.length;let f=t;for(u=0;u<h;){const g=a[u++],m=a[u++];try{f=g(f)}catch(y){m.call(this,y);break}}try{c=Tb.call(this,f)}catch(g){return Promise.reject(g)}for(u=0,h=d.length;u<h;)c=c.then(d[u++],d[u++]);return c}getUri(e){e=fl(this.defaults,e);const t=Ez(e.baseURL,e.url,e.allowAbsoluteUrls);return Bz(t,e.params,e.paramsSerializer)}};mt.forEach(["delete","get","head","options"],function(e){dl.prototype[e]=function(t,r){return this.request(fl(r||{},{method:e,url:t,data:(r||{}).data}))}});mt.forEach(["post","put","patch"],function(e){function t(r){return function(s,i,a){return this.request(fl(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}dl.prototype[e]=t(),dl.prototype[e+"Form"]=t(!0)});let _H=class Lz{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(o=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](o);r._listeners=null}),this.promise.then=o=>{let s;const i=new Promise(a=>{r.subscribe(a),s=a}).then(o);return i.cancel=function(){r.unsubscribe(s)},i},e(function(s,i,a){r.reason||(r.reason=new oc(s,i,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Lz(function(o){e=o}),cancel:e}}};function BH(n){return function(t){return n.apply(null,t)}}function xH(n){return mt.isObject(n)&&n.isAxiosError===!0}const Tm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Tm).forEach(([n,e])=>{Tm[e]=n});function Pz(n){const e=new dl(n),t=cz(dl.prototype.request,e);return mt.extend(t,dl.prototype,e,{allOwnKeys:!0}),mt.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return Pz(fl(n,o))},t}const kn=Pz(Xu);kn.Axios=dl;kn.CanceledError=oc;kn.CancelToken=_H;kn.isCancel=Cz;kn.VERSION=Tz;kn.toFormData=Qg;kn.AxiosError=Fr;kn.Cancel=kn.CanceledError;kn.all=function(e){return Promise.all(e)};kn.spread=BH;kn.isAxiosError=xH;kn.mergeConfig=fl;kn.AxiosHeaders=gs;kn.formToJSON=n=>zz(mt.isHTMLForm(n)?new FormData(n):n);kn.getAdapter=Qz.getAdapter;kn.HttpStatusCode=Tm;kn.default=kn;const{Axios:HK,AxiosError:jK,CanceledError:RK,isCancel:qK,CancelToken:KK,VERSION:$K,all:VK,Cancel:GK,isAxiosError:WK,spread:XK,toFormData:YK,AxiosHeaders:JK,HttpStatusCode:ZK,formToJSON:e$,getAdapter:t$,mergeConfig:r$}=kn,kz=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",zH=kz+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",CH="["+kz+"]["+zH+"]*",SH=new RegExp("^"+CH+"$");function Oz(n,e){const t=[];let r=e.exec(n);for(;r;){const o=[];o.startIndex=e.lastIndex-r[0].length;const s=r.length;for(let i=0;i<s;i++)o.push(r[i]);t.push(o),r=e.exec(n)}return t}const J1=function(n){const e=SH.exec(n);return!(e===null||typeof e>"u")};function EH(n){return typeof n<"u"}const FH={allowBooleanAttributes:!1,unpairedTags:[]};function IH(n,e){e=Object.assign({},FH,e);const t=[];let r=!1,o=!1;n[0]==="\uFEFF"&&(n=n.substr(1));for(let s=0;s<n.length;s++)if(n[s]==="<"&&n[s+1]==="?"){if(s+=2,s=kb(n,s),s.err)return s}else if(n[s]==="<"){let i=s;if(s++,n[s]==="!"){s=Ob(n,s);continue}else{let a=!1;n[s]==="/"&&(a=!0,s++);let A="";for(;s<n.length&&n[s]!==">"&&n[s]!==" "&&n[s]!=="	"&&n[s]!==`
`&&n[s]!=="\r";s++)A+=n[s];if(A=A.trim(),A[A.length-1]==="/"&&(A=A.substring(0,A.length-1),s--),!DH(A)){let u;return A.trim().length===0?u="Invalid space after '<'.":u="Tag '"+A+"' is an invalid name.",$n("InvalidTag",u,Go(n,s))}const d=TH(n,s);if(d===!1)return $n("InvalidAttr","Attributes for '"+A+"' have open quote.",Go(n,s));let c=d.value;if(s=d.index,c[c.length-1]==="/"){const u=s-c.length;c=c.substring(0,c.length-1);const h=Db(c,e);if(h===!0)r=!0;else return $n(h.err.code,h.err.msg,Go(n,u+h.err.line))}else if(a)if(d.tagClosed){if(c.trim().length>0)return $n("InvalidTag","Closing tag '"+A+"' can't have attributes or invalid starting.",Go(n,i));if(t.length===0)return $n("InvalidTag","Closing tag '"+A+"' has not been opened.",Go(n,i));{const u=t.pop();if(A!==u.tagName){let h=Go(n,u.tagStartPos);return $n("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+A+"'.",Go(n,i))}t.length==0&&(o=!0)}}else return $n("InvalidTag","Closing tag '"+A+"' doesn't have proper closing.",Go(n,s));else{const u=Db(c,e);if(u!==!0)return $n(u.err.code,u.err.msg,Go(n,s-c.length+u.err.line));if(o===!0)return $n("InvalidXml","Multiple possible root nodes found.",Go(n,s));e.unpairedTags.indexOf(A)!==-1||t.push({tagName:A,tagStartPos:i}),r=!0}for(s++;s<n.length;s++)if(n[s]==="<")if(n[s+1]==="!"){s++,s=Ob(n,s);continue}else if(n[s+1]==="?"){if(s=kb(n,++s),s.err)return s}else break;else if(n[s]==="&"){const u=kH(n,s);if(u==-1)return $n("InvalidChar","char '&' is not expected.",Go(n,s));s=u}else if(o===!0&&!Pb(n[s]))return $n("InvalidXml","Extra text at the end",Go(n,s));n[s]==="<"&&s--}}else{if(Pb(n[s]))continue;return $n("InvalidChar","char '"+n[s]+"' is not expected.",Go(n,s))}if(r){if(t.length==1)return $n("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",Go(n,t[0].tagStartPos));if(t.length>0)return $n("InvalidXml","Invalid '"+JSON.stringify(t.map(s=>s.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return $n("InvalidXml","Start tag expected.",1);return!0}function Pb(n){return n===" "||n==="	"||n===`
`||n==="\r"}function kb(n,e){const t=e;for(;e<n.length;e++)if(n[e]=="?"||n[e]==" "){const r=n.substr(t,e-t);if(e>5&&r==="xml")return $n("InvalidXml","XML declaration allowed only at the start of the document.",Go(n,e));if(n[e]=="?"&&n[e+1]==">"){e++;break}else continue}return e}function Ob(n,e){if(n.length>e+5&&n[e+1]==="-"&&n[e+2]==="-"){for(e+=3;e<n.length;e++)if(n[e]==="-"&&n[e+1]==="-"&&n[e+2]===">"){e+=2;break}}else if(n.length>e+8&&n[e+1]==="D"&&n[e+2]==="O"&&n[e+3]==="C"&&n[e+4]==="T"&&n[e+5]==="Y"&&n[e+6]==="P"&&n[e+7]==="E"){let t=1;for(e+=8;e<n.length;e++)if(n[e]==="<")t++;else if(n[e]===">"&&(t--,t===0))break}else if(n.length>e+9&&n[e+1]==="["&&n[e+2]==="C"&&n[e+3]==="D"&&n[e+4]==="A"&&n[e+5]==="T"&&n[e+6]==="A"&&n[e+7]==="["){for(e+=8;e<n.length;e++)if(n[e]==="]"&&n[e+1]==="]"&&n[e+2]===">"){e+=2;break}}return e}const UH='"',QH="'";function TH(n,e){let t="",r="",o=!1;for(;e<n.length;e++){if(n[e]===UH||n[e]===QH)r===""?r=n[e]:r!==n[e]||(r="");else if(n[e]===">"&&r===""){o=!0;break}t+=n[e]}return r!==""?!1:{value:t,index:e,tagClosed:o}}const LH=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function Db(n,e){const t=Oz(n,LH),r={};for(let o=0;o<t.length;o++){if(t[o][1].length===0)return $n("InvalidAttr","Attribute '"+t[o][2]+"' has no space in starting.",qc(t[o]));if(t[o][3]!==void 0&&t[o][4]===void 0)return $n("InvalidAttr","Attribute '"+t[o][2]+"' is without value.",qc(t[o]));if(t[o][3]===void 0&&!e.allowBooleanAttributes)return $n("InvalidAttr","boolean attribute '"+t[o][2]+"' is not allowed.",qc(t[o]));const s=t[o][2];if(!OH(s))return $n("InvalidAttr","Attribute '"+s+"' is an invalid name.",qc(t[o]));if(!r.hasOwnProperty(s))r[s]=1;else return $n("InvalidAttr","Attribute '"+s+"' is repeated.",qc(t[o]))}return!0}function PH(n,e){let t=/\d/;for(n[e]==="x"&&(e++,t=/[\da-fA-F]/);e<n.length;e++){if(n[e]===";")return e;if(!n[e].match(t))break}return-1}function kH(n,e){if(e++,n[e]===";")return-1;if(n[e]==="#")return e++,PH(n,e);let t=0;for(;e<n.length;e++,t++)if(!(n[e].match(/\w/)&&t<20)){if(n[e]===";")break;return-1}return e}function $n(n,e,t){return{err:{code:n,msg:e,line:t.line||t,col:t.col}}}function OH(n){return J1(n)}function DH(n){return J1(n)}function Go(n,e){const t=n.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function qc(n){return n.startIndex+n[1].length}const NH={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,e,t){return n},captureMetaData:!1},MH=function(n){return Object.assign({},NH,n)};let Np;typeof Symbol!="function"?Np="@@xmlMetadata":Np=Symbol("XML Node Metadata");class XA{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),t!==void 0&&(this.child[this.child.length-1][Np]={startIndex:t})}static getMetaDataSymbol(){return Np}}function HH(n,e){const t={};if(n[e+3]==="O"&&n[e+4]==="C"&&n[e+5]==="T"&&n[e+6]==="Y"&&n[e+7]==="P"&&n[e+8]==="E"){e=e+9;let r=1,o=!1,s=!1,i="";for(;e<n.length;e++)if(n[e]==="<"&&!s){if(o&&YA(n,"!ENTITY",e)){e+=7;let a,A;[a,A,e]=jH(n,e+1),A.indexOf("&")===-1&&(t[a]={regx:RegExp(`&${a};`,"g"),val:A})}else if(o&&YA(n,"!ELEMENT",e)){e+=8;const{index:a}=qH(n,e+1);e=a}else if(o&&YA(n,"!ATTLIST",e))e+=8;else if(o&&YA(n,"!NOTATION",e)){e+=9;const{index:a}=RH(n,e+1);e=a}else if(YA(n,"!--",e))s=!0;else throw new Error("Invalid DOCTYPE");r++,i=""}else if(n[e]===">"){if(s?n[e-1]==="-"&&n[e-2]==="-"&&(s=!1,r--):r--,r===0)break}else n[e]==="["?o=!0:i+=n[e];if(r!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}const uA=(n,e)=>{for(;e<n.length&&/\s/.test(n[e]);)e++;return e};function jH(n,e){e=uA(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e])&&n[e]!=='"'&&n[e]!=="'";)t+=n[e],e++;if(Z1(t),e=uA(n,e),n.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(n[e]==="%")throw new Error("Parameter entities are not supported");let r="";return[e,r]=ep(n,e,"entity"),e--,[t,r,e]}function RH(n,e){e=uA(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e]);)t+=n[e],e++;Z1(t),e=uA(n,e);const r=n.substring(e,e+6).toUpperCase();if(r!=="SYSTEM"&&r!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${r}"`);e+=r.length,e=uA(n,e);let o=null,s=null;if(r==="PUBLIC")[e,o]=ep(n,e,"publicIdentifier"),e=uA(n,e),(n[e]==='"'||n[e]==="'")&&([e,s]=ep(n,e,"systemIdentifier"));else if(r==="SYSTEM"&&([e,s]=ep(n,e,"systemIdentifier"),!s))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:t,publicIdentifier:o,systemIdentifier:s,index:--e}}function ep(n,e,t){let r="";const o=n[e];if(o!=='"'&&o!=="'")throw new Error(`Expected quoted string, found "${o}"`);for(e++;e<n.length&&n[e]!==o;)r+=n[e],e++;if(n[e]!==o)throw new Error(`Unterminated ${t} value`);return e++,[e,r]}function qH(n,e){e=uA(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e]);)t+=n[e],e++;if(!Z1(t))throw new Error(`Invalid element name: "${t}"`);e=uA(n,e);let r="";if(n[e]==="E"&&YA(n,"MPTY",e))e+=6;else if(n[e]==="A"&&YA(n,"NY",e))e+=4;else if(n[e]==="("){for(e++;e<n.length&&n[e]!==")";)r+=n[e],e++;if(n[e]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${n[e]}"`);return{elementName:t,contentModel:r.trim(),index:e}}function YA(n,e,t){for(let r=0;r<e.length;r++)if(e[r]!==n[t+r+1])return!1;return!0}function Z1(n){if(J1(n))return n;throw new Error(`Invalid entity name ${n}`)}const KH=/^[-+]?0x[a-fA-F0-9]+$/,$H=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,VH={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function GH(n,e={}){if(e=Object.assign({},VH,e),!n||typeof n!="string")return n;let t=n.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return n;if(n==="0")return 0;if(e.hex&&KH.test(t))return JH(t,16);if(t.search(/.+[eE].+/)!==-1)return XH(n,t,e);{const r=$H.exec(t);if(r){const o=r[1]||"",s=r[2];let i=YH(r[3]);const a=o?n[s.length+1]===".":n[s.length]===".";if(!e.leadingZeros&&(s.length>1||s.length===1&&!a))return n;{const A=Number(t),d=String(A);if(A===0||A===-0)return A;if(d.search(/[eE]/)!==-1)return e.eNotation?A:n;if(t.indexOf(".")!==-1)return d==="0"||d===i||d===`${o}${i}`?A:n;let c=s?i:t;return s?c===d||o+c===d?A:n:c===d||c===o+d?A:n}}else return n}}const WH=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function XH(n,e,t){if(!t.eNotation)return n;const r=e.match(WH);if(r){let o=r[1]||"";const s=r[3].indexOf("e")===-1?"E":"e",i=r[2],a=o?n[i.length+1]===s:n[i.length]===s;return i.length>1&&a?n:i.length===1&&(r[3].startsWith(`.${s}`)||r[3][0]===s)?Number(e):t.leadingZeros&&!a?(e=(r[1]||"")+r[3],Number(e)):n}else return n}function YH(n){return n&&n.indexOf(".")!==-1&&(n=n.replace(/0+$/,""),n==="."?n="0":n[0]==="."?n="0"+n:n[n.length-1]==="."&&(n=n.substring(0,n.length-1))),n}function JH(n,e){if(parseInt)return parseInt(n,e);if(Number.parseInt)return Number.parseInt(n,e);if(window&&window.parseInt)return window.parseInt(n,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function ZH(n){return typeof n=="function"?n:Array.isArray(n)?e=>{for(const t of n)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}class ej{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,r)=>String.fromCodePoint(Number.parseInt(r,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,r)=>String.fromCodePoint(Number.parseInt(r,16))}},this.addExternalEntities=tj,this.parseXml=ij,this.parseTextData=rj,this.resolveNameSpace=nj,this.buildAttributesMap=sj,this.isItStopNode=dj,this.replaceEntitiesValue=Aj,this.readStopNodeData=uj,this.saveTextToParentTag=lj,this.addChild=aj,this.ignoreAttributesFn=ZH(this.options.ignoreAttributes)}}function tj(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:n[r]}}}function rj(n,e,t,r,o,s,i){if(n!==void 0&&(this.options.trimValues&&!r&&(n=n.trim()),n.length>0)){i||(n=this.replaceEntitiesValue(n));const a=this.options.tagValueProcessor(e,n,t,o,s);return a==null?n:typeof a!=typeof n||a!==n?a:this.options.trimValues?Pm(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?Pm(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function nj(n){if(this.options.removeNSPrefix){const e=n.split(":"),t=n.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(n=t+e[1])}return n}const oj=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function sj(n,e,t){if(this.options.ignoreAttributes!==!0&&typeof n=="string"){const r=Oz(n,oj),o=r.length,s={};for(let i=0;i<o;i++){const a=this.resolveNameSpace(r[i][1]);if(this.ignoreAttributesFn(a,e))continue;let A=r[i][4],d=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(d=this.options.transformAttributeName(d)),d==="__proto__"&&(d="#__proto__"),A!==void 0){this.options.trimValues&&(A=A.trim()),A=this.replaceEntitiesValue(A);const c=this.options.attributeValueProcessor(a,A,e);c==null?s[d]=A:typeof c!=typeof A||c!==A?s[d]=c:s[d]=Pm(A,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[d]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){const i={};return i[this.options.attributesGroupName]=s,i}return s}}const ij=function(n){n=n.replace(/\r\n?/g,`
`);const e=new XA("!xml");let t=e,r="",o="";for(let s=0;s<n.length;s++)if(n[s]==="<")if(n[s+1]==="/"){const a=ol(n,">",s,"Closing Tag is not closed.");let A=n.substring(s+2,a).trim();if(this.options.removeNSPrefix){const u=A.indexOf(":");u!==-1&&(A=A.substr(u+1))}this.options.transformTagName&&(A=this.options.transformTagName(A)),t&&(r=this.saveTextToParentTag(r,t,o));const d=o.substring(o.lastIndexOf(".")+1);if(A&&this.options.unpairedTags.indexOf(A)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${A}>`);let c=0;d&&this.options.unpairedTags.indexOf(d)!==-1?(c=o.lastIndexOf(".",o.lastIndexOf(".")-1),this.tagsNodeStack.pop()):c=o.lastIndexOf("."),o=o.substring(0,c),t=this.tagsNodeStack.pop(),r="",s=a}else if(n[s+1]==="?"){let a=Lm(n,s,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,t,o),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const A=new XA(a.tagName);A.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(A[":@"]=this.buildAttributesMap(a.tagExp,o,a.tagName)),this.addChild(t,A,o,s)}s=a.closeIndex+1}else if(n.substr(s+1,3)==="!--"){const a=ol(n,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){const A=n.substring(s+4,a-2);r=this.saveTextToParentTag(r,t,o),t.add(this.options.commentPropName,[{[this.options.textNodeName]:A}])}s=a}else if(n.substr(s+1,2)==="!D"){const a=HH(n,s);this.docTypeEntities=a.entities,s=a.i}else if(n.substr(s+1,2)==="!["){const a=ol(n,"]]>",s,"CDATA is not closed.")-2,A=n.substring(s+9,a);r=this.saveTextToParentTag(r,t,o);let d=this.parseTextData(A,t.tagname,o,!0,!1,!0,!0);d==null&&(d=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:A}]):t.add(this.options.textNodeName,d),s=a+2}else{let a=Lm(n,s,this.options.removeNSPrefix),A=a.tagName;const d=a.rawTagName;let c=a.tagExp,u=a.attrExpPresent,h=a.closeIndex;this.options.transformTagName&&(A=this.options.transformTagName(A)),t&&r&&t.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,t,o,!1));const f=t;f&&this.options.unpairedTags.indexOf(f.tagname)!==-1&&(t=this.tagsNodeStack.pop(),o=o.substring(0,o.lastIndexOf("."))),A!==e.tagname&&(o+=o?"."+A:A);const g=s;if(this.isItStopNode(this.options.stopNodes,o,A)){let m="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)A[A.length-1]==="/"?(A=A.substr(0,A.length-1),o=o.substr(0,o.length-1),c=A):c=c.substr(0,c.length-1),s=a.closeIndex;else if(this.options.unpairedTags.indexOf(A)!==-1)s=a.closeIndex;else{const b=this.readStopNodeData(n,d,h+1);if(!b)throw new Error(`Unexpected end of ${d}`);s=b.i,m=b.tagContent}const y=new XA(A);A!==c&&u&&(y[":@"]=this.buildAttributesMap(c,o,A)),m&&(m=this.parseTextData(m,A,o,!0,u,!0,!0)),o=o.substr(0,o.lastIndexOf(".")),y.add(this.options.textNodeName,m),this.addChild(t,y,o,g)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){A[A.length-1]==="/"?(A=A.substr(0,A.length-1),o=o.substr(0,o.length-1),c=A):c=c.substr(0,c.length-1),this.options.transformTagName&&(A=this.options.transformTagName(A));const m=new XA(A);A!==c&&u&&(m[":@"]=this.buildAttributesMap(c,o,A)),this.addChild(t,m,o,g),o=o.substr(0,o.lastIndexOf("."))}else{const m=new XA(A);this.tagsNodeStack.push(t),A!==c&&u&&(m[":@"]=this.buildAttributesMap(c,o,A)),this.addChild(t,m,o,g),t=m}r="",s=h}}else r+=n[s];return e.child};function aj(n,e,t,r){this.options.captureMetaData||(r=void 0);const o=this.options.updateTag(e.tagname,t,e[":@"]);o===!1||(typeof o=="string"&&(e.tagname=o),n.addChild(e,r))}const Aj=function(n){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];n=n.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];n=n.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];n=n.replace(t.regex,t.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function lj(n,e,t,r){return n&&(r===void 0&&(r=e.child.length===0),n=this.parseTextData(n,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,r),n!==void 0&&n!==""&&e.add(this.options.textNodeName,n),n=""),n}function dj(n,e,t){const r="*."+t;for(const o in n){const s=n[o];if(r===s||e===s)return!0}return!1}function cj(n,e,t=">"){let r,o="";for(let s=e;s<n.length;s++){let i=n[s];if(r)i===r&&(r="");else if(i==='"'||i==="'")r=i;else if(i===t[0])if(t[1]){if(n[s+1]===t[1])return{data:o,index:s}}else return{data:o,index:s};else i==="	"&&(i=" ");o+=i}}function ol(n,e,t,r){const o=n.indexOf(e,t);if(o===-1)throw new Error(r);return o+e.length-1}function Lm(n,e,t,r=">"){const o=cj(n,e+1,r);if(!o)return;let s=o.data;const i=o.index,a=s.search(/\s/);let A=s,d=!0;a!==-1&&(A=s.substring(0,a),s=s.substring(a+1).trimStart());const c=A;if(t){const u=A.indexOf(":");u!==-1&&(A=A.substr(u+1),d=A!==o.data.substr(u+1))}return{tagName:A,tagExp:s,closeIndex:i,attrExpPresent:d,rawTagName:c}}function uj(n,e,t){const r=t;let o=1;for(;t<n.length;t++)if(n[t]==="<")if(n[t+1]==="/"){const s=ol(n,">",t,`${e} is not closed`);if(n.substring(t+2,s).trim()===e&&(o--,o===0))return{tagContent:n.substring(r,t),i:s};t=s}else if(n[t+1]==="?")t=ol(n,"?>",t+1,"StopNode is not closed.");else if(n.substr(t+1,3)==="!--")t=ol(n,"-->",t+3,"StopNode is not closed.");else if(n.substr(t+1,2)==="![")t=ol(n,"]]>",t,"StopNode is not closed.")-2;else{const s=Lm(n,t,">");s&&((s&&s.tagName)===e&&s.tagExp[s.tagExp.length-1]!=="/"&&o++,t=s.closeIndex)}}function Pm(n,e,t){if(e&&typeof n=="string"){const r=n.trim();return r==="true"?!0:r==="false"?!1:GH(n,t)}else return EH(n)?n:""}const i0=XA.getMetaDataSymbol();function hj(n,e){return Dz(n,e)}function Dz(n,e,t){let r;const o={};for(let s=0;s<n.length;s++){const i=n[s],a=fj(i);let A="";if(t===void 0?A=a:A=t+"."+a,a===e.textNodeName)r===void 0?r=i[a]:r+=""+i[a];else{if(a===void 0)continue;if(i[a]){let d=Dz(i[a],e,A);const c=gj(d,e);i[i0]!==void 0&&(d[i0]=i[i0]),i[":@"]?pj(d,i[":@"],A,e):Object.keys(d).length===1&&d[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?d=d[e.textNodeName]:Object.keys(d).length===0&&(e.alwaysCreateTextNode?d[e.textNodeName]="":d=""),o[a]!==void 0&&o.hasOwnProperty(a)?(Array.isArray(o[a])||(o[a]=[o[a]]),o[a].push(d)):e.isArray(a,A,c)?o[a]=[d]:o[a]=d}}}return typeof r=="string"?r.length>0&&(o[e.textNodeName]=r):r!==void 0&&(o[e.textNodeName]=r),o}function fj(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];if(r!==":@")return r}}function pj(n,e,t,r){if(e){const o=Object.keys(e),s=o.length;for(let i=0;i<s;i++){const a=o[i];r.isArray(a,t+"."+a,!0,!0)?n[a]=[e[a]]:n[a]=e[a]}}}function gj(n,e){const{textNodeName:t}=e,r=Object.keys(n).length;return!!(r===0||r===1&&(n[t]||typeof n[t]=="boolean"||n[t]===0))}class vj{constructor(e){this.externalEntities={},this.options=MH(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const s=IH(e,t);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}const r=new ej(this.options);r.addExternalEntities(this.externalEntities);const o=r.parseXml(e);return this.options.preserveOrder||o===void 0?o:hj(o,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return XA.getMetaDataSymbol()}}class Nz{constructor(){this.partner_key="JUZFJThGJUQ0JUQ0JUNCUVBD",this.key="JUI5JTgyR3QlMTMtUSVBRiUxMyVEQUslQzclN0ZHJTBCVzQlOUUyLSUxMiUwRmMlODQlNUMlRTglQTYlRjUlMTVMJThBVTclRTIlOTElM0E=",this.parser=new vj({ignoreAttributes:!1,trimValues:!0})}async getProduct(e){var t,r;try{const o=await kn.get("https://openhub.godo.co.kr/godomall5/goods/Goods_Search.php",{params:{partner_key:this.partner_key,key:this.key,goodsNo:e}});if(typeof o.data!="string")throw new Error("XML    .");const i=this.parser.parse(o.data).data.return.goods_data,a=((t=i.optionName)==null?void 0:t.split("^|^").map(d=>d))||[];console.log({godoProduct:i});const A=a.map((d,c)=>{var g;const u=((g=i.optionData)==null?void 0:g.map(m=>m[`optionValue${c+1}`]).filter(m=>m))||[],h=[...new Set(u)],f=h.map(m=>{var y,b;if(c===0){const F=(((b=(y=i.optionData)==null?void 0:y.find(P=>P[`optionValue${c+1}`]===m))==null?void 0:b.optionImage)||"").split("http").pop();return F?"http"+F:""}return""});return{title:d,values:h,images:f}});return{title:i.goodsNm,description:i.goodsDescription,handle:i.goodsNo,thumbnail:i.listImageData?i.listImageData["#text"]:"",goodsNo:i.goodsNo,goodsNm:i.goodsNm,goodsDescription:i.goodsDescription.replace(/\\r\\n/g,`
`).replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\/g,"")||"",status:"draft",productOptionValues:A,variants:((r=i.optionData)==null?void 0:r.map(d=>{const c=Array.from({length:5},(g,m)=>d[`optionValue${m+1}`]).filter(g=>g!==void 0&&g!==""),h=(d.optionImage||"").split("http").pop(),f=h?"http"+h:"";return{title:c.join(" / "),sku:d.optionCode||`${i.goodsNo}-${c.join("-")}`,thumbnail:f,barcode:"",inventory_quantity:parseInt(d.stockCnt||"0"),price:parseInt(i.goodsPrice+d.optionPrice||"0")}}))||[],mallType:"godo5",mallProductId:e,textOptionData:i.textOptionData}}catch(o){throw console.error("Godo5 API Error:",o),new Error("5    .")}}async getAddProduct(e){try{const t=await kn.get("https://openhub.godo.co.kr/godomall5/goods/Goods_Add_Search.php",{params:{partner_key:this.partner_key,key:this.key,addGoodsNo:e}});if(typeof t.data!="string")throw new Error("XML    .");console.log({response:t});const r=this.parser.parse(t.data);console.log({result:r});const o=r.data.return.goods_data;return console.log({addGoodsData:o}),{addGoodsNo:o.addGoodsNo,goodsNm:o.goodsNm,goodsPrice:parseInt(o.goodsPrice||"0"),stockCnt:parseInt(o.stockCnt||"0"),listImageData:o.listImageData,soldOutFl:o.soldOutFl==="y"}}catch(t){throw console.error("Godo5 API Error:",t),new Error("5    .")}}parseOptionInfo(e){try{return JSON.parse(e).map(r=>({name:r[0]||"",value:r[1]||"",code:r[2]||"",stock:r[3]||"",price:parseInt(r[3]||"0")})).filter(r=>r.name&&r.value)}catch(t){return console.error("   :",t),[]}}getOptionCode(e){try{return JSON.parse(e)[0][2]||""}catch(t){return console.error("   :",t),""}}async getOrder(e){try{const t=await kn.get("https://openhub.godo.co.kr/godomall5/order/Order_Search.php",{params:{partner_key:this.partner_key,key:this.key,orderNo:e}});if(typeof t.data!="string")throw new Error("XML    .");const o=this.parser.parse(t.data).data.return.order_data;return console.log({orderData:o}),{orderNo:o.orderNo,orderDate:o.orderDate,orderStatus:o.orderStatus,orderName:o.orderInfoData.orderName,orderEmail:o.orderInfoData.orderEmail,orderPhone:o.orderInfoData.orderPhone,receiverName:o.orderInfoData.receiverName,receiverPhone:o.orderInfoData.receiverPhone,receiverAddress:`${o.orderInfoData.receiverZonecode} ${o.orderInfoData.receiverAddress} ${o.orderInfoData.receiverAddressSub}`,totalPrice:parseInt(o.settlePrice),orderGoodsData:Array.isArray(o.orderGoodsData)?o.orderGoodsData.map(s=>({goodsNo:s.goodsNo||"",goodsNm:s.goodsNm||"",goodsType:"orderGoods",goodsCnt:s.goodsCnt||0,goodsPrice:s.goodsPrice||0,listImageData:s.listImageData||"",exist:!1,options:this.parseOptionInfo(s.optionInfo||"[]"),orderCd:s.orderCd||"",optionCode:this.getOptionCode(s.optionInfo||"")})):[],addGoodsData:Array.isArray(o.addGoodsData)?o.addGoodsData.map(s=>({goodsNm:s.goodsNm,addGoodsNo:s.addGoodsNo,goodsType:"addGoods",goodsCnt:parseInt(String(s.goodsCnt)),goodsPrice:parseInt(String(s.goodsPrice)),listImageData:s.listImageData,exist:!1,options:this.parseOptionInfo(s.optionInfo||"[]"),orderCd:s.orderCd||"",optionCode:this.getOptionCode(s.optionInfo||"")})):[]}}catch(t){throw console.error("Godo5 API Error:",t),new Error("5    .")}}}new Nz;async function mj(n,e){const t=[],r=n.filter(o=>o.product&&o.product.mall_type==="godo5"&&o.product.mall_product_id);if(r.length===0)return console.log("5  ."),t;console.log(`${r.length} 5  .`);try{const o=document.createElement("form");o.method="POST",o.action="/order/cart_ps.php",o.style.display="none";const s=(i,a)=>{const A=document.createElement("input");A.type="hidden",A.name=i,A.value=a,o.appendChild(A)};s("mode","cartIn"),s("cartMode","d"),s("useBundleGoods","1"),s("scmNo","1");for(const i of r)try{const A=i.product.mall_product_id,d=i.idx;let c=1;i.isAdditionalCost?c=1:c=Array.isArray(i.items)?i.items.reduce((f,g)=>f+(g.quantity||0),0):1;let u="";e&&d!==void 0&&(i.isAdditionalCost?u=`${e}-add-${i.id}`:u=`${e}-${d}`);const h=await yj(i.product.mall_product_id);console.log(`   (${i.isAdditionalCost?"":""}):`,h),s("goodsNo[]",A),s("goodsCnt[]",c.toString()),s("optionFl[]","n"),s("displayOptionkey[]",""),s("goodsPriceSum[]","0"),s("addGoodsPriceSum[]","0"),u&&h.textOptionData.optionName==="odiz"&&s(`optionText[${d}][${h.textOptionData.sno}]`,u),t.push(A)}catch(a){console.error("    :",a)}return document.body.appendChild(o),console.log(o),o.submit(),console.log(`${r.length} 5     `),t}catch(o){return console.error("    :",o),t}}async function wj(n){var t,r,o,s;const e={success:!1,submittedOrders:[]};try{const i=((t=n[0])==null?void 0:t.estimate_id)||((s=(o=(r=n[0])==null?void 0:r.items)==null?void 0:o[0])==null?void 0:s.estimate_id),a=await mj(n,i);a.length>0&&(e.submittedOrders.push({mallType:"godo5",productIds:a}),e.success=!0)}catch(i){console.error("    :",i)}return e}async function yj(n){return await new Nz().getProduct(n)}var bj=ee('<button class="odz-btn odz-btn-outline odz-ml-2"></button>'),_j=ee('<div class="odz-text-xs odz-text-gray-500 odz-mt-2"> </div>'),Bj=ee('<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-6"><div class="odz-card-body odz-p-4"><fieldset class="odz-border odz-border-solid odz-border-base-300 odz-rounded-md odz-p-4"><legend class="odz-px-2 odz-font-medium odz-text-sm"> </legend> <div class="odz-form-control odz-w-full"><div class="odz-flex odz-flex-row odz-flex-wrap odz-gap-3 odz-items-end"><div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"></span></label> <input type="date" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"></span></label> <input type="date" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-mt-6"><button class="odz-btn odz-btn-primary"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-5 odz-w-5 odz-mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> </button> <!></div></div> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mt-3"><button class="odz-btn odz-btn-xs odz-btn-outline">1</button> <button class="odz-btn odz-btn-xs odz-btn-outline"></button> <button class="odz-btn odz-btn-xs odz-btn-outline">6</button> <button class="odz-btn odz-btn-xs odz-btn-outline">1</button></div> <!></div></fieldset></div></div>'),xj=ee('<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-6"><div class="odz-card-body odz-p-4"><fieldset class="odz-border odz-border-solid odz-border-base-300 odz-rounded-md odz-p-4"><legend class="odz-px-2 odz-font-medium odz-text-sm">  </legend> <div class="odz-form-control odz-w-full"><div class="odz-flex odz-flex-row odz-flex-wrap odz-gap-3 odz-items-end"><div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"> *</span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"> *</span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-mt-6"><button class="odz-btn odz-btn-primary"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-5 odz-w-5 odz-mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> </button></div></div> <div class="odz-text-xs odz-text-gray-500 odz-mt-2">*        .</div></div></fieldset></div></div>'),zj=ee('<div class="odz-flex odz-justify-center odz-my-8"><span class="odz-loading odz-loading-spinner odz-loading-lg"></span></div>'),Cj=ee('<div class="odz-alert odz-alert-error"><span> </span></div>'),Sj=ee('<div class="odz-text-center odz-text-sm odz-text-gray-500 odz-my-8"><!></div>'),Ej=ee('<img loading="lazy" class="odz-w-24 odz-h-24 odz-rounded-xl odz-object-cover odz-ring-2 odz-ring-gray-100 odz-transition-transform odz-duration-300 group-hover:odz-scale-105"> <div class="odz-w-24 odz-h-24 odz-rounded-xl odz-bg-gradient-to-br odz-from-indigo-50 odz-via-purple-50 odz-to-pink-50 odz-flex odz-items-center odz-justify-center odz-ring-2 odz-ring-gray-100" style="display: none;"><svg class="odz-w-10 odz-h-10 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>',1),Fj=ee('<div class="odz-w-24 odz-h-24 odz-rounded-xl odz-bg-gradient-to-br odz-from-indigo-50 odz-via-purple-50 odz-to-pink-50 odz-flex odz-items-center odz-justify-center odz-ring-2 odz-ring-gray-100"><svg class="odz-w-10 odz-h-10 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'),Ij=ee('<div class="odz-absolute -odz-bottom-2 -odz-right-2 odz-bg-indigo-600 odz-text-white odz-text-xs odz-font-bold odz-px-2.5 odz-py-1 odz-rounded-full odz-shadow-lg odz-ring-2 odz-ring-white"> </div>'),Uj=ee('<p class="odz-text-sm odz-text-gray-600 odz-mb-2 odz-truncate"> <!></p>'),Qj=ee('<span class="odz-inline-flex odz-items-center odz-gap-1.5 odz-px-3 odz-py-1.5 odz-rounded-lg odz-bg-indigo-50 odz-text-indigo-700 odz-text-xs odz-font-medium odz-border odz-border-indigo-100"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg> </span>'),Tj=ee('<span class="odz-inline-flex odz-items-center odz-gap-1.5 odz-px-3 odz-py-1.5 odz-rounded-lg odz-bg-amber-50 odz-text-amber-700 odz-text-xs odz-font-medium odz-border odz-border-amber-100"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </span>'),Lj=Xp('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>'),Pj=Xp('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>',1),kj=ee('<button class="odz-btn odz-btn-outline odz-w-full odz-shadow-sm hover:odz-shadow-md odz-transition-all"><svg class="odz-w-4 odz-h-4 odz-mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg> </button>'),Oj=ee('<article class="odz-group odz-relative odz-flex odz-flex-col odz-overflow-hidden odz-bg-white odz-border odz-border-gray-200 odz-rounded-2xl odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)] odz-transition-all odz-duration-300 hover:odz-shadow-[0_12px_40px_rgba(0,0,0,0.12)] hover:odz-border-indigo-200"><div class="odz-absolute odz-top-4 odz-right-4 odz-z-10"><span><svg class="odz-w-2 odz-h-2 odz-fill-current svelte-1arj5vx" viewBox="0 0 8 8"><circle cx="4" cy="4" r="3" class="svelte-1arj5vx"></circle></svg> </span></div> <div class="odz-flex odz-flex-col lg:odz-flex-row"><div class="odz-flex odz-flex-1 odz-flex-col odz-p-6"><div class="odz-flex odz-items-start odz-gap-5 odz-mb-5"><div class="odz-relative odz-flex-shrink-0"><!> <!></div> <div class="odz-flex-1 odz-min-w-0 odz-pt-1"><h3 class="odz-text-xl odz-font-bold odz-text-slate-900 odz-mb-2 odz-line-clamp-2 odz-leading-tight"> </h3> <!> <div class="odz-flex odz-items-center odz-gap-2 odz-text-xs odz-text-gray-500"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> </div></div></div> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mb-5"><!> <!></div> <div class="odz-grid odz-grid-cols-2 odz-gap-4 odz-mb-5 odz-p-4 odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-50/50 odz-rounded-xl odz-border odz-border-gray-100"><div class="odz-flex odz-flex-col odz-gap-1"><span class="odz-text-xs odz-font-medium odz-text-gray-500 odz-uppercase odz-tracking-wide"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1"><span class="odz-text-xs odz-font-medium odz-text-gray-500 odz-uppercase odz-tracking-wide"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 odz-gap-3 odz-p-5 odz-bg-gradient-to-br odz-from-slate-50 odz-to-indigo-50/30 odz-rounded-xl odz-border odz-border-slate-200"><div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5 odz-col-span-2 sm:odz-col-span-1"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"> </span> <span class="odz-text-lg odz-font-bold odz-text-indigo-600"> </span></div></div></div> <div class="odz-flex odz-flex-col odz-gap-4 odz-p-6 odz-bg-gradient-to-br odz-from-slate-50 odz-to-gray-50 odz-border-t lg:odz-border-t-0 lg:odz-border-l odz-border-gray-200 lg:odz-w-56 odz-justify-between"><div class="odz-flex odz-flex-col odz-gap-2"><span class="odz-text-xs odz-font-medium odz-text-gray-500 odz-uppercase odz-tracking-wide"> </span> <button type="button"><svg class="odz-w-4 odz-h-4 svelte-1arj5vx" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" class="svelte-1arj5vx"></path></svg> </button></div> <div class="odz-flex odz-flex-col odz-gap-2.5"><button class="odz-btn odz-btn-primary odz-w-full odz-shadow-sm hover:odz-shadow-md odz-transition-all"><svg class="odz-w-4 odz-h-4 odz-mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><!></svg> </button> <!></div></div></div></article>'),Dj=ee('<div class="odz-flex odz-flex-col odz-gap-4"></div>'),Nj=ee('<label class="odz-label"><span class="odz-label-text-alt odz-text-error"> </span></label>'),Mj=ee('<div class="odz-fixed odz-inset-0 odz-flex odz-items-center odz-justify-center odz-bg-black odz-bg-opacity-50 odz-z-50"><div class="odz-bg-white odz-p-6 odz-rounded-lg odz-shadow-xl"><div class="odz-flex odz-flex-col odz-items-center"><span class="odz-loading odz-loading-spinner odz-loading-lg odz-mb-4"></span> <p class="odz-text-lg odz-font-medium">  ...</p> <p class="odz-text-sm odz-text-gray-500 odz-mt-2">  </p></div></div></div>'),Hj=ee('<div class="odz-w-full"><h2 class="odz-text-xl odz-font-bold odz-mb-4"> </h2> <!> <!> <!></div> <!> <dialog id="password_confirm_modal"><div class="odz-modal-box odz-max-w-sm"><h3 class="odz-font-bold odz-text-lg odz-mb-4">  </h3> <p class="odz-text-sm odz-mb-4">     .</p> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text"></span></label> <input type="password" placeholder=" "> <!></div> <div class="odz-modal-action"><button class="odz-btn odz-btn-outline"></button> <button class="odz-btn odz-btn-primary"></button></div></div> <div class="odz-modal-backdrop"></div></dialog> <!>',1);function jj(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Ls,"$shopStore",t),s=()=>Xr(sl,"$customerStore",t);let i=pt(e,"openEstimateModal",8,()=>{}),a=Ie([]),A=Ie(!0),d=Ie(null),c,u=Ie(!1),h=Ie(null),f=Ie(""),g=Ie(""),m=Ie(!1),y=Ie(!1),b=Ie(""),S=Ie(""),F=Ie(!1),k=Ie(!1),P=Ie(""),te=null,$=Ie(""),j=Ie(!1),J=null,we=Ie(null);const D={thumbnail:null,productNames:[],itemCount:0,totalQuantity:0};let N={};En(async()=>{try{if(l(m)){_(A,!0);try{const Te=await ft.from("estimates").select("*").eq("shop_id",o().id).is("customer_id",null).eq("sess",o().sess).neq("status","temp").order("created_at",{ascending:!1});if(Te.error)throw Te.error;_(a,Te.data||[]),s().mallType&&s().mallType.trim()!==""&&_(a,l(a).filter(_e=>_e.mall_type===s().mallType)),await pe(l(a))}catch(Te){console.error("    :",Te),_(a,[])}_(A,!1)}else{const Te=new Date,_e=new Date(Te);_e.setMonth(_e.getMonth()-1),_(b,se(_e)),_(S,se(Te)),_(F,!0);const{getEstimatesWithDateFilter:Ue}=await cs(async()=>{const{getEstimatesWithDateFilter:Me}=await Promise.resolve().then(()=>hv);return{getEstimatesWithDateFilter:Me}},void 0);_(a,await Ue(o().sess,o().customer_id,o().id,l(b),l(S))),await pe(l(a)),c=nB(o().sess,o().id,async Me=>{var je,At,ut,ht,Re,Xe;Me.eventType==="UPDATE"?((je=Me.new)==null?void 0:je.status)!=="temp"?(_(a,l(a).map(tt=>tt.id===Me.new.id?{...tt,...Me.new}:tt)),await V((At=Me.new)==null?void 0:At.id)):(_(a,l(a).filter(tt=>tt.id!==Me.new.id)),K((ut=Me.new)==null?void 0:ut.id)):Me.eventType==="INSERT"?((ht=Me.new)==null?void 0:ht.status)!=="temp"&&(_(a,[Me.new,...l(a)]),await V((Re=Me.new)==null?void 0:Re.id)):Me.eventType==="DELETE"&&(_(a,l(a).filter(tt=>tt.id!==Me.old.id)),K((Xe=Me.old)==null?void 0:Xe.id))},o().customer_id)}}catch(Te){_(d,Te.message||"     ."),N={}}finally{_(A,!1)}}),Eo(()=>{c&&c.unsubscribe()});function Z(Te){if(!Te)return"";const _e=new Date(Te);return`${_e.getFullYear()}-${String(_e.getMonth()+1).padStart(2,"0")}-${String(_e.getDate()).padStart(2,"0")}`}function se(Te){const _e=Te.getFullYear(),Ue=String(Te.getMonth()+1).padStart(2,"0"),Me=String(Te.getDate()).padStart(2,"0");return`${_e}-${Ue}-${Me}`}function ce(Te){const _e=new Date,Ue=se(_e);let Me=new Date(_e);switch(Te){case"1week":Me.setDate(Me.getDate()-7);break;case"1month":Me.setMonth(Me.getMonth()-1);break;case"6months":Me.setMonth(Me.getMonth()-6);break;case"1year":Me.setFullYear(Me.getFullYear()-1);break}_(b,se(Me)),_(S,Ue)}function re(Te){const _e=new Set;let Ue=null,Me=0,je=0;return(Te||[]).forEach((ut,ht)=>{var tt,rt;if(!ut)return;je+=1,Me+=ut.quantity||0;const Re=(tt=ut.product)==null?void 0:tt.title;Re&&_e.add(Re);const Xe=(rt=ut.product)==null?void 0:rt.thumbnail;!Ue&&Xe&&(Ue=Xe)}),{thumbnail:Ue,productNames:Array.from(_e),itemCount:je,totalQuantity:Me}}async function pe(Te){const _e=Te.map(Ue=>Ue.id).filter(Ue=>!!Ue);if(_e.length===0){N={};return}try{const{data:Ue,error:Me}=await ft.from("estimate_items").select(`
          estimate_id,
          idx,
          quantity,
          product:products(
            title,
            thumbnail
          )
        `).in("estimate_id",_e);if(Me){console.error("    :",Me);return}const je={};(Ue||[]).forEach(ut=>{ut!=null&&ut.estimate_id&&(je[ut.estimate_id]||(je[ut.estimate_id]=[]),je[ut.estimate_id].push(ut))});const At={};_e.forEach(ut=>{At[ut]=re(je[ut])}),N=At}catch(Ue){console.error("     :",Ue)}}async function V(Te){if(Te)try{const{data:_e,error:Ue}=await ft.from("estimate_items").select(`
          estimate_id,
          idx,
          quantity,
          product:products(
            title,
            thumbnail
          )
        `).eq("estimate_id",Te);if(Ue){console.error("[ERROR]      :",Ue),console.error("[ERROR] estimateId:",Te);return}const Me=re(_e);N={...N,[Te]:Me}}catch(_e){console.error("[ERROR]       :",_e),console.error("[ERROR] estimateId:",Te)}}function K(Te){if(!Te)return;const{[Te]:_e,...Ue}=N;N=Ue}function oe(Te){return Te&&N[Te]||D}function ae(Te){switch(Te){case"pending":return"";case"progress":return"";case"completed":return"";case"temp":return"";case"canceled":return"";case"hold":return"";default:return""}}function x(Te){switch(Te){case"pending":return"odz-bg-amber-100 odz-text-amber-700 odz-border-amber-200";case"progress":return"odz-bg-sky-100 odz-text-sky-700 odz-border-sky-200";case"completed":return"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200";case"canceled":return"odz-bg-rose-100 odz-text-rose-700 odz-border-rose-200";case"hold":case"temp":return"odz-bg-slate-200 odz-text-slate-600 odz-border-slate-300";default:return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200"}}function E(Te){switch(Te){case"none":return" ";case"waiting":return" ";case"processing":return" ";case"confirming":return" ";case"completed":return" ";case"rejected":return" ";default:return"-"}}function I(Te){switch(Te){case"none":return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200";case"waiting":return"odz-bg-sky-100 odz-text-sky-700 odz-border-sky-200";case"processing":return"odz-bg-indigo-100 odz-text-indigo-700 odz-border-indigo-200";case"confirming":return"odz-bg-purple-100 odz-text-purple-700 odz-border-purple-200";case"completed":return"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200";case"rejected":return"odz-bg-rose-100 odz-text-rose-700 odz-border-rose-200";default:return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200"}}function L(Te){_(h,Te),_(u,!0)}async function M(){if(!l(f)||!l(g)){_(d,"   .");return}_(A,!0),_(d,null),_(y,!0);try{_(a,await dB(o().id,l(f),l(g),null,s().mallType)),await pe(l(a)),l(a).length===0&&_(d,"    .")}catch(Te){_(d,Te.message||"    ."),_(a,[]),N={}}finally{_(A,!1)}}async function H(){if(!l(b)&&!l(S)){_(d,"   .");return}_(A,!0),_(d,null),_(F,!0);try{const{getEstimatesWithDateFilter:Te}=await cs(async()=>{const{getEstimatesWithDateFilter:_e}=await Promise.resolve().then(()=>hv);return{getEstimatesWithDateFilter:_e}},void 0);_(a,await Te(o().sess,o().customer_id,o().id,l(b),l(S))),await pe(l(a)),l(a).length===0&&_(d,"   .")}catch(Te){_(d,Te.message||"    ."),_(a,[]),N={}}finally{_(A,!1)}}async function q(){_(d,null);const Te=new Date,_e=new Date(Te);_e.setMonth(_e.getMonth()-1),_(b,se(_e)),_(S,se(Te)),_(F,!0),_(A,!0);try{const{getEstimatesWithDateFilter:Ue}=await cs(async()=>{const{getEstimatesWithDateFilter:Me}=await Promise.resolve().then(()=>hv);return{getEstimatesWithDateFilter:Me}},void 0);_(a,await Ue(o().sess,o().customer_id,o().id,l(b),l(S))),await pe(l(a))}catch(Ue){_(d,Ue.message||"     ."),N={}}finally{_(A,!1)}}function G(Te){l(m)&&Te.status==="pending"?(te=Te,_(P,""),_($,""),_(k,!0)):window.location.href=`?mode=register&estimateId=${Te.id}`}async function R(){if(!te||!l(P).trim()){_($," .");return}try{const{data:Te,error:_e}=await ft.from("estimates").select("id").eq("id",te.id).eq("password",l(P)).single();if(_e||!Te){_($,"  .");return}_(k,!1),i()(!0,te)}catch(Te){_($,"    ."),console.error("  :",Te)}}function he(){_(k,!1),_(P,""),_($,""),te=null}async function Be(Te){if(!(!Te||!Te.id))try{_(j,!0),_(we,Te.id);const _e=await cB(Te.id);let Ue=[..._e];const Me=await fB(Te.id);if((Me==null?void 0:Me.length)>0){const At=_e.length>0?Math.max(..._e.map(ht=>ht.idx||0)):0,ut=Me.map((ht,Re)=>({...ht,idx:At+Re+1,items:ht.items.map(Xe=>({...Xe,idx:At+Re+1}))}));Ue=[...Ue,...ut]}if(!Ue.some(At=>At.product&&At.product.mall_type==="godo5"&&At.product.mall_product_id)){alert("5    .");return}if(J=await wj(Ue),J.success){const At=J.submittedOrders.reduce((ut,ht)=>ut+ht.productIds.length,0);alert(` .  ${At}  .`)}else alert("  .   .")}catch(_e){console.error("    :",_e),alert("    : "+_e.message)}finally{_(j,!1)}}Zt(()=>o(),()=>{_(m,!o().customer_id)}),Zn(),qr();var be=Hj(),Le=gt(be),Y=z(w(Le),2);{var O=Te=>{var _e=Bj(),Ue=w(_e),Me=w(Ue),je=z(w(Me),2),At=w(je),ut=w(At),ht=z(w(ut),2),Re=z(ut,2),Xe=z(w(Re),2),tt=z(Re,2),rt=w(tt),Bt=z(rt,2);{var nt=Ct=>{var Ft=bj();He(()=>Ft.disabled=l(A)),at("click",Ft,q),T(Ct,Ft)};Se(Bt,Ct=>{l(F)&&Ct(nt)})}var ot=z(At,2),xt=w(ot),Lt=z(xt,2),_t=z(Lt,2),vt=z(_t,2),Pt=z(ot,2);{var kt=Ct=>{var Ft=_j(),zt=w(Ft);He(()=>Qe(zt,`*  ${l(b)||""} ~ ${l(S)||""}   `)),T(Ct,Ft)};Se(Pt,Ct=>{l(F)&&Ct(kt)})}He(()=>{rt.disabled=l(A),xt.disabled=l(A),Lt.disabled=l(A),_t.disabled=l(A),vt.disabled=l(A)}),br(ht,()=>l(b),Ct=>_(b,Ct)),br(Xe,()=>l(S),Ct=>_(S,Ct)),at("click",rt,H),at("click",xt,()=>ce("1week")),at("click",Lt,()=>ce("1month")),at("click",_t,()=>ce("6months")),at("click",vt,()=>ce("1year")),T(Te,_e)};Se(Y,Te=>{l(m)||Te(O)})}var ve=z(Y,2);{var xe=Te=>{var _e=xj(),Ue=w(_e),Me=w(Ue),je=z(w(Me),2),At=w(je),ut=w(At),ht=z(w(ut),2),Re=z(ut,2),Xe=z(w(Re),2),tt=z(Re,2),rt=w(tt);br(ht,()=>l(f),Bt=>_(f,Bt)),br(Xe,()=>l(g),Bt=>_(g,Bt)),at("click",rt,M),T(Te,_e)};Se(ve,Te=>{l(m)&&Te(xe)})}var me=z(ve,2);{var le=Te=>{var _e=zj();T(Te,_e)},ze=Te=>{var _e=Nt(),Ue=gt(_e);{var Me=At=>{var ut=Cj(),ht=w(ut),Re=w(ht);He(()=>Qe(Re,l(d))),T(At,ut)},je=At=>{var ut=Nt(),ht=gt(ut);{var Re=tt=>{var rt=Sj(),Bt=w(rt);{var nt=xt=>{var Lt=Wr("    .");T(xt,Lt)},ot=xt=>{var Lt=Nt(),_t=gt(Lt);{var vt=kt=>{var Ct=Wr("   .    .");T(kt,Ct)},Pt=kt=>{var Ct=Wr("  .");T(kt,Ct)};Se(_t,kt=>{l(m)?kt(vt):kt(Pt,!1)},!0)}T(xt,Lt)};Se(Bt,xt=>{l(m)&&l(y)?xt(nt):xt(ot,!1)})}T(tt,rt)},Xe=tt=>{var rt=Dj();Jt(rt,5,()=>l(a),Bt=>Bt.id??Bt.created_at,(Bt,nt)=>{var ot=Oj();const xt=it(()=>oe(l(nt).id)),Lt=it(()=>l(nt).design_confirm==="confirming"||l(nt).design_confirm==="completed");var _t=w(ot),vt=w(_t),Pt=z(w(vt)),kt=z(_t,2),Ct=w(kt),Ft=w(Ct),zt=w(Ft),Tt=w(zt);{var Rt=Qr=>{var Yr=Ej(),cn=gt(Yr);He(()=>{nr(cn,"src",l(xt).thumbnail),nr(cn,"alt",(l(nt).name||"")+"  ")}),B_(cn),at("error",cn,_s=>{_s.currentTarget.style.display="none";const ti=_s.currentTarget.nextElementSibling;ti&&(ti.style.display="flex")}),T(Qr,Yr)},Dt=Qr=>{var Yr=Fj();T(Qr,Yr)};Se(Tt,Qr=>{l(xt).thumbnail?Qr(Rt):Qr(Dt,!1)})}var Mt=z(Tt,2);{var Gt=Qr=>{var Yr=Ij(),cn=w(Yr);He(()=>Qe(cn,`${l(xt).totalQuantity??""}`)),T(Qr,Yr)};Se(Mt,Qr=>{l(xt).totalQuantity>0&&Qr(Gt)})}var lr=z(zt,2),tr=w(lr),sr=w(tr),Ht=z(tr,2);{var mr=Qr=>{var Yr=Uj(),cn=w(Yr),_s=z(cn);{var ti=Ds=>{var Fi=Wr();He(()=>Qe(Fi,` ${l(xt).productNames.length-1}`)),T(Ds,Fi)};Se(_s,Ds=>{l(xt).productNames.length>1&&Ds(ti)})}He(()=>Qe(cn,l(xt).productNames[0])),T(Qr,Yr)};Se(Ht,Qr=>{l(xt).productNames.length>0&&Qr(mr)})}var kr=z(Ht,2),Kr=z(w(kr)),Sr=z(Ft,2),fr=w(Sr);{var Lr=Qr=>{var Yr=Qj(),cn=z(w(Yr));He(()=>Qe(cn,` ${l(nt).estimate_no??""}`)),T(Qr,Yr)};Se(fr,Qr=>{l(nt).estimate_no&&Qr(Lr)})}var xr=z(fr,2);{var Ar=Qr=>{var Yr=Tj(),cn=z(w(Yr));He(_s=>Qe(cn,`  ${_s??""}`),[()=>Z(l(nt).pref_delivery_date)],it),T(Qr,Yr)};Se(xr,Qr=>{l(nt).pref_delivery_date&&Qr(Ar)})}var pr=z(Sr,2),Pr=w(pr),gn=z(w(Pr),2),vn=w(gn),zr=z(Pr,2),dr=z(w(zr),2),xn=w(dr),Fo=z(pr,2),io=w(Fo),bo=z(w(io),2),ns=w(bo),On=z(io,2),Io=z(w(On),2),Wt=w(Io),$r=z(On,2),Fn=z(w($r),2),ys=w(Fn),Uo=z($r,2),bs=z(w(Uo),2),eo=w(bs),ks=z(Ct,2),Ci=w(ks),Si=z(w(Ci),2),EA=z(w(Si)),or=z(Ci,2),on=w(or),Qo=w(on),Os=w(Qo);{var Ei=Qr=>{var Yr=Lj();T(Qr,Yr)},Qn=Qr=>{var Yr=Pj();T(Qr,Yr)};Se(Os,Qr=>{l(nt).status==="pending"?Qr(Ei):Qr(Qn,!1)})}var ei=z(Qo),Ta=z(on,2);{var yr=Qr=>{var Yr=kj(),cn=z(w(Yr));He(()=>{Yr.disabled=l(j)||l(we)===l(nt).id,Qe(cn,` ${(l(j)&&l(we)===l(nt).id?"...":"")??""}`)}),at("click",Yr,()=>Be(l(nt))),T(Qr,Yr)};Se(Ta,Qr=>{l(nt).status==="completed"&&Qr(yr)})}He((Qr,Yr,cn,_s,ti,Ds,Fi,sc,ic)=>{Ir(vt,`${Qr??""} svelte-1arj5vx`),Qe(Pt,` ${Yr??""}`),Qe(sr,l(nt).name||"  "),Qe(Kr,` ${cn??""}`),Qe(vn,l(nt).organization_name||"-"),Qe(xn,l(nt).order_name||"-"),Qe(ns,_s),Qe(Wt,ti),Qe(ys,Ds),Qe(eo,Fi),Ir(Si,`${sc??""} svelte-1arj5vx`),Si.disabled=!l(Lt),Qe(EA,` ${ic??""}`),Qe(ei,` ${(l(nt).status==="pending"?"":"")??""}`)},[()=>`odz-inline-flex odz-items-center odz-gap-1.5 odz-rounded-full odz-px-3.5 odz-py-1.5 odz-text-xs odz-font-semibold odz-shadow-sm odz-backdrop-blur-sm ${x(l(nt).status)}`,()=>ae(l(nt).status),()=>Z(l(nt).created_at),()=>l(nt).product_amount!==null&&l(nt).product_amount!==void 0?`${vr(l(nt).product_amount)}`:"-",()=>l(nt).print_amount!==null&&l(nt).print_amount!==void 0?`${vr(l(nt).print_amount)}`:"-",()=>l(nt).addon_amount!==null&&l(nt).addon_amount!==void 0?`${vr(l(nt).addon_amount)}`:"-",()=>l(nt).total_amount!==null&&l(nt).total_amount!==void 0?`${vr(l(nt).total_amount)}`:"-",()=>`odz-inline-flex odz-items-center odz-justify-center odz-gap-2 odz-px-4 odz-py-2.5 odz-rounded-lg odz-text-sm odz-font-semibold odz-transition-all odz-duration-200 ${I(l(nt).design_confirm)} ${l(Lt)?"hover:odz-shadow-md hover:odz-scale-105":"odz-opacity-60 odz-cursor-not-allowed"}`,()=>E(l(nt).design_confirm)],it),at("click",Si,()=>{l(Lt)&&L(l(nt).id)}),at("click",on,()=>G(l(nt))),T(Bt,ot)}),T(tt,rt)};Se(ht,tt=>{l(a).length===0?tt(Re):tt(Xe,!1)},!0)}T(At,ut)};Se(Ue,At=>{l(d)?At(Me):At(je,!1)},!0)}T(Te,_e)};Se(me,Te=>{l(A)?Te(le):Te(ze,!1)})}var ke=z(Le,2);{var de=Te=>{var _e=Nt(),Ue=gt(_e);Q4(Ue,()=>l(h),Me=>{GM(Me,{get estimateId(){return l(h)},get isOpen(){return l(u)},set isOpen(je){_(u,je)},$$legacy:!0})}),T(Te,_e)};Se(ke,Te=>{l(h)&&Te(de)})}var Fe=z(ke,2),U=w(Fe),Ae=z(w(U),4),fe=z(w(Ae),2),Ce=z(fe,2);{var ge=Te=>{var _e=Nj(),Ue=w(_e),Me=w(Ue);He(()=>Qe(Me,l($))),T(Te,_e)};Se(Ce,Te=>{l($)&&Te(ge)})}var De=z(Ae,2),Ne=w(De),Ze=z(Ne,2),Oe=z(U,2),Ke=z(Fe,2);{var Je=Te=>{var _e=Mj();T(Te,_e)};Se(Ke,Te=>{l(j)&&Te(Je)})}He(()=>{Ir(Fe,`odz-modal ${(l(k)?"odz-modal-open":"")??""}`),Ir(fe,`odz-input odz-input-bordered odz-w-full ${(l($)?"odz-input-error":"")??""}`)}),br(fe,()=>l(P),Te=>_(P,Te)),at("keydown",fe,Te=>{Te.key==="Enter"&&R()}),at("click",Ne,he),at("click",Ze,R),at("click",Oe,he),T(n,be),jr(),r()}var Rj=ee('<div class="odz-text-sm odz-text-gray-600 odz-leading-relaxed"> </div>'),qj=ee('<div class="odz-mb-8"><h3 class="odz-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200"> </h3> <div class="odz-flex odz-justify-between odz-items-start odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-p-4"><div class="odz-flex-1"><div class="odz-text-base odz-font-semibold odz-text-gray-800 odz-mb-1"> </div> <!></div> <div class="odz-text-lg odz-font-bold odz-text-gray-900 odz-ml-4"> </div></div></div>'),Kj=ee('<div class="odz-bg-white odz-border odz-border-gray-300 odz-rounded odz-px-2 odz-py-1 odz-text-xs odz-text-gray-700"> </div>'),$j=ee('<div class="odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-px-4 odz-py-3 odz-flex-shrink-0"><div class="odz-text-sm odz-font-semibold odz-text-gray-800 odz-mb-2"> </div> <div class="odz-flex odz-flex-wrap odz-gap-1"></div></div>'),Vj=ee('<div class="odz-text-xs odz-text-blue-600 odz-mt-1"><!></div>'),Gj=ee('<div class="odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-md odz-p-3 odz-mb-3"><div class="odz-flex odz-justify-between odz-items-center odz-mb-2"><div class="odz-flex odz-items-center odz-gap-2"><svg class="odz-w-5 odz-h-5 odz-text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="odz-font-medium odz-text-blue-700">  </span></div> <div class="odz-text-right"><div class="odz-text-xs odz-text-gray-500 odz-line-through"> </div> <div class="odz-text-sm odz-font-semibold odz-text-red-600"> </div></div></div> <!></div>'),Wj=ee('<div class="odz-mb-8"><h3 class="odz-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-3 odz-mb-4"></div> <div class="odz-text-sm odz-text-gray-600 odz-mb-2 odz-text-right"> </div> <!> <div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-100 odz-border odz-border-gray-200 odz-rounded-md odz-p-3"><span class="odz-font-medium odz-text-gray-700"> </span> <span class="odz-font-semibold odz-text-gray-900"> </span></div></div>'),Xj=ee('<span class="odz-w-6 odz-h-6 odz-rounded-full odz-border-2 odz-border-white odz-shadow-sm"></span>'),Yj=ee('<div class="odz-bg-gray-50 odz-rounded-lg odz-p-4"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3"><svg class="odz-w-4 odz-h-4 odz-text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-gray-700"> </span></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-gap-1"></div> <div class="odz-text-sm odz-text-gray-800"> </div></div></div>'),Jj=ee('<div class="odz-bg-white odz-border odz-border-gray-100 odz-rounded-xl odz-p-5 odz-shadow-sm odz-hover:shadow-md odz-transition-all odz-duration-200"><div class="odz-flex odz-items-center odz-justify-between odz-mb-4"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-w-8 odz-h-8 odz-bg-blue-100 odz-text-blue-600 odz-rounded-full odz-flex odz-items-center odz-justify-center odz-text-sm odz-font-semibold"></div> <span class="odz-font-medium odz-text-gray-900"> </span></div> <div class="odz-text-right"><div class="odz-text-lg odz-font-bold odz-text-gray-900"> </div></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-4"><!> <div class="odz-bg-gray-50 odz-rounded-lg odz-p-4"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3"><svg class="odz-w-4 odz-h-4 odz-text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-gray-700"> </span></div> <div class="odz-text-sm odz-text-gray-800 odz-leading-relaxed"> </div></div></div></div>'),Zj=ee('<div class="odz-mb-8"><h3 class="odz-text-xl odz-font-semibold odz-text-gray-800 odz-mb-6"> </h3> <div class="odz-space-y-4"></div></div>'),eR=ee('<span class="odz-text-gray-600"> </span>'),tR=ee('<div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-p-4"><div class="odz-flex-1"><div class="odz-font-medium odz-text-gray-800 odz-mb-1"> <!></div> <div class="odz-text-sm odz-text-gray-600"> </div></div> <div class="odz-font-semibold odz-text-gray-900"> </div></div>'),rR=ee('<div class="odz-mb-8"><h3 class="odz-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200"> </h3> <div class="odz-flex odz-flex-col odz-gap-3 odz-mb-4"></div> <div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-100 odz-border odz-border-gray-200 odz-rounded-md odz-p-3"><span class="odz-font-medium odz-text-gray-700"> </span> <span class="odz-font-semibold odz-text-gray-900"> </span></div></div>'),nR=ee("<!> <!> <!>",1),oR=ee('<div class="odz-fixed odz-inset-0 odz-z-50 odz-flex odz-items-center odz-justify-center odz-p-4 odz-animate-in odz-fade-in odz-duration-300"><div class="odz-fixed odz-inset-0 odz-bg-black odz-bg-opacity-60 odz-backdrop-blur-sm odz-cursor-pointer"></div> <div class="odz-relative odz-bg-white odz-rounded-xl odz-shadow-2xl odz-max-w-2xl odz-max-h-[90vh] odz-w-full odz-overflow-hidden odz-flex odz-flex-col odz-animate-in odz-zoom-in-95 odz-slide-in-from-bottom-4 odz-duration-300 odz-cursor-default"><div class="odz-flex odz-justify-between odz-items-center odz-p-6 odz-border-b odz-border-gray-200 odz-bg-gradient-to-r odz-from-slate-50 odz-to-slate-100 odz-sticky odz-top-0 odz-z-10"><h2 class="odz-text-2xl odz-font-bold odz-text-gray-900">  </h2> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-hover:odz-bg-gray-100 odz-transition-all odz-duration-200"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="odz-flex-1 odz-overflow-y-auto odz-p-6"><!> <div class="odz-border-t-2 odz-border-gray-200 odz-pt-6 odz-mt-6"><div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-900 odz-rounded-lg odz-p-4"><span class="odz-text-lg odz-font-semibold odz-text-white"> </span> <span class="odz-text-2xl odz-font-bold odz-text-white"> </span></div></div></div></div></div>');function sR(n,e){Hr(e,!1);let t=pt(e,"estimateDetails",8),r=pt(e,"productAmount",8);pt(e,"printAmount",8);let o=pt(e,"addonAmount",8),s=pt(e,"totalAmount",8),i=pt(e,"printInfoList",8),a=pt(e,"addonItems",8),A=pt(e,"addCostItems",8,null),d=pt(e,"isAddCost",8,!1),c=pt(e,"addonProductsMap",24,()=>({}));const u=Yp();let h=Ie([]);function f(){if(!t()||!t().items||t().items.length===0)return;const pe=new Map;t().items.forEach(K=>{const ae=(K.variant||{}).title||K.variant_title||" ",x=ae.match(/(.+)\s*-\s*(.+)/),E=x?x[1]:ae,I=x?x[2]:"";pe.has(E)||pe.set(E,{name:E,sizes:new Map});const L=pe.get(E);L.sizes.has(I)||L.sizes.set(I,{size:I,quantity:0});const M=L.sizes.get(I);M.quantity+=K.quantity||1}),_(h,Array.from(pe.values()).map(K=>({name:K.name,sizes:Array.from(K.sizes.values())}))),_(h,l(h).filter(K=>K.name!==""));const V=new Set;l(h).forEach(K=>{K.sizes.forEach(oe=>{V.add(oe.size)})}),Array.from(V)}function g(pe){return`background-color: ${pe.hex};`}function m(pe,V){const K=[];if(pe&&K.push(`: ${pe}`),V&&V.length>0){const oe=V.map(ae=>ae.name).join(" > ");K.push(`: ${oe}`)}return K.length>0?K.join(" | "):" "}function y(){return A()&&A().amount||0}function b(){u("close")}Zt(()=>zn(t()),()=>{t()&&f()}),Zn(),qr();var S=oR(),F=w(S),k=z(F,2),P=w(k),te=z(w(P),2),$=z(P,2),j=w($);{var J=pe=>{var V=qj(),K=z(w(V),2),oe=w(K),ae=w(oe),x=w(ae),E=z(ae,2);{var I=H=>{var q=Rj(),G=w(q);He(()=>Qe(G,A().description)),T(H,q)};Se(E,H=>{A().description&&H(I)})}var L=z(oe,2),M=w(L);He(H=>{Qe(x,A().name),Qe(M,`${H??""}`)},[()=>A().amount.toLocaleString()],it),T(pe,V)},we=pe=>{var V=Nt(),K=gt(V);{var oe=ae=>{var x=nR(),E=gt(x);{var I=G=>{var R=Wj(),he=z(w(R),2);Jt(he,5,()=>l(h),ar,(me,le)=>{var ze=$j(),ke=w(ze),de=w(ke),Fe=z(ke,2);Jt(Fe,5,()=>l(le).sizes,ar,(U,Ae)=>{var fe=Kj(),Ce=w(fe);He(()=>Qe(Ce,`${l(Ae).size??""}: ${l(Ae).quantity??""}`)),T(U,fe)}),He(()=>Qe(de,l(le).name)),T(me,ze)});var Be=z(he,2),be=w(Be),Le=z(Be,2);{var Y=me=>{var le=Gj();const ze=it(()=>t().items.reduce((Ne,Ze)=>Ne+(Ze.discount_amount||0)*(Ze.quantity||0),0)),ke=it(()=>t().items.find(Ne=>Ne.discount_amount&&Ne.discount_amount>0));var de=w(le),Fe=z(w(de),2),U=w(Fe),Ae=w(U),fe=z(U,2),Ce=w(fe),ge=z(de,2);{var De=Ne=>{var Ze=Vj(),Oe=w(Ze);{var Ke=Te=>{var _e=Wr();He(Ue=>Qe(_e,`${l(ke).discount_value??""}%  ( ${Ue??""})`),[()=>(l(ke).discount_amount||0).toLocaleString()],it),T(Te,_e)},Je=Te=>{var _e=Wr();He(Ue=>Qe(_e,` ${Ue??""} `),[()=>l(ke).discount_value.toLocaleString()],it),T(Te,_e)};Se(Oe,Te=>{l(ke).discount_type==="percentage"?Te(Ke):Te(Je,!1)})}T(Ne,Ze)};Se(ge,Ne=>{l(ke)&&l(ke).discount_type&&l(ke).discount_value&&Ne(De)})}He((Ne,Ze)=>{Qe(Ae,`${Ne??""}`),Qe(Ce,`-${Ze??""}`)},[()=>t().items.reduce((Ne,Ze)=>Ne+(Ze.original_price||Ze.price||0)*(Ze.quantity||0),0).toLocaleString(),()=>l(ze).toLocaleString()],it),T(me,le)};Se(Le,me=>{t().items&&t().items.some(le=>le.discount_amount&&le.discount_amount>0)&&me(Y)})}var O=z(Le,2),ve=z(w(O),2),xe=w(ve);He((me,le)=>{Qe(be,` : ${me??""}`),Qe(xe,`${le??""}`)},[()=>l(h).reduce((me,le)=>me+le.sizes.reduce((ze,ke)=>ze+ke.quantity,0),0),()=>r().toLocaleString()],it),T(G,R)};Se(E,G=>{l(h).length>0&&G(I)})}var L=z(E,2);{var M=G=>{var R=Zj(),he=z(w(R),2);Jt(he,5,i,ar,(Be,be,Le)=>{var Y=Jj(),O=w(Y),ve=w(O),xe=w(ve);xe.textContent=Le+1;var me=z(ve,2),le=w(me),ze=w(le),ke=z(O,2),de=w(ke);{var Fe=Ce=>{var ge=Yj(),De=z(w(ge),2),Ne=w(De);Jt(Ne,5,()=>l(be).colorInfo,ar,(Ke,Je)=>{var Te=Xj();He(_e=>{nr(Te,"style",_e),nr(Te,"title",l(Je).name)},[()=>g(l(Je))],it),T(Ke,Te)});var Ze=z(Ne,2),Oe=w(Ze);He(Ke=>Qe(Oe,Ke),[()=>l(be).colorInfo.map(Ke=>Ke.name).join(", ")],it),T(Ce,ge)};Se(de,Ce=>{l(be).colorInfo&&l(be).colorInfo.length>0&&Ce(Fe)})}var U=z(de,2),Ae=z(w(U),2),fe=w(Ae);He((Ce,ge)=>{Qe(ze,`${Ce??""}`),Qe(fe,ge)},[()=>l(be).price.toLocaleString(),()=>m(l(be).printAreaTitle,l(be).parentTemplates)],it),T(Be,Y)}),T(G,R)};Se(L,G=>{i().length>0&&G(M)})}var H=z(L,2);{var q=G=>{var R=rR(),he=z(w(R),2);Jt(he,5,a,ar,(Y,O)=>{var ve=tR();const xe=it(()=>`${l(O).selected_product_id}_${l(O).selected_variant_id}`),me=it(()=>c()[l(xe)]);var le=w(ve),ze=w(le),ke=w(ze),de=z(ke);{var Fe=ge=>{var De=eR(),Ne=w(De);He(()=>Qe(Ne,`- ${l(me).variantTitle??""}`)),T(ge,De)};Se(de,ge=>{var De;(De=l(me))!=null&&De.variantTitle&&ge(Fe)})}var U=z(ze,2),Ae=w(U),fe=z(le,2),Ce=w(fe);He(ge=>{var De;Qe(ke,`${((De=l(me))==null?void 0:De.productTitle)||""} `),Qe(Ae,`${l(O).quantity??""}`),Qe(Ce,`${ge??""}`)},[()=>(l(O).price*l(O).quantity).toLocaleString()],it),T(Y,ve)});var Be=z(he,2),be=z(w(Be),2),Le=w(be);He(Y=>Qe(Le,`${Y??""}`),[()=>o().toLocaleString()],it),T(G,R)};Se(H,G=>{a().length>0&&G(q)})}T(ae,x)};Se(K,ae=>{t()&&t().estimate&&ae(oe)},!0)}T(pe,V)};Se(j,pe=>{d()&&A()?pe(J):pe(we,!1)})}var D=z(j,2),N=w(D),Z=w(N),se=w(Z),ce=z(Z,2),re=w(ce);He(pe=>{Qe(se,d()?" ":" "),Qe(re,`${pe??""}`)},[()=>d()?y().toLocaleString():s().toLocaleString()],it),at("click",F,b),at("click",te,b),T(n,S),jr()}var iR=ee('<p class="odiz-loading"> ...</p>'),aR=ee('<p class="odiz-error"> </p>'),AR=ee('<div class="odiz-addcost-description"> </div>'),lR=ee('<div class="odiz-addcost-detailed"><div class="odiz-addcost-header"><h3 class="odiz-addcost-title"> </h3></div> <div class="odiz-addcost-items"><div class="odiz-addcost-item"><div class="odiz-addcost-info"><div class="odiz-addcost-name"> </div> <!></div> <div class="odiz-addcost-amount"> </div></div></div> <div class="odiz-divider"></div> <div class="odiz-total-price"><div class="odiz-price-label"> </div> <div class="odiz-price-value odiz-total-value"> </div></div></div>'),dR=ee('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value"><!></span></div>'),cR=ee('<span class="odz-color-dot-compact"></span>'),uR=ee('<span class="odz-color-count"> </span>'),hR=ee('<span class="odz-color-dots-compact"><!> <!></span>'),fR=ee('<span class="odz-print-area-compact"> </span>'),pR=ee("<!> <!>",1),gR=ee('<span class="odz-print-count"> </span>'),vR=ee('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value odz-print-inline"><!> <!></span></div>'),mR=ee('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value"> </span></div>'),wR=ee('<div class="odiz-estimate-detailed"><div class="odz-estimate-summary"><div class="odz-summary-content"><!> <!> <!></div> <div class="odz-summary-actions"><button class="odz-detail-btn" type="button">  </button></div></div> <div class="odz-price-summary"><div class="odz-price-label"></div> <div class="odz-price-value"><span class="odz-text-lg odz-font-bold"> </span></div></div></div>'),yR=ee('<p class="odiz-empty">  .</p>'),bR=ee('<div class="odiz-estimate-preview"><!></div> <!>',1);function _R(n,e){Hr(e,!1);let t=pt(e,"uuid",8),r=pt(e,"idx",8);pt(e,"appType",8);let o=pt(e,"isAddCost",8),s=Ie(!0),i=Ie(null),a=Ie(null),A=Ie(0),d=Ie(0),c=Ie(0),u=Ie(0),h=Ie([]),f=Ie([]),g=Ie(null),m=Ie({}),y=Ie([]),b=Ie(!1);async function S(){var re,pe;_(m,{});for(const V of l(f)){const K=`${V.selected_product_id}_${V.selected_variant_id}`;if(!l(m)[K])try{if(V.selected_variant_id){const oe=await mA(V.selected_variant_id);if(oe){const{data:ae}=await ft.from("products").select("id, title").eq("id",V.selected_product_id).single();hr(m,l(m)[K]={productTitle:(ae==null?void 0:ae.title)||"",variantTitle:oe.title||"",price:((pe=(re=oe.prices)==null?void 0:re[0])==null?void 0:pe.amount)||0})}}else{const{data:oe}=await ft.from("products").select("id, title").eq("id",V.selected_product_id).single();hr(m,l(m)[K]={productTitle:(oe==null?void 0:oe.title)||"",variantTitle:null,price:V.price||0})}}catch{hr(m,l(m)[K]={productTitle:"",variantTitle:null,price:V.price||0})}}}async function F(){try{_(s,!0),_(i,null),_(a,await A1(t()));const re=await eg(t());if(o()&&(_(g,await uB(r())),console.log("addCostItems",l(g))),l(a)){hr(a,l(a).items=l(a).items.filter(V=>{var K;return((K=V.idx)==null?void 0:K.toString())===r()}));const pe=l(a).prints.filter(V=>{var K;return((K=V.idx)==null?void 0:K.toString())===r()});hr(a,l(a).prints=l(a).prints.filter(V=>{var K;return((K=V.idx)==null?void 0:K.toString())===r()})),_(f,re.filter(V=>{var K;return((K=V.idx)==null?void 0:K.toString())===r()})),await S(),P(),k(),_(h,[]);for(const V of pe){const K={id:V.id||0,price:V.price||0,templateId:V.template_id,objectId:V.object_id,colorInfo:[]};try{if(V.template_id&&(console.log("template_id:",V.template_id),K.parentTemplates=await Ru(V.template_id),console.log("template_id   :",K.parentTemplates)),V.object_id){console.log("object_id:",V.object_id);const oe=await f1(V.object_id);oe&&(K.printAreaTitle=oe.title,console.log(" :",oe.title))}}catch(oe){console.error("    :",oe)}if(V.colors)try{let oe=null;if(typeof V.colors=="string"?oe=JSON.parse(V.colors):oe=V.colors,Array.isArray(oe)){let ae=[];if(oe.length>0&&Array.isArray(oe[0]))for(const x of oe)Array.isArray(x)&&(ae=ae.concat(x));else ae=oe;ae.length>0&&(typeof ae[0]=="object"&&ae[0]!==null?K.colorInfo=ae:K.colorInfo=ae.map(x=>({hex:x,name:x})))}console.log("  :",K.colorInfo)}catch(oe){console.error("    :",oe)}l(h).push(K)}console.log("   :",l(h))}}catch(re){console.error("    :",re),_(i,"     .")}finally{_(s,!1)}}function k(){if(!l(a)||!l(a).items||l(a).items.length===0)return;const re=new Map;l(a).items.forEach(V=>{const oe=(V.variant||{}).title||V.variant_title||" ",ae=oe.match(/(.+)\s*-\s*(.+)/),x=ae?ae[1]:oe,E=ae?ae[2]:"";re.has(x)||re.set(x,{name:x,sizes:new Map});const I=re.get(x);I.sizes.has(E)||I.sizes.set(E,{size:E,quantity:0});const L=I.sizes.get(E);L.quantity+=V.quantity||1}),_(y,Array.from(re.values()).map(V=>({name:V.name,sizes:Array.from(V.sizes.values())}))),_(y,l(y).filter(V=>V.name!==""));const pe=new Set;l(y).forEach(V=>{V.sizes.forEach(K=>{pe.add(K.size)})}),Array.from(pe)}function P(){if(l(a)){_(A,0),_(d,0),_(c,0);for(const re of l(a).items)re.quantity&&re.price&&_(A,l(A)+re.quantity*re.price);for(const re of l(a).prints)re.price&&_(d,l(d)+re.price);for(const re of l(f))re.price&&re.quantity&&_(c,l(c)+re.price*re.quantity);_(u,l(A)+l(d)+l(c))}}function te(){return l(g)&&l(g).amount||0}En(()=>{F()});function $(){_(b,!0)}function j(){_(b,!1)}qr();var J=bR(),we=gt(J),D=w(we);{var N=re=>{var pe=iR();T(re,pe)},Z=re=>{var pe=Nt(),V=gt(pe);{var K=ae=>{var x=aR(),E=w(x);He(()=>Qe(E,l(i))),T(ae,x)},oe=ae=>{var x=Nt(),E=gt(x);{var I=M=>{var H=lR(),q=z(w(H),2),G=w(q),R=w(G),he=w(R),Be=w(he),be=z(he,2);{var Le=le=>{var ze=AR(),ke=w(ze);He(()=>Qe(ke,l(g).description)),T(le,ze)};Se(be,le=>{l(g).description&&le(Le)})}var Y=z(R,2),O=w(Y),ve=z(q,4),xe=z(w(ve),2),me=w(xe);He((le,ze)=>{Qe(Be,l(g).name),Qe(O,`${le??""}`),Qe(me,`${ze??""}`)},[()=>l(g).amount.toLocaleString(),()=>te().toLocaleString()],it),T(M,H)},L=M=>{var H=Nt(),q=gt(H);{var G=he=>{var Be=wR(),be=w(Be),Le=w(be),Y=w(Le);{var O=fe=>{var Ce=dR(),ge=z(w(Ce),2),De=w(ge);{var Ne=Oe=>{var Ke=Wr();He(Je=>Qe(Ke,`${l(y)[0].name??""} (${Je??""})`),[()=>l(y).reduce((Je,Te)=>Je+Te.sizes.reduce((_e,Ue)=>_e+Ue.quantity,0),0)],it),T(Oe,Ke)},Ze=Oe=>{var Ke=Wr();He(Je=>Qe(Ke,`${l(y)[0].name??""}  ${l(y).length-1} (${Je??""})`),[()=>l(y).reduce((Je,Te)=>Je+Te.sizes.reduce((_e,Ue)=>_e+Ue.quantity,0),0)],it),T(Oe,Ke)};Se(De,Oe=>{l(y).length===1?Oe(Ne):Oe(Ze,!1)})}T(fe,Ce)};Se(Y,fe=>{l(y).length>0&&fe(O)})}var ve=z(Y,2);{var xe=fe=>{var Ce=vR(),ge=z(w(Ce),2),De=w(ge);Jt(De,1,()=>l(h).slice(0,1),ar,(Oe,Ke)=>{var Je=pR(),Te=gt(Je);{var _e=je=>{var At=hR(),ut=w(At);Jt(ut,1,()=>l(Ke).colorInfo.slice(0,3),ar,(Xe,tt)=>{var rt=cR();He(()=>{nr(rt,"style",`background-color: ${l(tt).hex??""};`),nr(rt,"title",l(tt).name)}),T(Xe,rt)});var ht=z(ut,2);{var Re=Xe=>{var tt=uR(),rt=w(tt);He(()=>Qe(rt,`+${l(Ke).colorInfo.length-3}`)),T(Xe,tt)};Se(ht,Xe=>{l(Ke).colorInfo.length>3&&Xe(Re)})}T(je,At)};Se(Te,je=>{l(Ke).colorInfo&&l(Ke).colorInfo.length>0&&je(_e)})}var Ue=z(Te,2);{var Me=je=>{var At=fR(),ut=w(At);He(()=>Qe(ut,l(Ke).printAreaTitle)),T(je,At)};Se(Ue,je=>{l(Ke).printAreaTitle&&je(Me)})}T(Oe,Je)});var Ne=z(De,2);{var Ze=Oe=>{var Ke=gR(),Je=w(Ke);He(()=>Qe(Je,` ${l(h).length-1}`)),T(Oe,Ke)};Se(Ne,Oe=>{l(h).length>1&&Oe(Ze)})}T(fe,Ce)};Se(ve,fe=>{l(h).length>0&&fe(xe)})}var me=z(ve,2);{var le=fe=>{var Ce=mR(),ge=z(w(Ce),2),De=w(ge);He(()=>Qe(De,`${l(f).length??""}`)),T(fe,Ce)};Se(me,fe=>{l(f).length>0&&fe(le)})}var ze=z(Le,2),ke=w(ze),de=z(be,2),Fe=z(w(de),2),U=w(Fe),Ae=w(U);He(fe=>Qe(Ae,`${fe??""}`),[()=>l(u).toLocaleString()],it),at("click",ke,$),T(he,Be)},R=he=>{var Be=yR();T(he,Be)};Se(q,he=>{l(a)&&l(a).estimate?he(G):he(R,!1)},!0)}T(M,H)};Se(E,M=>{o()&&l(g)?M(I):M(L,!1)},!0)}T(ae,x)};Se(V,ae=>{l(i)?ae(K):ae(oe,!1)},!0)}T(re,pe)};Se(D,re=>{l(s)?re(N):re(Z,!1)})}var se=z(we,2);{var ce=re=>{sR(re,{get estimateDetails(){return l(a)},get productAmount(){return l(A)},get printAmount(){return l(d)},get addonAmount(){return l(c)},get totalAmount(){return l(u)},get printInfoList(){return l(h)},get addonItems(){return l(f)},get addCostItems(){return l(g)},get isAddCost(){return o()},get addonProductsMap(){return l(m)},$$events:{close:j}})};Se(se,re=>{l(b)&&l(a)&&re(ce)})}T(n,J),jr()}var BR=ee('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),xR=ee('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div> <button class="odz-mt-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-px-4 odz-py-2 odz-rounded-lg odz-text-sm"> </button></div>'),zR=ee('<span class="odz-text-red-500 odz-ml-2"> </span>'),CR=ee('<div class="odz-text-sm odz-text-gray-600"> <!></div>'),SR=ee('<div class="odz-absolute -odz-top-1 -odz-right-1 odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div>'),ER=ee("<img> <!>",1),FR=ee('<div class="odz-flex odz-items-center odz-gap-1 odz-bg-red-100 odz-px-2 odz-py-1 odz-rounded-full"><span class="odz-text-xs odz-font-medium odz-text-red-600"> </span></div>'),IR=ee('<button><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-relative odz-flex-shrink-0"><!></div> <span> </span> <div class="odz-flex odz-items-center odz-gap-2 odz-flex-shrink-0"><!> <div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18 6-6-6-6"></path></svg></div></div></div></button>'),UR=ee('<div><h3 class="odz-font-bold odz-text-lg odz-mb-4 odz-text-gray-800"> </h3> <div class="odz-grid odz-grid-cols-1 sm:odz-grid-cols-2 lg:odz-grid-cols-4 xl:odz-grid-cols-5 odz-gap-3"></div></div>'),QR=ee('<div class="odz-relative"><img class="odz-w-12 odz-h-12 odz-rounded-lg odz-object-cover odz-shadow-md odz-ring-2 odz-ring-white"></div>'),TR=ee('<div class="odz-absolute -odz-top-2 -odz-right-2"><div class="odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center odz-shadow-lg"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div>'),LR=ee('<span class="odz-text-sm odz-font-semibold odz-text-gray-700"> </span>'),PR=ee(`<div class="odz-group odz-relative"><div><!> <div class="odz-text-center odz-mb-3"><div> </div> <div class="odz-mt-2 odz-min-h-[2rem] odz-flex odz-flex-col odz-items-center odz-justify-center"><!></div></div> <div class="odz-flex odz-items-center odz-bg-gray-50 odz-rounded-lg odz-p-1 odz-gap-1"><button aria-label=" "><svg class="odz-w-3 odz-h-3 sm:odz-w-4 sm:odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg></button> <input type="number" class="odz-flex-1 odz-text-center odz-bg-transparent odz-border-0 odz-text-xs sm:odz-text-sm odz-font-bold odz-text-gray-800
                                                           focus:odz-outline-none focus:odz-ring-0 odz-min-w-0" min="0" placeholder="0"> <button class="odz-flex odz-items-center odz-justify-center odz-w-7 odz-h-7 sm:odz-w-8 sm:odz-h-8 odz-bg-white odz-rounded-md odz-shadow-sm
                                                           odz-text-gray-600 hover:odz-text-red-500 hover:odz-bg-red-50 odz-transition-colors odz-duration-150 hover:odz-scale-110" aria-label=" "><svg class="odz-w-3 odz-h-3 sm:odz-w-4 sm:odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path></svg></button></div></div></div>`),kR=ee('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div>'),OR=ee('<div class="odz-text-center odz-py-8"><svg class="odz-w-12 odz-h-12 odz-text-gray-400 odz-mx-auto odz-mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg> <p class="odz-text-sm odz-text-gray-500">     .</p></div>'),DR=ee('<div class="odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-100 odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-gap-4 odz-mb-6"><!> <div><h4 class="odz-text-xl odz-font-bold odz-text-gray-800"> </h4> <p class="odz-text-sm odz-text-gray-600">  </p></div></div> <!></div>'),NR=ee('<div class="odz-space-y-6 odz-mt-6"></div>'),MR=ee('<div class="odz-card odz-card-side odz-bg-base-100 odz-border odz-rounded odz-p-3"><figure><img class="odz-max-h-24 odz-border"></figure> <div class="odz-card-body"><h2 class="odz-card-title odz-text-base"> </h2> <!></div></div> <!> <!> <!>',1),HR=ee('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><!></div> <!>',1);function jR(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(ur,"$fixedEstimateStore",t),s=()=>Xr(Et,"$estimateStore",t),i=()=>Xr(Ls,"$shopStore",t),a=Ie();let A=pt(e,"productId",8),d=pt(e,"estimateId",8,void 0),c=pt(e,"idx",8,void 0),u=pt(e,"onNext",8,void 0),h=Ie(null),f=Ie(!1),g=Ie(null),m=Ie(!1),y=Ie(""),b=Ie(""),S=Ie([]),F=Ie({}),k=Ie({}),P=Ie({}),te=Ie(0),$=Ie(0),j=null;function J(R){var ve,xe,me,le,ze,ke;if(!l(a)||!l(a).variants||!l(a).options||l(a).options.length===0)return;const he=o();if((xe=(ve=he==null?void 0:he.productSelection)==null?void 0:ve.quantityByVariant)!=null&&xe[R]&&Object.keys(he.productSelection.quantityByVariant[R]).length>0,(((le=(me=he==null?void 0:he.productSelection)==null?void 0:me.quantityByVariant)==null?void 0:le[R])!==void 0||l(S).includes(R))&&d()&&d()!=="temp"){if(l(S).includes(R)){_(S,l(S).filter(U=>U!==R));const de={...l(k)};delete de[R],_(k,de);const Fe={...l(F)};Fe[R]&&Object.keys(Fe[R]).forEach(U=>{Fe[R][U]=0}),_(F,Fe),ur.update(U=>{if(!U||!U.productSelection)return U;const Ae={...U.productSelection.quantityByVariant};Ae[R]&&Object.keys(Ae[R]).forEach(Ce=>{Ae[R][Ce]=0});const fe=Object.values(Ae).reduce((Ce,ge)=>Ce+Object.values(ge).reduce((De,Ne)=>De+Ne,0),0);return{...U,productSelection:{...U.productSelection,selectedColors:l(S),variantsByColor:de,quantityByVariant:Ae,totalQuantity:fe}}}),pe(),fa($);return}if(!l(S).includes(R)){const de=l(a).options[0].id,Fe=l(a).variants.filter(U=>{var Ae;return!U.option_values||!Array.isArray(U.option_values)?!1:(Ae=U.option_values)==null?void 0:Ae.some(fe=>fe.option_value&&fe.option_value.option?fe.option_value.option.id===de&&fe.option_value.value===R:fe.option_id?fe.option_id===de&&fe.value===R:!1)});Fe.length>0&&(_(k,{...l(k),[R]:Fe}),_(S,[...l(S),R]),ur.update(U=>!U||!U.productSelection?U:{...U,productSelection:{...U.productSelection,selectedColors:[...U.productSelection.selectedColors,R],variantsByColor:{...U.productSelection.variantsByColor,[R]:Fe},quantityByVariant:{...U.productSelection.quantityByVariant,[R]:U.productSelection.quantityByVariant[R]||{}}}}),fa($))}return}const be=l(a).options[0].id,Le=l(a).variants.filter(de=>{var Fe;return!de.option_values||!Array.isArray(de.option_values)?!1:(Fe=de.option_values)==null?void 0:Fe.some(U=>U.option_value&&U.option_value.option?U.option_value.option.id===be&&U.option_value.value===R:U.option_id?U.option_id===be&&U.value===R:!1)}),Y={...l(k)};if(Le.length>0&&(Y[R]=Le),d()&&d()!=="temp"){const de=o();((ke=(ze=de==null?void 0:de.productSelection)==null?void 0:ze.selectedColors)==null?void 0:ke.includes(R))?(_(k,{...l(k),...Y}),ur.update(U=>!U||!U.productSelection?U:{...U,productSelection:{...U.productSelection,variantsByColor:{...U.productSelection.variantsByColor,...Y}}})):(l(S).includes(R)||_(S,[...l(S),R]),_(k,{...l(k),...Y}),ur.update(U=>{var De,Ne,Ze,Oe,Ke;if(!U||!U.productSelection)return U;const Ae=Object.keys(U.productSelection.quantityByVariant||{}),fe=new Set([...Ae,R]),Ce=Array.from(fe),ge={...((De=U.productSelection)==null?void 0:De.variantsByColor)||{},...Y};return console.log(" Edit :   (  ):",{colorValue:R,colorsWithQuantity:Ae,newSelectedColors:Ce,variantsInColor:((Ne=Y[R])==null?void 0:Ne.length)||0,quantityByVariant:U.productSelection.quantityByVariant}),{...U,productSelection:{...U.productSelection,selectedColors:Ce,variantsByColor:ge,quantityByVariant:{...((Ze=U.productSelection)==null?void 0:Ze.quantityByVariant)||{},[R]:((Ke=(Oe=U.productSelection)==null?void 0:Oe.quantityByVariant)==null?void 0:Ke[R])||{}}}}}))}else ur.toggleColorSelection(R,Y)}function we(R){var be;if(!l(a)||l(a).options.length<2||!R||!R.option_values||!Array.isArray(R.option_values))return"";const he=l(a).options[1].id,Be=R.option_values.find(Le=>Le.option_value&&Le.option_value.option?Le.option_value.option.id===he:Le.option_id?Le.option_id===he:!1);return((be=Be==null?void 0:Be.option_value)==null?void 0:be.value)||(Be==null?void 0:Be.value)||""}function D(R,he){var Le;const Be=((Le=l(F)[R])==null?void 0:Le[he])||0,be=Be+1;o(),ur.updateQuantity(R,he,be),se("increase",R,he,Be,be)}function N(R,he){var be;const Be=((be=l(F)[R])==null?void 0:be[he])||0;if(Be>0){const Le=Be-1;ur.updateQuantity(R,he,Le),se("decrease",R,he,Be,Le)}}function Z(R,he,Be){var O;const be=parseInt(R.target.value)||0,Le=Math.max(0,be),Y=((O=l(F)[he])==null?void 0:O[Be])||0;ur.updateQuantity(he,Be,Le),se("input",he,Be,Y,Le)}function se(R,he,Be,be,Le){var Y;if(typeof window<"u"){const O=Object.values(l(F)).reduce((ve,xe)=>ve+Object.values(xe).reduce((me,le)=>me+le,0),0)-be+Le;window.dispatchEvent(new CustomEvent("productQuantityUpdate",{detail:{productId:(Y=l(a))==null?void 0:Y.id,action:R,color:he,variantId:Be,oldQuantity:be,newQuantity:Le,newTotalQuantity:O,timestamp:Date.now(),source:"product.svelte"}}))}}let ce=!1,re=!1;function pe(){const R=Object.values(l(F)).reduce((he,Be)=>he+Object.values(Be).reduce((be,Le)=>be+Le,0),0);l(te)!==R&&(_(te,R),V())}function V(){var R,he;if(!ce){ce=!0;try{const Be={};if(!((R=l(a))!=null&&R.quantity_discounts)||l(te)===0){Object.keys(l(P)).length>0&&(_(P,{}),ur.updateVariantDiscounts({}));return}const be=Object.keys(l(F)),Le=Object.keys(l(k));be.filter(me=>!Le.includes(me)).length>0;for(const me in l(F))for(const le in l(F)[me])if(l(F)[me][le]>0){const ke=(he=l(k)[me])==null?void 0:he.find(de=>de.id===le);if(ke&&ke.prices&&ke.prices.length>0){const de=ke.prices[0].amount,Fe=mi(l(te),de,l(a).quantity_discounts);Fe!=null&&Fe.hasDiscount&&(Be[le]=Fe)}}const O=Object.keys(l(P)).sort(),ve=Object.keys(Be).sort();(JSON.stringify(O)!==JSON.stringify(ve)||Object.keys(Be).some(me=>JSON.stringify(l(P)[me])!==JSON.stringify(Be[me])))&&(_(P,Be),ur.updateVariantDiscounts(l(P)))}finally{ce=!1}}}function K(){var be;let R=0,he=0,Be=!1;for(const Le in l(F))for(const Y in l(F)[Le]){const O=l(F)[Le][Y];if(O>0){const ve=(be=l(k)[Le])==null?void 0:be.find(xe=>xe.id===Y);if(ve&&ve.prices&&ve.prices.length>0){const xe=ve.prices[0].amount,me=l(P)[Y];R+=xe*O,me!=null&&me.hasDiscount?(he+=me.discountedPrice*O,Be=!0):he+=xe*O}}}return{originalTotal:R,discountedTotal:Be?he:R,hasDiscount:Be}}function oe(){if(l(te)===0){_(m,!0),_(y," "),_(b," 1   .");return}ur.completeProductSelection();const R=[];for(const Be in l(F))for(const be in l(F)[Be]){const Le=l(F)[Be][be];if(Le>0){const Y=l(k)[Be].find(O=>O.id===be);Y&&R.push({...Y,quantity:Le})}}const he=s().products.findIndex(Be=>{var be;return((be=Be.product)==null?void 0:be.id)===l(a).id});he>=0?Kt(Et,lt(s).products[he]={product:l(a),variants:R,quantity:l(te),prints:[],addons:{},addonProductsMap:{}},lt(s)):Kt(Et,lt(s).products=[...s().products,{product:l(a),variants:R,quantity:l(te),prints:[],addons:{},addonProductsMap:{}}],lt(s)),Et.updateTotalAmounts(),_(m,!0),_(y," "),_(b,`${l(te)}  .`),u()&&u()()}async function ae(){var he,Be,be,Le,Y,O,ve,xe,me;if(!A())return;const R=o().productSelection;if(R&&R.product&&R.productId===A()){_(f,!0),_(g,null);try{_(h,await pd.loadIntegratedProductData(A(),i().id)),console.log(" Edit : productDataStore   ( variants ):",{productId:A(),variantsCount:((be=(Be=(he=l(h))==null?void 0:he.product)==null?void 0:Be.variants)==null?void 0:be.length)||0,hasOptionValues:(ve=(O=(Y=(Le=l(h))==null?void 0:Le.product)==null?void 0:Y.variants)==null?void 0:O[0])!=null&&ve.option_values?"yes":"no"}),(xe=l(h))!=null&&xe.product&&Hn.updateProduct(A(),{product:l(h).product,addons:l(h).addons||[],addonItems:l(h).addonItems||[]})}catch(le){_(g,le instanceof Error?le.message:"   .")}finally{_(f,!1)}return}_(f,!0),_(g,null);try{if(_(h,await pd.loadIntegratedProductData(A(),i().id)),(me=l(h))!=null&&me.product){const le=s().products.find(ze=>{var ke;return((ke=ze.product)==null?void 0:ke.id)===l(h).product.id});if(le&&le.variants.length>0){const ze={},ke=l(h).product.options[0].id;le.variants.forEach(de=>{var U;if(!de||!de.option_values||!Array.isArray(de.option_values))return;const Fe=de.option_values.find(Ae=>Ae.option_value&&Ae.option_value.option?Ae.option_value.option.id===ke:Ae.option_id?Ae.option_id===ke:!1);if(Fe){const Ae=((U=Fe.option_value)==null?void 0:U.value)||Fe.value||"";ze[Ae]||(ze[Ae]=[]),ze[Ae].push(de)}});for(const de in ze)J(de),ze[de].forEach(Fe=>{l(F)[de]&&hr(F,l(F)[de][Fe.id]=Fe.quantity||0)});_(F,{...l(F)}),pe()}}}catch(le){_(g,le instanceof Error?le.message:"   .")}finally{_(f,!1)}}function x(){const R=o();if(!(R!=null&&R.productSelection)||!l(a))return;const he=R.productSelection;if(_(S,[...he.selectedColors]),_(F,{...he.quantityByVariant}),_(te,he.totalQuantity),d()&&d(),l(S).length>0&&l(a)&&l(a).variants){_(k,{});const Be=l(a).options[0].id;Object.keys(he.quantityByVariant||{}).forEach(Le=>{const Y=l(a).variants.filter(O=>{var ve;return(ve=O.option_values)==null?void 0:ve.some(xe=>xe.option_value&&xe.option_value.option?xe.option_value.option.id===Be&&xe.option_value.value===Le:xe.option_id?xe.option_id===Be&&xe.value===Le:!1)});Y.length>0&&hr(k,l(k)[Le]=Y)})}_(k,{...l(k)}),fa($),Object.keys(l(k)).length>0&&ur.update(Be=>!Be||!Be.productSelection?Be:{...Be,productSelection:{...Be.productSelection,variantsByColor:l(k)}}),l(te)>0&&V()}function E(){j=ur.subscribe(R=>{if(R!=null&&R.productSelection&&R.productId===A()){const he=R.productSelection;if(!l(a)||!l(a).variants)return;if(_(S,[...he.selectedColors]),_(F,{...he.quantityByVariant}),_(te,he.totalQuantity),l(a)&&l(a).variants&&l(S).length>0){d()&&d();const Be={},be=l(a).options[0].id;if(Object.keys(he.quantityByVariant||{}).forEach(Y=>{const O=l(a).variants.filter(ve=>{var xe;return(xe=ve.option_values)==null?void 0:xe.some(me=>me.option_value&&me.option_value.option?me.option_value.option.id===be&&me.option_value.value===Y:me.option_id?me.option_id===be&&me.value===Y:!1)});O.length>0&&(Be[Y]=O)}),_(k,Be),fa($),!re){const Y=Object.keys(he.variantsByColor||{}).sort(),O=Object.keys(Be).sort();if(JSON.stringify(Y)!==JSON.stringify(O)){re=!0;try{console.log(" Store variantsByColor  ( ):",{before:Y.length,after:O.length,beforeKeys:Y,afterKeys:O}),ur.update(xe=>!xe||!xe.productSelection?xe:{...xe,productSelection:{...xe.productSelection,variantsByColor:Be}})}finally{setTimeout(()=>{re=!1},0)}}}}else l(S).length===0&&(_(k,{}),fa($));he.needsDiscountRecalculation&&l(te)>0&&setTimeout(()=>{V()},0)}})}En(async()=>{d()&&d()!=="temp"||ur.initialize(A(),d()),E(),await ae(),x()}),Eo(()=>{j&&j()}),Zt(()=>(o(),zn(A()),l(h)),()=>{var R,he,Be;(he=(R=o())==null?void 0:R.productSelection)!=null&&he.product&&o().productSelection.productId===A()&&(!l(h)||((Be=l(h).product)==null?void 0:Be.id)!==o().productSelection.product.id)&&_(h,{product:o().productSelection.product,addons:o().productSelection.addons||[],addonItems:o().productSelection.addonItems||[]})}),Zt(()=>l(h),()=>{var R;_(a,((R=l(h))==null?void 0:R.product)||null)}),Zt(()=>(l(a),l(S),zn(d()),l($)),()=>{var R,he;if(l(a)&&l(a).variants&&l(S).length>0){const Be=d()&&d()!=="temp";console.log(` Reactive: product  , variantsByColor  (${Be?"Edit":"Create"} )`,{productId:l(a).id,variantsCount:l(a).variants.length,selectedColors:l(S),firstVariant:l(a).variants[0],hasOptionValues:!!((R=l(a).variants[0])!=null&&R.option_values)});const be={},Le=(he=l(a).options[0])==null?void 0:he.id;Le&&(l(S).forEach(Y=>{const O=l(a).variants.filter(ve=>{var xe;return l(S).indexOf(Y)===0&&l(a).variants.indexOf(ve),(xe=ve.option_values)==null?void 0:xe.some(me=>me.option_value&&me.option_value.option?me.option_value.option.id===Le&&me.option_value.value===Y:me.option_id?me.option_id===Le&&me.value===Y:!1)});O.length>0&&(be[Y]=O)}),_(k,be),fa($))}}),Zt(()=>(o(),l(P),l($)),()=>{var R,he;if((he=(R=o())==null?void 0:R.productSelection)!=null&&he.variantDiscounts){const Be=o().productSelection.variantDiscounts,be=Object.keys(l(P)).sort(),Le=Object.keys(Be).sort();(JSON.stringify(be)!==JSON.stringify(Le)||Object.keys(Be).some(O=>JSON.stringify(l(P)[O])!==JSON.stringify(Be[O])))&&(_(P,{...Be}),fa($))}}),Zn(),qr();var I=HR(),L=gt(I),M=w(L);{var H=R=>{var he=BR();T(R,he)},q=R=>{var he=Nt(),Be=gt(he);{var be=Y=>{var O=xR(),ve=w(O),xe=z(w(ve),2),me=z(w(xe),2),le=w(me),ze=z(ve,2);He(()=>Qe(le,l(g))),at("click",ze,ae),T(Y,O)},Le=Y=>{var O=Nt(),ve=gt(O);{var xe=me=>{var le=MR(),ze=gt(le),ke=w(ze),de=w(ke),Fe=z(ke,2),U=w(Fe),Ae=w(U),fe=z(U,2);{var Ce=_e=>{var Ue=CR();const Me=it(K);var je=w(Ue),At=z(je);{var ut=ht=>{var Re=zR();T(ht,Re)};Se(At,ht=>{l(Me).hasDiscount&&ht(ut)})}He(()=>Qe(je,` : ${l(te)??""} `)),T(_e,Ue)};Se(fe,_e=>{l(te)>0&&_e(Ce)})}var ge=z(ze,2);{var De=_e=>{var Ue=UR(),Me=z(w(Ue),2);Jt(Me,5,()=>l(a).options[0].values,ar,(je,At)=>{var ut=IR();const ht=it(()=>l(S).includes(l(At).value));var Re=w(ut),Xe=w(Re),tt=w(Xe);{var rt=Pt=>{var kt=ER(),Ct=gt(kt),Ft=z(Ct,2);{var zt=Tt=>{var Rt=SR();T(Tt,Rt)};Se(Ft,Tt=>{l(ht)&&Tt(zt)})}He(()=>{nr(Ct,"src",l(At).image),nr(Ct,"alt",l(At).value),Ir(Ct,`odz-w-12 odz-h-12 odz-object-cover odz-rounded-lg odz-shadow-sm
                                                   ${(l(ht)?"odz-ring-2 odz-ring-red-400 odz-ring-offset-2":"")??""}`)}),T(Pt,kt)};Se(tt,Pt=>{l(At).image&&Pt(rt)})}var Bt=z(Xe,2),nt=w(Bt),ot=z(Bt,2),xt=w(ot);{var Lt=Pt=>{var kt=Nt();const Ct=it(()=>Object.values(l(F)[l(At).value]||{}).reduce((Tt,Rt)=>Tt+Rt,0));var Ft=gt(kt);{var zt=Tt=>{var Rt=FR(),Dt=w(Rt),Mt=w(Dt);He(()=>Qe(Mt,`${l(Ct)??""}`)),T(Tt,Rt)};Se(Ft,Tt=>{l(Ct)>0&&Tt(zt)})}T(Pt,kt)};Se(xt,Pt=>{var kt;l(ht)&&((kt=l(k)[l(At).value])==null?void 0:kt.length)>0&&l($)>=0&&Pt(Lt)})}var _t=z(xt,2),vt=w(_t);He(()=>{Ir(ut,`odz-w-full odz-transition-all odz-duration-200 odz-ease-in-out
                                   ${(l(ht)?"odz-bg-gradient-to-r odz-from-red-50 odz-to-rose-50 odz-border-2 odz-border-red-400 odz-shadow-md":"odz-bg-white odz-border-2 odz-border-gray-200 hover:odz-border-gray-300 hover:odz-shadow-sm")??""}
                                   odz-rounded-xl odz-p-3`),Ir(Bt,`odz-flex-1 odz-text-sm odz-font-semibold odz-text-gray-700 odz-text-left
                                            ${(l(ht)?"odz-text-red-700":"")??""}`),Qe(nt,l(At).value),Ir(_t,`odz-transition-transform odz-duration-300
                                               ${(l(ht)?"odz-rotate-90":"")??""}`),M4(vt,`odz-w-4 odz-h-4 odz-text-gray-400
                                                   ${(l(ht)?"odz-text-red-500":"")??""}`)}),at("click",ut,()=>J(l(At).value)),T(je,ut)}),T(_e,Ue)};Se(ge,_e=>{l(a).options.length>0&&_e(De)})}var Ne=z(ge,2);{var Ze=_e=>{var Ue=NR();Jt(Ue,5,()=>l(S),ar,(Me,je)=>{var At=DR();const ut=it(()=>l(k)[l(je)]||[]),ht=it(()=>l(a).options[0].values.find(_t=>_t.value===l(je)));var Re=w(At),Xe=w(Re);{var tt=_t=>{var vt=QR(),Pt=w(vt);He(()=>{nr(Pt,"src",l(ht).image),nr(Pt,"alt",l(je))}),T(_t,vt)};Se(Xe,_t=>{var vt;(vt=l(ht))!=null&&vt.image&&_t(tt)})}var rt=z(Xe,2),Bt=w(rt),nt=w(Bt),ot=z(Re,2);{var xt=_t=>{var vt=kR();Jt(vt,5,()=>l(ut),ar,(Pt,kt)=>{var Ct=PR();const Ft=it(()=>we(l(kt))),zt=it(()=>{var Ar;return((Ar=l(F)[l(je)])==null?void 0:Ar[l(kt).id])||0}),Tt=it(()=>l(P)[l(kt).id]),Rt=it(()=>l(zt)>0);var Dt=w(Ct),Mt=w(Dt);{var Gt=Ar=>{var pr=TR();T(Ar,pr)};Se(Mt,Ar=>{var pr;l(Rt)&&((pr=l(Tt))!=null&&pr.hasDiscount)&&Ar(Gt)})}var lr=z(Mt,2),tr=w(lr),sr=w(tr),Ht=z(tr,2),mr=w(Ht);{var kr=Ar=>{CB(Ar,{get originalPrice(){return l(kt).prices[0].amount},get finalPrice(){return l(Tt).discountedPrice},hasDiscount:!0,size:"sm"})},Kr=Ar=>{var pr=LR(),Pr=w(pr);He(gn=>Qe(Pr,`${gn??""}`),[()=>vr(l(kt).prices[0].amount)],it),T(Ar,pr)};Se(mr,Ar=>{var pr;(pr=l(Tt))!=null&&pr.hasDiscount&&l(zt)>0?Ar(kr):Ar(Kr,!1)})}var Sr=z(lr,2),fr=w(Sr),Lr=z(fr,2),xr=z(Lr,2);He(()=>{Ir(Dt,`odz-bg-white odz-border-2 odz-rounded-xl odz-p-2 odz-transition-all odz-duration-200
                                                    ${(l(Rt)?"odz-border-red-300 odz-shadow-lg odz-scale-105":"odz-border-gray-200 hover:odz-border-red-200 hover:odz-shadow-md")??""}`),Ir(tr,`odz-bg-gradient-to-r odz-from-slate-600 odz-to-slate-800 odz-text-white
                                                           odz-px-3 odz-py-1 odz-rounded-lg odz-text-sm odz-font-bold odz-shadow-sm
                                                           ${(l(Rt)?"odz-from-red-500 odz-to-red-700":"")??""}`),Qe(sr,l(Ft)),Ir(fr,`odz-flex odz-items-center odz-justify-center odz-w-7 odz-h-7 sm:odz-w-8 sm:odz-h-8 odz-bg-white odz-rounded-md odz-shadow-sm
                                                           odz-text-gray-600 hover:odz-text-red-500 hover:odz-bg-red-50 odz-transition-colors odz-duration-150
                                                           ${(l(zt)<=0?"odz-opacity-50 odz-cursor-not-allowed":"hover:odz-scale-110")??""}`),fr.disabled=l(zt)<=0,Xm(Lr,l(zt))}),at("click",fr,()=>N(l(je),l(kt).id)),at("input",Lr,Ar=>Z(Ar,l(je),l(kt).id)),at("click",xr,()=>D(l(je),l(kt).id)),T(Pt,Ct)}),T(_t,vt)},Lt=_t=>{var vt=OR();T(_t,vt)};Se(ot,_t=>{l(ut).length>0&&l($)>=0?_t(xt):_t(Lt,!1)})}He(()=>Qe(nt,l(je))),T(Me,At)}),T(_e,Ue)};Se(Ne,_e=>{l(S).length>0&&_e(Ze)})}var Oe=z(Ne,2);const Ke=it(()=>d()||null),Je=it(()=>c()!==void 0?c():null),Te=it(()=>l(te)>0);VA(Oe,{get productId(){return A()},get estimateId(){return l(Ke)},get idx(){return l(Je)},get showNextButton(){return l(Te)},nextButtonText:"  ",onNext:oe}),He(()=>{nr(de,"src",l(a).thumbnail),nr(de,"alt",l(a).title),Qe(Ae,l(a).title)}),T(me,le)};Se(ve,me=>{l(a)&&me(xe)},!0)}T(Y,O)};Se(Be,Y=>{l(g)?Y(be):Y(Le,!1)},!0)}T(R,he)};Se(M,R=>{l(f)?R(H):R(q,!1)})}var G=z(L,2);Wd(G,{get isOpen(){return l(m)},set isOpen(R){_(m,R)},get title(){return l(y)},set title(R){_(y,R)},get message(){return l(b)},set message(R){_(b,R)},$$legacy:!0}),T(n,I),jr(),r()}var RR=ee('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),qR=ee('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div></div>'),KR=ee('<div class="odz-w-12 odz-h-12 odz-flex-shrink-0 odz-overflow-hidden odz-rounded-lg odz-border odz-border-gray-200"><img class="odz-w-full odz-h-full odz-object-cover" loading="lazy"></div>'),$R=ee('<div class="odz-w-12 odz-h-12 odz-flex-shrink-0 odz-bg-gray-100 odz-rounded-lg odz-border odz-border-gray-200 odz-flex odz-items-center odz-justify-center"><svg class="odz-w-6 odz-h-6 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg></div>'),VR=ee('<label><input type="radio" class="odz-w-4 odz-h-4 odz-text-red-600 odz-border-gray-300 odz-focus:ring-red-500"> <div class="odz-flex-1"><span class="odz-font-medium odz-text-gray-900"> </span> <div class="odz-text-sm odz-text-red-600 odz-font-semibold"> </div></div></label>'),GR=ee('<div class="odz-mt-4 odz-p-3 odz-bg-green-50 odz-border odz-border-green-200 odz-rounded-lg"><div class="odz-flex odz-items-center odz-gap-2 odz-text-sm"><svg class="odz-w-4 odz-h-4 odz-text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span class="odz-text-green-800">: <strong> </strong> </span></div></div>'),WR=ee('<div class="odz-border odz-border-gray-200 odz-rounded-lg odz-p-6"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-4"><!> <h4 class="odz-text-md odz-font-semibold odz-text-gray-800"> </h4></div> <fieldset class="odz-space-y-3"><legend class="odz-sr-only"> </legend> <!></fieldset> <!></div>'),XR=ee('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><h3 class="odz-text-lg odz-font-semibold odz-text-gray-800 odz-mb-6 odz-flex odz-items-center odz-gap-2"><svg class="odz-w-5 odz-h-5 odz-text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>  </h3> <div class="odz-space-y-8"></div></div>'),YR=ee('<div class="odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-xl odz-p-8 odz-text-center"><svg class="odz-w-12 odz-h-12 odz-text-gray-400 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg> <h3 class="odz-text-lg odz-font-semibold odz-text-gray-700 odz-mb-2"> </h3> <p class="odz-text-gray-500">     .</p></div>'),JR=ee("<!> <!>",1),ZR=ee('<div class="odz-bg-yellow-50 odz-border odz-border-yellow-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-yellow-800">    </h3> <p class="odz-text-sm odz-text-yellow-600"> ID   .</p></div></div></div>'),e9=ee('<div class="odz-modal odz-modal-open"><div class="odz-modal-box odz-max-w-md odz-p-8"><div class="odz-text-center odz-mb-8"><h3 class="odz-text-lg odz-font-medium odz-text-gray-800">   .</h3></div> <div class="odz-space-y-3"><button type="button" class="odz-w-full odz-px-6 odz-py-4 odz-bg-gray-900 hover:odz-bg-gray-800 odz-text-white odz-font-medium odz-rounded-lg odz-transition-colors odz-flex odz-items-center odz-justify-center odz-gap-3"><div class="odz-w-6 odz-h-6 odz-bg-green-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-4 odz-h-4 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg></div>   </button> <button type="button" class="odz-w-full odz-px-6 odz-py-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-font-medium odz-rounded-lg odz-transition-colors">  </button></div></div></div>'),t9=ee('<div class="odz-addon-tab"><div class="odz-mb-6"><h2 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2"> </h2> <p class="odz-text-sm odz-text-gray-600">  </p></div> <div class="odz-space-y-6"><!></div></div> <!>',1);function r9(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=()=>Xr(ur,"$fixedEstimateStore",t),i=()=>Xr(Ls,"$shopStore",t);let a=pt(e,"productId",8),A=pt(e,"estimateId",8,void 0),d=pt(e,"idx",8,void 0),c=pt(e,"onSave",8,void 0);pt(e,"onNext",8,void 0);let u=pt(e,"onPrev",8,void 0),h=null,f=Ie(null),g=Ie(!1),m=Ie(null),y=Ie({}),b=Ie(!1),S="";function F(x,E,I){var L,M;ur.toggleAddonSelection(x,E,I),((L=l(y)[x])==null?void 0:L.productId)===E&&((M=l(y)[x])==null?void 0:M.variantId)===I?delete l(y)[x]:hr(y,l(y)[x]={productId:E,variantId:I}),_(y,{...l(y)}),k(),typeof window<"u"&&(window.dispatchEvent(new CustomEvent("addonSelectionUpdate",{detail:{productId:E,addonId:x,variantId:I,selectedAddons:{...l(y)},timestamp:Date.now(),source:"addon.svelte"}})),console.log(" addonSelectionUpdate   (variantId ):",{productId:E,addonId:x,variantId:I,selectedAddonsCount:Object.keys(l(y)).length}))}function k(){const x=o().index;x>=0&&o().products[x]&&(Kt(Et,lt(o).products[x].addons={...l(y)},lt(o)),F_(Et,{...o()}))}async function P(){if(!a())return;const x=s().productSelection;if(x&&x.product&&x.productId===a()){_(f,{product:x.product,addons:x.addons||[],addonItems:x.addonItems||[]}),_(g,!1);return}_(g,!0),_(m,null);try{_(f,await Hn.loadIntegratedProductData(a(),i().id))}catch(E){_(m,E instanceof Error?E.message:"   .")}finally{_(g,!1)}}function te(){const x=s();if(x&&x.productId===a()&&x.addonSelection&&x.addonSelection.selectedAddons){const E={...x.addonSelection.selectedAddons};Object.keys(l(y)).length,Object.keys(E).length,_(y,E),_(y,{...l(y)})}}function $(){h=ur.subscribe(x=>{if(x&&x.productId===a())if(x.addonSelection&&x.addonSelection.selectedAddons){const E={...x.addonSelection.selectedAddons};Object.keys(l(y)).length,Object.keys(E).length,JSON.stringify(l(y))!==JSON.stringify(E)&&(_(y,E),typeof window<"u"&&window.dispatchEvent(new CustomEvent("addonSelectionChanged",{detail:{selectedAddons:E}})))}else Object.keys(l(y)).length>0&&_(y,{})})}async function j(x){const E={printMethod:null,simplePrintState:null,detailedPrintState:null,simplePrintKeys:[],detailedPrintKeys:[],allProductKeys:[],otherData:{}},I=Object.keys(sessionStorage).filter(L=>L.includes(x));return E.allProductKeys=I,I.forEach(L=>{var H;const M=sessionStorage.getItem(L);if(L.startsWith(`simplePrint_${x}`)){if(E.simplePrintKeys.push(L),M)try{E.simplePrintState=JSON.parse(M)}catch{E.simplePrintState=null}return}if(L.startsWith(`detailedPrint_${x}`)){if(E.detailedPrintKeys.push(L),M)try{E.detailedPrintState=JSON.parse(M)}catch{E.detailedPrintState=null}return}if(L.startsWith(`fixedEstimate_${x}`)&&M)try{const q=JSON.parse(M);(H=q.printSelection)!=null&&H.currentMethod&&(E.printMethod=q.printSelection.currentMethod)}catch{}try{E.otherData[L]=M&&JSON.parse(M)}catch{E.otherData[L]=M}}),E}async function J(x,E,I,L){var de,Fe,U,Ae,fe,Ce;const{shopData:M,customerData:H,fixedEstimateData:q,estimateStoreData:G}=x,R=new Date().toISOString(),he={shop_id:(M==null?void 0:M.id)||null,sess:(M==null?void 0:M.sess)||null,customer_id:(M==null?void 0:M.customer_id)||null,name:(H==null?void 0:H.name)||(E==null?void 0:E.name)||null,order_name:(H==null?void 0:H.name)||(E==null?void 0:E.name)||null,order_phone:(H==null?void 0:H.phone)||(E==null?void 0:E.phone)||null,address1:(H==null?void 0:H.address1)||(E==null?void 0:E.address1)||null,address2:(H==null?void 0:H.address2)||(E==null?void 0:E.address2)||null,postcode:(H==null?void 0:H.postcode)||(E==null?void 0:E.postcode)||null,mall_type:(H==null?void 0:H.mallType)||(E==null?void 0:E.mallType)||null,upload_memo:(G==null?void 0:G.uploadMemo)||null,status:"temp",created_at:R,updated_at:R},Be=[];let be=((de=q==null?void 0:q.printSelection)==null?void 0:de.currentMethod)||(I==null?void 0:I.printMethod)||"none";if(be==="selection"&&(console.warn(' [prepareDataForDatabase] print_type "selection" . "none" .'),be="none"),["simple","detailed","self-design","none"].includes(be)||(console.warn(` [prepareDataForDatabase]   print_type: "${be}". "none" .`),be="none"),(Fe=q==null?void 0:q.productSelection)!=null&&Fe.quantityByVariant&&((U=q==null?void 0:q.productSelection)!=null&&U.variantsByColor)){const ge=q.productSelection.quantityByVariant,De=q.productSelection.variantsByColor,Ne=q.productSelection.variantDiscounts||{};for(const Ze in ge){const Oe=ge[Ze],Ke=De[Ze]||[];for(const Je in Oe){const Te=Oe[Je];if(Te>0){const _e=Ke.find(Ue=>Ue.id===Je);if(_e){const Ue=_e.prices&&_e.prices.length>0?_e.prices[0].amount:0,Me=Ne[Je];let je=Ue,At=0,ut="amount",ht=0,Re="minus",Xe=null,tt=null;if(Me&&Me.hasDiscount){je=Me.discountedPrice,At=Me.discountAmount;const rt=Me.discountInfo;rt&&(ut=rt.type||"amount",ht=rt.value||0,Re=rt.direction||"minus",Xe=rt.min_quantity||null,tt=rt.max_quantity||null)}Be.push({idx:0,variant_id:Je,quantity:Te,price:je,print_type:be,original_price:Ue,discount_amount:At,discount_type:ut,discount_value:ht,discount_direction:Re,discount_min_quantity:Xe,discount_max_quantity:tt,product_id:L,created_at:R,updated_at:R})}}}}}if(Be.length===0&&(G!=null&&G.products)){const ge=G.products.find(De=>{var Ne;return((Ne=De.product)==null?void 0:Ne.id)===L});ge&&ge.variants&&ge.variants.length>0&&ge.variants.forEach((De,Ne)=>{var Ze;if(De.quantity>0){const Oe=De.prices&&De.prices.length>0?De.prices[0].amount:0,Ke=(Ze=De.product)==null?void 0:Ze.quantity_discounts,Je=mi(De.quantity,Oe,Ke),Te=Je.discountInfo;Be.push({idx:Ne,variant_id:De.id,quantity:De.quantity,price:Je.discountedPrice,original_price:Oe,discount_amount:Je.discountAmount,discount_type:(Te==null?void 0:Te.type)||"amount",discount_value:(Te==null?void 0:Te.value)||0,discount_direction:(Te==null?void 0:Te.direction)||"minus",discount_min_quantity:(Te==null?void 0:Te.min_quantity)||null,discount_max_quantity:(Te==null?void 0:Te.max_quantity)||null,product_id:L,created_at:R,updated_at:R})}})}const Y=[];I.simplePrintState&&Array.isArray(I.simplePrintState)&&I.simplePrintState.forEach((ge,De)=>{Y.push({idx:0,object_id:ge.objectId||`area-${De}`,title:ge.title||`  ${De+1}`,print_method:ge.printMethod||null,uploaded_files:ge.uploadedFiles||null,file_metadata:ge.savedFileInfo||null,price:ge.price||0,created_at:R,updated_at:R})});const O=[],ve=new Set,xe=((Ae=q==null?void 0:q.printSelection)==null?void 0:Ae.currentMethod)==="detailed"||Array.isArray(I.detailedPrintState)&&I.detailedPrintState.length>0;async function me(ge,De){var Me,je,At,ut;if(!ge)return;const Ne=((Me=ge.template)==null?void 0:Me.id)??ge.template_id??null,Ze=ge.objectId??ge.object_id??null;if(!Ne&&!Ze||Ze&&ve.has(Ze))return;let Oe=0;const Ke=ge.price??0,Je=Number(Ke);if(Number.isFinite(Je)&&Je>0)Oe=Je;else try{const ht=((je=q==null?void 0:q.productSelection)==null?void 0:je.totalQuantity)||0;let Re=0,Xe=0;if(ge.colors&&((At=ge.template)!=null&&At.templateProduct)){const tt=ge.colors.length,rt=ge.template.templateProduct.template_product_variants.find(Bt=>Bt.color_count===tt);if(rt){const Bt=await mA(rt.variant_id);if(Bt)if(Re=Bt.prices[0].amount,rt.min_quantity<=ht)if(Xe=Re*ht,ge.template.templateProduct.product.quantity_discounts&&ge.template.templateProduct.product.quantity_discounts.length>0){const nt=mi(ht,Re,ge.template.templateProduct.product.quantity_discounts);Oe=nt.hasDiscount?nt.discountedPrice*ht:Xe}else Oe=Xe;else Oe=rt.plate_price}}else if((ut=ge.template)!=null&&ut.templateProduct){const tt=ge.template.templateProduct.template_product_variants[0];if(tt){const rt=await mA(tt.variant_id);if(rt)if(Re=rt.prices[0].amount,tt.min_quantity<=ht)if(Xe=Re*ht,ge.template.templateProduct.product.quantity_discounts&&ge.template.templateProduct.product.quantity_discounts.length>0){const Bt=mi(ht,Re,ge.template.templateProduct.product.quantity_discounts);Oe=Bt.hasDiscount?Bt.discountedPrice*ht:Xe}else Oe=Xe;else Oe=tt.plate_price}}}catch{Oe=0}const Te=ge.discountInfo||{},_e=Te.discountDetails||Te.discountInfo||{};O.push({idx:0,template_id:Ne,variant_id:ge.variant_id??null,price:Oe,colors:ge.colors||null,uploads:ge.uploads||null,name_sheet:ge.nameSheet??ge.name_sheet??null,object_id:Ze,original_price:Te.originalPrice??ge.original_price??null,discount_amount:Te.discountAmount??ge.discount_amount??null,discount_type:_e.type??ge.discount_type??null,discount_value:_e.value??ge.discount_value??null,discount_direction:_e.direction??ge.discount_direction??null,discount_min_quantity:_e.min_quantity??ge.discount_min_quantity??null,discount_max_quantity:_e.max_quantity??ge.discount_max_quantity??null,created_at:R,updated_at:R}),Ze&&ve.add(Ze)}if(xe){if(Array.isArray(I.detailedPrintState)&&I.detailedPrintState.length>0)for(let ge=0;ge<I.detailedPrintState.length;ge++){const De=I.detailedPrintState[ge];await me(De)}if(O.length===0&&(G!=null&&G.products)){const ge=G.products.find(De=>{var Ne;return((Ne=De.product)==null?void 0:Ne.id)===L});if(ge!=null&&ge.prints&&ge.prints.length>0)for(let De=0;De<ge.prints.length;De++)await me(ge.prints[De])}}const le=[],ze=(fe=q==null?void 0:q.addonSelection)==null?void 0:fe.selectedAddons,ke=((Ce=q==null?void 0:q.productSelection)==null?void 0:Ce.totalQuantity)||0;return ze&&Object.keys(ze).length>0&&Object.entries(ze).forEach(([ge,De])=>{var Oe,Ke,Je;let Ne=0,Ze=0;if((Ke=(Oe=l(f))==null?void 0:Oe.addonProductsMap)!=null&&Ke[De.productId]){const _e=(Je=l(f).addonProductsMap[De.productId].variants)==null?void 0:Je.find(Ue=>Ue.id===De.variantId);_e&&_e.prices&&_e.prices.length>0&&(Ze=_e.prices[0].amount||0,Ne=Ze)}le.push({idx:0,addon_id:ge,selected_product_id:De.productId,selected_variant_id:De.variantId,quantity:ke,price:Ne,created_at:R,updated_at:R})}),{estimate:he,estimate_items:Be,estimate_simple_prints:Y,estimate_prints:O,estimate_addon_items:le}}function we(x){const E=[];return x.estimate.shop_id||E.push(" ID "),x.estimate_items.length===0&&E.push("  "),x.estimate_items.forEach((I,L)=>{I.variant_id||E.push(` ${L+1}:  ID `),(!I.quantity||I.quantity<=0)&&E.push(` ${L+1}:  `)}),x.estimate_simple_prints.forEach((I,L)=>{I.object_id||E.push(`  ${L+1}:  ID `)}),x.estimate_prints&&x.estimate_prints.length>0&&x.estimate_prints.forEach((I,L)=>{!I.template_id&&!I.object_id&&E.push(`  ${L+1}: template_id  object_id `)}),{isValid:E.length===0,errors:E}}async function D(){var x;try{let E=null,I=null,L=null,M=null,H=null;ur.subscribe(le=>{E=le})(),Hn.subscribe(le=>{I=le})(),Et.subscribe(le=>{L=le})(),sl.subscribe(le=>{M=le})(),Ls.subscribe(le=>{H=le})();const be=await j(a()),Le={shopData:H,customerData:M,fixedEstimateData:E,extendedProductData:I,estimateStoreData:L},Y={name:M==null?void 0:M.name,phone:M==null?void 0:M.phone,address1:M==null?void 0:M.address1,address2:M==null?void 0:M.address2,postcode:M==null?void 0:M.postcode,mallType:M==null?void 0:M.mallType},O=await J(Le,Y,be,a()),ve=we(O);if(!ve.isValid){alert(`   :

${ve.errors.join(`
`)}

   .`);return}const xe=await gB(O,(M==null?void 0:M.mallType)||(Y==null?void 0:Y.mallType),H==null?void 0:H.customer_id,H==null?void 0:H.sess);if(xe.success){const le=`
   !

  : ${((x=xe.details)==null?void 0:x.estimateNumber)||"N/A"}
  ID: ${xe.estimateId}
  ID: ${a()}
   : ${O.estimate_items.length}
   : ${O.estimate_simple_prints.length}
   : ${O.estimate_prints.length}
  : ${O.estimate_addon_items.length}

   : ${new Date().toLocaleString()}

   !
                `.trim();_(b,!0),S=xe.estimateId}else{const le=`
   !

  ID: ${a()}
  : ${xe.error}

  : ${new Date().toLocaleString()}

    .
                `.trim();alert(le)}const me={version:"1.0.0",timestamp:new Date().toISOString(),productId:a(),databaseData:O,validationResult:ve,saveResult:xe,stores:{shopStore:H,customerStore:M,fixedEstimateStore:E,extendedProductDataStore:I,estimateStore:L},sessionStorageBackup:be,integratedProductData:l(f),selectedAddons:l(y),formData:Y};window.lastEstimateDataPackage=me}catch(E){const I=`
     !

  : ${E instanceof Error?E.message:"   "}
  ID: ${a()}
  : ${new Date().toLocaleString()}

   .
            `.trim();alert(I)}}function N(){_(b,!1),ur.reset(),Hn.reset(),Et.reset(),_(y,{}),_(f,null),Object.keys(sessionStorage).filter(E=>E.includes(a())).forEach(E=>sessionStorage.removeItem(E)),ur.setCurrentStep("product"),setTimeout(()=>{window.location.href="/"},100)}function Z(){_(b,!1);const x=Object.keys(sessionStorage).filter(E=>E.includes(a()));x.forEach(E=>sessionStorage.removeItem(E)),console.log(" SessionStorage   (  ):",x),window.location.href="/odiz/estimate.php"}En(async()=>{var I;const x=s();(!x||x.productId!==a())&&ur.initialize(a(),A()),$(),await P(),te();const E=o().index;if(E>=0&&((I=o().products[E])!=null&&I.addons)){const L=o().products[E].addons;Object.keys(L).length>0&&_(y,{...L})}}),Eo(()=>{h&&h()}),qr();var se=t9(),ce=gt(se),re=z(w(ce),2),pe=w(re);{var V=x=>{var E=RR();T(x,E)},K=x=>{var E=Nt(),I=gt(E);{var L=H=>{var q=qR(),G=w(q),R=z(w(G),2),he=z(w(R),2),Be=w(he);He(()=>Qe(Be,l(m))),T(H,q)},M=H=>{var q=Nt(),G=gt(q);{var R=Be=>{var be=JR(),Le=gt(be);{var Y=ze=>{var ke=XR(),de=z(w(ke),2);Jt(de,5,()=>l(f).addons,Fe=>Fe.id,(Fe,U)=>{var Ae=WR(),fe=w(Ae),Ce=w(fe);{var ge=Me=>{var je=KR(),At=w(je);He(()=>{nr(At,"src",l(U).items[0].addon_product.thumbnail),nr(At,"alt",l(U).name)}),B_(At),at("error",At,ut=>{const ht=ut.target;ht.style.display="none",ht.parentElement&&(ht.parentElement.innerHTML=`
                                                        <div class="odz-w-full odz-h-full odz-bg-gray-100 odz-flex odz-items-center odz-justify-center">
                                                            <svg class="odz-w-6 odz-h-6 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
                                                            </svg>
                                                        </div>
                                                    `)}),T(Me,je)},De=Me=>{var je=$R();T(Me,je)};Se(Ce,Me=>{l(U).items&&l(U).items.length>0&&l(U).items[0].addon_product.thumbnail?Me(ge):Me(De,!1)})}var Ne=z(Ce,2),Ze=w(Ne),Oe=z(fe,2),Ke=w(Oe),Je=w(Ke),Te=z(Ke,2);Jt(Te,1,()=>l(U).items,Me=>Me.id,(Me,je)=>{var At=Nt(),ut=gt(At);{var ht=Re=>{var Xe=Nt(),tt=gt(Xe);Jt(tt,1,()=>l(je).addon_product.variants,rt=>rt.id,(rt,Bt)=>{var nt=VR();const ot=it(()=>{var zt,Tt;return((zt=l(y)[l(U).id])==null?void 0:zt.productId)===l(je).addon_product.id&&((Tt=l(y)[l(U).id])==null?void 0:Tt.variantId)===l(Bt).id}),xt=it(()=>l(Bt).prices&&l(Bt).prices.length>0?l(Bt).prices[0].amount:0);var Lt=w(nt),_t=kd(()=>(()=>{var tr,sr;const zt=l(U).id,Tt=l(U).name,Rt=l(je).addon_product.id,Dt=l(je).addon_product.title,Mt=l(Bt).id,Gt=l(Bt).title,lr=(sr=(tr=l(Bt).prices)==null?void 0:tr[0])==null?void 0:sr.amount;return Ht=>{console.log(" Radio button clicked ( ):",{addonId:zt,addonName:Tt,productId:Rt,productTitle:Dt,variantId:Mt,variantTitle:Gt,variantPrice:lr,radioId:Ht.target.id,timestamp:Date.now()}),F(zt,Rt,Mt)}})()),vt=z(Lt,2),Pt=w(vt),kt=w(Pt),Ct=z(Pt,2),Ft=w(Ct);He(zt=>{nr(nt,"for",`addon-${l(U).id??""}-${l(je).id??""}-${l(Bt).id??""}`),Ir(nt,`odz-flex odz-items-center odz-gap-4 odz-p-4 odz-border-2 odz-rounded-lg odz-cursor-pointer odz-transition-all
                                                           ${(l(ot)?"odz-border-red-500 odz-bg-red-50":"odz-border-gray-200 odz-bg-white hover:odz-border-gray-300")??""}`),nr(Lt,"id",`addon-${l(U).id??""}-${l(je).id??""}-${l(Bt).id??""}`),nr(Lt,"name",`addon-${l(U).id??""}`),mu(Lt,l(ot)),Qe(kt,l(Bt).title||l(je).addon_product.title),Qe(Ft,` ${zt??""}`)},[()=>vr(l(xt))],it),at("change",Lt,function(...zt){var Tt;(Tt=l(_t))==null||Tt.apply(this,zt)}),T(rt,nt)}),T(Re,Xe)};Se(ut,Re=>{l(je).addon_product.variants&&l(je).addon_product.variants.length>0&&Re(ht)})}T(Me,At)});var _e=z(Oe,2);{var Ue=Me=>{var je=Nt();const At=it(()=>l(U).items.find(Xe=>Xe.addon_product.id===l(y)[l(U).id].productId)),ut=it(()=>{var Xe,tt;return(tt=(Xe=l(At))==null?void 0:Xe.addon_product.variants)==null?void 0:tt.find(rt=>rt.id===l(y)[l(U).id].variantId)});var ht=gt(je);{var Re=Xe=>{var tt=GR(),rt=w(tt),Bt=z(w(rt),2),nt=z(w(Bt)),ot=w(nt),xt=z(nt);He(Lt=>{Qe(ot,l(ut).title||l(At).addon_product.title),Qe(xt,` ( ${Lt??""})`)},[()=>{var Lt,_t;return vr(((_t=(Lt=l(ut).prices)==null?void 0:Lt[0])==null?void 0:_t.amount)||0)}],it),T(Xe,tt)};Se(ht,Xe=>{l(At)&&l(ut)&&Xe(Re)})}T(Me,je)};Se(_e,Me=>{l(y)[l(U).id]&&Me(Ue)})}He(()=>{Qe(Ze,l(U).name),Qe(Je,`${l(U).name??""} `)}),T(Fe,Ae)}),T(ze,ke)},O=ze=>{var ke=YR();T(ze,ke)};Se(Le,ze=>{l(f).addons.length>0?ze(Y):ze(O,!1)})}var ve=z(Le,2);const xe=it(()=>A()||null),me=it(()=>d()!==void 0?d():null),le=it(()=>({type:"double",buttons:[{text:" ",action:u()||(()=>{}),style:"secondary",icon:"arrow-left"},{text:" ",action:A()&&typeof d()=="number"&&c()?c():D,style:"primary",icon:"save",size:"large"}]}));VA(ve,{get productId(){return a()},get estimateId(){return l(xe)},get idx(){return l(me)},get buttonConfig(){return l(le)}}),T(Be,be)},he=Be=>{var be=ZR();T(Be,be)};Se(G,Be=>{l(f)?Be(R):Be(he,!1)},!0)}T(H,q)};Se(I,H=>{l(m)?H(L):H(M,!1)},!0)}T(x,E)};Se(pe,x=>{l(g)?x(V):x(K,!1)})}var oe=z(ce,2);{var ae=x=>{var E=e9(),I=w(E),L=z(w(I),2),M=w(L),H=z(M,2);at("click",M,N),at("click",H,Z),T(x,E)};Se(oe,x=>{l(b)&&x(ae)})}T(n,se),jr(),r()}var n9=ee('<button><div class="odz-flex odz-items-center odz-justify-center odz-gap-2"><span class="odz-hidden sm:odz-inline"> </span></div></button>'),o9=ee('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><div class="odz-w-full"><div class="odz-flex odz-w-full odz-border-b odz-border-gray-200"></div></div>  <div><div><!></div> <div><!></div> <div><!></div></div></div>');function Mp(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Ls,"$shopStore",t);let s=pt(e,"productId",8),i=pt(e,"estimateId",8,void 0),a=pt(e,"idx",8,void 0),A=pt(e,"onSave",8,void 0),d=Ie("product"),c=null,u=null,h=!1,f=null;const g=[{id:"product",label:"",description:"   "},{id:"print",label:"",description:"   "},{id:"addon",label:"",description:"  "}];function m(Z){var pe,V;const se=l(d),ce=Z;if(_(d,ce),ur.setCurrentStep(ce),Hn.getProductData(s())&&(Hn.saveToSession(s()),typeof window<"u"))try{const K=`tab-state-${s()}`,oe={currentTab:ce,previousTab:se,timestamp:Date.now(),productId:s()};window.sessionStorage.setItem(K,JSON.stringify(oe))}catch{}if(typeof window<"u")try{let K;const oe=[i()&&a()!==void 0?`fixedEstimate_${s()}_${i()}_${a()}`:null,i()?`fixedEstimate_${s()}_${i()}`:null,a()!==void 0?`fixedEstimate_${s()}_${a()}`:null,`fixedEstimate_${s()}`].filter(Boolean);console.log("   - sessionStorage  :",{estimateId:i(),idx:a(),productId:s(),storageKeys:oe});for(const x of oe)try{const E=window.sessionStorage.getItem(x);if(E){const I=JSON.parse(E);if(console.log(" sessionStorage  :",{key:x,currentMethod:(pe=I==null?void 0:I.printSelection)==null?void 0:pe.currentMethod}),(V=I==null?void 0:I.printSelection)!=null&&V.currentMethod&&I.printSelection.currentMethod!=="selection"){K=I.printSelection.currentMethod,console.log(" toMethod :",K);break}}}catch{}const ae=new CustomEvent("printAmountRecalc",{detail:{productId:s(),fromTab:se,toTab:ce,toMethod:K,estimateId:i(),idx:a(),timestamp:Date.now(),source:"tab-change"}});window.dispatchEvent(ae)}catch{}console.log("   ( ):",{from:se,to:ce,productId:s(),sessionSaved:!0})}function y(){l(d)==="product"?m("print"):l(d)==="print"&&m("addon")}function b(){if(typeof window>"u")return!1;try{const Z=`tab-state-${s()}`,se=window.sessionStorage.getItem(Z);if(se){const ce=JSON.parse(se);if(ce.productId===s()&&ce.currentTab)return _(d,ce.currentTab),!0}}catch{}return!1}async function S(){try{await Hn.loadIntegratedProductData(s(),o().id)}catch{}}En(async()=>{const Z=i()&&i()!=="temp";await S();const se=b();h=se,Z||ur.initialize(s()),se&&!Z&&ur.setCurrentStep(l(d)),c=ur.subscribe(ce=>{ce&&ce.productId===s()&&!h&&(ce.currentStep,l(d))}),u=Hn.subscribe(ce=>{}),f=ce=>{const re=ce.detail;re&&["product","print","addon"].includes(re)&&m(re)},typeof window<"u"&&window.addEventListener("changeTab",f)}),Eo(()=>{c&&c(),u&&u(),typeof window<"u"&&f&&window.removeEventListener("changeTab",f)}),qr();var F=o9(),k=w(F),P=w(k);Jt(P,5,()=>g,ar,(Z,se)=>{var ce=n9(),re=w(ce),pe=w(re),V=w(pe);He(()=>{Ir(ce,`odz-flex-1 odz-px-4 odz-py-3 odz-text-sm odz-font-medium odz-transition-all odz-duration-200 odz-border-b-2
                           ${(l(d)===l(se).id?"odz-text-red-600 odz-border-red-400 odz-bg-red-50":"odz-text-gray-600 odz-border-transparent hover:odz-text-gray-800 hover:odz-border-gray-300")??""}`),Qe(V,l(se).label)}),at("click",ce,()=>m(l(se).id)),T(Z,ce)});var te=z(k,2),$=w(te),j=w($);jR(j,{get productId(){return s()},get estimateId(){return i()},get idx(){return a()},onNext:()=>m("print")});var J=z($,2),we=w(J);T5(we,{get productId(){return s()},get estimateId(){return i()},get idx(){return a()},onNext:y});var D=z(J,2),N=w(D);r9(N,{get productId(){return s()},get estimateId(){return i()},get idx(){return a()},onNext:y,get onSave(){return A()}}),He(()=>{hA($,"odz-hidden",l(d)!=="product"),hA(J,"odz-hidden",l(d)!=="print"),hA(D,"odz-hidden",l(d)!=="addon")}),T(n,F),jr(),r()}var s9=ee('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-ml-4 odz-text-gray-600">  ...</p></div>'),i9=ee('<div class="odz-alert odz-alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="odz-stroke-current odz-shrink-0 odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),a9=ee('<dialog class="odz-modal odz-modal-open odz-backdrop:odz-bg-black odz-backdrop:odz-bg-opacity-50"><div class="odz-modal-box odz-max-w-6xl odz-w-full odz-h-[90vh] odz-p-0 odz-relative"><div class="odz-sticky odz-top-0 odz-z-10 odz-bg-white odz-border-b odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-between odz-items-center"><h3 class="odz-text-lg odz-font-bold odz-text-gray-900">  </h3> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost"><!></button></div> <div class="odz-overflow-y-auto odz-h-[calc(90vh-140px)] odz-px-6 odz-py-4"><!></div> <div class="odz-sticky odz-bottom-0 odz-z-10 odz-bg-white odz-border-t odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-end odz-gap-2"><button class="odz-btn odz-btn-ghost"></button> <button class="odz-btn odz-btn-primary"></button></div></div></dialog>');function A9(n,e){Hr(e,!1);let t=pt(e,"isOpen",8,!1),r=pt(e,"estimateId",8),o=pt(e,"idx",8),s=pt(e,"productId",8),i=pt(e,"onClose",8),a=pt(e,"onSave",8),A=Ie(!0),d=Ie(""),c=Ie();async function u(){var N,Z,se,ce,re;try{_(A,!0),_(d,"");const pe=await vB(r(),o());if(!pe.items||pe.items.length===0)throw new Error(`     . (estimateId: ${r()}, idx: ${o()})`);if(!((N=pe.items[0])!=null&&N.product_id))throw new Error(" ID   .");if(!pe.items.some(E=>E.variant&&E.variant.id)){const E=pe.items.map(I=>I.variant_id).filter(Boolean);throw E.length===0?new Error("    .  ."):new Error(`     . ( ID: ${E[0]})
     .  .`)}const K=wB(pe);if(typeof window<"u"){const E=r()||"temp";[`fixedEstimate_${s()}_${E}_${o()}`,`simplePrint_${s()}_${E}`,`detailedPrint_${s()}_${E}`,`fixedEstimate_${s()}`,`simplePrint_${s()}`,`detailedPrint_${s()}`].forEach(L=>{window.sessionStorage.removeItem(L)})}const oe=r()||"temp",ae=Date.now().toString(36)+Math.random().toString(36).substr(2),x={productId:s(),productSelection:K.fixedEstimateData.productSelection,printSelection:K.fixedEstimateData.printSelection||null,addonSelection:K.fixedEstimateData.addonSelection||null,additionalInfo:K.fixedEstimateData.additionalInfo||null,currentStep:"product",isDebugMode:!0,sessionId:ae,estimateId:oe};if(typeof window<"u"){const{sessionStorageData:E}=K,I=`fixedEstimate_${s()}_${oe}_${o()}`;if(window.sessionStorage.setItem(I,JSON.stringify(x)),console.log(" sessionStorage   ( FixedEstimateState ):",{key:I,idx:o(),sessionId:x.sessionId,hasProductId:!!x.productId,quantityByVariant:K.fixedEstimateData.productSelection.quantityByVariant}),E.simplePrintState){const L=`simplePrint_${s()}_${oe}`;window.sessionStorage.setItem(L,JSON.stringify(E.simplePrintState))}if(E.detailedPrintState.length>0&&((Z=x.printSelection)==null?void 0:Z.currentMethod)==="detailed"){const L=`detailedPrint_${s()}_${oe}`;window.sessionStorage.setItem(L,JSON.stringify(E.detailedPrintState))}}ur.set(x),console.log(" fixedEstimateStore   ( ),    ...",{sessionId:x.sessionId,hasProductId:!!x.productId,hasProductSelection:!!x.productSelection,selectedColorsCount:((ce=(se=x.productSelection)==null?void 0:se.selectedColors)==null?void 0:ce.length)||0,totalQuantity:((re=x.productSelection)==null?void 0:re.totalQuantity)||0}),await new Promise(E=>setTimeout(E,50)),_(A,!1)}catch(pe){pe instanceof Error?_(d,pe.message):_(d,"    ."),_(A,!1)}}function h(){if(typeof window<"u"){const N=r()||"temp";[`fixedEstimate_${s()}_${N}_${o()}`,`simplePrint_${s()}_${N}`,`detailedPrint_${s()}_${N}`,`tab-state-${s()}`].forEach(se=>{window.sessionStorage.removeItem(se)})}ur.reset(),i()()}function f(){a()()}function g(N){N.key==="Escape"&&h()}function m(N){N.target===l(c)&&h()}Eo(()=>{if(typeof window<"u"){const N=r()||"temp";[`fixedEstimate_${s()}_${N}_${o()}`,`simplePrint_${s()}_${N}`,`detailedPrint_${s()}_${N}`,`tab-state-${s()}`].forEach(se=>{window.sessionStorage.removeItem(se)})}ur.reset()}),Zt(()=>(l(c),zn(t())),()=>{l(c)&&(t()?(l(c).showModal(),u()):l(c).close())}),Zn(),qr();var y=a9(),b=w(y),S=w(b),F=z(w(S),2),k=w(F);ju(k,{class:"odz-w-5 odz-h-5"});var P=z(S,2),te=w(P);{var $=N=>{var Z=s9();T(N,Z)},j=N=>{var Z=Nt(),se=gt(Z);{var ce=pe=>{var V=i9(),K=z(w(V),2),oe=w(K);He(()=>Qe(oe,l(d))),T(pe,V)},re=pe=>{Mp(pe,{get productId(){return s()},get estimateId(){return r()},get idx(){return o()},onSave:f})};Se(se,pe=>{l(d)?pe(ce):pe(re,!1)},!0)}T(N,Z)};Se(te,N=>{l(A)?N($):N(j,!1)})}var J=z(P,2),we=w(J),D=z(we,2);ts(y,N=>_(c,N),()=>l(c)),He(()=>D.disabled=l(A)),at("click",F,h),at("click",we,h),at("click",D,f),at("keydown",y,g),at("click",y,m),T(n,y),jr()}var l9=ee('<div class="odz-flex odz-items-center odz-justify-center odz-min-h-screen"><div class="odz-text-center"><div class="odz-w-12 odz-h-12 odz-border-4 odz-border-red-500 odz-border-t-transparent odz-rounded-full odz-animate-spin odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">  ...</p></div></div>'),d9=ee('<div class="odz-mb-4"><button class="odz-flex odz-items-center odz-gap-2 odz-text-gray-600 hover:odz-text-gray-900 odz-transition-colors"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> <span class="odz-text-sm odz-font-medium"> </span></button></div>'),c9=ee('<div class="odz-fixed odz-top-4 odz-right-4 odz-z-50 odz-bg-green-500 odz-text-white odz-px-4 odz-py-3 odz-rounded-lg odz-shadow-lg odz-flex odz-items-center odz-gap-2"><!> <span class="odz-text-sm"></span></div>'),u9=ee('<button class="odz-bg-red-500 hover:odz-bg-red-600 odz-text-white odz-px-6 odz-py-3 odz-rounded-lg odz-font-medium odz-text-sm odz-transition-colors"> </button>'),h9=ee('<div class="odz-text-center odz-py-12"><!> <p class="odz-text-sm odz-text-gray-500 odz-mb-4">  </p> <!></div>'),f9=ee('<div class="odz-flex odz-justify-between odz-text-sm odz-text-red-600"><span></span> <span class="odz-font-medium"> </span></div>'),p9=ee('<span class="odz-flex odz-items-center odz-justify-center odz-gap-2"><div class="odz-w-5 odz-h-5 odz-border-2 odz-border-white odz-border-t-transparent odz-rounded-full odz-animate-spin"></div>  ...</span>'),g9=ee('<div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-4 odz-border odz-border-gray-200 odz-sticky odz-bottom-0"><button class="odz-w-full odz-bg-red-500 hover:odz-bg-red-600 odz-text-white odz-py-4 odz-rounded-lg odz-font-medium odz-text-base odz-transition-colors disabled:odz-opacity-50 disabled:odz-cursor-not-allowed"><!></button></div>'),v9=ee('<div class="odz-max-w-5xl odz-mx-auto odz-px-4 odz-py-6"><!> <!> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><!></div> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><div class="odz-space-y-4"><div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="text" placeholder="  ()" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <div class="odz-flex odz-gap-2"><select class="odz-w-20 odz-px-3 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"><option>010</option><option>011</option><option>016</option><option>017</option><option>018</option><option>019</option></select> <input type="tel" placeholder="0000" maxlength="4" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"> <input type="tel" placeholder="0000" maxlength="4" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"></div></div> <div class="odz-col-span-full odz-border-t odz-border-gray-200 odz-my-2"></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <div class="odz-flex odz-gap-2"><input type="text" placeholder="" readonly="" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm odz-bg-gray-50"> <button type="button" class="odz-px-6 odz-py-2.5 odz-bg-gray-700 hover:odz-bg-gray-800 odz-text-white odz-rounded-lg odz-text-sm odz-font-medium odz-transition-colors odz-whitespace-nowrap disabled:odz-opacity-50"> </button></div></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder="    " readonly="" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm odz-bg-gray-50"></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <select class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"><option></option><option></option><option></option><option></option></select></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="date" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> </label> <textarea class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 odz-resize-none disabled:odz-bg-gray-50" rows="3" placeholder="  "></textarea></div></div></div> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><div class="odz-space-y-3"><div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"> </span> <span class="odz-font-medium"> </span></div> <div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"></span> <span class="odz-font-medium"> </span></div> <div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"></span> <span class="odz-font-medium"> </span></div> <!> <div class="odz-border-t odz-border-gray-200 odz-pt-3 odz-flex odz-justify-between"><span class="odz-font-semibold odz-text-gray-900"> </span> <span class="odz-text-xl odz-font-bold odz-text-red-600"> </span></div></div></div> <!></div>'),m9=ee('<div class="odz-min-h-screen odz-bg-gray-50"><!></div> <!> <!> <!> <!>',1);function w9(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(Et,"$estimateStore",t),s=Ie();let i=pt(e,"mallType",8,""),a=pt(e,"customerId",8,""),A=pt(e,"sess",8,""),d=pt(e,"shopId",8,""),c=pt(e,"estimateId",12,void 0),u=pt(e,"returnTo",8,"list"),h=Ie(null),f=Ie(!1),g=Ie(!1),m=Ie(!1),y=Ie(!1),b=Ie(""),S=Ie(""),F=Ie(void 0),k=Ie(!1),P=Ie(!1),te=!1,$=Ie(!1),j=-1,J=Ie(""),we=Ie(-1),D=[],N=null,Z=!1;async function se(){var U;if(Z){console.log(" [Realtime]     ");return}if(!((U=l(h))!=null&&U.id)){console.log(" [Realtime]  ID ,  ");return}N&&clearTimeout(N),N=setTimeout(async()=>{try{console.log(" [Realtime]    :",l(h).id),await M(l(h).id),console.log(" [Realtime]    ")}catch(Ae){console.error(" [Realtime]   :",Ae)}},300)}function ce(U){console.log(" [Realtime]    :",U);const Ae=Zp(U,Oe=>{console.log(" [Realtime] Estimate  :",Oe),_(h,Oe),_(m,Cd(Oe.status))});D.push(()=>Ae.unsubscribe());const fe=iB(U,Oe=>{console.log(" [Realtime] EstimateItems  :",Oe.eventType),se()});D.push(()=>fe.unsubscribe());const Ce=d1(U,Oe=>{console.log(" [Realtime] EstimatePrints  :",Oe.eventType),se()});D.push(()=>Ce.unsubscribe());const ge=aB(U,Oe=>{console.log(" [Realtime] EstimateSimplePrints  :",Oe.eventType),se()});D.push(()=>ge.unsubscribe());const De=AB(U,Oe=>{console.log(" [Realtime] EstimateAddonItems  :",Oe.eventType),se()});D.push(()=>De.unsubscribe());const Ne=lB(U,Oe=>{console.log(" [Realtime] EstimateAdditionalCosts  :",Oe.eventType),se()});D.push(()=>Ne.unsubscribe());const Ze=l1(U,Oe=>{console.log(" [Realtime] EstimateComments  :",Oe.eventType)});D.push(()=>Ze.unsubscribe()),console.log(" [Realtime]     (7 )")}function re(){const{phone1:U,phone2:Ae,phone3:fe}=o();U&&Ae&&fe&&Et.update(Ce=>({...Ce,orderPhone:`${U}-${Ae}-${fe}`}))}function pe(U){if(U&&U.includes("-")){const Ae=U.split("-");Ae.length===3&&Et.update(fe=>({...fe,phone1:Ae[0]||"010",phone2:Ae[1]||"",phone3:Ae[2]||""}))}}function V(){return te?Promise.resolve():new Promise(U=>{const Ae=document.createElement("script");Ae.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",Ae.onload=()=>{te=!0,U()},document.head.appendChild(Ae)})}async function K(){try{await V(),new window.daum.Postcode({oncomplete(U){Et.update(Ae=>({...Ae,postcode:U.zonecode,address1:U.roadAddress||U.jibunAddress}))},onresize(U){}}).open()}catch{_(y,!0),_(b,"  "),_(S,"     .    .")}}En(async()=>{Ls.set({id:d(),name:"",sess:A(),customer_id:a()}),sl.set({name:"",phone:"",address1:"",address2:"",postcode:"",mallType:i()}),c()?await ae(c()):await oe()}),Eo(()=>{D.forEach(U=>{try{U()}catch(Ae){console.error("   :",Ae)}}),D=[]});async function oe(){_(f,!0);try{const U=await o1(i(),a(),A());U?(_(h,U),_(m,Cd(U.status)),await I(U),ce(U.id)):(Et.reset(),_(m,!0))}catch{_(y,!0),_(b," "),_(S,"     .")}finally{_(f,!1)}}async function ae(U){_(f,!0);try{let Ae=await _u(U);if(Ae){const fe=!!(A()||a());if(_B(Ae)&&fe){console.log("[loadEstimateById]    ,   ...");const ge=await bB(U,d(),A()||null,a()||null,i()||null);if(ge.success&&ge.newEstimateId){if(console.log(`[loadEstimateById]   : ${U}  ${ge.newEstimateId}`),x(ge.newEstimateId),Ae=await _u(ge.newEstimateId),!Ae)throw new Error("    .");c(ge.newEstimateId)}else{console.error("[loadEstimateById]   :",ge.error),_(y,!0),_(b," "),_(S,`    : ${ge.error}`);return}}_(h,Ae),_(m,Cd(Ae.status)),await I(Ae),ce(Ae.id)}else _(y,!0),_(b," "),_(S,"   .")}catch(Ae){console.error("[loadEstimateById] :",Ae),_(y,!0),_(b," "),_(S,"    .")}finally{_(f,!1)}}function x(U){try{const Ae=new URL(window.location.href);Ae.searchParams.set("estimateId",U),window.history.replaceState({},"",Ae.toString()),console.log(`[updateUrlWithNewEstimateId] URL  : ${Ae.toString()}`)}catch(Ae){console.error("[updateUrlWithNewEstimateId] URL  :",Ae)}}function E(U){const Ae={delivery:"",pickup:"",quick:""};return U&&Ae[U]||""}async function I(U){try{Kt(Et,lt(o).estimateName=U.name||"",lt(o)),Kt(Et,lt(o).organizationName=U.organization_name||"",lt(o)),Kt(Et,lt(o).orderName=U.order_name||"",lt(o)),Kt(Et,lt(o).orderPhone=U.order_phone||"",lt(o)),Kt(Et,lt(o).postcode=U.postcode||"",lt(o)),Kt(Et,lt(o).address1=U.address1||"",lt(o)),Kt(Et,lt(o).address2=U.address2||"",lt(o)),Kt(Et,lt(o).comment=U.comment||"",lt(o)),Kt(Et,lt(o).shippingMethod=E(U.shipping_method),lt(o)),Kt(Et,lt(o).prefDeliveryDate=U.pref_delivery_date||"",lt(o)),Kt(Et,lt(o).uploadMemo=U.upload_memo||"",lt(o)),Kt(Et,lt(o).designConfirm=U.design_confirm||"",lt(o)),U.order_phone&&pe(U.order_phone),await M(U.id)}catch(Ae){Ae instanceof SyntaxError&&Ae.message.includes("JSON")?(_(y,!0),_(b," "),_(S,"    .  .")):(_(y,!0),_(b," "),_(S,"    ."))}}function L(U){if(U==null)return null;if(typeof U=="object")return U;if(typeof U=="string")try{return JSON.parse(U)}catch{return null}return U}async function M(U){var Ae;try{const fe=await xu(U),Ce=await Nd(U),ge=await eB(U),De=await eg(U),Ne=await u1(U),Ze=[],Oe={};for(const Ke of fe)if(Ke.product_id&&Ke.product){const Je=Ke.idx||0;if(Oe[Je]||(Oe[Je]={product:Ke.product,variants:[],quantity:0,prints:[],addons:{},print_type:Ke.print_type||"none",simplePrints:[]}),Ke.variant_id&&Ke.quantity){const Te=Ke.original_price?parseFloat(Ke.original_price.toString()):0,_e=Ke.price?parseFloat(Ke.price.toString()):0,Ue=Te>0,Me=Ue?Te:_e,je={id:Ke.variant_id,quantity:Ke.quantity,prices:[{amount:Me}],thumbnail:((Ae=Ke.variant)==null?void 0:Ae.thumbnail)||null,title:Ke.variant_title||` ${Ke.variant_id.substring(0,4)}`,discountInfo:Ue&&Ke.discount_amount?{discountAmount:Ke.discount_amount,discountType:Ke.discount_type,discountValue:Ke.discount_value,discountDirection:Ke.discount_direction}:void 0,isDiscountedPrice:!Ue};Oe[Je].variants.push(je),Oe[Je].quantity+=Ke.quantity}}for(const Ke of Ce)if(Ke.template_id&&Ke.estimate_id){const Je=Ke.idx||0;if(Oe[Je]){const Te={template:{id:Ke.template_id,name:""},price:Ke.price||0,colors:L(Ke.colors)||[],uploads:L(Ke.uploads)||null,title:"",objectId:Ke.object_id||null,variant_id:Ke.variant_id||null};Oe[Je].prints.push(Te)}}for(const Ke of ge){const Je=Ke.idx||0;Oe[Je]&&(Oe[Je].simplePrints||(Oe[Je].simplePrints=[]),Oe[Je].simplePrints.push({object_id:Ke.object_id||null,title:Ke.title||" ",print_method:Ke.print_method||"none",uploaded_files:L(Ke.uploaded_files)||null,file_metadata:L(Ke.file_metadata)||null,price:Ke.price||0}))}De.forEach(Ke=>{const Je=Ke.idx||0;Oe[Je]&&(Oe[Je].addons||(Oe[Je].addons={}),Oe[Je].addons[Ke.addon_id]={productId:Ke.selected_product_id,variantId:Ke.selected_variant_id||"",price:Ke.price||0,quantity:Ke.quantity||1})});for(const Ke in Oe)Ze.push({...Oe[Ke],idx:parseInt(Ke)});Kt(Et,lt(o).products=Ze,lt(o)),Kt(Et,lt(o).index=(Ze.length>0,0),lt(o)),Et.updateTotalAmounts()}catch(fe){throw fe instanceof SyntaxError&&fe.message.includes("JSON")?(_(y,!0),_(b," "),_(S,"     .  .")):(_(y,!0),_(b," "),_(S,"     .")),fe}}function H(U){_(g,!1)}function q(U){var Ae,fe;try{const Ce=o().products[U];if(!Ce||Ce.idx===void 0){_(y,!0),_(b," "),_(S,"    .");return}if(!((Ae=Ce.product)!=null&&Ae.id)){_(y,!0),_(b," "),_(S," ID   .");return}if(!((fe=l(h))!=null&&fe.id)){_(y,!0),_(b," "),_(S,"    .");return}j=U,_(J,Ce.product.id),_(we,Ce.idx),Z=!0,console.log(" [Edit]    - Realtime   "),_($,!0)}catch{_(y,!0),_(b,""),_(S,"    .")}}function G(){_($,!1),j=-1,_(J,""),_(we,-1),Z=!1,console.log(" [Edit]    - Realtime   ")}async function R(){var U,Ae,fe,Ce,ge,De,Ne,Ze,Oe,Ke,Je,Te,_e;_(k,!0);try{if(!((U=l(h))!=null&&U.id))throw new Error(" ID .");if(l(we)===-1)throw new Error(" idx  .");const Ue=hn(ur);if(!Ue||!Ue.productSelection)throw new Error("  .");if(!Ue.productSelection.quantityByVariant||Object.keys(Ue.productSelection.quantityByVariant).length===0)throw new Error("   .");await U0(l(h).id,l(we));const Me=[],{quantityByVariant:je,variantDiscounts:At,variantsByColor:ut}=Ue.productSelection;let ht="none";if(typeof window<"u"){const Re=l(h).id||"temp",Xe=`detailedPrint_${l(J)}_${Re}`,tt=`simplePrint_${l(J)}_${Re}`,rt=window.sessionStorage.getItem(Xe),Bt=window.sessionStorage.getItem(tt);if(rt)try{const nt=JSON.parse(rt);Array.isArray(nt)&&nt.length>0&&(ht="detailed")}catch{}if(ht==="none"&&Bt)try{const nt=JSON.parse(Bt);Array.isArray(nt)&&nt.length>0&&(ht="simple")}catch{}if(ht==="none"&&((Ae=Ue.printSelection)!=null&&Ae.currentMethod)){const nt=Ue.printSelection.currentMethod;(nt==="detailed"||nt==="simple"||nt==="self-design")&&(ht=nt)}}console.log(" [Edit ]  print_type:",ht),console.log(" [Edit ] currentStore.printSelection:",Ue.printSelection);for(const Re in je)for(const Xe in je[Re]){const tt=je[Re][Xe];if(tt>0){const rt=At==null?void 0:At[Xe],Bt=(fe=ut[Re])==null?void 0:fe.find(xt=>xt.id===Xe),nt=((ge=(Ce=Bt==null?void 0:Bt.prices)==null?void 0:Ce[0])==null?void 0:ge.amount)||0,ot=(rt==null?void 0:rt.discountedPrice)||nt;Me.push({estimate_id:l(h).id,product_id:Ue.productId,variant_id:Xe,quantity:tt,price:ot,original_price:nt,discount_amount:(rt==null?void 0:rt.discountAmount)||0,discount_type:((De=rt==null?void 0:rt.discountInfo)==null?void 0:De.type)||null,discount_value:((Ne=rt==null?void 0:rt.discountInfo)==null?void 0:Ne.value)||null,discount_direction:((Ze=rt==null?void 0:rt.discountInfo)==null?void 0:Ze.direction)||null,discount_min_quantity:((Oe=rt==null?void 0:rt.discountInfo)==null?void 0:Oe.min_quantity)||null,discount_max_quantity:((Ke=rt==null?void 0:rt.discountInfo)==null?void 0:Ke.max_quantity)||null,idx:l(we),print_type:ht})}}if(Me.length>0){const{error:Re}=await ft.from("estimate_items").insert(Me);if(Re)throw new Error(`  : ${Re.message}`)}if(typeof window<"u"){const Re=l(h).id||"temp",Xe=`detailedPrint_${l(J)}_${Re}`,tt=window.sessionStorage.getItem(Xe);if(tt){const nt=JSON.parse(tt),ot=((Je=Ue.productSelection)==null?void 0:Je.totalQuantity)||0;async function xt(_t,vt){var Pt,kt,Ct,Ft;try{const zt=((Pt=_t.template)==null?void 0:Pt.id)||_t.template_id;if(!zt)return _t.price||0;const Tt=await Gd(zt);if(!(Tt!=null&&Tt.template_product_variants)||Tt.template_product_variants.length===0)return _t.price||0;let Rt=null;_t.variant_id&&(Rt=Tt.template_product_variants.find(tr=>tr.variant_id===_t.variant_id)),!Rt&&Array.isArray(_t.colors)&&_t.colors.length>0&&(Rt=Tt.template_product_variants.find(tr=>tr.color_count===_t.colors.length)),Rt||(Rt=Tt.template_product_variants[0]);const Dt=await mA(Rt.variant_id),Mt=((Ct=(kt=Dt==null?void 0:Dt.prices)==null?void 0:kt[0])==null?void 0:Ct.amount)||0;if(Rt.min_quantity&&vt<Rt.min_quantity)return Rt.plate_price||0;let Gt=Mt;const lr=((Ft=Tt.product)==null?void 0:Ft.quantity_discounts)||[];if(lr.length>0){const tr=mi(vt,Mt,lr);tr!=null&&tr.hasDiscount&&(Gt=tr.discountedPrice)}return Gt*vt}catch{return _t.price||0}}const Lt=await Promise.all(nt.map(async _t=>{var Pt,kt,Ct,Ft,zt,Tt,Rt,Dt,Mt,Gt,lr,tr,sr;const vt=await xt(_t,ot);return{estimate_id:l(h).id,template_id:((Pt=_t.template)==null?void 0:Pt.id)||_t.template_id||null,colors:_t.colors||[],price:vt,object_id:_t.objectId||_t.object_id||null,variant_id:_t.variant_id||null,name_sheet:_t.nameSheet||_t.name_sheet||null,uploads:_t.uploads||null,original_price:_t.original_price||((kt=_t.discountInfo)==null?void 0:kt.originalPrice)||vt||0,discount_amount:_t.discount_amount||((Ct=_t.discountInfo)==null?void 0:Ct.discountAmount)||0,discount_type:_t.discount_type||((zt=(Ft=_t.discountInfo)==null?void 0:Ft.discountDetails)==null?void 0:zt.type)||null,discount_value:_t.discount_value||((Rt=(Tt=_t.discountInfo)==null?void 0:Tt.discountDetails)==null?void 0:Rt.value)||null,discount_direction:_t.discount_direction||((Mt=(Dt=_t.discountInfo)==null?void 0:Dt.discountDetails)==null?void 0:Mt.direction)||null,discount_min_quantity:_t.discount_min_quantity||((lr=(Gt=_t.discountInfo)==null?void 0:Gt.discountDetails)==null?void 0:lr.min_quantity)||null,discount_max_quantity:_t.discount_max_quantity||((sr=(tr=_t.discountInfo)==null?void 0:tr.discountDetails)==null?void 0:sr.max_quantity)||null,idx:l(we)}}));if(Lt.length>0){const{error:_t}=await ft.from("estimate_prints").insert(Lt);if(_t)throw new Error(`   : ${_t.message}`)}}const rt=`simplePrint_${l(J)}_${Re}`,Bt=window.sessionStorage.getItem(rt);if(Bt){const ot=JSON.parse(Bt).map(xt=>({estimate_id:l(h).id,object_id:xt.objectId||xt.object_id||null,title:xt.title||null,print_method:xt.printMethod||xt.print_method||null,uploaded_files:xt.uploadedFiles||xt.uploaded_files||null,file_metadata:xt.savedFileInfo||xt.file_metadata||null,price:xt.price||0,idx:l(we)}));if(ot.length>0){const{error:xt}=await ft.from("estimate_simple_prints").insert(ot);if(xt)throw new Error(`   : ${xt.message}`)}}}if((Te=Ue.addonSelection)!=null&&Te.selectedAddons){const Re=[],Xe=((_e=Ue.productSelection)==null?void 0:_e.totalQuantity)||0;for(const[tt,rt]of Object.entries(Ue.addonSelection.selectedAddons)){const Bt=rt;let nt=0;if(Bt.variantId)try{const{data:ot,error:xt}=await ft.from("prices").select("amount").eq("variant_id",Bt.variantId).single();!xt&&ot&&(nt=ot.amount)}catch{}Re.push({estimate_id:l(h).id,addon_id:tt,selected_product_id:Bt.productId,selected_variant_id:Bt.variantId||null,price:nt,quantity:Xe,idx:l(we)})}if(Re.length>0){const{error:tt}=await ft.from("estimate_addon_items").insert(Re);if(tt)throw new Error(`  : ${tt.message}`)}}_(P,!0),setTimeout(()=>{_(P,!1)},3e3),G(),await M(l(h).id)}catch(Ue){let Me="     .";Ue instanceof Error&&(Me=Ue.message,Ue.message.includes("duplicate key")?Me="  .  .":Ue.message.includes("foreign key")?Me="   .     .":Ue.message.includes("not null")?Me="  .    .":Ue.message.includes("permission")&&(Me="   .  .")),_(y,!0),_(b," "),_(S,Me)}finally{_(k,!1)}}async function he(U){var Ae;try{const fe=o().products[U];if(!fe||fe.idx===void 0){_(y,!0),_(b," "),_(S,"    .");return}if(!((Ae=l(h))!=null&&Ae.id)){_(y,!0),_(b," "),_(S,"    .");return}await U0(l(h).id,fe.idx),Kt(Et,lt(o).products=o().products.filter((Ce,ge)=>ge!==U),lt(o)),Et.updateTotalAmounts()}catch{_(y,!0),_(b," "),_(S,"    .")}}function Be(U){const Ae={:"delivery",:"pickup",:"quick"};return U&&Ae[U]||null}async function be(){var U;if(!l(s)){_(y,!0),_(b," "),_(S,"    .");return}re(),_(k,!0);try{if(!((U=l(h))!=null&&U.id))throw new Error("  .");const Ae=Be(o().shippingMethod);await Dd(l(h).id,{name:o().estimateName,organization_name:o().organizationName,order_name:o().orderName,order_phone:o().orderPhone,postcode:o().postcode,address1:o().address1,address2:o().address2,comment:o().comment||null,shipping_method:Ae,pref_delivery_date:o().prefDeliveryDate||null,upload_memo:o().uploadMemo||null,design_confirm:o().designConfirm||"none"}),await rB(l(h).id,"pending"),_(P,!0),setTimeout(()=>{_(P,!1)},3e3),_(y,!0),_(b," "),_(S,"  ."),_(F,()=>{window.location.href="/?mode=list"})}catch(Ae){_(y,!0),_(b," "),_(S,Ae instanceof Error?Ae.message:"    ."),_(F,void 0)}finally{_(k,!1)}}Zt(()=>o(),()=>{_(s,o().estimateName&&o().orderName&&o().phone1&&o().phone2&&o().phone3&&o().postcode&&o().address1)}),Zn(),qr();var Le=m9(),Y=gt(Le),O=w(Y);{var ve=U=>{var Ae=l9();T(U,Ae)},xe=U=>{var Ae=v9(),fe=w(Ae);{var Ce=Wt=>{var $r=d9(),Fn=w($r);at("click",Fn,()=>window.location.href=`?mode=${u()}`),T(Wt,$r)};Se(fe,Wt=>{c()&&Wt(Ce)})}var ge=z(fe,2);{var De=Wt=>{var $r=c9(),Fn=w($r);r1(Fn,{class:"odz-w-4 odz-h-4"}),T(Wt,$r)};Se(ge,Wt=>{l(P)&&Wt(De)})}var Ne=z(ge,2),Ze=w(Ne);{var Oe=Wt=>{zB(Wt,{onSelectProduct:q,onDeleteProduct:he,get isEditable(){return l(m)},set isEditable($r){_(m,$r)},$$legacy:!0})},Ke=Wt=>{var $r=h9(),Fn=w($r);uE(Fn,{class:"odz-w-16 odz-h-16 odz-text-gray-300 odz-mx-auto odz-mb-4"});var ys=z(Fn,4);{var Uo=bs=>{var eo=u9();at("click",eo,()=>_(g,!0)),T(bs,eo)};Se(ys,bs=>{l(m)&&bs(Uo)})}T(Wt,$r)};Se(Ze,Wt=>{o().products&&o().products.length>0?Wt(Oe):Wt(Ke,!1)})}var Je=z(Ne,2),Te=w(Je),_e=w(Te),Ue=z(w(_e),2),Me=z(_e,2),je=z(w(Me),2),At=z(Me,2),ut=z(w(At),2),ht=z(At,2),Re=z(w(ht),2),Xe=w(Re);He(()=>{o(),ip(()=>{l(m)})});var tt=w(Xe);tt.value=(tt.__value="010")==null?"":"010";var rt=z(tt);rt.value=(rt.__value="011")==null?"":"011";var Bt=z(rt);Bt.value=(Bt.__value="016")==null?"":"016";var nt=z(Bt);nt.value=(nt.__value="017")==null?"":"017";var ot=z(nt);ot.value=(ot.__value="018")==null?"":"018";var xt=z(ot);xt.value=(xt.__value="019")==null?"":"019";var Lt=z(Xe,2),_t=z(Lt,2),vt=z(ht,4),Pt=z(w(vt),2),kt=w(Pt),Ct=z(kt,2),Ft=z(vt,2),zt=z(w(Ft),2),Tt=z(Ft,2),Rt=z(w(Tt),2),Dt=z(Tt,2),Mt=z(w(Dt),2);He(()=>{o(),ip(()=>{l(m)})});var Gt=w(Mt);Gt.value=((Gt.__value="")==null,"");var lr=z(Gt);lr.value=(lr.__value="")==null?"":"";var tr=z(lr);tr.value=(tr.__value="")==null?"":"";var sr=z(tr);sr.value=(sr.__value="")==null?"":"";var Ht=z(Dt,2),mr=z(w(Ht),2),kr=z(Ht,2),Kr=z(w(kr),2),Sr=z(Je,2),fr=w(Sr),Lr=w(fr),xr=z(w(Lr),2),Ar=w(xr),pr=z(Lr,2),Pr=z(w(pr),2),gn=w(Pr),vn=z(pr,2),zr=z(w(vn),2),dr=w(zr),xn=z(vn,2);{var Fo=Wt=>{var $r=f9(),Fn=z(w($r),2),ys=w(Fn);He(Uo=>Qe(ys,`-${Uo??""}`),[()=>vr(o().totalDiscountAmount)],it),T(Wt,$r)};Se(xn,Wt=>{o().totalDiscountAmount>0&&Wt(Fo)})}var io=z(xn,2),bo=z(w(io),2),ns=w(bo),On=z(Sr,2);{var Io=Wt=>{var $r=g9(),Fn=w($r),ys=w(Fn);{var Uo=eo=>{var ks=p9();T(eo,ks)},bs=eo=>{var ks=Wr(" ");T(eo,ks)};Se(ys,eo=>{l(k)?eo(Uo):eo(bs,!1)})}He(()=>Fn.disabled=l(k)||!l(s)),at("click",Fn,be),T(Wt,$r)};Se(On,Wt=>{l(m)&&Wt(Io)})}He((Wt,$r,Fn)=>{Ue.disabled=!l(m),je.disabled=!l(m),ut.disabled=!l(m),Xe.disabled=!l(m),Lt.disabled=!l(m),_t.disabled=!l(m),Ct.disabled=!l(m),Rt.disabled=!l(m),Mt.disabled=!l(m),mr.disabled=!l(m),Kr.disabled=!l(m),Qe(Ar,`${o().totalQuantity||0}`),Qe(gn,Wt),Qe(dr,$r),Qe(ns,Fn)},[()=>vr(o().totalProductAmount),()=>vr(o().totalPrintAmount),()=>vr(o().totalAmount)],it),br(Ue,()=>o().estimateName,Wt=>Kt(Et,lt(o).estimateName=Wt,lt(o))),br(je,()=>o().organizationName,Wt=>Kt(Et,lt(o).organizationName=Wt,lt(o))),br(ut,()=>o().orderName,Wt=>Kt(Et,lt(o).orderName=Wt,lt(o))),ap(Xe,()=>o().phone1,Wt=>Kt(Et,lt(o).phone1=Wt,lt(o))),at("change",Xe,re),br(Lt,()=>o().phone2,Wt=>Kt(Et,lt(o).phone2=Wt,lt(o))),at("input",Lt,re),br(_t,()=>o().phone3,Wt=>Kt(Et,lt(o).phone3=Wt,lt(o))),at("input",_t,re),br(kt,()=>o().postcode,Wt=>Kt(Et,lt(o).postcode=Wt,lt(o))),at("click",Ct,K),br(zt,()=>o().address1,Wt=>Kt(Et,lt(o).address1=Wt,lt(o))),br(Rt,()=>o().address2,Wt=>Kt(Et,lt(o).address2=Wt,lt(o))),ap(Mt,()=>o().shippingMethod,Wt=>Kt(Et,lt(o).shippingMethod=Wt,lt(o))),br(mr,()=>o().prefDeliveryDate,Wt=>Kt(Et,lt(o).prefDeliveryDate=Wt,lt(o))),br(Kr,()=>o().comment,Wt=>Kt(Et,lt(o).comment=Wt,lt(o))),T(U,Ae)};Se(O,U=>{l(f)?U(ve):U(xe,!1)})}var me=z(Y,2);{var le=U=>{G1(U,{addProduct:H,productType:"godo",get isProductSearchOpen(){return l(g)},set isProductSearchOpen(Ae){_(g,Ae)},$$legacy:!0})};Se(me,U=>{l(g)&&U(le)})}var ze=z(me,2);{var ke=U=>{A9(U,{get isOpen(){return l($)},get estimateId(){return l(h).id},get idx(){return l(we)},get productId(){return l(J)},onClose:G,onSave:R})};Se(ze,U=>{l($)&&l(h)&&U(ke)})}var de=z(ze,2);Wd(de,{get onClose(){return l(F)},get isOpen(){return l(y)},set isOpen(U){_(y,U)},get title(){return l(b)},set title(U){_(b,U)},get message(){return l(S)},set message(U){_(S,U)},$$legacy:!0});var Fe=z(de,2);Xd(Fe,{get isLoading(){return l(f)},set isLoading(U){_(f,U)},$$legacy:!0}),T(n,Le),jr(),r()}const Nb={qnaId:null,title:"",content:"",customerName:"",customerPhone:"",customerEmail:"",products:[],nextIdx:0,editingIdx:null,editingProductId:null,isLoading:!1,isSaving:!1};function y9(){const{subscribe:n,set:e,update:t}=vl({...Nb});return{subscribe:n,reset:()=>{e({...Nb})},setQnaId:r=>{t(o=>({...o,qnaId:r}))},setTitle:r=>{t(o=>({...o,title:r}))},setContent:r=>{t(o=>({...o,content:r}))},setCustomerInfo:(r,o,s)=>{t(i=>({...i,customerName:r,customerPhone:o,customerEmail:s}))},addProduct:r=>{t(o=>{const s={...r,idx:o.nextIdx};return{...o,products:[...o.products,s],nextIdx:o.nextIdx+1}})},updateProduct:(r,o)=>{t(s=>({...s,products:s.products.map(i=>i.idx===r?{...i,...o}:i)}))},removeProduct:r=>{t(o=>({...o,products:o.products.filter(s=>s.idx!==r)}))},setEditing:(r,o)=>{t(s=>({...s,editingIdx:r,editingProductId:o}))},clearEditing:()=>{t(r=>({...r,editingIdx:null,editingProductId:null}))},setLoading:r=>{t(o=>({...o,isLoading:r}))},setSaving:r=>{t(o=>({...o,isSaving:r}))},setState:r=>{t(o=>({...o,...r}))},getState:()=>hn({subscribe:n})}}const di=y9();function Mz(n,e,t){return`qna_product_${e}_${n||"new"}_${t}`}function Hz(n,e,t,r){const o=Mz(n,e,t);try{sessionStorage.setItem(o,JSON.stringify(r))}catch(s){console.error("[QnaStore] Failed to save to session:",s)}}function b9(n,e,t){const r=Mz(n,e,t);try{const o=sessionStorage.getItem(r);return o?JSON.parse(o):null}catch(o){return console.error("[QnaStore] Failed to load from session:",o),null}}function a0(n){try{const e=[];for(let t=0;t<sessionStorage.length;t++){const r=sessionStorage.key(t);r&&r.startsWith("qna_product_")&&r.includes(`_${n||"new"}_`)&&e.push(r)}e.forEach(t=>sessionStorage.removeItem(t))}catch(e){console.error("[QnaStore] Failed to clear all session:",e)}}async function _9(n){const{data:e,error:t}=await ft.rpc("hash_inquiry_password",{plain_password:n});if(t)throw console.error("[QnaService] hashPassword error:",t),t;return e}async function B9(n,e){const{data:t,error:r}=await ft.rpc("verify_inquiry_password",{inquiry_id_param:n,plain_password:e});if(r)throw console.error("[QnaService] verifyPassword error:",r),r;return t===!0}async function x9(n,e){try{const t=await Pg(n);return t?t.customer_id?e&&t.customer_id===e?{canAccess:!0,requiresPassword:!1}:{canAccess:!1,requiresPassword:!1,message:"     ."}:{canAccess:!1,requiresPassword:!0,message:" ."}:{canAccess:!1,requiresPassword:!1,message:"   ."}}catch(t){return console.error("[QnaService] checkQnaAccess error:",t),{canAccess:!1,requiresPassword:!1,message:"     ."}}}async function z9(n,e){try{return await B9(n,e)?{canAccess:!0,requiresPassword:!1}:{canAccess:!1,requiresPassword:!0,message:"  ."}}catch(t){return console.error("[QnaService] accessQnaWithPassword error:",t),{canAccess:!1,requiresPassword:!0,message:"    ."}}}function C9(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),i=String(Math.floor(Math.random()*1e3)).padStart(3,"0");return`Q${e}${t}${r}${o}${s}${i}`}async function S9(n){const e=C9();let t;!n.customer_id&&n.password&&(t=await _9(n.password));const{password:r,...o}=n,s={...o,inquiry_no:e,status:n.status||"pending"};t&&(s.password=t);const{data:i,error:a}=await ft.from("inquiries").insert(s).select().single();if(a)throw console.error("[QnaService] createQna error:",a),a;return i}async function Pg(n){const{data:e,error:t}=await ft.from("inquiries").select("*").eq("id",n).single();if(t){if(t.code==="PGRST116")return null;throw console.error("[QnaService] getQnaById error:",t),t}return e}async function E9(n,e,t){let r=ft.from("inquiries").select("*").eq("shop_id",n).order("created_at",{ascending:!1});const{data:o,error:s}=await r;if(s)throw console.error("[QnaService] getQnaList error:",s),s;return o||[]}async function e2(n,e){const{data:t,error:r}=await ft.from("inquiries").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(r)throw console.error("[QnaService] updateQna error:",r),r;return t}async function jz(n,e){return e2(n,{status:e})}async function F9(n){const{error:e}=await ft.from("inquiries").delete().eq("id",n);if(e)throw console.error("[QnaService] deleteQna error:",e),e}async function I9(n,e){const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_items").insert(t).select();if(o)throw console.error("[QnaService] addQnaItems error:",o),o;return r||[]}async function t2(n){const{data:e,error:t}=await ft.from("inquiry_items").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaItems error:",t),t;return e||[]}async function U9(n){const{error:e}=await ft.from("inquiry_items").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaItems error:",e),e}async function Q9(n,e){const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_prints").insert(t).select();if(o)throw console.error("[QnaService] addQnaPrints error:",o),o;return r||[]}async function r2(n){const{data:e,error:t}=await ft.from("inquiry_prints").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaPrints error:",t),t;return e||[]}async function T9(n){const{error:e}=await ft.from("inquiry_prints").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaPrints error:",e),e}async function Rz(n,e){const{data:t,error:r}=await ft.from("inquiry_comments").insert({...e,inquiry_id:n}).select().single();if(r)throw console.error("[QnaService] addQnaComment error:",r),r;return e.writer==="manager"&&await jz(n,"answered"),t}async function L9(n){const{data:e,error:t}=await ft.from("inquiry_comments").select("*").eq("inquiry_id",n).order("created_at",{ascending:!0});if(t)throw console.error("[QnaService] getQnaComments error:",t),t;return e||[]}async function P9(n){const{error:e}=await ft.from("inquiry_comments").delete().eq("id",n);if(e)throw console.error("[QnaService] deleteQnaComment error:",e),e}async function k9(n){const e=await Pg(n);if(!e)throw new Error("   .");const t=await t2(n),r=await r2(n),o=await o2(n),s=await s2(n),i=await s1({shop_id:e.shop_id,customer_id:e.customer_id,name:e.title,order_name:e.customer_name,phone:e.customer_phone,email:e.customer_email,status:"temp",memo:`: ${e.inquiry_no}

${e.content}`});if(!i.id)throw new Error("  .");for(const a of t)await i1({estimate_id:i.id,idx:a.idx,product_id:a.product_id,variant_id:a.variant_id,quantity:a.quantity});for(const a of r)a.print_type==="simple"?await I0({estimate_id:i.id,idx:a.idx,object_id:a.object_id,title:a.title,print_method:a.print_method,uploaded_files:a.uploaded_files,file_metadata:a.file_metadata}):a.print_type==="detailed"&&await a1({estimate_id:i.id,idx:a.idx,object_id:a.object_id,template_id:a.template_id,colors:a.colors,uploads:a.uploaded_files});for(const a of o)await I0({estimate_id:i.id,idx:a.idx,object_id:a.object_id,print_method:a.print_method,template_id:a.template_id,selected_colors:a.selected_colors,print_config:a.print_config,uploads:a.uploads,name_sheet:a.name_sheet,memo:a.memo});for(const a of s)await c1({estimate_id:i.id,idx:a.idx,addon_id:a.addon_id,selected_product_id:a.selected_product_id,selected_variant_id:a.selected_variant_id});return await e2(n,{converted_estimate_id:i.id,status:"closed"}),await Rz(n,{writer:"system",writer_name:"",content:` . (: ${i.estimate_no})`}),i.id}function O9(n,e){return ft.channel(`qna-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiries",filter:`id=eq.${n}`},e).subscribe()}function D9(n,e){return ft.channel(`qna-list-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiries",filter:`shop_id=eq.${n}`},e).subscribe()}function N9(n,e){return ft.channel(`qna-comments-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiry_comments",filter:`inquiry_id=eq.${n}`},e).subscribe()}function n2(n){n&&ft.removeChannel(n)}async function M9(n,e){if(e.length===0)return[];const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_simple_prints").insert(t).select();if(o)throw console.error("[QnaService] addQnaSimplePrints error:",o),o;return r||[]}async function o2(n){const{data:e,error:t}=await ft.from("inquiry_simple_prints").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaSimplePrints error:",t),t;return e||[]}async function H9(n){const{error:e}=await ft.from("inquiry_simple_prints").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaSimplePrints error:",e),e}async function j9(n,e){if(e.length===0)return[];const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_addon_items").insert(t).select();if(o)throw console.error("[QnaService] addQnaAddonItems error:",o),o;return r||[]}async function s2(n){const{data:e,error:t}=await ft.from("inquiry_addon_items").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaAddonItems error:",t),t;if(!e||e.length===0)return[];const r=[...new Set(e.map(h=>h.addon_id).filter(Boolean))],o=[...new Set(e.map(h=>h.selected_product_id).filter(Boolean))],s=[...new Set(e.map(h=>h.selected_variant_id).filter(Boolean))],[i,a,A]=await Promise.all([r.length>0?ft.from("product_addons").select("id, name").in("id",r):{data:[]},o.length>0?ft.from("products").select("id, title").in("id",o):{data:[]},s.length>0?ft.from("product_variants").select("id, title").in("id",s):{data:[]}]),d=new Map((i.data||[]).map(h=>[h.id,h.name])),c=new Map((a.data||[]).map(h=>[h.id,h.title])),u=new Map((A.data||[]).map(h=>[h.id,h.title]));return e.map(h=>({...h,addon_name:d.get(h.addon_id)||null,selected_product_name:c.get(h.selected_product_id)||null,selected_variant_name:u.get(h.selected_variant_id)||null}))}async function R9(n){const{error:e}=await ft.from("inquiry_addon_items").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaAddonItems error:",e),e}async function q9(n){const{data:e}=await ft.from("inquiry_items").select("quantity, price").eq("inquiry_id",n);let t=0,r=0;if(e)for(const h of e){const f=h.quantity||0,g=h.price||0;t+=f*g,r+=f}const{data:o}=await ft.from("inquiry_prints").select("price").eq("inquiry_id",n);let s=0;if(o)for(const h of o)s+=h.price||0;const{data:i}=await ft.from("inquiry_simple_prints").select("price").eq("inquiry_id",n);if(i)for(const h of i)s+=h.price||0;const{data:a}=await ft.from("inquiry_addon_items").select("price, quantity").eq("inquiry_id",n);let A=0;if(a)for(const h of a){const f=h.quantity||1,g=h.price||0;A+=f*g}const{data:d}=await ft.from("inquiry_additional_costs").select("amount").eq("inquiry_id",n);let c=0;if(d)for(const h of d)c+=h.amount||0;const u=t+s+A+c;return{product_amount:t,print_amount:s,addon_amount:A,additional_amount:c,total_quantity:r,total_amount:u}}async function K9(n){const e=await q9(n),{error:t}=await ft.from("inquiries").update({product_amount:e.product_amount,print_amount:e.print_amount,addon_amount:e.addon_amount,additional_amount:e.additional_amount,total_quantity:e.total_quantity,total_amount:e.total_amount,updated_at:new Date().toISOString()}).eq("id",n);if(t)throw console.error("[QnaService] updateInquirySummary error:",t),t}async function $9(n){const{data:e,error:t}=await ft.from("inquiry_estimates").select(`
      id,
      inquiry_id,
      estimate_id,
      created_at,
      created_by,
      memo,
      estimates:estimate_id (
        estimate_no,
        status,
        total_amount,
        created_at,
        name
      )
    `).eq("inquiry_id",n).order("created_at",{ascending:!1});if(t)throw console.error("[QnaService] getLinkedEstimates error:",t),t;return(e||[]).map(r=>({id:r.id,inquiry_id:r.inquiry_id,estimate_id:r.estimate_id,created_at:r.created_at,created_by:r.created_by,memo:r.memo,estimate:r.estimates}))}var V9=ee(`<div class="odz-text-center odz-py-8 odz-bg-gray-50 odz-rounded-lg odz-border odz-border-dashed odz-border-gray-300"><!> <p class="odz-text-gray-500">  .</p> <p class="odz-text-sm odz-text-gray-400 odz-mt-1">   ' '  .</p></div>`),G9=ee('<div class="odz-flex odz-gap-1"><button type="button" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square" title=""><!></button> <button type="button" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square odz-text-error" title=""><!></button></div>'),W9=ee('<li class="odz-flex odz-justify-between"><span> </span> <span class="odz-font-medium"> </span></li>'),X9=ee('<div class="odz-mt-3 odz-bg-gray-50 odz-rounded odz-p-2"><ul class="odz-text-xs odz-text-gray-600 odz-space-y-1"></ul></div>'),Y9=ee('<span class="odz-text-gray-400"></span>'),J9=ee('<span class="odz-text-blue-800"> </span> <!>',1),Z9=ee('<span class="odz-flex odz-items-center odz-gap-1"></span>'),eq=ee("<span> </span>"),tq=ee('<span class="odz-text-blue-500"> </span>'),rq=ee('<span class="odz-text-gray-500"> </span>'),nq=ee('<li class="odz-flex odz-flex-wrap odz-items-center odz-gap-1"><!> <!> <!></li>'),oq=ee('<div class="odz-mt-2 odz-bg-blue-50 odz-rounded odz-p-2"><p class="odz-text-xs odz-font-medium odz-text-blue-800 odz-mb-1"> </p> <ul class="odz-text-xs odz-text-blue-700 odz-space-y-1"></ul></div>'),sq=ee('<span class="odz-text-green-600"> </span>'),iq=ee('<span class="odz-text-green-500"> </span>'),aq=ee('<span class="odz-text-gray-500"> </span>'),Aq=ee('<li class="odz-flex odz-items-center odz-gap-1"><span> </span> <!> <!> <!></li>'),lq=ee('<div class="odz-mt-2 odz-bg-green-50 odz-rounded odz-p-2"><p class="odz-text-xs odz-font-medium odz-text-green-800 odz-mb-1"> </p> <ul class="odz-text-xs odz-text-green-700 odz-space-y-1"></ul></div>'),dq=ee('<span class="odz-text-purple-500"> </span>'),cq=ee('<span class="odz-text-purple-600"> </span>'),uq=ee('<span class="odz-text-purple-600 odz-font-medium odz-whitespace-nowrap"> </span>'),hq=ee('<li class="odz-flex odz-items-center odz-justify-between"><span class="odz-flex odz-items-center odz-gap-1 odz-flex-wrap"><span class="odz-font-medium"> </span> <!> <!></span> <!></li>'),fq=ee('<div class="odz-mt-2 odz-bg-purple-50 odz-rounded odz-p-2"><p class="odz-text-xs odz-font-medium odz-text-purple-800 odz-mb-1"></p> <ul class="odz-text-xs odz-text-purple-700 odz-space-y-1"></ul></div>'),pq=ee('<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-border odz-border-gray-200"><div class="odz-card-body odz-p-4"><div class="odz-flex odz-items-start odz-justify-between"><div class="odz-flex-1"><h4 class="odz-font-semibold odz-text-gray-900"> </h4> <p class="odz-text-sm odz-text-gray-500 odz-mt-1"> : <span class="odz-font-medium"> </span></p></div> <!></div> <div class="odz-mt-3 odz-pt-3 odz-border-t odz-border-gray-100"><div class="odz-flex odz-items-start odz-gap-2 odz-text-sm"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <div class="odz-flex odz-items-start odz-gap-2 odz-text-sm odz-mt-2"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <div class="odz-flex odz-items-start odz-gap-2 odz-text-sm odz-mt-2"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <!> <!> <!> <!></div></div></div>'),gq=ee('<div class="odz-modal odz-modal-open" style="z-index: 9999;"><div class="odz-modal-box odz-max-w-sm"><h3 class="odz-font-bold odz-text-lg"> </h3> <p class="odz-py-4"> </p> <div class="odz-modal-action"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-error"></button></div></div> <button type="button" class="odz-modal-backdrop" aria-label=""></button></div>'),vq=ee('<div class="odz-space-y-3"><!></div> <!>',1);function qz(n,e){Hr(e,!1);const t=Yp();let r=pt(e,"products",24,()=>[]),o=pt(e,"disabled",8,!1),s=Ie(!1),i=Ie(null);function a(P,te){P.stopPropagation(),P.preventDefault(),!o()&&t("edit",{idx:te.idx,productId:te.productId})}function A(P,te){P.stopPropagation(),P.preventDefault(),!o()&&(_(i,te),_(s,!0))}function d(){l(i)&&t("delete",{idx:l(i).idx}),_(s,!1),_(i,null)}function c(){_(s,!1),_(i,null)}function u(P){return!P.variants||P.variants.length===0?" ":P.variants.map(te=>`${te.variantName||te.variantId}: ${te.quantity}`).join(", ")}function h(P){const te=P.prints&&P.prints.length>0,$=P.simplePrints&&P.simplePrints.length>0;if(!te&&!$)return" ";const j=[];return te&&j.push(`  ${P.prints.length}`),$&&j.push(`  ${P.simplePrints.length}`),j.join(", ")}function f(P){return!P.addons||P.addons.length===0?" ":` ${P.addons.length}`}qr();var g=vq(),m=gt(g),y=w(m);{var b=P=>{var te=V9(),$=w(te);E0($,{class:"odz-w-12 odz-h-12 odz-mx-auto odz-text-gray-400 odz-mb-3"}),T(P,te)},S=P=>{var te=Nt(),$=gt(te);Jt($,1,r,j=>j.idx,(j,J)=>{var we=pq(),D=w(we),N=w(D),Z=w(N),se=w(Z),ce=w(se),re=z(se,2),pe=z(w(re)),V=w(pe),K=z(Z,2);{var oe=U=>{var Ae=G9(),fe=w(Ae),Ce=w(fe);Y_(Ce,{class:"odz-w-4 odz-h-4"});var ge=z(fe,2),De=w(ge);n1(De,{class:"odz-w-4 odz-h-4"}),at("click",fe,Ne=>a(Ne,l(J))),at("click",ge,Ne=>A(Ne,l(J))),T(U,Ae)};Se(K,U=>{o()||U(oe)})}var ae=z(N,2),x=w(ae),E=w(x);E0(E,{class:"odz-w-4 odz-h-4 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var I=z(E,2),L=z(w(I),2),M=w(L),H=z(x,2),q=w(H);aE(q,{class:"odz-w-4 odz-h-4 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var G=z(q,2),R=z(w(G),2),he=w(R),Be=z(H,2),be=w(Be);cE(be,{class:"odz-w-4 odz-h-4 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var Le=z(be,2),Y=z(w(Le),2),O=w(Y),ve=z(Be,2);{var xe=U=>{var Ae=X9(),fe=w(Ae);Jt(fe,5,()=>l(J).variants,ar,(Ce,ge)=>{var De=W9(),Ne=w(De),Ze=w(Ne),Oe=z(Ne,2),Ke=w(Oe);He(()=>{Qe(Ze,l(ge).variantName||l(ge).variantId),Qe(Ke,`${l(ge).quantity??""}`)}),T(Ce,De)}),T(U,Ae)};Se(ve,U=>{l(J).variants&&l(J).variants.length>0&&U(xe)})}var me=z(ve,2);{var le=U=>{var Ae=oq(),fe=z(w(Ae),2);Jt(fe,5,()=>l(J).prints,ar,(Ce,ge)=>{var De=nq(),Ne=w(De);{var Ze=Ue=>{var Me=Z9();Jt(Me,5,()=>l(ge).parentTemplates,ar,(je,At,ut)=>{var ht=J9(),Re=gt(ht),Xe=w(Re),tt=z(Re,2);{var rt=Bt=>{var nt=Y9();T(Bt,nt)};Se(tt,Bt=>{ut<l(ge).parentTemplates.length-1&&Bt(rt)})}He(()=>Qe(Xe,l(At).name)),T(je,ht)}),T(Ue,Me)},Oe=Ue=>{var Me=Nt(),je=gt(Me);{var At=ut=>{var ht=eq(),Re=w(ht);He(()=>Qe(Re,`: ${(l(ge).templateName||l(ge).templateId)??""}`)),T(ut,ht)};Se(je,ut=>{l(ge).templateId&&ut(At)},!0)}T(Ue,Me)};Se(Ne,Ue=>{l(ge).parentTemplates&&l(ge).parentTemplates.length>0?Ue(Ze):Ue(Oe,!1)})}var Ke=z(Ne,2);{var Je=Ue=>{var Me=tq(),je=w(Me);He(()=>Qe(je,`(${l(ge).colors.length??""})`)),T(Ue,Me)};Se(Ke,Ue=>{l(ge).colors&&Array.isArray(l(ge).colors)&&l(ge).colors.length>0&&Ue(Je)})}var Te=z(Ke,2);{var _e=Ue=>{var Me=rq(),je=w(Me);He(()=>Qe(je,`- ${l(ge).memo??""}`)),T(Ue,Me)};Se(Te,Ue=>{l(ge).memo&&Ue(_e)})}T(Ce,De)}),T(U,Ae)};Se(me,U=>{l(J).prints&&l(J).prints.length>0&&U(le)})}var ze=z(me,2);{var ke=U=>{var Ae=lq(),fe=z(w(Ae),2);Jt(fe,5,()=>l(J).simplePrints,ar,(Ce,ge)=>{var De=Aq(),Ne=w(De),Ze=w(Ne),Oe=z(Ne,2);{var Ke=Me=>{var je=sq(),At=w(je);He(()=>Qe(At,`(${l(ge).printMethod??""})`)),T(Me,je)};Se(Oe,Me=>{l(ge).printMethod&&Me(Ke)})}var Je=z(Oe,2);{var Te=Me=>{var je=iq(),At=w(je);He(()=>Qe(At,`(${l(ge).selectedColors.length??""})`)),T(Me,je)};Se(Je,Me=>{l(ge).selectedColors&&Array.isArray(l(ge).selectedColors)&&l(ge).selectedColors.length>0&&Me(Te)})}var _e=z(Je,2);{var Ue=Me=>{var je=aq(),At=w(je);He(()=>Qe(At,`- ${l(ge).memo??""}`)),T(Me,je)};Se(_e,Me=>{l(ge).memo&&Me(Ue)})}He(()=>Qe(Ze,l(ge).objectId||" ")),T(Ce,De)}),T(U,Ae)};Se(ze,U=>{l(J).simplePrints&&l(J).simplePrints.length>0&&U(ke)})}var de=z(ze,2);{var Fe=U=>{var Ae=fq(),fe=z(w(Ae),2);Jt(fe,5,()=>l(J).addons,ar,(Ce,ge)=>{var De=hq(),Ne=w(De),Ze=w(Ne),Oe=w(Ze),Ke=z(Ze,2);{var Je=je=>{var At=dq(),ut=w(At);He(()=>Qe(ut,`(${l(ge).selectedProductName||""}${(l(ge).selectedVariantName?` - ${l(ge).selectedVariantName}`:"")??""})`)),T(je,At)};Se(Ke,je=>{(l(ge).selectedProductName||l(ge).selectedVariantName)&&je(Je)})}var Te=z(Ke,2);{var _e=je=>{var At=cq(),ut=w(At);He(()=>Qe(ut,`x${l(ge).quantity??""}`)),T(je,At)};Se(Te,je=>{l(ge).quantity&&l(ge).quantity>1&&je(_e)})}var Ue=z(Ne,2);{var Me=je=>{var At=uq(),ut=w(At);He(ht=>Qe(ut,`${ht??""}`),[()=>l(ge).price.toLocaleString()],it),T(je,At)};Se(Ue,je=>{l(ge).price&&je(Me)})}He(()=>Qe(Oe,l(ge).addonName||l(ge).addonId)),T(Ce,De)}),T(U,Ae)};Se(de,U=>{l(J).addons&&l(J).addons.length>0&&U(Fe)})}He((U,Ae,fe)=>{Qe(ce,l(J).productName||l(J).productId),Qe(V,l(J).totalQuantity),Qe(M,U),Qe(he,Ae),Qe(O,fe)},[()=>u(l(J)),()=>h(l(J)),()=>f(l(J))],it),T(j,we)}),T(P,te)};Se(y,P=>{r().length===0?P(b):P(S,!1)})}var F=z(m,2);{var k=P=>{var te=gq(),$=w(te),j=z(w($),2),J=w(j),we=z(j,2),D=w(we),N=z(D,2),Z=z($,2);He(()=>{var se,ce;return Qe(J,`'${(((se=l(i))==null?void 0:se.productName)||((ce=l(i))==null?void 0:ce.productId))??""}'  ?`)}),at("click",D,c),at("click",N,d),at("click",Z,c),T(P,te)};Se(F,P=>{l(s)&&P(k)})}T(n,g),jr()}var mq=ee('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-ml-4 odz-text-gray-600">  ...</p></div>'),wq=ee('<div class="odz-alert odz-alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="odz-stroke-current odz-shrink-0 odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),yq=ee('<dialog class="odz-modal odz-modal-open odiz-app odz-items-center odz-justify-center"><div class="odz-modal-box odz-max-w-6xl odz-w-full odz-h-[90vh] odz-p-0 odz-relative odz-rounded-xl odz-shadow-2xl odz-bg-white"><div class="odz-sticky odz-top-0 odz-z-10 odz-bg-white odz-border-b odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-between odz-items-center"><h3 class="odz-text-lg odz-font-bold odz-text-gray-900"> </h3> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost"><!></button></div> <div class="odz-overflow-y-auto odz-h-[calc(90vh-140px)] odz-px-6 odz-py-4"><!></div> <div class="odz-sticky odz-bottom-0 odz-z-10 odz-bg-white odz-border-t odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-end odz-gap-2"><button class="odz-btn odz-btn-ghost"></button> <button class="odz-btn odz-btn-primary"> </button></div></div></dialog>');function bq(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(di,"$qnaStore",t),s=Ie(),i=Ie(),a=Yp();let A=pt(e,"isOpen",8,!1),d=pt(e,"productId",8),c=pt(e,"shopId",8);pt(e,"mallType",8,"");let u=pt(e,"qnaId",8,null),h=pt(e,"editingIdx",8,null),f=Ie(!0),g=Ie(""),m=Ie(),y=Ie("");async function b(){try{_(f,!0),_(g,"");const I=await Mu(d(),c());if(_(y,(I==null?void 0:I.title)||(I==null?void 0:I.name)||d()),h()!==null){const L=b9(u(),d(),h());L?await F(L):await S()}else await S();_(f,!1)}catch(I){console.error("[QnaProductSelector]  :",I),I instanceof Error?_(g,I.message):_(g,"     ."),_(f,!1)}}async function S(){k();const I=Date.now().toString(36)+Math.random().toString(36).substr(2),L={productId:d(),productSelection:{selectedColors:[],quantityByVariant:{},totalQuantity:0,variantsData:[]},printSelection:null,addonSelection:null,additionalInfo:null,currentStep:"product",isDebugMode:!1,sessionId:I,estimateId:l(s)};if(ur.set(L),typeof window<"u"){const M=`fixedEstimate_${d()}_${l(s)}_${l(i)}`;window.sessionStorage.setItem(M,JSON.stringify(L))}}async function F(I){const L=Date.now().toString(36)+Math.random().toString(36).substr(2),M={productId:d(),productSelection:I.productSelection||{selectedColors:[],quantityByVariant:{},totalQuantity:0,variantsData:[]},printSelection:I.printSelection||null,addonSelection:I.addonSelection||null,additionalInfo:I.additionalInfo||null,currentStep:"product",isDebugMode:!1,sessionId:L,estimateId:l(s)};if(typeof window<"u"){const H=`fixedEstimate_${d()}_${l(s)}_${l(i)}`,q=`simplePrint_${d()}_${l(s)}`,G=`detailedPrint_${d()}_${l(s)}`;window.sessionStorage.removeItem(q),window.sessionStorage.removeItem(G),window.sessionStorage.setItem(H,JSON.stringify(M)),I.simplePrintState&&(window.sessionStorage.setItem(q,JSON.stringify(I.simplePrintState)),console.log("[QnaProductSelector] simplePrint  :",I.simplePrintState)),I.detailedPrintState&&(window.sessionStorage.setItem(G,JSON.stringify(I.detailedPrintState)),console.log("[QnaProductSelector] detailedPrint  :",I.detailedPrintState))}ur.set(M),await new Promise(H=>setTimeout(H,50))}function k(){typeof window<"u"&&[`fixedEstimate_${d()}_${l(s)}_${l(i)}`,`simplePrint_${d()}_${l(s)}`,`detailedPrint_${d()}_${l(s)}`,`tab-state-${d()}`].forEach(L=>window.sessionStorage.removeItem(L))}function P(){var I,L,M;try{const H=hn(ur);if(!H.productSelection||H.productSelection.totalQuantity===0){alert("   .");return}const q=[],G=H.productSelection.quantityByVariant||{},R=H.productSelection.variantsByColor||{};for(const[O,ve]of Object.entries(G)){if(typeof ve!="object"||ve===null)continue;const xe=R[O]||[];for(const[me,le]of Object.entries(ve))if(le&&Number(le)>0){const ze=xe.find(de=>de.id===me),ke=((L=(I=ze==null?void 0:ze.prices)==null?void 0:I[0])==null?void 0:L.amount)||0;q.push({variantId:me,variantName:(ze==null?void 0:ze.name)||(ze==null?void 0:ze.title)||`${O} - ${me}`,quantity:Number(le),price:ke,optionValues:(ze==null?void 0:ze.optionValues)||{color:O}})}}const he=[],Be=[],be=[];if(H.printSelection){const O=H.printSelection.currentMethod;if(O==="simple"){const ve=`simplePrint_${d()}_${l(s)}`,xe=window.sessionStorage.getItem(ve);if(xe)try{const me=JSON.parse(xe);Array.isArray(me)&&me.forEach(le=>{Be.push({objectId:le.objectId,printMethod:le.printMethod,templateId:le.templateId,selectedColors:le.selectedColors,printConfig:le.printConfig,uploads:le.uploadedFiles||le.uploads,nameSheet:le.nameSheet,memo:le.memo,price:le.price||0})})}catch(me){console.error("[QnaProductSelector]     :",me)}}else if(O==="detailed"){const ve=`detailedPrint_${d()}_${l(s)}`,xe=window.sessionStorage.getItem(ve);if(xe)try{const me=JSON.parse(xe);Array.isArray(me)&&me.forEach(le=>{var ke,de,Fe;const ze=[];le.parentTemplates&&Array.isArray(le.parentTemplates)&&le.parentTemplates.forEach(U=>{ze.push({id:U.id,name:U.name||U.id})}),(ke=le.template)!=null&&ke.id&&ze.push({id:le.template.id,name:le.template.name||le.template.id}),he.push({objectId:le.objectId,printType:"detailed",templateId:(de=le.template)==null?void 0:de.id,templateName:(Fe=le.template)==null?void 0:Fe.name,parentTemplates:ze.length>0?ze:void 0,colors:le.colors,uploadedFiles:le.uploads,memo:le.memo,price:le.price||0})})}catch(me){console.error("[QnaProductSelector]     :",me)}}}if(console.log("[QnaProductSelector] currentState.addonSelection:",H.addonSelection),(M=H.addonSelection)!=null&&M.selectedAddons){const O=H.addonSelection.selectedAddons;console.log("[QnaProductSelector] selectedAddons entries:",Object.entries(O));for(const[ve,xe]of Object.entries(O))if(console.log("[QnaProductSelector] Processing addon:",{addonId:ve,selection:xe}),xe&&typeof xe=="object"){const me=xe;console.log("[QnaProductSelector] sel.productId:",me.productId),me.productId?(be.push({addonId:ve,selectedProductId:me.productId,selectedVariantId:me.variantId,price:me.price||0,quantity:me.quantity||1}),console.log("[QnaProductSelector] Addon added to array:",be[be.length-1])):console.log("[QnaProductSelector] Addon skipped - no productId")}}else console.log("[QnaProductSelector] No selectedAddons in addonSelection");console.log("[QnaProductSelector] Final addons array:",be);const Le={productId:d(),productName:l(y),variants:q,prints:he,simplePrints:Be,addons:be,totalQuantity:H.productSelection.totalQuantity||0},Y={productSelection:H.productSelection,printSelection:H.printSelection,addonSelection:H.addonSelection,additionalInfo:H.additionalInfo,simplePrintState:null,detailedPrintState:null};if(typeof window<"u"){const O=`simplePrint_${d()}_${l(s)}`,ve=window.sessionStorage.getItem(O);ve&&(Y.simplePrintState=JSON.parse(ve));const xe=`detailedPrint_${d()}_${l(s)}`,me=window.sessionStorage.getItem(xe);me&&(Y.detailedPrintState=JSON.parse(me))}Hz(u(),d(),l(i),Y),a("save",{idx:l(i),productData:Le,isEdit:h()!==null}),te()}catch(H){console.error("[QnaProductSelector]  :",H),alert("   .")}}function te(){k(),ur.reset(),a("close")}function $(I){I.key==="Escape"&&te()}function j(I){I.target===l(m)&&te()}Eo(()=>{document.body.style.overflow="",k(),ur.reset()}),Zt(()=>zn(u()),()=>{_(s,`qna_${u()||"new"}`)}),Zt(()=>(zn(h()),o()),()=>{_(i,h()??o().nextIdx)}),Zt(()=>(l(m),zn(A())),()=>{l(m)&&(A()?(document.body.style.overflow="hidden",window.scrollTo(0,0),document.querySelectorAll('.odz-modal-box, .odz-overflow-y-auto, [style*="overflow"]').forEach(L=>{L instanceof HTMLElement&&(L.scrollTop=0)}),l(m).showModal(),b()):(document.body.style.overflow="",l(m).close()))}),Zn(),qr();var J=yq(),we=w(J),D=w(we),N=w(D),Z=w(N),se=z(N,2),ce=w(se);ju(ce,{class:"odz-w-5 odz-h-5"});var re=z(D,2),pe=w(re);{var V=I=>{var L=mq();T(I,L)},K=I=>{var L=Nt(),M=gt(L);{var H=G=>{var R=wq(),he=z(w(R),2),Be=w(he);He(()=>Qe(Be,l(g))),T(G,R)},q=G=>{Mp(G,{get productId(){return d()},get estimateId(){return l(s)},get idx(){return l(i)},onSave:P})};Se(M,G=>{l(g)?G(H):G(q,!1)},!0)}T(I,L)};Se(pe,I=>{l(f)?I(V):I(K,!1)})}var oe=z(re,2),ae=w(oe),x=z(ae,2),E=w(x);ts(J,I=>_(m,I),()=>l(m)),He(()=>{Qe(Z,`${(h()!==null?" ":" ")??""} - ${(l(y)||d())??""}`),x.disabled=l(f),Qe(E,h()!==null?"":"")}),at("click",se,te),at("click",ae,te),at("click",x,P),at("keydown",J,$),at("click",J,j),T(n,J),jr(),r()}var _q=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-12 odz-text-gray-500"><!> <p> ...</p></div>'),Bq=ee('<label class="odz-label"><span class="odz-label-text-alt odz-text-error">4  </span></label>'),xq=ee('<label class="odz-label"><span class="odz-label-text-alt odz-text-error">  </span></label>'),zq=ee('<div class="odz-mt-6 odz-p-4 odz-bg-yellow-50 odz-border odz-border-yellow-200 odz-rounded-lg"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3"><!> <h4 class="odz-font-semibold odz-text-yellow-900">   </h4></div> <p class="odz-text-sm odz-text-yellow-700 odz-mb-4">     .</p> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4"><div class="odz-form-control"><label class="odz-label" for="password"><span class="odz-label-text"> <span class="odz-text-error">*</span></span></label> <input type="password" id="password" placeholder=" (4~16)" minlength="4" maxlength="16" class="odz-input odz-input-bordered odz-input-md odz-w-full"> <!></div> <div class="odz-form-control"><label class="odz-label" for="passwordConfirm"><span class="odz-label-text">  <span class="odz-text-error">*</span></span></label> <input type="password" id="passwordConfirm" placeholder=" " maxlength="16" class="odz-input odz-input-bordered odz-input-md odz-w-full"> <!></div></div></div>'),Cq=ee('<div class="odz-mt-4"><!></div>'),Sq=ee('<div class="odz-text-center odz-py-8 odz-bg-gray-50 odz-rounded-lg odz-border odz-border-dashed odz-border-gray-300"><p class="odz-text-gray-500">  .</p> <button class="odz-btn odz-btn-ghost odz-btn-sm odz-mt-2 odz-text-primary"><!>  </button></div>'),Eq=ee("<!>  ...",1),Fq=ee("<!> ",1),Iq=ee('<div class="odz-space-y-6"><div class="odz-flex odz-items-center odz-justify-between"><h2 class="odz-text-xl odz-font-bold odz-text-gray-900"> </h2></div> <div class="odz-card odz-bg-base-100 odz-shadow-sm odz-border odz-border-gray-200"><div class="odz-card-body odz-p-6"><h3 class="odz-text-lg odz-font-semibold odz-mb-4 odz-text-gray-800 odz-flex odz-items-center odz-gap-2"><!>  </h3> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4"><div class="odz-form-control"><label class="odz-label" for="customerName"><span class="odz-label-text"> <span class="odz-text-error">*</span></span></label> <input type="text" id="customerName" placeholder=" " class="odz-input odz-input-bordered odz-input-md odz-w-full"></div> <div class="odz-form-control"><label class="odz-label" for="customerPhone"><span class="odz-label-text"></span></label> <div class="odz-flex odz-items-center odz-gap-2"><input type="text" placeholder="010" maxlength="3" class="odz-input odz-input-bordered odz-input-md odz-w-full odz-text-center"> <span class="odz-text-gray-400">-</span> <input type="text" placeholder="0000" maxlength="4" class="odz-input odz-input-bordered odz-input-md odz-w-full odz-text-center"> <span class="odz-text-gray-400">-</span> <input type="text" placeholder="0000" maxlength="4" class="odz-input odz-input-bordered odz-input-md odz-w-full odz-text-center"></div></div> <div class="odz-form-control md:odz-col-span-2"><label class="odz-label" for="customerEmail"><span class="odz-label-text"></span></label> <div class="odz-relative"><!> <input type="email" id="customerEmail" placeholder=" " class="odz-input odz-input-bordered odz-input-md odz-w-full odz-pl-10"></div></div></div> <!></div></div> <div class="odz-card odz-bg-base-100 odz-shadow-sm odz-border odz-border-gray-200"><div class="odz-card-body odz-p-6"><h3 class="odz-text-lg odz-font-semibold odz-mb-4 odz-text-gray-800 odz-flex odz-items-center odz-gap-2"><!>  </h3> <div class="odz-space-y-4"><div class="odz-form-control"><label class="odz-label" for="title"><span class="odz-label-text"> <span class="odz-text-error">*</span></span></label> <input type="text" id="title" placeholder="  " class="odz-input odz-input-bordered odz-input-md odz-w-full"></div> <div class="odz-form-control"><label class="odz-label" for="content"><span class="odz-label-text"> <span class="odz-text-error">*</span></span></label> <textarea id="content" placeholder="  " rows="6" class="odz-textarea odz-textarea-bordered odz-w-full"></textarea></div></div></div></div> <div class="odz-card odz-bg-base-100 odz-shadow-sm odz-border odz-border-gray-200"><div class="odz-card-body odz-p-6"><div class="odz-flex odz-items-center odz-justify-between odz-mb-4"><h3 class="odz-text-lg odz-font-semibold odz-text-gray-800 odz-flex odz-items-center odz-gap-2"><!>   <span class="odz-text-sm odz-font-normal odz-text-gray-500">()</span></h3> <button type="button" class="odz-btn odz-btn-sm odz-btn-outline"><!>  </button></div> <!></div></div> <div class="odz-flex odz-justify-end odz-gap-3 odz-mt-6"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-primary"><!></button></div></div>'),Uq=ee('<div class="odiz-app odz-max-w-3xl odz-mx-auto odz-p-4 svelte-fas30z"><!> <!> <!> <dialog class="cancel-confirm-dialog svelte-fas30z"><div class="cancel-confirm-box svelte-fas30z"><h3 class="odz-font-bold odz-text-lg"></h3> <p class="odz-py-4">    . ?</p> <div class="odz-flex odz-justify-end odz-gap-2"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-error">, </button></div></div></dialog></div>');function Qq(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(di,"$qnaStore",t),s=Ie(),i=Ie(),a=Ie(),A=Ie(),d=Ie();let c=pt(e,"mallType",8,""),u=pt(e,"customerId",8,"");pt(e,"sess",8,"");let h=pt(e,"shopId",8,""),f=pt(e,"qnaId",8,""),g=pt(e,"onSubmitSuccess",8,void 0),m=pt(e,"onCancel",8,void 0),y=Ie(""),b=Ie(""),S=Ie(""),F=Ie(""),k=Ie(""),P=Ie(""),te=Ie(""),$=Ie(!1),j=Ie(!1),J=Ie(!1),we=Ie(!1),D=Ie(""),N=Ie(),Z=null,se=Ie([]),ce=Ie(""),re=Ie("");En(async()=>{di.reset(),f()&&await pe()}),Eo(()=>{di.reset(),a0(f()||null)});async function pe(){_($,!0);try{if(Z=await Pg(f()),Z){if(_(y,Z.title||""),_(b,Z.content||""),_(S,Z.customer_name||""),_(te,Z.customer_email||""),Z.customer_phone){const U=Z.customer_phone.split("-");U.length===3&&(_(F,U[0]),_(k,U[1]),_(P,U[2]))}const le=await t2(f()),ze=await r2(f()),ke=await o2(f()),de=await s2(f()),Fe=new Map;for(const U of le){const Ae=U.idx||0;Fe.has(Ae)||Fe.set(Ae,{idx:Ae,productId:U.product_id,productName:U.product_name,variants:[],prints:[],simplePrints:[],addons:[],totalQuantity:0});const fe=Fe.get(Ae);fe.variants.push({variantId:U.variant_id,variantName:U.variant_name,quantity:U.quantity||1,optionValues:U.option_values}),fe.totalQuantity+=U.quantity||1}for(const U of ze){const Ae=U.idx||0;if(Fe.has(Ae)){let fe=[];if(U.template_id)try{fe=(await Ru(U.template_id)).map(De=>({id:De.id,name:De.name,image_url:De.image_url})),console.log("[QnaRegister] parentTemplates :",fe)}catch(ge){console.warn("[QnaRegister] parentTemplates  :",ge)}let Ce=U.title;if(!Ce&&U.object_id)try{const ge=await f1(U.object_id);ge&&(Ce=ge.title||ge.name,console.log("[QnaRegister] print area title :",Ce))}catch(ge){console.warn("[QnaRegister] print area  :",ge)}Fe.get(Ae).prints.push({objectId:U.object_id,printType:U.print_type,title:Ce,printMethod:U.print_method,templateId:U.template_id,colors:U.colors,uploadedFiles:U.uploaded_files,fileMetadata:U.file_metadata,memo:U.memo,parentTemplates:fe})}}for(const U of ke){const Ae=U.idx||0;Fe.has(Ae)&&Fe.get(Ae).simplePrints.push({objectId:U.object_id,printMethod:U.print_method,templateId:U.template_id,selectedColors:U.selected_colors,printConfig:U.print_config,uploads:U.uploads,nameSheet:U.name_sheet,memo:U.memo})}for(const U of de){const Ae=U.idx||0;Fe.has(Ae)&&Fe.get(Ae).addons.push({addonId:U.addon_id,addonName:U.addon_name||void 0,selectedProductId:U.selected_product_id,selectedProductName:U.selected_product_name||void 0,selectedVariantId:U.selected_variant_id,selectedVariantName:U.selected_variant_name||void 0,price:U.price||0,quantity:U.quantity||1})}_(se,Array.from(Fe.values())),di.setState({qnaId:f(),title:l(y),content:l(b),customerName:l(S),customerPhone:l(d),customerEmail:l(te),products:l(se),nextIdx:l(se).length>0?Math.max(...l(se).map(U=>U.idx))+1:0})}}catch(le){console.error("[QnaRegister] loadQna error:",le),alert("   .")}finally{_($,!1)}}function V(){_(J,!0)}function K(le){_(J,!1),_(D,le),_(we,!0)}function oe(le){const{productData:ze,isEdit:ke,idx:de}=le.detail;ze&&(ke&&de!==void 0?di.updateProduct(de,ze):di.addProduct(ze),_(se,[...o().products])),_(we,!1),_(D,""),di.clearEditing()}function ae(le){var Fe,U;const{idx:ze,productId:ke}=le.detail,de=o().products.find(Ae=>Ae.idx===ze);if(de){const Ae={},fe=[];for(const Oe of de.variants){const Ke=((Fe=Oe.optionValues)==null?void 0:Fe.color)||((U=Oe.optionValues)==null?void 0:U.)||"default";Ae[Ke]||(Ae[Ke]={},fe.push(Ke)),Ae[Ke][Oe.variantId]=Oe.quantity}const Ce={};for(const Oe of de.addons||[])Ce[Oe.addonId]={productId:Oe.selectedProductId,variantId:Oe.selectedVariantId,price:Oe.price||0,quantity:Oe.quantity||1};let ge=null,De=null,Ne=null;de.simplePrints&&de.simplePrints.length>0&&(ge=de.simplePrints.map(Oe=>({objectId:Oe.objectId,printMethod:Oe.printMethod,templateId:Oe.templateId,selectedColors:Oe.selectedColors,printConfig:Oe.printConfig,uploadedFiles:Oe.uploads,uploads:Oe.uploads,nameSheet:Oe.nameSheet,memo:Oe.memo,price:Oe.price||0})),Ne={currentMethod:"simple"}),de.prints&&de.prints.length>0&&(De=de.prints.map(Oe=>({objectId:Oe.objectId,title:Oe.title,template:Oe.templateId?{id:Oe.templateId,name:Oe.templateName||Oe.title}:null,parentTemplates:Oe.parentTemplates||[],colors:Oe.colors,uploads:Oe.uploadedFiles,memo:Oe.memo,price:Oe.price||0})),Ne={currentMethod:"detailed"},console.log("[QnaRegister] detailedPrintState :",De));const Ze={productSelection:{selectedColors:fe,quantityByVariant:Ae,totalQuantity:de.totalQuantity,variantsData:[]},printSelection:Ne,addonSelection:{selectedAddons:Ce},additionalInfo:null,simplePrintState:ge,detailedPrintState:De};Hz(o().qnaId,ke,ze,Ze),console.log("[QnaRegister]    sessionStorage :",{idx:ze,productId:ke,sessionData:Ze})}di.setEditing(ze,ke),_(D,ke),_(we,!0)}function x(le){const{idx:ze}=le.detail;di.removeProduct(ze),_(se,[...o().products])}async function E(le){if(le&&(le.stopPropagation(),le.preventDefault()),!l(A)){l(s)&&!f()?l(ce)?l(ce).length<4?alert(" 4  ."):l(ce)!==l(re)?alert("  ."):alert(", ,    ."):alert("   ."):alert(", ,    .");return}_(j,!0);try{let ze;if(f()&&Z?(ze=await e2(f(),{title:l(y),content:l(b),customer_name:l(S),customer_phone:l(d),customer_email:l(te)}),await U9(f()),await T9(f()),await H9(f()),await R9(f())):ze=await S9({shop_id:h(),customer_id:u()||void 0,customer_name:l(S),customer_phone:l(d),customer_email:l(te),title:l(y),content:l(b),password:l(s)?l(ce):void 0}),!ze.id)throw new Error("  .");const ke=o().products;if(ke.length>0){const de=[];for(const fe of ke)for(const Ce of fe.variants)de.push({idx:fe.idx,product_id:fe.productId,variant_id:Ce.variantId,quantity:Ce.quantity,price:Ce.price||0,product_name:fe.productName,variant_name:Ce.variantName,option_values:Ce.optionValues});de.length>0&&await I9(ze.id,de);const Fe=[];for(const fe of ke)for(const Ce of fe.prints||[])Fe.push({idx:fe.idx,object_id:Ce.objectId,print_type:Ce.printType,title:Ce.title,print_method:Ce.printMethod,template_id:Ce.templateId,colors:Ce.colors,uploaded_files:Ce.uploadedFiles,file_metadata:Ce.fileMetadata,memo:Ce.memo,price:Ce.price||0});Fe.length>0&&await Q9(ze.id,Fe);const U=[];for(const fe of ke)for(const Ce of fe.simplePrints||[])U.push({idx:fe.idx,object_id:Ce.objectId,print_method:Ce.printMethod,template_id:Ce.templateId,selected_colors:Ce.selectedColors,print_config:Ce.printConfig,uploads:Ce.uploads,name_sheet:Ce.nameSheet,memo:Ce.memo,price:Ce.price||0});U.length>0&&await M9(ze.id,U);const Ae=[];console.log("[QnaRegister] Processing addon save for products:",ke.map(fe=>{var Ce;return{idx:fe.idx,productId:fe.productId,addonsCount:((Ce=fe.addons)==null?void 0:Ce.length)||0,addons:fe.addons}}));for(const fe of ke){console.log("[QnaRegister] Product addons:",fe.addons);for(const Ce of fe.addons||[])Ae.push({idx:fe.idx,addon_id:Ce.addonId,selected_product_id:Ce.selectedProductId,selected_variant_id:Ce.selectedVariantId,price:Ce.price||0,quantity:Ce.quantity||1})}console.log("[QnaRegister] addonsToSave:",Ae),Ae.length>0?(console.log("[QnaRegister] Saving addons to database..."),await j9(ze.id,Ae),console.log("[QnaRegister] Addons saved successfully")):console.log("[QnaRegister] No addons to save"),await K9(ze.id)}if(a0(f()||null),g()&&ze.id)g()(ze.id);else{const de=f()?`?qnaMode=detail&qnaId=${ze.id}`:"?qnaMode=list";window.location.href=window.location.pathname+de}}catch(ze){console.error("[QnaRegister] submitQna error:",ze),alert("  .  .")}finally{_(j,!1)}}function I(le){le.stopPropagation(),le.preventDefault(),l(N)&&l(N).showModal()}function L(){l(N)&&l(N).close(),a0(f()||null),m()?m()():window.location.href=window.location.pathname+"?qnaMode=list"}function M(){l(N)&&l(N).close()}Zt(()=>zn(u()),()=>{_(s,!u())}),Zt(()=>(l(ce),l(re)),()=>{_(i,!l(ce)||!l(re)||l(ce)===l(re))}),Zt(()=>(l(s),zn(f()),l(ce),l(i)),()=>{_(a,!l(s)||!f()&&l(ce).length>=4&&l(ce).length<=16&&l(i))}),Zt(()=>(l(y),l(b),l(S),zn(u()),zn(f()),l(ce),l(re)),()=>{_(A,l(y).trim()&&l(b).trim()&&l(S).trim()&&(u()||f()||l(ce).trim()&&l(ce)===l(re)&&l(ce).length>=4))}),Zt(()=>(l(F),l(k),l(P)),()=>{_(d,l(F)&&l(k)&&l(P)?`${l(F)}-${l(k)}-${l(P)}`:"")}),Zn(),qr();var H=Uq(),q=w(H);{var G=le=>{var ze=_q(),ke=w(ze);zd(ke,{class:"odz-w-8 odz-h-8 odz-animate-spin odz-mb-2"}),T(le,ze)},R=le=>{var ze=Iq(),ke=w(ze),de=w(ke),Fe=w(de),U=z(ke,2),Ae=w(U),fe=w(Ae),Ce=w(fe);F0(Ce,{class:"odz-w-5 odz-h-5"});var ge=z(fe,2),De=w(ge),Ne=z(w(De),2),Ze=z(De,2),Oe=z(w(Ze),2),Ke=w(Oe),Je=z(Ke,4),Te=z(Je,4),_e=z(Ze,2),Ue=z(w(_e),2),Me=w(Ue);sE(Me,{class:"odz-w-4 odz-h-4 odz-absolute odz-left-3 odz-top-1/2 -odz-translate-y-1/2 odz-text-gray-400"});var je=z(Me,2),At=z(ge,2);{var ut=Ht=>{var mr=zq(),kr=w(mr),Kr=w(kr);oE(Kr,{class:"odz-w-5 odz-h-5 odz-text-yellow-700"});var Sr=z(kr,4),fr=w(Sr),Lr=z(w(fr),2),xr=z(Lr,2);{var Ar=zr=>{var dr=Bq();T(zr,dr)};Se(xr,zr=>{l(ce)&&l(ce).length<4&&zr(Ar)})}var pr=z(fr,2),Pr=z(w(pr),2),gn=z(Pr,2);{var vn=zr=>{var dr=xq();T(zr,dr)};Se(gn,zr=>{l(re)&&!l(i)&&zr(vn)})}He(()=>{hA(Lr,"odz-input-error",l(ce)&&l(ce).length<4),hA(Pr,"odz-input-error",l(re)&&!l(i))}),br(Lr,()=>l(ce),zr=>_(ce,zr)),br(Pr,()=>l(re),zr=>_(re,zr)),T(Ht,mr)};Se(At,Ht=>{l(s)&&!f()&&Ht(ut)})}var ht=z(U,2),Re=w(ht),Xe=w(Re),tt=w(Xe);kf(tt,{class:"odz-w-5 odz-h-5"});var rt=z(Xe,2),Bt=w(rt),nt=z(w(Bt),2),ot=z(Bt,2),xt=z(w(ot),2),Lt=z(ht,2),_t=w(Lt),vt=w(_t),Pt=w(vt),kt=w(Pt);E0(kt,{class:"odz-w-5 odz-h-5"});var Ct=z(Pt,2),Ft=w(Ct);bu(Ft,{class:"odz-w-4 odz-h-4 odz-mr-1"});var zt=z(vt,2);{var Tt=Ht=>{var mr=Cq(),kr=w(mr);qz(kr,{get products(){return l(se)},$$events:{edit:ae,delete:x}}),T(Ht,mr)},Rt=Ht=>{var mr=Sq(),kr=z(w(mr),2),Kr=w(kr);bu(Kr,{class:"odz-w-4 odz-h-4 odz-mr-1"}),at("click",kr,V),T(Ht,mr)};Se(zt,Ht=>{l(se).length>0?Ht(Tt):Ht(Rt,!1)})}var Dt=z(Lt,2),Mt=w(Dt),Gt=z(Mt,2),lr=w(Gt);{var tr=Ht=>{var mr=Eq(),kr=gt(mr);zd(kr,{class:"odz-w-4 odz-h-4 odz-animate-spin odz-mr-2"}),T(Ht,mr)},sr=Ht=>{var mr=Fq(),kr=gt(mr);lE(kr,{class:"odz-w-4 odz-h-4 odz-mr-2"});var Kr=z(kr);He(()=>Qe(Kr,` ${(f()?"":"")??""}`)),T(Ht,mr)};Se(lr,Ht=>{l(j)?Ht(tr):Ht(sr,!1)})}He(()=>{Qe(Fe,f()?" ":" "),Gt.disabled=!l(A)||l(j)}),br(Ne,()=>l(S),Ht=>_(S,Ht)),br(Ke,()=>l(F),Ht=>_(F,Ht)),br(Je,()=>l(k),Ht=>_(k,Ht)),br(Te,()=>l(P),Ht=>_(P,Ht)),br(je,()=>l(te),Ht=>_(te,Ht)),br(nt,()=>l(y),Ht=>_(y,Ht)),br(xt,()=>l(b),Ht=>_(b,Ht)),at("click",Ct,V),at("click",Mt,Ht=>I(Ht)),at("click",Gt,Ht=>E(Ht)),T(le,ze)};Se(q,le=>{l($)?le(G):le(R,!1)})}var he=z(q,2);{var Be=le=>{G1(le,{addProduct:K,get productType(){return c()},excludeNoProcess:!0,get isProductSearchOpen(){return l(J)},set isProductSearchOpen(ze){_(J,ze)},$$legacy:!0})};Se(he,le=>{l(J)&&le(Be)})}var be=z(he,2);{var Le=le=>{const ze=it(()=>f()||null);bq(le,{get isOpen(){return l(we)},get productId(){return l(D)},get shopId(){return h()},get mallType(){return c()},get qnaId(){return l(ze)},get editingIdx(){return o().editingIdx},$$events:{save:oe,close:()=>{_(we,!1),_(D,""),di.clearEditing()}}})};Se(be,le=>{l(we)&&le(Le)})}var Y=z(be,2),O=w(Y),ve=z(w(O),4),xe=w(ve),me=z(xe,2);ts(Y,le=>_(N,le),()=>l(N)),at("click",xe,M),at("click",me,L),at("click",Y,S_(M)),T(n,H),jr(),r()}var Tq=ee(' <span class="odz-font-mono odz-font-medium odz-text-primary"> </span>',1),Lq=ee('<label class="odz-label"><span class="odz-label-text-alt odz-text-error"> </span></label>'),Pq=ee("<!>  ...",1),kq=ee('<div class="odz-modal odz-modal-open"><div class="odz-modal-box odz-max-w-sm"><button type="button" class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"><!></button> <h3 class="odz-font-bold odz-text-lg odz-mb-4 odz-flex odz-items-center odz-gap-2"><!>  </h3> <p class="odz-text-sm odz-text-gray-600 odz-mb-4"><!>  .</p> <div class="odz-form-control odz-mb-4"><input type="password" placeholder=" (4~16)" maxlength="16" class="odz-input odz-input-bordered odz-w-full"> <!></div> <div class="odz-modal-action"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-primary"><!></button></div></div></div>');function Oq(n,e){Hr(e,!1);let t=pt(e,"isOpen",8,!1),r=pt(e,"qnaId",8,""),o=pt(e,"inquiryNo",8,"");const s=Yp();let i=Ie(""),a=Ie(!1),A=Ie("");async function d(){if(!l(i).trim()){_(A," .");return}if(l(i).length<4){_(A," 4  .");return}_(a,!0),_(A,""),s("verify",{qnaId:r(),password:l(i)})}function c(y,b){_(a,!1),!y&&b&&_(A,b)}function u(){_(i,""),_(A,""),_(a,!1),s("cancel")}function h(y){y.key==="Enter"&&!l(a)?d():y.key==="Escape"&&u()}Zt(()=>zn(t()),()=>{t()&&(_(i,""),_(A,""),_(a,!1))}),Zn(),qr();var f=Nt(),g=gt(f);{var m=y=>{var b=kq(),S=w(b),F=w(S),k=w(F);ju(k,{class:"odz-w-4 odz-h-4"});var P=z(F,2),te=w(P);X_(te,{class:"odz-w-5 odz-h-5 odz-text-warning"});var $=z(P,2),j=w($);{var J=oe=>{var ae=Tq(),x=z(gt(ae)),E=w(x);He(()=>Qe(E,o())),T(oe,ae)};Se(j,oe=>{o()&&oe(J)})}var we=z($,2),D=w(we),N=z(D,2);{var Z=oe=>{var ae=Lq(),x=w(ae),E=w(x);He(()=>Qe(E,l(A))),T(oe,ae)};Se(N,oe=>{l(A)&&oe(Z)})}var se=z(we,2),ce=w(se),re=z(ce,2),pe=w(re);{var V=oe=>{var ae=Pq(),x=gt(ae);zd(x,{class:"odz-w-4 odz-h-4 odz-animate-spin odz-mr-2"}),T(oe,ae)},K=oe=>{var ae=Wr("");T(oe,ae)};Se(pe,oe=>{l(a)?oe(V):oe(K,!1)})}He(oe=>{F.disabled=l(a),D.disabled=l(a),hA(D,"odz-input-error",l(A)),ce.disabled=l(a),re.disabled=oe},[()=>l(a)||!l(i).trim()],it),at("click",F,u),br(D,()=>l(i),oe=>_(i,oe)),at("keydown",D,h),at("click",ce,u),at("click",re,d),at("click",b,S_(u)),T(y,b)};Se(g,y=>{t()&&y(m)})}return T(n,f),z_(e,"setVerifyResult",c),jr({setVerifyResult:c})}var Dq=ee('<button class="odz-btn odz-btn-primary odz-btn-sm odz-gap-1"><!>  </button>'),Nq=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-16 odz-gap-4"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-text-gray-500">   ...</span></div>'),Mq=ee('<div class="odz-alert odz-alert-error odz-shadow-sm"><!> <span> </span> <button class="odz-btn odz-btn-sm odz-btn-ghost"> </button></div>'),Hq=ee('<button class="odz-btn odz-btn-primary odz-btn-sm odz-mt-4 odz-gap-1"><!>   </button>'),jq=ee('<p class="odz-text-gray-600 odz-font-medium">  </p> <p class="odz-text-sm odz-text-gray-400 odz-mt-1">  </p> <!>',1),Rq=ee('<p class="odz-text-gray-600 odz-font-medium">  </p> <p class="odz-text-sm odz-text-gray-400 odz-mt-1">   </p>',1),qq=ee('<div class="odz-text-center odz-py-16 odz-bg-gray-50 odz-rounded-xl odz-border odz-border-dashed odz-border-gray-300"><!> <!></div>'),Kq=ee('<span class="odz-badge odz-badge-xs odz-badge-info"></span>'),$q=ee('<tr class="odz-cursor-pointer hover:odz-bg-gray-50 odz-transition-colors"><td class="odz-text-center"><span class="odz-inline-flex odz-items-center odz-gap-1 odz-font-mono odz-text-xs odz-text-gray-500"> <!></span></td><td class="odz-text-center"><span><!> </span></td><td><div class="odz-flex odz-items-center odz-gap-2"><span class="odz-font-medium odz-text-gray-900 odz-truncate odz-max-w-xs hover:odz-text-primary odz-transition-colors"> </span> <!></div></td><td class="odz-text-center odz-text-sm odz-text-gray-600 odz-hidden sm:odz-table-cell"> </td><td class="odz-text-center odz-text-xs odz-text-gray-400 odz-hidden md:odz-table-cell"> </td></tr>'),Vq=ee('<span class="odz-text-gray-300"> </span>'),Gq=ee('<div class="odz-bg-white odz-rounded-xl odz-border odz-border-gray-200 odz-overflow-hidden"><table class="odz-table odz-table-sm odz-w-full"><thead><tr class="odz-bg-gray-50 odz-border-b odz-border-gray-200"><th class="odz-text-center odz-w-28 odz-text-xs odz-font-semibold odz-text-gray-500 odz-uppercase"></th><th class="odz-text-center odz-w-20 odz-text-xs odz-font-semibold odz-text-gray-500 odz-uppercase"></th><th class="odz-text-left odz-text-xs odz-font-semibold odz-text-gray-500 odz-uppercase"></th><th class="odz-text-center odz-w-24 odz-text-xs odz-font-semibold odz-text-gray-500 odz-uppercase odz-hidden sm:odz-table-cell"></th><th class="odz-text-center odz-w-28 odz-text-xs odz-font-semibold odz-text-gray-500 odz-uppercase odz-hidden md:odz-table-cell"></th></tr></thead><tbody class="odz-divide-y odz-divide-gray-100"></tbody></table></div> <div class="odz-text-center odz-text-xs odz-text-gray-400 odz-pt-2"> <!></div>',1),Wq=ee('<div class="odz-space-y-4"><div class="odz-flex odz-items-center odz-justify-between odz-pb-4 odz-border-b odz-border-gray-200"><h2 class="odz-text-xl odz-font-bold odz-text-gray-900"> </h2> <!></div> <div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-2"><div class="odz-relative odz-flex-1"><!> <input type="text" placeholder=", ,  ..." class="odz-input odz-input-bordered odz-input-sm odz-w-full odz-pl-9"></div> <select class="odz-select odz-select-bordered odz-select-sm odz-w-full sm:odz-w-32"><option></option><option></option><option></option><option></option></select></div> <!></div> <!>',1);function Xq(n,e){Hr(e,!1);let t=pt(e,"shopId",8),r=pt(e,"customerId",8,void 0),o=pt(e,"onSelectQna",8,void 0),s=pt(e,"onCreateNew",8,void 0),i=Ie([]),a=Ie([]),A=Ie(!0),d=Ie(""),c=Ie(""),u=Ie("all"),h=null,f=Ie(!1),g=Ie(null),m=Ie();En(async()=>{await y(),b()}),Eo(()=>{h&&n2(h)});async function y(){try{_(A,!0),_(d,""),_(i,await E9(t(),r()))}catch(q){console.error("[QnaList]   :",q),_(d,"     .")}finally{_(A,!1)}}function b(){h=D9(t(),async q=>{console.log("[QnaList]  :",q),await y()})}function S(q){switch(q){case"pending":return{label:"",class:"odz-badge-warning",icon:lp};case"answered":return{label:"",class:"odz-badge-success",icon:r1};case"closed":return{label:"",class:"odz-badge-neutral",icon:yu};default:return{label:"",class:"odz-badge-ghost",icon:lp}}}function F(q){return q?new Date(q).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}async function k(q){if(q.id)try{const G=await x9(q.id,r());G.canAccess?o()&&o()(q.id):G.requiresPassword?(_(g,q),_(f,!0)):alert(G.message||"  .")}catch(G){console.error("[QnaList]    :",G),alert("     .")}}async function P(q){const{qnaId:G,password:R}=q.detail;try{const he=await z9(G,R);he.canAccess?(_(f,!1),_(g,null),o()&&o()(G)):l(m)&&l(m).setVerifyResult(!1,he.message||"  .")}catch(he){console.error("[QnaList]   :",he),l(m)&&l(m).setVerifyResult(!1,"    .")}}function te(){_(f,!1),_(g,null)}function $(){s()&&s()()}Zt(()=>(l(i),l(c),l(u)),()=>{let q=l(i);if(l(c).trim()){const G=l(c).toLowerCase();q=q.filter(R=>{var he,Be,be;return((he=R.title)==null?void 0:he.toLowerCase().includes(G))||((Be=R.customer_name)==null?void 0:Be.toLowerCase().includes(G))||((be=R.inquiry_no)==null?void 0:be.toLowerCase().includes(G))})}l(u)!=="all"&&(q=q.filter(G=>G.status===l(u))),_(a,q)}),Zn(),qr();var j=Wq(),J=gt(j),we=w(J),D=z(w(we),2);{var N=q=>{var G=Dq(),R=w(G);bu(R,{class:"odz-w-4 odz-h-4"}),at("click",G,$),T(q,G)};Se(D,q=>{s()&&q(N)})}var Z=z(we,2),se=w(Z),ce=w(se);J_(ce,{class:"odz-absolute odz-left-3 odz-top-1/2 odz--translate-y-1/2 odz-w-4 odz-h-4 odz-text-gray-400"});var re=z(ce,2),pe=z(se,2);He(()=>{l(u),ip(()=>{})});var V=w(pe);V.value=(V.__value="all")==null?"":"all";var K=z(V);K.value=(K.__value="pending")==null?"":"pending";var oe=z(K);oe.value=(oe.__value="answered")==null?"":"answered";var ae=z(oe);ae.value=(ae.__value="closed")==null?"":"closed";var x=z(Z,2);{var E=q=>{var G=Nq();T(q,G)},I=q=>{var G=Nt(),R=gt(G);{var he=be=>{var Le=Mq(),Y=w(Le);yu(Y,{class:"odz-w-5 odz-h-5"});var O=z(Y,2),ve=w(O),xe=z(O,2);He(()=>Qe(ve,l(d))),at("click",xe,y),T(be,Le)},Be=be=>{var Le=Nt(),Y=gt(Le);{var O=xe=>{var me=qq(),le=w(me);iE(le,{class:"odz-w-12 odz-h-12 odz-mx-auto odz-text-gray-400 odz-mb-4"});var ze=z(le,2);{var ke=Fe=>{var U=jq(),Ae=z(gt(U),4);{var fe=Ce=>{var ge=Hq(),De=w(ge);bu(De,{class:"odz-w-4 odz-h-4"}),at("click",ge,$),T(Ce,ge)};Se(Ae,Ce=>{s()&&Ce(fe)})}T(Fe,U)},de=Fe=>{var U=Rq();T(Fe,U)};Se(ze,Fe=>{l(i).length===0?Fe(ke):Fe(de,!1)})}T(xe,me)},ve=xe=>{var me=Gq(),le=gt(me),ze=w(le),ke=z(w(ze));Jt(ke,5,()=>l(a),fe=>fe.id,(fe,Ce)=>{var ge=$q();const De=it(()=>S(l(Ce).status));var Ne=w(ge),Ze=w(Ne),Oe=w(Ze),Ke=z(Oe);{var Je=ot=>{X_(ot,{class:"odz-w-3 odz-h-3 odz-text-amber-500",title:" "})};Se(Ke,ot=>{l(Ce).customer_id||ot(Je)})}var Te=z(Ne),_e=w(Te),Ue=w(_e);Wm(Ue,()=>l(De).icon,(ot,xt)=>{xt(ot,{class:"odz-w-3 odz-h-3"})});var Me=z(Ue),je=z(Te),At=w(je),ut=w(At),ht=w(ut),Re=z(ut,2);{var Xe=ot=>{var xt=Kq();T(ot,xt)};Se(Re,ot=>{l(Ce).converted_estimate_id&&ot(Xe)})}var tt=z(je),rt=w(tt),Bt=z(tt),nt=w(Bt);He(ot=>{Qe(Oe,`${l(Ce).inquiry_no??""} `),Ir(_e,`odz-badge odz-badge-sm odz-gap-0.5 odz-whitespace-nowrap ${l(De).class??""}`),Qe(Me,` ${l(De).label??""}`),Qe(ht,l(Ce).title||"( )"),Qe(rt,l(Ce).customer_name),Qe(nt,ot)},[()=>F(l(Ce).created_at)],it),at("click",ge,()=>k(l(Ce))),T(fe,ge)});var de=z(le,2),Fe=w(de),U=z(Fe);{var Ae=fe=>{var Ce=Vq(),ge=w(Ce);He(()=>Qe(ge,`/  ${l(i).length??""}`)),T(fe,Ce)};Se(U,fe=>{l(a).length!==l(i).length&&fe(Ae)})}He(()=>Qe(Fe,` ${l(a).length??""} `)),T(xe,me)};Se(Y,xe=>{l(a).length===0?xe(O):xe(ve,!1)},!0)}T(be,Le)};Se(R,be=>{l(d)?be(he):be(Be,!1)},!0)}T(q,G)};Se(x,q=>{l(A)?q(E):q(I,!1)})}var L=z(J,2);const M=it(()=>{var q;return((q=l(g))==null?void 0:q.id)||""}),H=it(()=>{var q;return((q=l(g))==null?void 0:q.inquiry_no)||""});ts(Oq(L,{get qnaId(){return l(M)},get inquiryNo(){return l(H)},get isOpen(){return l(f)},set isOpen(q){_(f,q)},$$events:{verify:P,cancel:te},$$legacy:!0}),q=>_(m,q),()=>l(m)),br(re,()=>l(c),q=>_(c,q)),ap(pe,()=>l(u),q=>_(u,q)),T(n,j),jr()}var Yq=ee('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-dots odz-loading-md odz-text-gray-400"></div></div>'),Jq=ee('<div class="odz-text-center odz-text-red-500 odz-py-4"> </div>'),Zq=ee('<div class="odz-text-center odz-text-gray-500 odz-py-8"><p>  .</p> <p class="odz-text-sm odz-mt-1">   .</p></div>'),eK=ee('<div class="odz-flex odz-justify-center"><div class="odz-px-3 odz-py-1.5 odz-bg-gray-200 odz-text-gray-600 odz-text-xs odz-rounded-full"> </div></div>'),tK=ee("<button><!></button>"),rK=ee('<div><div class="odz-flex-shrink-0"><div><!></div></div> <div><span class="odz-text-xs odz-text-gray-500 odz-mb-1"> </span> <div class="odz-group odz-relative"><div> </div> <!></div> <span class="odz-text-xs odz-text-gray-400 odz-mt-0.5"> </span></div></div>'),nK=ee('<span class="odz-loading odz-loading-spinner odz-loading-sm"></span>'),oK=ee('<div class="odz-flex odz-flex-col odz-h-full odz-min-h-[300px]"><div class="odz-flex-1 odz-overflow-y-auto odz-space-y-4 odz-p-4 odz-bg-gray-50 odz-rounded-lg odz-max-h-[400px]"><!></div> <div class="odz-mt-4 odz-flex odz-gap-2"><textarea placeholder=" ..." class="odz-textarea odz-textarea-bordered odz-flex-1 odz-resize-none odz-h-12"></textarea> <button class="odz-btn odz-btn-primary"><!></button></div></div>');function sK(n,e){Hr(e,!1);let t=pt(e,"qnaId",8),r=pt(e,"isManager",8,!1),o=pt(e,"customerName",8,""),s=Ie([]),i=Ie(""),a=Ie(!0),A=Ie(!1),d=Ie(""),c=null,u=Ie();En(async()=>{await h(),f()}),Eo(()=>{c&&n2(c)}),V4(()=>{g()});async function h(){try{_(a,!0),_(d,""),_(s,await L9(t()))}catch(ce){console.error("[QnaComments]  :",ce),_(d,"    .")}finally{_(a,!1)}}function f(){c=N9(t(),async ce=>{console.log("[QnaComments]  :",ce),await h()})}function g(){l(u)&&hr(u,l(u).scrollTop=l(u).scrollHeight)}async function m(){if(l(i).trim())try{_(A,!0);const ce=r()?"manager":"customer",re=r()?"":o();await Rz(t(),{writer:ce,writer_name:re,content:l(i).trim()}),_(i,"")}catch(ce){console.error("[QnaComments]  :",ce),alert("    .")}finally{_(A,!1)}}async function y(ce){if(confirm("  ?"))try{await P9(ce),_(s,l(s).filter(re=>re.id!==ce))}catch(re){console.error("[QnaComments]  :",re),alert("    .")}}function b(ce){ce.key==="Enter"&&!ce.shiftKey&&(ce.preventDefault(),m())}function S(ce){switch(r()?ce.writer:ce.writer,ce.writer){case"customer":return{icon:F0,class:"odz-bg-blue-100 odz-text-blue-600",isMe:!r()};case"manager":return{icon:hE,class:"odz-bg-green-100 odz-text-green-600",isMe:r()};case"system":return{icon:tE,class:"odz-bg-gray-100 odz-text-gray-600",isMe:!1};default:return{icon:F0,class:"odz-bg-gray-100 odz-text-gray-600",isMe:!1}}}function F(ce){if(!ce)return"";const re=new Date(ce),pe=new Date;return re.toDateString()===pe.toDateString()?re.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}):re.toLocaleDateString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}qr();var k=oK(),P=w(k),te=w(P);{var $=ce=>{var re=Yq();T(ce,re)},j=ce=>{var re=Nt(),pe=gt(re);{var V=oe=>{var ae=Jq(),x=w(ae);He(()=>Qe(x,l(d))),T(oe,ae)},K=oe=>{var ae=Nt(),x=gt(ae);{var E=L=>{var M=Zq();T(L,M)},I=L=>{var M=Nt(),H=gt(M);Jt(H,1,()=>l(s),q=>q.id,(q,G)=>{var R=Nt();const he=it(()=>S(l(G)));var Be=gt(R);{var be=Y=>{var O=eK(),ve=w(O),xe=w(ve);He(()=>Qe(xe,l(G).content)),T(Y,O)},Le=Y=>{var O=rK(),ve=w(O),xe=w(ve),me=w(xe);Wm(me,()=>l(he).icon,(De,Ne)=>{Ne(De,{class:"odz-w-4 odz-h-4"})});var le=z(ve,2),ze=w(le),ke=w(ze),de=z(ze,2),Fe=w(de),U=w(Fe),Ae=z(Fe,2);{var fe=De=>{var Ne=tK(),Ze=w(Ne);n1(Ze,{class:"odz-w-3.5 odz-h-3.5 odz-text-gray-400 hover:odz-text-red-500"}),He(()=>Ir(Ne,`odz-absolute odz-top-0 ${(l(he).isMe?"odz-left-0 -odz-translate-x-full odz-pr-1":"odz-right-0 odz-translate-x-full odz-pl-1")??""} odz-opacity-0 group-hover:odz-opacity-100 odz-transition-opacity`)),at("click",Ne,()=>y(l(G).id)),T(De,Ne)};Se(Ae,De=>{(l(he).isMe||r())&&l(G).writer!=="system"&&De(fe)})}var Ce=z(de,2),ge=w(Ce);He(De=>{Ir(O,`odz-flex odz-gap-2 ${(l(he).isMe?"odz-flex-row-reverse":"")??""}`),Ir(xe,`odz-w-8 odz-h-8 odz-rounded-full ${l(he).class??""} odz-flex odz-items-center odz-justify-center`),Ir(le,`odz-flex odz-flex-col odz-max-w-[70%] ${(l(he).isMe?"odz-items-end":"odz-items-start")??""}`),Qe(ke,l(G).writer_name||l(G).writer),Ir(Fe,`odz-px-3 odz-py-2 odz-rounded-lg odz-text-sm odz-whitespace-pre-wrap ${(l(he).isMe?"odz-bg-primary odz-text-primary-content":"odz-bg-white odz-text-gray-800 odz-border odz-border-gray-200")??""}`),Qe(U,l(G).content),Qe(ge,De)},[()=>F(l(G).created_at)],it),T(Y,O)};Se(Be,Y=>{l(G).writer==="system"?Y(be):Y(Le,!1)})}T(q,R)}),T(L,M)};Se(x,L=>{l(s).length===0?L(E):L(I,!1)},!0)}T(oe,ae)};Se(pe,oe=>{l(d)?oe(V):oe(K,!1)},!0)}T(ce,re)};Se(te,ce=>{l(a)?ce($):ce(j,!1)})}ts(P,ce=>_(u,ce),()=>l(u));var J=z(P,2),we=w(J),D=z(we,2),N=w(D);{var Z=ce=>{var re=nK();T(ce,re)},se=ce=>{dE(ce,{class:"odz-w-5 odz-h-5"})};Se(N,ce=>{l(A)?ce(Z):ce(se,!1)})}He(ce=>{we.disabled=l(A),D.disabled=ce},[()=>l(A)||!l(i).trim()],it),br(we,()=>l(i),ce=>_(i,ce)),at("keydown",we,b),at("click",D,m),T(n,k),jr()}var iK=ee('<button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost" title=""><!></button>'),aK=ee('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-16 odz-gap-4"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-text-gray-500">   ...</span></div>'),AK=ee('<div class="odz-alert odz-alert-error odz-shadow-sm"><!> <span> </span></div>'),lK=ee('<span class="odz-badge odz-badge-info odz-badge-outline odz-gap-1"><!> </span>'),dK=ee('<button class="odz-btn odz-btn-sm odz-btn-outline odz-gap-1"><!> </button>'),cK=ee('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),uK=ee('<button class="odz-btn odz-btn-sm odz-btn-primary odz-gap-1"><!> </button>'),hK=ee('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),fK=ee('<div class="odz-dropdown odz-dropdown-end"><button tabindex="0" role="button" class="odz-btn odz-btn-sm odz-btn-outline odz-gap-1"><!> </button> <ul tabindex="0" class="odz-dropdown-content odz-z-[1] odz-menu odz-p-2 odz-shadow-lg odz-bg-base-100 odz-rounded-box odz-w-32 odz-mt-1 odz-border odz-border-gray-200"><li><button></button></li> <li><button></button></li> <li><button></button></li></ul></div> <!> <button class="odz-btn odz-btn-sm odz-btn-ghost odz-text-error odz-btn-square" title=""><!></button>',1),pK=ee('<p class="odz-text-sm odz-text-gray-600 odz-mt-1 odz-pl-6"> </p>'),gK=ee('<button type="button" class="odz-w-full odz-text-left odz-bg-gray-50 odz-rounded-lg odz-p-3 odz-border odz-border-gray-100 hover:odz-bg-primary/5 hover:odz-border-primary/30 odz-transition-all odz-cursor-pointer odz-group"><div class="odz-flex odz-items-center odz-justify-between"><div class="odz-flex odz-items-center odz-gap-2"><!> <span class="odz-font-mono odz-text-sm odz-font-medium odz-text-gray-900"> </span> <span> </span></div> <span class="odz-text-xs odz-text-gray-400"> </span></div> <!></button>'),vK=ee('<div class="odz-bg-white odz-rounded-xl odz-p-5 odz-border odz-border-gray-200 odz-shadow-sm"><div class="odz-flex odz-items-center odz-justify-between odz-mb-4"><h4 class="odz-text-sm odz-font-semibold odz-text-gray-500 odz-uppercase odz-tracking-wide"> </h4> <span class="odz-badge odz-badge-sm odz-badge-primary"> </span></div> <div class="odz-space-y-2"></div></div>'),mK=ee('<div class="odz-bg-white odz-rounded-xl odz-p-5 odz-border odz-border-gray-200 odz-shadow-sm"><div class="odz-flex odz-items-center odz-justify-between odz-mb-4"><h4 class="odz-text-sm odz-font-semibold odz-text-gray-500 odz-uppercase odz-tracking-wide"> </h4> <span class="odz-badge odz-badge-sm odz-badge-neutral"> </span></div> <!></div>'),wK=ee('<div class="odz-bg-gradient-to-r odz-from-gray-50 odz-to-gray-100/50 odz-rounded-xl odz-p-5 odz-border odz-border-gray-200"><div class="odz-flex odz-flex-wrap odz-items-start odz-justify-between odz-gap-4"><div class="odz-flex odz-flex-col odz-gap-2"><div class="odz-flex odz-items-center odz-gap-2 odz-flex-wrap"><span class="odz-px-2 odz-py-1 odz-bg-white odz-rounded odz-text-xs odz-font-mono odz-text-gray-600 odz-border odz-border-gray-200"> </span> <span><!> </span> <!></div> <h3 class="odz-text-lg odz-font-bold odz-text-gray-900"> </h3></div> <div class="odz-flex odz-items-center odz-gap-2 odz-flex-wrap"><!> <!></div></div> <div class="odz-divider odz-my-3"></div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 odz-gap-4 odz-text-sm"><div><span class="odz-text-gray-500"></span> <p class="odz-font-medium odz-text-gray-900"> </p></div> <div><span class="odz-text-gray-500"></span> <p class="odz-font-medium odz-text-gray-900"> </p></div> <div><span class="odz-text-gray-500"></span> <p class="odz-font-medium odz-text-gray-900 odz-break-all"> </p></div> <div><span class="odz-text-gray-500"></span> <p class="odz-font-medium odz-text-gray-900"> </p></div></div></div> <!> <div class="odz-bg-white odz-rounded-xl odz-p-5 odz-border odz-border-gray-200 odz-shadow-sm"><h4 class="odz-text-sm odz-font-semibold odz-text-gray-500 odz-uppercase odz-tracking-wide odz-mb-3"> </h4> <div class="odz-prose odz-prose-sm odz-max-w-none odz-text-gray-700 odz-whitespace-pre-wrap odz-leading-relaxed"> </div></div> <!> <div class="odz-bg-white odz-rounded-xl odz-p-5 odz-border odz-border-gray-200 odz-shadow-sm"><h4 class="odz-text-sm odz-font-semibold odz-text-gray-500 odz-uppercase odz-tracking-wide odz-mb-4"></h4> <!></div>',1),yK=ee('<div class="odz-space-y-4"><div class="odz-flex odz-items-center odz-justify-between odz-pb-4 odz-border-b odz-border-gray-200"><div class="odz-flex odz-items-center odz-gap-3"><h2 class="odz-text-xl odz-font-bold odz-text-gray-900"> </h2></div> <!></div> <!></div>');function bK(n,e){Hr(e,!1);const t=Ie();let r=pt(e,"qnaId",8);pt(e,"shopId",8);let o=pt(e,"isManager",8,!1),s=pt(e,"onBack",8,void 0),i=pt(e,"onEdit",8,void 0),a=pt(e,"onConvertToEstimate",8,void 0),A=pt(e,"onViewEstimate",8,void 0),d=Ie(null),c=[],u=[],h=Ie([]),f=Ie([]),g=Ie(!0),m=Ie(""),y=Ie(!1),b=Ie(!1),S=null;En(async()=>{await F(),k()}),Eo(()=>{S&&n2(S)});async function F(){try{if(_(g,!0),_(m,""),_(d,await Pg(r())),!l(d)){_(m,"   .");return}const[x,E,I,L]=await Promise.all([t2(r()),r2(r()),o2(r()),s2(r())]);c=x,u=E,_(h,P(c,u,I,L));try{_(f,await $9(r()))}catch(M){console.warn("[QnaDetail]    :",M),_(f,[])}}catch(x){console.error("[QnaDetail]  :",x),_(m,"     .")}finally{_(g,!1)}}function k(){S=O9(r(),async x=>{console.log("[QnaDetail]  :",x),await F()})}function P(x,E,I,L){const M=new Map;return x.forEach(H=>{const q=H.idx??0;M.has(q)||M.set(q,{idx:q,productId:H.product_id,productName:H.product_name,variants:[],prints:[],simplePrints:[],addons:[],totalQuantity:0});const G=M.get(q);G.variants.push({variantId:H.variant_id||"",variantName:H.variant_name,quantity:H.quantity||0,optionValues:H.option_values}),G.totalQuantity+=H.quantity||0}),E.forEach(H=>{const q=H.idx??0,G=M.get(q);G&&G.prints.push({objectId:H.object_id||"",printType:H.print_type||"none",title:H.title,printMethod:H.print_method,templateId:H.template_id,colors:H.colors,uploadedFiles:H.uploaded_files,fileMetadata:H.file_metadata,memo:H.memo})}),I.forEach(H=>{const q=H.idx??0,G=M.get(q);G&&G.simplePrints&&G.simplePrints.push({objectId:H.object_id||"",printMethod:H.print_method,templateId:H.template_id,selectedColors:H.selected_colors,printConfig:H.print_config,uploads:H.uploads,nameSheet:H.name_sheet,memo:H.memo,price:H.price})}),L.forEach(H=>{const q=H.idx??0,G=M.get(q);G&&G.addons&&G.addons.push({addonId:H.addon_id,addonName:H.addon_name||"",selectedProductId:H.selected_product_id,selectedProductName:H.selected_product_name||"",selectedVariantId:H.selected_variant_id,selectedVariantName:H.selected_variant_name||"",quantity:H.quantity||0})}),Array.from(M.values())}function te(x){switch(x){case"pending":return{label:"",class:"odz-badge-warning",icon:lp};case"answered":return{label:"",class:"odz-badge-success",icon:r1};case"closed":return{label:"",class:"odz-badge-neutral",icon:yu};default:return{label:"",class:"odz-badge-ghost",icon:lp}}}function $(x){return x?new Date(x).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}function j(x){switch(x){case"temp":return{label:"",class:"odz-badge-ghost"};case"pending":return{label:"",class:"odz-badge-warning"};case"progress":return{label:"",class:"odz-badge-info"};case"completed":return{label:"",class:"odz-badge-success"};case"canceled":return{label:"",class:"odz-badge-error"};case"hold":return{label:"",class:"odz-badge-neutral"};default:return{label:x,class:"odz-badge-ghost"}}}function J(){s()&&s()()}function we(x){A()?A()(x):window.location.href=`/?mode=register&estimateId=${x}&returnTo=qna`}function D(){var x;i()&&((x=l(d))!=null&&x.id)&&i()(l(d).id)}async function N(){var x;if((x=l(d))!=null&&x.id&&confirm("  ?     ."))try{_(b,!0),await F9(l(d).id),alert(" ."),s()&&s()()}catch(E){console.error("[QnaDetail]  :",E),alert("   .")}finally{_(b,!1)}}async function Z(){var x;if((x=l(d))!=null&&x.id&&confirm("   ?"))try{_(y,!0);const E=await k9(l(d).id);alert(" ."),a()&&a()(E)}catch(E){console.error("[QnaDetail]   :",E),alert("    .")}finally{_(y,!1)}}async function se(x){var E;if((E=l(d))!=null&&E.id)try{await jz(l(d).id,x),_(d,{...l(d),status:x})}catch(I){console.error("[QnaDetail]   :",I),alert("    .")}}Zt(()=>l(d),()=>{_(t,l(d)&&((l(d).product_amount??0)>0||(l(d).print_amount??0)>0||(l(d).addon_amount??0)>0||(l(d).additional_amount??0)>0))}),Zn(),qr();var ce=yK(),re=w(ce),pe=z(w(re),2);{var V=x=>{var E=iK(),I=w(E);ju(I,{class:"odz-w-5 odz-h-5"}),at("click",E,J),T(x,E)};Se(pe,x=>{s()&&x(V)})}var K=z(re,2);{var oe=x=>{var E=aK();T(x,E)},ae=x=>{var E=Nt(),I=gt(E);{var L=H=>{var q=AK(),G=w(q);yu(G,{class:"odz-w-6 odz-h-6"});var R=z(G,2),he=w(R);He(()=>Qe(he,l(m))),T(H,q)},M=H=>{var q=Nt(),G=gt(q);{var R=he=>{var Be=wK();const be=it(()=>te(l(d).status));var Le=gt(Be),Y=w(Le),O=w(Y),ve=w(O),xe=w(ve),me=w(xe),le=z(xe,2),ze=w(le);Wm(ze,()=>l(be).icon,(vt,Pt)=>{Pt(vt,{class:"odz-w-3 odz-h-3"})});var ke=z(ze),de=z(le,2);{var Fe=vt=>{var Pt=lK(),kt=w(Pt);kf(kt,{class:"odz-w-3 odz-h-3"}),T(vt,Pt)};Se(de,vt=>{l(d).converted_estimate_id&&vt(Fe)})}var U=z(ve,2),Ae=w(U),fe=z(O,2),Ce=w(fe);{var ge=vt=>{var Pt=dK(),kt=w(Pt);Y_(kt,{class:"odz-w-4 odz-h-4"}),at("click",Pt,D),T(vt,Pt)};Se(Ce,vt=>{i()&&l(d).status==="pending"&&vt(ge)})}var De=z(Ce,2);{var Ne=vt=>{var Pt=fK(),kt=gt(Pt),Ct=w(kt),Ft=w(Ct);AE(Ft,{class:"odz-w-4 odz-h-4"});var zt=z(Ct,2),Tt=w(zt),Rt=w(Tt),Dt=z(Tt,2),Mt=w(Dt),Gt=z(Dt,2),lr=w(Gt),tr=z(kt,2);{var sr=Sr=>{var fr=uK(),Lr=w(fr);{var xr=pr=>{var Pr=cK();T(pr,Pr)},Ar=pr=>{kf(pr,{class:"odz-w-4 odz-h-4"})};Se(Lr,pr=>{l(y)?pr(xr):pr(Ar,!1)})}He(()=>fr.disabled=l(y)),at("click",fr,Z),T(Sr,fr)};Se(tr,Sr=>{!l(d).converted_estimate_id&&l(h).length>0&&Sr(sr)})}var Ht=z(tr,2),mr=w(Ht);{var kr=Sr=>{var fr=hK();T(Sr,fr)},Kr=Sr=>{n1(Sr,{class:"odz-w-4 odz-h-4"})};Se(mr,Sr=>{l(b)?Sr(kr):Sr(Kr,!1)})}He(()=>{hA(Rt,"odz-font-bold",l(d).status==="pending"),hA(Mt,"odz-font-bold",l(d).status==="answered"),Ht.disabled=l(b)}),at("click",Rt,()=>se("pending")),at("click",Mt,()=>se("answered")),at("click",lr,()=>se("closed")),at("click",Ht,N),T(vt,Pt)};Se(De,vt=>{o()&&l(d).status!=="closed"&&vt(Ne)})}var Ze=z(Y,4),Oe=w(Ze),Ke=z(w(Oe),2),Je=w(Ke),Te=z(Oe,2),_e=z(w(Te),2),Ue=w(_e),Me=z(Te,2),je=z(w(Me),2),At=w(je),ut=z(Me,2),ht=z(w(ut),2),Re=w(ht),Xe=z(Le,2);{var tt=vt=>{var Pt=vK(),kt=w(Pt),Ct=z(w(kt),2),Ft=w(Ct),zt=z(kt,2);Jt(zt,5,()=>l(f),ar,(Tt,Rt)=>{var Dt=gK();const Mt=it(()=>{var xr;return j(((xr=l(Rt).estimate)==null?void 0:xr.status)||"")});var Gt=w(Dt),lr=w(Gt),tr=w(lr);kf(tr,{class:"odz-w-4 odz-h-4 odz-text-gray-400 group-hover:odz-text-primary odz-transition-colors"});var sr=z(tr,2),Ht=w(sr),mr=z(sr,2),kr=w(mr),Kr=z(lr,2),Sr=w(Kr),fr=z(Gt,2);{var Lr=xr=>{var Ar=pK(),pr=w(Ar);He(()=>Qe(pr,l(Rt).estimate.name)),T(xr,Ar)};Se(fr,xr=>{var Ar;(Ar=l(Rt).estimate)!=null&&Ar.name&&xr(Lr)})}He(xr=>{var Ar;Qe(Ht,((Ar=l(Rt).estimate)==null?void 0:Ar.estimate_no)||"-"),Ir(mr,`odz-badge odz-badge-sm ${l(Mt).class??""}`),Qe(kr,l(Mt).label),Qe(Sr,xr)},[()=>$(l(Rt).created_at)],it),at("click",Dt,()=>we(l(Rt).estimate_id)),T(Tt,Dt)}),He(()=>Qe(Ft,`${l(f).length??""}`)),T(vt,Pt)};Se(Xe,vt=>{l(f).length>0&&vt(tt)})}var rt=z(Xe,2),Bt=z(w(rt),2),nt=w(Bt),ot=z(rt,2);{var xt=vt=>{var Pt=mK(),kt=w(Pt),Ct=z(w(kt),2),Ft=w(Ct),zt=z(kt,2);qz(zt,{get products(){return l(h)},disabled:!0}),He(()=>Qe(Ft,`${l(h).length??""}`)),T(vt,Pt)};Se(ot,vt=>{l(h).length>0&&vt(xt)})}var Lt=z(ot,2),_t=z(w(Lt),2);sK(_t,{get qnaId(){return r()},get isManager(){return o()}}),He(vt=>{Qe(me,`#${l(d).inquiry_no??""}`),Ir(le,`odz-badge odz-gap-1 ${l(be).class??""}`),Qe(ke,` ${l(be).label??""}`),Qe(Ae,l(d).title||"( )"),Qe(Je,l(d).customer_name),Qe(Ue,l(d).customer_phone||"-"),Qe(At,l(d).customer_email||"-"),Qe(Re,vt),Qe(nt,l(d).content||"( )")},[()=>$(l(d).created_at)],it),T(he,Be)};Se(G,he=>{l(d)&&he(R)},!0)}T(H,q)};Se(I,H=>{l(m)?H(L):H(M,!1)},!0)}T(x,E)};Se(K,x=>{l(g)?x(oe):x(ae,!1)})}T(n,ce),jr()}var _K=ee('<dialog id="estimate-modal" class="odz-modal odz-py-10 odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl odz-h-full main-estimate-modal-box"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button></form> <!></div></dialog>'),BK=ee("<main><!></main>");function xK(n,e){Hr(e,!1);const[t,r]=uo(),o=()=>Xr(sl,"$customerStore",t);let s=Ie(""),i="",a="",A="",d="",c="",u="",h="",f="",g="",m="",y=Ie(!1),b=null,S=Ie(null),F=null,k=null,P="list",te=!1,$=null,j=null,J=null,we=null;function D(){var L,M,H,q,G,R,he,Be,be,Le;i=((L=document.getElementById("odiz-product-id"))==null?void 0:L.value)||"",A=((M=document.getElementById("odiz-shop-id"))==null?void 0:M.value)||"",d=((H=document.getElementById("odiz-sess"))==null?void 0:H.value)||"",c=((q=document.getElementById("odiz-customer-id"))==null?void 0:q.value)||"",a=((G=document.getElementById("odiz-mall_type"))==null?void 0:G.value)||"",u=((R=document.getElementById("odiz-customer-name"))==null?void 0:R.value)||"",h=((he=document.getElementById("odiz-customer-phone"))==null?void 0:he.value)||"",f=((Be=document.getElementById("odiz-customer-address1"))==null?void 0:Be.value)||"",g=((be=document.getElementById("odiz-customer-address2"))==null?void 0:be.value)||"",m=((Le=document.getElementById("odiz-customer-postcode"))==null?void 0:Le.value)||""}function N(){document.querySelectorAll("input.odiz-hidden-class").forEach(M=>{const H=M.value;if(H){const q=document.getElementsByClassName(H);for(let G=0;G<q.length;G++)q[G].style.display="none"}})}function Z(L,M,H,q,G){const R=document.createElement("div");R.className="odiz-estimate-preview-container odiz-app";const he=H.closest("div");he&&(he.insertAdjacentElement("afterend",R),ua(_R,{target:R,props:{uuid:L,idx:M,appType:q,isAddCost:G}}))}function se(L,M=5e3){return new Promise(H=>{const q=document.getElementById(L);if(q)return H(q);const G=new MutationObserver(()=>{const R=document.getElementById(L);R&&(G.disconnect(),H(R))});G.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{G.disconnect(),H(null)},M)})}function ce(L){let H=new URLSearchParams(window.location.search).get(L);if(H)return H;try{if(H=new URL(window.location.href).searchParams.get(L),H)return H}catch{}const q=document.getElementById(`odiz-${L}`);return q!=null&&q.value?q.value:null}En(async()=>{var be,Le,Y;try{const O=await sB();O>0&&console.log(`[ODIZ]   : ${O}    .`)}catch(O){console.error("[ODIZ]    :",O)}const L=ce("mode"),M=ce("estimateId"),H=ce("returnTo");console.log("[ODIZ] URL parameters:",{urlMode:L,urlEstimateId:M,urlReturnTo:H});let q=((be=document.getElementById("odiz-app-type"))==null?void 0:be.value)||"";(L==="register"||L==="list")&&(q=L,console.log("[ODIZ] AppType set from URL:",q)),M&&(F=M,console.log("[ODIZ] EditingEstimateId set:",F));const G=ce("qnaId"),R=ce("qnaMode"),he=ce("isManager");if(G&&(k=G,console.log("[ODIZ] EditingQnaId set:",k)),(R==="register"||R==="list"||R==="detail")&&(P=R,console.log("[ODIZ] QnaMode set from URL:",P)),(he==="true"||he==="1")&&(te=!0,console.log("[ODIZ] IsQnaManager set:",te)),!q){console.warn("[ODIZ] No appType detected, exiting early");return}const Be=document.getElementById("odiz-estimate");if(Be&&Be.addEventListener("click",pe),D(),N(),Ls.set({id:A,name:"",sess:d,customer_id:c}),sl.set({name:u,phone:h,address1:f,address2:g,postcode:m,mallType:a}),b=document.getElementById("odiz-estimate-list"),q==="order"||q==="admin"){const O=document.getElementById("select-order-class"),ve=document.getElementById("select-order-class-uuid");if(O&&ve){const xe=O.value,me=ve.value,le=document.getElementsByClassName(xe);if(le.length>0){const ze=le[0].getElementsByClassName(me);for(let ke=0;ke<ze.length;ke++){const de=ze[ke],Fe=((Le=de.textContent)==null?void 0:Le.trim())||"",U=/odiz\s*:\s*([a-f0-9-]+)-(\d+)/i,Ae=Fe.match(U);if(Ae){let fe=Ae[1],Ce=!1;fe.endsWith("-add")&&(fe=fe.slice(0,-4),Ce=!0);const ge=Ae[2];Z(fe,ge,de,q,Ce)}}}}}if(q==="list"&&b&&ua(jj,{target:b,props:{openEstimateModal:(O,ve)=>{Et.reset(),_(y,O),_(S,ve)}}}),q==="run"&&i){const O=document.getElementById("odiz-run-btn"),ve=((Y=document.getElementById("odiz-run-btn-name"))==null?void 0:Y.value)||" ";if(O){const xe=document.createElement("button");xe.textContent=ve,xe.type="button",xe.className="odz-btn odz-btn-primary",xe.onclick=re,O.appendChild(xe)}}if(q==="fixed"){const O=document.getElementById("odiz-fixed-area");if(O&&i){const ve=document.createElement("div");if(ve.className="odiz-fixed-product-container odiz-app",O.appendChild(ve),a)try{const xe=await S0(a,i);xe&&(_(s,xe.id),ua(Mp,{target:ve,props:{productId:l(s)}}))}catch{}else i&&(_(s,i),ua(Mp,{target:ve,props:{productId:l(s)}}))}}if(q==="register"){console.log("[ODIZ] Register mode detected, waiting for container...");const O=await se("odiz-estimate-register-area");if(O){console.log("[ODIZ] Container found, mounting EstimateRegister with estimateId:",F);const ve=document.createElement("div");ve.className="odiz-estimate-register-container odiz-app",O.appendChild(ve),ua(w9,{target:ve,props:{mallType:a,customerId:c,sess:d,shopId:A,estimateId:F,returnTo:H||"list"}})}else console.error("[ODIZ] Failed to find #odiz-estimate-register-area after 5s timeout"),console.error('[ODIZ] Make sure PHP template includes: <div id="odiz-estimate-register-area"></div>')}if(q==="qna"){console.log("[ODIZ] QNA mode detected (dialog-based)");const O=await se("odiz-qna-area");if(O){console.log("[ODIZ] QNA container found, mounting QnaList as main view...");const ve=document.createElement("div");ve.className="odiz-qna-container odiz-app",O.appendChild(ve),ua(Xq,{target:ve,props:{shopId:A,customerId:c||void 0,onSelectQna:xe=>{j=xe,ae()},onCreateNew:()=>{$=null,oe()}}}),k?P==="detail"?(j=k,setTimeout(()=>ae(),100)):P==="register"&&($=k,setTimeout(()=>oe(),100)):P==="register"&&($=null,setTimeout(()=>oe(),100))}else console.error("[ODIZ] Failed to find #odiz-qna-area after 5s timeout"),console.error('[ODIZ] Make sure PHP template includes: <div id="odiz-qna-area"></div>')}});async function re(){Et.reset(),_(S,null);try{a&&Kt(sl,lt(o).mallType=a,lt(o));const L=await S0(a,i);L?(_(s,L.id),_(y,!0)):alert("     .")}catch{alert("     .")}}function pe(){_(s,""),Et.reset(),_(S,null),_(y,!0)}function V(L){L.style.cssText=`
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      max-width: 100vw !important;
      max-height: 100vh !important;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      background: transparent !important;
    `}function K(L){L.style.cssText="",L.close()}function oe(){const L=document.getElementById("qna-register-dialog-wrapper"),M=document.getElementById("qna-register-dialog");if(L&&M){if(L.classList.add("odiz-app"),J){try{M2(J)}catch(H){console.warn("[ODIZ] Failed to unmount previous QnaRegister instance:",H)}J=null}M.innerHTML="",L.oncancel=H=>{H.preventDefault()},J=ua(Qq,{target:M,props:{shopId:A,mallType:a,customerId:c||void 0,customerName:u,customerPhone:h,qnaId:$||"",onSubmitSuccess:H=>{K(L),j=H,ae()},onCancel:()=>{K(L)}}}),L.showModal(),V(L)}}function ae(){const L=document.getElementById("qna-detail-dialog-wrapper"),M=document.getElementById("qna-detail-dialog");if(L&&M&&j){if(L.classList.add("odiz-app"),we){try{M2(we)}catch(H){console.warn("[ODIZ] Failed to unmount previous QnaDetail instance:",H)}we=null}M.innerHTML="",L.oncancel=H=>{H.preventDefault()},we=ua(bK,{target:M,props:{qnaId:j,shopId:A,isManager:te,onBack:()=>{K(L)},onEdit:H=>{K(L),$=H,oe()},onConvertToEstimate:H=>{console.log("[ODIZ] Converted to estimate:",H),alert(` . ( ID: ${H})`)}}}),L.showModal(),V(L)}}qr();var x=BK(),E=w(x);{var I=L=>{var M=_K(),H=w(M),q=w(H),G=w(q),R=z(q,2);cM(R,{get productId(){return l(s)},get estimate(){return l(S)},get isEstimateModal(){return l(y)},set isEstimateModal(he){_(y,he)},$$legacy:!0}),at("click",G,()=>_(y,!1)),T(L,M)};Se(E,L=>{l(y)&&L(I)})}T(n,x),jr(),r()}ua(xK,{target:document.getElementById("odiz-app")});export{ln as _,zK as c,nS as g};
