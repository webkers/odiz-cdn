(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerPolicy&&(s.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?s.credentials="include":o.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=t(o);fetch(o.href,s)}})();const p0=!1;var eg=Array.isArray,qC=Array.prototype.indexOf,qm=Array.from,G_=Object.defineProperty,vA=Object.getOwnPropertyDescriptor,W_=Object.getOwnPropertyDescriptors,KC=Object.prototype,$C=Array.prototype,Km=Object.getPrototypeOf;function tu(n){return typeof n=="function"}const ic=()=>{};function VC(n){return n()}function g0(n){for(var e=0;e<n.length;e++)n[e]()}const Mi=2,X_=4,ah=8,$m=16,qa=32,Sc=64,gp=128,Da=256,vp=512,Is=1024,SA=2048,ad=4096,mA=8192,tg=16384,GC=32768,Ah=65536,Y_=1<<17,WC=1<<19,J_=1<<20,La=Symbol("$state"),Z_=Symbol("legacy props"),v0=Symbol("");function eb(n){return n===this.v}function Vm(n,e){return n!=n?e==e:n!==e||n!==null&&typeof n=="object"||typeof n=="function"}function XC(n,e){return n!==e}function Gm(n){return!Vm(n,this.v)}function YC(n){throw new Error("https://svelte.dev/e/effect_in_teardown")}function JC(){throw new Error("https://svelte.dev/e/effect_in_unowned_derived")}function ZC(n){throw new Error("https://svelte.dev/e/effect_orphan")}function e4(){throw new Error("https://svelte.dev/e/effect_update_depth_exceeded")}function t4(n){throw new Error("https://svelte.dev/e/lifecycle_legacy_only")}function r4(n){throw new Error("https://svelte.dev/e/props_invalid_value")}function n4(){throw new Error("https://svelte.dev/e/state_descriptors_fixed")}function o4(){throw new Error("https://svelte.dev/e/state_prototype_fixed")}function s4(){throw new Error("https://svelte.dev/e/state_unsafe_local_read")}function i4(){throw new Error("https://svelte.dev/e/state_unsafe_mutation")}let Ec=!1,a4=!1;function A4(){Ec=!0}const Wm=1,Xm=2,tb=4,l4=8,d4=16,c4=1,u4=2,rb=4,h4=8,f4=16,nb=1,p4=2,ks=Symbol(),ob="http://www.w3.org/2000/svg";function rg(n){throw new Error("https://svelte.dev/e/lifecycle_outside_component")}let Cn=null;function H2(n){Cn=n}function ln(n,e=!1,t){Cn={p:Cn,c:null,e:null,m:!1,s:n,x:null,l:null},Ec&&!e&&(Cn.l={s:null,u:null,r1:[],r2:yi(!1)})}function dn(n){const e=Cn;if(e!==null){n!==void 0&&(e.x=n);const i=e.e;if(i!==null){var t=Sn,r=jn;e.e=null;try{for(var o=0;o<i.length;o++){var s=i[o];Ma(s.effect),cl(s.reaction),dh(s.fn)}}finally{Ma(t),cl(r)}}Cn=e.p,e.m=!0}return n||{}}function Fc(){return!Ec||Cn!==null&&Cn.l===null}function yi(n,e){var t={f:0,v:n,reactions:null,equals:eb,rv:0,wv:0};return t}function ng(n,e=!1){var r;const t=yi(n);return e||(t.equals=Gm),Ec&&Cn!==null&&Cn.l!==null&&((r=Cn.l).s??(r.s=[])).push(t),t}function Be(n,e=!1){return g4(ng(n,e))}function g4(n){return jn!==null&&!wA&&jn.f&Mi&&(Pa===null?E4([n]):Pa.push(n)),n}function br(n,e){return _(n,dt(()=>l(n))),e}function _(n,e){return jn!==null&&!wA&&Fc()&&jn.f&(Mi|$m)&&(Pa===null||!Pa.includes(n))&&i4(),Nu(n,e)}function Nu(n,e){return n.equals(e)||(n.v,n.v=e,n.wv=wb(),sb(n,SA),Fc()&&Sn!==null&&Sn.f&Is&&!(Sn.f&(qa|Sc))&&(uA===null?F4([n]):uA.push(n))),e}function Ia(n,e=1){var t=l(n),r=e===1?t++:t--;return _(n,t),r}function sb(n,e){var t=n.reactions;if(t!==null)for(var r=Fc(),o=t.length,s=0;s<o;s++){var i=t[s],a=i.f;a&SA||!r&&i===Sn||(Aa(i,e),a&(Is|Da)&&(a&Mi?sb(i,ad):Ag(i)))}}let Ym=!1;function Vd(n,e=null,t){if(typeof n!="object"||n===null||La in n)return n;const r=Km(n);if(r!==KC&&r!==$C)return n;var o=new Map,s=eg(n),i=yi(0);s&&o.set("length",yi(n.length));var a;return new Proxy(n,{defineProperty(A,d,c){(!("value"in c)||c.configurable===!1||c.enumerable===!1||c.writable===!1)&&n4();var u=o.get(d);return u===void 0?(u=yi(c.value),o.set(d,u)):_(u,Vd(c.value,a)),!0},deleteProperty(A,d){var c=o.get(d);if(c===void 0)d in A&&o.set(d,yi(ks));else{if(s&&typeof d=="string"){var u=o.get("length"),h=Number(d);Number.isInteger(h)&&h<u.v&&_(u,h)}_(c,ks),j2(i)}return!0},get(A,d,c){var v;if(d===La)return n;var u=o.get(d),h=d in A;if(u===void 0&&(!h||(v=vA(A,d))!=null&&v.writable)&&(u=yi(Vd(h?A[d]:ks,a)),o.set(d,u)),u!==void 0){var p=l(u);return p===ks?void 0:p}return Reflect.get(A,d,c)},getOwnPropertyDescriptor(A,d){var c=Reflect.getOwnPropertyDescriptor(A,d);if(c&&"value"in c){var u=o.get(d);u&&(c.value=l(u))}else if(c===void 0){var h=o.get(d),p=h==null?void 0:h.v;if(h!==void 0&&p!==ks)return{enumerable:!0,configurable:!0,value:p,writable:!0}}return c},has(A,d){var p;if(d===La)return!0;var c=o.get(d),u=c!==void 0&&c.v!==ks||Reflect.has(A,d);if(c!==void 0||Sn!==null&&(!u||(p=vA(A,d))!=null&&p.writable)){c===void 0&&(c=yi(u?Vd(A[d],a):ks),o.set(d,c));var h=l(c);if(h===ks)return!1}return u},set(A,d,c,u){var Q;var h=o.get(d),p=d in A;if(s&&d==="length")for(var v=c;v<h.v;v+=1){var w=o.get(v+"");w!==void 0?_(w,ks):v in A&&(w=yi(ks),o.set(v+"",w))}h===void 0?(!p||(Q=vA(A,d))!=null&&Q.writable)&&(h=yi(void 0),_(h,Vd(c,a)),o.set(d,h)):(p=h.v!==ks,_(h,Vd(c,a)));var y=Reflect.getOwnPropertyDescriptor(A,d);if(y!=null&&y.set&&y.set.call(u,c),!p){if(s&&typeof d=="string"){var B=o.get("length"),C=Number(d);Number.isInteger(C)&&C>=B.v&&_(B,C+1)}j2(i)}return!0},ownKeys(A){l(i);var d=Reflect.ownKeys(A).filter(h=>{var p=o.get(h);return p===void 0||p.v!==ks});for(var[c,u]of o)u.v!==ks&&!(c in A)&&d.push(c);return d},setPrototypeOf(){o4()}})}function j2(n,e=1){_(n,n.v+e)}function R2(n){return n!==null&&typeof n=="object"&&La in n?n[La]:n}function v4(n,e){return Object.is(R2(n),R2(e))}var q2,ib,ab;function m4(){if(q2===void 0){q2=window;var n=Element.prototype,e=Node.prototype;ib=vA(e,"firstChild").get,ab=vA(e,"nextSibling").get,n.__click=void 0,n.__className="",n.__attributes=null,n.__styles=null,n.__e=void 0,Text.prototype.__t=void 0}}function lh(n=""){return document.createTextNode(n)}function _i(n){return ib.call(n)}function og(n){return ab.call(n)}function g(n,e){return _i(n)}function it(n,e){{var t=_i(n);return t instanceof Comment&&t.data===""?og(t):t}}function x(n,e=1,t=!1){let r=n;for(;e--;)r=og(r);return r}function w4(n){n.textContent=""}function _c(n){var e=Mi|SA,t=jn!==null&&jn.f&Mi?jn:null;return Sn===null||t!==null&&t.f&Da?e|=Da:Sn.f|=J_,{ctx:Cn,deps:null,effects:null,equals:eb,f:e,fn:n,reactions:null,rv:0,v:null,wv:0,parent:t??Sn}}function at(n){const e=_c(n);return e.equals=Gm,e}function Ab(n){var e=n.effects;if(e!==null){n.effects=null;for(var t=0;t<e.length;t+=1)Na(e[t])}}function y4(n){for(var e=n.parent;e!==null;){if(!(e.f&Mi))return e;e=e.parent}return null}function _4(n){var e,t=Sn;Ma(y4(n));try{Ab(n),e=_b(n)}finally{Ma(t)}return e}function lb(n){var e=_4(n),t=(ol||n.f&Da)&&n.deps!==null?ad:Is;Aa(n,t),n.equals(e)||(n.v=e,n.wv=wb())}function db(n){Sn===null&&jn===null&&ZC(),jn!==null&&jn.f&Da&&Sn===null&&JC(),e1&&YC()}function b4(n,e){var t=e.last;t===null?e.last=e.first=n:(t.next=n,n.prev=t,e.last=n)}function Ic(n,e,t,r=!0){var o=(n&Sc)!==0,s=Sn,i={ctx:Cn,deps:null,nodes_start:null,nodes_end:null,f:n|SA,first:null,fn:e,last:null,next:null,parent:o?null:s,prev:null,teardown:null,transitions:null,wv:0};if(t){var a=ac;try{K2(!0),ag(i),i.f|=GC}catch(c){throw Na(i),c}finally{K2(a)}}else e!==null&&Ag(i);var A=t&&i.deps===null&&i.first===null&&i.nodes_start===null&&i.teardown===null&&(i.f&(J_|gp))===0;if(!A&&!o&&r&&(s!==null&&b4(i,s),jn!==null&&jn.f&Mi)){var d=jn;(d.effects??(d.effects=[])).push(i)}return i}function Jm(n){const e=Ic(ah,null,!1);return Aa(e,Is),e.teardown=n,e}function m0(n){db();var e=Sn!==null&&(Sn.f&qa)!==0&&Cn!==null&&!Cn.m;if(e){var t=Cn;(t.e??(t.e=[])).push({fn:n,effect:Sn,reaction:jn})}else{var r=dh(n);return r}}function x4(n){return db(),Uc(n)}function B4(n){const e=Ic(Sc,n,!0);return(t={})=>new Promise(r=>{t.outro?td(e,()=>{Na(e),r(void 0)}):(Na(e),r(void 0))})}function dh(n){return Ic(X_,n,!1)}function Yt(n,e){var t=Cn,r={effect:null,ran:!1};t.l.r1.push(r),r.effect=Uc(()=>{n(),!r.ran&&(r.ran=!0,_(t.l.r2,!0),dt(e))})}function mo(){var n=Cn;Uc(()=>{if(l(n.l.r2)){for(var e of n.l.r1){var t=e.effect;t.f&Is&&Aa(t,ad),Qc(t)&&ag(t),e.ran=!1}n.l.r2.v=!1}})}function Uc(n){return Ic(ah,n,!0)}function Ne(n,e=[],t=_c){const r=e.map(t);return Ad(()=>n(...r.map(l)))}function Ad(n,e=0){return Ic(ah|$m|e,n,!0)}function bA(n,e=!0){return Ic(ah|qa,n,!0,e)}function cb(n){var e=n.teardown;if(e!==null){const t=e1,r=jn;$2(!0),cl(null);try{e.call(null)}finally{$2(t),cl(r)}}}function ub(n,e=!1){var t=n.first;for(n.first=n.last=null;t!==null;){var r=t.next;Na(t,e),t=r}}function z4(n){for(var e=n.first;e!==null;){var t=e.next;e.f&qa||Na(e),e=t}}function Na(n,e=!0){var t=!1;if((e||n.f&WC)&&n.nodes_start!==null){for(var r=n.nodes_start,o=n.nodes_end;r!==null;){var s=r===o?null:og(r);r.remove(),r=s}t=!0}ub(n,e&&!t),yp(n,0),Aa(n,tg);var i=n.transitions;if(i!==null)for(const A of i)A.stop();cb(n);var a=n.parent;a!==null&&a.first!==null&&hb(n),n.next=n.prev=n.teardown=n.ctx=n.deps=n.fn=n.nodes_start=n.nodes_end=null}function hb(n){var e=n.parent,t=n.prev,r=n.next;t!==null&&(t.next=r),r!==null&&(r.prev=t),e!==null&&(e.first===n&&(e.first=r),e.last===n&&(e.last=t))}function td(n,e){var t=[];Zm(n,t,!0),fb(t,()=>{Na(n),e&&e()})}function fb(n,e){var t=n.length;if(t>0){var r=()=>--t||e();for(var o of n)o.out(r)}else e()}function Zm(n,e,t){if(!(n.f&mA)){if(n.f^=mA,n.transitions!==null)for(const i of n.transitions)(i.is_global||t)&&e.push(i);for(var r=n.first;r!==null;){var o=r.next,s=(r.f&Ah)!==0||(r.f&qa)!==0;Zm(r,e,s?t:!1),r=o}}}function Mu(n){pb(n,!0)}function pb(n,e){if(n.f&mA){n.f^=mA,n.f&Is||(n.f^=Is),Qc(n)&&(Aa(n,SA),Ag(n));for(var t=n.first;t!==null;){var r=t.next,o=(t.f&Ah)!==0||(t.f&qa)!==0;pb(t,o?e:!1),t=r}if(n.transitions!==null)for(const s of n.transitions)(s.is_global||e)&&s.in()}}let mp=!1,w0=[];function gb(){mp=!1;const n=w0.slice();w0=[],g0(n)}function sg(n){mp||(mp=!0,queueMicrotask(gb)),w0.push(n)}function C4(){mp&&gb()}const vb=0,S4=1;let Gf=!1,Wf=vb,Hu=!1,ju=null,ac=!1,e1=!1;function K2(n){ac=n}function $2(n){e1=n}let Hl=[],Ac=0;let jn=null,wA=!1;function cl(n){jn=n}let Sn=null;function Ma(n){Sn=n}let Pa=null;function E4(n){Pa=n}let Ns=null,mi=0,uA=null;function F4(n){uA=n}let mb=1,wp=0,ol=!1,rl=null;function wb(){return++mb}function Qc(n){var d;var e=n.f;if(e&SA)return!0;if(e&ad){var t=n.deps,r=(e&Da)!==0;if(t!==null){var o,s,i=(e&vp)!==0,a=r&&Sn!==null&&!ol,A=t.length;if(i||a){for(o=0;o<A;o++)s=t[o],(i||!((d=s==null?void 0:s.reactions)!=null&&d.includes(n)))&&(s.reactions??(s.reactions=[])).push(n);i&&(n.f^=vp)}for(o=0;o<A;o++)if(s=t[o],Qc(s)&&lb(s),s.wv>n.wv)return!0}(!r||Sn!==null&&!ol)&&Aa(n,Is)}return!1}function I4(n,e){for(var t=e;t!==null;){if(t.f&gp)try{t.fn(n);return}catch{t.f^=gp}t=t.parent}throw Gf=!1,n}function U4(n){return(n.f&tg)===0&&(n.parent===null||(n.parent.f&gp)===0)}function ig(n,e,t,r){if(Gf){if(t===null&&(Gf=!1),U4(e))throw n;return}t!==null&&(Gf=!0);{I4(n,e);return}}function yb(n,e,t=0){var r=n.reactions;if(r!==null)for(var o=0;o<r.length;o++){var s=r[o];s.f&Mi?yb(s,e,t+1):e===s&&(t===0?Aa(s,SA):s.f&Is&&Aa(s,ad),Ag(s))}}function _b(n){var p;var e=Ns,t=mi,r=uA,o=jn,s=ol,i=Pa,a=Cn,A=wA,d=n.f;Ns=null,mi=0,uA=null,jn=d&(qa|Sc)?null:n,ol=(d&Da)!==0&&(!ac||o===null||A),Pa=null,H2(n.ctx),wA=!1,wp++;try{var c=(0,n.fn)(),u=n.deps;if(Ns!==null){var h;if(yp(n,mi),u!==null&&mi>0)for(u.length=mi+Ns.length,h=0;h<Ns.length;h++)u[mi+h]=Ns[h];else n.deps=u=Ns;if(!ol)for(h=mi;h<u.length;h++)((p=u[h]).reactions??(p.reactions=[])).push(n)}else u!==null&&mi<u.length&&(yp(n,mi),u.length=mi);if(Fc()&&uA!==null&&!(n.f&(Mi|ad|SA)))for(h=0;h<uA.length;h++)yb(uA[h],n);return o!==null&&wp++,c}finally{Ns=e,mi=t,uA=r,jn=o,ol=s,Pa=i,H2(a),wA=A}}function Q4(n,e){let t=e.reactions;if(t!==null){var r=qC.call(t,n);if(r!==-1){var o=t.length-1;o===0?t=e.reactions=null:(t[r]=t[o],t.pop())}}t===null&&e.f&Mi&&(Ns===null||!Ns.includes(e))&&(Aa(e,ad),e.f&(Da|vp)||(e.f^=vp),Ab(e),yp(e,0))}function yp(n,e){var t=n.deps;if(t!==null)for(var r=e;r<t.length;r++)Q4(n,t[r])}function ag(n){var e=n.f;if(!(e&tg)){Aa(n,Is);var t=Sn,r=Cn;Sn=n;try{e&$m?z4(n):ub(n),cb(n);var o=_b(n);n.teardown=typeof o=="function"?o:null,n.wv=mb;var s=n.deps,i;p0&&a4&&n.f&SA}catch(a){ig(a,n,t,r||n.ctx)}finally{Sn=t}}}function bb(){if(Ac>1e3){Ac=0;try{e4()}catch(n){if(ju!==null)ig(n,ju,null);else throw n}}Ac++}function xb(n){var e=n.length;if(e!==0){bb();var t=ac;ac=!0;try{for(var r=0;r<e;r++){var o=n[r];o.f&Is||(o.f^=Is);var s=[];Bb(o,s),T4(s)}}finally{ac=t}}}function T4(n){var e=n.length;if(e!==0)for(var t=0;t<e;t++){var r=n[t];if(!(r.f&(tg|mA)))try{Qc(r)&&(ag(r),r.deps===null&&r.first===null&&r.nodes_start===null&&(r.teardown===null?hb(r):r.fn=null))}catch(o){ig(o,r,null,r.ctx)}}}function L4(){if(Hu=!1,Ac>1001)return;const n=Hl;Hl=[],xb(n),Hu||(Ac=0,ju=null)}function Ag(n){Wf===vb&&(Hu||(Hu=!0,queueMicrotask(L4))),ju=n;for(var e=n;e.parent!==null;){e=e.parent;var t=e.f;if(t&(Sc|qa)){if(!(t&Is))return;e.f^=Is}}Hl.push(e)}function Bb(n,e){var t=n.first,r=[];e:for(;t!==null;){var o=t.f,s=(o&qa)!==0,i=s&&(o&Is)!==0,a=t.next;if(!i&&!(o&mA))if(o&ah){if(s)t.f^=Is;else{var A=jn;try{jn=t,Qc(t)&&ag(t)}catch(h){ig(h,t,null,t.ctx)}finally{jn=A}}var d=t.first;if(d!==null){t=d;continue}}else o&X_&&r.push(t);if(a===null){let h=t.parent;for(;h!==null;){if(n===h)break e;var c=h.next;if(c!==null){t=c;continue e}h=h.parent}}t=a}for(var u=0;u<r.length;u++)d=r[u],e.push(d),Bb(d,e)}function zb(n){var e=Wf,t=Hl;try{bb();const o=[];Wf=S4,Hl=o,Hu=!1,xb(t);var r=n==null?void 0:n();return C4(),(Hl.length>0||o.length>0)&&zb(),Ac=0,ju=null,r}finally{Wf=e,Hl=t}}async function ra(){await Promise.resolve(),zb()}function l(n){var e=n.f,t=(e&Mi)!==0;if(rl!==null&&rl.add(n),jn!==null&&!wA){Pa!==null&&Pa.includes(n)&&s4();var r=jn.deps;n.rv<wp&&(n.rv=wp,Ns===null&&r!==null&&r[mi]===n?mi++:Ns===null?Ns=[n]:(!ol||!Ns.includes(n))&&Ns.push(n))}else if(t&&n.deps===null&&n.effects===null){var o=n,s=o.parent;s!==null&&!(s.f&Da)&&(o.f^=Da)}return t&&(o=n,Qc(o)&&lb(o)),n.v}function P4(n){var e=rl;rl=new Set;var t=rl,r;try{if(dt(n),e!==null)for(r of rl)e.add(r)}finally{rl=e}return t}function Ru(n){var e=P4(()=>dt(n));for(var t of e)if(t.f&Y_)for(const r of t.deps||[])r.f&Mi||Nu(r,r.v);else Nu(t,t.v)}function dt(n){var e=wA;try{return wA=!0,n()}finally{wA=e}}const k4=-7169;function Aa(n,e){n.f=n.f&k4|e}function oo(n){if(!(typeof n!="object"||!n||n instanceof EventTarget)){if(La in n)y0(n);else if(!Array.isArray(n))for(let e in n){const t=n[e];typeof t=="object"&&t&&La in t&&y0(t)}}}function y0(n,e=new Set){if(typeof n=="object"&&n!==null&&!(n instanceof EventTarget)&&!e.has(n)){e.add(n),n instanceof Date&&n.getTime();for(let r in n)try{y0(n[r],e)}catch{}const t=Km(n);if(t!==Object.prototype&&t!==Array.prototype&&t!==Map.prototype&&t!==Set.prototype&&t!==Date.prototype){const r=W_(t);for(let o in r){const s=r[o].get;if(s)try{s.call(n)}catch{}}}}}function O4(n){return n.endsWith("capture")&&n!=="gotpointercapture"&&n!=="lostpointercapture"}const D4=["beforeinput","click","change","dblclick","contextmenu","focusin","focusout","input","keydown","keyup","mousedown","mousemove","mouseout","mouseover","mouseup","pointerdown","pointermove","pointerout","pointerover","pointerup","touchend","touchmove","touchstart"];function N4(n){return D4.includes(n)}const M4={formnovalidate:"formNoValidate",ismap:"isMap",nomodule:"noModule",playsinline:"playsInline",readonly:"readOnly",defaultvalue:"defaultValue",defaultchecked:"defaultChecked",srcobject:"srcObject",novalidate:"noValidate",allowfullscreen:"allowFullscreen",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback"};function H4(n){return n=n.toLowerCase(),M4[n]??n}const j4=["touchstart","touchmove"];function R4(n){return j4.includes(n)}function q4(n,e){if(e){const t=document.body;n.autofocus=!0,sg(()=>{document.activeElement===t&&n.focus()})}}let V2=!1;function K4(){V2||(V2=!0,document.addEventListener("reset",n=>{Promise.resolve().then(()=>{var e;if(!n.defaultPrevented)for(const t of n.target.elements)(e=t.__on_r)==null||e.call(t)})},{capture:!0}))}function Cb(n){var e=jn,t=Sn;cl(null),Ma(null);try{return n()}finally{cl(e),Ma(t)}}function t1(n,e,t,r=t){n.addEventListener(e,()=>Cb(t));const o=n.__on_r;o?n.__on_r=()=>{o(),r(!0)}:n.__on_r=()=>r(!0),K4()}const Sb=new Set,_0=new Set;function Eb(n,e,t,r={}){function o(s){if(r.capture||pu.call(e,s),!s.cancelBubble)return Cb(()=>t==null?void 0:t.call(this,s))}return n.startsWith("pointer")||n.startsWith("touch")||n==="wheel"?sg(()=>{e.addEventListener(n,o,r)}):e.addEventListener(n,o,r),o}function At(n,e,t,r,o){var s={capture:r,passive:o},i=Eb(n,e,t,s);(e===document.body||e===window||e===document)&&Jm(()=>{e.removeEventListener(n,i,s)})}function Fb(n){for(var e=0;e<n.length;e++)Sb.add(n[e]);for(var t of _0)t(n)}function pu(n){var C;var e=this,t=e.ownerDocument,r=n.type,o=((C=n.composedPath)==null?void 0:C.call(n))||[],s=o[0]||n.target,i=0,a=n.__root;if(a){var A=o.indexOf(a);if(A!==-1&&(e===document||e===window)){n.__root=e;return}var d=o.indexOf(e);if(d===-1)return;A<=d&&(i=A)}if(s=o[i]||n.target,s!==e){G_(n,"currentTarget",{configurable:!0,get(){return s||t}});var c=jn,u=Sn;cl(null),Ma(null);try{for(var h,p=[];s!==null;){var v=s.assignedSlot||s.parentNode||s.host||null;try{var w=s["__"+r];if(w!==void 0&&!s.disabled)if(eg(w)){var[y,...B]=w;y.apply(s,[n,...B])}else w.call(s,n)}catch(Q){h?p.push(Q):h=Q}if(n.cancelBubble||v===e||v===null)break;s=v}if(h){for(let Q of p)queueMicrotask(()=>{throw Q});throw h}}finally{n.__root=e,delete n.currentTarget,cl(c),Ma(u)}}}function r1(n){var e=document.createElement("template");return e.innerHTML=n,e.content}function ul(n,e){var t=Sn;t.nodes_start===null&&(t.nodes_start=n,t.nodes_end=e)}function $(n,e){var t=(e&nb)!==0,r=(e&p4)!==0,o,s=!n.startsWith("<!>");return()=>{o===void 0&&(o=r1(s?n:"<!>"+n),t||(o=_i(o)));var i=r?document.importNode(o,!0):o.cloneNode(!0);if(t){var a=_i(i),A=i.lastChild;ul(a,A)}else ul(i,i);return i}}function lg(n,e,t="svg"){var r=!n.startsWith("<!>"),o=(e&nb)!==0,s=`<${t}>${r?n:"<!>"+n}</${t}>`,i;return()=>{if(!i){var a=r1(s),A=_i(a);if(o)for(i=document.createDocumentFragment();_i(A);)i.appendChild(_i(A));else i=_i(A)}var d=i.cloneNode(!0);if(o){var c=_i(d),u=d.lastChild;ul(c,u)}else ul(d,d);return d}}function bn(n=""){{var e=lh(n+"");return ul(e,e),e}}function kt(){var n=document.createDocumentFragment(),e=document.createComment(""),t=lh();return n.append(e,t),ul(e,t),n}function U(n,e){n!==null&&n.before(e)}function Se(n,e){var t=e==null?"":typeof e=="object"?e+"":e;t!==(n.__t??(n.__t=n.nodeValue))&&(n.__t=t,n.nodeValue=t+"")}function Sa(n,e){return $4(n,e)}const Cd=new Map;function $4(n,{target:e,anchor:t,props:r={},events:o,context:s,intro:i=!0}){m4();var a=new Set,A=u=>{for(var h=0;h<u.length;h++){var p=u[h];if(!a.has(p)){a.add(p);var v=R4(p);e.addEventListener(p,pu,{passive:v});var w=Cd.get(p);w===void 0?(document.addEventListener(p,pu,{passive:v}),Cd.set(p,1)):Cd.set(p,w+1)}}};A(qm(Sb)),_0.add(A);var d=void 0,c=B4(()=>{var u=t??e.appendChild(lh());return bA(()=>{if(s){ln({});var h=Cn;h.c=s}o&&(r.$$events=o),d=n(u,r)||{},s&&dn()}),()=>{var v;for(var h of a){e.removeEventListener(h,pu);var p=Cd.get(h);--p===0?(document.removeEventListener(h,pu),Cd.delete(h)):Cd.set(h,p)}_0.delete(A),u!==t&&((v=u.parentNode)==null||v.removeChild(u))}});return b0.set(d,c),d}let b0=new WeakMap;function hv(n,e){const t=b0.get(n);return t?(b0.delete(n),t(e)):Promise.resolve()}function ve(n,e,t=!1){var r=n,o=null,s=null,i=ks,a=t?Ah:0,A=!1;const d=(u,h=!0)=>{A=!0,c(h,u)},c=(u,h)=>{i!==(i=u)&&(i?(o?Mu(o):h&&(o=bA(()=>h(r))),s&&td(s,()=>{s=null})):(s?Mu(s):h&&(s=bA(()=>h(r))),o&&td(o,()=>{o=null})))};Ad(()=>{A=!1,e(d),A||c(null,null)},a)}function V4(n,e,t){var r=n,o=ks,s,i=Fc()?XC:Vm;Ad(()=>{i(o,o=e())&&(s&&td(s),s=bA(()=>t(r)))})}function mr(n,e){return e}function G4(n,e,t,r){for(var o=[],s=e.length,i=0;i<s;i++)Zm(e[i].e,o,!0);var a=s>0&&o.length===0&&t!==null;if(a){var A=t.parentNode;w4(A),A.append(t),r.clear(),ZA(n,e[0].prev,e[s-1].next)}fb(o,()=>{for(var d=0;d<s;d++){var c=e[d];a||(r.delete(c.k),ZA(n,c.prev,c.next)),Na(c.e,!a)}})}function tr(n,e,t,r,o,s=null){var i=n,a={items:new Map,first:null},A=(e&tb)!==0;if(A){var d=n;i=d.appendChild(lh())}var c=null,u=!1,h=at(()=>{var p=t();return eg(p)?p:p==null?[]:qm(p)});Ad(()=>{var p=l(h),v=p.length;u&&v===0||(u=v===0,W4(p,a,i,o,e,r,t),s!==null&&(v===0?c?Mu(c):c=bA(()=>s(i)):c!==null&&td(c,()=>{c=null})),l(h))})}function W4(n,e,t,r,o,s,i){var se,fe,ie,pe;var a=(o&l4)!==0,A=(o&(Wm|Xm))!==0,d=n.length,c=e.items,u=e.first,h=u,p,v=null,w,y=[],B=[],C,Q,k,H;if(a)for(H=0;H<d;H+=1)C=n[H],Q=s(C,H),k=c.get(Q),k!==void 0&&((se=k.a)==null||se.measure(),(w??(w=new Set)).add(k));for(H=0;H<d;H+=1){if(C=n[H],Q=s(C,H),k=c.get(Q),k===void 0){var Z=h?h.e.nodes_start:t;v=Y4(Z,e,v,v===null?e.first:v.next,C,Q,H,r,o,i),c.set(Q,v),y=[],B=[],h=v.next;continue}if(A&&X4(k,C,H,o),k.e.f&mA&&(Mu(k.e),a&&((fe=k.a)==null||fe.unfix(),(w??(w=new Set)).delete(k))),k!==h){if(p!==void 0&&p.has(k)){if(y.length<B.length){var q=B[0],N;v=q.prev;var re=y[0],be=y[y.length-1];for(N=0;N<y.length;N+=1)G2(y[N],q,t);for(N=0;N<B.length;N+=1)p.delete(B[N]);ZA(e,re.prev,be.next),ZA(e,v,re),ZA(e,be,q),h=q,v=be,H-=1,y=[],B=[]}else p.delete(k),G2(k,h,t),ZA(e,k.prev,k.next),ZA(e,k,v===null?e.first:v.next),ZA(e,v,k),v=k;continue}for(y=[],B=[];h!==null&&h.k!==Q;)h.e.f&mA||(p??(p=new Set)).add(h),B.push(h),h=h.next;if(h===null)continue;k=h}y.push(k),v=k,h=k.next}if(h!==null||p!==void 0){for(var L=p===void 0?[]:qm(p);h!==null;)h.e.f&mA||L.push(h),h=h.next;var R=L.length;if(R>0){var J=o&tb&&d===0?t:null;if(a){for(H=0;H<R;H+=1)(ie=L[H].a)==null||ie.measure();for(H=0;H<R;H+=1)(pe=L[H].a)==null||pe.fix()}G4(e,L,J,c)}}a&&sg(()=>{var te;if(w!==void 0)for(k of w)(te=k.a)==null||te.apply()}),Sn.first=e.first&&e.first.e,Sn.last=v&&v.e}function X4(n,e,t,r){r&Wm&&Nu(n.v,e),r&Xm?Nu(n.i,t):n.i=t}function Y4(n,e,t,r,o,s,i,a,A,d){var c=(A&Wm)!==0,u=(A&d4)===0,h=c?u?ng(o):yi(o):o,p=A&Xm?yi(i):i,v={i:p,v:h,k:s,a:null,e:null,prev:t,next:r};try{return v.e=bA(()=>a(n,h,p,d),Ym),v.e.prev=t&&t.e,v.e.next=r&&r.e,t===null?e.first=v:(t.next=v,t.e.next=v.e),r!==null&&(r.prev=v,r.e.prev=v.e),v}finally{}}function G2(n,e,t){for(var r=n.next?n.next.e.nodes_start:t,o=e?e.e.nodes_start:t,s=n.e.nodes_start;s!==r;){var i=og(s);o.before(s),s=i}}function ZA(n,e,t){e===null?n.first=t:(e.next=t,e.e.next=t&&t.e),t!==null&&(t.prev=e,t.e.prev=e&&e.e)}function x0(n,e,t,r,o){var s=n,i="",a;Ad(()=>{i!==(i=e()??"")&&(a!==void 0&&(Na(a),a=void 0),i!==""&&(a=bA(()=>{var A=i+"";t&&(A=`<svg>${A}</svg>`);var d=r1(A);if((t||r)&&(d=_i(d)),ul(_i(d),d.lastChild),t||r)for(;_i(d);)s.before(_i(d));else s.before(d)})))})}function hn(n,e,t,r,o){var a;var s=(a=e.$$slots)==null?void 0:a[t],i=!1;s===!0&&(s=e.children,i=!0),s===void 0||s(n,i?()=>r:r)}function Ib(n,e,t){var r=n,o,s;Ad(()=>{o!==(o=e())&&(s&&(td(s),s=null),o&&(s=bA(()=>t(r,o))))},Ah)}function J4(n,e,t,r,o,s){var i,a,A=null,d=n,c;Ad(()=>{const u=e()||null;var h=ob;u!==i&&(c&&(u===null?td(c,()=>{c=null,a=null}):u===a?Mu(c):Na(c)),u&&u!==a&&(c=bA(()=>{if(A=document.createElementNS(h,u),ul(A,A),r){var p=A.appendChild(lh());r(A,p)}Sn.nodes_end=A,d.before(A)})),i=u,i&&(a=i))},Ah)}function Ub(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var o=n.length;for(e=0;e<o;e++)n[e]&&(t=Ub(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function Z4(){for(var n,e,t=0,r="",o=arguments.length;t<o;t++)(n=arguments[t])&&(e=Ub(n))&&(r&&(r+=" "),r+=e);return r}function B0(n){return typeof n=="object"?Z4(n):n??""}function n1(n,e){var t=n.__attributes??(n.__attributes={});t.value===(t.value=e??void 0)||n.value===e&&(e!==0||n.nodeName!=="PROGRESS")||(n.value=e??"")}function qu(n,e){var t=n.__attributes??(n.__attributes={});t.checked!==(t.checked=e??void 0)&&(n.checked=e)}function eS(n,e){e?n.hasAttribute("selected")||n.setAttribute("selected",""):n.removeAttribute("selected")}function cr(n,e,t,r){var o=n.__attributes??(n.__attributes={});o[e]!==(o[e]=t)&&(e==="style"&&"__styles"in n&&(n.__styles={}),e==="loading"&&(n[v0]=t),t==null?n.removeAttribute(e):typeof t!="string"&&Qb(n).includes(e)?n[e]=t:n.setAttribute(e,t))}function W2(n,e,t,r,o=!1,s=!1,i=!1){var a=e||{},A=n.tagName==="OPTION";for(var d in e)d in t||(t[d]=null);t.class&&(t.class=B0(t.class));var c=Qb(n),u=n.__attributes??(n.__attributes={});for(const B in t){let C=t[B];if(A&&B==="value"&&C==null){n.value=n.__value="",a[B]=C;continue}var h=a[B];if(C!==h){a[B]=C;var p=B[0]+B[1];if(p!=="$$"){if(p==="on"){const Q={},k="$$"+B;let H=B.slice(2);var v=N4(H);if(O4(H)&&(H=H.slice(0,-7),Q.capture=!0),!v&&h){if(C!=null)continue;n.removeEventListener(H,a[k],Q),a[k]=null}if(C!=null)if(v)n[`__${H}`]=C,Fb([H]);else{let Z=function(q){a[B].call(this,q)};a[k]=Eb(H,n,Z,Q)}else v&&(n[`__${H}`]=void 0)}else if(B==="style"&&C!=null)n.style.cssText=C+"";else if(B==="autofocus")q4(n,!!C);else if(!s&&(B==="__value"||B==="value"&&C!=null))n.value=n.__value=C;else if(B==="selected"&&A)eS(n,C);else{var w=B;o||(w=H4(w));var y=w==="defaultValue"||w==="defaultChecked";if(C==null&&!s&&!y)if(u[B]=null,w==="value"||w==="checked"){let Q=n;if(w==="value"){let k=Q.defaultValue;Q.removeAttribute(w),Q.defaultValue=k}else{let k=Q.defaultChecked;Q.removeAttribute(w),Q.defaultChecked=k}}else n.removeAttribute(B);else y||c.includes(w)&&(s||typeof C!="string")?n[w]=C:typeof C!="function"&&cr(n,w,C)}B==="style"&&"__styles"in n&&(n.__styles={})}}}return a}var X2=new Map;function Qb(n){var e=X2.get(n.nodeName);if(e)return e;X2.set(n.nodeName,e=[]);for(var t,r=n,o=Element.prototype;o!==r;){t=W_(r);for(var s in t)t[s].set&&e.push(s);r=Km(r)}return e}function Tb(n){if(n.loading==="lazy"){var e=n.src;n[v0]=null,n.loading="eager",n.removeAttribute("src"),requestAnimationFrame(()=>{n[v0]!=="eager"&&(n.loading="lazy"),n.src=e})}}function tS(n,e,t){var r=n.__className,o=Lb(e);(r!==o||Ym)&&(o===""?n.removeAttribute("class"):n.setAttribute("class",o),n.__className=o)}function Dr(n,e,t){var r=n.__className,o=Lb(e);(r!==o||Ym)&&(e==null?n.removeAttribute("class"):n.className=o,n.__className=o)}function Lb(n,e){return(n??"")+""}function Cs(n,e,t){if(t){if(n.classList.contains(e))return;n.classList.add(e)}else{if(!n.classList.contains(e))return;n.classList.remove(e)}}function Cr(n,e,t=e){var r=Fc();t1(n,"input",o=>{var s=o?n.defaultValue:n.value;if(s=fv(n)?pv(s):s,t(s),r&&s!==(s=e())){var i=n.selectionStart,a=n.selectionEnd;n.value=s??"",a!==null&&(n.selectionStart=i,n.selectionEnd=Math.min(a,n.value.length))}}),dt(e)==null&&n.value&&t(fv(n)?pv(n.value):n.value),Uc(()=>{var o=e();fv(n)&&o===pv(n.value)||n.type==="date"&&!o&&!n.value||o!==n.value&&(n.value=o??"")})}function z0(n,e,t=e){t1(n,"change",r=>{var o=r?n.defaultChecked:n.checked;t(o)}),dt(e)==null&&t(n.checked),Uc(()=>{var r=e();n.checked=!!r})}function fv(n){var e=n.type;return e==="number"||e==="range"}function pv(n){return n===""?null:+n}function Pb(n,e,t){var r=vA(n,e);r&&r.set&&(n[e]=t,Jm(()=>{n[e]=null}))}function kb(n,e,t){if(n.multiple)return nS(n,e);for(var r of n.options){var o=zu(r);if(v4(o,e)){r.selected=!0;return}}(!t||e!==void 0)&&(n.selectedIndex=-1)}function rS(n,e){dh(()=>{var t=new MutationObserver(()=>{var r=n.__value;kb(n,r)});return t.observe(n,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),()=>{t.disconnect()}})}function Ku(n,e,t=e){var r=!0;t1(n,"change",o=>{var s=o?"[selected]":":checked",i;if(n.multiple)i=[].map.call(n.querySelectorAll(s),zu);else{var a=n.querySelector(s)??n.querySelector("option:not([disabled])");i=a&&zu(a)}t(i)}),dh(()=>{var o=e();if(kb(n,o,r),r&&o===void 0){var s=n.querySelector(":checked");s!==null&&(o=zu(s),t(o))}n.__value=o,r=!1}),rS(n)}function nS(n,e){for(var t of n.options)t.selected=~e.indexOf(zu(t))}function zu(n){return"__value"in n?n.__value:n.value}function Y2(n,e){return n===e||(n==null?void 0:n[La])===e}function fs(n={},e,t,r){return dh(()=>{var o,s;return Uc(()=>{o=s,s=[],dt(()=>{n!==t(...s)&&(e(n,...s),o&&Y2(t(...o),n)&&e(null,...o))})}),()=>{sg(()=>{s&&Y2(t(...s),n)&&e(null,...s)})}}),n}function Ob(n){return function(...e){var t=e[0];t.target===this&&(n==null||n.apply(this,e))}}function gv(n){return function(...e){var t=e[0];return t.preventDefault(),n==null?void 0:n.apply(this,e)}}function fn(n=!1){const e=Cn,t=e.l.u;if(!t)return;let r=()=>oo(e.s);if(n){let o=0,s={};const i=_c(()=>{let a=!1;const A=e.s;for(const d in A)A[d]!==s[d]&&(s[d]=A[d],a=!0);return a&&o++,o});r=()=>l(i)}t.b.length&&x4(()=>{J2(e,r),g0(t.b)}),m0(()=>{const o=dt(()=>t.m.map(VC));return()=>{for(const s of o)typeof s=="function"&&s()}}),t.a.length&&m0(()=>{J2(e,r),g0(t.a)})}function J2(n,e){if(n.l.s)for(const t of n.l.s)l(t);e()}function Db(n,e,t){if(n==null)return e(void 0),ic;const r=dt(()=>n.subscribe(e,t));return r.unsubscribe?()=>r.unsubscribe():r}const Sd=[];function ld(n,e=ic){let t=null;const r=new Set;function o(a){if(Vm(n,a)&&(n=a,t)){const A=!Sd.length;for(const d of r)d[1](),Sd.push(d,n);if(A){for(let d=0;d<Sd.length;d+=2)Sd[d][0](Sd[d+1]);Sd.length=0}}}function s(a){o(a(n))}function i(a,A=ic){const d=[a,A];return r.add(d),r.size===1&&(t=e(o,s)||ic),a(n),()=>{r.delete(d),r.size===0&&t&&(t(),t=null)}}return{set:o,update:s,subscribe:i}}function Er(n){let e;return Db(n,t=>e=t)(),e}let jh=!1,C0=Symbol();function an(n,e,t){const r=t[e]??(t[e]={store:null,source:ng(void 0),unsubscribe:ic});if(r.store!==n&&!(C0 in t))if(r.unsubscribe(),r.store=n??null,n==null)r.source.v=void 0,r.unsubscribe=ic;else{var o=!0;r.unsubscribe=Db(n,s=>{o?r.source.v=s:_(r.source,s)}),o=!1}return n&&C0 in t?Er(n):l(r.source)}function Nb(n,e){return n.set(e),e}function Vo(){const n={};function e(){Jm(()=>{for(var t in n)n[t].unsubscribe();G_(n,C0,{enumerable:!1,value:!0})})}return[n,e]}function er(n,e,t){return n.set(t),e}function oS(n){var e=jh;try{return jh=!1,[n(),jh]}finally{jh=e}}const sS={get(n,e){if(!n.exclude.includes(e))return l(n.version),e in n.special?n.special[e]():n.props[e]},set(n,e,t){return e in n.special||(n.special[e]=ht({get[e](){return n.props[e]}},e,rb)),n.special[e](t),Ia(n.version),!0},getOwnPropertyDescriptor(n,e){if(!n.exclude.includes(e)&&e in n.props)return{enumerable:!0,configurable:!0,value:n.props[e]}},deleteProperty(n,e){return n.exclude.includes(e)||(n.exclude.push(e),Ia(n.version)),!0},has(n,e){return n.exclude.includes(e)?!1:e in n.props},ownKeys(n){return Reflect.ownKeys(n.props).filter(e=>!n.exclude.includes(e))}};function An(n,e){return new Proxy({props:n,exclude:e,special:{},version:yi(0)},sS)}const iS={get(n,e){let t=n.props.length;for(;t--;){let r=n.props[t];if(tu(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r)return r[e]}},set(n,e,t){let r=n.props.length;for(;r--;){let o=n.props[r];tu(o)&&(o=o());const s=vA(o,e);if(s&&s.set)return s.set(t),!0}return!1},getOwnPropertyDescriptor(n,e){let t=n.props.length;for(;t--;){let r=n.props[t];if(tu(r)&&(r=r()),typeof r=="object"&&r!==null&&e in r){const o=vA(r,e);return o&&!o.configurable&&(o.configurable=!0),o}}},has(n,e){if(e===La||e===Z_)return!1;for(let t of n.props)if(tu(t)&&(t=t()),t!=null&&e in t)return!0;return!1},ownKeys(n){const e=[];for(let t of n.props){tu(t)&&(t=t());for(const r in t)e.includes(r)||e.push(r)}return e}};function wn(...n){return new Proxy({props:n},iS)}function Z2(n){for(var e=Sn,t=Sn;e!==null&&!(e.f&(qa|Sc));)e=e.parent;try{return Ma(e),n()}finally{Ma(t)}}function ht(n,e,t,r){var q;var o=(t&c4)!==0,s=!Ec||(t&u4)!==0,i=(t&h4)!==0,a=(t&f4)!==0,A=!1,d;i?[d,A]=oS(()=>n[e]):d=n[e];var c=La in n||Z_ in n,u=i&&(((q=vA(n,e))==null?void 0:q.set)??(c&&e in n&&(N=>n[e]=N)))||void 0,h=r,p=!0,v=!1,w=()=>(v=!0,p&&(p=!1,a?h=dt(r):h=r),h);d===void 0&&r!==void 0&&(u&&s&&r4(),d=w(),u&&u(d));var y;if(s)y=()=>{var N=n[e];return N===void 0?w():(p=!0,v=!1,N)};else{var B=Z2(()=>(o?_c:at)(()=>n[e]));B.f|=Y_,y=()=>{var N=l(B);return N!==void 0&&(h=void 0),N===void 0?h:N}}if(!(t&rb))return y;if(u){var C=n.$$legacy;return function(N,re){return arguments.length>0?((!s||!re||C||A)&&u(re?y():N),N):y()}}var Q=!1,k=!1,H=ng(d),Z=Z2(()=>_c(()=>{var N=y(),re=l(H);return Q?(Q=!1,k=!0,re):(k=!1,H.v=N)}));return o||(Z.equals=Gm),function(N,re){if(rl!==null&&(Q=k,y(),l(H)),arguments.length>0){const be=re?l(Z):s&&i?Vd(N):N;return Z.equals(be)||(Q=!0,_(H,be),v&&h!==void 0&&(h=be),dt(()=>l(Z))),N}return l(Z)}}function to(n){Cn===null&&rg(),Ec&&Cn.l!==null?Mb(Cn).m.push(n):m0(()=>{const e=dt(n);if(typeof e=="function")return e})}function gs(n){Cn===null&&rg(),to(()=>()=>dt(n))}function aS(n,e,{bubbles:t=!1,cancelable:r=!1}={}){return new CustomEvent(n,{detail:e,bubbles:t,cancelable:r})}function dg(){const n=Cn;return n===null&&rg(),(e,t,r)=>{var s;const o=(s=n.s.$$events)==null?void 0:s[e];if(o){const i=eg(o)?o.slice():[o],a=aS(e,t,r);for(const A of i)A.call(n.x,a);return!a.defaultPrevented}return!0}}function AS(n){Cn===null&&rg(),Cn.l===null&&t4(),Mb(Cn).a.push(n)}function Mb(n){var e=n.l;return e.u??(e.u={a:[],b:[],m:[]})}const lS="5";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(lS);A4();const dS="modulepreload",cS=function(n){return"/"+n},ew={},js=function(e,t,r){let o=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),a=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(t.map(A=>{if(A=cS(A),A in ew)return;ew[A]=!0;const d=A.endsWith(".css"),c=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${A}"]${c}`))return;const u=document.createElement("link");if(u.rel=d?"stylesheet":dS,d||(u.as="script"),u.crossOrigin="",u.href=A,a&&u.setAttribute("nonce",a),document.head.appendChild(u),d)return new Promise((h,p)=>{u.addEventListener("load",h),u.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${A}`)))})}))}function s(i){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=i,window.dispatchEvent(a),!a.defaultPrevented)throw i}return o.then(i=>{for(const a of i||[])a.status==="rejected"&&s(a.reason);return e().catch(s)})},uS=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>js(async()=>{const{default:r}=await Promise.resolve().then(()=>Tc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)};class o1 extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class hS extends o1{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class fS extends o1{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class pS extends o1{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var S0;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(S0||(S0={}));var gS=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class vS{constructor(e,{headers:t={},customFetch:r,region:o=S0.Any}={}){this.url=e,this.headers=t,this.region=o,this.fetch=uS(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return gS(this,void 0,void 0,function*(){try{const{headers:o,method:s,body:i}=t;let a={},{region:A}=t;A||(A=this.region),A&&A!=="any"&&(a["x-region"]=A);let d;i&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",d=i):typeof i=="string"?(a["Content-Type"]="text/plain",d=i):typeof FormData<"u"&&i instanceof FormData?d=i:(a["Content-Type"]="application/json",d=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),o),body:d}).catch(v=>{throw new hS(v)}),u=c.headers.get("x-relay-error");if(u&&u==="true")throw new fS(c);if(!c.ok)throw new pS(c);let h=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield c.json():h==="application/octet-stream"?p=yield c.blob():h==="text/event-stream"?p=c:h==="multipart/form-data"?p=yield c.formData():p=yield c.text(),{data:p,error:null}}catch(o){return{data:null,error:o}}})}}var O$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function wS(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var o=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:function(){return n[r]}})}),t}var es={},Ed={},Fd={},Id={},Ud={},Qd={},yS=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},bc=yS();const _S=bc.fetch,Hb=bc.fetch.bind(bc),jb=bc.Headers,bS=bc.Request,xS=bc.Response,Tc=Object.freeze(Object.defineProperty({__proto__:null,Headers:jb,Request:bS,Response:xS,default:Hb,fetch:_S},Symbol.toStringTag,{value:"Module"})),BS=wS(Tc);var Rh={},tw;function Rb(){if(tw)return Rh;tw=1,Object.defineProperty(Rh,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Rh.default=n,Rh}var rw;function qb(){if(rw)return Qd;rw=1;var n=Qd&&Qd.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(Qd,"__esModule",{value:!0});const e=n(BS),t=n(Rb());class r{constructor(s){this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=s.headers,this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=s.shouldThrowOnError,this.signal=s.signal,this.isMaybeSingle=s.isMaybeSingle,s.fetch?this.fetch=s.fetch:typeof fetch>"u"?this.fetch=e.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,i){return this.headers=Object.assign({},this.headers),this.headers[s]=i,this}then(s,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const a=this.fetch;let A=a(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async d=>{var c,u,h;let p=null,v=null,w=null,y=d.status,B=d.statusText;if(d.ok){if(this.method!=="HEAD"){const H=await d.text();H===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?v=H:v=JSON.parse(H))}const Q=(c=this.headers.Prefer)===null||c===void 0?void 0:c.match(/count=(exact|planned|estimated)/),k=(u=d.headers.get("content-range"))===null||u===void 0?void 0:u.split("/");Q&&k&&k.length>1&&(w=parseInt(k[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(v)&&(v.length>1?(p={code:"PGRST116",details:`Results contain ${v.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},v=null,w=null,y=406,B="Not Acceptable"):v.length===1?v=v[0]:v=null)}else{const Q=await d.text();try{p=JSON.parse(Q),Array.isArray(p)&&d.status===404&&(v=[],p=null,y=200,B="OK")}catch{d.status===404&&Q===""?(y=204,B="No Content"):p={message:Q}}if(p&&this.isMaybeSingle&&(!((h=p==null?void 0:p.details)===null||h===void 0)&&h.includes("0 rows"))&&(p=null,y=200,B="OK"),p&&this.shouldThrowOnError)throw new t.default(p)}return{error:p,data:v,count:w,status:y,statusText:B}});return this.shouldThrowOnError||(A=A.catch(d=>{var c,u,h;return{error:{message:`${(c=d==null?void 0:d.name)!==null&&c!==void 0?c:"FetchError"}: ${d==null?void 0:d.message}`,details:`${(u=d==null?void 0:d.stack)!==null&&u!==void 0?u:""}`,hint:"",code:`${(h=d==null?void 0:d.code)!==null&&h!==void 0?h:""}`},data:null,count:null,status:0,statusText:""}})),A.then(s,i)}}return Qd.default=r,Qd}var nw;function Kb(){if(nw)return Ud;nw=1;var n=Ud&&Ud.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Ud,"__esModule",{value:!0});const e=n(qb());class t extends e.default{select(o){let s=!1;const i=(o??"*").split("").map(a=>/\s/.test(a)&&!s?"":(a==='"'&&(s=!s),a)).join("");return this.url.searchParams.set("select",i),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(o,{ascending:s=!0,nullsFirst:i,foreignTable:a,referencedTable:A=a}={}){const d=A?`${A}.order`:"order",c=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${c?`${c},`:""}${o}.${s?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:s,referencedTable:i=s}={}){const a=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(a,`${o}`),this}range(o,s,{foreignTable:i,referencedTable:a=i}={}){const A=typeof a>"u"?"offset":`${a}.offset`,d=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(A,`${o}`),this.url.searchParams.set(d,`${s-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:o=!1,verbose:s=!1,settings:i=!1,buffers:a=!1,wal:A=!1,format:d="text"}={}){var c;const u=[o?"analyze":null,s?"verbose":null,i?"settings":null,a?"buffers":null,A?"wal":null].filter(Boolean).join("|"),h=(c=this.headers.Accept)!==null&&c!==void 0?c:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${d}; for="${h}"; options=${u};`,d==="json"?this:this}rollback(){var o;return((o=this.headers.Prefer)!==null&&o!==void 0?o:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}return Ud.default=t,Ud}var ow;function s1(){if(ow)return Id;ow=1;var n=Id&&Id.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Id,"__esModule",{value:!0});const e=n(Kb());class t extends e.default{eq(o,s){return this.url.searchParams.append(o,`eq.${s}`),this}neq(o,s){return this.url.searchParams.append(o,`neq.${s}`),this}gt(o,s){return this.url.searchParams.append(o,`gt.${s}`),this}gte(o,s){return this.url.searchParams.append(o,`gte.${s}`),this}lt(o,s){return this.url.searchParams.append(o,`lt.${s}`),this}lte(o,s){return this.url.searchParams.append(o,`lte.${s}`),this}like(o,s){return this.url.searchParams.append(o,`like.${s}`),this}likeAllOf(o,s){return this.url.searchParams.append(o,`like(all).{${s.join(",")}}`),this}likeAnyOf(o,s){return this.url.searchParams.append(o,`like(any).{${s.join(",")}}`),this}ilike(o,s){return this.url.searchParams.append(o,`ilike.${s}`),this}ilikeAllOf(o,s){return this.url.searchParams.append(o,`ilike(all).{${s.join(",")}}`),this}ilikeAnyOf(o,s){return this.url.searchParams.append(o,`ilike(any).{${s.join(",")}}`),this}is(o,s){return this.url.searchParams.append(o,`is.${s}`),this}in(o,s){const i=Array.from(new Set(s)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(o,`in.(${i})`),this}contains(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cs.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cs.{${s.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(s)}`),this}containedBy(o,s){return typeof s=="string"?this.url.searchParams.append(o,`cd.${s}`):Array.isArray(s)?this.url.searchParams.append(o,`cd.{${s.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(s)}`),this}rangeGt(o,s){return this.url.searchParams.append(o,`sr.${s}`),this}rangeGte(o,s){return this.url.searchParams.append(o,`nxl.${s}`),this}rangeLt(o,s){return this.url.searchParams.append(o,`sl.${s}`),this}rangeLte(o,s){return this.url.searchParams.append(o,`nxr.${s}`),this}rangeAdjacent(o,s){return this.url.searchParams.append(o,`adj.${s}`),this}overlaps(o,s){return typeof s=="string"?this.url.searchParams.append(o,`ov.${s}`):this.url.searchParams.append(o,`ov.{${s.join(",")}}`),this}textSearch(o,s,{config:i,type:a}={}){let A="";a==="plain"?A="pl":a==="phrase"?A="ph":a==="websearch"&&(A="w");const d=i===void 0?"":`(${i})`;return this.url.searchParams.append(o,`${A}fts${d}.${s}`),this}match(o){return Object.entries(o).forEach(([s,i])=>{this.url.searchParams.append(s,`eq.${i}`)}),this}not(o,s,i){return this.url.searchParams.append(o,`not.${s}.${i}`),this}or(o,{foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.or`:"or";return this.url.searchParams.append(a,`(${o})`),this}filter(o,s,i){return this.url.searchParams.append(o,`${s}.${i}`),this}}return Id.default=t,Id}var sw;function $b(){if(sw)return Fd;sw=1;var n=Fd&&Fd.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(Fd,"__esModule",{value:!0});const e=n(s1());class t{constructor(o,{headers:s={},schema:i,fetch:a}){this.url=o,this.headers=s,this.schema=i,this.fetch=a}select(o,{head:s=!1,count:i}={}){const a=s?"HEAD":"GET";let A=!1;const d=(o??"*").split("").map(c=>/\s/.test(c)&&!A?"":(c==='"'&&(A=!A),c)).join("");return this.url.searchParams.set("select",d),i&&(this.headers.Prefer=`count=${i}`),new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(o,{count:s,defaultToNull:i=!0}={}){const a="POST",A=[];if(this.headers.Prefer&&A.push(this.headers.Prefer),s&&A.push(`count=${s}`),i||A.push("missing=default"),this.headers.Prefer=A.join(","),Array.isArray(o)){const d=o.reduce((c,u)=>c.concat(Object.keys(u)),[]);if(d.length>0){const c=[...new Set(d)].map(u=>`"${u}"`);this.url.searchParams.set("columns",c.join(","))}}return new e.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}upsert(o,{onConflict:s,ignoreDuplicates:i=!1,count:a,defaultToNull:A=!0}={}){const d="POST",c=[`resolution=${i?"ignore":"merge"}-duplicates`];if(s!==void 0&&this.url.searchParams.set("on_conflict",s),this.headers.Prefer&&c.push(this.headers.Prefer),a&&c.push(`count=${a}`),A||c.push("missing=default"),this.headers.Prefer=c.join(","),Array.isArray(o)){const u=o.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(u.length>0){const h=[...new Set(u)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:d,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}update(o,{count:s}={}){const i="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),s&&a.push(`count=${s}`),this.headers.Prefer=a.join(","),new e.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}delete({count:o}={}){const s="DELETE",i=[];return o&&i.push(`count=${o}`),this.headers.Prefer&&i.unshift(this.headers.Prefer),this.headers.Prefer=i.join(","),new e.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}return Fd.default=t,Fd}var ru={},nu={},iw;function zS(){return iw||(iw=1,Object.defineProperty(nu,"__esModule",{value:!0}),nu.version=void 0,nu.version="0.0.0-automated"),nu}var aw;function CS(){if(aw)return ru;aw=1,Object.defineProperty(ru,"__esModule",{value:!0}),ru.DEFAULT_HEADERS=void 0;const n=zS();return ru.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${n.version}`},ru}var Aw;function SS(){if(Aw)return Ed;Aw=1;var n=Ed&&Ed.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ed,"__esModule",{value:!0});const e=n($b()),t=n(s1()),r=CS();class o{constructor(i,{headers:a={},schema:A,fetch:d}={}){this.url=i,this.headers=Object.assign(Object.assign({},r.DEFAULT_HEADERS),a),this.schemaName=A,this.fetch=d}from(i){const a=new URL(`${this.url}/${i}`);return new e.default(a,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new o(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,a={},{head:A=!1,get:d=!1,count:c}={}){let u;const h=new URL(`${this.url}/rpc/${i}`);let p;A||d?(u=A?"HEAD":"GET",Object.entries(a).filter(([w,y])=>y!==void 0).map(([w,y])=>[w,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([w,y])=>{h.searchParams.append(w,y)})):(u="POST",p=a);const v=Object.assign({},this.headers);return c&&(v.Prefer=`count=${c}`),new t.default({method:u,url:h,headers:v,schema:this.schemaName,body:p,fetch:this.fetch,allowEmpty:!1})}}return Ed.default=o,Ed}var lw;function ES(){if(lw)return es;lw=1;var n=es&&es.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(es,"__esModule",{value:!0}),es.PostgrestError=es.PostgrestBuilder=es.PostgrestTransformBuilder=es.PostgrestFilterBuilder=es.PostgrestQueryBuilder=es.PostgrestClient=void 0;const e=n(SS());es.PostgrestClient=e.default;const t=n($b());es.PostgrestQueryBuilder=t.default;const r=n(s1());es.PostgrestFilterBuilder=r.default;const o=n(Kb());es.PostgrestTransformBuilder=o.default;const s=n(qb());es.PostgrestBuilder=s.default;const i=n(Rb());return es.PostgrestError=i.default,es.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:s.default,PostgrestError:i.default},es}var FS=ES();const IS=mS(FS),{PostgrestClient:US,PostgrestQueryBuilder:D$,PostgrestFilterBuilder:N$,PostgrestTransformBuilder:M$,PostgrestBuilder:H$,PostgrestError:j$}=IS,QS="2.11.2",TS={"X-Client-Info":`realtime-js/${QS}`},LS="1.0.0",Vb=1e4,PS=1e3;var lc;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(lc||(lc={}));var wi;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(wi||(wi={}));var ea;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ea||(ea={}));var E0;(function(n){n.websocket="websocket"})(E0||(E0={}));var Tl;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Tl||(Tl={}));class kS{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const o=t.getUint8(1),s=t.getUint8(2);let i=this.HEADER_LENGTH+2;const a=r.decode(e.slice(i,i+o));i=i+o;const A=r.decode(e.slice(i,i+s));i=i+s;const d=JSON.parse(r.decode(e.slice(i,e.byteLength)));return{ref:null,topic:a,event:A,payload:d}}}class Gb{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Wn;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Wn||(Wn={}));const dw=(n,e,t={})=>{var r;const o=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((s,i)=>(s[i]=OS(i,n,e,o),s),{})},OS=(n,e,t,r)=>{const o=e.find(a=>a.name===n),s=o==null?void 0:o.type,i=t[n];return s&&!r.includes(s)?Wb(s,i):F0(i)},Wb=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return HS(e,t)}switch(n){case Wn.bool:return DS(e);case Wn.float4:case Wn.float8:case Wn.int2:case Wn.int4:case Wn.int8:case Wn.numeric:case Wn.oid:return NS(e);case Wn.json:case Wn.jsonb:return MS(e);case Wn.timestamp:return jS(e);case Wn.abstime:case Wn.date:case Wn.daterange:case Wn.int4range:case Wn.int8range:case Wn.money:case Wn.reltime:case Wn.text:case Wn.time:case Wn.timestamptz:case Wn.timetz:case Wn.tsrange:case Wn.tstzrange:return F0(e);default:return F0(e)}},F0=n=>n,DS=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},NS=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},MS=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},HS=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let s;const i=n.slice(1,t);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(a=>Wb(e,a))}return n},jS=n=>typeof n=="string"?n.replace(" ","T"):n,Xb=n=>{let e=n;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class vv{constructor(e,t,r={},o=Vb){this.channel=e,this.event=t,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var cw;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(cw||(cw={}));class Cu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cu.syncState(this.state,o,s,i),this.pendingDiffs.forEach(A=>{this.state=Cu.syncDiff(this.state,A,s,i)}),this.pendingDiffs=[],a()}),this.channel._on(r.diff,{},o=>{const{onJoin:s,onLeave:i,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Cu.syncDiff(this.state,o,s,i),a())}),this.onJoin((o,s,i)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:s,newPresences:i})}),this.onLeave((o,s,i)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,o){const s=this.cloneDeep(e),i=this.transformState(t),a={},A={};return this.map(s,(d,c)=>{i[d]||(A[d]=c)}),this.map(i,(d,c)=>{const u=s[d];if(u){const h=c.map(y=>y.presence_ref),p=u.map(y=>y.presence_ref),v=c.filter(y=>p.indexOf(y.presence_ref)<0),w=u.filter(y=>h.indexOf(y.presence_ref)<0);v.length>0&&(a[d]=v),w.length>0&&(A[d]=w)}else a[d]=c}),this.syncDiff(s,{joins:a,leaves:A},r,o)}static syncDiff(e,t,r,o){const{joins:s,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(s,(a,A)=>{var d;const c=(d=e[a])!==null&&d!==void 0?d:[];if(e[a]=this.cloneDeep(A),c.length>0){const u=e[a].map(p=>p.presence_ref),h=c.filter(p=>u.indexOf(p.presence_ref)<0);e[a].unshift(...h)}r(a,c,A)}),this.map(i,(a,A)=>{let d=e[a];if(!d)return;const c=A.map(u=>u.presence_ref);d=d.filter(u=>c.indexOf(u.presence_ref)<0),e[a]=d,o(a,d,A),d.length===0&&delete e[a]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const o=e[r];return"metas"in o?t[r]=o.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):t[r]=o,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var uw;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(uw||(uw={}));var hw;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(hw||(hw={}));var cA;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(cA||(cA={}));class i1{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=wi.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new vv(this,ea.join,this.params,this.timeout),this.rejoinTimer=new Gb(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=wi.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=wi.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=wi.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=wi.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ea.reply,{},(o,s)=>{this._trigger(this._replyEventName(s),o)}),this.presence=new Cu(this),this.broadcastEndpointURL=Xb(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var r,o;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:a}}=this.params;this._onError(c=>e==null?void 0:e(cA.CHANNEL_ERROR,c)),this._onClose(()=>e==null?void 0:e(cA.CLOSED));const A={},d={broadcast:s,presence:i,postgres_changes:(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&o!==void 0?o:[],private:a};this.socket.accessTokenValue&&(A.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:d},A)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:c})=>{var u;if(this.socket.setAuth(),c===void 0){e==null||e(cA.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(u=h==null?void 0:h.length)!==null&&u!==void 0?u:0,v=[];for(let w=0;w<p;w++){const y=h[w],{filter:{event:B,schema:C,table:Q,filter:k}}=y,H=c&&c[w];if(H&&H.event===B&&H.schema===C&&H.table===Q&&H.filter===k)v.push(Object.assign(Object.assign({},y),{id:H.id}));else{this.unsubscribe(),e==null||e(cA.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,e&&e(cA.SUBSCRIBED);return}}).receive("error",c=>{e==null||e(cA.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(cA.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,o;if(!this._canPush()&&e.type==="broadcast"){const{event:s,payload:i}=e,A={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,A,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=d.body)===null||o===void 0?void 0:o.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,a,A;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((A=(a=(i=this.params)===null||i===void 0?void 0:i.config)===null||a===void 0?void 0:a.broadcast)===null||A===void 0)&&A.ack)&&s("ok"),d.receive("ok",()=>s("ok")),d.receive("error",()=>s("error")),d.receive("timeout",()=>s("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=wi.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ea.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const o=new vv(this,ea.leave,{},e);o.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),o.send(),this._canPush()||o.trigger("ok",{})})}async _fetchWithTimeout(e,t,r){const o=new AbortController,s=setTimeout(()=>o.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:o.signal}));return clearTimeout(s),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new vv(this,e,t,r);return this._canPush()?o.send():(o.startTimeout(),this.pushBuffer.push(o)),o}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var o,s;const i=e.toLocaleLowerCase(),{close:a,error:A,leave:d,join:c}=ea;if(r&&[a,A,d,c].indexOf(i)>=0&&r!==this._joinRef())return;let h=this._onMessage(i,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(p=>{var v,w,y;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((y=(w=p.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===i}).map(p=>p.callback(h,r)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var v,w,y,B,C,Q;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const k=p.id,H=(v=p.filter)===null||v===void 0?void 0:v.event;return k&&((w=t.ids)===null||w===void 0?void 0:w.includes(k))&&(H==="*"||(H==null?void 0:H.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const k=(C=(B=p==null?void 0:p.filter)===null||B===void 0?void 0:B.event)===null||C===void 0?void 0:C.toLocaleLowerCase();return k==="*"||k===((Q=t==null?void 0:t.event)===null||Q===void 0?void 0:Q.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:w,table:y,commit_timestamp:B,type:C,errors:Q}=v;h=Object.assign(Object.assign({},{schema:w,table:y,commit_timestamp:B,eventType:C,new:{},old:{},errors:Q}),this._getPayloadRecords(v))}p.callback(h,r)})}_isClosed(){return this.state===wi.closed}_isJoined(){return this.state===wi.joined}_isJoining(){return this.state===wi.joining}_isLeaving(){return this.state===wi.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const o=e.toLocaleLowerCase(),s={type:o,filter:t,callback:r};return this.bindings[o]?this.bindings[o].push(s):this.bindings[o]=[s],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(o=>{var s;return!(((s=o.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===r&&i1.isEqual(o.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ea.close,{},e)}_onError(e){this._on(ea.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=wi.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=dw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=dw(e.columns,e.old_record)),t}}const RS=()=>{},qS=typeof WebSocket<"u",KS=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class $S{constructor(e,t){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=TS,this.params={},this.timeout=Vb,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=RS,this.conn=null,this.sendBuffer=[],this.serializer=new kS,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...a)=>js(async()=>{const{default:A}=await Promise.resolve().then(()=>Tc);return{default:A}},void 0).then(({default:A})=>A(...a)):i=fetch,(...a)=>i(...a)},this.endPoint=`${e}/${E0.websocket}`,this.httpEndpoint=Xb(e),t!=null&&t.transport?this.transport=t.transport:this.transport=null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const o=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.apikey;if(o&&(this.accessTokenValue=o,this.apiKey=o),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(s,i)=>i(JSON.stringify(s)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Gb(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(t==null?void 0:t.fetch),t!=null&&t.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(t==null?void 0:t.worker)||!1,this.workerUrl=t==null?void 0:t.workerUrl}this.accessToken=(t==null?void 0:t.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(qS){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new VS(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),js(async()=>{const{default:e}=await import("./browser.js").then(t=>t.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:LS}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case lc.connecting:return Tl.Connecting;case lc.open:return Tl.Open;case lc.closing:return Tl.Closing;default:return Tl.Closed}}isConnected(){return this.connectionState()===Tl.Open}channel(e,t={config:{}}){const r=new i1(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:o,ref:s}=e,i=()=>{this.encode(e,a=>{var A;(A=this.conn)===null||A===void 0||A.send(a)})};this.log("push",`${t} ${r} (${s})`,o),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let r=null;try{r=JSON.parse(atob(t.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=t,this.channels.forEach(o=>{t&&o.updateJoinPayload({access_token:t}),o.joinedOnce&&o._isJoined()&&o._push(ea.access_token,{access_token:t})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(PS,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:o,payload:s,ref:i}=t;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${r} ${o} ${i&&"("+i+")"||""}`,s),this.channels.filter(a=>a._isMember(r)).forEach(a=>a._trigger(o,s,i)),this.stateChangeCallbacks.message.forEach(a=>a(t))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ea.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",o=new URLSearchParams(t);return`${e}${r}${o}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([KS],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}}class VS{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=lc.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class a1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function rs(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class GS extends a1{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class I0 extends a1{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var WS=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const Yb=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>js(async()=>{const{default:r}=await Promise.resolve().then(()=>Tc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},XS=()=>WS(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield js(()=>Promise.resolve().then(()=>Tc),void 0)).Response:Response}),U0=n=>{if(Array.isArray(n))return n.map(t=>U0(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const o=t.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));e[o]=U0(r)}),e};var dd=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const mv=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),YS=(n,e,t)=>dd(void 0,void 0,void 0,function*(){const r=yield XS();n instanceof r&&!(t!=null&&t.noResolveJson)?n.json().then(o=>{e(new GS(mv(o),n.status||500))}).catch(o=>{e(new I0(mv(o),o))}):e(new I0(mv(n),n))}),JS=(n,e,t,r)=>{const o={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r&&(o.body=JSON.stringify(r)),Object.assign(Object.assign({},o),t))};function ch(n,e,t,r,o,s){return dd(this,void 0,void 0,function*(){return new Promise((i,a)=>{n(t,JS(e,r,o,s)).then(A=>{if(!A.ok)throw A;return r!=null&&r.noResolveJson?A:A.json()}).then(A=>i(A)).catch(A=>YS(A,a,r))})})}function _p(n,e,t,r){return dd(this,void 0,void 0,function*(){return ch(n,"GET",e,t,r)})}function el(n,e,t,r,o){return dd(this,void 0,void 0,function*(){return ch(n,"POST",e,r,o,t)})}function ZS(n,e,t,r,o){return dd(this,void 0,void 0,function*(){return ch(n,"PUT",e,r,o,t)})}function e3(n,e,t,r){return dd(this,void 0,void 0,function*(){return ch(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function Jb(n,e,t,r,o){return dd(this,void 0,void 0,function*(){return ch(n,"DELETE",e,r,o,t)})}var Ws=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const t3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},fw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class r3{constructor(e,t={},r,o){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Yb(o)}uploadOrUpdate(e,t,r,o){return Ws(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},fw),o);let a=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(i.upsert)});const A=i.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),A&&s.append("metadata",this.encodeMetadata(A)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.append("cacheControl",i.cacheControl),A&&s.append("metadata",this.encodeMetadata(A))):(s=r,a["cache-control"]=`max-age=${i.cacheControl}`,a["content-type"]=i.contentType,A&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(A)))),o!=null&&o.headers&&(a=Object.assign(Object.assign({},a),o.headers));const d=this._removeEmptyFolders(t),c=this._getFinalPath(d),u=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:s,headers:a},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield u.json();return u.ok?{data:{path:d,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(rs(s))return{data:null,error:s};throw s}})}upload(e,t,r){return Ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,o){return Ws(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(e),i=this._getFinalPath(s),a=new URL(this.url+`/object/upload/sign/${i}`);a.searchParams.set("token",t);try{let A;const d=Object.assign({upsert:fw.upsert},o),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(A=new FormData,A.append("cacheControl",d.cacheControl),A.append("",r)):typeof FormData<"u"&&r instanceof FormData?(A=r,A.append("cacheControl",d.cacheControl)):(A=r,c["cache-control"]=`max-age=${d.cacheControl}`,c["content-type"]=d.contentType);const u=yield this.fetch(a.toString(),{method:"PUT",body:A,headers:c}),h=yield u.json();return u.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(A){if(rs(A))return{data:null,error:A};throw A}})}createSignedUploadUrl(e,t){return Ws(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const o=Object.assign({},this.headers);t!=null&&t.upsert&&(o["x-upsert"]="true");const s=yield el(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),i=new URL(this.url+s.url),a=i.searchParams.get("token");if(!a)throw new a1("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:a},error:null}}catch(r){if(rs(r))return{data:null,error:r};throw r}})}update(e,t,r){return Ws(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return Ws(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(rs(o))return{data:null,error:o};throw o}})}copy(e,t,r){return Ws(this,void 0,void 0,function*(){try{return{data:{path:(yield el(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(rs(o))return{data:null,error:o};throw o}})}createSignedUrl(e,t,r){return Ws(this,void 0,void 0,function*(){try{let o=this._getFinalPath(e),s=yield el(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(o){if(rs(o))return{data:null,error:o};throw o}})}createSignedUrls(e,t,r){return Ws(this,void 0,void 0,function*(){try{const o=yield el(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),s=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(o){if(rs(o))return{data:null,error:o};throw o}})}download(e,t){return Ws(this,void 0,void 0,function*(){const o=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),i=s?`?${s}`:"";try{const a=this._getFinalPath(e);return{data:yield(yield _p(this.fetch,`${this.url}/${o}/${a}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(rs(a))return{data:null,error:a};throw a}})}info(e){return Ws(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield _p(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:U0(r),error:null}}catch(r){if(rs(r))return{data:null,error:r};throw r}})}exists(e){return Ws(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield e3(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(rs(r)&&r instanceof I0){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),o=[],s=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";s!==""&&o.push(s);const a=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",A=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});A!==""&&o.push(A);let d=o.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${r}${d}`)}}}remove(e){return Ws(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(rs(t))return{data:null,error:t};throw t}})}list(e,t,r){return Ws(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},t3),t),{prefix:e||""});return{data:yield el(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(rs(o))return{data:null,error:o};throw o}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const n3="2.7.1",o3={"X-Client-Info":`storage-js/${n3}`};var Td=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class s3{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},o3),t),this.fetch=Yb(r)}listBuckets(){return Td(this,void 0,void 0,function*(){try{return{data:yield _p(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(rs(e))return{data:null,error:e};throw e}})}getBucket(e){return Td(this,void 0,void 0,function*(){try{return{data:yield _p(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(rs(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return Td(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(rs(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return Td(this,void 0,void 0,function*(){try{return{data:yield ZS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(rs(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Td(this,void 0,void 0,function*(){try{return{data:yield el(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(rs(t))return{data:null,error:t};throw t}})}deleteBucket(e){return Td(this,void 0,void 0,function*(){try{return{data:yield Jb(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(rs(t))return{data:null,error:t};throw t}})}}class i3 extends s3{constructor(e,t={},r){super(e,t,r)}from(e){return new r3(this.url,this.headers,e,this.fetch)}}const a3="2.48.1";let gu="";typeof Deno<"u"?gu="deno":typeof document<"u"?gu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?gu="react-native":gu="node";const A3={"X-Client-Info":`supabase-js-${gu}/${a3}`},l3={headers:A3},d3={schema:"public"},c3={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},u3={};var h3=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};const f3=n=>{let e;return n?e=n:typeof fetch>"u"?e=Hb:e=fetch,(...t)=>e(...t)},p3=()=>typeof Headers>"u"?jb:Headers,g3=(n,e,t)=>{const r=f3(t),o=p3();return(s,i)=>h3(void 0,void 0,void 0,function*(){var a;const A=(a=yield e())!==null&&a!==void 0?a:n;let d=new o(i==null?void 0:i.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${A}`),r(s,Object.assign(Object.assign({},i),{headers:d}))})};var v3=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};function m3(n){return n.replace(/\/$/,"")}function w3(n,e){const{db:t,auth:r,realtime:o,global:s}=n,{db:i,auth:a,realtime:A,global:d}=e,c={db:Object.assign(Object.assign({},i),t),auth:Object.assign(Object.assign({},a),r),realtime:Object.assign(Object.assign({},A),o),global:Object.assign(Object.assign({},d),s),accessToken:()=>v3(this,void 0,void 0,function*(){return""})};return n.accessToken?c.accessToken=n.accessToken:delete c.accessToken,c}const Zb="2.67.3",y3="http://localhost:9999",_3="supabase.auth.token",b3={"X-Client-Info":`gotrue-js/${Zb}`},pw=10,Q0="X-Supabase-Api-Version",e5={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function x3(n){return Math.round(Date.now()/1e3)+n}function B3(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Ea=()=>typeof window<"u"&&typeof document<"u",Fl={tested:!1,writable:!1},Su=()=>{if(!Ea())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Fl.tested)return Fl.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Fl.tested=!0,Fl.writable=!0}catch{Fl.tested=!0,Fl.writable=!1}return Fl.writable};function z3(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((o,s)=>{e[s]=o})}catch{}return t.searchParams.forEach((r,o)=>{e[o]=r}),e}const t5=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>js(async()=>{const{default:r}=await Promise.resolve().then(()=>Tc);return{default:r}},void 0).then(({default:r})=>r(...t)):e=fetch,(...t)=>e(...t)},C3=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",r5=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},qh=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Kh=async(n,e)=>{await n.removeItem(e)};function S3(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,o,s,i,a,A,d,c=0;for(n=n.replace("-","+").replace("_","/");c<n.length;)i=e.indexOf(n.charAt(c++)),a=e.indexOf(n.charAt(c++)),A=e.indexOf(n.charAt(c++)),d=e.indexOf(n.charAt(c++)),r=i<<2|a>>4,o=(a&15)<<4|A>>2,s=(A&3)<<6|d,t=t+String.fromCharCode(r),A!=64&&o!=0&&(t=t+String.fromCharCode(o)),d!=64&&s!=0&&(t=t+String.fromCharCode(s));return t}class cg{constructor(){this.promise=new cg.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}cg.promiseConstructor=Promise;function gw(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(S3(r))}async function E3(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function F3(n,e){return new Promise((r,o)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await n(s);if(!e(s,null,i)){r(i);return}}catch(i){if(!e(s,i)){o(i);return}}})()})}function I3(n){return("0"+n.toString(16)).substr(-2)}function U3(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let o="";for(let s=0;s<56;s++)o+=t.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(e),Array.from(e,I3).join("")}async function Q3(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),o=new Uint8Array(r);return Array.from(o).map(s=>String.fromCharCode(s)).join("")}function T3(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function L3(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await Q3(n);return T3(t)}async function Ld(n,e,t=!1){const r=U3();let o=r;t&&(o+="/PASSWORD_RECOVERY"),await r5(n,`${e}-code-verifier`,o);const s=await L3(r);return[s,r===s?"plain":"s256"]}const P3=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function k3(n){const e=n.headers.get(Q0);if(!e||!e.match(P3))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class A1 extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function $r(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class O3 extends A1{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function D3(n){return $r(n)&&n.name==="AuthApiError"}class n5 extends A1{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class cd extends A1{constructor(e,t,r,o){super(e,r,o),this.name=t,this.status=r}}class WA extends cd{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function N3(n){return $r(n)&&n.name==="AuthSessionMissingError"}class wv extends cd{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class $h extends cd{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Vh extends cd{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function M3(n){return $r(n)&&n.name==="AuthImplicitGrantRedirectError"}class vw extends cd{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class T0 extends cd{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function yv(n){return $r(n)&&n.name==="AuthRetryableFetchError"}class mw extends cd{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}var H3=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};const Ul=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),j3=[502,503,504];async function ww(n){var e;if(!C3(n))throw new T0(Ul(n),0);if(j3.includes(n.status))throw new T0(Ul(n),n.status);let t;try{t=await n.json()}catch(s){throw new n5(Ul(s),s)}let r;const o=k3(n);if(o&&o.getTime()>=e5["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new mw(Ul(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new WA}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new mw(Ul(t),n.status,t.weak_password.reasons);throw new O3(Ul(t),n.status||500,r)}const R3=(n,e,t,r)=>{const o={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),t))};async function on(n,e,t,r){var o;const s=Object.assign({},r==null?void 0:r.headers);s[Q0]||(s[Q0]=e5["2024-01-01"].name),r!=null&&r.jwt&&(s.Authorization=`Bearer ${r.jwt}`);const i=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(i.redirect_to=r.redirectTo);const a=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",A=await q3(n,e,t+a,{headers:s,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(A):{data:Object.assign({},A),error:null}}async function q3(n,e,t,r,o,s){const i=R3(e,r,o,s);let a;try{a=await n(t,Object.assign({},i))}catch(A){throw console.error(A),new T0(Ul(A),0)}if(a.ok||await ww(a),r!=null&&r.noResolveJson)return a;try{return await a.json()}catch(A){await ww(A)}}function XA(n){var e;let t=null;G3(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=x3(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function yw(n){const e=XA(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function nl(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function K3(n){return{data:n,error:null}}function $3(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:s}=n,i=H3(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:e,email_otp:t,hashed_token:r,redirect_to:o,verification_type:s},A=Object.assign({},i);return{data:{properties:a,user:A},error:null}}function V3(n){return n}function G3(n){return n.access_token&&n.refresh_token&&n.expires_in}var W3=function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(n);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(n,r[o])&&(t[r[o]]=n[r[o]]);return t};class X3{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=t5(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await on(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if($r(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await on(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:nl})}catch(r){if($r(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=W3(e,["options"]),o=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await on(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:$3,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if($r(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await on(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:nl})}catch(t){if($r(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,o,s,i,a,A;try{const d={nextPage:null,lastPage:0,total:0},c=await on(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(s=(o=e==null?void 0:e.perPage)===null||o===void 0?void 0:o.toString())!==null&&s!==void 0?s:""},xform:V3});if(c.error)throw c.error;const u=await c.json(),h=(i=c.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(A=(a=c.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&A!==void 0?A:[];return p.length>0&&(p.forEach(v=>{const w=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(v.split(";")[1].split("=")[1]);d[`${y}Page`]=w}),d.total=parseInt(h)),{data:Object.assign(Object.assign({},u),d),error:null}}catch(d){if($r(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){try{return await on(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:nl})}catch(t){if($r(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await on(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:nl})}catch(r){if($r(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await on(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:nl})}catch(r){if($r(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await on(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:t,error:r}}catch(t){if($r(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await on(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if($r(t))return{data:null,error:t};throw t}}}const Y3={getItem:n=>Su()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Su()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Su()&&globalThis.localStorage.removeItem(n)}};function _w(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}function J3(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Pd={debug:!!(globalThis&&Su()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class o5 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class Z3 extends o5{}async function eE(n,e,t){Pd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Pd.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Pd.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,o.name);try{return await t()}finally{Pd.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,o.name)}}else{if(e===0)throw Pd.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Z3(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Pd.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}J3();const tE={url:y3,storageKey:_3,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:b3,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},ou=30*1e3,bw=3;async function xw(n,e,t){return await t()}class $u{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=$u.nextInstanceID,$u.nextInstanceID+=1,this.instanceID>0&&Ea()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},tE),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new X3({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=t5(o.fetch),this.lock=o.lock||xw,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:Ea()&&(!((t=globalThis==null?void 0:globalThis.navigator)===null||t===void 0)&&t.locks)?this.lock=eE:this.lock=xw,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:Su()?this.storage=Y3:(this.memoryStorage={},this.storage=_w(this.memoryStorage)):(this.memoryStorage={},this.storage=_w(this.memoryStorage)),Ea()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${Zb}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const t=z3(window.location.href);let r="none";if(this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce"),Ea()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:s}=await this._getSessionFromURL(t,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),M3(s)){const A=(e=s.details)===null||e===void 0?void 0:e.code;if(A==="identity_already_exists"||A==="identity_not_found"||A==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:a}=o;return this._debug("#_initialize()","detected session in URL",i,"redirect type",a),await this._saveSession(i),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return $r(t)?{error:t}:{error:new n5("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,o;try{const s=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e==null?void 0:e.options)===null||o===void 0?void 0:o.captchaToken}},xform:XA}),{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const A=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(s){if($r(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(e){var t,r,o;try{let s;if("email"in e){const{email:c,password:u,options:h}=e;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await Ld(this.storage,this.storageKey)),s=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:c,password:u,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:v},xform:XA})}else if("phone"in e){const{phone:c,password:u,options:h}=e;s=await on(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:u,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(o=h==null?void 0:h.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:XA})}else throw new $h("You must provide either an email or phone number and a password");const{data:i,error:a}=s;if(a||!i)return{data:{user:null,session:null},error:a};const A=i.session,d=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(s){if($r(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:i,options:a}=e;t=await on(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:yw})}else if("phone"in e){const{phone:s,password:i,options:a}=e;t=await on(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:yw})}else throw new $h("You must provide either an email or phone number and a password");const{data:r,error:o}=t;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new wv}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(t){if($r(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,o,s;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const t=await qh(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(t??"").split("/");try{const{data:s,error:i}=await on(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:XA});if(await Kh(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new wv}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:i})}catch(s){if($r(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(e){try{const{options:t,provider:r,token:o,access_token:s,nonce:i}=e,a=await on(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:XA}),{data:A,error:d}=a;return d?{data:{user:null,session:null},error:d}:!A||!A.session||!A.user?{data:{user:null,session:null},error:new wv}:(A.session&&(await this._saveSession(A.session),await this._notifyAllSubscribers("SIGNED_IN",A.session)),{data:A,error:d})}catch(t){if($r(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,o,s,i;try{if("email"in e){const{email:a,options:A}=e;let d=null,c=null;this.flowType==="pkce"&&([d,c]=await Ld(this.storage,this.storageKey));const{error:u}=await on(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(t=A==null?void 0:A.data)!==null&&t!==void 0?t:{},create_user:(r=A==null?void 0:A.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken},code_challenge:d,code_challenge_method:c},redirectTo:A==null?void 0:A.emailRedirectTo});return{data:{user:null,session:null},error:u}}if("phone"in e){const{phone:a,options:A}=e,{data:d,error:c}=await on(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(o=A==null?void 0:A.data)!==null&&o!==void 0?o:{},create_user:(s=A==null?void 0:A.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:A==null?void 0:A.captchaToken},channel:(i=A==null?void 0:A.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:c}}throw new $h("You must provide either an email or phone number.")}catch(a){if($r(a))return{data:{user:null,session:null},error:a};throw a}}async verifyOtp(e){var t,r;try{let o,s;"options"in e&&(o=(t=e.options)===null||t===void 0?void 0:t.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:i,error:a}=await on(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:XA});if(a)throw a;if(!i)throw new Error("An error occurred on token verification.");const A=i.session,d=i.user;return A!=null&&A.access_token&&(await this._saveSession(A),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",A)),{data:{user:d,session:A},error:null}}catch(o){if($r(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(e){var t,r,o;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await Ld(this.storage,this.storageKey)),await on(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e==null?void 0:e.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:K3})}catch(s){if($r(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new WA;const{error:o}=await on(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:o}})}catch(e){if($r(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:o,options:s}=e,{error:i}=await on(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in e){const{phone:r,type:o,options:s}=e,{data:i,error:a}=await on(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:a}}throw new $h("You must provide either an email or phone number and a type")}catch(t){if($r(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await qh(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let i=this.suppressGetSessionWarning;e=new Proxy(e,{get:(A,d,c)=>(!i&&d==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(A,d,c))})}return{data:{session:e},error:null}}const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await on(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:nl}):await this._useSession(async t=>{var r,o,s;const{data:i,error:a}=t;if(a)throw a;return!(!((r=i.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new WA}:await on(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=i.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:nl})})}catch(t){if($r(t))return N3(t)&&(await this._removeSession(),await Kh(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:o,error:s}=r;if(s)throw s;if(!o.session)throw new WA;const i=o.session;let a=null,A=null;this.flowType==="pkce"&&e.email!=null&&([a,A]=await Ld(this.storage,this.storageKey));const{data:d,error:c}=await on(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:a,code_challenge_method:A}),jwt:i.access_token,xform:nl});if(c)throw c;return i.user=d.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(r){if($r(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return gw(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new WA;const t=Date.now()/1e3;let r=t,o=!0,s=null;const i=gw(e.access_token);if(i.exp&&(r=i.exp,o=r<=t),o){const{session:a,error:A}=await this._callRefreshToken(e.refresh_token);if(A)return{data:{user:null,session:null},error:A};if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:A}=await this._getUser(e.access_token);if(A)throw A;s={access_token:e.access_token,refresh_token:e.refresh_token,user:a.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(t){if($r(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:i,error:a}=t;if(a)throw a;e=(r=i.session)!==null&&r!==void 0?r:void 0}if(!(e!=null&&e.refresh_token))throw new WA;const{session:o,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(t){if($r(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ea())throw new Vh("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Vh(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new vw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vh("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new vw("No code detected.");const{data:C,error:Q}=await this._exchangeCodeForSession(e.code);if(Q)throw Q;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:C.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:i,expires_in:a,expires_at:A,token_type:d}=e;if(!s||!a||!i||!d)throw new Vh("No session defined in URL");const c=Math.round(Date.now()/1e3),u=parseInt(a);let h=c+u;A&&(h=parseInt(A));const p=h-c;p*1e3<=ou&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${u}s`);const v=h-u;c-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,c):c-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,c);const{data:w,error:y}=await this._getUser(s);if(y)throw y;const B={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:u,expires_at:h,refresh_token:i,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:B,redirectType:e.type},error:null}}catch(r){if($r(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await qh(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:o,error:s}=t;if(s)return{error:s};const i=(r=o.session)===null||r===void 0?void 0:r.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(D3(a)&&(a.status===404||a.status===401||a.status===403)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Kh(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const t=B3(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,o;try{const{data:{session:s},error:i}=t;if(i)throw i;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}})}async resetPasswordForEmail(e,t={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await Ld(this.storage,this.storageKey,!0));try{return await on(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(s){if($r(s))return{data:null,error:s};throw s}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(t){if($r(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:r,error:o}=await this._useSession(async s=>{var i,a,A,d,c;const{data:u,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(a=e.options)===null||a===void 0?void 0:a.scopes,queryParams:(A=e.options)===null||A===void 0?void 0:A.queryParams,skipBrowserRedirect:!0});return await on(this.fetch,"GET",p,{headers:this.headers,jwt:(c=(d=u.session)===null||d===void 0?void 0:d.access_token)!==null&&c!==void 0?c:void 0})});if(o)throw o;return Ea()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:e.provider,url:r==null?void 0:r.url},error:null}}catch(r){if($r(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,o;const{data:s,error:i}=t;if(i)throw i;return await on(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(t){if($r(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await F3(async o=>(o>0&&await E3(200*Math.pow(2,o-1)),this._debug(t,"refreshing attempt",o),await on(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:XA})),(o,s)=>{const i=200*Math.pow(2,o);return s&&yv(s)&&Date.now()+i-r<ou})}catch(r){if(this._debug(t,"error",r),$r(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Ea()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await qh(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const o=Math.round(Date.now()/1e3),s=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<o+pw;if(this._debug(t,`session has${s?"":" not"} expired with margin of ${pw}s`),s){if(this.autoRefreshToken&&r.refresh_token){const{error:i}=await this._callRefreshToken(r.refresh_token);i&&(console.error(i),yv(i)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",i),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new WA;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new cg;const{data:s,error:i}=await this._refreshAccessToken(e);if(i)throw i;if(!s.session)throw new WA;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={session:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(o,"error",s),$r(s)){const i={session:null,error:s};return yv(s)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(i),i}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(e,t,r=!0){const o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(e,t)}catch(A){s.push(A)}});if(await Promise.all(i),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(o,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await r5(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Kh(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ea()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ou);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-e)/ou);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${ou}ms, refresh threshold is ${bw} ticks`),o<=bw&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof o5)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ea()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const o=[`provider=${encodeURIComponent(t)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[s,i]=await Ld(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});o.push(a.toString())}if(r!=null&&r.queryParams){const s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;return s?{data:null,error:s}:await on(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if($r(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,o;const{data:s,error:i}=t;if(i)return{data:null,error:i};const a=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:A,error:d}=await on(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return d?{data:null,error:d}:(e.factorType==="totp"&&(!((o=A==null?void 0:A.totp)===null||o===void 0)&&o.qr_code)&&(A.totp.qr_code=`data:image/svg+xml;utf-8,${A.totp.qr_code}`),{data:A,error:null})})}catch(t){if($r(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;if(s)return{data:null,error:s};const{data:i,error:a}=await on(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})})}catch(t){if($r(t))return{data:null,error:t};throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:o,error:s}=t;return s?{data:null,error:s}:await on(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if($r(t))return{data:null,error:t};throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],o=r.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=r.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:r,totp:o,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;const{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(o.access_token);let a=null;i.aal&&(a=i.aal);let A=a;((r=(t=o.user.factors)===null||t===void 0?void 0:t.filter(u=>u.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(A="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:A,currentAuthenticationMethods:c},error:null}}))}}$u.nextInstanceID=0;const rE=$u;class nE extends rE{constructor(e){super(e)}}var oE=function(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,e||[])).next())})};class sE{constructor(e,t,r){var o,s,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const a=m3(e);this.realtimeUrl=`${a}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,this.functionsUrl=`${a}/functions/v1`;const A=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,d={db:d3,realtime:u3,auth:Object.assign(Object.assign({},c3),{storageKey:A}),global:l3},c=w3(r??{},d);this.storageKey=(o=c.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(s=c.global.headers)!==null&&s!==void 0?s:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=c.auth)!==null&&i!==void 0?i:{},this.headers,c.global.fetch),this.fetch=g3(t,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new US(`${a}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new vS(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new i3(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return oE(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,storageKey:s,flowType:i,lock:a,debug:A},d,c){const u={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nE({url:this.authUrl,headers:Object.assign(Object.assign({},u),d),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:o,flowType:i,lock:a,debug:A,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new $S(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const iE=(n,e,t)=>new sE(n,e,t),aE="https://mprzyonufqescpcpusno.supabase.co",AE="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1wcnp5b251ZnFlc2NwY3B1c25vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mjk3NjAwMzIsImV4cCI6MjA0NTMzNjAzMn0._EwKZZ9Yk-C6t96up66bvHDv_pLcE5HDD1TNpi2dWy4",ft=iE(aE,AE);async function uh(n,e){const{data:t,error:r}=await ft.from("products").select(`
            *,
            variants:product_variants(
                *,
                prices(*),
                option_values:product_variant_option_values(
                    option_value:product_option_values(
                        *,
                        option:product_options(*)
                    )
                )
            ),
            categories:categories(*),
            options:product_options(
                *,
                values:product_option_values(*)
            ),
            process:processes(*)
        `).eq("id",n).eq("shop",e).single();if(r)throw r;return t}async function hl(n){const{data:e,error:t}=await ft.from("product_variants").select(" *, prices(*)").eq("id",n).single();if(t)throw t;return e}async function s5(){const{data:n,error:e}=await ft.from("categories").select("*").order("name");if(e)throw e;const t=n||[],r=new Map,o=[];return t.forEach(s=>{r.set(s.id,{...s,children:[]})}),t.forEach(s=>{const i=r.get(s.id);if(i)if(s.parent_category_id){const a=r.get(s.parent_category_id);a&&(a.children=a.children||[],a.children.push(i))}else o.push(i)}),o}async function Xf(n,e,t=1,r=12,o,s=!1){const i=(t-1)*r,a=i+r-1;let A=ft.from("products").select(`
      *,
      variants:product_variants(
        *,
        prices(*)
      )
    `,{count:"exact"}).ilike("title",`%${n}%`).range(i,a).order("created_at",{ascending:!1});if(o==="godo"&&(A=A.not("godo_product","is",null)),s&&(A=A.not("process_id","is",null)),e){const{data:h}=await ft.from("product_categories").select("product_id").eq("category_id",e),p=(h==null?void 0:h.map(v=>v.product_id))||[];A=A.in("id",p)}const{data:d,error:c,count:u}=await A;if(c)throw c;return{products:d||[],total:u||0}}async function Yf(n,e){if(!n||!e)return console.warn("getProductByMallInfo: mallType or mallProductNo is missing."),null;const{data:t,error:r}=await ft.from("products").select("*").eq("mall_type",n).eq("mall_product_id",e).maybeSingle();if(r)throw console.error("Error fetching product by mall info:",r),r;return t||console.log("Product not found for given mall info."),t}async function hh(n){const{data:e,error:t}=await ft.from("product_addons").select("*").eq("product_id",n).order("created_at",{ascending:!0});if(t)throw console.error("Error fetching product addons:",t),t;if(!e||e.length===0)return[];const r=[];for(const o of e){const{data:s,error:i}=await ft.from("product_addon_items").select(`
        *,
        addon_product:products(
          *,
          variants:product_variants(
            *,
            prices(*)
          )
        )
      `).eq("addon_id",o.id);if(i){console.error("Error fetching addon items:",i);continue}r.push({...o,items:s||[]})}return r}const lE=Object.freeze(Object.defineProperty({__proto__:null,getCategories:s5,getProductAddons:hh,getProductById:uh,getProductByMallInfo:Yf,getProductVariant:hl,searchProducts:Xf},Symbol.toStringTag,{value:"Module"}));function ia(n,e,t){if(!t||t.length===0)return{originalPrice:e,discountedPrice:e,discountAmount:0,hasDiscount:!1};const r=t.find(i=>n>=i.min_quantity&&n<=i.max_quantity);if(!r)return{originalPrice:e,discountedPrice:e,discountAmount:0,hasDiscount:!1};let o=e,s=0;if(r.type==="amount")r.direction==="minus"?(o=Math.max(0,e-r.value),s=e-o):(o=e+r.value,s=-r.value);else if(r.type==="percentage"){const i=r.value/100;r.direction==="minus"?(s=e*i,o=e-s):(s=-(e*i),o=e+Math.abs(s))}return{originalPrice:e,discountedPrice:o,discountAmount:s,discountInfo:r,hasDiscount:s!==0}}const dE={productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1};function cE(){const{subscribe:n,set:e,update:t}=ld(dE);return{subscribe:n,set:e,update:t,async loadIntegratedProductData(r,o){var i;const s=Er({subscribe:n});if((i=s.productDataCache[r])!=null&&i.isLoaded)return s.productDataCache[r];if(s.loadingProducts.has(r))return new Promise((a,A)=>{const d=setInterval(()=>{var u;const c=Er({subscribe:n});c.loadingProducts.has(r)||(clearInterval(d),(u=c.productDataCache[r])!=null&&u.isLoaded?a(c.productDataCache[r]):A(new Error("   ")))},100)});t(a=>({...a,loadingProducts:new Set([...a.loadingProducts,r]),isGlobalLoading:!0,productDataCache:{...a.productDataCache,[r]:{id:r,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!0}}}));try{const[a,A]=await Promise.all([uh(r,o),hh(r)]);if(!a)throw new Error("   ");const d={};A.forEach(u=>{u.items.forEach(h=>{h.addon_product.variants&&h.addon_product.variants.length>0&&(d[h.addon_product.id]={price:h.addon_product.variants[0].prices[0].amount,title:h.addon_product.title,variants:h.addon_product.variants,description:h.addon_product.description,thumbnail:h.addon_product.thumbnail})})});const c={id:r,product:a,addons:A,process:a.process,addonProductsMap:d,isLoaded:!0,isLoading:!1};return t(u=>{const h=new Set(u.loadingProducts);return h.delete(r),{...u,loadingProducts:h,isGlobalLoading:h.size>0,productDataCache:{...u.productDataCache,[r]:c}}}),c}catch(a){throw console.error("   :",a),t(A=>{const d=new Set(A.loadingProducts);return d.delete(r),{...A,loadingProducts:d,isGlobalLoading:d.size>0,productDataCache:{...A.productDataCache,[r]:{id:r,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!1,error:a instanceof Error?a.message:"   "}}}}),a}},async loadMultipleProductData(r,o){t(s=>({...s,isGlobalLoading:!0}));try{const s=r.map(a=>this.loadIntegratedProductData(a,o)),i=await Promise.all(s);return t(a=>({...a,isGlobalLoading:!1})),i}catch(s){throw t(i=>({...i,isGlobalLoading:!1})),s}},getProductData(r){return Er({subscribe:n}).productDataCache[r]||null},clearProductData(r){t(r?o=>{const s={...o.productDataCache};return delete s[r],{...o,productDataCache:s}}:o=>({...o,productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1}))},isProductLoading(r){return Er({subscribe:n}).loadingProducts.has(r)},isGlobalLoading(){return Er({subscribe:n}).isGlobalLoading},isCached(r){var s;return((s=Er({subscribe:n}).productDataCache[r])==null?void 0:s.isLoaded)===!0}}}const Zd=cE(),ni=ld(null);function uE(){const n={},e={products:[],index:0,totalAmount:0,totalQuantity:0,totalProductAmount:0,totalPrintAmount:0,totalAddonAmount:0,totalAdditionalAmount:0,estimateName:"",organizationName:"",orderName:"",orderPhone:"",phone1:"010",phone2:"",phone3:"",postcode:"",address1:"",address2:"",prefDeliveryDate:"",estDeliveryDate:"",shippingMethod:"",comment:"",password:"",uploadMemo:"",discountAmount:0,originalAmount:0,finalAmount:0,discountDetails:null},{subscribe:t,set:r,update:o}=ld(e),s=i=>{const a=i.products.map(h=>{var re;let p=0,v={originalAmount:0,discountAmount:0,hasDiscount:!1,discountDetails:void 0};const w=(h.variants||[]).reduce((be,L)=>be+(L.quantity||0),0),y=(h.variants||[]).map(be=>{const L=be.quantity||0,R=be.prices[0].amount;if(L>0){if(be.isDiscountedPrice)return{originalAmount:R*L,discountedAmount:R*L,discountAmount:0,discountDetails:void 0,hasDiscount:!1};const J=ia(w,R,h.product.quantity_discounts);return{originalAmount:R*L,discountedAmount:J.discountedPrice*L,discountAmount:J.discountAmount*L,discountDetails:J.discountInfo,hasDiscount:J.hasDiscount}}else return{originalAmount:R*L,discountedAmount:R*L,discountAmount:0,discountDetails:void 0,hasDiscount:!1}});p=y.reduce((be,L)=>be+L.discountedAmount,0);const B=y.some(be=>be.hasDiscount),C=(re=y.find(be=>be.hasDiscount))==null?void 0:re.discountDetails;v={originalAmount:y.reduce((be,L)=>be+L.originalAmount,0),discountAmount:y.reduce((be,L)=>be+L.discountAmount,0),hasDiscount:B,discountDetails:C};let Q=0;const k=h.prints&&h.prints.length>0,H=h.simplePrints&&h.simplePrints.length>0,Z=h.print_type==="simple"&&H||H&&!k;k&&!Z&&(Q=(h.prints||[]).reduce((be,L)=>be+(L.price||0),0));let q=0;if(h.addons&&Object.keys(h.addons).length>0){const be=h.quantity||0;q=Object.values(h.addons).reduce((L,R)=>{if(R.price!==void 0){const J=R.quantity||1;return L+R.price*J}if(h.addonProductsMap){const J=h.addonProductsMap[R.productId];if(J&&R.variantId){const se=J.variants.find(fe=>fe.id===R.variantId);if(se&&se.prices&&se.prices.length>0)return L+se.prices[0].amount*be}}return L},0)}const N=p+Q+q;return{...h,productAmount:p,printAmount:Q,addonAmount:q,totalAmount:N,discountInfo:v}}),A=a.reduce((h,p)=>h+p.quantity,0),d=a.reduce((h,p)=>h+(p.productAmount||0),0),c=a.reduce((h,p)=>h+(p.printAmount||0),0),u=a.reduce((h,p)=>h+(p.addonAmount||0),0);return{products:a,totalQuantity:A,totalProductAmount:d,totalPrintAmount:c,totalAddonAmount:u,totalAmount:d+c+u+(i.totalAdditionalAmount||0)}};return{subscribe:t,set:r,update:o,async addProductWithIntegratedData(i,a){try{const A=await Zd.loadIntegratedProductData(i,a),d={product:A.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:A.addonProductsMap,productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0};o(c=>({...c,products:[...c.products,d],index:c.products.length}))}catch(A){throw console.error("  :",A),A}},async preloadProductsForFixedMode(i,a){try{const d=(await Zd.loadMultipleProductData(i,a)).map(c=>({product:c.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:c.addonProductsMap,productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0}));o(c=>({...c,products:d,index:0}))}catch(A){throw console.error("   :",A),A}},async refreshProductData(i,a){const d=Er({subscribe:t}).products[i];if(!d)throw new Error("   ");try{Zd.clearProductData(d.product.id);const c=await Zd.loadIntegratedProductData(d.product.id,a);o(u=>({...u,products:u.products.map((h,p)=>p===i?{...h,product:c.product,addonProductsMap:c.addonProductsMap,isLoaded:!0}:h)}))}catch(c){throw console.error("   :",c),c}},reset:()=>{r({products:[],index:0,totalAmount:0,totalQuantity:0,totalProductAmount:0,totalPrintAmount:0,totalAddonAmount:0,totalAdditionalAmount:0,estimateName:"",organizationName:"",orderName:"",orderPhone:"",phone1:"010",phone2:"",phone3:"",postcode:"",address1:"",address2:"",prefDeliveryDate:"",estDeliveryDate:"",shippingMethod:"",comment:"",password:"",uploadMemo:"",discountAmount:0,originalAmount:0,finalAmount:0,discountDetails:null})},calculatePrintPrice:async(i,a=!1)=>{const A=Er(gt),d=A.products[i];if(console.log({product:d}),d.prints&&d.prints.length>0)for(const c of d.prints){console.log({print:c});let u=0,h=0;if(c.colors&&c.template.templateProduct){const p=c.template.templateProduct.template_product_variants.find(v=>v.color_count===c.colors.length);if(console.log({selectedVariant:p}),p){if(n[p.variant_id])u=n[p.variant_id].prices[0].amount;else{const v=await hl(p.variant_id);v&&(n[p.variant_id]=v,u=v.prices[0].amount)}if(c.variant_id=p.variant_id,p.min_quantity<=d.quantity)if(h=u*d.quantity,c.template.templateProduct.product.quantity_discounts&&c.template.templateProduct.product.quantity_discounts.length>0){const v=ia(d.quantity,u,c.template.templateProduct.product.quantity_discounts);v.hasDiscount?(c.price=v.discountedPrice*d.quantity,c.discountInfo={originalPrice:h,discountAmount:h-v.discountedPrice*d.quantity,discountDetails:v.discountInfo,hasDiscount:!0}):(c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1})}else c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1};else c.price=p.plate_price,c.discountInfo={originalPrice:p.plate_price,discountAmount:0,hasDiscount:!1}}}else if(c.template.templateProduct){const p=c.template.templateProduct.template_product_variants[0];if(p){if(n[p.variant_id])u=n[p.variant_id].prices[0].amount;else{const v=await hl(p.variant_id);v&&(n[p.variant_id]=v,u=v.prices[0].amount)}if(c.variant_id=p.variant_id,p.min_quantity<=d.quantity)if(h=u*d.quantity,c.template.templateProduct.product.quantity_discounts&&c.template.templateProduct.product.quantity_discounts.length>0){const v=ia(d.quantity,u,c.template.templateProduct.product.quantity_discounts);v.hasDiscount?(c.price=v.discountedPrice*d.quantity,c.discountInfo={originalPrice:h,discountAmount:h-v.discountedPrice*d.quantity,discountDetails:v.discountInfo,hasDiscount:!0}):(c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1})}else c.price=h,c.discountInfo={originalPrice:h,discountAmount:0,hasDiscount:!1};else c.price=p.plate_price,c.discountInfo={originalPrice:p.plate_price,discountAmount:0,hasDiscount:!1}}}}if(!a){const c=s(A);r({...A,...c,totalAdditionalAmount:A.totalAdditionalAmount})}},updateTotalAmounts:()=>{o(i=>{const a=s(i);return{...i,...a,totalAdditionalAmount:i.totalAdditionalAmount}})},cancelPrint:(i,a,A)=>{o(d=>{const c=d.products[i].prints;c&&(a?d.products[i].prints=c.filter(h=>h.id!==a):A&&(d.products[i].prints=c.filter(h=>h.objectId!==A)));const u=s(d);return{...d,...u,totalAdditionalAmount:d.totalAdditionalAmount}})},updateSimplePrint:(i,a,A)=>{o(d=>{d.products[i].prints||(d.products[i].prints=[]);const c=d.products[i].prints.findIndex(u=>u.objectId===a);return c>=0?d.products[i].prints[c]={...d.products[i].prints[c],...A}:d.products[i].prints.push(A),d})},saveSimplePrintState:(i,a)=>{console.log("Store: saveSimplePrintState ",{productIndex:i,selectedAreasCount:a.length,selectedAreas:a}),o(A=>A.products[i]?(A.products[i].simplePrintState=a,console.log("Store: saveSimplePrintState ",{productIndex:i,savedState:A.products[i].simplePrintState}),A):(console.warn("Store: saveSimplePrintState -   :",i),A))},getSimplePrintState:i=>{var d;const a=Er(gt),A=((d=a.products[i])==null?void 0:d.simplePrintState)||[];return console.log("Store: getSimplePrintState ",{productIndex:i,hasProduct:!!a.products[i],result:A,resultType:typeof A,resultLength:Array.isArray(A)?A.length:"not array"}),A},updateProductPrintType:(i,a)=>{o(A=>{if(A.products[i]){console.log("Store: updateProductPrintType ",{idx:i,printType:a,previousPrintType:A.products[i].print_type}),A.products[i].print_type=a,(a==="simple"||a==="none")&&(A.products[i].prints=[],A.products[i].printAmount=0);const d=s(A);return{...A,totalProductAmount:d.totalProductAmount,totalPrintAmount:d.totalPrintAmount,totalAddonAmount:d.totalAddonAmount,totalAdditionalCostAmount:d.totalAdditionalCostAmount,totalAmount:d.totalAmount}}return A})},updateSimplePrints:(i,a)=>{o(A=>A.products[i]?(console.log("Store: updateSimplePrints ",{idx:i,simplePrintsCount:a.length}),A.products[i].simplePrints=a,A.products[i].simplePrintState=a,{...A}):A)},updateDetailedPrints:(i,a)=>{o(A=>{if(A.products[i]){console.log("Store: updateDetailedPrints ",{idx:i,printsCount:a.length}),A.products[i].prints=a;const d=s(A);return{...A,...d,totalAdditionalAmount:A.totalAdditionalAmount}}return A})},clearSimplePrints:i=>{o(a=>a.products[i]?(console.log("Store: clearSimplePrints ",{idx:i}),a.products[i].simplePrints=[],a.products[i].simplePrintState=[],{...a}):a)},clearDetailedPrints:i=>{o(a=>{if(a.products[i]){console.log("Store: clearDetailedPrints ",{idx:i}),a.products[i].prints=[],a.products[i].printAmount=0;const A=s(a);return{...a,...A,totalAdditionalAmount:a.totalAdditionalAmount}}return a})},updateProductAtIndex:(i,a)=>{o(A=>{if(A.products[i]){console.log("Store: updateProductAtIndex ",{idx:i,dataKeys:Object.keys(a)}),A.products[i]={...A.products[i],...a};const d=s(A);return{...A,...d,totalAdditionalAmount:A.totalAdditionalAmount}}return A})}}}const gt=uE();function hE(){const n={name:"",phone:"",address1:"",address2:"",postcode:""},{subscribe:e,set:t,update:r}=ld(n);return{subscribe:e,set:t,update:r,reset:()=>{console.log(" Customer Store "),t(n)}}}const Gl=hE(),yr=n=>n.toLocaleString("ko-KR");/**
* @license lucide-svelte v0.475.0 - ISC
*
* ISC License
* 
* Copyright (c) for portions of Lucide are held by Cole Bemis 2013-2022 as part of Feather (MIT). All other copyright (c) for Lucide are held by Lucide Contributors 2022.
* 
* Permission to use, copy, modify, and/or distribute this software for any
* purpose with or without fee is hereby granted, provided that the above
* copyright notice and this permission notice appear in all copies.
* 
* THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
* WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
* MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
* ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
* WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
* ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
* OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
* 
*/const fE={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};var pE=lg("<svg><!><!></svg>");function yn(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]),r=An(t,["name","color","size","strokeWidth","absoluteStrokeWidth","iconNode"]);ln(e,!1);let o=ht(e,"name",8,void 0),s=ht(e,"color",8,"currentColor"),i=ht(e,"size",8,24),a=ht(e,"strokeWidth",8,2),A=ht(e,"absoluteStrokeWidth",8,!1),d=ht(e,"iconNode",24,()=>[]);const c=(...w)=>w.filter((y,B,C)=>!!y&&C.indexOf(y)===B).join(" ");fn();var u=pE();let h;var p=g(u);tr(p,1,d,mr,(w,y)=>{let B=()=>l(y)[0],C=()=>l(y)[1];var Q=kt(),k=it(Q);J4(k,B,!0,(H,Z)=>{let q;Ne(()=>q=W2(H,q,{...C()},void 0,H.namespaceURI===ob,H.nodeName.includes("-")))}),U(w,Q)});var v=x(p);hn(v,e,"default",{}),Ne((w,y)=>h=W2(u,h,{...fE,...r,width:i(),height:i(),stroke:s(),"stroke-width":w,class:y},void 0,!0),[()=>A()?Number(a())*24/Number(i()):a(),()=>c("lucide-icon","lucide",o()?`lucide-${o()}`:"",t.class)],at),U(n,u),dn()}function qA(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"asterisk"},()=>t,{iconNode:[["path",{d:"M12 6v12"}],["path",{d:"M17.196 9 6.804 15"}],["path",{d:"m6.804 9 10.392 6"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function L0(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"book-text"},()=>t,{iconNode:[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20"}],["path",{d:"M8 11h8"}],["path",{d:"M8 7h6"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function gE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"bot"},()=>t,{iconNode:[["path",{d:"M12 8V4H8"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2"}],["path",{d:"M2 14h2"}],["path",{d:"M20 14h2"}],["path",{d:"M15 13v2"}],["path",{d:"M9 13v2"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function Bw(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"building-2"},()=>t,{iconNode:[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"}],["path",{d:"M10 6h4"}],["path",{d:"M10 10h4"}],["path",{d:"M10 14h4"}],["path",{d:"M10 18h4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function vE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"chevron-right"},()=>t,{iconNode:[["path",{d:"m9 18 6-6-6-6"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function l1(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"circle-check-big"},()=>t,{iconNode:[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335"}],["path",{d:"m9 11 3 3L22 4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function su(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"circle-check"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m9 12 2 2 4-4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function Vu(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"circle-x"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"m15 9-6 6"}],["path",{d:"m9 9 6 6"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function bp(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"clock"},()=>t,{iconNode:[["circle",{cx:"12",cy:"12",r:"10"}],["polyline",{points:"12 6 12 12 16 14"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function i5(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"eye"},()=>t,{iconNode:[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0"}],["circle",{cx:"12",cy:"12",r:"3"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function ec(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"file-text"},()=>t,{iconNode:[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4"}],["path",{d:"M10 9H8"}],["path",{d:"M16 13H8"}],["path",{d:"M16 17H8"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function mE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"filter"},()=>t,{iconNode:[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function wE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"key"},()=>t,{iconNode:[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4"}],["path",{d:"m21 2-9.6 9.6"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function dc(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"loader-circle"},()=>t,{iconNode:[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function d1(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"lock"},()=>t,{iconNode:[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function yE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"mail"},()=>t,{iconNode:[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function a5(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"message-square"},()=>t,{iconNode:[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function Gu(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"package"},()=>t,{iconNode:[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z"}],["path",{d:"M12 22V12"}],["polyline",{points:"3.29 7 12 12 20.71 7"}],["path",{d:"m7.5 4.27 9 5.15"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function A5(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"pencil"},()=>t,{iconNode:[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function P0(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"phone"},()=>t,{iconNode:[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function Wu(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"plus"},()=>t,{iconNode:[["path",{d:"M5 12h14"}],["path",{d:"M12 5v14"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function _E(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"printer"},()=>t,{iconNode:[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function bE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"refresh-cw"},()=>t,{iconNode:[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}],["path",{d:"M21 3v5h-5"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}],["path",{d:"M8 16H3v5"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function zw(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"rotate-ccw"},()=>t,{iconNode:[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"}],["path",{d:"M3 3v5h5"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function xE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"save"},()=>t,{iconNode:[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function xp(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"search"},()=>t,{iconNode:[["circle",{cx:"11",cy:"11",r:"8"}],["path",{d:"m21 21-4.3-4.3"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function BE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"send"},()=>t,{iconNode:[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z"}],["path",{d:"m21.854 2.147-10.94 10.939"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function k0(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"shopping-bag"},()=>t,{iconNode:[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"}],["path",{d:"M3 6h18"}],["path",{d:"M16 10a4 4 0 0 1-8 0"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function zE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"shopping-cart"},()=>t,{iconNode:[["circle",{cx:"8",cy:"21",r:"1"}],["circle",{cx:"19",cy:"21",r:"1"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function c1(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"trash-2"},()=>t,{iconNode:[["path",{d:"M3 6h18"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function CE(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"user-cog"},()=>t,{iconNode:[["circle",{cx:"18",cy:"15",r:"3"}],["circle",{cx:"9",cy:"7",r:"4"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2"}],["path",{d:"m21.7 16.4-.9-.3"}],["path",{d:"m15.2 13.9-.9-.3"}],["path",{d:"m16.6 18.7.3-.9"}],["path",{d:"m19.1 12.2.3-.9"}],["path",{d:"m19.6 18.7-.4-1"}],["path",{d:"m16.8 12.3-.4-1"}],["path",{d:"m14.3 16.6 1-.4"}],["path",{d:"m20.7 13.8 1-.4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function Wl(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"user"},()=>t,{iconNode:[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"}],["circle",{cx:"12",cy:"7",r:"4"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}function xA(n,e){const t=An(e,["children","$$slots","$$events","$$legacy"]);yn(n,wn({name:"x"},()=>t,{iconNode:[["path",{d:"M18 6 6 18"}],["path",{d:"m6 6 12 12"}]],children:(o,s)=>{var i=kt(),a=it(i);hn(a,e,"default",{}),U(o,i)},$$slots:{default:!0}}))}async function SE(n,e,t,r,o){let s=ft.from("estimates").select("*").eq("is_delete",!1).neq("status","temp").order("created_at",{ascending:!1});t&&(s=s.eq("shop_id",t)),e?s=s.eq("customer_id",e):n&&(s=s.eq("sess",n)),r&&(s=s.gte("created_at",`${r}T00:00:00`)),o&&(s=s.lte("created_at",`${o}T23:59:59`));const{data:i,error:a}=await s;if(a)throw a;return i||[]}async function u1(n,e,t){if(n&&e){const{data:r,error:o}=await ft.from("estimates").select("*").eq("status","temp").eq("mall_type",n).eq("customer_id",e).eq("is_delete",!1).order("created_at",{ascending:!1}).limit(1);if(o)throw o;if(r&&r.length>0)return r[0]}if(t){const{data:r,error:o}=await ft.from("estimates").select("*").eq("status","temp").eq("sess",t).eq("is_delete",!1).order("created_at",{ascending:!1}).limit(1);if(o)throw o;if(r&&r.length>0)return r[0]}return null}async function rd(n){const{data:e,error:t}=await ft.from("estimates").select("*").eq("id",n).eq("is_delete",!1).single();if(t)throw t;return e}function nd(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),i=String(Math.floor(Math.random()*999)+1).padStart(3,"0");return`${e}${t}${r}${o}${s}${i}`}async function h1(n){const e={...n,estimate_no:nd(),customer_id:n.customer_id===""?null:n.customer_id,sess:n.sess===""?null:n.sess},{data:t,error:r}=await ft.from("estimates").insert(e).select().single();if(r)throw r;return t}async function xc(n,e){const{data:t,error:r}=await ft.from("estimates").select("estimate_no, customer_id, sess").eq("id",n).single();if(r)throw r;const o={...e};(e.customer_id===""||e.customer_id===void 0)&&((t==null?void 0:t.customer_id)===null?o.customer_id=null:e.customer_id===""&&delete o.customer_id),(e.sess===""||e.sess===void 0)&&(t!=null&&t.sess?delete o.sess:e.sess===""&&(o.sess=null)),t!=null&&t.estimate_no||(o.estimate_no=nd());const{error:s}=await ft.from("estimates").update(o).eq("id",n);if(s)throw s;const{data:i,error:a}=await ft.from("estimates").select("*").eq("id",n).single();if(a)throw a;if(!i)throw new Error("   .");return i}async function Xu(n){const{data:e,error:t}=await ft.from("estimate_items").select(`
      *,
      product:products(*),
      variant:product_variants(id, title, thumbnail)
    `).eq("estimate_id",n);if(t)throw t;return(e||[]).map(r=>{var o;return{...r,variant_title:((o=r.variant)==null?void 0:o.title)||null}})}async function f1(n){const{data:e,error:t}=await ft.from("estimate_items").insert(n).select().single();if(t)throw t;return e}async function l5(n){const{error:e}=await ft.from("estimate_items").delete().eq("id",n);if(e)throw e}async function Bc(n){const{data:e,error:t}=await ft.from("estimate_prints").select("*").eq("estimate_id",n);if(t)throw t;return e||[]}async function p1(n){const{data:e,error:t}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n);if(t)throw t;return e||[]}async function g1(n){const{data:e,error:t}=await ft.from("estimate_prints").insert(n).select().single();if(t)throw t;return e}async function d5(n){const{error:e}=await ft.from("estimate_prints").delete().eq("id",n);if(e)throw e}async function O0(n){const{data:e,error:t}=await ft.from("estimate_simple_prints").insert(n).select().single();if(t)throw t;return e}async function c5(n,e){const{data:t,error:r}=await ft.from("estimates").update({status:e}).eq("id",n).select().single();if(r)throw r;return t}function ug(n,e){return ft.channel(`estimate-${n}`).on("postgres_changes",{event:"UPDATE",schema:"public",table:"estimates",filter:`id=eq.${n}`},t=>{e(t.new)}).subscribe()}function D0(n,e,t,r){const o=r?`estimate-list-${e}-${r}`:`estimate-list-${n}-${e}`;let s=`shop_id=eq.${e}`;return r?s=`customer_id=eq.${r}`:n&&(s=`sess=eq.${n}`),ft.channel(o).on("postgres_changes",{event:"*",schema:"public",table:"estimates",filter:s},i=>{t({...i,eventType:i.eventType})}).subscribe()}function cc(n){return n===void 0||n==="temp"||n==="pending"}async function v1(n){try{const e=rd(n),t=Xu(n),r=Bc(n),[o,s,i]=await Promise.all([e,t,r]);return{estimate:o,items:s||[],prints:i||[]}}catch(e){throw e}}async function u5(n){const{data:e,error:t}=await ft.from("estimate_comments").select("*").eq("estimate_id",n).order("created_at",{ascending:!0});if(t)throw t;return e||[]}async function Jf(n){const{data:e,error:t}=await ft.from("estimate_comments").insert(n).select().single();if(t)throw t;return e}function m1(n,e){return ft.channel(`estimate-comments-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_comments",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{})}async function h5(){var n,e;try{const t=document.getElementById("odiz-customer-id"),r=document.getElementById("odiz-sess"),o=(n=t==null?void 0:t.value)==null?void 0:n.trim(),s=(e=r==null?void 0:r.value)==null?void 0:e.trim();if(!o||!s)return 0;const{data:i,error:a}=await ft.from("estimates").select("id").eq("sess",s).is("customer_id",null);if(a)throw a;if(!i||i.length===0)return 0;const{data:A,error:d}=await ft.from("estimates").update({customer_id:o}).eq("sess",s).is("customer_id",null).select();if(d)throw d;return(A==null?void 0:A.length)||0}catch{return 0}}function w1(n,e){return ft.channel(`estimate-prints-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_prints",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{})}function f5(n,e){return ft.channel(`estimate-items-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_items",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateItems  :",r)})}function p5(n,e){return ft.channel(`estimate-simple-prints-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_simple_prints",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateSimplePrints  :",r)})}function g5(n,e){return ft.channel(`estimate-addon-items-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_addon_items",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateAddonItems  :",r)})}function v5(n,e){return ft.channel(`estimate-additional-costs-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"estimate_additional_costs",filter:`estimate_id=eq.${n}`},t=>{e({new:t.new,old:t.old,eventType:t.eventType})}).subscribe((t,r)=>{r&&console.error("EstimateAdditionalCosts  :",r)})}async function m5(n,e,t,r,o){const s=t?t.replace(/[\s\-\(\)\.]/g,""):"";let i=ft.from("estimates").select("*").eq("shop_id",n).or("customer_id.is.null,customer_id.eq.").neq("status","temp").order("created_at",{ascending:!1});r&&!e&&!s?i=i.eq("sess",r):(e&&(i=i.ilike("order_name",`%${e}%`)),s&&(i=i.filter("order_phone","ilike",`%${s}%`))),o&&(i=i.eq("mall_type",o));const{data:a,error:A}=await i;if(A)throw A;return a||[]}async function w5(n){try{const{data:e,error:t}=await ft.from("estimate_items").select(`
        *,
        product:products(*)
      `).eq("estimate_id",n).order("idx");if(t)throw t;const{data:r,error:o}=await ft.from("estimate_prints").select("*").eq("estimate_id",n).order("idx");if(o)throw o;const s={};return(e||[]).forEach(i=>{const a=i.idx||0;s[a]||(s[a]={idx:a,product:i.product,items:[],prints:[]}),s[a].items.push(i)}),(r||[]).forEach(i=>{const a=i.idx||0;s[a]||(s[a]={idx:a,items:[],prints:[]}),s[a].prints.push(i)}),Object.values(s)}catch(e){throw e}}async function hg(n){const{data:e,error:t}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n).order("idx");if(t)throw t;return e||[]}async function y5(n){const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("id",n).single();if(t)throw t;return e||null}async function y1(n){const e={...n,selected_variant_id:n.selected_variant_id&&n.selected_variant_id.trim()!==""?n.selected_variant_id:null},{data:t,error:r}=await ft.from("estimate_addon_items").insert(e).select().single();if(r)throw r;return t}async function _5(n,e){const{error:t}=await ft.from("estimate_addon_items").delete().eq("estimate_id",n).eq("idx",e);if(t)throw t}async function _1(n){const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n).order("created_at",{ascending:!0});if(t)throw t;return e||[]}async function b5(n){try{const{data:e,error:t}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n).order("created_at");if(t)throw t;return(e||[]).map((o,s)=>({id:o.id,product:{name:o.name,title:o.name,mall_type:o.mall_type||null,mall_product_id:o.mall_product_id||null},items:[{estimate_id:n,quantity:1,price:o.amount}],additionalCosts:[o],isAdditionalCost:!0}))}catch(e){throw e}}async function x5(n){const{data:e,error:t}=await ft.from("estimate_items").select("idx").eq("estimate_id",n).order("idx",{ascending:!1}).limit(1).single();return t||!e?-1:e.idx}async function B5(n,e,t,r){try{const o=await u1(e,t,r);let s,i,a=!1,A=0;if(o&&o.id)s=o.id,i=o.estimate_no||nd(),await xc(s,{...n.estimate,estimate_no:i}),A=await x5(s)+1;else{const v={...n.estimate,estimate_no:nd(),status:"temp",customer_id:n.estimate.customer_id===""?null:n.estimate.customer_id,sess:n.estimate.sess===""?null:n.estimate.sess},{data:w,error:y}=await ft.from("estimates").insert(v).select().single();if(y)throw new Error(`  : ${y.message}`);s=w.id,i=w.estimate_no,a=!0}let d=0;if(n.estimate_items&&n.estimate_items.length>0){const v=n.estimate_items.map(B=>({...B,estimate_id:s,idx:A})),{data:w,error:y}=await ft.from("estimate_items").insert(v).select();if(y)throw new Error(`   : ${y.message}`);d=(w==null?void 0:w.length)||0}let c=0;if(n.estimate_simple_prints&&n.estimate_simple_prints.length>0){const v=n.estimate_simple_prints.map(B=>({...B,estimate_id:s,idx:a?B.idx||0:A})),{data:w,error:y}=await ft.from("estimate_simple_prints").insert(v).select();if(y)throw new Error(`   : ${y.message}`);c=(w==null?void 0:w.length)||0}let u=0;if(n.estimate_prints&&n.estimate_prints.length>0){const v=n.estimate_prints.map(B=>({...B,estimate_id:s,idx:a?B.idx||0:A})),{data:w,error:y}=await ft.from("estimate_prints").insert(v).select();if(y)throw new Error(`    : ${y.message}`);if(u=(w==null?void 0:w.length)||0,u>0){const{error:B}=await ft.from("estimate_items").update({print_type:"detailed"}).eq("estimate_id",s).eq("idx",A)}}let h=0;if(n.estimate_addon_items&&n.estimate_addon_items.length>0){const v=n.estimate_addon_items.map(B=>({...B,estimate_id:s,idx:a?B.idx||0:A,selected_variant_id:B.selected_variant_id&&B.selected_variant_id.trim()!==""?B.selected_variant_id:null})),{data:w,error:y}=await ft.from("estimate_addon_items").insert(v).select();if(y)throw new Error(`   : ${y.message}`);h=(w==null?void 0:w.length)||0}const p={success:!0,estimateId:s,details:{estimateCount:a?1:0,itemsCount:d,simplePrintsCount:c,detailedPrintsCount:u,addonItemsCount:h}};return await b1(s),p}catch(o){return{success:!1,error:o instanceof Error?o.message:"    ."}}}async function N0(n,e){try{const{error:t}=await ft.from("estimate_items").delete().eq("estimate_id",n).eq("idx",e);if(t)throw t;const{error:r}=await ft.from("estimate_prints").delete().eq("estimate_id",n).eq("idx",e);if(r)throw r;const{error:o}=await ft.from("estimate_simple_prints").delete().eq("estimate_id",n).eq("idx",e);if(o)throw o;const{error:s}=await ft.from("estimate_addon_items").delete().eq("estimate_id",n).eq("idx",e);if(s)throw s}catch(t){throw t}}async function z5(n,e){try{const{data:t,error:r}=await ft.from("estimate_items").select(`
        *,
        product:products(
          *,
          options:product_options(
            *,
            values:product_option_values(*)
          ),
          variants:product_variants(*)
        )
      `).eq("estimate_id",n).eq("idx",e);if(r)throw r;if(t&&t.length>0)for(const h of t)if(h.variant_id)try{const{data:p,error:v}=await ft.from("product_variants").select("*").eq("id",h.variant_id).single();if(v)h.variant=null;else{h.variant=p;try{const{data:w,error:y}=await ft.from("prices").select("*").eq("variant_id",h.variant_id);y?h.variant.prices=[]:h.variant.prices=w||[]}catch{h.variant.prices=[]}try{const{data:w,error:y}=await ft.from("product_variant_option_values").select("option_value_id").eq("variant_id",h.variant_id);if(y||!w||w.length===0)h.variant.option_values=[];else{const B=w.map(Q=>Q.option_value_id).filter(Boolean),C=[];for(const Q of B)try{const{data:k,error:H}=await ft.from("product_option_values").select("id, value, option_id").eq("id",Q).single();if(H||!k)continue;let Z=null;if(k.option_id){const{data:q,error:N}=await ft.from("product_options").select("*").eq("id",k.option_id).single();!N&&q&&(Z={id:q.id,name:q.title})}C.push({option_value:{id:k.id,value:k.value,option_id:k.option_id,option:Z}})}catch{}h.variant.option_values=C}}catch{h.variant.option_values=[]}}}catch{h.variant=null}else h.variant=null;const{data:o,error:s}=await ft.from("estimate_prints").select("*").eq("estimate_id",n).eq("idx",e);if(s)throw s;if(o&&o.length>0){const{getParentTemplates:h}=await js(async()=>{const{getParentTemplates:p}=await Promise.resolve().then(()=>EE);return{getParentTemplates:p}},void 0);for(const p of o)if(p.template_id)try{const v=await h(p.template_id);p.parentTemplates=v}catch{p.parentTemplates=[]}else p.parentTemplates=[]}const{data:i,error:a}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n).eq("idx",e);if(a)throw a;const{data:A,error:d}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n).eq("idx",e);if(d)throw d;const c=t&&t.length>0?t[0].product_id:null;let u=[];if(c)try{const{getProductAddons:h}=await js(async()=>{const{getProductAddons:p}=await Promise.resolve().then(()=>lE);return{getProductAddons:p}},void 0);u=await h(c)}catch{u=[]}return{items:t||[],prints:o||[],simplePrints:i||[],addonItems:A||[],addons:u||[]}}catch(t){throw t}}function C5(n){const e={};return n.forEach((t,r)=>{if(!t.variant)return;const o=t.variant;let s="";if(o.option_values&&Array.isArray(o.option_values)&&o.option_values.length>0)try{const a=o.option_values.find(A=>{var c;if(!A||!A.option_value)return!1;const d=(c=A.option_value.option)==null?void 0:c.name;return d===""||d===""||d==="color"||d==="Color"});a&&a.option_value&&(s=a.option_value.value||"")}catch{}if(!s&&o.title){const a=o.title.split("/").map(A=>A.trim());a.length>0&&(s=a[0])}s||(s=""),e[s]||(e[s]=[]),e[s].some(a=>a.id===o.id)||e[s].push({id:o.id,title:o.title,thumbnail:o.thumbnail,product_id:o.product_id,prices:t.variant.prices||[],option_values:o.option_values||[]})}),e}function S5(n,e){var y,B,C;if(!n.items||n.items.length===0)throw new Error("estimate_items  ");const t=(y=n.items[0])==null?void 0:y.product_id;if(!t)throw new Error("Product ID   ");let r;r=C5(n.items),Object.keys(r).length;const o={},s={},i=new Set;let a=0;n.items.forEach((Q,k)=>{const H=Q.variant_id,Z=Q.quantity||0;a+=Z;let q="";for(const[N,re]of Object.entries(r))if(re.some(be=>be.id===H)){q=N,i.add(N);break}q&&(o[q]||(o[q]={}),o[q][H]=Z),(Q.discount_amount>0||Q.discount_value>0)&&(s[H]={hasDiscount:!0,discountedPrice:Q.price,discountAmount:Q.discount_amount,discountInfo:{type:Q.discount_type,value:Q.discount_value,direction:Q.discount_direction,min_quantity:Q.discount_min_quantity,max_quantity:Q.discount_max_quantity}})});const A={productId:t,product:(B=n.items[0])==null?void 0:B.product,addons:n.addons||[],addonItems:n.addonItems||[],selectedColors:Array.from(i),quantityByVariant:o,variantsByColor:r,variantDiscounts:s,totalQuantity:a,isCompleted:!0,lastUpdated:Date.now()},d=(n.simplePrints||[]).map(Q=>({objectId:Q.object_id,title:Q.title,printMethod:Q.print_method,uploadedFiles:Q.uploaded_files,savedFileInfo:Q.file_metadata,price:Q.price})),c=n.prints.map((Q,k)=>({template:{id:Q.template_id},template_id:Q.template_id,variant_id:Q.variant_id,colors:Q.colors,uploads:Q.uploads,nameSheet:Q.name_sheet,name_sheet:Q.name_sheet,objectId:Q.object_id,object_id:Q.object_id,price:Q.price,original_price:Q.original_price,discount_amount:Q.discount_amount,discount_type:Q.discount_type,discount_value:Q.discount_value,discount_direction:Q.discount_direction,discount_min_quantity:Q.discount_min_quantity,discount_max_quantity:Q.discount_max_quantity,parentTemplates:Q.parentTemplates||[],discountInfo:{originalPrice:Q.original_price,discountAmount:Q.discount_amount,discountDetails:{type:Q.discount_type,value:Q.discount_value,direction:Q.discount_direction,min_quantity:Q.discount_min_quantity,max_quantity:Q.discount_max_quantity}}})),u={};n.addonItems.forEach(Q=>{u[Q.addon_id]={productId:Q.selected_product_id,variantId:Q.selected_variant_id}});const h={productId:t,selectedAddons:u,isCompleted:!0,lastUpdated:Date.now()};let p="none";const v=(C=n.items[0])==null?void 0:C.print_type;v&&["simple","detailed","self-design","none"].includes(v)?p=v:(p="selection",(d.length>0||c.length>0)&&console.warn("    print_type .    ."));const w={productId:t,currentMethod:p,isCompleted:!0,lastUpdated:Date.now()};return{productId:t,fixedEstimateData:{productId:t,productSelection:A,printSelection:w,addonSelection:h,additionalInfo:null,currentStep:"product",isDebugMode:!0,sessionId:Date.now().toString(36)+Math.random().toString(36).substr(2)},sessionStorageData:{fixedEstimateKey:`fixedEstimate_${t}`,simplePrintKey:`simplePrint_${t}`,detailedPrintKey:`detailedPrint_${t}`,printMethod:p,simplePrintState:d,detailedPrintState:c}}}async function E5(n){const{data:e,error:t}=await ft.from("estimate_items").select("quantity, price, print_type").eq("estimate_id",n);if(t)throw t;let r=0,o=0,s=!1;(e||[]).forEach(v=>{const w=v.quantity||0,y=v.price||0;r+=w*y,o+=w,v.print_type==="detailed"&&(s=!0)});let i=0;if(s){const{data:v,error:w}=await ft.from("estimate_prints").select("price").eq("estimate_id",n);if(w)throw w;i=(v||[]).reduce((y,B)=>y+(B.price||0),0)}const{data:a,error:A}=await ft.from("estimate_addon_items").select("price, quantity").eq("estimate_id",n);if(A)throw A;let d=0;(a||[]).forEach(v=>{const w=v.price||0,y=v.quantity||1;d+=w*y});const{data:c,error:u}=await ft.from("estimate_additional_costs").select("amount").eq("estimate_id",n);if(u)throw u;const h=(c||[]).reduce((v,w)=>v+(w.amount||0),0),p=r+i+d+h;return{product_amount:r,print_amount:i,addon_amount:d,additional_amount:h,total_quantity:o,total_amount:p}}async function b1(n){const e=await E5(n),{error:t}=await ft.from("estimates").update(e).eq("id",n);if(t)throw new Error(`Failed to update estimate summary: ${t.message}`)}async function F5(n,e,t,r,o){try{const s=await rd(n);if(!s)throw new Error("    ");const i=new Date().toISOString(),a=nd(),A={shop_id:s.shop_id||e,name:s.name,organization_name:s.organization_name,order_name:s.order_name,order_phone:s.order_phone,postcode:s.postcode,address1:s.address1,address2:s.address2,comment:s.comment,shipping_method:s.shipping_method,pref_delivery_date:s.pref_delivery_date,upload_memo:s.upload_memo,product_amount:s.product_amount,print_amount:s.print_amount,addon_amount:s.addon_amount,additional_amount:s.additional_amount,total_quantity:s.total_quantity,total_amount:s.total_amount,delivery_fee:s.delivery_fee,memo:s.memo,use_reorder:s.use_reorder,sess:t||null,customer_id:r||null,mall_type:o||s.mall_type,estimate_no:a,status:"temp",design_confirm:"none",source_estimate_id:n,is_delete:!1,created_at:i,updated_at:i},{data:d,error:c}=await ft.from("estimates").insert(A).select().single();if(c)throw new Error(`  : ${c.message}`);const u=d.id;return await U5(n,u),await Q5(n,u),await T5(n,u),await L5(n,u),await P5(n,u),console.log(`[copyEstimateForUser]   : ${n}  ${u}`),{success:!0,newEstimateId:u,newEstimateNo:a}}catch(s){return console.error("[copyEstimateForUser] :",s),{success:!1,newEstimateId:null,newEstimateNo:null,error:s instanceof Error?s.message:"    ."}}}async function I5(n){try{const e=await rd(n);if(!e)throw new Error("    ");const t=new Date().toISOString(),r=nd(),o={shop_id:e.shop_id,customer_id:e.customer_id||null,sess:e.sess||null,mall_type:e.mall_type,name:e.name,organization_name:e.organization_name,order_name:e.order_name,order_phone:e.order_phone,phone:e.phone,email:e.email,postcode:e.postcode,address1:e.address1,address2:e.address2,comment:e.comment,shipping_method:e.shipping_method,pref_delivery_date:e.pref_delivery_date,upload_memo:e.upload_memo,memo:e.memo,use_reorder:e.use_reorder,delivery_fee:e.delivery_fee,product_amount:e.product_amount,print_amount:e.print_amount,addon_amount:e.addon_amount,additional_amount:e.additional_amount,total_quantity:e.total_quantity,total_amount:e.total_amount,estimate_no:r,status:"pending",design_confirm:"none",is_payment:!1,source_estimate_id:n,design_uploads:null,is_delete:!1,created_at:t,updated_at:t},{data:s,error:i}=await ft.from("estimates").insert(o).select().single();if(i)throw new Error(`  : ${i.message}`);const a=s.id;return await U5(n,a),await Q5(n,a),await T5(n,a),await L5(n,a),await P5(n,a),console.log(`[reorderEstimate]    : ${n}  ${a}`),{success:!0,newEstimateId:a,newEstimateNo:r}}catch(e){return console.error("[reorderEstimate] :",e),{success:!1,newEstimateId:null,newEstimateNo:null,error:e instanceof Error?e.message:"    ."}}}async function U5(n,e){const{data:t,error:r}=await ft.from("estimate_items").select("*").eq("estimate_id",n);if(r)throw new Error(`   : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_items").insert(s);if(i)throw new Error(`   : ${i.message}`)}}async function Q5(n,e){const{data:t,error:r}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_simple_prints").insert(s);if(i)throw new Error(`    : ${i.message}`)}}async function T5(n,e){const{data:t,error:r}=await ft.from("estimate_prints").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_prints").insert(s);if(i)throw new Error(`    : ${i.message}`)}}async function L5(n,e){const{data:t,error:r}=await ft.from("estimate_addon_items").select("*").eq("estimate_id",n);if(r)throw new Error(`   : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_addon_items").insert(s);if(i)throw new Error(`   : ${i.message}`)}}async function P5(n,e){const{data:t,error:r}=await ft.from("estimate_additional_costs").select("*").eq("estimate_id",n);if(r)throw new Error(`    : ${r.message}`);if(t&&t.length>0){const o=new Date().toISOString(),s=t.map(a=>{const{id:A,created_at:d,updated_at:c,...u}=a;return{...u,estimate_id:e,created_at:o,updated_at:o}}),{error:i}=await ft.from("estimate_additional_costs").insert(s);if(i)throw new Error(`    : ${i.message}`)}}async function k5(n,e,t){try{const r=new Date().toISOString(),o=nd();let s=null;n.estimateGoods&&n.estimateGoods.length>0&&(s=n.estimateGoods.map(u=>({sno:u.sno,goodsNm:u.goodsNm||"",url:`http://dantee771.godomall.com/estimate/estimate_goods_design.php?estimateGoodsSno=${u.sno}`})));const i=e&&e.trim()!==""?e:null,a=t&&t.trim()!==""?t:null;if(!i)throw new Error("shop_id .");console.log("[reorderFromLegacyEstimate] shopId:",i,"customerId:",a);const A={shop_id:i,customer_id:a,estimate_no:o,name:n.estimateNm||` - ${n.estimateNo}`,organization_name:n.ex1||null,order_name:n.receiverName||n.memNm||null,order_phone:n.receiverCellPhone||null,legacy_estimate_no:String(n.estimateNo),legacy_design_urls:s,status:"pending",design_confirm:"none",is_payment:!1,is_delete:!1,product_amount:0,print_amount:0,addon_amount:0,additional_amount:0,total_quantity:0,total_amount:0,created_at:r,updated_at:r},{data:d,error:c}=await ft.from("estimates").insert(A).select().single();if(c)throw new Error(`  : ${c.message}`);return{success:!0,newEstimateId:d.id,newEstimateNo:o}}catch(r){return console.error("[reorderFromLegacyEstimate] :",r),{success:!1,newEstimateId:null,newEstimateNo:null,error:r instanceof Error?r.message:"    ."}}}function O5(n){return n?!n.sess&&!n.customer_id:!1}const Gh=Object.freeze(Object.defineProperty({__proto__:null,addEstimateAddonItem:y1,addEstimateComment:Jf,addEstimateItem:f1,addEstimatePrint:g1,addEstimateSimplePrint:O0,buildVariantsByColorFromDB:C5,calculateEstimateSummary:E5,canEditEstimate:cc,convertDBDataToSessionStorage:S5,copyEstimateForUser:F5,createEstimate:h1,deleteEstimateAddonItemsByIdx:_5,deleteEstimateItem:l5,deleteEstimatePrint:d5,deleteEstimateProductByIdx:N0,getAdditionalItems:b5,getEstimateAdditionalCost:y5,getEstimateAdditionalCosts:_1,getEstimateAddonItems:hg,getEstimateById:rd,getEstimateComments:u5,getEstimateItems:Xu,getEstimateItemsGroupedByIdx:w5,getEstimatePrints:Bc,getEstimateSimplePrints:p1,getEstimatesWithDateFilter:SE,getFullEstimateDetails:v1,getGuestEstimates:m5,getMaxEstimateItemIdx:x5,getTempEstimate:u1,isAdminCreatedEstimate:O5,loadEstimateItemDataByIdx:z5,migrateSessionEstimatesToCustomer:h5,reorderEstimate:I5,reorderFromLegacyEstimate:k5,saveCompleteEstimateData:B5,subscribeToEstimateAdditionalCostsChanges:v5,subscribeToEstimateAddonItemsChanges:g5,subscribeToEstimateChanges:ug,subscribeToEstimateCommentChanges:m1,subscribeToEstimateItemsChanges:f5,subscribeToEstimateListChanges:D0,subscribeToEstimatePrintChanges:w1,subscribeToEstimateSimplePrintsChanges:p5,updateEstimate:xc,updateEstimateStatus:c5,updateEstimateSummary:b1},Symbol.toStringTag,{value:"Module"}));async function D5(n){const{data:e,error:t}=await ft.from("templates").select("*").eq("id",n).single();if(t)throw t;return e}async function N5(n){const{data:e,error:t}=await ft.from("templates").select("*").eq("parent_id",n).order("sort");if(t)throw t;return e||[]}async function zc(n){const{data:e,error:t}=await ft.from("process_print_areas").select(`
            id,
            title,
            process_print_area_templates!inner (
                id,
                print_area_id,
                template_id,
                group_cd,
                created_at,
                updated_at,
                template:templates (*)
            )
        `).eq("object_id",n).single();if(t)throw t;return e!=null&&e.process_print_area_templates&&e.process_print_area_templates.sort((r,o)=>{var a,A;const s=((a=r.template)==null?void 0:a.sort)??Number.MAX_SAFE_INTEGER,i=((A=o.template)==null?void 0:A.sort)??Number.MAX_SAFE_INTEGER;return s-i}),e}async function ud(n){const e=[],{data:t,error:r}=await ft.from("templates").select(" * ").eq("id",n).single();if(r)return console.error("   :",r),e;if(!t)return e;e.push(t);let o=t.parent_id;for(;o;){const{data:s,error:i}=await ft.from("templates").select(" * ").eq("id",o).single();if(i){console.error("   :",i);break}if(!s)break;e.push(s),o=s.parent_id}return e.reverse()}async function Lc(n){const{data:e,error:t}=await ft.from("template_products").select(`
            *,
            product:products (*),
            template_product_variants (
                id,
                variant_id,
                color_count,
                min_quantity,
                plate_price
            )
        `).eq("template_id",n).single();if(t)throw t;return e}async function fg(n){const{data:e,error:t}=await ft.from("process_print_areas").select("*").eq("object_id",n).single();return t?(console.error("  :",t),null):e}const EE=Object.freeze(Object.defineProperty({__proto__:null,getChildTemplates:N5,getParentTemplates:ud,getPrintAreaByObjectId:fg,getTemplate:D5,getTemplateProduct:Lc,getTemplatesByObjectId:zc},Symbol.toStringTag,{value:"Module"})),kd={productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1,currentSessionId:`session-${Date.now()}-${Math.random().toString(36).substring(2)}`,sessionStorageKey:"extended-product-data-cache"};function FE(){const{subscribe:n,set:e,update:t}=ld(kd),r={save(o,s){if(!(typeof window>"u"))try{const i=`${kd.sessionStorageKey}-${o}`,a={...s,lastSavedToSession:Date.now()};window.sessionStorage.setItem(i,JSON.stringify(a))}catch(i){console.warn("   :",i)}},restore(o){if(typeof window>"u")return null;try{const s=`${kd.sessionStorageKey}-${o}`,i=window.sessionStorage.getItem(s);if(i)return JSON.parse(i)}catch(s){console.warn("   :",s)}return null},clear(o){if(!(typeof window>"u"))if(o){const s=`${kd.sessionStorageKey}-${o}`;window.sessionStorage.removeItem(s)}else Object.keys(window.sessionStorage).forEach(s=>{s.startsWith(kd.sessionStorageKey)&&window.sessionStorage.removeItem(s)})}};return{subscribe:n,set:e,update:t,async loadIntegratedProductData(o,s){var d;const i={subscribe:n},a=Er(i),A=r.restore(o);if((d=a.productDataCache[o])!=null&&d.isLoaded||A!=null&&A.isLoaded){const c=A||a.productDataCache[o];return A&&t(u=>({...u,productDataCache:{...u.productDataCache,[o]:c}})),c}if(a.loadingProducts.has(o))return new Promise((c,u)=>{const h=setInterval(()=>{var v;const p=Er(i);p.loadingProducts.has(o)||(clearInterval(h),(v=p.productDataCache[o])!=null&&v.isLoaded?c(p.productDataCache[o]):u(new Error("   ")))},100)});t(c=>({...c,loadingProducts:new Set([...c.loadingProducts,o]),isGlobalLoading:!0,productDataCache:{...c.productDataCache,[o]:{id:o,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!0,sessionId:c.currentSessionId}}}));try{const[c,u]=await Promise.all([uh(o,s),hh(o)]);if(!c)throw new Error("   ");const h={};u.forEach(v=>{v.items.forEach(w=>{w.addon_product.variants&&w.addon_product.variants.length>0&&(h[w.addon_product.id]={price:w.addon_product.variants[0].prices[0].amount,title:w.addon_product.title,variants:w.addon_product.variants,description:w.addon_product.description,thumbnail:w.addon_product.thumbnail})})});const p={id:o,product:c,addons:u,process:c.process,addonProductsMap:h,productSelection:A==null?void 0:A.productSelection,printSelection:A==null?void 0:A.printSelection,addonSelection:A==null?void 0:A.addonSelection,isLoaded:!0,isLoading:!1,sessionId:a.currentSessionId};return t(v=>{const w=new Set(v.loadingProducts);return w.delete(o),{...v,loadingProducts:w,isGlobalLoading:w.size>0,productDataCache:{...v.productDataCache,[o]:p}}}),r.save(o,p),p}catch(c){throw console.error("   :",c),t(u=>{const h=new Set(u.loadingProducts);return h.delete(o),{...u,loadingProducts:h,isGlobalLoading:h.size>0,productDataCache:{...u.productDataCache,[o]:{id:o,product:{},addons:[],addonProductsMap:{},isLoaded:!1,isLoading:!1,error:c instanceof Error?c.message:"   ",sessionId:u.currentSessionId}}}}),c}},updateProductSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,selectedColors:[],quantityByVariant:{},variantsByColor:{},totalQuantity:0,isCompleted:!1,...a.productSelection,...s,lastUpdated:A},c={...a,productSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},updatePrintSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,currentMethod:"selection",isCompleted:!1,...a.printSelection,...s,lastUpdated:A},c={...a,printSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},selectPrintMethod(o,s){this.updatePrintSelection(o,{currentMethod:s,lastUpdated:Date.now()})},completePrintSelection(o){this.updatePrintSelection(o,{isCompleted:!0,lastUpdated:Date.now()})},updateAddonSelection(o,s){t(i=>{const a=i.productDataCache[o];if(!a)return i;const A=Date.now(),d={productId:o,selectedAddons:{},isCompleted:!1,...a.addonSelection,...s,lastUpdated:A},c={...a,addonSelection:d};return r.save(o,c),{...i,productDataCache:{...i.productDataCache,[o]:c}}})},getProductData(o){return Er({subscribe:n}).productDataCache[o]||null},restoreFromSession(o){const s=r.restore(o);return s&&t(i=>({...i,productDataCache:{...i.productDataCache,[o]:s}})),s},saveToSession(o){const a=Er({subscribe:n}).productDataCache[o];a&&r.save(o,a)},clearProductData(o){o?(r.clear(o),t(s=>{const i={...s.productDataCache};return delete i[o],{...s,productDataCache:i}})):(r.clear(),t(s=>({...s,productDataCache:{},loadingProducts:new Set,isGlobalLoading:!1})))},updateProduct(o,s){t(i=>{const A={...i.productDataCache[o]||{id:o,product:s.product,addons:s.addons,addonProductsMap:{},isLoaded:!0,isLoading:!1,sessionId:i.currentSessionId},product:s.product,addons:s.addons,isLoaded:!0,isLoading:!1};return r.save(o,A),{...i,productDataCache:{...i.productDataCache,[o]:A}}})},hasProductSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.productSelection)!=null&&i.isCompleted)},hasPrintSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.printSelection)!=null&&i.isCompleted)},hasAddonSelection(o){var i;const s=this.getProductData(o);return!!((i=s==null?void 0:s.addonSelection)!=null&&i.isCompleted)},reset(){console.log(" Extended Product Data Store  "),r.clear(),e(kd),console.log(" Extended Product Data Store  ")}}}const Xn=FE();function IE(){if(typeof window>"u")return;const n=[];for(let e=0;e<window.sessionStorage.length;e++){const t=window.sessionStorage.key(e);if(!t)continue;(t.startsWith("fixedEstimate_")||t.startsWith("detailedPrint_")||t.startsWith("simplePrint_")||t.startsWith("extended-product-data-cache-"))&&n.push(t)}n.forEach(e=>window.sessionStorage.removeItem(e)),console.log(` Edit mode: Cleared ${n.length} sessionStorage keys`,n)}var UE=$('<div class="odz-gap-2 odz-mt-3 odz-flex odz-flex-col"><button class="odz-btn odz-btn-sm odz-btn-secondary"></button> <button class="odz-btn odz-btn-sm odz-btn-primary"></button></div>'),QE=$('<img class="odz-w-8 odz-h-8 odz-object-cover odz-rounded">'),TE=$('<div class="odz-flex odz-items-center odz-gap-2 odz-border odz-rounded-lg odz-p-2"><!> <div class="odz-text-xs"><span> </span> <span class="odz-ml-2 odz-font-semibold"> </span></div></div>'),LE=$('<span class="odz-bg-gray-800 odz-text-white odz-text-xs odz-font-bold odz-px-2 odz-py-0.5 odz-rounded odz-whitespace-nowrap"> </span>'),PE=$('<span class="odz-text-xs odz-font-bold odz-text-rose-500"> </span>'),kE=$('<span class="odz-text-xs odz-font-bold odz-text-gray-600"> </span>'),OE=$('<span class="odz-text-xs odz-text-gray-400"></span> <span class="odz-text-xs odz-font-semibold odz-text-gray-700"> </span>',1),DE=$('<a target="_blank" rel="noopener noreferrer" class="odz-inline-flex odz-items-center odz-gap-0.5 odz-text-xs odz-text-blue-500 hover:odz-text-blue-700 odz-bg-blue-50 odz-px-1.5 odz-py-0.5 odz-rounded"><svg xmlns="http://www.w3.org/2000/svg" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48"></path></svg> </a>'),NE=$('<div class="odz-flex odz-items-center odz-gap-1 odz-ml-auto"></div>'),ME=$('<div class="odz-text-xs odz-text-gray-500 odz-mt-1 odz-pl-0.5"> </div>'),HE=$('<div class="odz-border odz-border-gray-200 odz-rounded-lg odz-px-3 odz-py-2 odz-bg-gray-50"><div class="odz-flex odz-items-center odz-gap-2"><!> <!> <!> <!></div> <!></div>'),jE=$('<div class="odz-mt-3 odz-flex odz-flex-col odz-gap-1.5"></div>'),RE=$('<span class="odz-text-gray-600"> </span> <span class="odz-text-primary odz-font-semibold odz-ml-auto"> </span>',1),qE=$('<div class="odz-flex odz-items-center odz-gap-2 odz-text-xs odz-bg-gray-50 odz-p-2 odz-rounded odz-mb-1"><span class="odz-font-medium"> </span> <!></div>'),KE=$('<div class="odz-mt-3"><div class="odz-text-sm odz-font-bold odz-text-gray-600 odz-mb-2"> </div> <!></div>'),$E=$('<span class="odz-text-sm odz-font-bold odz-text-gray-500"></span>'),VE=$('<span class="odz-text-sm odz-font-bold"> </span>'),GE=$('<div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <span class="odz-text-sm odz-font-bold"> </span></div>'),WE=$('<div class="odz-flex odz-flex-col odz-gap-1"><div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <span class="odz-text-sm odz-font-bold"> </span></div> <div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-600"> </span> <!></div> <!></div> <div class="odz-flex odz-flex-col odz-items-end"><span class="odz-font-bold"> </span> <span class="odz-font-bold odz-text-lg"> </span></div>',1),XE=$('<div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border"><div class="odz-card-body odz-p-3"><div class="odz-flex odz-gap-4"><div class="odz-flex odz-flex-col odz-justify-between"><img class="odz-w-24 odz-h-24 odz-object-cover odz-rounded"> <!></div> <div class="odz-flex-1"><h2 class="odz-text-lg odz-font-bold"> </h2> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mt-3"></div> <!> <!> <div class="odz-flex odz-justify-between odz-items-center odz-mt-4 odz-pt-3 odz-border-t"></div></div></div></div></div>'),YE=$('<div class="odz-text-center odz-py-8 odz-text-gray-500">  .</div>'),JE=$('<div class="odz-fixed odz-inset-0 odz-z-50 odz-flex odz-items-center odz-justify-center odz-bg-black odz-bg-opacity-50"><div class="odz-bg-white odz-rounded-lg odz-shadow-xl odz-max-w-md odz-w-full odz-mx-4"><div class="odz-px-6 odz-py-4 odz-border-b odz-border-gray-200"><h3 class="odz-text-lg odz-font-semibold odz-text-gray-900">  </h3></div> <div class="odz-px-6 odz-py-4"><p class="odz-text-sm odz-text-gray-600"><span class="odz-font-medium odz-text-gray-900"> </span>() ?</p> <p class="odz-text-xs odz-text-gray-500 odz-mt-2">    .</p></div> <div class="odz-px-6 odz-py-4 odz-border-t odz-border-gray-200 odz-flex odz-gap-3 odz-justify-end"><button class="odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-text-gray-700 odz-bg-white odz-border odz-border-gray-300 odz-rounded-lg hover:odz-bg-gray-50 odz-transition-colors"></button> <button class="odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-text-white odz-bg-red-500 odz-rounded-lg hover:odz-bg-red-600 odz-transition-colors"></button></div></div></div>'),ZE=$('<div class="odz-flex odz-flex-col odz-gap-4"><!></div> <!>',1);function M5(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t);let s=ht(e,"onSelectProduct",8),i=ht(e,"onDeleteProduct",8,void 0),a=ht(e,"isEditable",8,!1),A=Be(!1),d=null,c=Be(""),u=Be({});function h(q){return q.title?q.title:!q.option_values||!Array.isArray(q.option_values)?q.id||"":q.option_values.map(N=>{var re;return((re=N.option_value)==null?void 0:re.value)||""}).join(" / ")}function p(q){var N,re;d=q,_(c,((re=(N=o().products[q])==null?void 0:N.product)==null?void 0:re.title)||" "),_(A,!0)}async function v(){if(d===null)return;const q=d;_(A,!1),d=null,_(c,""),i()?await i()(q):er(gt,dt(o).products=o().products.filter((N,re)=>re!==q),dt(o))}function w(){_(A,!1),d=null,_(c,"")}Yt(()=>(o(),l(u),zc),()=>{const q=o().products;q&&q.forEach(N=>{N.prints&&N.prints.forEach(async re=>{if(re.objectId&&!l(u)[re.objectId])try{const be=await zc(re.objectId);_(u,{...l(u),[re.objectId]:(be==null?void 0:be.title)||re.objectId})}catch{_(u,{...l(u),[re.objectId]:re.objectId})}})})}),mo(),fn();var y=ZE(),B=it(y),C=g(B);{var Q=q=>{var N=kt(),re=it(N);tr(re,1,()=>o().products,mr,(be,L,R)=>{var J=XE(),se=g(J),fe=g(se),ie=g(fe),pe=g(ie),te=x(pe,2);{var Ce=K=>{var M=UE(),ge=g(M),_e=x(ge,2);At("click",ge,()=>s()(R)),At("click",_e,()=>p(R)),U(K,M)};ve(te,K=>{a()&&K(Ce)})}var ne=x(ie,2),ze=g(ne),z=g(ze),E=x(ze,2);tr(E,5,()=>l(L).variants,mr,(K,M)=>{var ge=TE(),_e=g(ge);{var Me=ue=>{var me=QE();Ne(ye=>{cr(me,"src",l(M).thumbnail),cr(me,"alt",ye)},[()=>h(l(M))],at),U(ue,me)};ve(_e,ue=>{l(M).thumbnail&&ue(Me)})}var $e=x(_e,2),Y=g($e),j=g(Y),ee=x(Y,2),ae=g(ee);Ne(ue=>{Se(j,ue),Se(ae,`${l(M).quantity??""}`)},[()=>h(l(M))],at),U(K,ge)});var F=x(E,2);{var I=K=>{var M=jE();tr(M,5,()=>l(L).prints,mr,(ge,_e)=>{var Me=HE(),$e=g(Me),Y=g($e);{var j=Oe=>{var Te=LE(),De=g(Te);Ne(()=>Se(De,l(u)[l(_e).objectId]||l(_e).objectId)),U(Oe,Te)};ve(Y,Oe=>{l(_e).objectId&&Oe(j)})}var ee=x(Y,2);{var ae=Oe=>{var Te=PE(),De=g(Te);Ne(()=>Se(De,l(_e).parentTemplates[0].name)),U(Oe,Te)},ue=Oe=>{var Te=kE(),De=g(Te);Ne(()=>Se(De,l(_e).title||"")),U(Oe,Te)};ve(ee,Oe=>{l(_e).parentTemplates&&l(_e).parentTemplates.length>0?Oe(ae):Oe(ue,!1)})}var me=x(ee,2);{var ye=Oe=>{var Te=OE(),De=x(it(Te),2),ce=g(De);Ne(()=>Se(ce,`${l(_e).colors.length??""}`)),U(Oe,Te)};ve(me,Oe=>{l(_e).colors&&l(_e).colors.length>0&&Oe(ye)})}var Ee=x(me,2);{var de=Oe=>{var Te=NE();tr(Te,5,()=>l(_e).uploads.files,mr,(De,ce)=>{var Ie=DE(),V=x(g(Ie));Ne(()=>{cr(Ie,"href",l(ce).url),cr(Ie,"title",l(ce).name||""),Se(V,` ${l(ce).name||""}`)}),U(De,Ie)}),U(Oe,Te)};ve(Ee,Oe=>{var Te;(Te=l(_e).uploads)!=null&&Te.files&&l(_e).uploads.files.length>0&&Oe(de)})}var Qe=x($e,2);{var Fe=Oe=>{var Te=ME(),De=g(Te);Ne(ce=>Se(De,ce),[()=>l(_e).parentTemplates.slice(1).map(ce=>ce.name).join("  ")],at),U(Oe,Te)};ve(Qe,Oe=>{l(_e).parentTemplates&&l(_e).parentTemplates.length>1&&Oe(Fe)})}U(ge,Me)}),U(K,M)};ve(F,K=>{l(L).prints&&l(L).prints.length>0&&K(I)})}var O=x(F,2);{var D=K=>{var M=KE(),ge=x(g(M),2);tr(ge,1,()=>Object.entries(l(L).addons),mr,(_e,Me)=>{let $e=()=>l(Me)[1];var Y=kt();const j=at(()=>l(L).addonProductsMap[$e().productId]);var ee=it(Y);{var ae=ue=>{var me=qE();const ye=at(()=>l(j).variants.find(Oe=>Oe.id===$e().variantId));var Ee=g(me),de=g(Ee),Qe=x(Ee,2);{var Fe=Oe=>{var Te=RE(),De=it(Te),ce=g(De),Ie=x(De,2),V=g(Ie);Ne(G=>{Se(ce,`- ${l(ye).title||" "}`),Se(V,` ${G??""}`)},[()=>yr(l(ye).prices[0].amount)],at),U(Oe,Te)};ve(Qe,Oe=>{l(ye)&&Oe(Fe)})}Ne(()=>Se(de,l(j).title)),U(ue,me)};ve(ee,ue=>{l(j)&&ue(ae)})}U(_e,Y)}),U(K,M)};ve(O,K=>{l(L).addons&&Object.keys(l(L).addons).length>0&&l(L).addonProductsMap&&K(D)})}var P=x(O,2);tr(P,5,()=>[l(L)],mr,(K,M)=>{var ge=WE();const _e=at(()=>l(M).productAmount||(l(M).variants||[]).reduce((le,Le)=>le+Le.prices[0].amount*Le.quantity,0)),Me=at(()=>l(M).printAmount||(l(M).prints||[]).reduce((le,Le)=>le+(Le.price||0),0)),$e=at(()=>l(M).addonAmount||0),Y=at(()=>l(M).totalAmount||l(_e)+l(Me)+l($e)),j=at(()=>l(M).prints&&l(M).prints.length>0),ee=at(()=>l(M).simplePrints&&l(M).simplePrints.length>0),ae=at(()=>l(M).print_type==="simple"&&l(ee)||l(ee)&&!l(j)),ue=at(()=>!l(j)&&!l(ee));var me=it(ge),ye=g(me),Ee=x(g(ye),2),de=g(Ee),Qe=x(ye,2),Fe=x(g(Qe),2);{var Oe=le=>{var Le=$E();U(le,Le)},Te=le=>{var Le=VE(),He=g(Le);Ne(je=>Se(He,`${je??""}`),[()=>yr(l(Me))],at),U(le,Le)};ve(Fe,le=>{l(ae)||l(ue)?le(Oe):le(Te,!1)})}var De=x(Qe,2);{var ce=le=>{var Le=GE(),He=x(g(Le),2),je=g(He);Ne(xe=>Se(je,`${xe??""}`),[()=>yr(l($e))],at),U(le,Le)};ve(De,le=>{l($e)>0&&le(ce)})}var Ie=x(me,2),V=x(g(Ie),2),G=g(V);Ne((le,Le)=>{Se(de,`${le??""}`),Se(G,`${Le??""}`)},[()=>yr(l(_e)),()=>yr(l(Y))],at),U(K,ge)}),Ne(()=>{cr(pe,"src",l(L).product.thumbnail),cr(pe,"alt",l(L).product.title),Se(z,l(L).product.title)}),U(be,J)}),U(q,N)},k=q=>{var N=YE();U(q,N)};ve(C,q=>{o().products&&o().products.length>0?q(Q):q(k,!1)})}var H=x(B,2);{var Z=q=>{var N=JE(),re=g(N),be=x(g(re),2),L=g(be),R=g(L),J=g(R),se=x(be,2),fe=g(se),ie=x(fe,2);Ne(()=>Se(J,l(c))),At("click",fe,w),At("click",ie,v),U(q,N)};ve(H,q=>{l(A)&&q(Z)})}U(n,y),dn(),r()}var eF=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl"><h3 class="odz-text-lg odz-font-bold"> </h3> <p class="odz-py-4"> </p> <div class="odz-modal-action"><form method="dialog"><button class="odz-btn"></button></form></div></div></dialog>');function Pc(n,e){ln(e,!1);let t=ht(e,"isOpen",12),r=ht(e,"message",12),o=ht(e,"title",8,""),s=ht(e,"onClose",8,void 0);function i(){t(!1),r(""),s()&&s()()}fn();var a=kt(),A=it(a);{var d=c=>{var u=eF(),h=g(u),p=g(h),v=g(p),w=x(p,2),y=g(w),B=x(w,2),C=g(B),Q=g(C);Ne(()=>{Se(v,o()),Se(y,r())}),At("click",Q,i),U(c,u)};ve(A,c=>{t()&&c(d)})}U(n,a),dn()}var tF=$('<div class="odz-fixed odz-inset-0 odz-bg-base-100 odz-bg-opacity-50 odz-flex odz-items-center odz-justify-center odz-z-50"><div class="odz-rounded-lg odz-p-8 odz-flex odz-flex-col odz-items-center odz-gap-4"><span class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></span> <p class="odz-text-base-content odz-font-medium"> </p></div></div>');function kc(n,e){let t=ht(e,"isLoading",8,!1),r=ht(e,"message",8,"...");var o=kt(),s=it(o);{var i=a=>{var A=tF(),d=g(A),c=x(g(d),2),u=g(c);Ne(()=>Se(u,r())),U(a,A)};ve(s,a=>{t()&&a(i)})}U(n,o)}var rF=$("<span> <span></span></span>"),nF=$('<div class="odz-flex odz-items-center odz-gap-2 odz-w-full odz-justify-center"><!> <span> <span></span></span> <!></div>');function H5(n,e){ln(e,!1);const t=Be();let r=ht(e,"originalPrice",8),o=ht(e,"finalPrice",8),s=ht(e,"hasDiscount",8,!1),i=ht(e,"size",8,"md"),a=ht(e,"showOriginal",8,!0);Yt(()=>oo(i()),()=>{_(t,{sm:{original:"odz-text-sm",final:"odz-text-sm odz-font-semibold",currency:"odz-text-xs"},md:{original:"odz-text-base",final:"odz-text-lg odz-font-bold",currency:"odz-text-sm"},lg:{original:"odz-text-lg",final:"odz-text-xl odz-font-bold",currency:"odz-text-base"}}[i()])}),mo(),fn();var A=nF(),d=g(A);{var c=y=>{var B=rF(),C=g(B),Q=x(C);Ne(k=>{Dr(B,`odz-text-gray-500 odz-line-through ${l(t).original??""}`),Se(C,k),Dr(Q,B0(l(t).currency))},[()=>r().toLocaleString()],at),U(y,B)};ve(d,y=>{s()&&a()&&r()!==o()&&y(c)})}var u=x(d,2),h=g(u),p=x(h),v=x(u,2);{var w=y=>{var B=kt();const C=at(()=>Math.round((r()-o())/r()*100));var Q=it(B);{var k=H=>{};ve(Q,H=>{l(C)>0&&H(k)})}U(y,B)};ve(v,y=>{s()&&r()!==o()&&y(w)})}Ne(y=>{Dr(u,`odz-text-gray-900 ${l(t).final??""}`),Se(h,y),Dr(p,B0(l(t).currency))},[()=>o().toLocaleString()],at),U(n,A),dn()}var oF=$('<img class="odz-w-8 odz-h-8 odz-object-cover odz-mb-1">'),sF=$('<span class="odz-ml-1"></span>'),iF=$('<span class="odz-ml-1"></span>'),aF=$("<button><!> <span> </span> <!></button>"),AF=$('<div class="odz-flex odz-flex-col odz-gap-2 mb-4"><h3 class="odz-font-bold odz-text-sm"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),lF=$('<img class="odz-w-10 odz-h-10 odz-rounded odz-object-cover">'),dF=$('<!> <div class="odz-inline-flex odz-items-center odz-justify-center odz-w-5 odz-h-5 odz-bg-red-500 odz-text-white odz-rounded-full odz-text-xs odz-font-bold odz-flex-shrink-0" title=" ">%</div>',1),cF=$('<span class="odz-text-xs"> </span>'),uF=$('<div class="odz-flex odz-flex-col odz-border odz-rounded odz-overflow-hidden"><div class="odz-bg-gray-50 odz-px-3 odz-py-2 odz-border-b"><span class="odz-text-xs odz-font-medium odz-text-center odz-block"> </span></div> <div class="odz-flex odz-flex-col odz-p-3 odz-gap-2"><div class="odz-text-center"><div class="odz-flex odz-items-center odz-justify-center odz-gap-1"><!></div></div> <div class="odz-flex odz-items-center odz-border odz-rounded odz-mt-1"><button class="odz-btn odz-btn-ghost odz-btn-sm odz-px-2">-</button> <input type="number" class="odz-input odz-input-sm odz-w-full odz-text-center odz-border-x-0 odz-border-y focus:odz-outline-none focus:odz-ring-0 focus:odz-border-x-0 focus:odz-border-y" min="0"> <button class="odz-btn odz-btn-ghost odz-btn-sm odz-px-2">+</button></div></div></div>'),hF=$('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div>'),fF=$(`<p class="odz-text-sm odz-text-gray-500">    ( )
                                .</p>`),pF=$('<div class="odz-flex odz-flex-col odz-gap-3"><div class="odz-flex odz-items-center odz-gap-2 odz-bg-gray-100 odz-p-2 odz-rounded"><!> <h3 class="odz-font-semibold odz-text-base"> </h3></div> <!></div>'),gF=$('<div class="odz-flex odz-flex-col odz-gap-6 mt-4"></div>'),vF=$('<img class="odz-w-16 odz-h-16 odz-object-cover odz-rounded">'),mF=$('<p class="odz-text-sm odz-text-gray-600 odz-mt-1"> </p>'),wF=$('<div class="odz-text-sm odz-font-semibold odz-text-primary"> </div>'),yF=$('<div role="button" tabindex="0"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-2"><input type="radio" class="odz-radio odz-radio-primary odz-radio-sm"> <span class="odz-text-sm odz-font-medium"> </span></div> <!></div>'),_F=$('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 odz-gap-3"></div>'),bF=$('<div class="odz-border odz-rounded-lg odz-p-4 odz-bg-base-100"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-3"><!> <div><h5 class="odz-font-medium odz-text-base"> </h5> <!></div></div> <!></div>'),xF=$('<div class="odz-flex odz-flex-col odz-gap-4"><h4 class="odz-font-semibold odz-text-base odz-text-gray-700"> </h4> <!></div>'),BF=$('<div class="odz-flex odz-flex-col odz-gap-6 odz-mt-8"><h3 class="odz-font-bold odz-text-lg odz-border-b odz-pb-2"> </h3> <!></div>'),zF=$('<div class="odz-flex odz-justify-end odz-mt-6"><button class="odz-btn odz-btn-accent odz-w-full"></button></div>'),CF=$('<div class="odz-card odz-card-side odz-bg-base-100 odz-border odz-rounded odz-p-3"><figure><img class="odz-max-h-24 odz-border"></figure> <div class="odz-card-body"><h2 class="odz-card-title odz-text-base"> </h2> <div class="odz-card-actions odz-justify-end"></div></div></div> <!> <!> <!> <!>',1),SF=$('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><!></div> <!> <!>',1);function EF(n,e){var ze;ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=()=>an(ni,"$shopStore",t);let i=ht(e,"step",12,0),a=ht(e,"productId",8),A=Be(null),d=Be(!1),c=Be(""),u=Be(""),h=Be(!1),p=Be([]),v=Be({}),w=Be({}),y=Be(((ze=o().products[o().index])==null?void 0:ze.variants.map(z=>({...z})))||[]),B=Be({}),C=null,Q=Be({}),k=Be([]),H=Be({});function Z(z,E){console.log(" togglePenultimateSelection :",{optionId:z,value:E,penultimateOptionId:C}),!C&&l(A)&&l(A).options.length>=2&&(C=l(A).options[l(A).options.length-2].id,console.log(" penultimateOptionId :",C)),z!==C&&console.log(" optionId :",{optionId:z,penultimateOptionId:C}),br(B,l(B)[z]=E),_(B,{...l(B)});const F=l(k).indexOf(E);if(console.log("  expandedPenultimateValues:",l(k),"index:",F),F===-1)if(_(k,[...l(k),E]),console.log("    expandedPenultimateValues:",l(k)),!l(H)[E]||l(H)[E].length===0){console.log(" variants  :",{value:E,optionId:z,penultimateOptionId:C});const I=l(A).variants.filter(O=>O.option_values?O.option_values.some(P=>{if(P.option_id&&P.value){const K=P.option_id===z&&P.value===E;return K&&console.log("   :",{variantId:O.id,ov:P}),K}else if(P.option_value&&P.option_value.option_id){const K=P.option_value.option_id===z&&P.option_value.value===E;return K&&console.log("   :",{variantId:O.id,ov:P}),K}return!1}):(console.log(" variant.option_values :",O.id),!1));console.log("  variants:",{value:E,count:I.length,variants:I.map(O=>({id:O.id,title:O.title}))}),br(H,l(H)[E]=I),_(H,{...l(H)}),I.forEach(O=>{l(y).some(D=>D.id===O.id)||_(y,[...l(y),{...O,quantity:0}])})}else console.log("  variants :",{value:E,count:l(H)[E].length});else _(k,l(k).filter(I=>I!==E)),console.log("    expandedPenultimateValues:",l(k));_(k,[...l(k)]),_(H,{...l(H)}),console.log(" togglePenultimateSelection :",{expandedPenultimateValues:l(k),variantsByGroup:Object.keys(l(H)),hasExpanded:l(k).length>0}),setTimeout(()=>{console.log(" 1   :",{expandedPenultimateValues:l(k).length,variantsByGroupKeys:Object.keys(l(H))})},1e3)}function q(z,E){var I;const F=((I=l(A))==null?void 0:I.options.findIndex(O=>O.id===z))??-1;if(!(!l(A)||F===-1||F>=l(A).options.length-1)){for(let O=F+1;O<l(A).options.length;O++)delete l(B)[l(A).options[O].id];br(B,l(B)[z]=E),_(B,{...l(B)}),_(k,[]),_(H,{}),C&&_(y,l(y).filter(O=>!O.option_values.some(D=>D.option_value.option_id===C)||(O.quantity||0)>0))}}function N(z){_(y,l(y).map(E=>E.id===z?{...E,quantity:(E.quantity||0)+1}:E))}function re(z){_(y,l(y).map(E=>E.id===z&&(E.quantity||0)>0?{...E,quantity:(E.quantity||0)-1}:E))}function be(){const z=l(y).filter(F=>(F.quantity||0)>0);if(z.length===0){_(d,!0),_(c," "),_(u,"1    .");return}const E=o().products[o().index];E&&(er(gt,dt(o).products[o().index]={...E,variants:z,quantity:z.reduce((F,I)=>F+(I.quantity||0),0)},dt(o)),gt.updateTotalAmounts()),i(2)}async function L(){var I,O;if(!((I=l(A))!=null&&I.quantity_discounts)){_(Q,{});return}const z=l(y).reduce((D,P)=>D+(P.quantity||0),0);let E=null;if(z>0){const D=((O=l(y).find(P=>(P.quantity||0)>0))==null?void 0:O.prices[0].amount)||0;E=ia(z,D,l(A).quantity_discounts)}const F={};for(const D of l(y))(D.quantity||0)>0&&(E!=null&&E.hasDiscount)&&(F[D.id]=E);_(Q,F)}let R=Be(null);to(async()=>{var z;_(h,!0);try{if(_(A,await uh(a(),s().id)),l(A)&&(_(p,await hh(l(A).id)),_(w,{}),l(p).forEach(E=>{E.items.forEach(F=>{F.addon_product.variants&&F.addon_product.variants.length>0&&br(w,l(w)[F.addon_product.id]={price:F.addon_product.variants[0].prices[0].amount,title:F.addon_product.title,variants:F.addon_product.variants})})}),(z=o().products[o().index])!=null&&z.addons)){const E=o().products[o().index].addons;_(v,{}),Object.entries(E).forEach(([F,I])=>{typeof I=="object"&&I.productId&&I.variantId?br(v,l(v)[F]={productId:I.productId,variantId:I.variantId}):typeof I=="string"&&br(v,l(v)[F]={productId:I,variantId:""})}),_(v,{...l(v)})}if(l(A)&&l(A).options.length>0&&(l(A).options.length>=2?(C=l(A).options[l(A).options.length-2].id,console.log(" penultimateOptionId :",{penultimateOptionId:C,optionCount:l(A).options.length,allOptions:l(A).options.map(E=>({id:E.id,title:E.title}))})):console.log("  2 :",l(A).options.length)),o().products[o().index]&&o().products[o().index].variants.length>0){er(gt,dt(o).products[o().index].product=l(A),dt(o)),_(y,o().products[o().index].variants.map(F=>({...F})));const E=o().products[o().index].addons||{};if(_(v,{}),Object.entries(E).forEach(([F,I])=>{typeof I=="object"&&I.productId&&I.variantId?br(v,l(v)[F]={productId:I.productId,variantId:I.variantId}):typeof I=="string"&&br(v,l(v)[F]={productId:I,variantId:""})}),l(A)&&l(A).options.length>0){const F=l(y).filter(I=>(I.quantity||0)>0);if(F.length>0){const I=l(A).options.map(O=>O.id);if(l(A).options.length>=2){C=l(A).options[l(A).options.length-2].id;const O=[];if(F.forEach(D=>{if(D.title){const P=D.title.split(" / ");if(P.length>0){const K=P[0];O.includes(K)||O.push(K)}}D.option_values&&D.option_values.forEach(P=>{P.option_id&&P.value?P.option_id===C&&(O.includes(P.value)||O.push(P.value)):P.option_value&&P.option_value.option_id&&P.option_value.option_id===C&&(O.includes(P.option_value.value)||O.push(P.option_value.value))})}),O.length>0)O.forEach(D=>{Z(C,D)});else{const D=[];F.forEach(P=>{if(P.title){const K=P.title.split(" / ");if(K.length>0){const M=K[0].trim();D.includes(M)||D.push(M)}}}),D.length>0?D.forEach(P=>{const K=l(A).options[l(A).options.length-2].values.find(M=>M.value.toLowerCase()===P.toLowerCase());if(K)Z(C,K.value);else{const M=l(A).options[l(A).options.length-2].values.filter(ge=>ge.value.toLowerCase().includes(P.toLowerCase())||P.toLowerCase().includes(ge.value.toLowerCase()));M.length>0&&M.forEach(ge=>{Z(C,ge.value)})}}):l(A).options[l(A).options.length-2].values.forEach(P=>{Z(C,P.value)})}}else l(A).options.length}}}else l(A)&&er(gt,dt(o).products=[...o().products,{product:l(A),variants:[],quantity:0,prints:[],addons:{},addonProductsMap:l(w)}],dt(o));setTimeout(()=>{gt.updateTotalAmounts()},100)}catch(E){console.error("Product component  :",E)}finally{_(h,!1)}});function J(z,E,F){if(!F||F.trim()===""){console.error("Invalid variantId provided:",F);return}br(v,l(v)[z]={productId:E,variantId:F}),_(v,{...l(v)});const I=o().products[o().index];I&&(er(gt,dt(o).products[o().index]={...I,addons:l(v),addonProductsMap:l(w)},dt(o)),gt.updateTotalAmounts())}function se(z){return z?z.replace(/<[^>]*>/g,"").trim():""}Yt(()=>(o(),l(v)),()=>{var z;if((z=o().products[o().index])!=null&&z.addons&&Object.keys(o().products[o().index].addons).length>0&&Object.keys(l(v)).length===0){const E=o().products[o().index].addons;Object.entries(E).forEach(([F,I])=>{typeof I=="object"&&I.productId&&I.variantId&&br(v,l(v)[F]={productId:I.productId,variantId:I.variantId})}),_(v,{...l(v)})}}),Yt(()=>(l(y),l(A),l(R),o(),l(v),l(w),gt),()=>{l(y)&&l(A)&&(l(R)&&clearTimeout(l(R)),_(R,setTimeout(()=>{const z=o().products[o().index];if(z){const E=l(y).reduce((O,D)=>O+(D.quantity||0),0),F=z.quantity||0,I=l(y).filter(O=>(O.quantity||0)>0);er(gt,dt(o).products[o().index]={...z,variants:I,quantity:E,addons:l(v),addonProductsMap:l(w)},dt(o)),L(),E!==F&&z.prints&&z.prints.length>0&&gt.calculatePrintPrice(o().index),gt.updateTotalAmounts()}},100)))}),mo(),fn();var fe=SF(),ie=it(fe),pe=g(ie);{var te=z=>{var E=CF(),F=it(E),I=g(F),O=g(I),D=x(I,2),P=g(D),K=g(P),M=x(F,2);tr(M,1,()=>l(A).options,mr,(ee,ae,ue)=>{var me=kt(),ye=it(me);{var Ee=de=>{var Qe=AF(),Fe=g(Qe),Oe=g(Fe),Te=x(Fe,2);tr(Te,5,()=>l(ae).values,mr,(De,ce)=>{var Ie=aF();const V=at(()=>ue===l(A).options.length-2),G=at(()=>l(V)&&l(k).includes(l(ce).value)),le=at(()=>l(V)?l(G):l(B)[l(ae).id]===l(ce).value);var Le=g(Ie);{var He=ot=>{var Pe=oF();Ne(()=>{cr(Pe,"src",l(ce).image),cr(Pe,"alt",l(ce).value)}),U(ot,Pe)};ve(Le,ot=>{l(ce).image&&ot(He)})}var je=x(Le,2),xe=g(je),Re=x(je,2);{var et=ot=>{var Pe=sF();U(ot,Pe)},qe=ot=>{var Pe=kt(),Ye=it(Pe);{var rt=lt=>{var vt=iF();U(lt,vt)};ve(Ye,lt=>{l(V)&&lt(rt)},!0)}U(ot,Pe)};ve(Re,ot=>{l(V)&&l(G)?ot(et):ot(qe,!1)})}Ne(()=>{Dr(Ie,`odz-btn odz-btn-outline odz-h-auto odz-min-h-10 odz-border-gray-300 odz-w-44 odz-p-2 odz-text-xs ${(l(le)?"odz-border-2 odz-border-gray-800":"")??""}`),Se(xe,l(ce).value)}),At("click",Ie,()=>{var ot;console.log("   :",{optionTitle:l(ae).title,optionId:l(ae).id,value:l(ce).value,isPenultimateOption:l(V),index:ue,totalOptions:(ot=l(A))==null?void 0:ot.options.length}),l(V)?Z(l(ae).id,l(ce).value):q(l(ae).id,l(ce).value)}),U(De,Ie)}),Ne(()=>Se(Oe,l(ae).title)),U(de,Qe)};ve(ye,de=>{ue<l(A).options.length-1&&de(Ee)})}U(ee,me)});var ge=x(M,2);{var _e=ee=>{var ae=gF();tr(ae,5,()=>l(k),ue=>ue,(ue,me)=>{var ye=pF();const Ee=at(()=>l(H)[l(me)]||[]),de=at(()=>{var G;return(G=l(A).options[l(A).options.length-2])==null?void 0:G.values.find(le=>le.value===l(me))});var Qe=g(ye),Fe=g(Qe);{var Oe=G=>{var le=lF();Ne(()=>{cr(le,"src",l(de).image),cr(le,"alt",l(me))}),U(G,le)};ve(Fe,G=>{var le;(le=l(de))!=null&&le.image&&G(Oe)})}var Te=x(Fe,2),De=g(Te),ce=x(Qe,2);{var Ie=G=>{var le=hF();tr(le,5,()=>l(Ee),Le=>Le.id,(Le,He)=>{var je=uF();const xe=at(()=>l(y).find(st=>st.id===l(He).id)),Re=at(()=>{var st;return((st=l(xe))==null?void 0:st.quantity)||0}),et=at(()=>{var st;return((st=l(He).option_values.find(pt=>pt.option_value.option_id===l(A).options[l(A).options.length-1].id))==null?void 0:st.option_value.value)||"N/A"}),qe=at(()=>l(Q)[l(He).id]);var ot=g(je),Pe=g(ot),Ye=g(Pe),rt=x(ot,2),lt=g(rt),vt=g(lt),Ft=g(vt);{var Qt=st=>{var pt=dF(),_t=it(pt);H5(_t,{get originalPrice(){return l(He).prices[0].amount},get finalPrice(){return l(qe).discountedPrice},hasDiscount:!0,size:"sm"}),U(st,pt)},Et=st=>{var pt=cF(),_t=g(pt);Ne($t=>Se(_t,`${$t??""}`),[()=>yr(l(He).prices[0].amount)],at),U(st,pt)};ve(Ft,st=>{var pt;(pt=l(qe))!=null&&pt.hasDiscount&&l(Re)>0?st(Qt):st(Et,!1)})}var mt=x(lt,2),Gt=g(mt),Ht=x(Gt,2),Ut=x(Ht,2);Ne(()=>{Se(Ye,l(et)),Gt.disabled=l(Re)<=0,n1(Ht,l(Re))}),At("click",Gt,()=>re(l(He).id)),At("input",Ht,st=>{const pt=parseInt(st.target.value)||0;_(y,l(y).map(_t=>_t.id===l(He).id?{..._t,quantity:pt>=0?pt:0}:_t))}),At("click",Ut,()=>N(l(He).id)),U(Le,je)}),U(G,le)},V=G=>{var le=fF();U(G,le)};ve(ce,G=>{l(Ee).length>0?G(Ie):G(V,!1)})}Ne(()=>Se(De,l(me))),U(ue,ye)}),U(ee,ae)};ve(ge,ee=>{l(k).length>0&&ee(_e)})}var Me=x(ge,2);{var $e=ee=>{var ae=BF(),ue=x(g(ae),2);tr(ue,1,()=>l(p),me=>me.id,(me,ye)=>{var Ee=xF(),de=g(Ee),Qe=g(de),Fe=x(de,2);tr(Fe,1,()=>l(ye).items,Oe=>Oe.id,(Oe,Te)=>{var De=bF(),ce=g(De),Ie=g(ce);{var V=et=>{var qe=vF();Ne(()=>{cr(qe,"src",l(Te).addon_product.thumbnail),cr(qe,"alt",l(Te).addon_product.title)}),U(et,qe)};ve(Ie,et=>{l(Te).addon_product.thumbnail&&et(V)})}var G=x(Ie,2),le=g(G),Le=g(le),He=x(le,2);{var je=et=>{var qe=mF(),ot=g(qe);Ne(Pe=>Se(ot,Pe),[()=>se(l(Te).addon_product.description)],at),U(et,qe)};ve(He,et=>{l(Te).addon_product.description&&et(je)})}var xe=x(ce,2);{var Re=et=>{var qe=_F();tr(qe,5,()=>l(Te).addon_product.variants,ot=>ot.id,(ot,Pe)=>{var Ye=yF();const rt=at(()=>l(v)[l(ye).id]),lt=at(()=>{var Ht,Ut;return((Ht=l(rt))==null?void 0:Ht.productId)===l(Te).addon_product.id&&((Ut=l(rt))==null?void 0:Ut.variantId)===l(Pe).id});var vt=g(Ye),Ft=g(vt),Qt=x(Ft,2),Et=g(Qt),mt=x(vt,2);{var Gt=Ht=>{var Ut=wF(),st=g(Ut);Ne(pt=>Se(st,` ${pt??""}`),[()=>yr(l(Pe).prices[0].amount)],at),U(Ht,Ut)};ve(mt,Ht=>{l(Pe).prices&&l(Pe).prices.length>0&&Ht(Gt)})}Ne(Ht=>{Dr(Ye,`odz-border odz-rounded odz-p-3 odz-cursor-pointer odz-transition-all odz-duration-200 ${(l(lt)?"odz-border-primary odz-bg-primary/5":"odz-border-gray-300 hover:odz-border-gray-400")??""}`),cr(Ft,"name",`addon-${l(ye).id??""}`),qu(Ft,l(lt)),Se(Et,Ht)},[()=>l(Pe).title||` ${l(Pe).id.substring(0,4)}`],at),At("change",Ft,()=>J(l(ye).id,l(Te).addon_product.id,l(Pe).id)),At("click",Ye,()=>J(l(ye).id,l(Te).addon_product.id,l(Pe).id)),At("keydown",Ye,Ht=>Ht.key==="Enter"&&J(l(ye).id,l(Te).addon_product.id,l(Pe).id)),U(ot,Ye)}),U(et,qe)};ve(xe,et=>{l(Te).addon_product.variants&&l(Te).addon_product.variants.length>0&&et(Re)})}Ne(()=>Se(Le,l(Te).addon_product.title)),U(Oe,De)}),Ne(()=>Se(Qe,l(ye).name)),U(me,Ee)}),U(ee,ae)};ve(Me,ee=>{l(p).length>0&&ee($e)})}var Y=x(Me,2);{var j=ee=>{var ae=zF(),ue=g(ae);At("click",ue,()=>be()),U(ee,ae)};ve(Y,ee=>{l(y).filter(ae=>(ae.quantity||0)>0).length>0&&ee(j)})}Ne(()=>{cr(O,"src",l(A).thumbnail),cr(O,"alt",l(A).title),Se(K,l(A).title)}),U(z,E)};ve(pe,z=>{l(A)&&z(te)})}var Ce=x(ie,2);Pc(Ce,{get isOpen(){return l(d)},set isOpen(z){_(d,z)},get title(){return l(c)},set title(z){_(c,z)},get message(){return l(u)},set message(z){_(u,z)},$$legacy:!0});var ne=x(Ce,2);kc(ne,{get isLoading(){return l(h)},set isLoading(z){_(h,z)},$$legacy:!0}),U(n,fe),dn(),r()}class FF{constructor(e){this.isEnabled=!0,this.sessionId=e}log(e,t,r){if(!this.isEnabled)return;const o=new Date().toISOString();`${this.sessionId}${o}`}info(e,t){this.log("info",e,t)}warn(e,t){this.log("warn",e,t)}error(e,t){this.log("error",e,t)}enable(){this.isEnabled=!0}disable(){this.isEnabled=!1}}function IF(n){const e=Date.now().toString(36)+Math.random().toString(36).substr(2);return{productId:n,productSelection:null,printSelection:null,addonSelection:null,additionalInfo:null,currentStep:"product",isDebugMode:!0,sessionId:e}}function UF(){const{subscribe:n,set:e,update:t}=ld(null);let r=null;return{subscribe:n,set:e,update:t,initialize(o,s,i){const a={...IF(o),estimateId:s,idx:i};r=new FF(a.sessionId),e(a),r.info("Fixed Estimate Store  ",{productId:o,estimateId:s,idx:i,sessionId:a.sessionId})},reset(){r==null||r.info("Fixed Estimate Store "),e(null),r=null},setCurrentStep(o){t(s=>s&&(r==null||r.info(" ",{from:s.currentStep,to:o}),{...s,currentStep:o}))},updateProductSelection(o){t(s=>{if(!s)return s;const i=Date.now(),a=s.productSelection,A={productId:s.productId,selectedColors:[],quantityByVariant:{},variantsByColor:{},variantDiscounts:{},totalQuantity:0,isCompleted:!1,...a,...o,lastUpdated:i};return r==null||r.info("   ",{productId:s.productId,changes:o,totalQuantity:A.totalQuantity,selectedColors:A.selectedColors.length}),{...s,productSelection:A}})},toggleColorSelection(o,s){t(i=>{var p;if(!i)return i;if(!i.productSelection){const v={productId:i.productId,selectedColors:[],quantityByVariant:{},variantsByColor:{},variantDiscounts:{},totalQuantity:0,isCompleted:!1,lastUpdated:Date.now()};i={...i,productSelection:v}}const a=[...i.productSelection.selectedColors],A={...i.productSelection.quantityByVariant},d={...i.productSelection.variantsByColor},c=a.indexOf(o);c===-1?(a.push(o),d[o]=s[o]||[],A[o]=A[o]||{},r==null||r.info("  ",{color:o,totalColors:a.length,variantCount:((p=s[o])==null?void 0:p.length)||0})):(a.splice(c,1),delete d[o],delete A[o],r==null||r.info("  ",{color:o,remainingColors:a.length}));const u=Object.values(A).reduce((v,w)=>v+Object.values(w).reduce((y,B)=>y+B,0),0);return{...i,productSelection:{...i.productSelection,selectedColors:a,quantityByVariant:A,variantsByColor:d,totalQuantity:u,lastUpdated:Date.now()}}})},updateQuantity(o,s,i){t(a=>{if(!a||!a.productSelection)return a;const A={...a.productSelection.quantityByVariant};A[o]||(A[o]={});const d=A[o][s]||0;A[o][s]=Math.max(0,i);const c=Object.values(A).reduce((u,h)=>u+Object.values(h).reduce((p,v)=>p+v,0),0);return r==null||r.info(" ",{color:o,variantId:s,oldQuantity:d,newQuantity:A[o][s],totalQuantity:c,triggerDiscountUpdate:!0}),{...a,productSelection:{...a.productSelection,quantityByVariant:A,totalQuantity:c,lastUpdated:Date.now(),needsDiscountRecalculation:!0}}})},updateVariantDiscounts(o){t(s=>{if(!s||!s.productSelection)return s;const i=s.productSelection.variantDiscounts||{},a=Object.keys(i).sort(),A=Object.keys(o).sort();return JSON.stringify(a)!==JSON.stringify(A)||Object.keys(o).some(c=>JSON.stringify(i[c])!==JSON.stringify(o[c]))?(r==null||r.info("  ",{productId:s.productId,discountCount:Object.keys(o).length,changedVariants:Object.keys(o)}),{...s,productSelection:{...s.productSelection,variantDiscounts:{...o},needsDiscountRecalculation:!1,lastUpdated:Date.now()}}):s})},completeProductSelection(){t(o=>!o||!o.productSelection?o:(r==null||r.info("  ",{totalQuantity:o.productSelection.totalQuantity,selectedColors:o.productSelection.selectedColors.length}),{...o,productSelection:{...o.productSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"print"}))},updatePrintSelection(o){t(s=>{if(!s)return s;const i=Date.now(),a=s.printSelection,A={productId:s.productId,currentMethod:"selection",isCompleted:!1,...a,...o,lastUpdated:i};return r==null||r.info("   ",{productId:s.productId,changes:o,currentMethod:A.currentMethod}),{...s,printSelection:A}})},selectPrintMethod(o){t(s=>{if(!s)return s;r==null||r.info("  ",{method:o,productId:s.productId});const i={...s.printSelection,productId:s.productId,currentMethod:o,isCompleted:!1,lastUpdated:Date.now()};return{...s,printSelection:i}})},completePrintSelection(){t(o=>!o||!o.printSelection?o:(r==null||r.info("  ",{method:o.printSelection.currentMethod}),{...o,printSelection:{...o.printSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"addon"}))},updateAddonSelection(o){t(s=>{if(!s)return s;const i=Date.now(),a=s.addonSelection,A={productId:s.productId,selectedAddons:{},isCompleted:!1,...a,...o,lastUpdated:i};return r==null||r.info("   ",{productId:s.productId,changes:o,addonCount:Object.keys(A.selectedAddons).length}),{...s,addonSelection:A}})},toggleAddonSelection(o,s,i){t(a=>{var u,h,p;if(!a)return a;const A={...((u=a.addonSelection)==null?void 0:u.selectedAddons)||{}};((h=A[o])==null?void 0:h.productId)===s&&((p=A[o])==null?void 0:p.variantId)===i?(delete A[o],r==null||r.info("  ",{addonId:o,productId:s,variantId:i,remainingAddons:Object.keys(A).length})):(A[o]={productId:s,variantId:i},r==null||r.info(" ",{addonId:o,productId:s,variantId:i,totalAddons:Object.keys(A).length}));const c={...a.addonSelection??{productId:a.productId,selectedAddons:{},isCompleted:!1,lastUpdated:Date.now()},productId:a.productId,selectedAddons:A,isCompleted:!1,lastUpdated:Date.now()};return{...a,addonSelection:c}})},completeAddonSelection(){t(o=>{var i;if(!o)return o;const s=Object.keys(((i=o.addonSelection)==null?void 0:i.selectedAddons)||{}).length;return r==null||r.info("  ",{addonCount:s}),{...o,addonSelection:{...o.addonSelection,isCompleted:!0,lastUpdated:Date.now()},currentStep:"additional"}})},updateAdditionalInfo(o){t(s=>{if(!s)return s;const i=Date.now(),A={customerName:"",customerPhone:"",customerEmail:"",organizationName:"",postcode:"",address1:"",address2:"",shippingMethod:"standard",prefDeliveryDate:"",comment:"",designRequirement:"",isCompleted:!1,...s.additionalInfo,...o,lastUpdated:i};return r==null||r.info("  ",{changes:o,hasCustomerInfo:!!(A.customerName&&A.customerPhone),hasAddressInfo:!!A.address1}),{...s,additionalInfo:A}})},completeAdditionalInfo(){t(o=>!o||!o.additionalInfo?o:(r==null||r.info("  ",{customerName:o.additionalInfo.customerName,hasAddress:!!o.additionalInfo.address1}),{...o,additionalInfo:{...o.additionalInfo,isCompleted:!0,lastUpdated:Date.now()}}))},toggleDebugMode(){t(o=>{if(!o)return o;const s=!o.isDebugMode;return r&&(s?(r.enable(),r.info("  ")):(r.info("  "),r.disable())),{...o,isDebugMode:s}})},getSelectionSummary(){var i,a,A,d,c,u,h,p,v,w;const o=Er({subscribe:n});if(!o)return null;const s={productId:o.productId,sessionId:o.sessionId,currentStep:o.currentStep,completedSteps:{product:((i=o.productSelection)==null?void 0:i.isCompleted)||!1,print:((a=o.printSelection)==null?void 0:a.isCompleted)||!1,addon:((A=o.addonSelection)==null?void 0:A.isCompleted)||!1,additional:((d=o.additionalInfo)==null?void 0:d.isCompleted)||!1},statistics:{totalQuantity:((c=o.productSelection)==null?void 0:c.totalQuantity)||0,selectedColors:((u=o.productSelection)==null?void 0:u.selectedColors.length)||0,printMethod:((h=o.printSelection)==null?void 0:h.currentMethod)||"none",addonCount:Object.keys(((p=o.addonSelection)==null?void 0:p.selectedAddons)||{}).length,hasCustomerInfo:!!((v=o.additionalInfo)!=null&&v.customerName&&((w=o.additionalInfo)!=null&&w.customerPhone))}};return r==null||r.info("  ",s),s},toEstimateStoreFormat(){const o=Er({subscribe:n});if(!o)return null;r==null||r.info("EstimateStore   ");const s={productSelection:o.productSelection,printSelection:o.printSelection,addonSelection:o.addonSelection,additionalInfo:o.additionalInfo,metadata:{sessionId:o.sessionId,lastUpdated:Date.now()}};return r==null||r.info("EstimateStore   ",{hasProductSelection:!!o.productSelection,hasPrintSelection:!!o.printSelection,hasAddonSelection:!!o.addonSelection,hasAdditionalInfo:!!o.additionalInfo}),s},toDBFormat(o){const s=Er({subscribe:n});if(!s)return null;try{const{FixedEstimateDBConverter:i}=require("../types/fixedEstimateTypes"),a=o||`EST_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;r==null||r.info("DB   ",{estimateId:a});const A=i.toDBFormat(s,a);return r==null||r.info("DB   ",{estimateId:a,hasProductSelection:!!A.productSelection,hasPrintSelection:!!A.printSelection,addonSelectionsCount:A.addonSelections.length,hasAdditionalInfo:!!A.additionalInfo}),A}catch(i){return r==null||r.error("DB   ",i),null}},fromDBFormat(o){try{const{FixedEstimateDBConverter:s}=require("../types/fixedEstimateTypes");r==null||r.info("DB    ");const i=s.fromDBFormat(o);return e(i),r==null||r.info("DB   ",{productId:i.productId,sessionId:i.sessionId,currentStep:i.currentStep}),!0}catch(s){return r==null||r.error("DB   ",s),!1}},validate(){const o=Er({subscribe:n});if(!o)return{isValid:!1,errors:["Store  ."]};try{const{FixedEstimateDBConverter:s}=require("../types/fixedEstimateTypes"),i=s.validateForDB(o);return r==null||r.info("  ",{isValid:i.isValid,errorCount:i.errors.length}),i.isValid||r==null||r.warn("  ",{errors:i.errors}),i}catch(s){return r==null||r.error("  ",s),{isValid:!1,errors:["    ."]}}},backup(){const o=Er({subscribe:n});if(!o)return null;const s={...o,backupTimestamp:Date.now()};return r==null||r.info("  ",{sessionId:o.sessionId,backupTimestamp:s.backupTimestamp}),s},restore(o){if(!o||!o.sessionId)return r==null||r.error("  "),!1;try{const{backupTimestamp:s,...i}=o;return e(i),r==null||r.info("    ",{sessionId:i.sessionId,backupTimestamp:s}),!0}catch(s){return r==null||r.error("  ",s),!1}}}}const gr=UF();async function j5(n,e){const{data:t,error:r}=await ft.from("products").select("process:processes( id, shop_id, name, description, image_url, created_at, updated_at, canvas_json)").eq("id",n).eq("shop",e).single();if(r)throw r;return t!=null&&t.process?t.process:null}async function R5(n){const{data:e,error:t}=await ft.from("process_print_areas").select("*").eq("process_id",n);if(t)throw t;return e||[]}function Xe(n,e,t){return(e=function(r){var o=function(s,i){if(typeof s!="object"||!s)return s;var a=s[Symbol.toPrimitive];if(a!==void 0){var A=a.call(s,i);if(typeof A!="object")return A;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(s)}(r,"string");return typeof o=="symbol"?o:o+""}(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Cw(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,r)}return t}function Je(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Cw(Object(t),!0).forEach(function(r){Xe(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Cw(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function so(n,e){if(n==null)return{};var t,r,o=function(i,a){if(i==null)return{};var A={};for(var d in i)if({}.hasOwnProperty.call(i,d)){if(a.indexOf(d)>=0)continue;A[d]=i[d]}return A}(n,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(n);for(r=0;r<s.length;r++)t=s[r],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(o[t]=n[t])}return o}function wl(n,e){return e||(e=n.slice(0)),Object.freeze(Object.defineProperties(n,{raw:{value:Object.freeze(e)}}))}let Sw=class{constructor(){Xe(this,"browserShadowBlurConstant",1),Xe(this,"DPI",96),Xe(this,"devicePixelRatio",typeof window<"u"?window.devicePixelRatio:1),Xe(this,"perfLimitSizeTotal",2097152),Xe(this,"maxCacheSideLimit",4096),Xe(this,"minCacheSideLimit",256),Xe(this,"disableStyleCopyPaste",!1),Xe(this,"enableGLFiltering",!0),Xe(this,"textureSize",4096),Xe(this,"forceGLPutImageData",!1),Xe(this,"cachesBoundsOfCurve",!1),Xe(this,"fontPaths",{}),Xe(this,"NUM_FRACTION_DIGITS",4)}};const mn=new class extends Sw{constructor(n){super(),this.configure(n)}configure(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.assign(this,n)}addFonts(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.fontPaths=Je(Je({},this.fontPaths),n)}removeFonts(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(n=>{delete this.fontPaths[n]})}clearFonts(){this.fontPaths={}}restoreDefaults(n){const e=new Sw,t=(n==null?void 0:n.reduce((r,o)=>(r[o]=e[o],r),{}))||e;this.configure(t)}},fl=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return console[n]("fabric",...t)};let Qa=class extends Error{constructor(e,t){super("fabric: ".concat(e),t)}},QF=class extends Qa{constructor(e){super("".concat(e," 'options.signal' is in 'aborted' state"))}},TF=class{},LF=class extends TF{testPrecision(e,t){const r="precision ".concat(t,` float;
void main(){}`),o=e.createShader(e.FRAGMENT_SHADER);return!!o&&(e.shaderSource(o,r),e.compileShader(o),!!e.getShaderParameter(o,e.COMPILE_STATUS))}queryWebGL(e){const t=e.getContext("webgl");t&&(this.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),this.GLPrecision=["highp","mediump","lowp"].find(r=>this.testPrecision(t,r)),t.getExtension("WEBGL_lose_context").loseContext(),fl("log","WebGL: max texture size ".concat(this.maxTextureSize)))}isSupported(e){return!!this.maxTextureSize&&this.maxTextureSize>=e}};const PF={};let Ew;const Ha=()=>Ew||(Ew={document,window,isTouchSupported:"ontouchstart"in window||"ontouchstart"in document||window&&window.navigator&&window.navigator.maxTouchPoints>0,WebGLProbe:new LF,dispose(){},copyPasteData:PF}),Oc=()=>Ha().document,x1=()=>Ha().window,q5=()=>{var n;return Math.max((n=mn.devicePixelRatio)!==null&&n!==void 0?n:x1().devicePixelRatio,1)},Eu=new class{constructor(){Xe(this,"charWidthsCache",{}),Xe(this,"boundsOfCurveCache",{})}getFontCache(n){let{fontFamily:e,fontStyle:t,fontWeight:r}=n;e=e.toLowerCase(),this.charWidthsCache[e]||(this.charWidthsCache[e]={});const o=this.charWidthsCache[e],s="".concat(t.toLowerCase(),"_").concat((r+"").toLowerCase());return o[s]||(o[s]={}),o[s]}clearFontCache(n){(n=(n||"").toLowerCase())?this.charWidthsCache[n]&&delete this.charWidthsCache[n]:this.charWidthsCache={}}limitDimsByArea(n){const{perfLimitSizeTotal:e}=mn,t=Math.sqrt(e*n);return[Math.floor(t),Math.floor(e/t)]}},M0="6.5.4";function Zf(){}const fh=Math.PI/2,Bp=2*Math.PI,B1=Math.PI/180,Rs=Object.freeze([1,0,0,1,0,0]),z1=16,KA=.4477152502,Gr="center",zn="left",Js="top",H0="bottom",So="right",Zs="none",C1=/\r?\n/,K5="moving",pg="scaling",$5="rotating",S1="rotate",V5="skewing",Yu="resizing",kF="modifyPoly",OF="modifyPath",zp="changed",gg="scale",oi="scaleX",Hi="scaleY",Dc="skewX",Nc="skewY",Ko="fill",ei="stroke",Cp="modified",Od="json",_v="svg",lr=new class{constructor(){this[Od]=new Map,this[_v]=new Map}has(n){return this[Od].has(n)}getClass(n){const e=this[Od].get(n);if(!e)throw new Qa("No class registered for ".concat(n));return e}setClass(n,e){e?this[Od].set(e,n):(this[Od].set(n.type,n),this[Od].set(n.type.toLowerCase(),n))}getSVGClass(n){return this[_v].get(n)}setSVGClass(n,e){this[_v].set(e??n.type.toLowerCase(),n)}},Sp=new class extends Array{remove(n){const e=this.indexOf(n);e>-1&&this.splice(e,1)}cancelAll(){const n=this.splice(0);return n.forEach(e=>e.abort()),n}cancelByCanvas(n){if(!n)return[];const e=this.filter(t=>{var r;return t.target===n||typeof t.target=="object"&&((r=t.target)===null||r===void 0?void 0:r.canvas)===n});return e.forEach(t=>t.abort()),e}cancelByTarget(n){if(!n)return[];const e=this.filter(t=>t.target===n);return e.forEach(t=>t.abort()),e}};let DF=class{constructor(){Xe(this,"__eventListeners",{})}on(e,t){if(this.__eventListeners||(this.__eventListeners={}),typeof e=="object")return Object.entries(e).forEach(r=>{let[o,s]=r;this.on(o,s)}),()=>this.off(e);if(t){const r=e;return this.__eventListeners[r]||(this.__eventListeners[r]=[]),this.__eventListeners[r].push(t),()=>this.off(r,t)}return()=>!1}once(e,t){if(typeof e=="object"){const r=[];return Object.entries(e).forEach(o=>{let[s,i]=o;r.push(this.once(s,i))}),()=>r.forEach(o=>o())}if(t){const r=this.on(e,function(){for(var o=arguments.length,s=new Array(o),i=0;i<o;i++)s[i]=arguments[i];t.call(this,...s),r()});return r}return()=>!1}_removeEventListener(e,t){if(this.__eventListeners[e])if(t){const r=this.__eventListeners[e],o=r.indexOf(t);o>-1&&r.splice(o,1)}else this.__eventListeners[e]=[]}off(e,t){if(this.__eventListeners)if(e===void 0)for(const r in this.__eventListeners)this._removeEventListener(r);else typeof e=="object"?Object.entries(e).forEach(r=>{let[o,s]=r;this._removeEventListener(o,s)}):this._removeEventListener(e,t)}fire(e,t){var r;if(!this.__eventListeners)return;const o=(r=this.__eventListeners[e])===null||r===void 0?void 0:r.concat();if(o)for(let s=0;s<o.length;s++)o[s].call(this,t||{})}};const Gd=(n,e)=>{const t=n.indexOf(e);return t!==-1&&n.splice(t,1),n},BA=n=>{if(n===0)return 1;switch(Math.abs(n)/fh){case 1:case 3:return 0;case 2:return-1}return Math.cos(n)},zA=n=>{if(n===0)return 0;const e=n/fh,t=Math.sign(n);switch(e){case 1:return t;case 2:return 0;case 3:return-t}return Math.sin(n)};let zt=class Ls{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;typeof e=="object"?(this.x=e.x,this.y=e.y):(this.x=e,this.y=t)}add(e){return new Ls(this.x+e.x,this.y+e.y)}addEquals(e){return this.x+=e.x,this.y+=e.y,this}scalarAdd(e){return new Ls(this.x+e,this.y+e)}scalarAddEquals(e){return this.x+=e,this.y+=e,this}subtract(e){return new Ls(this.x-e.x,this.y-e.y)}subtractEquals(e){return this.x-=e.x,this.y-=e.y,this}scalarSubtract(e){return new Ls(this.x-e,this.y-e)}scalarSubtractEquals(e){return this.x-=e,this.y-=e,this}multiply(e){return new Ls(this.x*e.x,this.y*e.y)}scalarMultiply(e){return new Ls(this.x*e,this.y*e)}scalarMultiplyEquals(e){return this.x*=e,this.y*=e,this}divide(e){return new Ls(this.x/e.x,this.y/e.y)}scalarDivide(e){return new Ls(this.x/e,this.y/e)}scalarDivideEquals(e){return this.x/=e,this.y/=e,this}eq(e){return this.x===e.x&&this.y===e.y}lt(e){return this.x<e.x&&this.y<e.y}lte(e){return this.x<=e.x&&this.y<=e.y}gt(e){return this.x>e.x&&this.y>e.y}gte(e){return this.x>=e.x&&this.y>=e.y}lerp(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:.5;return t=Math.max(Math.min(1,t),0),new Ls(this.x+(e.x-this.x)*t,this.y+(e.y-this.y)*t)}distanceFrom(e){const t=this.x-e.x,r=this.y-e.y;return Math.sqrt(t*t+r*r)}midPointFrom(e){return this.lerp(e)}min(e){return new Ls(Math.min(this.x,e.x),Math.min(this.y,e.y))}max(e){return new Ls(Math.max(this.x,e.x),Math.max(this.y,e.y))}toString(){return"".concat(this.x,",").concat(this.y)}setXY(e,t){return this.x=e,this.y=t,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setFromPoint(e){return this.x=e.x,this.y=e.y,this}swap(e){const t=this.x,r=this.y;this.x=e.x,this.y=e.y,e.x=t,e.y=r}clone(){return new Ls(this.x,this.y)}rotate(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:E1;const r=zA(e),o=BA(e),s=this.subtract(t);return new Ls(s.x*o-s.y*r,s.x*r+s.y*o).add(t)}transform(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];return new Ls(e[0]*this.x+e[2]*this.y+(t?0:e[4]),e[1]*this.x+e[3]*this.y+(t?0:e[5]))}};const E1=new zt(0,0),ep=n=>!!n&&Array.isArray(n._objects);function G5(n){class e extends n{constructor(){super(...arguments),Xe(this,"_objects",[])}_onObjectAdded(r){}_onObjectRemoved(r){}_onStackOrderChanged(r){}add(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];const i=this._objects.push(...o);return o.forEach(a=>this._onObjectAdded(a)),i}insertAt(r){for(var o=arguments.length,s=new Array(o>1?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return this._objects.splice(r,0,...s),s.forEach(a=>this._onObjectAdded(a)),this._objects.length}remove(){const r=this._objects,o=[];for(var s=arguments.length,i=new Array(s),a=0;a<s;a++)i[a]=arguments[a];return i.forEach(A=>{const d=r.indexOf(A);d!==-1&&(r.splice(d,1),o.push(A),this._onObjectRemoved(A))}),o}forEachObject(r){this.getObjects().forEach((o,s,i)=>r(o,s,i))}getObjects(){for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return o.length===0?[...this._objects]:this._objects.filter(i=>i.isType(...o))}item(r){return this._objects[r]}isEmpty(){return this._objects.length===0}size(){return this._objects.length}contains(r,o){return!!this._objects.includes(r)||!!o&&this._objects.some(s=>s instanceof e&&s.contains(r,!0))}complexity(){return this._objects.reduce((r,o)=>r+=o.complexity?o.complexity():0,0)}sendObjectToBack(r){return!(!r||r===this._objects[0])&&(Gd(this._objects,r),this._objects.unshift(r),this._onStackOrderChanged(r),!0)}bringObjectToFront(r){return!(!r||r===this._objects[this._objects.length-1])&&(Gd(this._objects,r),this._objects.push(r),this._onStackOrderChanged(r),!0)}sendObjectBackwards(r,o){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==0){const i=this.findNewLowerIndex(r,s,o);return Gd(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0}return!1}bringObjectForward(r,o){if(!r)return!1;const s=this._objects.indexOf(r);if(s!==this._objects.length-1){const i=this.findNewUpperIndex(r,s,o);return Gd(this._objects,r),this._objects.splice(i,0,r),this._onStackOrderChanged(r),!0}return!1}moveObjectTo(r,o){return r!==this._objects[o]&&(Gd(this._objects,r),this._objects.splice(o,0,r),this._onStackOrderChanged(r),!0)}findNewLowerIndex(r,o,s){let i;if(s){i=o;for(let a=o-1;a>=0;--a)if(r.isOverlapping(this._objects[a])){i=a;break}}else i=o-1;return i}findNewUpperIndex(r,o,s){let i;if(s){i=o;for(let a=o+1;a<this._objects.length;++a)if(r.isOverlapping(this._objects[a])){i=a;break}}else i=o+1;return i}collectObjects(r){let{left:o,top:s,width:i,height:a}=r,{includeIntersecting:A=!0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const d=[],c=new zt(o,s),u=c.add(new zt(i,a));for(let h=this._objects.length-1;h>=0;h--){const p=this._objects[h];p.selectable&&p.visible&&(A&&p.intersectsWithRect(c,u)||p.isContainedWithinRect(c,u)||A&&p.containsPoint(c)||A&&p.containsPoint(u))&&d.push(p)}return d}}return e}let W5=class extends DF{_setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};for(const t in e)this.set(t,e[t])}_setObject(e){for(const t in e)this._set(t,e[t])}set(e,t){return typeof e=="object"?this._setObject(e):this._set(e,t),this}_set(e,t){this[e]=t}toggle(e){const t=this.get(e);return typeof t=="boolean"&&this.set(e,!t),this}get(e){return this[e]}};function tp(n){return x1().requestAnimationFrame(n)}function NF(n){return x1().cancelAnimationFrame(n)}let MF=0;const pl=()=>MF++,la=()=>{const n=Oc().createElement("canvas");if(!n||n.getContext===void 0)throw new Qa("Failed to create `canvas` element");return n},HF=()=>Oc().createElement("img"),ja=n=>{const e=la();return e.width=n.width,e.height=n.height,e},X5=(n,e,t)=>n.toDataURL("image/".concat(e),t),Uo=n=>n*B1,od=n=>n/B1,jF=n=>n.every((e,t)=>e===Rs[t]),Xs=(n,e,t)=>new zt(n).transform(e,t),sa=n=>{const e=1/(n[0]*n[3]-n[1]*n[2]),t=[e*n[3],-e*n[1],-e*n[2],e*n[0],0,0],{x:r,y:o}=new zt(n[4],n[5]).transform(t,!0);return t[4]=-r,t[5]=-o,t},us=(n,e,t)=>[n[0]*e[0]+n[2]*e[1],n[1]*e[0]+n[3]*e[1],n[0]*e[2]+n[2]*e[3],n[1]*e[2]+n[3]*e[3],t?0:n[0]*e[4]+n[2]*e[5]+n[4],t?0:n[1]*e[4]+n[3]*e[5]+n[5]],F1=(n,e)=>n.reduceRight((t,r)=>r&&t?us(r,t,e):r||t,void 0)||Rs.concat(),Y5=n=>{let[e,t]=n;return Math.atan2(t,e)},Ep=n=>{const e=Y5(n),t=Math.pow(n[0],2)+Math.pow(n[1],2),r=Math.sqrt(t),o=(n[0]*n[3]-n[2]*n[1])/r,s=Math.atan2(n[0]*n[2]+n[1]*n[3],t);return{angle:od(e),scaleX:r,scaleY:o,skewX:od(s),skewY:0,translateX:n[4]||0,translateY:n[5]||0}},ph=function(n){return[1,0,0,1,n,arguments.length>1&&arguments[1]!==void 0?arguments[1]:0]};function gh(){let{angle:n=0}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{x:e=0,y:t=0}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=Uo(n),o=BA(r),s=zA(r);return[o,s,-s,o,e?e-(o*e-s*t):0,t?t-(s*e+o*t):0]}const I1=function(n){return[n,0,0,arguments.length>1&&arguments[1]!==void 0?arguments[1]:n,0,0]},J5=n=>Math.tan(Uo(n)),Z5=n=>[1,0,J5(n),1,0,0],ex=n=>[1,J5(n),0,1,0,0],vg=n=>{let{scaleX:e=1,scaleY:t=1,flipX:r=!1,flipY:o=!1,skewX:s=0,skewY:i=0}=n,a=I1(r?-e:e,o?-t:t);return s&&(a=us(a,Z5(s),!0)),i&&(a=us(a,ex(i),!0)),a},RF=n=>{const{translateX:e=0,translateY:t=0,angle:r=0}=n;let o=ph(e,t);r&&(o=us(o,gh({angle:r})));const s=vg(n);return jF(s)||(o=us(o,s)),o},rp=function(n){let{signal:e,crossOrigin:t=null}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise(function(r,o){if(e&&e.aborted)return o(new QF("loadImage"));const s=HF();let i;e&&(i=function(A){s.src="",o(A)},e.addEventListener("abort",i,{once:!0}));const a=function(){s.onload=s.onerror=null,i&&(e==null||e.removeEventListener("abort",i)),r(s)};n?(s.onload=a,s.onerror=function(){i&&(e==null||e.removeEventListener("abort",i)),o(new Qa("Error loading ".concat(s.src)))},t&&(s.crossOrigin=t),s.src=n):a()})},Ju=function(n){let{signal:e,reviver:t=Zf}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((r,o)=>{const s=[];e&&e.addEventListener("abort",o,{once:!0}),Promise.all(n.map(i=>lr.getClass(i.type).fromObject(i,{signal:e}).then(a=>(t(i,a),s.push(a),a)))).then(r).catch(i=>{s.forEach(a=>{a.dispose&&a.dispose()}),o(i)}).finally(()=>{e&&e.removeEventListener("abort",o)})})},mg=function(n){let{signal:e}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Promise((t,r)=>{const o=[];e&&e.addEventListener("abort",r,{once:!0});const s=Object.values(n).map(a=>a&&a.type&&lr.has(a.type)?Ju([a],{signal:e}).then(A=>{let[d]=A;return o.push(d),d}):a),i=Object.keys(n);Promise.all(s).then(a=>a.reduce((A,d,c)=>(A[i[c]]=d,A),{})).then(t).catch(a=>{o.forEach(A=>{A.dispose&&A.dispose()}),r(a)}).finally(()=>{e&&e.removeEventListener("abort",r)})})},Mc=function(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:[]).reduce((e,t)=>(t in n&&(e[t]=n[t]),e),{})},U1=(n,e)=>Object.keys(n).reduce((t,r)=>(e(n[r],r,n)&&(t[r]=n[r]),t),{}),Fw={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#0FF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000",blanchedalmond:"#FFEBCD",blue:"#00F",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#0FF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#F0F",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#789",lightslategrey:"#789",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#0F0",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#F0F",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#639",red:"#F00",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFF",whitesmoke:"#F5F5F5",yellow:"#FF0",yellowgreen:"#9ACD32"},bv=(n,e,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+6*(e-n)*t:t<.5?e:t<2/3?n+(e-n)*(2/3-t)*6:n),Iw=(n,e,t,r)=>{n/=255,e/=255,t/=255;const o=Math.max(n,e,t),s=Math.min(n,e,t);let i,a;const A=(o+s)/2;if(o===s)i=a=0;else{const d=o-s;switch(a=A>.5?d/(2-o-s):d/(o+s),o){case n:i=(e-t)/d+(e<t?6:0);break;case e:i=(t-n)/d+2;break;case t:i=(n-e)/d+4}i/=6}return[Math.round(360*i),Math.round(100*a),Math.round(100*A),r]},Uw=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"1";return parseFloat(n)/(n.endsWith("%")?100:1)},Wh=n=>Math.min(Math.round(n),255).toString(16).toUpperCase().padStart(2,"0"),Qw=n=>{let[e,t,r,o=1]=n;const s=Math.round(.3*e+.59*t+.11*r);return[s,s,s,o]};let xi=class Bs{constructor(e){if(Xe(this,"isUnrecognised",!1),e)if(e instanceof Bs)this.setSource([...e._source]);else if(Array.isArray(e)){const[t,r,o,s=1]=e;this.setSource([t,r,o,s])}else this.setSource(this._tryParsingColor(e));else this.setSource([0,0,0,1])}_tryParsingColor(e){return(e=e.toLowerCase())in Fw&&(e=Fw[e]),e==="transparent"?[255,255,255,0]:Bs.sourceFromHex(e)||Bs.sourceFromRgb(e)||Bs.sourceFromHsl(e)||(this.isUnrecognised=!0)&&[0,0,0,1]}getSource(){return this._source}setSource(e){this._source=e}toRgb(){const[e,t,r]=this.getSource();return"rgb(".concat(e,",").concat(t,",").concat(r,")")}toRgba(){return"rgba(".concat(this.getSource().join(","),")")}toHsl(){const[e,t,r]=Iw(...this.getSource());return"hsl(".concat(e,",").concat(t,"%,").concat(r,"%)")}toHsla(){const[e,t,r,o]=Iw(...this.getSource());return"hsla(".concat(e,",").concat(t,"%,").concat(r,"%,").concat(o,")")}toHex(){return this.toHexa().slice(0,6)}toHexa(){const[e,t,r,o]=this.getSource();return"".concat(Wh(e)).concat(Wh(t)).concat(Wh(r)).concat(Wh(Math.round(255*o)))}getAlpha(){return this.getSource()[3]}setAlpha(e){return this._source[3]=e,this}toGrayscale(){return this.setSource(Qw(this.getSource())),this}toBlackWhite(e){const[t,,,r]=Qw(this.getSource()),o=t<(e||127)?0:255;return this.setSource([o,o,o,r]),this}overlayWith(e){e instanceof Bs||(e=new Bs(e));const t=this.getSource(),r=e.getSource(),[o,s,i]=t.map((a,A)=>Math.round(.5*a+.5*r[A]));return this.setSource([o,s,i,t[3]]),this}static fromRgb(e){return Bs.fromRgba(e)}static fromRgba(e){return new Bs(Bs.sourceFromRgb(e))}static sourceFromRgb(e){const t=e.match(/^rgba?\(\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d{0,3}(?:\.\d+)?%?)\s*)?\)$/i);if(t){const[r,o,s]=t.slice(1,4).map(i=>{const a=parseFloat(i);return i.endsWith("%")?Math.round(2.55*a):a});return[r,o,s,Uw(t[4])]}}static fromHsl(e){return Bs.fromHsla(e)}static fromHsla(e){return new Bs(Bs.sourceFromHsl(e))}static sourceFromHsl(e){const t=e.match(/^hsla?\(\s*([+-]?\d{0,3}(?:\.\d+)?(?:deg|turn|rad)?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*[\s|,]\s*(\d{0,3}(?:\.\d+)?%?)\s*(?:\s*[,/]\s*(\d*(?:\.\d+)?%?)\s*)?\)$/i);if(!t)return;const r=(Bs.parseAngletoDegrees(t[1])%360+360)%360/360,o=parseFloat(t[2])/100,s=parseFloat(t[3])/100;let i,a,A;if(o===0)i=a=A=s;else{const d=s<=.5?s*(o+1):s+o-s*o,c=2*s-d;i=bv(c,d,r+1/3),a=bv(c,d,r),A=bv(c,d,r-1/3)}return[Math.round(255*i),Math.round(255*a),Math.round(255*A),Uw(t[4])]}static fromHex(e){return new Bs(Bs.sourceFromHex(e))}static sourceFromHex(e){if(e.match(/^#?(([0-9a-f]){3,4}|([0-9a-f]{2}){3,4})$/i)){const t=e.slice(e.indexOf("#")+1);let r;r=t.length<=4?t.split("").map(A=>A+A):t.match(/.{2}/g);const[o,s,i,a=255]=r.map(A=>parseInt(A,16));return[o,s,i,a/255]}}static parseAngletoDegrees(e){const t=e.toLowerCase(),r=parseFloat(t);return t.includes("rad")?od(r):t.includes("turn")?360*r:r}};const uo=(n,e)=>parseFloat(Number(n).toFixed(e)),uc=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:z1;const t=/\D{0,2}$/.exec(n),r=parseFloat(n),o=mn.DPI;switch(t==null?void 0:t[0]){case"mm":return r*o/25.4;case"cm":return r*o/2.54;case"in":return r*o;case"pt":return r*o/72;case"pc":return r*o/72*12;case"em":return r*e;default:return r}},qF=n=>{const[e,t]=n.trim().split(" "),[r,o]=(s=e)&&s!==Zs?[s.slice(1,4),s.slice(5,8)]:s===Zs?[s,s]:["Mid","Mid"];var s;return{meetOrSlice:t||"meet",alignX:r,alignY:o}},Fp=n=>"matrix("+n.map(e=>uo(e,mn.NUM_FRACTION_DIGITS)).join(" ")+")",Zu=function(n,e){let t,r,o=!(arguments.length>2&&arguments[2]!==void 0)||arguments[2];if(e)if(e.toLive)t="url(#SVGID_".concat(e.id,")");else{const s=new xi(e),i=s.getAlpha();t=s.toRgb(),i!==1&&(r=i.toString())}else t="none";return o?"".concat(n,": ").concat(t,"; ").concat(r?"".concat(n,"-opacity: ").concat(r,"; "):""):"".concat(n,'="').concat(t,'" ').concat(r?"".concat(n,'-opacity="').concat(r,'" '):"")},Oi=n=>!!n&&n.toLive!==void 0,Tw=n=>!!n&&typeof n.toObject=="function",Lw=n=>!!n&&n.offsetX!==void 0&&"source"in n,Ll=n=>!!n&&"multiSelectionStacking"in n;function tx(n){const e=n&&oa(n);let t=0,r=0;if(!n||!e)return{left:t,top:r};let o=n;const s=e.documentElement,i=e.body||{scrollLeft:0,scrollTop:0};for(;o&&(o.parentNode||o.host)&&(o=o.parentNode||o.host,o===e?(t=i.scrollLeft||s.scrollLeft||0,r=i.scrollTop||s.scrollTop||0):(t+=o.scrollLeft||0,r+=o.scrollTop||0),o.nodeType!==1||o.style.position!=="fixed"););return{left:t,top:r}}const oa=n=>n.ownerDocument||null,rx=n=>{var e;return((e=n.ownerDocument)===null||e===void 0?void 0:e.defaultView)||null},nx=function(n,e,t){let{width:r,height:o}=t,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;n.width=r,n.height=o,s>1&&(n.setAttribute("width",(r*s).toString()),n.setAttribute("height",(o*s).toString()),e.scale(s,s))},j0=(n,e)=>{let{width:t,height:r}=e;t&&(n.style.width=typeof t=="number"?"".concat(t,"px"):t),r&&(n.style.height=typeof r=="number"?"".concat(r,"px"):r)};function Pw(n){return n.onselectstart!==void 0&&(n.onselectstart=()=>!1),n.style.userSelect=Zs,n}let ox=class{constructor(e){Xe(this,"_originalCanvasStyle",void 0),Xe(this,"lower",void 0);const t=this.createLowerCanvas(e);this.lower={el:t,ctx:t.getContext("2d")}}createLowerCanvas(e){const t=(r=e)&&r.getContext!==void 0?e:e&&Oc().getElementById(e)||la();var r;if(t.hasAttribute("data-fabric"))throw new Qa("Trying to initialize a canvas that has already been initialized. Did you forget to dispose the canvas?");return this._originalCanvasStyle=t.style.cssText,t.setAttribute("data-fabric","main"),t.classList.add("lower-canvas"),t}cleanupDOM(e){let{width:t,height:r}=e;const{el:o}=this.lower;o.classList.remove("lower-canvas"),o.removeAttribute("data-fabric"),o.setAttribute("width","".concat(t)),o.setAttribute("height","".concat(r)),o.style.cssText=this._originalCanvasStyle||"",this._originalCanvasStyle=void 0}setDimensions(e,t){const{el:r,ctx:o}=this.lower;nx(r,o,e,t)}setCSSDimensions(e){j0(this.lower.el,e)}calcOffset(){return function(e){var t;const r=e&&oa(e),o={left:0,top:0};if(!r)return o;const s=((t=rx(e))===null||t===void 0?void 0:t.getComputedStyle(e,null))||{};o.left+=parseInt(s.borderLeftWidth,10)||0,o.top+=parseInt(s.borderTopWidth,10)||0,o.left+=parseInt(s.paddingLeft,10)||0,o.top+=parseInt(s.paddingTop,10)||0;let i={left:0,top:0};const a=r.documentElement;e.getBoundingClientRect!==void 0&&(i=e.getBoundingClientRect());const A=tx(e);return{left:i.left+A.left-(a.clientLeft||0)+o.left,top:i.top+A.top-(a.clientTop||0)+o.top}}(this.lower.el)}dispose(){Ha().dispose(this.lower.el),delete this.lower}};const KF={backgroundVpt:!0,backgroundColor:"",overlayVpt:!0,overlayColor:"",includeDefaultValues:!0,svgViewportTransformation:!0,renderOnAddRemove:!0,skipOffscreen:!0,enableRetinaScaling:!0,imageSmoothingEnabled:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,viewportTransform:[...Rs]};let Q1=class sx extends G5(W5){get lowerCanvasEl(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.el}get contextContainer(){var e;return(e=this.elements.lower)===null||e===void 0?void 0:e.ctx}static getDefaults(){return sx.ownDefaults}constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,this.constructor.getDefaults()),this.set(t),this.initElements(e),this._setDimensionsImpl({width:this.width||this.elements.lower.el.width||0,height:this.height||this.elements.lower.el.height||0}),this.skipControlsDrawing=!1,this.viewportTransform=[...this.viewportTransform],this.calcViewportBoundaries()}initElements(e){this.elements=new ox(e)}add(){const e=super.add(...arguments);return arguments.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];const s=super.insertAt(e,...r);return r.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),s}remove(){const e=super.remove(...arguments);return e.length>0&&this.renderOnAddRemove&&this.requestRenderAll(),e}_onObjectAdded(e){e.canvas&&e.canvas!==this&&(fl("warn",`Canvas is trying to add an object that belongs to a different canvas.
Resulting to default behavior: removing object from previous canvas and adding to new canvas`),e.canvas.remove(e)),e._set("canvas",this),e.setCoords(),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e){e._set("canvas",void 0),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onStackOrderChanged(){this.renderOnAddRemove&&this.requestRenderAll()}getRetinaScaling(){return this.enableRetinaScaling?q5():1}calcOffset(){return this._offset=this.elements.calcOffset()}getWidth(){return this.width}getHeight(){return this.height}setWidth(e,t){return this.setDimensions({width:e},t)}setHeight(e,t){return this.setDimensions({height:e},t)}_setDimensionsImpl(e){let{cssOnly:t=!1,backstoreOnly:r=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!t){const o=Je({width:this.width,height:this.height},e);this.elements.setDimensions(o,this.getRetinaScaling()),this.hasLostContext=!0,this.width=o.width,this.height=o.height}r||this.elements.setCSSDimensions(e),this.calcOffset()}setDimensions(e,t){this._setDimensionsImpl(e,t),t&&t.cssOnly||this.requestRenderAll()}getZoom(){return this.viewportTransform[0]}setViewportTransform(e){this.viewportTransform=e,this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll()}zoomToPoint(e,t){const r=e,o=[...this.viewportTransform],s=Xs(e,sa(o));o[0]=t,o[3]=t;const i=Xs(s,o);o[4]+=r.x-i.x,o[5]+=r.y-i.y,this.setViewportTransform(o)}setZoom(e){this.zoomToPoint(new zt(0,0),e)}absolutePan(e){const t=[...this.viewportTransform];return t[4]=-e.x,t[5]=-e.y,this.setViewportTransform(t)}relativePan(e){return this.absolutePan(new zt(-e.x-this.viewportTransform[4],-e.y-this.viewportTransform[5]))}getElement(){return this.elements.lower.el}clearContext(e){e.clearRect(0,0,this.width,this.height)}getContext(){return this.elements.lower.ctx}clear(){this.remove(...this.getObjects()),this.backgroundImage=void 0,this.overlayImage=void 0,this.backgroundColor="",this.overlayColor="",this.clearContext(this.getContext()),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll()}renderAll(){this.cancelRequestedRender(),this.destroyed||this.renderCanvas(this.getContext(),this._objects)}renderAndReset(){this.nextRenderHandle=0,this.renderAll()}requestRenderAll(){this.nextRenderHandle||this.disposed||this.destroyed||(this.nextRenderHandle=tp(()=>this.renderAndReset()))}calcViewportBoundaries(){const e=this.width,t=this.height,r=sa(this.viewportTransform),o=Xs({x:0,y:0},r),s=Xs({x:e,y:t},r),i=o.min(s),a=o.max(s);return this.vptCoords={tl:i,tr:new zt(a.x,i.y),bl:new zt(i.x,a.y),br:a}}cancelRequestedRender(){this.nextRenderHandle&&(NF(this.nextRenderHandle),this.nextRenderHandle=0)}drawControls(e){}renderCanvas(e,t){if(this.destroyed)return;const r=this.viewportTransform,o=this.clipPath;this.calcViewportBoundaries(),this.clearContext(e),e.imageSmoothingEnabled=this.imageSmoothingEnabled,e.patternQuality="best",this.fire("before:render",{ctx:e}),this._renderBackground(e),e.save(),e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._renderObjects(e,t),e.restore(),this.controlsAboveOverlay||this.skipControlsDrawing||this.drawControls(e),o&&(o._set("canvas",this),o.shouldCache(),o._transformDone=!0,o.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(e,o)),this._renderOverlay(e),this.controlsAboveOverlay&&!this.skipControlsDrawing&&this.drawControls(e),this.fire("after:render",{ctx:e}),this.__cleanupTask&&(this.__cleanupTask(),this.__cleanupTask=void 0)}drawClipPathOnCanvas(e,t){const r=this.viewportTransform;e.save(),e.transform(...r),e.globalCompositeOperation="destination-in",t.transform(e),e.scale(1/t.zoomX,1/t.zoomY),e.drawImage(t._cacheCanvas,-t.cacheTranslationX,-t.cacheTranslationY),e.restore()}_renderObjects(e,t){for(let r=0,o=t.length;r<o;++r)t[r]&&t[r].render(e)}_renderBackgroundOrOverlay(e,t){const r=this["".concat(t,"Color")],o=this["".concat(t,"Image")],s=this.viewportTransform,i=this["".concat(t,"Vpt")];if(!r&&!o)return;const a=Oi(r);if(r){if(e.save(),e.beginPath(),e.moveTo(0,0),e.lineTo(this.width,0),e.lineTo(this.width,this.height),e.lineTo(0,this.height),e.closePath(),e.fillStyle=a?r.toLive(e):r,i&&e.transform(...s),a){e.transform(1,0,0,1,r.offsetX||0,r.offsetY||0);const A=r.gradientTransform||r.patternTransform;A&&e.transform(...A)}e.fill(),e.restore()}if(o){e.save();const{skipOffscreen:A}=this;this.skipOffscreen=i,i&&e.transform(...s),o.render(e),this.skipOffscreen=A,e.restore()}}_renderBackground(e){this._renderBackgroundOrOverlay(e,"background")}_renderOverlay(e){this._renderBackgroundOrOverlay(e,"overlay")}getCenter(){return{top:this.height/2,left:this.width/2}}getCenterPoint(){return new zt(this.width/2,this.height/2)}centerObjectH(e){return this._centerObject(e,new zt(this.getCenterPoint().x,e.getCenterPoint().y))}centerObjectV(e){return this._centerObject(e,new zt(e.getCenterPoint().x,this.getCenterPoint().y))}centerObject(e){return this._centerObject(e,this.getCenterPoint())}viewportCenterObject(e){return this._centerObject(e,this.getVpCenter())}viewportCenterObjectH(e){return this._centerObject(e,new zt(this.getVpCenter().x,e.getCenterPoint().y))}viewportCenterObjectV(e){return this._centerObject(e,new zt(e.getCenterPoint().x,this.getVpCenter().y))}getVpCenter(){return Xs(this.getCenterPoint(),sa(this.viewportTransform))}_centerObject(e,t){e.setXY(t,Gr,Gr),e.setCoords(),this.renderOnAddRemove&&this.requestRenderAll()}toDatalessJSON(e){return this.toDatalessObject(e)}toObject(e){return this._toObjectMethod("toObject",e)}toJSON(){return this.toObject()}toDatalessObject(e){return this._toObjectMethod("toDatalessObject",e)}_toObjectMethod(e,t){const r=this.clipPath,o=r&&!r.excludeFromExport?this._toObject(r,e,t):null;return Je(Je(Je({version:M0},Mc(this,t)),{},{objects:this._objects.filter(s=>!s.excludeFromExport).map(s=>this._toObject(s,e,t))},this.__serializeBgOverlay(e,t)),o?{clipPath:o}:null)}_toObject(e,t,r){let o;this.includeDefaultValues||(o=e.includeDefaultValues,e.includeDefaultValues=!1);const s=e[t](r);return this.includeDefaultValues||(e.includeDefaultValues=!!o),s}__serializeBgOverlay(e,t){const r={},o=this.backgroundImage,s=this.overlayImage,i=this.backgroundColor,a=this.overlayColor;return Oi(i)?i.excludeFromExport||(r.background=i.toObject(t)):i&&(r.background=i),Oi(a)?a.excludeFromExport||(r.overlay=a.toObject(t)):a&&(r.overlay=a),o&&!o.excludeFromExport&&(r.backgroundImage=this._toObject(o,e,t)),s&&!s.excludeFromExport&&(r.overlayImage=this._toObject(s,e,t)),r}toSVG(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;e.reviver=t;const r=[];return this._setSVGPreamble(r,e),this._setSVGHeader(r,e),this.clipPath&&r.push('<g clip-path="url(#'.concat(this.clipPath.clipPathId,`)" >
`)),this._setSVGBgOverlayColor(r,"background"),this._setSVGBgOverlayImage(r,"backgroundImage",t),this._setSVGObjects(r,t),this.clipPath&&r.push(`</g>
`),this._setSVGBgOverlayColor(r,"overlay"),this._setSVGBgOverlayImage(r,"overlayImage",t),r.push("</svg>"),r.join("")}_setSVGPreamble(e,t){t.suppressPreamble||e.push('<?xml version="1.0" encoding="',t.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)}_setSVGHeader(e,t){const r=t.width||"".concat(this.width),o=t.height||"".concat(this.height),s=mn.NUM_FRACTION_DIGITS,i=t.viewBox;let a;if(i)a='viewBox="'.concat(i.x," ").concat(i.y," ").concat(i.width," ").concat(i.height,'" ');else if(this.svgViewportTransformation){const A=this.viewportTransform;a='viewBox="'.concat(uo(-A[4]/A[0],s)," ").concat(uo(-A[5]/A[3],s)," ").concat(uo(this.width/A[0],s)," ").concat(uo(this.height/A[3],s),'" ')}else a='viewBox="0 0 '.concat(this.width," ").concat(this.height,'" ');e.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',r,'" ','height="',o,'" ',a,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",M0,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(t),`</defs>
`)}createSVGClipPathMarkup(e){const t=this.clipPath;return t?(t.clipPathId="CLIPPATH_".concat(pl()),'<clipPath id="'.concat(t.clipPathId,`" >
`).concat(t.toClipPathSVG(e.reviver),`</clipPath>
`)):""}createSVGRefElementsMarkup(){return["background","overlay"].map(e=>{const t=this["".concat(e,"Color")];if(Oi(t)){const r=this["".concat(e,"Vpt")],o=this.viewportTransform,s={isType:()=>!1,width:this.width/(r?o[0]:1),height:this.height/(r?o[3]:1)};return t.toSVG(s,{additionalTransform:r?Fp(o):""})}}).join("")}createSVGFontFacesMarkup(){const e=[],t={},r=mn.fontPaths;this._objects.forEach(function s(i){e.push(i),ep(i)&&i._objects.forEach(s)}),e.forEach(s=>{if(!(i=s)||typeof i._renderText!="function")return;var i;const{styles:a,fontFamily:A}=s;!t[A]&&r[A]&&(t[A]=!0,a&&Object.values(a).forEach(d=>{Object.values(d).forEach(c=>{let{fontFamily:u=""}=c;!t[u]&&r[u]&&(t[u]=!0)})}))});const o=Object.keys(t).map(s=>`		@font-face {
			font-family: '`.concat(s,`';
			src: url('`).concat(r[s],`');
		}
`)).join("");return o?`	<style type="text/css"><![CDATA[
`.concat(o,`]]></style>
`):""}_setSVGObjects(e,t){this.forEachObject(r=>{r.excludeFromExport||this._setSVGObject(e,r,t)})}_setSVGObject(e,t,r){e.push(t.toSVG(r))}_setSVGBgOverlayImage(e,t,r){const o=this[t];o&&!o.excludeFromExport&&o.toSVG&&e.push(o.toSVG(r))}_setSVGBgOverlayColor(e,t){const r=this["".concat(t,"Color")];if(r)if(Oi(r)){const o=r.repeat||"",s=this.width,i=this.height,a=this["".concat(t,"Vpt")]?Fp(sa(this.viewportTransform)):"";e.push('<rect transform="'.concat(a," translate(").concat(s/2,",").concat(i/2,')" x="').concat(r.offsetX-s/2,'" y="').concat(r.offsetY-i/2,'" width="').concat(o!=="repeat-y"&&o!=="no-repeat"||!Lw(r)?s:r.source.width,'" height="').concat(o!=="repeat-x"&&o!=="no-repeat"||!Lw(r)?i:r.source.height,'" fill="url(#SVGID_').concat(r.id,`)"></rect>
`))}else e.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',r,'"',`></rect>
`)}loadFromJSON(e,t){let{signal:r}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!e)return Promise.reject(new Qa("`json` is undefined"));const o=typeof e=="string"?JSON.parse(e):e,{objects:s=[],backgroundImage:i,background:a,overlayImage:A,overlay:d,clipPath:c}=o,u=this.renderOnAddRemove;return this.renderOnAddRemove=!1,Promise.all([Ju(s,{reviver:t,signal:r}),mg({backgroundImage:i,backgroundColor:a,overlayImage:A,overlayColor:d,clipPath:c},{signal:r})]).then(h=>{let[p,v]=h;return this.clear(),this.add(...p),this.set(o),this.set(v),this.renderOnAddRemove=u,this})}clone(e){const t=this.toObject(e);return this.cloneWithoutData().loadFromJSON(t)}cloneWithoutData(){const e=ja(this);return new this.constructor(e)}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const{format:t="png",quality:r=1,multiplier:o=1,enableRetinaScaling:s=!1}=e,i=o*(s?this.getRetinaScaling():1);return X5(this.toCanvasElement(i,e),t,r)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,{width:t,height:r,left:o,top:s,filter:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const a=(t||this.width)*e,A=(r||this.height)*e,d=this.getZoom(),c=this.width,u=this.height,h=this.skipControlsDrawing,p=d*e,v=this.viewportTransform,w=[p,0,0,p,(v[4]-(o||0))*e,(v[5]-(s||0))*e],y=this.enableRetinaScaling,B=ja({width:a,height:A}),C=i?this._objects.filter(Q=>i(Q)):this._objects;return this.enableRetinaScaling=!1,this.viewportTransform=w,this.width=a,this.height=A,this.skipControlsDrawing=!0,this.calcViewportBoundaries(),this.renderCanvas(B.getContext("2d"),C),this.viewportTransform=v,this.width=c,this.height=u,this.calcViewportBoundaries(),this.enableRetinaScaling=y,this.skipControlsDrawing=h,B}dispose(){return!this.disposed&&this.elements.cleanupDOM({width:this.width,height:this.height}),Sp.cancelByCanvas(this),this.disposed=!0,new Promise((e,t)=>{const r=()=>{this.destroy(),e(!0)};r.kill=t,this.__cleanupTask&&this.__cleanupTask.kill("aborted"),this.destroyed?e(!1):this.nextRenderHandle?this.__cleanupTask=r:r()})}destroy(){this.destroyed=!0,this.cancelRequestedRender(),this.forEachObject(e=>e.dispose()),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose(),this.backgroundImage=void 0,this.overlayImage&&this.overlayImage.dispose(),this.overlayImage=void 0,this.elements.dispose()}toString(){return"#<Canvas (".concat(this.complexity(),"): { objects: ").concat(this._objects.length," }>")}};Xe(Q1,"ownDefaults",KF);const $F=["touchstart","touchmove","touchend"],VF=n=>{const e=tx(n.target),t=function(r){const o=r.changedTouches;return o&&o[0]?o[0]:r}(n);return new zt(t.clientX+e.left,t.clientY+e.top)},R0=n=>$F.includes(n.type)||n.pointerType==="touch",q0=n=>{n.preventDefault(),n.stopPropagation()},yA=n=>{let e=0,t=0,r=0,o=0;for(let s=0,i=n.length;s<i;s++){const{x:a,y:A}=n[s];(a>r||!s)&&(r=a),(a<e||!s)&&(e=a),(A>o||!s)&&(o=A),(A<t||!s)&&(t=A)}return{left:e,top:t,width:r-e,height:o-t}},GF=["translateX","translateY","scaleX","scaleY"],WF=(n,e)=>Ip(n,us(e,n.calcOwnMatrix())),Ip=(n,e)=>{const t=Ep(e),{translateX:r,translateY:o,scaleX:s,scaleY:i}=t,a=so(t,GF),A=new zt(r,o);n.flipX=!1,n.flipY=!1,Object.assign(n,a),n.set({scaleX:s,scaleY:i}),n.setPositionByOrigin(A,Gr,Gr)},XF=n=>{n.scaleX=1,n.scaleY=1,n.skewX=0,n.skewY=0,n.flipX=!1,n.flipY=!1,n.rotate(0)},ix=n=>({scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,angle:n.angle,left:n.left,flipX:n.flipX,flipY:n.flipY,top:n.top}),T1=(n,e,t)=>{const r=n/2,o=e/2,s=[new zt(-r,-o),new zt(r,-o),new zt(-r,o),new zt(r,o)].map(a=>a.transform(t)),i=yA(s);return new zt(i.width,i.height)},wg=function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Rs;return us(sa(arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rs),n)},hc=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rs,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Rs;return n.transform(wg(e,t))},YF=function(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rs,t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Rs;return n.transform(wg(e,t),!0)},JF=(n,e,t)=>{const r=wg(e,t);return Ip(n,us(r,n.calcOwnMatrix())),r},ax=(n,e)=>{var t;const{transform:{target:r}}=e;(t=r.canvas)===null||t===void 0||t.fire("object:".concat(n),Je(Je({},e),{},{target:r})),r.fire(n,e)},ZF={left:-.5,top:-.5,center:0,bottom:.5,right:.5},Oo=n=>typeof n=="string"?ZF[n]:n-.5,Up="not-allowed";function Ax(n){return Oo(n.originX)===Oo(Gr)&&Oo(n.originY)===Oo(Gr)}function kw(n){return .5-Oo(n)}const aa=(n,e)=>n[e],lx=(n,e,t,r)=>({e:n,transform:e,pointer:new zt(t,r)});function dx(n,e){const t=n.getTotalAngle()+od(Math.atan2(e.y,e.x))+360;return Math.round(t%360/45)}function L1(n,e,t,r,o){var s;let{target:i,corner:a}=n;const A=i.controls[a],d=((s=i.canvas)===null||s===void 0?void 0:s.getZoom())||1,c=i.padding/d,u=function(h,p,v,w){const y=h.getRelativeCenterPoint(),B=v!==void 0&&w!==void 0?h.translateToGivenOrigin(y,Gr,Gr,v,w):new zt(h.left,h.top);return(h.angle?p.rotate(-Uo(h.angle),y):p).subtract(B)}(i,new zt(r,o),e,t);return u.x>=c&&(u.x-=c),u.x<=-c&&(u.x+=c),u.y>=c&&(u.y-=c),u.y<=c&&(u.y+=c),u.x-=A.offsetX,u.y-=A.offsetY,u}const eI=(n,e,t,r)=>{const{target:o,offsetX:s,offsetY:i}=e,a=t-s,A=r-i,d=!aa(o,"lockMovementX")&&o.left!==a,c=!aa(o,"lockMovementY")&&o.top!==A;return d&&o.set(zn,a),c&&o.set(Js,A),(d||c)&&ax(K5,lx(n,e,t,r)),d||c};class cx{getSvgStyles(e){const t=this.fillRule?this.fillRule:"nonzero",r=this.strokeWidth?this.strokeWidth:"0",o=this.strokeDashArray?this.strokeDashArray.join(" "):Zs,s=this.strokeDashOffset?this.strokeDashOffset:"0",i=this.strokeLineCap?this.strokeLineCap:"butt",a=this.strokeLineJoin?this.strokeLineJoin:"miter",A=this.strokeMiterLimit?this.strokeMiterLimit:"4",d=this.opacity!==void 0?this.opacity:"1",c=this.visible?"":" visibility: hidden;",u=e?"":this.getSvgFilter(),h=Zu(Ko,this.fill);return[Zu(ei,this.stroke),"stroke-width: ",r,"; ","stroke-dasharray: ",o,"; ","stroke-linecap: ",i,"; ","stroke-dashoffset: ",s,"; ","stroke-linejoin: ",a,"; ","stroke-miterlimit: ",A,"; ",h,"fill-rule: ",t,"; ","opacity: ",d,";",u,c].join("")}getSvgFilter(){return this.shadow?"filter: url(#SVGID_".concat(this.shadow.id,");"):""}getSvgCommons(){return[this.id?'id="'.concat(this.id,'" '):"",this.clipPath?'clip-path="url(#'.concat(this.clipPath.clipPathId,')" '):""].join("")}getSvgTransform(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const r=e?this.calcTransformMatrix():this.calcOwnMatrix(),o='transform="'.concat(Fp(r));return"".concat(o).concat(t,'" ')}_toSVG(e){return[""]}toSVG(e){return this._createBaseSVGMarkup(this._toSVG(e),{reviver:e})}toClipPathSVG(e){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(e),{reviver:e})}_createBaseClipPathSVGMarkup(e){let{reviver:t,additionalTransform:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const o=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),s=e.indexOf("COMMON_PARTS");return e[s]=o,t?t(e.join("")):e.join("")}_createBaseSVGMarkup(e){let{noStyle:t,reviver:r,withShadow:o,additionalTransform:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const i=t?"":'style="'.concat(this.getSvgStyles(),'" '),a=o?'style="'.concat(this.getSvgFilter(),'" '):"",A=this.clipPath,d=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",c=A&&A.absolutePositioned,u=this.stroke,h=this.fill,p=this.shadow,v=[],w=e.indexOf("COMMON_PARTS");let y;A&&(A.clipPathId="CLIPPATH_".concat(pl()),y='<clipPath id="'.concat(A.clipPathId,`" >
`).concat(A.toClipPathSVG(r),`</clipPath>
`)),c&&v.push("<g ",a,this.getSvgCommons(),` >
`),v.push("<g ",this.getSvgTransform(!1),c?"":a+this.getSvgCommons(),` >
`);const B=[i,d,t?"":this.addPaintOrder()," ",s?'transform="'.concat(s,'" '):""].join("");return e[w]=B,Oi(h)&&v.push(h.toSVG(this)),Oi(u)&&v.push(u.toSVG(this)),p&&v.push(p.toSVG(this)),A&&v.push(y),v.push(e.join("")),v.push(`</g>
`),c&&v.push(`</g>
`),r?r(v.join("")):v.join("")}addPaintOrder(){return this.paintFirst!==Ko?' paint-order="'.concat(this.paintFirst,'" '):""}}function yg(n){return new RegExp("^("+n.join("|")+")\\b","i")}var Ow;const sd=String.raw(Ow||(Ow=wl(["(?:[-+]?(?:d*.d+|d+.?)(?:[eE][-+]?d+)?)"],["(?:[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?)"]))),tI=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+sd+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+sd+"))?\\s+(.*)"),rI={cx:zn,x:zn,r:"radius",cy:Js,y:Js,display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},xv="font-size",Bv="clip-path";yg(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]);yg(["symbol","image","marker","pattern","view","svg"]);const Dw=yg(["symbol","g","a","svg","clipPath","defs"]),nI=new zt(1,0),ux=new zt,hx=(n,e)=>n.rotate(e),K0=(n,e)=>new zt(e).subtract(n),$0=n=>n.distanceFrom(ux),V0=(n,e)=>Math.atan2(Fu(n,e),sI(n,e)),oI=n=>V0(nI,n),P1=n=>n.eq(ux)?n:n.scalarDivide($0(n)),fx=function(n){let e=!(arguments.length>1&&arguments[1]!==void 0)||arguments[1];return P1(new zt(-n.y,n.x).scalarMultiply(e?1:-1))},Fu=(n,e)=>n.x*e.y-n.y*e.x,sI=(n,e)=>n.x*e.x+n.y*e.y,Nw=(n,e,t)=>{if(n.eq(e)||n.eq(t))return!0;const r=Fu(e,t),o=Fu(e,n),s=Fu(t,n);return r>=0?o>=0&&s<=0:!(o<=0&&s>=0)},Mw="(-?\\d+(?:\\.\\d*)?(?:px)?(?:\\s?|$))?",Hw=new RegExp("(?:\\s|^)"+Mw+Mw+"("+sd+"?(?:px)?)?(?:\\s?|$)(?:$|\\s)");class _A{constructor(e){const t=typeof e=="string"?_A.parseShadow(e):e;Object.assign(this,_A.ownDefaults,t),this.id=pl()}static parseShadow(e){const t=e.trim(),[,r=0,o=0,s=0]=(Hw.exec(t)||[]).map(i=>parseFloat(i)||0);return{color:(t.replace(Hw,"")||"rgb(0,0,0)").trim(),offsetX:r,offsetY:o,blur:s}}toString(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")}toSVG(e){const t=hx(new zt(this.offsetX,this.offsetY),Uo(-e.angle)),r=new xi(this.color);let o=40,s=40;return e.width&&e.height&&(o=100*uo((Math.abs(t.x)+this.blur)/e.width,mn.NUM_FRACTION_DIGITS)+20,s=100*uo((Math.abs(t.y)+this.blur)/e.height,mn.NUM_FRACTION_DIGITS)+20),e.flipX&&(t.x*=-1),e.flipY&&(t.y*=-1),'<filter id="SVGID_'.concat(this.id,'" y="-').concat(s,'%" height="').concat(100+2*s,'%" x="-').concat(o,'%" width="').concat(100+2*o,`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`).concat(uo(this.blur?this.blur/2:0,mn.NUM_FRACTION_DIGITS),`"></feGaussianBlur>
	<feOffset dx="`).concat(uo(t.x,mn.NUM_FRACTION_DIGITS),'" dy="').concat(uo(t.y,mn.NUM_FRACTION_DIGITS),`" result="oBlur" ></feOffset>
	<feFlood flood-color="`).concat(r.toRgb(),'" flood-opacity="').concat(r.getAlpha(),`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`)}toObject(){const e={color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling,type:this.constructor.type},t=_A.ownDefaults;return this.includeDefaultValues?e:U1(e,(r,o)=>r!==t[o])}static async fromObject(e){return new this(e)}}Xe(_A,"ownDefaults",{color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1}),Xe(_A,"type","shadow"),lr.setClass(_A,"shadow");const Cc=(n,e,t)=>Math.max(n,Math.min(e,t)),iI=[Js,zn,oi,Hi,"flipX","flipY","originX","originY","angle","opacity","globalCompositeOperation","shadow","visible",Dc,Nc],EA=[Ko,ei,"strokeWidth","strokeDashArray","width","height","paintFirst","strokeUniform","strokeLineCap","strokeDashOffset","strokeLineJoin","strokeMiterLimit","backgroundColor","clipPath"],aI={top:0,left:0,width:0,height:0,angle:0,flipX:!1,flipY:!1,scaleX:1,scaleY:1,minScaleLimit:0,skewX:0,skewY:0,originX:zn,originY:Js,strokeWidth:1,strokeUniform:!1,padding:0,opacity:1,paintFirst:Ko,fill:"rgb(0,0,0)",fillRule:"nonzero",stroke:null,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,globalCompositeOperation:"source-over",backgroundColor:"",shadow:null,visible:!0,includeDefaultValues:!0,excludeFromExport:!1,objectCaching:!0,clipPath:void 0,inverted:!1,absolutePositioned:!1,centeredRotation:!0,centeredScaling:!1,dirty:!0},AI=(n,e,t,r)=>-t*Math.cos(n/r*fh)+t+e,lI=()=>!1;class k1{constructor(e){let{startValue:t,byValue:r,duration:o=500,delay:s=0,easing:i=AI,onStart:a=Zf,onChange:A=Zf,onComplete:d=Zf,abort:c=lI,target:u}=e;Xe(this,"_state","pending"),Xe(this,"durationProgress",0),Xe(this,"valueProgress",0),this.tick=this.tick.bind(this),this.duration=o,this.delay=s,this.easing=i,this._onStart=a,this._onChange=A,this._onComplete=d,this._abort=c,this.target=u,this.startValue=t,this.byValue=r,this.value=this.startValue,this.endValue=Object.freeze(this.calculate(this.duration).value)}get state(){return this._state}isDone(){return this._state==="aborted"||this._state==="completed"}start(){const e=t=>{this._state==="pending"&&(this.startTime=t||+new Date,this._state="running",this._onStart(),this.tick(this.startTime))};this.register(),this.delay>0?setTimeout(()=>tp(e),this.delay):tp(e)}tick(e){const t=(e||+new Date)-this.startTime,r=Math.min(t,this.duration);this.durationProgress=r/this.duration;const{value:o,valueProgress:s}=this.calculate(r);this.value=Object.freeze(o),this.valueProgress=s,this._state!=="aborted"&&(this._abort(this.value,this.valueProgress,this.durationProgress)?(this._state="aborted",this.unregister()):t>=this.duration?(this.durationProgress=this.valueProgress=1,this._onChange(this.endValue,this.valueProgress,this.durationProgress),this._state="completed",this._onComplete(this.endValue,this.valueProgress,this.durationProgress),this.unregister()):(this._onChange(this.value,this.valueProgress,this.durationProgress),tp(this.tick)))}register(){Sp.push(this)}unregister(){Sp.remove(this)}abort(){this._state="aborted",this.unregister()}}const dI=["startValue","endValue"];class cI extends k1{constructor(e){let{startValue:t=0,endValue:r=100}=e;super(Je(Je({},so(e,dI)),{},{startValue:t,byValue:r-t}))}calculate(e){const t=this.easing(e,this.startValue,this.byValue,this.duration);return{value:t,valueProgress:Math.abs((t-this.startValue)/this.byValue)}}}const uI=["startValue","endValue"];class hI extends k1{constructor(e){let{startValue:t=[0],endValue:r=[100]}=e;super(Je(Je({},so(e,uI)),{},{startValue:t,byValue:r.map((o,s)=>o-t[s])}))}calculate(e){const t=this.startValue.map((r,o)=>this.easing(e,r,this.byValue[o],this.duration,o));return{value:t,valueProgress:Math.abs((t[0]-this.startValue[0])/this.byValue[0])}}}const fI=["startValue","endValue","easing","onChange","onComplete","abort"],pI=(n,e,t,r)=>e+t*(1-Math.cos(n/r*fh)),zv=n=>n&&((e,t,r)=>n(new xi(e).toRgba(),t,r));class gI extends k1{constructor(e){let{startValue:t,endValue:r,easing:o=pI,onChange:s,onComplete:i,abort:a}=e,A=so(e,fI);const d=new xi(t).getSource(),c=new xi(r).getSource();super(Je(Je({},A),{},{startValue:d,byValue:c.map((u,h)=>u-d[h]),easing:o,onChange:zv(s),onComplete:zv(i),abort:zv(a)}))}calculate(e){const[t,r,o,s]=this.startValue.map((a,A)=>this.easing(e,a,this.byValue[A],this.duration,A)),i=[...[t,r,o].map(Math.round),Cc(0,s,1)];return{value:i,valueProgress:i.map((a,A)=>this.byValue[A]!==0?Math.abs((a-this.startValue[A])/this.byValue[A]):0).find(a=>a!==0)||0}}}function px(n){const e=(t=>Array.isArray(t.startValue)||Array.isArray(t.endValue))(n)?new hI(n):new cI(n);return e.start(),e}function vI(n){const e=new gI(n);return e.start(),e}class co{constructor(e){this.status=e,this.points=[]}includes(e){return this.points.some(t=>t.eq(e))}append(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.points=this.points.concat(t.filter(o=>!this.includes(o))),this}static isPointContained(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0&&arguments[3];if(t.eq(r))return e.eq(t);if(t.x===r.x)return e.x===t.x&&(o||e.y>=Math.min(t.y,r.y)&&e.y<=Math.max(t.y,r.y));if(t.y===r.y)return e.y===t.y&&(o||e.x>=Math.min(t.x,r.x)&&e.x<=Math.max(t.x,r.x));{const s=K0(t,r),i=K0(t,e).divide(s);return o?Math.abs(i.x)===Math.abs(i.y):i.x===i.y&&i.x>=0&&i.x<=1}}static isPointInPolygon(e,t){const r=new zt(e).setX(Math.min(e.x-1,...t.map(s=>s.x)));let o=0;for(let s=0;s<t.length;s++){const i=this.intersectSegmentSegment(t[s],t[(s+1)%t.length],e,r);if(i.includes(e))return!0;o+=+(i.status==="Intersection")}return o%2==1}static intersectLineLine(e,t,r,o){let s=!(arguments.length>4&&arguments[4]!==void 0)||arguments[4],i=!(arguments.length>5&&arguments[5]!==void 0)||arguments[5];const a=t.x-e.x,A=t.y-e.y,d=o.x-r.x,c=o.y-r.y,u=e.x-r.x,h=e.y-r.y,p=d*h-c*u,v=a*h-A*u,w=c*a-d*A;if(w!==0){const y=p/w,B=v/w;return(s||0<=y&&y<=1)&&(i||0<=B&&B<=1)?new co("Intersection").append(new zt(e.x+y*a,e.y+y*A)):new co}if(p===0||v===0){const y=s||i||co.isPointContained(e,r,o)||co.isPointContained(t,r,o)||co.isPointContained(r,e,t)||co.isPointContained(o,e,t);return new co(y?"Coincident":void 0)}return new co("Parallel")}static intersectSegmentLine(e,t,r,o){return co.intersectLineLine(e,t,r,o,!1,!0)}static intersectSegmentSegment(e,t,r,o){return co.intersectLineLine(e,t,r,o,!1,!1)}static intersectLinePolygon(e,t,r){let o=!(arguments.length>3&&arguments[3]!==void 0)||arguments[3];const s=new co,i=r.length;for(let a,A,d,c=0;c<i;c++){if(a=r[c],A=r[(c+1)%i],d=co.intersectLineLine(e,t,a,A,o,!1),d.status==="Coincident")return d;s.append(...d.points)}return s.points.length>0&&(s.status="Intersection"),s}static intersectSegmentPolygon(e,t,r){return co.intersectLinePolygon(e,t,r,!1)}static intersectPolygonPolygon(e,t){const r=new co,o=e.length,s=[];for(let i=0;i<o;i++){const a=e[i],A=e[(i+1)%o],d=co.intersectSegmentPolygon(a,A,t);d.status==="Coincident"?(s.push(d),r.append(a,A)):r.append(...d.points)}return s.length>0&&s.length===e.length?new co("Coincident"):(r.points.length>0&&(r.status="Intersection"),r)}static intersectPolygonRectangle(e,t,r){const o=t.min(r),s=t.max(r),i=new zt(s.x,o.y),a=new zt(o.x,s.y);return co.intersectPolygonPolygon(e,[o,i,s,a])}}class mI extends W5{getX(){return this.getXY().x}setX(e){this.setXY(this.getXY().setX(e))}getY(){return this.getXY().y}setY(e){this.setXY(this.getXY().setY(e))}getRelativeX(){return this.left}setRelativeX(e){this.left=e}getRelativeY(){return this.top}setRelativeY(e){this.top=e}getXY(){const e=this.getRelativeXY();return this.group?Xs(e,this.group.calcTransformMatrix()):e}setXY(e,t,r){this.group&&(e=Xs(e,sa(this.group.calcTransformMatrix()))),this.setRelativeXY(e,t,r)}getRelativeXY(){return new zt(this.left,this.top)}setRelativeXY(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.originX,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.originY;this.setPositionByOrigin(e,t,r)}isStrokeAccountedForInDimensions(){return!1}getCoords(){const{tl:e,tr:t,br:r,bl:o}=this.aCoords||(this.aCoords=this.calcACoords()),s=[e,t,r,o];if(this.group){const i=this.group.calcTransformMatrix();return s.map(a=>Xs(a,i))}return s}intersectsWithRect(e,t){return co.intersectPolygonRectangle(this.getCoords(),e,t).status==="Intersection"}intersectsWithObject(e){const t=co.intersectPolygonPolygon(this.getCoords(),e.getCoords());return t.status==="Intersection"||t.status==="Coincident"||e.isContainedWithinObject(this)||this.isContainedWithinObject(e)}isContainedWithinObject(e){return this.getCoords().every(t=>e.containsPoint(t))}isContainedWithinRect(e,t){const{left:r,top:o,width:s,height:i}=this.getBoundingRect();return r>=e.x&&r+s<=t.x&&o>=e.y&&o+i<=t.y}isOverlapping(e){return this.intersectsWithObject(e)||this.isContainedWithinObject(e)||e.isContainedWithinObject(this)}containsPoint(e){return co.isPointInPolygon(e,this.getCoords())}isOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return!!this.getCoords().some(r=>r.x<=t.x&&r.x>=e.x&&r.y<=t.y&&r.y>=e.y)||!!this.intersectsWithRect(e,t)||this.containsPoint(e.midPointFrom(t))}isPartiallyOnScreen(){if(!this.canvas)return!1;const{tl:e,br:t}=this.canvas.vptCoords;return this.intersectsWithRect(e,t)?!0:this.getCoords().every(r=>(r.x>=t.x||r.x<=e.x)&&(r.y>=t.y||r.y<=e.y))&&this.containsPoint(e.midPointFrom(t))}getBoundingRect(){return yA(this.getCoords())}getScaledWidth(){return this._getTransformedDimensions().x}getScaledHeight(){return this._getTransformedDimensions().y}scale(e){this._set(oi,e),this._set(Hi,e),this.setCoords()}scaleToWidth(e){const t=this.getBoundingRect().width/this.getScaledWidth();return this.scale(e/this.width/t)}scaleToHeight(e){const t=this.getBoundingRect().height/this.getScaledHeight();return this.scale(e/this.height/t)}getCanvasRetinaScaling(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.getRetinaScaling())||1}getTotalAngle(){return this.group?od(Y5(this.calcTransformMatrix())):this.angle}getViewportTransform(){var e;return((e=this.canvas)===null||e===void 0?void 0:e.viewportTransform)||Rs.concat()}calcACoords(){const e=gh({angle:this.angle}),{x:t,y:r}=this.getRelativeCenterPoint(),o=ph(t,r),s=us(o,e),i=this._getTransformedDimensions(),a=i.x/2,A=i.y/2;return{tl:Xs({x:-a,y:-A},s),tr:Xs({x:a,y:-A},s),bl:Xs({x:-a,y:A},s),br:Xs({x:a,y:A},s)}}setCoords(){this.aCoords=this.calcACoords()}transformMatrixKey(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=[];return!e&&this.group&&(t=this.group.transformMatrixKey(e)),t.push(this.top,this.left,this.width,this.height,this.scaleX,this.scaleY,this.angle,this.strokeWidth,this.skewX,this.skewY,+this.flipX,+this.flipY,Oo(this.originX),Oo(this.originY)),t}calcTransformMatrix(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0],t=this.calcOwnMatrix();if(e||!this.group)return t;const r=this.transformMatrixKey(e),o=this.matrixCache;return o&&o.key.every((s,i)=>s===r[i])?o.value:(this.group&&(t=us(this.group.calcTransformMatrix(!1),t)),this.matrixCache={key:r,value:t},t)}calcOwnMatrix(){const e=this.transformMatrixKey(!0),t=this.ownMatrixCache;if(t&&t.key===e)return t.value;const r=this.getRelativeCenterPoint(),o={angle:this.angle,translateX:r.x,translateY:r.y,scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY},s=RF(o);return this.ownMatrixCache={key:e,value:s},s}_getNonTransformedDimensions(){return new zt(this.width,this.height).scalarAdd(this.strokeWidth)}_calculateCurrentDimensions(e){return this._getTransformedDimensions(e).transform(this.getViewportTransform(),!0).scalarAdd(2*this.padding)}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=Je({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,width:this.width,height:this.height,strokeWidth:this.strokeWidth},e),r=t.strokeWidth;let o=r,s=0;this.strokeUniform&&(o=0,s=r);const i=t.width+o,a=t.height+o;let A;return A=t.skewX===0&&t.skewY===0?new zt(i*t.scaleX,a*t.scaleY):T1(i,a,vg(t)),A.scalarAdd(s)}translateToGivenOrigin(e,t,r,o,s){let i=e.x,a=e.y;const A=Oo(o)-Oo(t),d=Oo(s)-Oo(r);if(A||d){const c=this._getTransformedDimensions();i+=A*c.x,a+=d*c.y}return new zt(i,a)}translateToCenterPoint(e,t,r){if(t===Gr&&r===Gr)return e;const o=this.translateToGivenOrigin(e,t,r,Gr,Gr);return this.angle?o.rotate(Uo(this.angle),e):o}translateToOriginPoint(e,t,r){const o=this.translateToGivenOrigin(e,Gr,Gr,t,r);return this.angle?o.rotate(Uo(this.angle),e):o}getCenterPoint(){const e=this.getRelativeCenterPoint();return this.group?Xs(e,this.group.calcTransformMatrix()):e}getRelativeCenterPoint(){return this.translateToCenterPoint(new zt(this.left,this.top),this.originX,this.originY)}getPointByOrigin(e,t){return this.translateToOriginPoint(this.getRelativeCenterPoint(),e,t)}setPositionByOrigin(e,t,r){const o=this.translateToCenterPoint(e,t,r),s=this.translateToOriginPoint(o,this.originX,this.originY);this.set({left:s.x,top:s.y})}_getLeftTopCoords(){return this.translateToOriginPoint(this.getRelativeCenterPoint(),zn,Js)}}const wI=["type"],yI=["extraParam"];let dA=class np extends mI{static getDefaults(){return np.ownDefaults}get type(){const e=this.constructor.type;return e==="FabricObject"?"object":e.toLowerCase()}set type(e){fl("warn","Setting type has no effect",e)}constructor(e){super(),Xe(this,"_cacheContext",null),Object.assign(this,np.ownDefaults),this.setOptions(e)}_createCacheCanvas(){this._cacheCanvas=la(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0}_limitCacheSize(e){const t=e.width,r=e.height,o=mn.maxCacheSideLimit,s=mn.minCacheSideLimit;if(t<=o&&r<=o&&t*r<=mn.perfLimitSizeTotal)return t<s&&(e.width=s),r<s&&(e.height=s),e;const i=t/r,[a,A]=Eu.limitDimsByArea(i),d=Cc(s,a,o),c=Cc(s,A,o);return t>d&&(e.zoomX/=t/d,e.width=d,e.capped=!0),r>c&&(e.zoomY/=r/c,e.height=c,e.capped=!0),e}_getCacheCanvasDimensions(){const e=this.getTotalObjectScaling(),t=this._getTransformedDimensions({skewX:0,skewY:0}),r=t.x*e.x/this.scaleX,o=t.y*e.y/this.scaleY;return{width:Math.ceil(r+2),height:Math.ceil(o+2),zoomX:e.x,zoomY:e.y,x:r,y:o}}_updateCacheCanvas(){const e=this._cacheCanvas,t=this._cacheContext,{width:r,height:o,zoomX:s,zoomY:i,x:a,y:A}=this._limitCacheSize(this._getCacheCanvasDimensions()),d=r!==e.width||o!==e.height,c=this.zoomX!==s||this.zoomY!==i;if(!e||!t)return!1;if(d||c){r!==e.width||o!==e.height?(e.width=r,e.height=o):(t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,e.width,e.height));const u=a/2,h=A/2;return this.cacheTranslationX=Math.round(e.width/2-u)+u,this.cacheTranslationY=Math.round(e.height/2-h)+h,t.translate(this.cacheTranslationX,this.cacheTranslationY),t.scale(s,i),this.zoomX=s,this.zoomY=i,!0}return!1}setOptions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._setOptions(e)}transform(e){const t=this.group&&!this.group._transformDone||this.group&&this.canvas&&e===this.canvas.contextTop,r=this.calcTransformMatrix(!t);e.transform(r[0],r[1],r[2],r[3],r[4],r[5])}getObjectScaling(){if(!this.group)return new zt(Math.abs(this.scaleX),Math.abs(this.scaleY));const e=Ep(this.calcTransformMatrix());return new zt(Math.abs(e.scaleX),Math.abs(e.scaleY))}getTotalObjectScaling(){const e=this.getObjectScaling();if(this.canvas){const t=this.canvas.getZoom(),r=this.getCanvasRetinaScaling();return e.scalarMultiply(t*r)}return e}getObjectOpacity(){let e=this.opacity;return this.group&&(e*=this.group.getObjectOpacity()),e}_constrainScale(e){return Math.abs(e)<this.minScaleLimit?e<0?-this.minScaleLimit:this.minScaleLimit:e===0?1e-4:e}_set(e,t){e!==oi&&e!==Hi||(t=this._constrainScale(t)),e===oi&&t<0?(this.flipX=!this.flipX,t*=-1):e==="scaleY"&&t<0?(this.flipY=!this.flipY,t*=-1):e!=="shadow"||!t||t instanceof _A||(t=new _A(t));const r=this[e]!==t;return this[e]=t,r&&this.constructor.cacheProperties.includes(e)&&(this.dirty=!0),this.parent&&(this.dirty||r&&this.constructor.stateProperties.includes(e))&&this.parent._set("dirty",!0),this}isNotVisible(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible}render(e){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(e.save(),this._setupCompositeOperation(e),this.drawSelectionBackground(e),this.transform(e),this._setOpacity(e),this._setShadow(e),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(e)):(this._removeCacheCanvas(),this.drawObject(e,!1,{}),this.dirty=!1),e.restore())}drawSelectionBackground(e){}renderCache(e){if(e=e||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&this._cacheContext){const{zoomX:t,zoomY:r,cacheTranslationX:o,cacheTranslationY:s}=this,{width:i,height:a}=this._cacheCanvas;this.drawObject(this._cacheContext,e.forClipping,{zoomX:t,zoomY:r,cacheTranslationX:o,cacheTranslationY:s,width:i,height:a,parentClipPaths:[]}),this.dirty=!1}}_removeCacheCanvas(){this._cacheCanvas=void 0,this._cacheContext=null}hasStroke(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0}hasFill(){return this.fill&&this.fill!=="transparent"}needsItsOwnCache(){return!!(this.paintFirst===ei&&this.hasFill()&&this.hasStroke()&&this.shadow)||!!this.clipPath}shouldCache(){return this.ownCaching=this.objectCaching&&(!this.parent||!this.parent.isOnACache())||this.needsItsOwnCache(),this.ownCaching}willDrawShadow(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)}drawClipPathOnCache(e,t,r){e.save(),t.inverted?e.globalCompositeOperation="destination-out":e.globalCompositeOperation="destination-in",e.setTransform(1,0,0,1,0,0),e.drawImage(r,0,0),e.restore()}drawObject(e,t,r){const o=this.fill,s=this.stroke;t?(this.fill="black",this.stroke="",this._setClippingProperties(e)):this._renderBackground(e),this._render(e),this._drawClipPath(e,this.clipPath,r),this.fill=o,this.stroke=s}createClipPathLayer(e,t){const r=ja(t),o=r.getContext("2d");if(o.translate(t.cacheTranslationX,t.cacheTranslationY),o.scale(t.zoomX,t.zoomY),e._cacheCanvas=r,t.parentClipPaths.forEach(s=>{s.transform(o)}),t.parentClipPaths.push(e),e.absolutePositioned){const s=sa(this.calcTransformMatrix());o.transform(s[0],s[1],s[2],s[3],s[4],s[5])}return e.transform(o),e.drawObject(o,!0,t),r}_drawClipPath(e,t,r){if(!t)return;t._transformDone=!0;const o=this.createClipPathLayer(t,r);this.drawClipPathOnCache(e,t,o)}drawCacheOnCanvas(e){e.scale(1/this.zoomX,1/this.zoomY),e.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)}isCacheDirty(){let e=arguments.length>0&&arguments[0]!==void 0&&arguments[0];if(this.isNotVisible())return!1;const t=this._cacheCanvas,r=this._cacheContext;return!(!t||!r||e||!this._updateCacheCanvas())||!!(this.dirty||this.clipPath&&this.clipPath.absolutePositioned)&&(t&&r&&!e&&(r.save(),r.setTransform(1,0,0,1,0,0),r.clearRect(0,0,t.width,t.height),r.restore()),!0)}_renderBackground(e){if(!this.backgroundColor)return;const t=this._getNonTransformedDimensions();e.fillStyle=this.backgroundColor,e.fillRect(-t.x/2,-t.y/2,t.x,t.y),this._removeShadow(e)}_setOpacity(e){this.group&&!this.group._transformDone?e.globalAlpha=this.getObjectOpacity():e.globalAlpha*=this.opacity}_setStrokeStyles(e,t){const r=t.stroke;r&&(e.lineWidth=t.strokeWidth,e.lineCap=t.strokeLineCap,e.lineDashOffset=t.strokeDashOffset,e.lineJoin=t.strokeLineJoin,e.miterLimit=t.strokeMiterLimit,Oi(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?this._applyPatternForTransformedGradient(e,r):(e.strokeStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.strokeStyle=t.stroke)}_setFillStyles(e,t){let{fill:r}=t;r&&(Oi(r)?(e.fillStyle=r.toLive(e),this._applyPatternGradientTransform(e,r)):e.fillStyle=r)}_setClippingProperties(e){e.globalAlpha=1,e.strokeStyle="transparent",e.fillStyle="#000000"}_setLineDash(e,t){t&&t.length!==0&&e.setLineDash(t)}_setShadow(e){if(!this.shadow)return;const t=this.shadow,r=this.canvas,o=this.getCanvasRetinaScaling(),[s,,,i]=(r==null?void 0:r.viewportTransform)||Rs,a=s*o,A=i*o,d=t.nonScaling?new zt(1,1):this.getObjectScaling();e.shadowColor=t.color,e.shadowBlur=t.blur*mn.browserShadowBlurConstant*(a+A)*(d.x+d.y)/4,e.shadowOffsetX=t.offsetX*a*d.x,e.shadowOffsetY=t.offsetY*A*d.y}_removeShadow(e){this.shadow&&(e.shadowColor="",e.shadowBlur=e.shadowOffsetX=e.shadowOffsetY=0)}_applyPatternGradientTransform(e,t){if(!Oi(t))return{offsetX:0,offsetY:0};const r=t.gradientTransform||t.patternTransform,o=-this.width/2+t.offsetX||0,s=-this.height/2+t.offsetY||0;return t.gradientUnits==="percentage"?e.transform(this.width,0,0,this.height,o,s):e.transform(1,0,0,1,o,s),r&&e.transform(r[0],r[1],r[2],r[3],r[4],r[5]),{offsetX:o,offsetY:s}}_renderPaintInOrder(e){this.paintFirst===ei?(this._renderStroke(e),this._renderFill(e)):(this._renderFill(e),this._renderStroke(e))}_render(e){}_renderFill(e){this.fill&&(e.save(),this._setFillStyles(e,this),this.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}_renderStroke(e){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this.strokeUniform){const t=this.getObjectScaling();e.scale(1/t.x,1/t.y)}this._setLineDash(e,this.strokeDashArray),this._setStrokeStyles(e,this),e.stroke(),e.restore()}}_applyPatternForTransformedGradient(e,t){var r;const o=this._limitCacheSize(this._getCacheCanvasDimensions()),s=this.getCanvasRetinaScaling(),i=o.x/this.scaleX/s,a=o.y/this.scaleY/s,A=ja({width:Math.ceil(i),height:Math.ceil(a)}),d=A.getContext("2d");d&&(d.beginPath(),d.moveTo(0,0),d.lineTo(i,0),d.lineTo(i,a),d.lineTo(0,a),d.closePath(),d.translate(i/2,a/2),d.scale(o.zoomX/this.scaleX/s,o.zoomY/this.scaleY/s),this._applyPatternGradientTransform(d,t),d.fillStyle=t.toLive(e),d.fill(),e.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),e.scale(s*this.scaleX/o.zoomX,s*this.scaleY/o.zoomY),e.strokeStyle=(r=d.createPattern(A,"no-repeat"))!==null&&r!==void 0?r:"")}_findCenterFromElement(){return new zt(this.left+this.width/2,this.top+this.height/2)}clone(e){const t=this.toObject(e);return this.constructor.fromObject(t)}cloneAsImage(e){const t=this.toCanvasElement(e);return new(lr.getClass("image"))(t)}toCanvasElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const t=ix(this),r=this.group,o=this.shadow,s=Math.abs,i=e.enableRetinaScaling?q5():1,a=(e.multiplier||1)*i,A=e.canvasProvider||(C=>new Q1(C,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1}));delete this.group,e.withoutTransform&&XF(this),e.withoutShadow&&(this.shadow=null),e.viewportTransform&&JF(this,this.getViewportTransform()),this.setCoords();const d=la(),c=this.getBoundingRect(),u=this.shadow,h=new zt;if(u){const C=u.blur,Q=u.nonScaling?new zt(1,1):this.getObjectScaling();h.x=2*Math.round(s(u.offsetX)+C)*s(Q.x),h.y=2*Math.round(s(u.offsetY)+C)*s(Q.y)}const p=c.width+h.x,v=c.height+h.y;d.width=Math.ceil(p),d.height=Math.ceil(v);const w=A(d);e.format==="jpeg"&&(w.backgroundColor="#fff"),this.setPositionByOrigin(new zt(w.width/2,w.height/2),Gr,Gr);const y=this.canvas;w._objects=[this],this.set("canvas",w),this.setCoords();const B=w.toCanvasElement(a||1,e);return this.set("canvas",y),this.shadow=o,r&&(this.group=r),this.set(t),this.setCoords(),w._objects=[],w.destroy(),B}toDataURL(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return X5(this.toCanvasElement(e),e.format||"png",e.quality||1)}isType(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.includes(this.constructor.type)||t.includes(this.type)}complexity(){return 1}toJSON(){return this.toObject()}rotate(e){const{centeredRotation:t,originX:r,originY:o}=this;if(t){const{x:s,y:i}=this.getRelativeCenterPoint();this.originX=Gr,this.originY=Gr,this.left=s,this.top=i}if(this.set("angle",e),t){const{x:s,y:i}=this.translateToOriginPoint(this.getRelativeCenterPoint(),r,o);this.left=s,this.top=i,this.originX=r,this.originY=o}}setOnGroup(){}_setupCompositeOperation(e){this.globalCompositeOperation&&(e.globalCompositeOperation=this.globalCompositeOperation)}dispose(){Sp.cancelByTarget(this),this.off(),this._set("canvas",void 0),this._cacheCanvas&&Ha().dispose(this._cacheCanvas),this._cacheCanvas=void 0,this._cacheContext=null}animate(e,t){return Object.entries(e).reduce((r,o)=>{let[s,i]=o;return r[s]=this._animate(s,i,t),r},{})}_animate(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=e.split("."),s=this.constructor.colorProperties.includes(o[o.length-1]),{abort:i,startValue:a,onChange:A,onComplete:d}=r,c=Je(Je({},r),{},{target:this,startValue:a??o.reduce((u,h)=>u[h],this),endValue:t,abort:i==null?void 0:i.bind(this),onChange:(u,h,p)=>{o.reduce((v,w,y)=>(y===o.length-1&&(v[w]=u),v[w]),this),A&&A(u,h,p)},onComplete:(u,h,p)=>{this.setCoords(),d&&d(u,h,p)}});return s?vI(c):px(c)}isDescendantOf(e){const{parent:t,group:r}=this;return t===e||r===e||!!t&&t.isDescendantOf(e)||!!r&&r!==t&&r.isDescendantOf(e)}getAncestors(){const e=[];let t=this;do t=t.parent,t&&e.push(t);while(t);return e}findCommonAncestors(e){if(this===e)return{fork:[],otherFork:[],common:[this,...this.getAncestors()]};const t=this.getAncestors(),r=e.getAncestors();if(t.length===0&&r.length>0&&this===r[r.length-1])return{fork:[],otherFork:[e,...r.slice(0,r.length-1)],common:[this]};for(let o,s=0;s<t.length;s++){if(o=t[s],o===e)return{fork:[this,...t.slice(0,s)],otherFork:[],common:t.slice(s)};for(let i=0;i<r.length;i++){if(this===r[i])return{fork:[],otherFork:[e,...r.slice(0,i)],common:[this,...t]};if(o===r[i])return{fork:[this,...t.slice(0,s)],otherFork:[e,...r.slice(0,i)],common:t.slice(s)}}}return{fork:[this,...t],otherFork:[e,...r],common:[]}}hasCommonAncestors(e){const t=this.findCommonAncestors(e);return t&&!!t.common.length}isInFrontOf(e){if(this===e)return;const t=this.findCommonAncestors(e);if(t.fork.includes(e))return!0;if(t.otherFork.includes(this))return!1;const r=t.common[0]||this.canvas;if(!r)return;const o=t.fork.pop(),s=t.otherFork.pop(),i=r._objects.indexOf(o),a=r._objects.indexOf(s);return i>-1&&i>a}toObject(){const e=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).concat(np.customProperties,this.constructor.customProperties||[]);let t;const r=mn.NUM_FRACTION_DIGITS,{clipPath:o,fill:s,stroke:i,shadow:a,strokeDashArray:A,left:d,top:c,originX:u,originY:h,width:p,height:v,strokeWidth:w,strokeLineCap:y,strokeDashOffset:B,strokeLineJoin:C,strokeUniform:Q,strokeMiterLimit:k,scaleX:H,scaleY:Z,angle:q,flipX:N,flipY:re,opacity:be,visible:L,backgroundColor:R,fillRule:J,paintFirst:se,globalCompositeOperation:fe,skewX:ie,skewY:pe}=this;o&&!o.excludeFromExport&&(t=o.toObject(e.concat("inverted","absolutePositioned")));const te=ne=>uo(ne,r),Ce=Je(Je({},Mc(this,e)),{},{type:this.constructor.type,version:M0,originX:u,originY:h,left:te(d),top:te(c),width:te(p),height:te(v),fill:Tw(s)?s.toObject():s,stroke:Tw(i)?i.toObject():i,strokeWidth:te(w),strokeDashArray:A&&A.concat(),strokeLineCap:y,strokeDashOffset:B,strokeLineJoin:C,strokeUniform:Q,strokeMiterLimit:te(k),scaleX:te(H),scaleY:te(Z),angle:te(q),flipX:N,flipY:re,opacity:te(be),shadow:a&&a.toObject(),visible:L,backgroundColor:R,fillRule:J,paintFirst:se,globalCompositeOperation:fe,skewX:te(ie),skewY:te(pe)},t?{clipPath:t}:null);return this.includeDefaultValues?Ce:this._removeDefaultValues(Ce)}toDatalessObject(e){return this.toObject(e)}_removeDefaultValues(e){const t=this.constructor.getDefaults(),r=Object.keys(t).length>0?t:Object.getPrototypeOf(this);return U1(e,(o,s)=>{if(s===zn||s===Js||s==="type")return!0;const i=r[s];return o!==i&&!(Array.isArray(o)&&Array.isArray(i)&&o.length===0&&i.length===0)})}toString(){return"#<".concat(this.constructor.type,">")}static _fromObject(e){let t=so(e,wI),r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{extraParam:o}=r,s=so(r,yI);return mg(t,s).then(i=>o?(delete i[o],new this(t[o],i)):new this(i))}static fromObject(e,t){return this._fromObject(e,t)}};Xe(dA,"stateProperties",iI),Xe(dA,"cacheProperties",EA),Xe(dA,"ownDefaults",aI),Xe(dA,"type","FabricObject"),Xe(dA,"colorProperties",[Ko,ei,"backgroundColor"]),Xe(dA,"customProperties",[]),lr.setClass(dA),lr.setClass(dA,"object");const Hc=(n,e,t)=>(r,o,s,i)=>{const a=e(r,o,s,i);return a&&ax(n,Je(Je({},lx(r,o,s,i)),t)),a};function jc(n){return(e,t,r,o)=>{const{target:s,originX:i,originY:a}=t,A=s.getRelativeCenterPoint(),d=s.translateToOriginPoint(A,i,a),c=n(e,t,r,o);return s.setPositionByOrigin(d,t.originX,t.originY),c}}const jw=Hc(Yu,jc((n,e,t,r)=>{const o=L1(e,e.originX,e.originY,t,r);if(Oo(e.originX)===Oo(Gr)||Oo(e.originX)===Oo(So)&&o.x<0||Oo(e.originX)===Oo(zn)&&o.x>0){const{target:s}=e,i=s.strokeWidth/(s.strokeUniform?s.scaleX:1),a=Ax(e)?2:1,A=s.width,d=Math.abs(o.x*a/s.scaleX)-i;return s.set("width",Math.max(d,1)),A!==s.width}return!1}));function _I(n,e,t,r,o){r=r||{};const s=this.sizeX||r.cornerSize||o.cornerSize,i=this.sizeY||r.cornerSize||o.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:o.transparentCorners,A=a?ei:Ko,d=!a&&(r.cornerStrokeColor||o.cornerStrokeColor);let c,u=e,h=t;n.save(),n.fillStyle=r.cornerColor||o.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||o.cornerStrokeColor||"",s>i?(c=s,n.scale(1,i/s),h=t*s/i):i>s?(c=i,n.scale(s/i,1),u=e*i/s):c=s,n.beginPath(),n.arc(u,h,c/2,0,Bp,!1),n[A](),d&&n.stroke(),n.restore()}function bI(n,e,t,r,o){r=r||{};const s=this.sizeX||r.cornerSize||o.cornerSize,i=this.sizeY||r.cornerSize||o.cornerSize,a=r.transparentCorners!==void 0?r.transparentCorners:o.transparentCorners,A=a?ei:Ko,d=!a&&(r.cornerStrokeColor||o.cornerStrokeColor),c=s/2,u=i/2;n.save(),n.fillStyle=r.cornerColor||o.cornerColor||"",n.strokeStyle=r.cornerStrokeColor||o.cornerStrokeColor||"",n.translate(e,t);const h=o.getTotalAngle();n.rotate(Uo(h)),n["".concat(A,"Rect")](-c,-u,s,i),d&&n.strokeRect(-c,-u,s,i),n.restore()}class Ji{constructor(e){Xe(this,"visible",!0),Xe(this,"actionName",gg),Xe(this,"angle",0),Xe(this,"x",0),Xe(this,"y",0),Xe(this,"offsetX",0),Xe(this,"offsetY",0),Xe(this,"sizeX",0),Xe(this,"sizeY",0),Xe(this,"touchSizeX",0),Xe(this,"touchSizeY",0),Xe(this,"cursorStyle","crosshair"),Xe(this,"withConnection",!1),Object.assign(this,e)}shouldActivate(e,t,r,o){var s;let{tl:i,tr:a,br:A,bl:d}=o;return((s=t.canvas)===null||s===void 0?void 0:s.getActiveObject())===t&&t.isControlVisible(e)&&co.isPointInPolygon(r,[i,a,A,d])}getActionHandler(e,t,r){return this.actionHandler}getMouseDownHandler(e,t,r){return this.mouseDownHandler}getMouseUpHandler(e,t,r){return this.mouseUpHandler}cursorStyleHandler(e,t,r){return t.cursorStyle}getActionName(e,t,r){return t.actionName}getVisibility(e,t){var r,o;return(r=(o=e._controlsVisibility)===null||o===void 0?void 0:o[t])!==null&&r!==void 0?r:this.visible}setVisibility(e,t,r){this.visible=e}positionHandler(e,t,r,o){return new zt(this.x*e.x+this.offsetX,this.y*e.y+this.offsetY).transform(t)}calcCornerCoords(e,t,r,o,s,i){const a=F1([ph(r,o),gh({angle:e}),I1((s?this.touchSizeX:this.sizeX)||t,(s?this.touchSizeY:this.sizeY)||t)]);return{tl:new zt(-.5,-.5).transform(a),tr:new zt(.5,-.5).transform(a),br:new zt(.5,.5).transform(a),bl:new zt(-.5,.5).transform(a)}}render(e,t,r,o,s){((o=o||{}).cornerStyle||s.cornerStyle)==="circle"?_I.call(this,e,t,r,o,s):bI.call(this,e,t,r,o,s)}}const xI=(n,e,t)=>t.lockRotation?Up:e.cursorStyle,BI=Hc($5,jc((n,e,t,r)=>{let{target:o,ex:s,ey:i,theta:a,originX:A,originY:d}=e;const c=o.translateToOriginPoint(o.getRelativeCenterPoint(),A,d);if(aa(o,"lockRotation"))return!1;const u=Math.atan2(i-c.y,s-c.x),h=Math.atan2(r-c.y,t-c.x);let p=od(h-u+a);if(o.snapAngle&&o.snapAngle>0){const w=o.snapAngle,y=o.snapThreshold||w,B=Math.ceil(p/w)*w,C=Math.floor(p/w)*w;Math.abs(p-C)<y?p=C:Math.abs(p-B)<y&&(p=B)}p<0&&(p=360+p),p%=360;const v=o.angle!==p;return o.angle=p,v}));function gx(n,e){const t=e.canvas,r=n[t.uniScaleKey];return t.uniformScaling&&!r||!t.uniformScaling&&r}function vx(n,e,t){const r=aa(n,"lockScalingX"),o=aa(n,"lockScalingY");if(r&&o||!e&&(r||o)&&t||r&&e==="x"||o&&e==="y")return!0;const{width:s,height:i,strokeWidth:a}=n;return s===0&&a===0&&e!=="y"||i===0&&a===0&&e!=="x"}const zI=["e","se","s","sw","w","nw","n","ne","e"],vu=(n,e,t)=>{const r=gx(n,t);if(vx(t,e.x!==0&&e.y===0?"x":e.x===0&&e.y!==0?"y":"",r))return Up;const o=dx(t,e);return"".concat(zI[o],"-resize")};function O1(n,e,t,r){let o=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{};const s=e.target,i=o.by,a=gx(n,s);let A,d,c,u,h,p;if(vx(s,i,a))return!1;if(e.gestureScale)d=e.scaleX*e.gestureScale,c=e.scaleY*e.gestureScale;else{if(A=L1(e,e.originX,e.originY,t,r),h=i!=="y"?Math.sign(A.x||e.signX||1):1,p=i!=="x"?Math.sign(A.y||e.signY||1):1,e.signX||(e.signX=h),e.signY||(e.signY=p),aa(s,"lockScalingFlip")&&(e.signX!==h||e.signY!==p))return!1;if(u=s._getTransformedDimensions(),a&&!i){const y=Math.abs(A.x)+Math.abs(A.y),{original:B}=e,C=y/(Math.abs(u.x*B.scaleX/s.scaleX)+Math.abs(u.y*B.scaleY/s.scaleY));d=B.scaleX*C,c=B.scaleY*C}else d=Math.abs(A.x*s.scaleX/u.x),c=Math.abs(A.y*s.scaleY/u.y);Ax(e)&&(d*=2,c*=2),e.signX!==h&&i!=="y"&&(e.originX=kw(e.originX),d*=-1,e.signX=h),e.signY!==p&&i!=="x"&&(e.originY=kw(e.originY),c*=-1,e.signY=p)}const v=s.scaleX,w=s.scaleY;return i?(i==="x"&&s.set(oi,d),i==="y"&&s.set(Hi,c)):(!aa(s,"lockScalingX")&&s.set(oi,d),!aa(s,"lockScalingY")&&s.set(Hi,c)),v!==s.scaleX||w!==s.scaleY}const Xh=Hc(pg,jc((n,e,t,r)=>O1(n,e,t,r))),CI=Hc(pg,jc((n,e,t,r)=>O1(n,e,t,r,{by:"x"}))),SI=Hc(pg,jc((n,e,t,r)=>O1(n,e,t,r,{by:"y"}))),EI=["target","ex","ey","skewingSide"],Cv={x:{counterAxis:"y",scale:oi,skew:Dc,lockSkewing:"lockSkewingX",origin:"originX",flip:"flipX"},y:{counterAxis:"x",scale:Hi,skew:Nc,lockSkewing:"lockSkewingY",origin:"originY",flip:"flipY"}},FI=["ns","nesw","ew","nwse"],II=(n,e,t)=>{if(e.x!==0&&aa(t,"lockSkewingY")||e.y!==0&&aa(t,"lockSkewingX"))return Up;const r=dx(t,e)%4;return"".concat(FI[r],"-resize")};function mx(n,e,t,r,o){const{target:s}=t,{counterAxis:i,origin:a,lockSkewing:A,skew:d,flip:c}=Cv[n];if(aa(s,A))return!1;const{origin:u,flip:h}=Cv[i],p=Oo(t[u])*(s[h]?-1:1),v=-Math.sign(p)*(s[c]?-1:1),w=.5*-((s[d]===0&&L1(t,Gr,Gr,r,o)[n]>0||s[d]>0?1:-1)*v)+.5;return Hc(V5,jc((B,C,Q,k)=>function(H,Z,q){let{target:N,ex:re,ey:be,skewingSide:L}=Z,R=so(Z,EI);const{skew:J}=Cv[H],se=q.subtract(new zt(re,be)).divide(new zt(N.scaleX,N.scaleY))[H],fe=N[J],ie=R[J],pe=Math.tan(Uo(ie)),te=H==="y"?N._getTransformedDimensions({scaleX:1,scaleY:1,skewX:0}).x:N._getTransformedDimensions({scaleX:1,scaleY:1}).y,Ce=2*se*L/Math.max(te,1)+pe,ne=od(Math.atan(Ce));N.set(J,ne);const ze=fe!==N[J];if(ze&&H==="y"){const{skewX:z,scaleX:E}=N,F=N._getTransformedDimensions({skewY:fe}),I=N._getTransformedDimensions(),O=z!==0?F.x/I.x:1;O!==1&&N.set(oi,O*E)}return ze}(n,C,new zt(Q,k))))(e,Je(Je({},t),{},{[a]:w,skewingSide:v}),r,o)}const UI=(n,e,t,r)=>mx("x",n,e,t,r),QI=(n,e,t,r)=>mx("y",n,e,t,r);function _g(n,e){return n[e.canvas.altActionKey]}const Yh=(n,e,t)=>{const r=_g(n,t);return e.x===0?r?Dc:Hi:e.y===0?r?Nc:oi:""},tc=(n,e,t)=>_g(n,t)?II(0,e,t):vu(n,e,t),Rw=(n,e,t,r)=>_g(n,e.target)?QI(n,e,t,r):CI(n,e,t,r),qw=(n,e,t,r)=>_g(n,e.target)?UI(n,e,t,r):SI(n,e,t,r),wx=()=>({ml:new Ji({x:-.5,y:0,cursorStyleHandler:tc,actionHandler:Rw,getActionName:Yh}),mr:new Ji({x:.5,y:0,cursorStyleHandler:tc,actionHandler:Rw,getActionName:Yh}),mb:new Ji({x:0,y:.5,cursorStyleHandler:tc,actionHandler:qw,getActionName:Yh}),mt:new Ji({x:0,y:-.5,cursorStyleHandler:tc,actionHandler:qw,getActionName:Yh}),tl:new Ji({x:-.5,y:-.5,cursorStyleHandler:vu,actionHandler:Xh}),tr:new Ji({x:.5,y:-.5,cursorStyleHandler:vu,actionHandler:Xh}),bl:new Ji({x:-.5,y:.5,cursorStyleHandler:vu,actionHandler:Xh}),br:new Ji({x:.5,y:.5,cursorStyleHandler:vu,actionHandler:Xh}),mtr:new Ji({x:0,y:-.5,actionHandler:BI,cursorStyleHandler:xI,offsetY:-40,withConnection:!0,actionName:S1})}),TI=()=>({mr:new Ji({x:.5,y:0,actionHandler:jw,cursorStyleHandler:tc,actionName:Yu}),ml:new Ji({x:-.5,y:0,actionHandler:jw,cursorStyleHandler:tc,actionName:Yu})}),LI=()=>Je(Je({},wx()),TI());class eh extends dA{static getDefaults(){return Je(Je({},super.getDefaults()),eh.ownDefaults)}constructor(e){super(),Object.assign(this,this.constructor.createControls(),eh.ownDefaults),this.setOptions(e)}static createControls(){return{controls:wx()}}_updateCacheCanvas(){const e=this.canvas;if(this.noScaleCache&&e&&e._currentTransform){const t=e._currentTransform,r=t.target,o=t.action;if(this===r&&o&&o.startsWith(gg))return!1}return super._updateCacheCanvas()}getActiveControl(){const e=this.__corner;return e?{key:e,control:this.controls[e],coord:this.oCoords[e]}:void 0}findControl(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];if(!this.hasControls||!this.canvas)return;this.__corner=void 0;const r=Object.entries(this.oCoords);for(let o=r.length-1;o>=0;o--){const[s,i]=r[o],a=this.controls[s];if(a.shouldActivate(s,this,e,t?i.touchCorner:i.corner))return this.__corner=s,{key:s,control:a,coord:this.oCoords[s]}}}calcOCoords(){const e=this.getViewportTransform(),t=this.getCenterPoint(),r=ph(t.x,t.y),o=gh({angle:this.getTotalAngle()-(this.group&&this.flipX?180:0)}),s=us(r,o),i=us(e,s),a=us(i,[1/e[0],0,0,1/e[3],0,0]),A=this.group?Ep(this.calcTransformMatrix()):void 0;A&&(A.scaleX=Math.abs(A.scaleX),A.scaleY=Math.abs(A.scaleY));const d=this._calculateCurrentDimensions(A),c={};return this.forEachControl((u,h)=>{const p=u.positionHandler(d,a,this,u);c[h]=Object.assign(p,this._calcCornerCoords(u,p))}),c}_calcCornerCoords(e,t){const r=this.getTotalAngle();return{corner:e.calcCornerCoords(r,this.cornerSize,t.x,t.y,!1,this),touchCorner:e.calcCornerCoords(r,this.touchCornerSize,t.x,t.y,!0,this)}}setCoords(){super.setCoords(),this.canvas&&(this.oCoords=this.calcOCoords())}forEachControl(e){for(const t in this.controls)e(this.controls[t],t,this)}drawSelectionBackground(e){if(!this.selectionBackgroundColor||this.canvas&&this.canvas._activeObject!==this)return;e.save();const t=this.getRelativeCenterPoint(),r=this._calculateCurrentDimensions(),o=this.getViewportTransform();e.translate(t.x,t.y),e.scale(1/o[0],1/o[3]),e.rotate(Uo(this.angle)),e.fillStyle=this.selectionBackgroundColor,e.fillRect(-r.x/2,-r.y/2,r.x,r.y),e.restore()}strokeBorders(e,t){e.strokeRect(-t.x/2,-t.y/2,t.x,t.y)}_drawBorders(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=Je({hasControls:this.hasControls,borderColor:this.borderColor,borderDashArray:this.borderDashArray},r);e.save(),e.strokeStyle=o.borderColor,this._setLineDash(e,o.borderDashArray),this.strokeBorders(e,t),o.hasControls&&this.drawControlsConnectingLines(e,t),e.restore()}_renderControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{hasBorders:r,hasControls:o}=this,s=Je({hasBorders:r,hasControls:o},t),i=this.getViewportTransform(),a=s.hasBorders,A=s.hasControls,d=us(i,this.calcTransformMatrix()),c=Ep(d);e.save(),e.translate(c.translateX,c.translateY),e.lineWidth=this.borderScaleFactor,this.group===this.parent&&(e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(c.angle-=180),e.rotate(Uo(this.group?c.angle:this.angle)),a&&this.drawBorders(e,c,t),A&&this.drawControls(e,t),e.restore()}drawBorders(e,t,r){let o;if(r&&r.forActiveSelection||this.group){const s=T1(this.width,this.height,vg(t)),i=this.isStrokeAccountedForInDimensions()?E1:(this.strokeUniform?new zt().scalarAdd(this.canvas?this.canvas.getZoom():1):new zt(t.scaleX,t.scaleY)).scalarMultiply(this.strokeWidth);o=s.add(i).scalarAdd(this.borderScaleFactor).scalarAdd(2*this.padding)}else o=this._calculateCurrentDimensions().scalarAdd(this.borderScaleFactor);this._drawBorders(e,o,r)}drawControlsConnectingLines(e,t){let r=!1;e.beginPath(),this.forEachControl((o,s)=>{o.withConnection&&o.getVisibility(this,s)&&(r=!0,e.moveTo(o.x*t.x,o.y*t.y),e.lineTo(o.x*t.x+o.offsetX,o.y*t.y+o.offsetY))}),r&&e.stroke()}drawControls(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};e.save();const r=this.getCanvasRetinaScaling(),{cornerStrokeColor:o,cornerDashArray:s,cornerColor:i}=this,a=Je({cornerStrokeColor:o,cornerDashArray:s,cornerColor:i},t);e.setTransform(r,0,0,r,0,0),e.strokeStyle=e.fillStyle=a.cornerColor,this.transparentCorners||(e.strokeStyle=a.cornerStrokeColor),this._setLineDash(e,a.cornerDashArray),this.forEachControl((A,d)=>{if(A.getVisibility(this,d)){const c=this.oCoords[d];A.render(e,c.x,c.y,a,this)}}),e.restore()}isControlVisible(e){return this.controls[e]&&this.controls[e].getVisibility(this,e)}setControlVisible(e,t){this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[e]=t}setControlsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Object.entries(e).forEach(t=>{let[r,o]=t;return this.setControlVisible(r,o)})}clearContextTop(e){if(!this.canvas)return;const t=this.canvas.contextTop;if(!t)return;const r=this.canvas.viewportTransform;t.save(),t.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this.transform(t);const o=this.width+4,s=this.height+4;return t.clearRect(-o/2,-s/2,o,s),e||t.restore(),t}onDeselect(e){return!1}onSelect(e){return!1}shouldStartDragging(e){return!1}onDragStart(e){return!1}canDrop(e){return!1}renderDragSourceEffect(e){}renderDropTargetEffect(e){}}function yx(n,e){return e.forEach(t=>{Object.getOwnPropertyNames(t.prototype).forEach(r=>{r!=="constructor"&&Object.defineProperty(n.prototype,r,Object.getOwnPropertyDescriptor(t.prototype,r)||Object.create(null))})}),n}Xe(eh,"ownDefaults",{noScaleCache:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,cornerSize:13,touchCornerSize:24,transparentCorners:!0,cornerColor:"rgb(178,204,255)",cornerStrokeColor:"",cornerStyle:"rect",cornerDashArray:null,hasControls:!0,borderColor:"rgb(178,204,255)",borderDashArray:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,hasBorders:!0,selectionBackgroundColor:"",selectable:!0,evented:!0,perPixelTargetFind:!1,activeOn:"down",hoverCursor:null,moveCursor:null});class os extends eh{}yx(os,[cx]),lr.setClass(os),lr.setClass(os,"object");const PI=(n,e,t,r)=>{const o=2*(r=Math.round(r))+1,{data:s}=n.getImageData(e-r,t-r,o,o);for(let i=3;i<s.length;i+=4)if(s[i]>0)return!1;return!0};class _x{constructor(e){this.options=e,this.strokeProjectionMagnitude=this.options.strokeWidth/2,this.scale=new zt(this.options.scaleX,this.options.scaleY),this.strokeUniformScalar=this.options.strokeUniform?new zt(1/this.options.scaleX,1/this.options.scaleY):new zt(1,1)}createSideVector(e,t){const r=K0(e,t);return this.options.strokeUniform?r.multiply(this.scale):r}projectOrthogonally(e,t,r){return this.applySkew(e.add(this.calcOrthogonalProjection(e,t,r)))}isSkewed(){return this.options.skewX!==0||this.options.skewY!==0}applySkew(e){const t=new zt(e);return t.y+=t.x*Math.tan(Uo(this.options.skewY)),t.x+=t.y*Math.tan(Uo(this.options.skewX)),t}scaleUnitVector(e,t){return e.multiply(this.strokeUniformScalar).scalarMultiply(t)}}const kI=new zt;class fc extends _x{static getOrthogonalRotationFactor(e,t){const r=t?V0(e,t):oI(e);return Math.abs(r)<fh?-1:1}constructor(e,t,r,o){super(o),Xe(this,"AB",void 0),Xe(this,"AC",void 0),Xe(this,"alpha",void 0),Xe(this,"bisector",void 0),this.A=new zt(e),this.B=new zt(t),this.C=new zt(r),this.AB=this.createSideVector(this.A,this.B),this.AC=this.createSideVector(this.A,this.C),this.alpha=V0(this.AB,this.AC),this.bisector=P1(hx(this.AB.eq(kI)?this.AC:this.AB,this.alpha/2))}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(e,t),s=fx(o),i=fc.getOrthogonalRotationFactor(s,this.bisector);return this.scaleUnitVector(s,r*i)}projectBevel(){const e=[];return(this.alpha%Bp==0?[this.B]:[this.B,this.C]).forEach(t=>{e.push(this.projectOrthogonally(this.A,t)),e.push(this.projectOrthogonally(this.A,t,-this.strokeProjectionMagnitude))}),e}projectMiter(){const e=[],t=Math.abs(this.alpha),r=1/Math.sin(t/2),o=this.scaleUnitVector(this.bisector,-this.strokeProjectionMagnitude*r),s=this.options.strokeUniform?$0(this.scaleUnitVector(this.bisector,this.options.strokeMiterLimit)):this.options.strokeMiterLimit;return $0(o)/this.strokeProjectionMagnitude<=s&&e.push(this.applySkew(this.A.add(o))),e.push(...this.projectBevel()),e}projectRoundNoSkew(e,t){const r=[],o=new zt(fc.getOrthogonalRotationFactor(this.bisector),fc.getOrthogonalRotationFactor(new zt(this.bisector.y,this.bisector.x)));return[new zt(1,0).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o),new zt(0,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar).multiply(o)].forEach(s=>{Nw(s,e,t)&&r.push(this.A.add(s))}),r}projectRoundWithSkew(e,t){const r=[],{skewX:o,skewY:s,scaleX:i,scaleY:a,strokeUniform:A}=this.options,d=new zt(Math.tan(Uo(o)),Math.tan(Uo(s))),c=this.strokeProjectionMagnitude,u=A?c/a/Math.sqrt(1/a**2+1/i**2*d.y**2):c/Math.sqrt(1+d.y**2),h=new zt(Math.sqrt(Math.max(c**2-u**2,0)),u),p=A?c/Math.sqrt(1+d.x**2*(1/a)**2/(1/i+1/i*d.x*d.y)**2):c/Math.sqrt(1+d.x**2/(1+d.x*d.y)**2),v=new zt(p,Math.sqrt(Math.max(c**2-p**2,0)));return[v,v.scalarMultiply(-1),h,h.scalarMultiply(-1)].map(w=>this.applySkew(A?w.multiply(this.strokeUniformScalar):w)).forEach(w=>{Nw(w,e,t)&&r.push(this.applySkew(this.A).add(w))}),r}projectRound(){const e=[];e.push(...this.projectBevel());const t=this.alpha%Bp==0,r=this.applySkew(this.A),o=e[t?0:2].subtract(r),s=e[t?1:0].subtract(r),i=t?this.applySkew(this.AB.scalarMultiply(-1)):this.applySkew(this.bisector.multiply(this.strokeUniformScalar).scalarMultiply(-1)),a=Fu(o,i)>0,A=a?o:s,d=a?s:o;return this.isSkewed()?e.push(...this.projectRoundWithSkew(A,d)):e.push(...this.projectRoundNoSkew(A,d)),e}projectPoints(){switch(this.options.strokeLineJoin){case"miter":return this.projectMiter();case"round":return this.projectRound();default:return this.projectBevel()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e,angle:this.alpha,bisector:this.bisector}))}}class Kw extends _x{constructor(e,t,r){super(r),this.A=new zt(e),this.T=new zt(t)}calcOrthogonalProjection(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.strokeProjectionMagnitude;const o=this.createSideVector(e,t);return this.scaleUnitVector(fx(o),r)}projectButt(){return[this.projectOrthogonally(this.A,this.T,this.strokeProjectionMagnitude),this.projectOrthogonally(this.A,this.T,-this.strokeProjectionMagnitude)]}projectRound(){const e=[];if(!this.isSkewed()&&this.A.eq(this.T)){const t=new zt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.applySkew(this.A.add(t)),this.applySkew(this.A.subtract(t)))}else e.push(...new fc(this.A,this.T,this.T,this.options).projectRound());return e}projectSquare(){const e=[];if(this.A.eq(this.T)){const t=new zt(1,1).scalarMultiply(this.strokeProjectionMagnitude).multiply(this.strokeUniformScalar);e.push(this.A.add(t),this.A.subtract(t))}else{const t=this.calcOrthogonalProjection(this.A,this.T,this.strokeProjectionMagnitude),r=this.scaleUnitVector(P1(this.createSideVector(this.A,this.T)),-this.strokeProjectionMagnitude),o=this.A.add(r);e.push(o.add(t),o.subtract(t))}return e.map(t=>this.applySkew(t))}projectPoints(){switch(this.options.strokeLineCap){case"round":return this.projectRound();case"square":return this.projectSquare();default:return this.projectButt()}}project(){return this.projectPoints().map(e=>({originPoint:this.A,projectedPoint:e}))}}const OI=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const r=[];if(n.length===0)return r;const o=n.reduce((s,i)=>(s[s.length-1].eq(i)||s.push(new zt(i)),s),[new zt(n[0])]);if(o.length===1)t=!0;else if(!t){const s=o[0],i=((a,A)=>{for(let d=a.length-1;d>=0;d--)if(A(a[d],d,a))return d;return-1})(o,a=>!a.eq(s));o.splice(i+1)}return o.forEach((s,i,a)=>{let A,d;i===0?(d=a[1],A=t?s:a[a.length-1]):i===a.length-1?(A=a[i-1],d=t?s:a[0]):(A=a[i-1],d=a[i+1]),t&&a.length===1?r.push(...new Kw(s,s,e).project()):!t||i!==0&&i!==a.length-1?r.push(...new fc(s,A,d,e).project()):r.push(...new Kw(s,i===0?d:A,e).project())}),r},D1=n=>{const e={};return Object.keys(n).forEach(t=>{e[t]={},Object.keys(n[t]).forEach(r=>{e[t][r]=Je({},n[t][r])})}),e},DI=n=>n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),N1=n=>{const e=[];for(let t,r=0;r<n.length;r++)(t=NI(n,r))!==!1&&e.push(t);return e},NI=(n,e)=>{const t=n.charCodeAt(e);if(isNaN(t))return"";if(t<55296||t>57343)return n.charAt(e);if(55296<=t&&t<=56319){if(n.length<=e+1)throw"High surrogate without following low surrogate";const o=n.charCodeAt(e+1);if(56320>o||o>57343)throw"High surrogate without following low surrogate";return n.charAt(e)+n.charAt(e+1)}if(e===0)throw"Low surrogate without preceding high surrogate";const r=n.charCodeAt(e-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1},M1=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return n.fill!==e.fill||n.stroke!==e.stroke||n.strokeWidth!==e.strokeWidth||n.fontSize!==e.fontSize||n.fontFamily!==e.fontFamily||n.fontWeight!==e.fontWeight||n.fontStyle!==e.fontStyle||n.textBackgroundColor!==e.textBackgroundColor||n.deltaY!==e.deltaY||t&&(n.overline!==e.overline||n.underline!==e.underline||n.linethrough!==e.linethrough)},MI=(n,e)=>{const t=e.split(`
`),r=[];let o=-1,s={};n=D1(n);for(let i=0;i<t.length;i++){const a=N1(t[i]);if(n[i])for(let A=0;A<a.length;A++){o++;const d=n[i][A];d&&Object.keys(d).length>0&&(M1(s,d,!0)?r.push({start:o,end:o+1,style:d}):r[r.length-1].end++),s=d||{}}else o+=a.length,s={}}return r},HI=(n,e)=>{if(!Array.isArray(n))return D1(n);const t=e.split(C1),r={};let o=-1,s=0;for(let i=0;i<t.length;i++){const a=N1(t[i]);for(let A=0;A<a.length;A++)o++,n[s]&&n[s].start<=o&&o<n[s].end&&(r[i]=r[i]||{},r[i][A]=Je({},n[s].style),o===n[s].end-1&&s++)}return r},yl=["display","transform",Ko,"fill-opacity","fill-rule","opacity",ei,"stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"];function $w(n,e){const t=n.nodeName,r=n.getAttribute("class"),o=n.getAttribute("id"),s="(?![a-zA-Z\\-]+)";let i;if(i=new RegExp("^"+t,"i"),e=e.replace(i,""),o&&e.length&&(i=new RegExp("#"+o+s,"i"),e=e.replace(i,"")),r&&e.length){const a=r.split(" ");for(let A=a.length;A--;)i=new RegExp("\\."+a[A]+s,"i"),e=e.replace(i,"")}return e.length===0}function jI(n,e){let t=!0;const r=$w(n,e.pop());return r&&e.length&&(t=function(o,s){let i,a=!0;for(;o.parentElement&&o.parentElement.nodeType===1&&s.length;)a&&(i=s.pop()),a=$w(o=o.parentElement,i);return s.length===0}(n,e)),r&&t&&e.length===0}const RI=n=>{var e;return(e=rI[n])!==null&&e!==void 0?e:n},qI=new RegExp("(".concat(sd,")"),"gi"),KI=n=>n.replace(qI," $1 ").replace(/,/gi," ").replace(/\s+/gi," ");var Vw,Gw,Ww,Xw,Yw,Jw,Zw;const Hs="(".concat(sd,")"),$I=String.raw(Vw||(Vw=wl(["(skewX)(",")"],["(skewX)\\(","\\)"])),Hs),VI=String.raw(Gw||(Gw=wl(["(skewY)(",")"],["(skewY)\\(","\\)"])),Hs),GI=String.raw(Ww||(Ww=wl(["(rotate)(","(?: "," ",")?)"],["(rotate)\\(","(?: "," ",")?\\)"])),Hs,Hs,Hs),WI=String.raw(Xw||(Xw=wl(["(scale)(","(?: ",")?)"],["(scale)\\(","(?: ",")?\\)"])),Hs,Hs),XI=String.raw(Yw||(Yw=wl(["(translate)(","(?: ",")?)"],["(translate)\\(","(?: ",")?\\)"])),Hs,Hs),YI=String.raw(Jw||(Jw=wl(["(matrix)("," "," "," "," "," ",")"],["(matrix)\\("," "," "," "," "," ","\\)"])),Hs,Hs,Hs,Hs,Hs,Hs),H1="(?:".concat(YI,"|").concat(XI,"|").concat(GI,"|").concat(WI,"|").concat($I,"|").concat(VI,")"),JI="(?:".concat(H1,"*)"),ZI=String.raw(Zw||(Zw=wl(["^s*(?:","?)s*$"],["^\\s*(?:","?)\\s*$"])),JI),eU=new RegExp(ZI),tU=new RegExp(H1),rU=new RegExp(H1,"g");function G0(n){const e=[];if(!(n=KI(n).replace(/\s*([()])\s*/gi,"$1"))||n&&!eU.test(n))return[...Rs];for(const t of n.matchAll(rU)){const r=tU.exec(t[0]);if(!r)continue;let o=Rs;const s=r.filter(v=>!!v),[,i,...a]=s,[A,d,c,u,h,p]=a.map(v=>parseFloat(v));switch(i){case"translate":o=ph(A,d);break;case S1:o=gh({angle:A},{x:d,y:c});break;case gg:o=I1(A,d);break;case Dc:o=Z5(A);break;case Nc:o=ex(A);break;case"matrix":o=[A,d,c,u,h,p]}e.push(o)}return F1(e)}function nU(n,e,t,r){const o=Array.isArray(e);let s,i=e;if(n!==Ko&&n!==ei||e!==Zs){if(n==="strokeUniform")return e==="non-scaling-stroke";if(n==="strokeDashArray")i=e===Zs?null:e.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(n==="transformMatrix")i=t&&t.transformMatrix?us(t.transformMatrix,G0(e)):G0(e);else if(n==="visible")i=e!==Zs&&e!=="hidden",t&&t.visible===!1&&(i=!1);else if(n==="opacity")i=parseFloat(e),t&&t.opacity!==void 0&&(i*=t.opacity);else if(n==="textAnchor")i=e==="start"?zn:e==="end"?So:Gr;else if(n==="charSpacing")s=uc(e,r)/r*1e3;else if(n==="paintFirst"){const a=e.indexOf(Ko),A=e.indexOf(ei);i=Ko,(a>-1&&A>-1&&A<a||a===-1&&A>-1)&&(i=ei)}else{if(n==="href"||n==="xlink:href"||n==="font"||n==="id")return e;if(n==="imageSmoothing")return e==="optimizeQuality";s=o?e.map(uc):uc(e,r)}}else i="";return!o&&isNaN(s)?i:s}function oU(n,e){const t=n.match(tI);if(!t)return;const r=t[1],o=t[3],s=t[4],i=t[5],a=t[6];r&&(e.fontStyle=r),o&&(e.fontWeight=isNaN(parseFloat(o))?o:parseFloat(o)),s&&(e.fontSize=uc(s)),a&&(e.fontFamily=a),i&&(e.lineHeight=i==="normal"?1:i)}function sU(n,e){n.replace(/;\s*$/,"").split(";").forEach(t=>{if(!t)return;const[r,o]=t.split(":");e[r.trim().toLowerCase()]=o.trim()})}function iU(n){const e={},t=n.getAttribute("style");return t&&(typeof t=="string"?sU(t,e):function(r,o){Object.entries(r).forEach(s=>{let[i,a]=s;a!==void 0&&(o[i.toLowerCase()]=a)})}(t,e)),e}const aU={stroke:"strokeOpacity",fill:"fillOpacity"};function FA(n,e,t){if(!n)return{};let r,o={},s=z1;n.parentNode&&Dw.test(n.parentNode.nodeName)&&(o=FA(n.parentElement,e,t),o.fontSize&&(r=s=uc(o.fontSize)));const i=Je(Je(Je({},e.reduce((d,c)=>{const u=n.getAttribute(c);return u&&(d[c]=u),d},{})),function(d){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u={};for(const h in c)jI(d,h.split(" "))&&(u=Je(Je({},u),c[h]));return u}(n,t)),iU(n));i[Bv]&&n.setAttribute(Bv,i[Bv]),i[xv]&&(r=uc(i[xv],s),i[xv]="".concat(r));const a={};for(const d in i){const c=RI(d),u=nU(c,i[d],o,r);a[c]=u}a&&a.font&&oU(a.font,a);const A=Je(Je({},o),a);return Dw.test(n.nodeName)?A:function(d){const c=os.getDefaults();return Object.entries(aU).forEach(u=>{let[h,p]=u;if(d[p]===void 0||d[h]==="")return;if(d[h]===void 0){if(!c[h])return;d[h]=c[h]}if(d[h].indexOf("url(")===0)return;const v=new xi(d[h]);d[h]=v.setAlpha(uo(v.getAlpha()*d[p],2)).toRgba()}),d}(A)}const AU=["left","top","width","height","visible"],bx=["rx","ry"];class na extends os{static getDefaults(){return Je(Je({},super.getDefaults()),na.ownDefaults)}constructor(e){super(),Object.assign(this,na.ownDefaults),this.setOptions(e),this._initRxRy()}_initRxRy(){const{rx:e,ry:t}=this;e&&!t?this.ry=e:t&&!e&&(this.rx=t)}_render(e){const{width:t,height:r}=this,o=-t/2,s=-r/2,i=this.rx?Math.min(this.rx,t/2):0,a=this.ry?Math.min(this.ry,r/2):0,A=i!==0||a!==0;e.beginPath(),e.moveTo(o+i,s),e.lineTo(o+t-i,s),A&&e.bezierCurveTo(o+t-KA*i,s,o+t,s+KA*a,o+t,s+a),e.lineTo(o+t,s+r-a),A&&e.bezierCurveTo(o+t,s+r-KA*a,o+t-KA*i,s+r,o+t-i,s+r),e.lineTo(o+i,s+r),A&&e.bezierCurveTo(o+KA*i,s+r,o,s+r-KA*a,o,s+r-a),e.lineTo(o,s+a),A&&e.bezierCurveTo(o,s+KA*a,o+KA*i,s,o+i,s),e.closePath(),this._renderPaintInOrder(e)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...bx,...e])}_toSVG(){const{width:e,height:t,rx:r,ry:o}=this;return["<rect ","COMMON_PARTS",'x="'.concat(-e/2,'" y="').concat(-t/2,'" rx="').concat(r,'" ry="').concat(o,'" width="').concat(e,'" height="').concat(t,`" />
`)]}static async fromElement(e,t,r){const o=FA(e,this.ATTRIBUTE_NAMES,r),{left:s=0,top:i=0,width:a=0,height:A=0,visible:d=!0}=o,c=so(o,AU);return new this(Je(Je(Je({},t),c),{},{left:s,top:i,width:a,height:A,visible:!!(d&&a&&A)}))}}Xe(na,"type","Rect"),Xe(na,"cacheProperties",[...EA,...bx]),Xe(na,"ownDefaults",{rx:0,ry:0}),Xe(na,"ATTRIBUTE_NAMES",[...yl,"x","y","rx","ry","width","height"]),lr.setClass(na),lr.setSVGClass(na);const pA="initialization",Qp="added",j1="removed",Tp="imperative",xx=(n,e)=>{const{strokeUniform:t,strokeWidth:r,width:o,height:s,group:i}=e,a=i&&i!==n?wg(i.calcTransformMatrix(),n.calcTransformMatrix()):null,A=a?e.getRelativeCenterPoint().transform(a):e.getRelativeCenterPoint(),d=!e.isStrokeAccountedForInDimensions(),c=t&&d?YF(new zt(r,r),void 0,n.calcTransformMatrix()):E1,u=!t&&d?r:0,h=T1(o+u,s+u,F1([a,e.calcOwnMatrix()],!0)).add(c).scalarDivide(2);return[A.subtract(h),A.add(h)]};class bg{calcLayoutResult(e,t){if(this.shouldPerformLayout(e))return this.calcBoundingBox(t,e)}shouldPerformLayout(e){let{type:t,prevStrategy:r,strategy:o}=e;return t===pA||t===Tp||!!r&&o!==r}shouldLayoutClipPath(e){let{type:t,target:{clipPath:r}}=e;return t!==pA&&r&&!r.absolutePositioned}getInitialSize(e,t){return t.size}calcBoundingBox(e,t){const{type:r,target:o}=t;if(r===Tp&&t.overrides)return t.overrides;if(e.length===0)return;const{left:s,top:i,width:a,height:A}=yA(e.map(u=>xx(o,u)).reduce((u,h)=>u.concat(h),[])),d=new zt(a,A),c=new zt(s,i).add(d.scalarDivide(2));if(r===pA){const u=this.getInitialSize(t,{size:d,center:c});return{center:c,relativeCorrection:new zt(0,0),size:u}}return{center:c.transform(o.calcOwnMatrix()),size:d}}}Xe(bg,"type","strategy");class W0 extends bg{shouldPerformLayout(e){return!0}}Xe(W0,"type","fit-content"),lr.setClass(W0);const lU=["strategy"],dU=["target","strategy","bubbles","prevStrategy"],Bx="layoutManager";class th{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new W0;Xe(this,"strategy",void 0),this.strategy=e,this._subscriptions=new Map}performLayout(e){const t=Je(Je({bubbles:!0,strategy:this.strategy},e),{},{prevStrategy:this._prevLayoutStrategy,stopPropagation(){this.bubbles=!1}});this.onBeforeLayout(t);const r=this.getLayoutResult(t);r&&this.commitLayout(t,r),this.onAfterLayout(t,r),this._prevLayoutStrategy=t.strategy}attachHandlers(e,t){const{target:r}=t;return[Cp,K5,Yu,$5,pg,V5,zp,kF,OF].map(o=>e.on(o,s=>this.performLayout(o===Cp?{type:"object_modified",trigger:o,e:s,target:r}:{type:"object_modifying",trigger:o,e:s,target:r})))}subscribe(e,t){this.unsubscribe(e,t);const r=this.attachHandlers(e,t);this._subscriptions.set(e,r)}unsubscribe(e,t){(this._subscriptions.get(e)||[]).forEach(r=>r()),this._subscriptions.delete(e)}unsubscribeTargets(e){e.targets.forEach(t=>this.unsubscribe(t,e))}subscribeTargets(e){e.targets.forEach(t=>this.subscribe(t,e))}onBeforeLayout(e){const{target:t,type:r}=e,{canvas:o}=t;if(r===pA||r===Qp?this.subscribeTargets(e):r===j1&&this.unsubscribeTargets(e),t.fire("layout:before",{context:e}),o&&o.fire("object:layout:before",{target:t,context:e}),r===Tp&&e.deep){const s=so(e,lU);t.forEachObject(i=>i.layoutManager&&i.layoutManager.performLayout(Je(Je({},s),{},{bubbles:!1,target:i})))}}getLayoutResult(e){const{target:t,strategy:r,type:o}=e,s=r.calcLayoutResult(e,t.getObjects());if(!s)return;const i=o===pA?new zt:t.getRelativeCenterPoint(),{center:a,correction:A=new zt,relativeCorrection:d=new zt}=s,c=i.subtract(a).add(A).transform(o===pA?Rs:sa(t.calcOwnMatrix()),!0).add(d);return{result:s,prevCenter:i,nextCenter:a,offset:c}}commitLayout(e,t){const{target:r}=e,{result:{size:o},nextCenter:s}=t;var i,a;r.set({width:o.x,height:o.y}),this.layoutObjects(e,t),e.type===pA?r.set({left:(i=e.x)!==null&&i!==void 0?i:s.x+o.x*Oo(r.originX),top:(a=e.y)!==null&&a!==void 0?a:s.y+o.y*Oo(r.originY)}):(r.setPositionByOrigin(s,Gr,Gr),r.setCoords(),r.set("dirty",!0))}layoutObjects(e,t){const{target:r}=e;r.forEachObject(o=>{o.group===r&&this.layoutObject(e,t,o)}),e.strategy.shouldLayoutClipPath(e)&&this.layoutObject(e,t,r.clipPath)}layoutObject(e,t,r){let{offset:o}=t;r.set({left:r.left+o.x,top:r.top+o.y})}onAfterLayout(e,t){const{target:r,strategy:o,bubbles:s,prevStrategy:i}=e,a=so(e,dU),{canvas:A}=r;r.fire("layout:after",{context:e,result:t}),A&&A.fire("object:layout:after",{context:e,result:t,target:r});const d=r.parent;s&&d!=null&&d.layoutManager&&((a.path||(a.path=[])).push(r),d.layoutManager.performLayout(Je(Je({},a),{},{target:d}))),r.set("dirty",!0)}dispose(){const{_subscriptions:e}=this;e.forEach(t=>t.forEach(r=>r())),e.clear()}toObject(){return{type:Bx,strategy:this.strategy.constructor.type}}toJSON(){return this.toObject()}}lr.setClass(th,Bx);const cU=["type","objects","layoutManager"];class uU extends th{performLayout(){}}class Xl extends G5(os){static getDefaults(){return Je(Je({},super.getDefaults()),Xl.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Xe(this,"_activeObjects",[]),Xe(this,"__objectSelectionTracker",void 0),Xe(this,"__objectSelectionDisposer",void 0),Object.assign(this,Xl.ownDefaults),this.setOptions(t),this.groupInit(e,t)}groupInit(e,t){var r;this._objects=[...e],this.__objectSelectionTracker=this.__objectSelectionMonitor.bind(this,!0),this.__objectSelectionDisposer=this.__objectSelectionMonitor.bind(this,!1),this.forEachObject(o=>{this.enterGroup(o,!1)}),this.layoutManager=(r=t.layoutManager)!==null&&r!==void 0?r:new th,this.layoutManager.performLayout({type:pA,target:this,targets:[...e],x:t.left,y:t.top})}canEnterGroup(e){return e===this||this.isDescendantOf(e)?(fl("error","Group: circular object trees are not supported, this call has no effect"),!1):this._objects.indexOf(e)===-1||(fl("error","Group: duplicate objects are not supported inside group, this call has no effect"),!1)}_filterObjectsBeforeEnteringGroup(e){return e.filter((t,r,o)=>this.canEnterGroup(t)&&o.indexOf(t)===r)}add(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];const o=this._filterObjectsBeforeEnteringGroup(t),s=super.add(...o);return this._onAfterObjectsChange(Qp,o),s}insertAt(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];const s=this._filterObjectsBeforeEnteringGroup(r),i=super.insertAt(e,...s);return this._onAfterObjectsChange(Qp,s),i}remove(){const e=super.remove(...arguments);return this._onAfterObjectsChange(j1,e),e}_onObjectAdded(e){this.enterGroup(e,!0),this.fire("object:added",{target:e}),e.fire("added",{target:this})}_onObjectRemoved(e,t){this.exitGroup(e,t),this.fire("object:removed",{target:e}),e.fire("removed",{target:this})}_onAfterObjectsChange(e,t){this.layoutManager.performLayout({type:e,targets:t,target:this})}_onStackOrderChanged(){this._set("dirty",!0)}_set(e,t){const r=this[e];return super._set(e,t),e==="canvas"&&r!==t&&(this._objects||[]).forEach(o=>{o._set(e,t)}),this}_shouldSetNestedCoords(){return this.subTargetCheck}removeAll(){return this._activeObjects=[],this.remove(...this._objects)}__objectSelectionMonitor(e,t){let{target:r}=t;const o=this._activeObjects;if(e)o.push(r),this._set("dirty",!0);else if(o.length>0){const s=o.indexOf(r);s>-1&&(o.splice(s,1),this._set("dirty",!0))}}_watchObject(e,t){e&&this._watchObject(!1,t),e?(t.on("selected",this.__objectSelectionTracker),t.on("deselected",this.__objectSelectionDisposer)):(t.off("selected",this.__objectSelectionTracker),t.off("deselected",this.__objectSelectionDisposer))}enterGroup(e,t){e.group&&e.group.remove(e),e._set("parent",this),this._enterGroup(e,t)}_enterGroup(e,t){t&&Ip(e,us(sa(this.calcTransformMatrix()),e.calcTransformMatrix())),this._shouldSetNestedCoords()&&e.setCoords(),e._set("group",this),e._set("canvas",this.canvas),this._watchObject(!0,e);const r=this.canvas&&this.canvas.getActiveObject&&this.canvas.getActiveObject();r&&(r===e||e.isDescendantOf(r))&&this._activeObjects.push(e)}exitGroup(e,t){this._exitGroup(e,t),e._set("parent",void 0),e._set("canvas",void 0)}_exitGroup(e,t){e._set("group",void 0),t||(Ip(e,us(this.calcTransformMatrix(),e.calcTransformMatrix())),e.setCoords()),this._watchObject(!1,e);const r=this._activeObjects.length>0?this._activeObjects.indexOf(e):-1;r>-1&&this._activeObjects.splice(r,1)}shouldCache(){const e=os.prototype.shouldCache.call(this);if(e){for(let t=0;t<this._objects.length;t++)if(this._objects[t].willDrawShadow())return this.ownCaching=!1,!1}return e}willDrawShadow(){if(super.willDrawShadow())return!0;for(let e=0;e<this._objects.length;e++)if(this._objects[e].willDrawShadow())return!0;return!1}isOnACache(){return this.ownCaching||!!this.parent&&this.parent.isOnACache()}drawObject(e,t,r){this._renderBackground(e);for(let s=0;s<this._objects.length;s++){var o;const i=this._objects[s];(o=this.canvas)!==null&&o!==void 0&&o.preserveObjectStacking&&i.group!==this?(e.save(),e.transform(...sa(this.calcTransformMatrix())),i.render(e),e.restore()):i.group===this&&i.render(e)}this._drawClipPath(e,this.clipPath,r)}setCoords(){super.setCoords(),this._shouldSetNestedCoords()&&this.forEachObject(e=>e.setCoords())}triggerLayout(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.layoutManager.performLayout(Je({target:this,type:Tp},e))}render(e){this._transformDone=!0,super.render(e),this._transformDone=!1}__serializeObjects(e,t){const r=this.includeDefaultValues;return this._objects.filter(function(o){return!o.excludeFromExport}).map(function(o){const s=o.includeDefaultValues;o.includeDefaultValues=r;const i=o[e||"toObject"](t);return o.includeDefaultValues=s,i})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.layoutManager.toObject();return Je(Je(Je({},super.toObject(["subTargetCheck","interactive",...e])),t.strategy!=="fit-content"||this.includeDefaultValues?{layoutManager:t}:{}),{},{objects:this.__serializeObjects("toObject",e)})}toString(){return"#<Group: (".concat(this.complexity(),")>")}dispose(){this.layoutManager.unsubscribeTargets({targets:this.getObjects(),target:this}),this._activeObjects=[],this.forEachObject(e=>{this._watchObject(!1,e),e.dispose()}),super.dispose()}_createSVGBgRect(e){if(!this.backgroundColor)return"";const t=na.prototype._toSVG.call(this),r=t.indexOf("COMMON_PARTS");t[r]='for="group" ';const o=t.join("");return e?e(o):o}_toSVG(e){const t=["<g ","COMMON_PARTS",` >
`],r=this._createSVGBgRect(e);r&&t.push("		",r);for(let o=0;o<this._objects.length;o++)t.push("		",this._objects[o].toSVG(e));return t.push(`</g>
`),t}getSvgStyles(){const e=this.opacity!==void 0&&this.opacity!==1?"opacity: ".concat(this.opacity,";"):"",t=this.visible?"":" visibility: hidden;";return[e,this.getSvgFilter(),t].join("")}toClipPathSVG(e){const t=[],r=this._createSVGBgRect(e);r&&t.push("	",r);for(let o=0;o<this._objects.length;o++)t.push("	",this._objects[o].toClipPathSVG(e));return this._createBaseClipPathSVGMarkup(t,{reviver:e})}static fromObject(e,t){let{type:r,objects:o=[],layoutManager:s}=e,i=so(e,cU);return Promise.all([Ju(o,t),mg(i,t)]).then(a=>{let[A,d]=a;const c=new this(A,Je(Je(Je({},i),d),{},{layoutManager:new uU}));if(s){const u=lr.getClass(s.type),h=lr.getClass(s.strategy);c.layoutManager=new u(new h)}else c.layoutManager=new th;return c.layoutManager.subscribeTargets({type:pA,target:c,targets:c.getObjects()}),c.setCoords(),c})}}Xe(Xl,"type","Group"),Xe(Xl,"ownDefaults",{strokeWidth:0,subTargetCheck:!1,interactive:!1}),lr.setClass(Xl);const hU=(n,e)=>Math.min(e.width/n.width,e.height/n.height),fU=(n,e)=>Math.max(e.width/n.width,e.height/n.height),X0="\\s*,?\\s*",iu="".concat(X0,"(").concat(sd,")"),pU="".concat(iu).concat(iu).concat(iu).concat(X0,"([01])").concat(X0,"([01])").concat(iu).concat(iu),gU={m:"l",M:"L"},vU=(n,e,t,r,o,s,i,a,A,d,c)=>{const u=BA(n),h=zA(n),p=BA(e),v=zA(e),w=t*o*p-r*s*v+i,y=r*o*p+t*s*v+a;return["C",d+A*(-t*o*h-r*s*u),c+A*(-r*o*h+t*s*u),w+A*(t*o*v+r*s*p),y+A*(r*o*v-t*s*p),w,y]},ey=(n,e,t,r)=>{const o=Math.atan2(e,n),s=Math.atan2(r,t);return s>=o?s-o:2*Math.PI-(o-s)};function ty(n,e,t,r,o,s,i,a){let A;if(mn.cachesBoundsOfCurve&&(A=[...arguments].join(),Eu.boundsOfCurveCache[A]))return Eu.boundsOfCurveCache[A];const d=Math.sqrt,c=Math.abs,u=[],h=[[0,0],[0,0]];let p=6*n-12*t+6*o,v=-3*n+9*t-9*o+3*i,w=3*t-3*n;for(let k=0;k<2;++k){if(k>0&&(p=6*e-12*r+6*s,v=-3*e+9*r-9*s+3*a,w=3*r-3*e),c(v)<1e-12){if(c(p)<1e-12)continue;const re=-w/p;0<re&&re<1&&u.push(re);continue}const H=p*p-4*w*v;if(H<0)continue;const Z=d(H),q=(-p+Z)/(2*v);0<q&&q<1&&u.push(q);const N=(-p-Z)/(2*v);0<N&&N<1&&u.push(N)}let y=u.length;const B=y,C=zx(n,e,t,r,o,s,i,a);for(;y--;){const{x:k,y:H}=C(u[y]);h[0][y]=k,h[1][y]=H}h[0][B]=n,h[1][B]=e,h[0][B+1]=i,h[1][B+1]=a;const Q=[new zt(Math.min(...h[0]),Math.min(...h[1])),new zt(Math.max(...h[0]),Math.max(...h[1]))];return mn.cachesBoundsOfCurve&&(Eu.boundsOfCurveCache[A]=Q),Q}const mU=(n,e,t)=>{let[r,o,s,i,a,A,d,c]=t;const u=((h,p,v,w,y,B,C)=>{if(v===0||w===0)return[];let Q=0,k=0,H=0;const Z=Math.PI,q=C*B1,N=zA(q),re=BA(q),be=.5*(-re*h-N*p),L=.5*(-re*p+N*h),R=v**2,J=w**2,se=L**2,fe=be**2,ie=R*J-R*se-J*fe;let pe=Math.abs(v),te=Math.abs(w);if(ie<0){const M=Math.sqrt(1-ie/(R*J));pe*=M,te*=M}else H=(y===B?-1:1)*Math.sqrt(ie/(R*se+J*fe));const Ce=H*pe*L/te,ne=-H*te*be/pe,ze=re*Ce-N*ne+.5*h,z=N*Ce+re*ne+.5*p;let E=ey(1,0,(be-Ce)/pe,(L-ne)/te),F=ey((be-Ce)/pe,(L-ne)/te,(-be-Ce)/pe,(-L-ne)/te);B===0&&F>0?F-=2*Z:B===1&&F<0&&(F+=2*Z);const I=Math.ceil(Math.abs(F/Z*2)),O=[],D=F/I,P=8/3*Math.sin(D/4)*Math.sin(D/4)/Math.sin(D/2);let K=E+D;for(let M=0;M<I;M++)O[M]=vU(E,K,re,N,pe,te,ze,z,P,Q,k),Q=O[M][5],k=O[M][6],E=K,K+=D;return O})(d-n,c-e,o,s,a,A,i);for(let h=0,p=u.length;h<p;h++)u[h][1]+=n,u[h][2]+=e,u[h][3]+=n,u[h][4]+=e,u[h][5]+=n,u[h][6]+=e;return u},wU=n=>{let e=0,t=0,r=0,o=0;const s=[];let i,a=0,A=0;for(const d of n){const c=[...d];let u;switch(c[0]){case"l":c[1]+=e,c[2]+=t;case"L":e=c[1],t=c[2],u=["L",e,t];break;case"h":c[1]+=e;case"H":e=c[1],u=["L",e,t];break;case"v":c[1]+=t;case"V":t=c[1],u=["L",e,t];break;case"m":c[1]+=e,c[2]+=t;case"M":e=c[1],t=c[2],r=c[1],o=c[2],u=["M",e,t];break;case"c":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t,c[5]+=e,c[6]+=t;case"C":a=c[3],A=c[4],e=c[5],t=c[6],u=["C",c[1],c[2],a,A,e,t];break;case"s":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t;case"S":i==="C"?(a=2*e-a,A=2*t-A):(a=e,A=t),e=c[3],t=c[4],u=["C",a,A,c[1],c[2],e,t],a=u[3],A=u[4];break;case"q":c[1]+=e,c[2]+=t,c[3]+=e,c[4]+=t;case"Q":a=c[1],A=c[2],e=c[3],t=c[4],u=["Q",a,A,e,t];break;case"t":c[1]+=e,c[2]+=t;case"T":i==="Q"?(a=2*e-a,A=2*t-A):(a=e,A=t),e=c[1],t=c[2],u=["Q",a,A,e,t];break;case"a":c[6]+=e,c[7]+=t;case"A":mU(e,t,c).forEach(h=>s.push(h)),e=c[6],t=c[7];break;case"z":case"Z":e=r,t=o,u=["Z"]}u?(s.push(u),i=u[0]):i=""}return s},Lp=(n,e,t,r)=>Math.sqrt((t-n)**2+(r-e)**2),zx=(n,e,t,r,o,s,i,a)=>A=>{const d=A**3,c=(p=>3*p**2*(1-p))(A),u=(p=>3*p*(1-p)**2)(A),h=(p=>(1-p)**3)(A);return new zt(i*d+o*c+t*u+n*h,a*d+s*c+r*u+e*h)},Cx=n=>n**2,Sx=n=>2*n*(1-n),Ex=n=>(1-n)**2,yU=(n,e,t,r,o,s,i,a)=>A=>{const d=Cx(A),c=Sx(A),u=Ex(A),h=3*(u*(t-n)+c*(o-t)+d*(i-o)),p=3*(u*(r-e)+c*(s-r)+d*(a-s));return Math.atan2(p,h)},_U=(n,e,t,r,o,s)=>i=>{const a=Cx(i),A=Sx(i),d=Ex(i);return new zt(o*a+t*A+n*d,s*a+r*A+e*d)},bU=(n,e,t,r,o,s)=>i=>{const a=1-i,A=2*(a*(t-n)+i*(o-t)),d=2*(a*(r-e)+i*(s-r));return Math.atan2(d,A)},ry=(n,e,t)=>{let r=new zt(e,t),o=0;for(let s=1;s<=100;s+=1){const i=n(s/100);o+=Lp(r.x,r.y,i.x,i.y),r=i}return o},xU=(n,e)=>{let t,r=0,o=0,s={x:n.x,y:n.y},i=Je({},s),a=.01,A=0;const d=n.iterator,c=n.angleFinder;for(;o<e&&a>1e-4;)i=d(r),A=r,t=Lp(s.x,s.y,i.x,i.y),t+o>e?(r-=a,a/=2):(s=i,r+=a,o+=t);return Je(Je({},i),{},{angle:c(A)})},Fx=n=>{let e,t,r=0,o=0,s=0,i=0,a=0;const A=[];for(const d of n){const c={x:o,y:s,command:d[0],length:0};switch(d[0]){case"M":t=c,t.x=i=o=d[1],t.y=a=s=d[2];break;case"L":t=c,t.length=Lp(o,s,d[1],d[2]),o=d[1],s=d[2];break;case"C":e=zx(o,s,d[1],d[2],d[3],d[4],d[5],d[6]),t=c,t.iterator=e,t.angleFinder=yU(o,s,d[1],d[2],d[3],d[4],d[5],d[6]),t.length=ry(e,o,s),o=d[5],s=d[6];break;case"Q":e=_U(o,s,d[1],d[2],d[3],d[4]),t=c,t.iterator=e,t.angleFinder=bU(o,s,d[1],d[2],d[3],d[4]),t.length=ry(e,o,s),o=d[3],s=d[4];break;case"Z":t=c,t.destX=i,t.destY=a,t.length=Lp(o,s,i,a),o=i,s=a}r+=t.length,A.push(t)}return A.push({length:r,x:o,y:s}),A},BU=function(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Fx(n),r=0;for(;e-t[r].length>0&&r<t.length-2;)e-=t[r].length,r++;const o=t[r],s=e/o.length,i=n[r];switch(o.command){case"M":return{x:o.x,y:o.y,angle:0};case"Z":return Je(Je({},new zt(o.x,o.y).lerp(new zt(o.destX,o.destY),s)),{},{angle:Math.atan2(o.destY-o.y,o.destX-o.x)});case"L":return Je(Je({},new zt(o.x,o.y).lerp(new zt(i[1],i[2]),s)),{},{angle:Math.atan2(i[2]-o.y,i[1]-o.x)});case"C":case"Q":return xU(o,e)}},zU=new RegExp("[mzlhvcsqta][^mzlhvcsqta]*","gi"),ny=new RegExp(pU,"g"),CU=new RegExp(sd,"gi"),SU={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},EU=n=>{var e;const t=[],r=(e=n.match(zU))!==null&&e!==void 0?e:[];for(const o of r){const s=o[0];if(s==="z"||s==="Z"){t.push([s]);continue}const i=SU[s.toLowerCase()];let a=[];if(s==="a"||s==="A"){ny.lastIndex=0;for(let A=null;A=ny.exec(o);)a.push(...A.slice(1))}else a=o.match(CU)||[];for(let A=0;A<a.length;A+=i){const d=new Array(i),c=gU[s];d[0]=A>0&&c?c:s;for(let u=0;u<i;u++)d[u+1]=parseFloat(a[A+u]);t.push(d)}}return t},FU=(n,e)=>n.map(t=>t.map((r,o)=>o===0||e===void 0?r:uo(r,e)).join(" ")).join(" ");function Y0(n,e){const t=n.style;t&&e&&(typeof e=="string"?t.cssText+=";"+e:Object.entries(e).forEach(r=>{let[o,s]=r;return t.setProperty(o,s)}))}class IU extends ox{constructor(e){let{allowTouchScrolling:t=!1,containerClass:r=""}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(e),Xe(this,"upper",void 0),Xe(this,"container",void 0);const{el:o}=this.lower,s=this.createUpperCanvas();this.upper={el:s,ctx:s.getContext("2d")},this.applyCanvasStyle(o,{allowTouchScrolling:t}),this.applyCanvasStyle(s,{allowTouchScrolling:t,styles:{position:"absolute",left:"0",top:"0"}});const i=this.createContainerElement();i.classList.add(r),o.parentNode&&o.parentNode.replaceChild(i,o),i.append(o,s),this.container=i}createUpperCanvas(){const{el:e}=this.lower,t=la();return t.className=e.className,t.classList.remove("lower-canvas"),t.classList.add("upper-canvas"),t.setAttribute("data-fabric","top"),t.style.cssText=e.style.cssText,t.setAttribute("draggable","true"),t}createContainerElement(){const e=Oc().createElement("div");return e.setAttribute("data-fabric","wrapper"),Y0(e,{position:"relative"}),Pw(e),e}applyCanvasStyle(e,t){const{styles:r,allowTouchScrolling:o}=t;Y0(e,Je(Je({},r),{},{"touch-action":o?"manipulation":Zs})),Pw(e)}setDimensions(e,t){super.setDimensions(e,t);const{el:r,ctx:o}=this.upper;nx(r,o,e,t)}setCSSDimensions(e){super.setCSSDimensions(e),j0(this.upper.el,e),j0(this.container,e)}cleanupDOM(e){const t=this.container,{el:r}=this.lower,{el:o}=this.upper;super.cleanupDOM(e),t.removeChild(o),t.removeChild(r),t.parentNode&&t.parentNode.replaceChild(r,t)}dispose(){super.dispose(),Ha().dispose(this.upper.el),delete this.upper,delete this.container}}class xg extends Q1{constructor(){super(...arguments),Xe(this,"targets",[]),Xe(this,"_hoveredTargets",[]),Xe(this,"_objectsToRender",void 0),Xe(this,"_currentTransform",null),Xe(this,"_groupSelector",null),Xe(this,"contextTopDirty",!1)}static getDefaults(){return Je(Je({},super.getDefaults()),xg.ownDefaults)}get upperCanvasEl(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.el}get contextTop(){var e;return(e=this.elements.upper)===null||e===void 0?void 0:e.ctx}get wrapperEl(){return this.elements.container}initElements(e){this.elements=new IU(e,{allowTouchScrolling:this.allowTouchScrolling,containerClass:this.containerClass}),this._createCacheCanvas()}_onObjectAdded(e){this._objectsToRender=void 0,super._onObjectAdded(e)}_onObjectRemoved(e){this._objectsToRender=void 0,e===this._activeObject&&(this.fire("before:selection:cleared",{deselected:[e]}),this._discardActiveObject(),this.fire("selection:cleared",{deselected:[e]}),e.fire("deselected",{target:e})),e===this._hoveredTarget&&(this._hoveredTarget=void 0,this._hoveredTargets=[]),super._onObjectRemoved(e)}_onStackOrderChanged(){this._objectsToRender=void 0,super._onStackOrderChanged()}_chooseObjectsToRender(){const e=this._activeObject;return!this.preserveObjectStacking&&e?this._objects.filter(t=>!t.group&&t!==e).concat(e):this._objects}renderAll(){this.cancelRequestedRender(),this.destroyed||(!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1),!this._objectsToRender&&(this._objectsToRender=this._chooseObjectsToRender()),this.renderCanvas(this.getContext(),this._objectsToRender))}renderTopLayer(e){e.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(e),this.contextTopDirty=!0),e.restore()}renderTop(){const e=this.contextTop;this.clearContext(e),this.renderTopLayer(e),this.fire("after:render",{ctx:e})}setTargetFindTolerance(e){e=Math.round(e),this.targetFindTolerance=e;const t=this.getRetinaScaling(),r=Math.ceil((2*e+1)*t);this.pixelFindCanvasEl.width=this.pixelFindCanvasEl.height=r,this.pixelFindContext.scale(t,t)}isTargetTransparent(e,t,r){const o=this.targetFindTolerance,s=this.pixelFindContext;this.clearContext(s),s.save(),s.translate(-t+o,-r+o),s.transform(...this.viewportTransform);const i=e.selectionBackgroundColor;e.selectionBackgroundColor="",e.render(s),e.selectionBackgroundColor=i,s.restore();const a=Math.round(o*this.getRetinaScaling());return PI(s,a,a,a)}_isSelectionKeyPressed(e){const t=this.selectionKey;return!!t&&(Array.isArray(t)?!!t.find(r=>!!r&&e[r]===!0):e[t])}_shouldClearSelection(e,t){const r=this.getActiveObjects(),o=this._activeObject;return!!(!t||t&&o&&r.length>1&&r.indexOf(t)===-1&&o!==t&&!this._isSelectionKeyPressed(e)||t&&!t.evented||t&&!t.selectable&&o&&o!==t)}_shouldCenterTransform(e,t,r){if(!e)return;let o;return t===gg||t===oi||t===Hi||t===Yu?o=this.centeredScaling||e.centeredScaling:t===S1&&(o=this.centeredRotation||e.centeredRotation),o?!r:r}_getOriginFromCorner(e,t){const r={x:e.originX,y:e.originY};return t&&(["ml","tl","bl"].includes(t)?r.x=So:["mr","tr","br"].includes(t)&&(r.x=zn),["tl","mt","tr"].includes(t)?r.y=H0:["bl","mb","br"].includes(t)&&(r.y=Js)),r}_setupCurrentTransform(e,t,r){var o;const s=t.group?hc(this.getScenePoint(e),void 0,t.group.calcTransformMatrix()):this.getScenePoint(e),{key:i="",control:a}=t.getActiveControl()||{},A=r&&a?(o=a.getActionHandler(e,t,a))===null||o===void 0?void 0:o.bind(a):eI,d=((p,v,w,y)=>{if(!v||!p)return"drag";const B=y.controls[v];return B.getActionName(w,B,y)})(r,i,e,t),c=e[this.centeredKey],u=this._shouldCenterTransform(t,d,c)?{x:Gr,y:Gr}:this._getOriginFromCorner(t,i),h={target:t,action:d,actionHandler:A,actionPerformed:!1,corner:i,scaleX:t.scaleX,scaleY:t.scaleY,skewX:t.skewX,skewY:t.skewY,offsetX:s.x-t.left,offsetY:s.y-t.top,originX:u.x,originY:u.y,ex:s.x,ey:s.y,lastX:s.x,lastY:s.y,theta:Uo(t.angle),width:t.width,height:t.height,shiftKey:e.shiftKey,altKey:c,original:Je(Je({},ix(t)),{},{originX:u.x,originY:u.y})};this._currentTransform=h,this.fire("before:transform",{e,transform:h})}setCursor(e){this.upperCanvasEl.style.cursor=e}_drawSelection(e){const{x:t,y:r,deltaX:o,deltaY:s}=this._groupSelector,i=new zt(t,r).transform(this.viewportTransform),a=new zt(t+o,r+s).transform(this.viewportTransform),A=this.selectionLineWidth/2;let d=Math.min(i.x,a.x),c=Math.min(i.y,a.y),u=Math.max(i.x,a.x),h=Math.max(i.y,a.y);this.selectionColor&&(e.fillStyle=this.selectionColor,e.fillRect(d,c,u-d,h-c)),this.selectionLineWidth&&this.selectionBorderColor&&(e.lineWidth=this.selectionLineWidth,e.strokeStyle=this.selectionBorderColor,d+=A,c+=A,u-=A,h-=A,os.prototype._setLineDash.call(this,e,this.selectionDashArray),e.strokeRect(d,c,u-d,h-c))}findTarget(e){if(this.skipTargetFind)return;const t=this.getViewportPoint(e),r=this._activeObject,o=this.getActiveObjects();if(this.targets=[],r&&o.length>=1){if(r.findControl(t,R0(e))||o.length>1&&this.searchPossibleTargets([r],t))return r;if(r===this.searchPossibleTargets([r],t)){if(this.preserveObjectStacking){const s=this.targets;this.targets=[];const i=this.searchPossibleTargets(this._objects,t);return e[this.altSelectionKey]&&i&&i!==r?(this.targets=s,r):i}return r}}return this.searchPossibleTargets(this._objects,t)}_pointIsInObjectSelectionArea(e,t){let r=e.getCoords();const o=this.getZoom(),s=e.padding/o;if(s){const[i,a,A,d]=r,c=Math.atan2(a.y-i.y,a.x-i.x),u=BA(c)*s,h=zA(c)*s,p=u+h,v=u-h;r=[new zt(i.x-v,i.y-p),new zt(a.x+p,a.y-v),new zt(A.x+v,A.y+p),new zt(d.x-p,d.y+v)]}return co.isPointInPolygon(t,r)}_checkTarget(e,t){return!!(e&&e.visible&&e.evented&&this._pointIsInObjectSelectionArea(e,hc(t,void 0,this.viewportTransform))&&(!this.perPixelTargetFind&&!e.perPixelTargetFind||e.isEditing||!this.isTargetTransparent(e,t.x,t.y)))}_searchPossibleTargets(e,t){let r=e.length;for(;r--;){const o=e[r];if(this._checkTarget(o,t)){if(ep(o)&&o.subTargetCheck){const s=this._searchPossibleTargets(o._objects,t);s&&this.targets.push(s)}return o}}}searchPossibleTargets(e,t){const r=this._searchPossibleTargets(e,t);if(r&&ep(r)&&r.interactive&&this.targets[0]){const o=this.targets;for(let s=o.length-1;s>0;s--){const i=o[s];if(!ep(i)||!i.interactive)return i}return o[0]}return r}getViewportPoint(e){return this._pointer?this._pointer:this.getPointer(e,!0)}getScenePoint(e){return this._absolutePointer?this._absolutePointer:this.getPointer(e)}getPointer(e){let t=arguments.length>1&&arguments[1]!==void 0&&arguments[1];const r=this.upperCanvasEl,o=r.getBoundingClientRect();let s=VF(e),i=o.width||0,a=o.height||0;i&&a||(Js in o&&H0 in o&&(a=Math.abs(o.top-o.bottom)),So in o&&zn in o&&(i=Math.abs(o.right-o.left))),this.calcOffset(),s.x=s.x-this._offset.left,s.y=s.y-this._offset.top,t||(s=hc(s,void 0,this.viewportTransform));const A=this.getRetinaScaling();A!==1&&(s.x/=A,s.y/=A);const d=i===0||a===0?new zt(1,1):new zt(r.width/i,r.height/a);return s.multiply(d)}_setDimensionsImpl(e,t){this._resetTransformEventData(),super._setDimensionsImpl(e,t),this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop)}_createCacheCanvas(){this.pixelFindCanvasEl=la(),this.pixelFindContext=this.pixelFindCanvasEl.getContext("2d",{willReadFrequently:!0}),this.setTargetFindTolerance(this.targetFindTolerance)}getTopContext(){return this.elements.upper.ctx}getSelectionContext(){return this.elements.upper.ctx}getSelectionElement(){return this.elements.upper.el}getActiveObject(){return this._activeObject}getActiveObjects(){const e=this._activeObject;return Ll(e)?e.getObjects():e?[e]:[]}_fireSelectionEvents(e,t){let r=!1,o=!1;const s=this.getActiveObjects(),i=[],a=[];e.forEach(A=>{s.includes(A)||(r=!0,A.fire("deselected",{e:t,target:A}),a.push(A))}),s.forEach(A=>{e.includes(A)||(r=!0,A.fire("selected",{e:t,target:A}),i.push(A))}),e.length>0&&s.length>0?(o=!0,r&&this.fire("selection:updated",{e:t,selected:i,deselected:a})):s.length>0?(o=!0,this.fire("selection:created",{e:t,selected:i})):e.length>0&&(o=!0,this.fire("selection:cleared",{e:t,deselected:a})),o&&(this._objectsToRender=void 0)}setActiveObject(e,t){const r=this.getActiveObjects(),o=this._setActiveObject(e,t);return this._fireSelectionEvents(r,t),o}_setActiveObject(e,t){const r=this._activeObject;return r!==e&&!(!this._discardActiveObject(t,e)&&this._activeObject)&&!e.onSelect({e:t})&&(this._activeObject=e,Ll(e)&&r!==e&&e.set("canvas",this),e.setCoords(),!0)}_discardActiveObject(e,t){const r=this._activeObject;return!!r&&!r.onDeselect({e,object:t})&&(this._currentTransform&&this._currentTransform.target===r&&this.endCurrentTransform(e),Ll(r)&&r===this._hoveredTarget&&(this._hoveredTarget=void 0),this._activeObject=void 0,!0)}discardActiveObject(e){const t=this.getActiveObjects(),r=this.getActiveObject();t.length&&this.fire("before:selection:cleared",{e,deselected:[r]});const o=this._discardActiveObject(e);return this._fireSelectionEvents(t,e),o}endCurrentTransform(e){const t=this._currentTransform;this._finalizeCurrentTransform(e),t&&t.target&&(t.target.isMoving=!1),this._currentTransform=null}_finalizeCurrentTransform(e){const t=this._currentTransform,r=t.target,o={e,target:r,transform:t,action:t.action};r._scaling&&(r._scaling=!1),r.setCoords(),t.actionPerformed&&(this.fire("object:modified",o),r.fire(Cp,o))}setViewportTransform(e){super.setViewportTransform(e);const t=this._activeObject;t&&t.setCoords()}destroy(){const e=this._activeObject;Ll(e)&&(e.removeAll(),e.dispose()),delete this._activeObject,super.destroy(),this.pixelFindContext=null,this.pixelFindCanvasEl=void 0}clear(){this.discardActiveObject(),this._activeObject=void 0,this.clearContext(this.contextTop),super.clear()}drawControls(e){const t=this._activeObject;t&&t._renderControls(e)}_toObject(e,t,r){const o=this._realizeGroupTransformOnObject(e),s=super._toObject(e,t,r);return e.set(o),s}_realizeGroupTransformOnObject(e){const{group:t}=e;if(t&&Ll(t)&&this._activeObject===t){const r=Mc(e,["angle","flipX","flipY",zn,oi,Hi,Dc,Nc,Js]);return WF(e,t.calcOwnMatrix()),r}return{}}_setSVGObject(e,t,r){const o=this._realizeGroupTransformOnObject(t);super._setSVGObject(e,t,r),t.set(o)}}Xe(xg,"ownDefaults",{uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",selection:!0,selectionKey:"shiftKey",selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,enablePointerEvents:!1,containerClass:"canvas-container",preserveObjectStacking:!1});class UU{constructor(e){Xe(this,"targets",[]),Xe(this,"__disposer",void 0);const t=()=>{const{hiddenTextarea:o}=e.getActiveObject()||{};o&&o.focus()},r=e.upperCanvasEl;r.addEventListener("click",t),this.__disposer=()=>r.removeEventListener("click",t)}exitTextEditing(){this.target=void 0,this.targets.forEach(e=>{e.isEditing&&e.exitEditing()})}add(e){this.targets.push(e)}remove(e){this.unregister(e),Gd(this.targets,e)}register(e){this.target=e}unregister(e){e===this.target&&(this.target=void 0)}onMouseMove(e){var t;!((t=this.target)===null||t===void 0)&&t.isEditing&&this.target.updateSelectionOnMouseMove(e)}clear(){this.targets=[],this.target=void 0}dispose(){this.clear(),this.__disposer(),delete this.__disposer}}const QU=["target","oldTarget","fireCanvas","e"],gi={passive:!1},Dd=(n,e)=>{const t=n.getViewportPoint(e),r=n.getScenePoint(e);return{viewportPoint:t,scenePoint:r,pointer:t,absolutePointer:r}},$A=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.addEventListener(...t)},Li=function(n){for(var e=arguments.length,t=new Array(e>1?e-1:0),r=1;r<e;r++)t[r-1]=arguments[r];return n.removeEventListener(...t)},TU={mouse:{in:"over",out:"out",targetIn:"mouseover",targetOut:"mouseout",canvasIn:"mouse:over",canvasOut:"mouse:out"},drag:{in:"enter",out:"leave",targetIn:"dragenter",targetOut:"dragleave",canvasIn:"drag:enter",canvasOut:"drag:leave"}};class J0 extends xg{constructor(e){super(e,arguments.length>1&&arguments[1]!==void 0?arguments[1]:{}),Xe(this,"_isClick",void 0),Xe(this,"textEditingManager",new UU(this)),["_onMouseDown","_onTouchStart","_onMouseMove","_onMouseUp","_onTouchEnd","_onResize","_onMouseWheel","_onMouseOut","_onMouseEnter","_onContextMenu","_onDoubleClick","_onDragStart","_onDragEnd","_onDragProgress","_onDragOver","_onDragEnter","_onDragLeave","_onDrop"].forEach(t=>{this[t]=this[t].bind(this)}),this.addOrRemove($A,"add")}_getEventPrefix(){return this.enablePointerEvents?"pointer":"mouse"}addOrRemove(e,t){const r=this.upperCanvasEl,o=this._getEventPrefix();e(rx(r),"resize",this._onResize),e(r,o+"down",this._onMouseDown),e(r,"".concat(o,"move"),this._onMouseMove,gi),e(r,"".concat(o,"out"),this._onMouseOut),e(r,"".concat(o,"enter"),this._onMouseEnter),e(r,"wheel",this._onMouseWheel),e(r,"contextmenu",this._onContextMenu),e(r,"dblclick",this._onDoubleClick),e(r,"dragstart",this._onDragStart),e(r,"dragend",this._onDragEnd),e(r,"dragover",this._onDragOver),e(r,"dragenter",this._onDragEnter),e(r,"dragleave",this._onDragLeave),e(r,"drop",this._onDrop),this.enablePointerEvents||e(r,"touchstart",this._onTouchStart,gi)}removeListeners(){this.addOrRemove(Li,"remove");const e=this._getEventPrefix(),t=oa(this.upperCanvasEl);Li(t,"".concat(e,"up"),this._onMouseUp),Li(t,"touchend",this._onTouchEnd,gi),Li(t,"".concat(e,"move"),this._onMouseMove,gi),Li(t,"touchmove",this._onMouseMove,gi),clearTimeout(this._willAddMouseDown)}_onMouseWheel(e){this.__onMouseWheel(e)}_onMouseOut(e){const t=this._hoveredTarget,r=Je({e},Dd(this,e));this.fire("mouse:out",Je(Je({},r),{},{target:t})),this._hoveredTarget=void 0,t&&t.fire("mouseout",Je({},r)),this._hoveredTargets.forEach(o=>{this.fire("mouse:out",Je(Je({},r),{},{target:o})),o&&o.fire("mouseout",Je({},r))}),this._hoveredTargets=[]}_onMouseEnter(e){this._currentTransform||this.findTarget(e)||(this.fire("mouse:over",Je({e},Dd(this,e))),this._hoveredTarget=void 0,this._hoveredTargets=[])}_onDragStart(e){this._isClick=!1;const t=this.getActiveObject();if(t&&t.onDragStart(e)){this._dragSource=t;const r={e,target:t};return this.fire("dragstart",r),t.fire("dragstart",r),void $A(this.upperCanvasEl,"drag",this._onDragProgress)}q0(e)}_renderDragEffects(e,t,r){let o=!1;const s=this._dropTarget;s&&s!==t&&s!==r&&(s.clearContextTop(),o=!0),t==null||t.clearContextTop(),r!==t&&(r==null||r.clearContextTop());const i=this.contextTop;i.save(),i.transform(...this.viewportTransform),t&&(i.save(),t.transform(i),t.renderDragSourceEffect(e),i.restore(),o=!0),r&&(i.save(),r.transform(i),r.renderDropTargetEffect(e),i.restore(),o=!0),i.restore(),o&&(this.contextTopDirty=!0)}_onDragEnd(e){const t=!!e.dataTransfer&&e.dataTransfer.dropEffect!==Zs,r=t?this._activeObject:void 0,o={e,target:this._dragSource,subTargets:this.targets,dragSource:this._dragSource,didDrop:t,dropTarget:r};Li(this.upperCanvasEl,"drag",this._onDragProgress),this.fire("dragend",o),this._dragSource&&this._dragSource.fire("dragend",o),delete this._dragSource,this._onMouseUp(e)}_onDragProgress(e){const t={e,target:this._dragSource,dragSource:this._dragSource,dropTarget:this._draggedoverTarget};this.fire("drag",t),this._dragSource&&this._dragSource.fire("drag",t)}findDragTargets(e){return this.targets=[],{target:this._searchPossibleTargets(this._objects,this.getViewportPoint(e)),targets:[...this.targets]}}_onDragOver(e){const t="dragover",{target:r,targets:o}=this.findDragTargets(e),s=this._dragSource,i={e,target:r,subTargets:o,dragSource:s,canDrop:!1,dropTarget:void 0};let a;this.fire(t,i),this._fireEnterLeaveEvents(r,i),r&&(r.canDrop(e)&&(a=r),r.fire(t,i));for(let A=0;A<o.length;A++){const d=o[A];d.canDrop(e)&&(a=d),d.fire(t,i)}this._renderDragEffects(e,s,a),this._dropTarget=a}_onDragEnter(e){const{target:t,targets:r}=this.findDragTargets(e),o={e,target:t,subTargets:r,dragSource:this._dragSource};this.fire("dragenter",o),this._fireEnterLeaveEvents(t,o)}_onDragLeave(e){const t={e,target:this._draggedoverTarget,subTargets:this.targets,dragSource:this._dragSource};this.fire("dragleave",t),this._fireEnterLeaveEvents(void 0,t),this._renderDragEffects(e,this._dragSource),this._dropTarget=void 0,this.targets=[],this._hoveredTargets=[]}_onDrop(e){const{target:t,targets:r}=this.findDragTargets(e),o=this._basicEventHandler("drop:before",Je({e,target:t,subTargets:r,dragSource:this._dragSource},Dd(this,e)));o.didDrop=!1,o.dropTarget=void 0,this._basicEventHandler("drop",o),this.fire("drop:after",o)}_onContextMenu(e){const t=this.findTarget(e),r=this.targets||[],o=this._basicEventHandler("contextmenu:before",{e,target:t,subTargets:r});return this.stopContextMenu&&q0(e),this._basicEventHandler("contextmenu",o),!1}_onDoubleClick(e){this._cacheTransformEventData(e),this._handleEvent(e,"dblclick"),this._resetTransformEventData()}getPointerId(e){const t=e.changedTouches;return t?t[0]&&t[0].identifier:this.enablePointerEvents?e.pointerId:-1}_isMainEvent(e){return e.isPrimary===!0||e.isPrimary!==!1&&(e.type==="touchend"&&e.touches.length===0||!e.changedTouches||e.changedTouches[0].identifier===this.mainTouchId)}_onTouchStart(e){let t=!this.allowTouchScrolling;const r=this._activeObject;this.mainTouchId===void 0&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),(this.isDrawingMode||r&&this._target===r)&&(t=!0),t&&e.preventDefault(),this._resetTransformEventData();const o=this.upperCanvasEl,s=this._getEventPrefix(),i=oa(o);$A(i,"touchend",this._onTouchEnd,gi),t&&$A(i,"touchmove",this._onMouseMove,gi),Li(o,"".concat(s,"down"),this._onMouseDown)}_onMouseDown(e){this.__onMouseDown(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();Li(t,"".concat(r,"move"),this._onMouseMove,gi);const o=oa(t);$A(o,"".concat(r,"up"),this._onMouseUp),$A(o,"".concat(r,"move"),this._onMouseMove,gi)}_onTouchEnd(e){if(e.touches.length>0)return;this.__onMouseUp(e),this._resetTransformEventData(),delete this.mainTouchId;const t=this._getEventPrefix(),r=oa(this.upperCanvasEl);Li(r,"touchend",this._onTouchEnd,gi),Li(r,"touchmove",this._onMouseMove,gi),this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(()=>{$A(this.upperCanvasEl,"".concat(t,"down"),this._onMouseDown),this._willAddMouseDown=0},400)}_onMouseUp(e){this.__onMouseUp(e),this._resetTransformEventData();const t=this.upperCanvasEl,r=this._getEventPrefix();if(this._isMainEvent(e)){const o=oa(this.upperCanvasEl);Li(o,"".concat(r,"up"),this._onMouseUp),Li(o,"".concat(r,"move"),this._onMouseMove,gi),$A(t,"".concat(r,"move"),this._onMouseMove,gi)}}_onMouseMove(e){const t=this.getActiveObject();!this.allowTouchScrolling&&(!t||!t.shouldStartDragging(e))&&e.preventDefault&&e.preventDefault(),this.__onMouseMove(e)}_onResize(){this.calcOffset(),this._resetTransformEventData()}_shouldRender(e){const t=this.getActiveObject();return!!t!=!!e||t&&e&&t!==e}__onMouseUp(e){var t;this._cacheTransformEventData(e),this._handleEvent(e,"up:before");const r=this._currentTransform,o=this._isClick,s=this._target,{button:i}=e;if(i)return(this.fireMiddleClick&&i===1||this.fireRightClick&&i===2)&&this._handleEvent(e,"up"),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)return void this._onMouseUpInDrawingMode(e);if(!this._isMainEvent(e))return;let a,A,d=!1;if(r&&(this._finalizeCurrentTransform(e),d=r.actionPerformed),!o){const c=s===this._activeObject;this.handleSelection(e),d||(d=this._shouldRender(s)||!c&&s===this._activeObject)}if(s){const c=s.findControl(this.getViewportPoint(e),R0(e)),{key:u,control:h}=c||{};if(A=u,s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,e),d=!0;else if(h){const p=h.getMouseUpHandler(e,s,h);p&&(a=this.getScenePoint(e),p.call(h,e,r,a.x,a.y))}s.isMoving=!1}if(r&&(r.target!==s||r.corner!==A)){const c=r.target&&r.target.controls[r.corner],u=c&&c.getMouseUpHandler(e,r.target,c);a=a||this.getScenePoint(e),u&&u.call(c,e,r,a.x,a.y)}this._setCursorFromEvent(e,s),this._handleEvent(e,"up"),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=void 0),d?this.requestRenderAll():o||(t=this._activeObject)!==null&&t!==void 0&&t.isEditing||this.renderTop()}_basicEventHandler(e,t){const{target:r,subTargets:o=[]}=t;this.fire(e,t),r&&r.fire(e,t);for(let s=0;s<o.length;s++)o[s]!==r&&o[s].fire(e,t);return t}_handleEvent(e,t){const r=this._target,o=this.targets||[],s=Je(Je({e,target:r,subTargets:o},Dd(this,e)),{},{transform:this._currentTransform},t==="up:before"||t==="up"?{isClick:this._isClick,currentTarget:this.findTarget(e),currentSubTargets:this.targets}:{});this.fire("mouse:".concat(t),s),r&&r.fire("mouse".concat(t),s);for(let i=0;i<o.length;i++)o[i]!==r&&o[i].fire("mouse".concat(t),s)}_onMouseDownInDrawingMode(e){this._isCurrentlyDrawing=!0,this.getActiveObject()&&(this.discardActiveObject(e),this.requestRenderAll());const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseDown(t,{e,pointer:t}),this._handleEvent(e,"down")}_onMouseMoveInDrawingMode(e){if(this._isCurrentlyDrawing){const t=this.getScenePoint(e);this.freeDrawingBrush&&this.freeDrawingBrush.onMouseMove(t,{e,pointer:t})}this.setCursor(this.freeDrawingCursor),this._handleEvent(e,"move")}_onMouseUpInDrawingMode(e){const t=this.getScenePoint(e);this.freeDrawingBrush?this._isCurrentlyDrawing=!!this.freeDrawingBrush.onMouseUp({e,pointer:t}):this._isCurrentlyDrawing=!1,this._handleEvent(e,"up")}__onMouseDown(e){this._isClick=!0,this._cacheTransformEventData(e),this._handleEvent(e,"down:before");let t=this._target;const{button:r}=e;if(r)return(this.fireMiddleClick&&r===1||this.fireRightClick&&r===2)&&this._handleEvent(e,"down"),void this._resetTransformEventData();if(this.isDrawingMode)return void this._onMouseDownInDrawingMode(e);if(!this._isMainEvent(e)||this._currentTransform)return;let o=this._shouldRender(t),s=!1;if(this.handleMultiSelection(e,t)?(t=this._activeObject,s=!0,o=!0):this._shouldClearSelection(e,t)&&this.discardActiveObject(e),this.selection&&(!t||!t.selectable&&!t.isEditing&&t!==this._activeObject)){const i=this.getScenePoint(e);this._groupSelector={x:i.x,y:i.y,deltaY:0,deltaX:0}}if(t){const i=t===this._activeObject;t.selectable&&t.activeOn==="down"&&this.setActiveObject(t,e);const a=t.findControl(this.getViewportPoint(e),R0(e));if(t===this._activeObject&&(a||!s)){this._setupCurrentTransform(e,t,i);const A=a?a.control:void 0,d=this.getScenePoint(e),c=A&&A.getMouseDownHandler(e,t,A);c&&c.call(A,e,this._currentTransform,d.x,d.y)}}o&&(this._objectsToRender=void 0),this._handleEvent(e,"down"),o&&this.requestRenderAll()}_resetTransformEventData(){this._target=this._pointer=this._absolutePointer=void 0}_cacheTransformEventData(e){this._resetTransformEventData(),this._pointer=this.getViewportPoint(e),this._absolutePointer=hc(this._pointer,void 0,this.viewportTransform),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(e)}__onMouseMove(e){if(this._isClick=!1,this._cacheTransformEventData(e),this._handleEvent(e,"move:before"),this.isDrawingMode)return void this._onMouseMoveInDrawingMode(e);if(!this._isMainEvent(e))return;const t=this._groupSelector;if(t){const r=this.getScenePoint(e);t.deltaX=r.x-t.x,t.deltaY=r.y-t.y,this.renderTop()}else if(this._currentTransform)this._transformObject(e);else{const r=this.findTarget(e);this._setCursorFromEvent(e,r),this._fireOverOutEvents(e,r)}this.textEditingManager.onMouseMove(e),this._handleEvent(e,"move"),this._resetTransformEventData()}_fireOverOutEvents(e,t){const r=this._hoveredTarget,o=this._hoveredTargets,s=this.targets,i=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("mouse",{e,target:t,oldTarget:r,fireCanvas:!0});for(let a=0;a<i;a++)this.fireSyntheticInOutEvents("mouse",{e,target:s[a],oldTarget:o[a]});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()}_fireEnterLeaveEvents(e,t){const r=this._draggedoverTarget,o=this._hoveredTargets,s=this.targets,i=Math.max(o.length,s.length);this.fireSyntheticInOutEvents("drag",Je(Je({},t),{},{target:e,oldTarget:r,fireCanvas:!0}));for(let a=0;a<i;a++)this.fireSyntheticInOutEvents("drag",Je(Je({},t),{},{target:s[a],oldTarget:o[a]}));this._draggedoverTarget=e}fireSyntheticInOutEvents(e,t){let{target:r,oldTarget:o,fireCanvas:s,e:i}=t,a=so(t,QU);const{targetIn:A,targetOut:d,canvasIn:c,canvasOut:u}=TU[e],h=o!==r;if(o&&h){const p=Je(Je({},a),{},{e:i,target:o,nextTarget:r},Dd(this,i));s&&this.fire(u,p),o.fire(d,p)}if(r&&h){const p=Je(Je({},a),{},{e:i,target:r,previousTarget:o},Dd(this,i));s&&this.fire(c,p),r.fire(A,p)}}__onMouseWheel(e){this._cacheTransformEventData(e),this._handleEvent(e,"wheel"),this._resetTransformEventData()}_transformObject(e){const t=this.getScenePoint(e),r=this._currentTransform,o=r.target,s=o.group?hc(t,void 0,o.group.calcTransformMatrix()):t;r.shiftKey=e.shiftKey,r.altKey=!!this.centeredKey&&e[this.centeredKey],this._performTransformAction(e,r,s),r.actionPerformed&&this.requestRenderAll()}_performTransformAction(e,t,r){const{action:o,actionHandler:s,target:i}=t,a=!!s&&s(e,t,r.x,r.y);a&&i.setCoords(),o==="drag"&&a&&(t.target.isMoving=!0,this.setCursor(t.target.moveCursor||this.moveCursor)),t.actionPerformed=t.actionPerformed||a}_setCursorFromEvent(e,t){if(!t)return void this.setCursor(this.defaultCursor);let r=t.hoverCursor||this.hoverCursor;const o=Ll(this._activeObject)?this._activeObject:null,s=(!o||t.group!==o)&&t.findControl(this.getViewportPoint(e));if(s){const i=s.control;this.setCursor(i.cursorStyleHandler(e,i,t))}else t.subTargetCheck&&this.targets.concat().reverse().map(i=>{r=i.hoverCursor||r}),this.setCursor(r)}handleMultiSelection(e,t){const r=this._activeObject,o=Ll(r);if(r&&this._isSelectionKeyPressed(e)&&this.selection&&t&&t.selectable&&(r!==t||o)&&(o||!t.isDescendantOf(r)&&!r.isDescendantOf(t))&&!t.onSelect({e})&&!r.getActiveControl()){if(o){const s=r.getObjects();if(t===r){const i=this.getViewportPoint(e);if(!(t=this.searchPossibleTargets(s,i)||this.searchPossibleTargets(this._objects,i))||!t.selectable)return!1}t.group===r?(r.remove(t),this._hoveredTarget=t,this._hoveredTargets=[...this.targets],r.size()===1&&this._setActiveObject(r.item(0),e)):(r.multiSelectAdd(t),this._hoveredTarget=r,this._hoveredTargets=[...this.targets]),this._fireSelectionEvents(s,e)}else{r.isEditing&&r.exitEditing();const s=new(lr.getClass("ActiveSelection"))([],{canvas:this});s.multiSelectAdd(r,t),this._hoveredTarget=s,this._setActiveObject(s,e),this._fireSelectionEvents([r],e)}return!0}return!1}handleSelection(e){if(!this.selection||!this._groupSelector)return!1;const{x:t,y:r,deltaX:o,deltaY:s}=this._groupSelector,i=new zt(t,r),a=i.add(new zt(o,s)),A=i.min(a),d=i.max(a).subtract(A),c=this.collectObjects({left:A.x,top:A.y,width:d.x,height:d.y},{includeIntersecting:!this.selectionFullyContained}),u=i.eq(a)?c[0]?[c[0]]:[]:c.length>1?c.filter(h=>!h.onSelect({e})).reverse():c;if(u.length===1)this.setActiveObject(u[0],e);else if(u.length>1){const h=lr.getClass("ActiveSelection");this.setActiveObject(new h(u,{canvas:this}),e)}return this._groupSelector=null,!0}clear(){this.textEditingManager.clear(),super.clear()}destroy(){this.removeListeners(),this.textEditingManager.dispose(),super.destroy()}}const Ix={x1:0,y1:0,x2:0,y2:0},LU=Je(Je({},Ix),{},{r1:0,r2:0}),rc=(n,e)=>isNaN(n)&&typeof e=="number"?e:n,PU=/^(\d+\.\d+)%|(\d+)%$/;function Ux(n){return n&&PU.test(n)}function Qx(n,e){const t=typeof n=="number"?n:typeof n=="string"?parseFloat(n)/(Ux(n)?100:1):NaN;return Cc(0,rc(t,e),1)}const kU=/\s*;\s*/,OU=/\s*:\s*/;function DU(n,e){let t,r;const o=n.getAttribute("style");if(o){const i=o.split(kU);i[i.length-1]===""&&i.pop();for(let a=i.length;a--;){const[A,d]=i[a].split(OU).map(c=>c.trim());A==="stop-color"?t=d:A==="stop-opacity"&&(r=d)}}const s=new xi(t||n.getAttribute("stop-color")||"rgb(0,0,0)");return{offset:Qx(n.getAttribute("offset"),0),color:s.toRgb(),opacity:rc(parseFloat(r||n.getAttribute("stop-opacity")||""),1)*s.getAlpha()*e}}function NU(n,e){const t=[],r=n.getElementsByTagName("stop"),o=Qx(e,1);for(let s=r.length;s--;)t.push(DU(r[s],o));return t}function Tx(n){return n.nodeName==="linearGradient"||n.nodeName==="LINEARGRADIENT"?"linear":"radial"}function Lx(n){return n.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage"}function Vi(n,e){return n.getAttribute(e)}function MU(n,e){return function(t,r){let o,{width:s,height:i,gradientUnits:a}=r;return Object.keys(t).reduce((A,d)=>{const c=t[d];return c==="Infinity"?o=1:c==="-Infinity"?o=0:(o=typeof c=="string"?parseFloat(c):c,typeof c=="string"&&Ux(c)&&(o*=.01,a==="pixels"&&(d!=="x1"&&d!=="x2"&&d!=="r2"||(o*=s),d!=="y1"&&d!=="y2"||(o*=i)))),A[d]=o,A},{})}(Tx(n)==="linear"?function(t){return{x1:Vi(t,"x1")||0,y1:Vi(t,"y1")||0,x2:Vi(t,"x2")||"100%",y2:Vi(t,"y2")||0}}(n):function(t){return{x1:Vi(t,"fx")||Vi(t,"cx")||"50%",y1:Vi(t,"fy")||Vi(t,"cy")||"50%",r1:0,x2:Vi(t,"cx")||"50%",y2:Vi(t,"cy")||"50%",r2:Vi(t,"r")||"50%"}}(n),Je(Je({},e),{},{gradientUnits:Lx(n)}))}class Jh{constructor(e){const{type:t="linear",gradientUnits:r="pixels",coords:o={},colorStops:s=[],offsetX:i=0,offsetY:a=0,gradientTransform:A,id:d}=e||{};Object.assign(this,{type:t,gradientUnits:r,coords:Je(Je({},t==="radial"?LU:Ix),o),colorStops:s,offsetX:i,offsetY:a,gradientTransform:A,id:d?"".concat(d,"_").concat(pl()):pl()})}addColorStop(e){for(const t in e){const r=new xi(e[t]);this.colorStops.push({offset:parseFloat(t),color:r.toRgb(),opacity:r.getAlpha()})}return this}toObject(e){return Je(Je({},Mc(this,e)),{},{type:this.type,coords:Je({},this.coords),colorStops:this.colorStops.map(t=>Je({},t)),offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?[...this.gradientTransform]:void 0})}toSVG(e){let{additionalTransform:t}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=[],o=this.gradientTransform?this.gradientTransform.concat():Rs.concat(),s=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox",i=this.colorStops.map(u=>Je({},u)).sort((u,h)=>u.offset-h.offset);let a=-this.offsetX,A=-this.offsetY;var d;s==="objectBoundingBox"?(a/=e.width,A/=e.height):(a+=e.width/2,A+=e.height/2),(d=e)&&typeof d._renderPathCommands=="function"&&this.gradientUnits!=="percentage"&&(a-=e.pathOffset.x,A-=e.pathOffset.y),o[4]-=a,o[5]-=A;const c=['id="SVGID_'.concat(this.id,'"'),'gradientUnits="'.concat(s,'"'),'gradientTransform="'.concat(t?t+" ":"").concat(Fp(o),'"'),""].join(" ");if(this.type==="linear"){const{x1:u,y1:h,x2:p,y2:v}=this.coords;r.push("<linearGradient ",c,' x1="',u,'" y1="',h,'" x2="',p,'" y2="',v,`">
`)}else if(this.type==="radial"){const{x1:u,y1:h,x2:p,y2:v,r1:w,r2:y}=this.coords,B=w>y;r.push("<radialGradient ",c,' cx="',B?u:p,'" cy="',B?h:v,'" r="',B?w:y,'" fx="',B?p:u,'" fy="',B?v:h,`">
`),B&&(i.reverse(),i.forEach(Q=>{Q.offset=1-Q.offset}));const C=Math.min(w,y);if(C>0){const Q=C/Math.max(w,y);i.forEach(k=>{k.offset+=Q*(1-k.offset)})}}return i.forEach(u=>{let{color:h,offset:p,opacity:v}=u;r.push("<stop ",'offset="',100*p+"%",'" style="stop-color:',h,v!==void 0?";stop-opacity: "+v:";",`"/>
`)}),r.push(this.type==="linear"?"</linearGradient>":"</radialGradient>",`
`),r.join("")}toLive(e){const{x1:t,y1:r,x2:o,y2:s,r1:i,r2:a}=this.coords,A=this.type==="linear"?e.createLinearGradient(t,r,o,s):e.createRadialGradient(t,r,i,o,s,a);return this.colorStops.forEach(d=>{let{color:c,opacity:u,offset:h}=d;A.addColorStop(h,u!==void 0?new xi(c).setAlpha(u).toRgba():c)}),A}static async fromObject(e){const{colorStops:t,gradientTransform:r}=e;return new this(Je(Je({},e),{},{colorStops:t?t.map(o=>Je({},o)):void 0,gradientTransform:r?[...r]:void 0}))}static fromElement(e,t,r){const o=Lx(e),s=t._findCenterFromElement();return new this(Je({id:e.getAttribute("id")||void 0,type:Tx(e),coords:MU(e,{width:r.viewBoxWidth||r.width,height:r.viewBoxHeight||r.height}),colorStops:NU(e,r.opacity),gradientUnits:o,gradientTransform:G0(e.getAttribute("gradientTransform")||"")},o==="pixels"?{offsetX:t.width/2-s.x,offsetY:t.height/2-s.y}:{offsetX:0,offsetY:0}))}}Xe(Jh,"type","Gradient"),lr.setClass(Jh,"gradient"),lr.setClass(Jh,"linear"),lr.setClass(Jh,"radial");const HU=["type","source","patternTransform"];class Sv{get type(){return"pattern"}set type(e){fl("warn","Setting type has no effect",e)}constructor(e){Xe(this,"repeat","repeat"),Xe(this,"offsetX",0),Xe(this,"offsetY",0),Xe(this,"crossOrigin",""),this.id=pl(),Object.assign(this,e)}isImageSource(){return!!this.source&&typeof this.source.src=="string"}isCanvasSource(){return!!this.source&&!!this.source.toDataURL}sourceToString(){return this.isImageSource()?this.source.src:this.isCanvasSource()?this.source.toDataURL():""}toLive(e){return this.source&&(!this.isImageSource()||this.source.complete&&this.source.naturalWidth!==0&&this.source.naturalHeight!==0)?e.createPattern(this.source,this.repeat):null}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const{repeat:t,crossOrigin:r}=this;return Je(Je({},Mc(this,e)),{},{type:"pattern",source:this.sourceToString(),repeat:t,crossOrigin:r,offsetX:uo(this.offsetX,mn.NUM_FRACTION_DIGITS),offsetY:uo(this.offsetY,mn.NUM_FRACTION_DIGITS),patternTransform:this.patternTransform?[...this.patternTransform]:null})}toSVG(e){let{width:t,height:r}=e;const{source:o,repeat:s,id:i}=this,a=rc(this.offsetX/t,0),A=rc(this.offsetY/r,0),d=s==="repeat-y"||s==="no-repeat"?1+Math.abs(a||0):rc(o.width/t,0),c=s==="repeat-x"||s==="no-repeat"?1+Math.abs(A||0):rc(o.height/r,0);return['<pattern id="SVGID_'.concat(i,'" x="').concat(a,'" y="').concat(A,'" width="').concat(d,'" height="').concat(c,'">'),'<image x="0" y="0" width="'.concat(o.width,'" height="').concat(o.height,'" xlink:href="').concat(this.sourceToString(),'"></image>'),"</pattern>",""].join(`
`)}static async fromObject(e,t){let{type:r,source:o,patternTransform:s}=e,i=so(e,HU);const a=await rp(o,Je(Je({},t),{},{crossOrigin:i.crossOrigin}));return new this(Je(Je({},i),{},{patternTransform:s&&s.slice(0),source:a}))}}Xe(Sv,"type","Pattern"),lr.setClass(Sv),lr.setClass(Sv,"pattern");const jU=["path","left","top"],RU=["d"];class Pl extends os{constructor(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},{path:r,left:o,top:s}=t,i=so(t,jU);super(),Object.assign(this,Pl.ownDefaults),this.setOptions(i),this._setPath(e||[],!0),typeof o=="number"&&this.set(zn,o),typeof s=="number"&&this.set(Js,s)}_setPath(e,t){this.path=wU(Array.isArray(e)?e:EU(e)),this.setBoundingBox(t)}_findCenterFromElement(){const e=this._calcBoundsFromPath();return new zt(e.left+e.width/2,e.top+e.height/2)}_renderPathCommands(e){const t=-this.pathOffset.x,r=-this.pathOffset.y;e.beginPath();for(const o of this.path)switch(o[0]){case"L":e.lineTo(o[1]+t,o[2]+r);break;case"M":e.moveTo(o[1]+t,o[2]+r);break;case"C":e.bezierCurveTo(o[1]+t,o[2]+r,o[3]+t,o[4]+r,o[5]+t,o[6]+r);break;case"Q":e.quadraticCurveTo(o[1]+t,o[2]+r,o[3]+t,o[4]+r);break;case"Z":e.closePath()}}_render(e){this._renderPathCommands(e),this._renderPaintInOrder(e)}toString(){return"#<Path (".concat(this.complexity(),'): { "top": ').concat(this.top,', "left": ').concat(this.left," }>")}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Je(Je({},super.toObject(e)),{},{path:this.path.map(t=>t.slice())})}toDatalessObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=this.toObject(e);return this.sourcePath&&(delete t.path,t.sourcePath=this.sourcePath),t}_toSVG(){const e=FU(this.path,mn.NUM_FRACTION_DIGITS);return["<path ","COMMON_PARTS",'d="'.concat(e,`" stroke-linecap="round" />
`)]}_getOffsetTransform(){const e=mn.NUM_FRACTION_DIGITS;return" translate(".concat(uo(-this.pathOffset.x,e),", ").concat(uo(-this.pathOffset.y,e),")")}toClipPathSVG(e){const t=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}toSVG(e){const t=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:e,additionalTransform:t})}complexity(){return this.path.length}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{width:t,height:r,pathOffset:o}=this._calcDimensions();this.set({width:t,height:r,pathOffset:o}),e&&this.setPositionByOrigin(o,Gr,Gr)}_calcBoundsFromPath(){const e=[];let t=0,r=0,o=0,s=0;for(const i of this.path)switch(i[0]){case"L":o=i[1],s=i[2],e.push({x:t,y:r},{x:o,y:s});break;case"M":o=i[1],s=i[2],t=o,r=s;break;case"C":e.push(...ty(o,s,i[1],i[2],i[3],i[4],i[5],i[6])),o=i[5],s=i[6];break;case"Q":e.push(...ty(o,s,i[1],i[2],i[1],i[2],i[3],i[4])),o=i[3],s=i[4];break;case"Z":o=t,s=r}return yA(e)}_calcDimensions(){const e=this._calcBoundsFromPath();return Je(Je({},e),{},{pathOffset:new zt(e.left+e.width/2,e.top+e.height/2)})}static fromObject(e){return this._fromObject(e,{extraParam:"path"})}static async fromElement(e,t,r){const o=FA(e,this.ATTRIBUTE_NAMES,r),{d:s}=o;return new this(s,Je(Je(Je({},so(o,RU)),t),{},{left:void 0,top:void 0}))}}Xe(Pl,"type","Path"),Xe(Pl,"cacheProperties",[...EA,"path","fillRule"]),Xe(Pl,"ATTRIBUTE_NAMES",[...yl,"d"]),lr.setClass(Pl),lr.setSVGClass(Pl);const qU=["left","top","radius"],Px=["radius","startAngle","endAngle","counterClockwise"];class hA extends os{static getDefaults(){return Je(Je({},super.getDefaults()),hA.ownDefaults)}constructor(e){super(),Object.assign(this,hA.ownDefaults),this.setOptions(e)}_set(e,t){return super._set(e,t),e==="radius"&&this.setRadius(t),this}_render(e){e.beginPath(),e.arc(0,0,this.radius,Uo(this.startAngle),Uo(this.endAngle),this.counterClockwise),this._renderPaintInOrder(e)}getRadiusX(){return this.get("radius")*this.get(oi)}getRadiusY(){return this.get("radius")*this.get(Hi)}setRadius(e){this.radius=e,this.set({width:2*e,height:2*e})}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...Px,...e])}_toSVG(){const e=(this.endAngle-this.startAngle)%360;if(e===0)return["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',"".concat(this.radius),`" />
`];{const{radius:t}=this,r=Uo(this.startAngle),o=Uo(this.endAngle),s=BA(r)*t,i=zA(r)*t,a=BA(o)*t,A=zA(o)*t,d=e>180?1:0,c=this.counterClockwise?0:1;return['<path d="M '.concat(s," ").concat(i," A ").concat(t," ").concat(t," 0 ").concat(d," ").concat(c," ").concat(a," ").concat(A,'" '),"COMMON_PARTS",` />
`]}}static async fromElement(e,t,r){const o=FA(e,this.ATTRIBUTE_NAMES,r),{left:s=0,top:i=0,radius:a=0}=o;return new this(Je(Je({},so(o,qU)),{},{radius:a,left:s-a,top:i-a}))}static fromObject(e){return super._fromObject(e)}}Xe(hA,"type","Circle"),Xe(hA,"cacheProperties",[...EA,...Px]),Xe(hA,"ownDefaults",{radius:0,startAngle:0,endAngle:360,counterClockwise:!1}),Xe(hA,"ATTRIBUTE_NAMES",["cx","cy","r",...yl]),lr.setClass(hA),lr.setSVGClass(hA);const KU=["x1","y1","x2","y2"],$U=["x1","y1","x2","y2"],Z0=["x1","x2","y1","y2"];class kl extends os{constructor(){let[e,t,r,o]=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[0,0,0,0],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,kl.ownDefaults),this.setOptions(s),this.x1=e,this.x2=r,this.y1=t,this.y2=o,this._setWidthHeight();const{left:i,top:a}=s;typeof i=="number"&&this.set(zn,i),typeof a=="number"&&this.set(Js,a)}_setWidthHeight(){const{x1:e,y1:t,x2:r,y2:o}=this;this.width=Math.abs(r-e),this.height=Math.abs(o-t);const{left:s,top:i,width:a,height:A}=yA([{x:e,y:t},{x:r,y:o}]),d=new zt(s+a/2,i+A/2);this.setPositionByOrigin(d,Gr,Gr)}_set(e,t){return super._set(e,t),Z0.includes(e)&&this._setWidthHeight(),this}_render(e){e.beginPath();const t=this.calcLinePoints();e.moveTo(t.x1,t.y1),e.lineTo(t.x2,t.y2),e.lineWidth=this.strokeWidth;const r=e.strokeStyle;var o;Oi(this.stroke)?e.strokeStyle=this.stroke.toLive(e):e.strokeStyle=(o=this.stroke)!==null&&o!==void 0?o:e.fillStyle,this.stroke&&this._renderStroke(e),e.strokeStyle=r}_findCenterFromElement(){return new zt((this.x1+this.x2)/2,(this.y1+this.y2)/2)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Je(Je({},super.toObject(e)),this.calcLinePoints())}_getNonTransformedDimensions(){const e=super._getNonTransformedDimensions();return this.strokeLineCap==="butt"&&(this.width===0&&(e.y-=this.strokeWidth),this.height===0&&(e.x-=this.strokeWidth)),e}calcLinePoints(){const{x1:e,x2:t,y1:r,y2:o,width:s,height:i}=this,a=e<=t?-1:1,A=r<=o?-1:1;return{x1:a*s/2,x2:a*-s/2,y1:A*i/2,y2:A*-i/2}}_toSVG(){const{x1:e,x2:t,y1:r,y2:o}=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="'.concat(e,'" y1="').concat(r,'" x2="').concat(t,'" y2="').concat(o,`" />
`)]}static async fromElement(e,t,r){const o=FA(e,this.ATTRIBUTE_NAMES,r),{x1:s=0,y1:i=0,x2:a=0,y2:A=0}=o;return new this([s,i,a,A],so(o,KU))}static fromObject(e){let{x1:t,y1:r,x2:o,y2:s}=e,i=so(e,$U);return this._fromObject(Je(Je({},i),{},{points:[t,r,o,s]}),{extraParam:"points"})}}Xe(kl,"type","Line"),Xe(kl,"cacheProperties",[...EA,...Z0]),Xe(kl,"ATTRIBUTE_NAMES",yl.concat(Z0)),lr.setClass(kl),lr.setSVGClass(kl);class jl extends os{static getDefaults(){return Je(Je({},super.getDefaults()),jl.ownDefaults)}constructor(e){super(),Object.assign(this,jl.ownDefaults),this.setOptions(e)}_render(e){const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,r),e.lineTo(0,-r),e.lineTo(t,r),e.closePath(),this._renderPaintInOrder(e)}_toSVG(){const e=this.width/2,t=this.height/2;return["<polygon ","COMMON_PARTS",'points="',"".concat(-e," ").concat(t,",0 ").concat(-t,",").concat(e," ").concat(t),'" />']}}Xe(jl,"type","Triangle"),Xe(jl,"ownDefaults",{width:100,height:100}),lr.setClass(jl),lr.setSVGClass(jl);const kx=["rx","ry"];class fA extends os{static getDefaults(){return Je(Je({},super.getDefaults()),fA.ownDefaults)}constructor(e){super(),Object.assign(this,fA.ownDefaults),this.setOptions(e)}_set(e,t){switch(super._set(e,t),e){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this}getRx(){return this.get("rx")*this.get(oi)}getRy(){return this.get("ry")*this.get(Hi)}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject([...kx,...e])}_toSVG(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" rx="'.concat(this.rx,'" ry="').concat(this.ry,`" />
`)]}_render(e){e.beginPath(),e.save(),e.transform(1,0,0,this.ry/this.rx,0,0),e.arc(0,0,this.rx,0,Bp,!1),e.restore(),this._renderPaintInOrder(e)}static async fromElement(e,t,r){const o=FA(e,this.ATTRIBUTE_NAMES,r);return o.left=(o.left||0)-o.rx,o.top=(o.top||0)-o.ry,new this(o)}}function VU(n){if(!n)return[];const e=n.replace(/,/g," ").trim().split(/\s+/),t=[];for(let r=0;r<e.length;r+=2)t.push({x:parseFloat(e[r]),y:parseFloat(e[r+1])});return t}Xe(fA,"type","Ellipse"),Xe(fA,"cacheProperties",[...EA,...kx]),Xe(fA,"ownDefaults",{rx:0,ry:0}),Xe(fA,"ATTRIBUTE_NAMES",[...yl,"cx","cy","rx","ry"]),lr.setClass(fA),lr.setSVGClass(fA);const GU=["left","top"],Ox={exactBoundingBox:!1};class ta extends os{static getDefaults(){return Je(Je({},super.getDefaults()),ta.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Xe(this,"strokeDiff",void 0),Object.assign(this,ta.ownDefaults),this.setOptions(t),this.points=e;const{left:r,top:o}=t;this.initialized=!0,this.setBoundingBox(!0),typeof r=="number"&&this.set(zn,r),typeof o=="number"&&this.set(Js,o)}isOpen(){return!0}_projectStrokeOnPoints(e){return OI(this.points,e,this.isOpen())}_calcDimensions(e){e=Je({scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,strokeLineCap:this.strokeLineCap,strokeLineJoin:this.strokeLineJoin,strokeMiterLimit:this.strokeMiterLimit,strokeUniform:this.strokeUniform,strokeWidth:this.strokeWidth},e||{});const t=this.exactBoundingBox?this._projectStrokeOnPoints(e).map(d=>d.projectedPoint):this.points;if(t.length===0)return{left:0,top:0,width:0,height:0,pathOffset:new zt,strokeOffset:new zt,strokeDiff:new zt};const r=yA(t),o=vg(Je(Je({},e),{},{scaleX:1,scaleY:1})),s=yA(this.points.map(d=>Xs(d,o,!0))),i=new zt(this.scaleX,this.scaleY);let a=r.left+r.width/2,A=r.top+r.height/2;return this.exactBoundingBox&&(a-=A*Math.tan(Uo(this.skewX)),A-=a*Math.tan(Uo(this.skewY))),Je(Je({},r),{},{pathOffset:new zt(a,A),strokeOffset:new zt(s.left,s.top).subtract(new zt(r.left,r.top)).multiply(i),strokeDiff:new zt(r.width,r.height).subtract(new zt(s.width,s.height)).multiply(i)})}_findCenterFromElement(){const e=yA(this.points);return new zt(e.left+e.width/2,e.top+e.height/2)}setDimensions(){this.setBoundingBox()}setBoundingBox(e){const{left:t,top:r,width:o,height:s,pathOffset:i,strokeOffset:a,strokeDiff:A}=this._calcDimensions();this.set({width:o,height:s,pathOffset:i,strokeOffset:a,strokeDiff:A}),e&&this.setPositionByOrigin(new zt(t+o/2,r+s/2),Gr,Gr)}isStrokeAccountedForInDimensions(){return this.exactBoundingBox}_getNonTransformedDimensions(){return this.exactBoundingBox?new zt(this.width,this.height):super._getNonTransformedDimensions()}_getTransformedDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.exactBoundingBox){let i;if(Object.keys(e).some(a=>this.strokeUniform||this.constructor.layoutProperties.includes(a))){var t,r;const{width:a,height:A}=this._calcDimensions(e);i=new zt((t=e.width)!==null&&t!==void 0?t:a,(r=e.height)!==null&&r!==void 0?r:A)}else{var o,s;i=new zt((o=e.width)!==null&&o!==void 0?o:this.width,(s=e.height)!==null&&s!==void 0?s:this.height)}return i.multiply(new zt(e.scaleX||this.scaleX,e.scaleY||this.scaleY))}return super._getTransformedDimensions(e)}_set(e,t){const r=this.initialized&&this[e]!==t,o=super._set(e,t);return this.exactBoundingBox&&r&&((e===oi||e===Hi)&&this.strokeUniform&&this.constructor.layoutProperties.includes("strokeUniform")||this.constructor.layoutProperties.includes(e))&&this.setDimensions(),o}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Je(Je({},super.toObject(e)),{},{points:this.points.map(t=>{let{x:r,y:o}=t;return{x:r,y:o}})})}_toSVG(){const e=[],t=this.pathOffset.x,r=this.pathOffset.y,o=mn.NUM_FRACTION_DIGITS;for(let s=0,i=this.points.length;s<i;s++)e.push(uo(this.points[s].x-t,o),",",uo(this.points[s].y-r,o)," ");return["<".concat(this.constructor.type.toLowerCase()," "),"COMMON_PARTS",'points="'.concat(e.join(""),`" />
`)]}_render(e){const t=this.points.length,r=this.pathOffset.x,o=this.pathOffset.y;if(t&&!isNaN(this.points[t-1].y)){e.beginPath(),e.moveTo(this.points[0].x-r,this.points[0].y-o);for(let s=0;s<t;s++){const i=this.points[s];e.lineTo(i.x-r,i.y-o)}!this.isOpen()&&e.closePath(),this._renderPaintInOrder(e)}}complexity(){return this.points.length}static async fromElement(e,t,r){return new this(VU(e.getAttribute("points")),Je(Je({},so(FA(e,this.ATTRIBUTE_NAMES,r),GU)),t))}static fromObject(e){return this._fromObject(e,{extraParam:"points"})}}Xe(ta,"ownDefaults",Ox),Xe(ta,"type","Polyline"),Xe(ta,"layoutProperties",[Dc,Nc,"strokeLineCap","strokeLineJoin","strokeMiterLimit","strokeWidth","strokeUniform","points"]),Xe(ta,"cacheProperties",[...EA,"points"]),Xe(ta,"ATTRIBUTE_NAMES",[...yl]),lr.setClass(ta),lr.setSVGClass(ta);class Zh extends ta{isOpen(){return!1}}Xe(Zh,"ownDefaults",Ox),Xe(Zh,"type","Polygon"),lr.setClass(Zh),lr.setSVGClass(Zh);const Dx=["fontSize","fontWeight","fontFamily","fontStyle"],Nx=["underline","overline","linethrough"],Mx=[...Dx,"lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],Hx=[...Mx,...Nx,"textBackgroundColor","direction"],WU=[...Dx,...Nx,ei,"strokeWidth",Ko,"deltaY","textBackgroundColor"],XU={_reNewline:C1,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:zn,fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stroke:null,shadow:null,path:void 0,pathStartOffset:0,pathSide:zn,pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,deltaY:0,direction:"ltr",CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2},Ua="justify",Pp="justify-left",Iu="justify-right",Uu="justify-center";class jx extends os{isEmptyStyles(e){if(!this.styles||e!==void 0&&!this.styles[e])return!0;const t=e===void 0?this.styles:{line:this.styles[e]};for(const r in t)for(const o in t[r])for(const s in t[r][o])return!1;return!0}styleHas(e,t){if(!this.styles||t!==void 0&&!this.styles[t])return!1;const r=t===void 0?this.styles:{0:this.styles[t]};for(const o in r)for(const s in r[o])if(r[o][s][e]!==void 0)return!0;return!1}cleanStyle(e){if(!this.styles)return!1;const t=this.styles;let r,o,s=0,i=!0,a=0;for(const A in t){r=0;for(const d in t[A]){const c=t[A][d]||{};s++,c[e]!==void 0?(o?c[e]!==o&&(i=!1):o=c[e],c[e]===this[e]&&delete c[e]):i=!1,Object.keys(c).length!==0?r++:delete t[A][d]}r===0&&delete t[A]}for(let A=0;A<this._textLines.length;A++)a+=this._textLines[A].length;i&&s===a&&(this[e]=o,this.removeStyle(e))}removeStyle(e){if(!this.styles)return;const t=this.styles;let r,o,s;for(o in t){for(s in r=t[o],r)delete r[s][e],Object.keys(r[s]).length===0&&delete r[s];Object.keys(r).length===0&&delete t[o]}}_extendStyles(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e);this._getLineStyle(r)||this._setLineStyle(r);const s=U1(Je(Je({},this._getStyleDeclaration(r,o)),t),i=>i!==void 0);this._setStyleDeclaration(r,o,s)}getSelectionStyles(e,t,r){const o=[];for(let s=e;s<(t||e);s++)o.push(this.getStyleAtPosition(s,r));return o}getStyleAtPosition(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e);return t?this.getCompleteStyleDeclaration(r,o):this._getStyleDeclaration(r,o)}setSelectionStyles(e,t,r){for(let o=t;o<(r||t);o++)this._extendStyles(o,e);this._forceClearCache=!0}_getStyleDeclaration(e,t){var r;const o=this.styles&&this.styles[e];return o&&(r=o[t])!==null&&r!==void 0?r:{}}getCompleteStyleDeclaration(e,t){return Je(Je({},Mc(this,this.constructor._styleProperties)),this._getStyleDeclaration(e,t))}_setStyleDeclaration(e,t,r){this.styles[e][t]=r}_deleteStyleDeclaration(e,t){delete this.styles[e][t]}_getLineStyle(e){return!!this.styles[e]}_setLineStyle(e){this.styles[e]={}}_deleteLineStyle(e){delete this.styles[e]}}Xe(jx,"_styleProperties",WU);const YU=/  +/g,JU=/"/g;function Ev(n,e,t,r,o){return"		".concat(function(s,i){let{left:a,top:A,width:d,height:c}=i,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:mn.NUM_FRACTION_DIGITS;const h=Zu(Ko,s,!1),[p,v,w,y]=[a,A,d,c].map(B=>uo(B,u));return"<rect ".concat(h,' x="').concat(p,'" y="').concat(v,'" width="').concat(w,'" height="').concat(y,'"></rect>')}(n,{left:e,top:t,width:r,height:o}),`
`)}const ZU=["textAnchor","textDecoration","dx","dy","top","left","fontSize","strokeWidth"];let Fv;class Ds extends jx{static getDefaults(){return Je(Je({},super.getDefaults()),Ds.ownDefaults)}constructor(e,t){super(),Xe(this,"__charBounds",[]),Object.assign(this,Ds.ownDefaults),this.setOptions(t),this.styles||(this.styles={}),this.text=e,this.initialized=!0,this.path&&this.setPathInfo(),this.initDimensions(),this.setCoords()}setPathInfo(){const e=this.path;e&&(e.segmentsInfo=Fx(e.path))}_splitText(){const e=this._splitTextIntoLines(this.text);return this.textLines=e.lines,this._textLines=e.graphemeLines,this._unwrappedTextLines=e._unwrappedLines,this._text=e.graphemeText,e}initDimensions(){this._splitText(),this._clearCache(),this.dirty=!0,this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.includes(Ua)&&this.enlargeSpaces()}enlargeSpaces(){let e,t,r,o,s,i,a;for(let A=0,d=this._textLines.length;A<d;A++)if((this.textAlign===Ua||A!==d-1&&!this.isEndOfWrapping(A))&&(o=0,s=this._textLines[A],t=this.getLineWidth(A),t<this.width&&(a=this.textLines[A].match(this._reSpacesAndTabs)))){r=a.length,e=(this.width-t)/r;for(let c=0;c<=s.length;c++)i=this.__charBounds[A][c],this._reSpaceAndTab.test(s[c])?(i.width+=e,i.kernedWidth+=e,i.left+=o,o+=e):i.left+=o}}isEndOfWrapping(e){return e===this._textLines.length-1}missingNewlineOffset(e){return 1}get2DCursorLocation(e,t){const r=t?this._unwrappedTextLines:this._textLines;let o;for(o=0;o<r.length;o++){if(e<=r[o].length)return{lineIndex:o,charIndex:e};e-=r[o].length+this.missingNewlineOffset(o,t)}return{lineIndex:o-1,charIndex:r[o-1].length<e?r[o-1].length:e}}toString(){return"#<Text (".concat(this.complexity(),'): { "text": "').concat(this.text,'", "fontFamily": "').concat(this.fontFamily,'" }>')}_getCacheCanvasDimensions(){const e=super._getCacheCanvasDimensions(),t=this.fontSize;return e.width+=t*e.zoomX,e.height+=t*e.zoomY,e}_render(e){const t=this.path;t&&!t.isNotVisible()&&t._render(e),this._setTextStyles(e),this._renderTextLinesBackground(e),this._renderTextDecoration(e,"underline"),this._renderText(e),this._renderTextDecoration(e,"overline"),this._renderTextDecoration(e,"linethrough")}_renderText(e){this.paintFirst===ei?(this._renderTextStroke(e),this._renderTextFill(e)):(this._renderTextFill(e),this._renderTextStroke(e))}_setTextStyles(e,t,r){if(e.textBaseline="alphabetic",this.path)switch(this.pathAlign){case Gr:e.textBaseline="middle";break;case"ascender":e.textBaseline=Js;break;case"descender":e.textBaseline=H0}e.font=this._getFontDeclaration(t,r)}calcTextWidth(){let e=this.getLineWidth(0);for(let t=1,r=this._textLines.length;t<r;t++){const o=this.getLineWidth(t);o>e&&(e=o)}return e}_renderTextLine(e,t,r,o,s,i){this._renderChars(e,t,r,o,s,i)}_renderTextLinesBackground(e){if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))return;const t=e.fillStyle,r=this._getLeftOffset();let o=this._getTopOffset();for(let s=0,i=this._textLines.length;s<i;s++){const a=this.getHeightOfLine(s);if(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",s)){o+=a;continue}const A=this._textLines[s].length,d=this._getLineLeftOffset(s);let c,u,h=0,p=0,v=this.getValueOfPropertyAt(s,0,"textBackgroundColor");for(let w=0;w<A;w++){const y=this.__charBounds[s][w];u=this.getValueOfPropertyAt(s,w,"textBackgroundColor"),this.path?(e.save(),e.translate(y.renderLeft,y.renderTop),e.rotate(y.angle),e.fillStyle=u,u&&e.fillRect(-y.width/2,-a/this.lineHeight*(1-this._fontSizeFraction),y.width,a/this.lineHeight),e.restore()):u!==v?(c=r+d+p,this.direction==="rtl"&&(c=this.width-c-h),e.fillStyle=v,v&&e.fillRect(c,o,h,a/this.lineHeight),p=y.left,h=y.width,v=u):h+=y.kernedWidth}u&&!this.path&&(c=r+d+p,this.direction==="rtl"&&(c=this.width-c-h),e.fillStyle=u,e.fillRect(c,o,h,a/this.lineHeight)),o+=a}e.fillStyle=t,this._removeShadow(e)}_measureChar(e,t,r,o){const s=Eu.getFontCache(t),i=this._getFontDeclaration(t),a=r+e,A=r&&i===this._getFontDeclaration(o),d=t.fontSize/this.CACHE_FONT_SIZE;let c,u,h,p;if(r&&s[r]!==void 0&&(h=s[r]),s[e]!==void 0&&(p=c=s[e]),A&&s[a]!==void 0&&(u=s[a],p=u-h),c===void 0||h===void 0||u===void 0){const v=function(){return Fv||(Fv=ja({width:0,height:0}).getContext("2d")),Fv}();this._setTextStyles(v,t,!0),c===void 0&&(p=c=v.measureText(e).width,s[e]=c),h===void 0&&A&&r&&(h=v.measureText(r).width,s[r]=h),A&&u===void 0&&(u=v.measureText(a).width,s[a]=u,p=u-h)}return{width:c*d,kernedWidth:p*d}}getHeightOfChar(e,t){return this.getValueOfPropertyAt(e,t,"fontSize")}measureLine(e){const t=this._measureLine(e);return this.charSpacing!==0&&(t.width-=this._getWidthOfCharSpacing()),t.width<0&&(t.width=0),t}_measureLine(e){let t,r,o=0;const s=this.pathSide===So,i=this.path,a=this._textLines[e],A=a.length,d=new Array(A);this.__charBounds[e]=d;for(let c=0;c<A;c++){const u=a[c];r=this._getGraphemeBox(u,e,c,t),d[c]=r,o+=r.kernedWidth,t=u}if(d[A]={left:r?r.left+r.width:0,width:0,kernedWidth:0,height:this.fontSize,deltaY:0},i&&i.segmentsInfo){let c=0;const u=i.segmentsInfo[i.segmentsInfo.length-1].length;switch(this.textAlign){case zn:c=s?u-o:0;break;case Gr:c=(u-o)/2;break;case So:c=s?0:u-o}c+=this.pathStartOffset*(s?-1:1);for(let h=s?A-1:0;s?h>=0:h<A;s?h--:h++)r=d[h],c>u?c%=u:c<0&&(c+=u),this._setGraphemeOnPath(c,r),c+=r.kernedWidth}return{width:o,numOfSpaces:0}}_setGraphemeOnPath(e,t){const r=e+t.kernedWidth/2,o=this.path,s=BU(o.path,r,o.segmentsInfo);t.renderLeft=s.x-o.pathOffset.x,t.renderTop=s.y-o.pathOffset.y,t.angle=s.angle+(this.pathSide===So?Math.PI:0)}_getGraphemeBox(e,t,r,o,s){const i=this.getCompleteStyleDeclaration(t,r),a=o?this.getCompleteStyleDeclaration(t,r-1):{},A=this._measureChar(e,i,o,a);let d,c=A.kernedWidth,u=A.width;this.charSpacing!==0&&(d=this._getWidthOfCharSpacing(),u+=d,c+=d);const h={width:u,left:0,height:i.fontSize,kernedWidth:c,deltaY:i.deltaY};if(r>0&&!s){const p=this.__charBounds[t][r-1];h.left=p.left+p.width+A.kernedWidth-A.width}return h}getHeightOfLine(e){if(this.__lineHeights[e])return this.__lineHeights[e];let t=this.getHeightOfChar(e,0);for(let r=1,o=this._textLines[e].length;r<o;r++)t=Math.max(this.getHeightOfChar(e,r),t);return this.__lineHeights[e]=t*this.lineHeight*this._fontSizeMult}calcTextHeight(){let e,t=0;for(let r=0,o=this._textLines.length;r<o;r++)e=this.getHeightOfLine(r),t+=r===o-1?e/this.lineHeight:e;return t}_getLeftOffset(){return this.direction==="ltr"?-this.width/2:this.width/2}_getTopOffset(){return-this.height/2}_renderTextCommon(e,t){e.save();let r=0;const o=this._getLeftOffset(),s=this._getTopOffset();for(let i=0,a=this._textLines.length;i<a;i++){const A=this.getHeightOfLine(i),d=A/this.lineHeight,c=this._getLineLeftOffset(i);this._renderTextLine(t,e,this._textLines[i],o+c,s+r+d,i),r+=A}e.restore()}_renderTextFill(e){(this.fill||this.styleHas(Ko))&&this._renderTextCommon(e,"fillText")}_renderTextStroke(e){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(e),e.save(),this._setLineDash(e,this.strokeDashArray),e.beginPath(),this._renderTextCommon(e,"strokeText"),e.closePath(),e.restore())}_renderChars(e,t,r,o,s,i){const a=this.getHeightOfLine(i),A=this.textAlign.includes(Ua),d=this.path,c=!A&&this.charSpacing===0&&this.isEmptyStyles(i)&&!d,u=this.direction==="ltr",h=this.direction==="ltr"?1:-1,p=t.direction;let v,w,y,B,C,Q="",k=0;if(t.save(),p!==this.direction&&(t.canvas.setAttribute("dir",u?"ltr":"rtl"),t.direction=u?"ltr":"rtl",t.textAlign=u?zn:So),s-=a*this._fontSizeFraction/this.lineHeight,c)return this._renderChar(e,t,i,0,r.join(""),o,s),void t.restore();for(let H=0,Z=r.length-1;H<=Z;H++)B=H===Z||this.charSpacing||d,Q+=r[H],y=this.__charBounds[i][H],k===0?(o+=h*(y.kernedWidth-y.width),k+=y.width):k+=y.kernedWidth,A&&!B&&this._reSpaceAndTab.test(r[H])&&(B=!0),B||(v=v||this.getCompleteStyleDeclaration(i,H),w=this.getCompleteStyleDeclaration(i,H+1),B=M1(v,w,!1)),B&&(d?(t.save(),t.translate(y.renderLeft,y.renderTop),t.rotate(y.angle),this._renderChar(e,t,i,H,Q,-k/2,0),t.restore()):(C=o,this._renderChar(e,t,i,H,Q,C,s)),Q="",v=w,o+=h*k,k=0);t.restore()}_applyPatternGradientTransformText(e){const t=this.width+this.strokeWidth,r=this.height+this.strokeWidth,o=ja({width:t,height:r}),s=o.getContext("2d");return o.width=t,o.height=r,s.beginPath(),s.moveTo(0,0),s.lineTo(t,0),s.lineTo(t,r),s.lineTo(0,r),s.closePath(),s.translate(t/2,r/2),s.fillStyle=e.toLive(s),this._applyPatternGradientTransform(s,e),s.fill(),s.createPattern(o,"no-repeat")}handleFiller(e,t,r){let o,s;return Oi(r)?r.gradientUnits==="percentage"||r.gradientTransform||r.patternTransform?(o=-this.width/2,s=-this.height/2,e.translate(o,s),e[t]=this._applyPatternGradientTransformText(r),{offsetX:o,offsetY:s}):(e[t]=r.toLive(e),this._applyPatternGradientTransform(e,r)):(e[t]=r,{offsetX:0,offsetY:0})}_setStrokeStyles(e,t){let{stroke:r,strokeWidth:o}=t;return e.lineWidth=o,e.lineCap=this.strokeLineCap,e.lineDashOffset=this.strokeDashOffset,e.lineJoin=this.strokeLineJoin,e.miterLimit=this.strokeMiterLimit,this.handleFiller(e,"strokeStyle",r)}_setFillStyles(e,t){let{fill:r}=t;return this.handleFiller(e,"fillStyle",r)}_renderChar(e,t,r,o,s,i,a){const A=this._getStyleDeclaration(r,o),d=this.getCompleteStyleDeclaration(r,o),c=e==="fillText"&&d.fill,u=e==="strokeText"&&d.stroke&&d.strokeWidth;if(u||c){if(t.save(),t.font=this._getFontDeclaration(d),A.textBackgroundColor&&this._removeShadow(t),A.deltaY&&(a+=A.deltaY),c){const h=this._setFillStyles(t,d);t.fillText(s,i-h.offsetX,a-h.offsetY)}if(u){const h=this._setStrokeStyles(t,d);t.strokeText(s,i-h.offsetX,a-h.offsetY)}t.restore()}}setSuperscript(e,t){this._setScript(e,t,this.superscript)}setSubscript(e,t){this._setScript(e,t,this.subscript)}_setScript(e,t,r){const o=this.get2DCursorLocation(e,!0),s=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"fontSize"),i=this.getValueOfPropertyAt(o.lineIndex,o.charIndex,"deltaY"),a={fontSize:s*r.size,deltaY:i+s*r.baseline};this.setSelectionStyles(a,e,t)}_getLineLeftOffset(e){const t=this.getLineWidth(e),r=this.width-t,o=this.textAlign,s=this.direction,i=this.isEndOfWrapping(e);let a=0;return o===Ua||o===Uu&&!i||o===Iu&&!i||o===Pp&&!i?0:(o===Gr&&(a=r/2),o===So&&(a=r),o===Uu&&(a=r/2),o===Iu&&(a=r),s==="rtl"&&(o===So||o===Ua||o===Iu?a=0:o===zn||o===Pp?a=-r:o!==Gr&&o!==Uu||(a=-r/2)),a)}_clearCache(){this._forceClearCache=!1,this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]}getLineWidth(e){if(this.__lineWidths[e]!==void 0)return this.__lineWidths[e];const{width:t}=this.measureLine(e);return this.__lineWidths[e]=t,t}_getWidthOfCharSpacing(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0}getValueOfPropertyAt(e,t,r){var o;return(o=this._getStyleDeclaration(e,t)[r])!==null&&o!==void 0?o:this[r]}_renderTextDecoration(e,t){if(!this[t]&&!this.styleHas(t))return;let r=this._getTopOffset();const o=this._getLeftOffset(),s=this.path,i=this._getWidthOfCharSpacing(),a=this.offsets[t];for(let A=0,d=this._textLines.length;A<d;A++){const c=this.getHeightOfLine(A);if(!this[t]&&!this.styleHas(t,A)){r+=c;continue}const u=this._textLines[A],h=c/this.lineHeight,p=this._getLineLeftOffset(A);let v,w,y=0,B=0,C=this.getValueOfPropertyAt(A,0,t),Q=this.getValueOfPropertyAt(A,0,Ko);const k=r+h*(1-this._fontSizeFraction);let H=this.getHeightOfChar(A,0),Z=this.getValueOfPropertyAt(A,0,"deltaY");for(let N=0,re=u.length;N<re;N++){const be=this.__charBounds[A][N];v=this.getValueOfPropertyAt(A,N,t),w=this.getValueOfPropertyAt(A,N,Ko);const L=this.getHeightOfChar(A,N),R=this.getValueOfPropertyAt(A,N,"deltaY");if(s&&v&&w)e.save(),e.fillStyle=Q,e.translate(be.renderLeft,be.renderTop),e.rotate(be.angle),e.fillRect(-be.kernedWidth/2,a*L+R,be.kernedWidth,this.fontSize/15),e.restore();else if((v!==C||w!==Q||L!==H||R!==Z)&&B>0){let J=o+p+y;this.direction==="rtl"&&(J=this.width-J-B),C&&Q&&(e.fillStyle=Q,e.fillRect(J,k+a*H+Z,B,this.fontSize/15)),y=be.left,B=be.width,C=v,Q=w,H=L,Z=R}else B+=be.kernedWidth}let q=o+p+y;this.direction==="rtl"&&(q=this.width-q-B),e.fillStyle=w,v&&w&&e.fillRect(q,k+a*H+Z,B-i,this.fontSize/15),r+=c}this._removeShadow(e)}_getFontDeclaration(){let{fontFamily:e=this.fontFamily,fontStyle:t=this.fontStyle,fontWeight:r=this.fontWeight,fontSize:o=this.fontSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},s=arguments.length>1?arguments[1]:void 0;const i=e.includes("'")||e.includes('"')||e.includes(",")||Ds.genericFonts.includes(e.toLowerCase())?e:'"'.concat(e,'"');return[t,r,"".concat(s?this.CACHE_FONT_SIZE:o,"px"),i].join(" ")}render(e){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._forceClearCache&&this.initDimensions(),super.render(e)))}graphemeSplit(e){return N1(e)}_splitTextIntoLines(e){const t=e.split(this._reNewline),r=new Array(t.length),o=[`
`];let s=[];for(let i=0;i<t.length;i++)r[i]=this.graphemeSplit(t[i]),s=s.concat(r[i],o);return s.pop(),{_unwrappedLines:r,lines:t,graphemeText:s,graphemeLines:r}}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Je(Je({},super.toObject([...Hx,...e])),{},{styles:MI(this.styles,this.text)},this.path?{path:this.path.toObject()}:{})}set(e,t){const{textLayoutProperties:r}=this.constructor;super.set(e,t);let o=!1,s=!1;if(typeof e=="object")for(const i in e)i==="path"&&this.setPathInfo(),o=o||r.includes(i),s=s||i==="path";else o=r.includes(e),s=e==="path";return s&&this.setPathInfo(),o&&this.initialized&&(this.initDimensions(),this.setCoords()),this}complexity(){return 1}static async fromElement(e,t,r){const o=FA(e,Ds.ATTRIBUTE_NAMES,r),s=Je(Je({},t),o),{textAnchor:i=zn,textDecoration:a="",dx:A=0,dy:d=0,top:c=0,left:u=0,fontSize:h=z1,strokeWidth:p=1}=s,v=so(s,ZU),w=new this((e.textContent||"").replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," "),Je({left:u+A,top:c+d,underline:a.includes("underline"),overline:a.includes("overline"),linethrough:a.includes("line-through"),strokeWidth:0,fontSize:h},v)),y=w.getScaledHeight()/w.height,B=((w.height+w.strokeWidth)*w.lineHeight-w.height)*y,C=w.getScaledHeight()+B;let Q=0;return i===Gr&&(Q=w.getScaledWidth()/2),i===So&&(Q=w.getScaledWidth()),w.set({left:w.left-Q,top:w.top-(C-w.fontSize*(.07+w._fontSizeFraction))/w.lineHeight,strokeWidth:p}),w}static fromObject(e){return this._fromObject(Je(Je({},e),{},{styles:HI(e.styles||{},e.text)}),{extraParam:"text"})}}Xe(Ds,"textLayoutProperties",Mx),Xe(Ds,"cacheProperties",[...EA,...Hx]),Xe(Ds,"ownDefaults",XU),Xe(Ds,"type","Text"),Xe(Ds,"genericFonts",["serif","sans-serif","monospace","cursive","fantasy","system-ui","ui-serif","ui-sans-serif","ui-monospace","ui-rounded","math","emoji","fangsong"]),Xe(Ds,"ATTRIBUTE_NAMES",yl.concat("x","y","dx","dy","font-family","font-style","font-weight","font-size","letter-spacing","text-decoration","text-anchor")),yx(Ds,[class extends cx{_toSVG(){const n=this._getSVGLeftTopOffsets(),e=this._getSVGTextAndBg(n.textTop,n.textLeft);return this._wrapSVGTextAndBg(e)}toSVG(n){return this._createBaseSVGMarkup(this._toSVG(),{reviver:n,noStyle:!0,withShadow:!0})}_getSVGLeftTopOffsets(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}}_wrapSVGTextAndBg(n){let{textBgRects:e,textSpans:t}=n;const r=this.getSvgTextDecoration(this);return[e.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'.concat(this.fontFamily.replace(JU,"'"),'" '):"",this.fontSize?'font-size="'.concat(this.fontSize,'" '):"",this.fontStyle?'font-style="'.concat(this.fontStyle,'" '):"",this.fontWeight?'font-weight="'.concat(this.fontWeight,'" '):"",r?'text-decoration="'.concat(r,'" '):"",this.direction==="rtl"?'direction="'.concat(this.direction,'" '):"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",t.join(""),`</text>
`]}_getSVGTextAndBg(n,e){const t=[],r=[];let o,s=n;this.backgroundColor&&r.push(...Ev(this.backgroundColor,-this.width/2,-this.height/2,this.width,this.height));for(let i=0,a=this._textLines.length;i<a;i++)o=this._getLineLeftOffset(i),this.direction==="rtl"&&(o+=this.width),(this.textBackgroundColor||this.styleHas("textBackgroundColor",i))&&this._setSVGTextLineBg(r,i,e+o,s),this._setSVGTextLineText(t,i,e+o,s),s+=this.getHeightOfLine(i);return{textSpans:t,textBgRects:r}}_createTextCharSpan(n,e,t,r){const o=this.getSvgSpanStyles(e,n!==n.trim()||!!n.match(YU)),s=o?'style="'.concat(o,'"'):"",i=e.deltaY,a=i?' dy="'.concat(uo(i,mn.NUM_FRACTION_DIGITS),'" '):"";return'<tspan x="'.concat(uo(t,mn.NUM_FRACTION_DIGITS),'" y="').concat(uo(r,mn.NUM_FRACTION_DIGITS),'" ').concat(a).concat(s,">").concat(DI(n),"</tspan>")}_setSVGTextLineText(n,e,t,r){const o=this.getHeightOfLine(e),s=this.textAlign.includes(Ua),i=this._textLines[e];let a,A,d,c,u,h="",p=0;r+=o*(1-this._fontSizeFraction)/this.lineHeight;for(let v=0,w=i.length-1;v<=w;v++)u=v===w||this.charSpacing,h+=i[v],d=this.__charBounds[e][v],p===0?(t+=d.kernedWidth-d.width,p+=d.width):p+=d.kernedWidth,s&&!u&&this._reSpaceAndTab.test(i[v])&&(u=!0),u||(a=a||this.getCompleteStyleDeclaration(e,v),A=this.getCompleteStyleDeclaration(e,v+1),u=M1(a,A,!0)),u&&(c=this._getStyleDeclaration(e,v),n.push(this._createTextCharSpan(h,c,t,r)),h="",a=A,this.direction==="rtl"?t-=p:t+=p,p=0)}_setSVGTextLineBg(n,e,t,r){const o=this._textLines[e],s=this.getHeightOfLine(e)/this.lineHeight;let i,a=0,A=0,d=this.getValueOfPropertyAt(e,0,"textBackgroundColor");for(let c=0;c<o.length;c++){const{left:u,width:h,kernedWidth:p}=this.__charBounds[e][c];i=this.getValueOfPropertyAt(e,c,"textBackgroundColor"),i!==d?(d&&n.push(...Ev(d,t+A,r,a,s)),A=u,a=h,d=i):a+=p}i&&n.push(...Ev(d,t+A,r,a,s))}_getSVGLineTopOffset(n){let e,t=0;for(e=0;e<n;e++)t+=this.getHeightOfLine(e);const r=this.getHeightOfLine(e);return{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*r/(this.lineHeight*this._fontSizeMult)}}getSvgStyles(n){return"".concat(super.getSvgStyles(n)," white-space: pre;")}getSvgSpanStyles(n,e){const{fontFamily:t,strokeWidth:r,stroke:o,fill:s,fontSize:i,fontStyle:a,fontWeight:A,deltaY:d}=n,c=this.getSvgTextDecoration(n);return[o?Zu(ei,o):"",r?"stroke-width: ".concat(r,"; "):"",t?"font-family: ".concat(t.includes("'")||t.includes('"')?t:"'".concat(t,"'"),"; "):"",i?"font-size: ".concat(i,"px; "):"",a?"font-style: ".concat(a,"; "):"",A?"font-weight: ".concat(A,"; "):"",c&&"text-decoration: ".concat(c,"; "),s?Zu(Ko,s):"",d?"baseline-shift: ".concat(-d,"; "):"",e?"white-space: pre; ":""].join("")}getSvgTextDecoration(n){return["overline","underline","line-through"].filter(e=>n[e.replace("-","")]).join(" ")}}]),lr.setClass(Ds),lr.setSVGClass(Ds);class eQ{constructor(e){Xe(this,"target",void 0),Xe(this,"__mouseDownInPlace",!1),Xe(this,"__dragStartFired",!1),Xe(this,"__isDraggingOver",!1),Xe(this,"__dragStartSelection",void 0),Xe(this,"__dragImageDisposer",void 0),Xe(this,"_dispose",void 0),this.target=e;const t=[this.target.on("dragenter",this.dragEnterHandler.bind(this)),this.target.on("dragover",this.dragOverHandler.bind(this)),this.target.on("dragleave",this.dragLeaveHandler.bind(this)),this.target.on("dragend",this.dragEndHandler.bind(this)),this.target.on("drop",this.dropHandler.bind(this))];this._dispose=()=>{t.forEach(r=>r()),this._dispose=void 0}}isPointerOverSelection(e){const t=this.target,r=t.getSelectionStartFromPointer(e);return t.isEditing&&r>=t.selectionStart&&r<=t.selectionEnd&&t.selectionStart<t.selectionEnd}start(e){return this.__mouseDownInPlace=this.isPointerOverSelection(e)}isActive(){return this.__mouseDownInPlace}end(e){const t=this.isActive();return t&&!this.__dragStartFired&&(this.target.setCursorByClick(e),this.target.initDelayedCursor(!0)),this.__mouseDownInPlace=!1,this.__dragStartFired=!1,this.__isDraggingOver=!1,t}getDragStartSelection(){return this.__dragStartSelection}setDragImage(e,t){var r;let{selectionStart:o,selectionEnd:s}=t;const i=this.target,a=i.canvas,A=new zt(i.flipX?-1:1,i.flipY?-1:1),d=i._getCursorBoundaries(o),c=new zt(d.left+d.leftOffset,d.top+d.topOffset).multiply(A).transform(i.calcTransformMatrix()),u=a.getScenePoint(e).subtract(c),h=i.getCanvasRetinaScaling(),p=i.getBoundingRect(),v=c.subtract(new zt(p.left,p.top)),w=a.viewportTransform,y=v.add(u).transform(w,!0),B=i.backgroundColor,C=D1(i.styles);i.backgroundColor="";const Q={stroke:"transparent",fill:"transparent",textBackgroundColor:"transparent"};i.setSelectionStyles(Q,0,o),i.setSelectionStyles(Q,s,i.text.length),i.dirty=!0;const k=i.toCanvasElement({enableRetinaScaling:a.enableRetinaScaling,viewportTransform:!0});i.backgroundColor=B,i.styles=C,i.dirty=!0,Y0(k,{position:"fixed",left:"".concat(-k.width,"px"),border:Zs,width:"".concat(k.width/h,"px"),height:"".concat(k.height/h,"px")}),this.__dragImageDisposer&&this.__dragImageDisposer(),this.__dragImageDisposer=()=>{k.remove()},oa(e.target||this.target.hiddenTextarea).body.appendChild(k),(r=e.dataTransfer)===null||r===void 0||r.setDragImage(k,y.x,y.y)}onDragStart(e){this.__dragStartFired=!0;const t=this.target,r=this.isActive();if(r&&e.dataTransfer){const o=this.__dragStartSelection={selectionStart:t.selectionStart,selectionEnd:t.selectionEnd},s=t._text.slice(o.selectionStart,o.selectionEnd).join(""),i=Je({text:t.text,value:s},o);e.dataTransfer.setData("text/plain",s),e.dataTransfer.setData("application/fabric",JSON.stringify({value:s,styles:t.getSelectionStyles(o.selectionStart,o.selectionEnd,!0)})),e.dataTransfer.effectAllowed="copyMove",this.setDragImage(e,i)}return t.abortCursorAnimation(),r}canDrop(e){if(this.target.editable&&!this.target.getActiveControl()&&!e.defaultPrevented){if(this.isActive()&&this.__dragStartSelection){const t=this.target.getSelectionStartFromPointer(e),r=this.__dragStartSelection;return t<r.selectionStart||t>r.selectionEnd}return!0}return!1}targetCanDrop(e){return this.target.canDrop(e)}dragEnterHandler(e){let{e:t}=e;const r=this.targetCanDrop(t);!this.__isDraggingOver&&r&&(this.__isDraggingOver=!0)}dragOverHandler(e){const{e:t}=e,r=this.targetCanDrop(t);!this.__isDraggingOver&&r?this.__isDraggingOver=!0:this.__isDraggingOver&&!r&&(this.__isDraggingOver=!1),this.__isDraggingOver&&(t.preventDefault(),e.canDrop=!0,e.dropTarget=this.target)}dragLeaveHandler(){(this.__isDraggingOver||this.isActive())&&(this.__isDraggingOver=!1)}dropHandler(e){var t;const{e:r}=e,o=r.defaultPrevented;this.__isDraggingOver=!1,r.preventDefault();let s=(t=r.dataTransfer)===null||t===void 0?void 0:t.getData("text/plain");if(s&&!o){const i=this.target,a=i.canvas;let A=i.getSelectionStartFromPointer(r);const{styles:d}=r.dataTransfer.types.includes("application/fabric")?JSON.parse(r.dataTransfer.getData("application/fabric")):{},c=s[Math.max(0,s.length-1)],u=0;if(this.__dragStartSelection){const h=this.__dragStartSelection.selectionStart,p=this.__dragStartSelection.selectionEnd;A>h&&A<=p?A=h:A>p&&(A-=p-h),i.removeChars(h,p),delete this.__dragStartSelection}i._reNewline.test(c)&&(i._reNewline.test(i._text[A])||A===i._text.length)&&(s=s.trimEnd()),e.didDrop=!0,e.dropTarget=i,i.insertChars(s,d,A),a.setActiveObject(i),i.enterEditing(r),i.selectionStart=Math.min(A+u,i._text.length),i.selectionEnd=Math.min(i.selectionStart+s.length,i._text.length),i.hiddenTextarea.value=i.text,i._updateTextarea(),i.hiddenTextarea.focus(),i.fire(zp,{index:A+u,action:"drop"}),a.fire("text:changed",{target:i}),a.contextTopDirty=!0,a.requestRenderAll()}}dragEndHandler(e){let{e:t}=e;if(this.isActive()&&this.__dragStartFired&&this.__dragStartSelection){var r;const o=this.target,s=this.target.canvas,{selectionStart:i,selectionEnd:a}=this.__dragStartSelection,A=((r=t.dataTransfer)===null||r===void 0?void 0:r.dropEffect)||Zs;A===Zs?(o.selectionStart=i,o.selectionEnd=a,o._updateTextarea(),o.hiddenTextarea.focus()):(o.clearContextTop(),A==="move"&&(o.removeChars(i,a),o.selectionStart=o.selectionEnd=i,o.hiddenTextarea&&(o.hiddenTextarea.value=o.text),o._updateTextarea(),o.fire(zp,{index:i,action:"dragend"}),s.fire("text:changed",{target:o}),s.requestRenderAll()),o.exitEditing())}this.__dragImageDisposer&&this.__dragImageDisposer(),delete this.__dragImageDisposer,delete this.__dragStartSelection,this.__isDraggingOver=!1}dispose(){this._dispose&&this._dispose()}}const oy=/[ \n\.,;!\?\-]/;class tQ extends Ds{constructor(){super(...arguments),Xe(this,"_currentCursorOpacity",1)}initBehavior(){this._tick=this._tick.bind(this),this._onTickComplete=this._onTickComplete.bind(this),this.updateSelectionOnMouseMove=this.updateSelectionOnMouseMove.bind(this)}onDeselect(e){return this.isEditing&&this.exitEditing(),this.selected=!1,super.onDeselect(e)}_animateCursor(e){let{toValue:t,duration:r,delay:o,onComplete:s}=e;return px({startValue:this._currentCursorOpacity,endValue:t,duration:r,delay:o,onComplete:s,abort:()=>!this.canvas||this.selectionStart!==this.selectionEnd,onChange:i=>{this._currentCursorOpacity=i,this.renderCursorOrSelection()}})}_tick(e){this._currentTickState=this._animateCursor({toValue:0,duration:this.cursorDuration/2,delay:Math.max(e||0,100),onComplete:this._onTickComplete})}_onTickComplete(){var e;(e=this._currentTickCompleteState)===null||e===void 0||e.abort(),this._currentTickCompleteState=this._animateCursor({toValue:1,duration:this.cursorDuration,onComplete:this._tick})}initDelayedCursor(e){this.abortCursorAnimation(),this._tick(e?0:this.cursorDelay)}abortCursorAnimation(){let e=!1;[this._currentTickState,this._currentTickCompleteState].forEach(t=>{t&&!t.isDone()&&(e=!0,t.abort())}),this._currentCursorOpacity=1,e&&this.clearContextTop()}restartCursorIfNeeded(){[this._currentTickState,this._currentTickCompleteState].some(e=>!e||e.isDone())&&this.initDelayedCursor()}selectAll(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this}getSelectedText(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")}findWordBoundaryLeft(e){let t=0,r=e-1;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r--;for(;/\S/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findWordBoundaryRight(e){let t=0,r=e;if(this._reSpace.test(this._text[r]))for(;this._reSpace.test(this._text[r]);)t++,r++;for(;/\S/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}findLineBoundaryLeft(e){let t=0,r=e-1;for(;!/\n/.test(this._text[r])&&r>-1;)t++,r--;return e-t}findLineBoundaryRight(e){let t=0,r=e;for(;!/\n/.test(this._text[r])&&r<this._text.length;)t++,r++;return e+t}searchWordBoundary(e,t){const r=this._text;let o=e>0&&this._reSpace.test(r[e])&&(t===-1||!C1.test(r[e-1]))?e-1:e,s=r[o];for(;o>0&&o<r.length&&!oy.test(s);)o+=t,s=r[o];return t===-1&&oy.test(s)&&o++,o}selectWord(e){e=e||this.selectionStart;const t=this.searchWordBoundary(e,-1),r=Math.max(t,this.searchWordBoundary(e,1));this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()}selectLine(e){e=e||this.selectionStart;const t=this.findLineBoundaryLeft(e),r=this.findLineBoundaryRight(e);return this.selectionStart=t,this.selectionEnd=r,this._fireSelectionChanged(),this._updateTextarea(),this}enterEditing(e){!this.isEditing&&this.editable&&(this.enterEditingImpl(),this.fire("editing:entered",e?{e}:void 0),this._fireSelectionChanged(),this.canvas&&(this.canvas.fire("text:editing:entered",{target:this,e}),this.canvas.requestRenderAll()))}enterEditingImpl(){this.canvas&&(this.canvas.calcOffset(),this.canvas.textEditingManager.exitTextEditing()),this.isEditing=!0,this.initHiddenTextarea(),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick()}updateSelectionOnMouseMove(e){if(this.getActiveControl())return;const t=this.hiddenTextarea;oa(t).activeElement!==t&&t.focus();const r=this.getSelectionStartFromPointer(e),o=this.selectionStart,s=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&o!==s||o!==r&&s!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===o&&this.selectionEnd===s||(this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}_setEditingProps(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0}fromStringToGraphemeSelection(e,t,r){const o=r.slice(0,e),s=this.graphemeSplit(o).length;if(e===t)return{selectionStart:s,selectionEnd:s};const i=r.slice(e,t);return{selectionStart:s,selectionEnd:s+this.graphemeSplit(i).length}}fromGraphemeToStringSelection(e,t,r){const o=r.slice(0,e).join("").length;return e===t?{selectionStart:o,selectionEnd:o}:{selectionStart:o,selectionEnd:o+r.slice(e,t).join("").length}}_updateTextarea(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){const e=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=e.selectionStart,this.hiddenTextarea.selectionEnd=e.selectionEnd}this.updateTextareaPosition()}}updateFromTextArea(){if(!this.hiddenTextarea)return;this.cursorOffsetCache={};const e=this.hiddenTextarea;this.text=e.value,this.set("dirty",!0),this.initDimensions(),this.setCoords();const t=this.fromStringToGraphemeSelection(e.selectionStart,e.selectionEnd,e.value);this.selectionEnd=this.selectionStart=t.selectionEnd,this.inCompositionMode||(this.selectionStart=t.selectionStart),this.updateTextareaPosition()}updateTextareaPosition(){if(this.selectionStart===this.selectionEnd){const e=this._calcTextareaPosition();this.hiddenTextarea.style.left=e.left,this.hiddenTextarea.style.top=e.top}}_calcTextareaPosition(){if(!this.canvas)return{left:"1px",top:"1px"};const e=this.inCompositionMode?this.compositionStart:this.selectionStart,t=this._getCursorBoundaries(e),r=this.get2DCursorLocation(e),o=r.lineIndex,s=r.charIndex,i=this.getValueOfPropertyAt(o,s,"fontSize")*this.lineHeight,a=t.leftOffset,A=this.getCanvasRetinaScaling(),d=this.canvas.upperCanvasEl,c=d.width/A,u=d.height/A,h=c-i,p=u-i,v=new zt(t.left+a,t.top+t.topOffset+i).transform(this.calcTransformMatrix()).transform(this.canvas.viewportTransform).multiply(new zt(d.clientWidth/c,d.clientHeight/u));return v.x<0&&(v.x=0),v.x>h&&(v.x=h),v.y<0&&(v.y=0),v.y>p&&(v.y=p),v.x+=this.canvas._offset.left,v.y+=this.canvas._offset.top,{left:"".concat(v.x,"px"),top:"".concat(v.y,"px"),fontSize:"".concat(i,"px"),charHeight:i}}_saveEditingProps(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}}_restoreEditingProps(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor||this.canvas.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor||this.canvas.moveCursor),delete this._savedProps)}_exitEditing(){const e=this.hiddenTextarea;this.selected=!1,this.isEditing=!1,e&&(e.blur&&e.blur(),e.parentNode&&e.parentNode.removeChild(e)),this.hiddenTextarea=null,this.abortCursorAnimation(),this.selectionStart!==this.selectionEnd&&this.clearContextTop()}exitEditingImpl(){this._exitEditing(),this.selectionEnd=this.selectionStart,this._restoreEditingProps(),this._forceClearCache&&(this.initDimensions(),this.setCoords())}exitEditing(){const e=this._textBeforeEdit!==this.text;return this.exitEditingImpl(),this.fire("editing:exited"),e&&this.fire(Cp),this.canvas&&(this.canvas.fire("text:editing:exited",{target:this}),e&&this.canvas.fire("object:modified",{target:this})),this}_removeExtraneousStyles(){for(const e in this.styles)this._textLines[e]||delete this.styles[e]}removeStyleFromTo(e,t){const{lineIndex:r,charIndex:o}=this.get2DCursorLocation(e,!0),{lineIndex:s,charIndex:i}=this.get2DCursorLocation(t,!0);if(r!==s){if(this.styles[r])for(let a=o;a<this._unwrappedTextLines[r].length;a++)delete this.styles[r][a];if(this.styles[s])for(let a=i;a<this._unwrappedTextLines[s].length;a++){const A=this.styles[s][a];A&&(this.styles[r]||(this.styles[r]={}),this.styles[r][o+a-i]=A)}for(let a=r+1;a<=s;a++)delete this.styles[a];this.shiftLineStyles(s,r-s)}else if(this.styles[r]){const a=this.styles[r],A=i-o;for(let d=o;d<i;d++)delete a[d];for(const d in this.styles[r]){const c=parseInt(d,10);c>=i&&(a[c-A]=a[d],delete a[d])}}}shiftLineStyles(e,t){const r=Object.assign({},this.styles);for(const o in this.styles){const s=parseInt(o,10);s>e&&(this.styles[s+t]=r[s],r[s-t]||delete this.styles[s])}}insertNewlineStyleObject(e,t,r,o){const s={},i=this._unwrappedTextLines[e].length,a=i===t;let A=!1;r||(r=1),this.shiftLineStyles(e,r);const d=this.styles[e]?this.styles[e][t===0?t:t-1]:void 0;for(const u in this.styles[e]){const h=parseInt(u,10);h>=t&&(A=!0,s[h-t]=this.styles[e][u],a&&t===0||delete this.styles[e][u])}let c=!1;for(A&&!a&&(this.styles[e+r]=s,c=!0),(c||i>t)&&r--;r>0;)o&&o[r-1]?this.styles[e+r]={0:Je({},o[r-1])}:d?this.styles[e+r]={0:Je({},d)}:delete this.styles[e+r],r--;this._forceClearCache=!0}insertCharStyleObject(e,t,r,o){this.styles||(this.styles={});const s=this.styles[e],i=s?Je({},s):{};r||(r=1);for(const A in i){const d=parseInt(A,10);d>=t&&(s[d+r]=i[d],i[d-r]||delete s[d])}if(this._forceClearCache=!0,o){for(;r--;)Object.keys(o[r]).length&&(this.styles[e]||(this.styles[e]={}),this.styles[e][t+r]=Je({},o[r]));return}if(!s)return;const a=s[t?t-1:1];for(;a&&r--;)this.styles[e][t+r]=Je({},a)}insertNewStyleBlock(e,t,r){const o=this.get2DCursorLocation(t,!0),s=[0];let i,a=0;for(let A=0;A<e.length;A++)e[A]===`
`?(a++,s[a]=0):s[a]++;for(s[0]>0&&(this.insertCharStyleObject(o.lineIndex,o.charIndex,s[0],r),r=r&&r.slice(s[0]+1)),a&&this.insertNewlineStyleObject(o.lineIndex,o.charIndex+s[0],a),i=1;i<a;i++)s[i]>0?this.insertCharStyleObject(o.lineIndex+i,0,s[i],r):r&&this.styles[o.lineIndex+i]&&r[0]&&(this.styles[o.lineIndex+i][0]=r[0]),r=r&&r.slice(s[i]+1);s[i]>0&&this.insertCharStyleObject(o.lineIndex+i,0,s[i],r)}removeChars(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e+1;this.removeStyleFromTo(e,t),this._text.splice(e,t-e),this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}insertChars(e,t,r){let o=arguments.length>3&&arguments[3]!==void 0?arguments[3]:r;o>r&&this.removeStyleFromTo(r,o);const s=this.graphemeSplit(e);this.insertNewStyleBlock(s,r,t),this._text=[...this._text.slice(0,r),...s,...this._text.slice(o)],this.text=this._text.join(""),this.set("dirty",!0),this.initDimensions(),this.setCoords(),this._removeExtraneousStyles()}setSelectionStartEndWithShift(e,t,r){r<=e?(t===e?this._selectionDirection=zn:this._selectionDirection===So&&(this._selectionDirection=zn,this.selectionEnd=e),this.selectionStart=r):r>e&&r<t?this._selectionDirection===So?this.selectionEnd=r:this.selectionStart=r:(t===e?this._selectionDirection=So:this._selectionDirection===zn&&(this._selectionDirection=So,this.selectionStart=t),this.selectionEnd=r)}}class rQ extends tQ{initHiddenTextarea(){const e=this.canvas&&oa(this.canvas.getElement())||Oc(),t=e.createElement("textarea");Object.entries({autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false","data-fabric":"textarea",wrap:"off"}).map(i=>{let[a,A]=i;return t.setAttribute(a,A)});const{top:r,left:o,fontSize:s}=this._calcTextareaPosition();t.style.cssText="position: absolute; top: ".concat(r,"; left: ").concat(o,"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: ").concat(s,";"),(this.hiddenTextareaContainer||e.body).appendChild(t),Object.entries({blur:"blur",keydown:"onKeyDown",keyup:"onKeyUp",input:"onInput",copy:"copy",cut:"copy",paste:"paste",compositionstart:"onCompositionStart",compositionupdate:"onCompositionUpdate",compositionend:"onCompositionEnd"}).map(i=>{let[a,A]=i;return t.addEventListener(a,this[A].bind(this))}),this.hiddenTextarea=t}blur(){this.abortCursorAnimation()}onKeyDown(e){if(!this.isEditing)return;const t=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(e.keyCode in t)this[t[e.keyCode]](e);else{if(!(e.keyCode in this.ctrlKeysMapDown)||!e.ctrlKey&&!e.metaKey)return;this[this.ctrlKeysMapDown[e.keyCode]](e)}e.stopImmediatePropagation(),e.preventDefault(),e.keyCode>=33&&e.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}onKeyUp(e){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:e.keyCode in this.ctrlKeysMapUp&&(e.ctrlKey||e.metaKey)&&(this[this.ctrlKeysMapUp[e.keyCode]](e),e.stopImmediatePropagation(),e.preventDefault(),this.canvas&&this.canvas.requestRenderAll())}onInput(e){const t=this.fromPaste;if(this.fromPaste=!1,e&&e.stopPropagation(),!this.isEditing)return;const r=()=>{this.updateFromTextArea(),this.fire(zp),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())};if(this.hiddenTextarea.value==="")return this.styles={},void r();const o=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,s=this._text.length,i=o.length,a=this.selectionStart,A=this.selectionEnd,d=a!==A;let c,u,h,p,v=i-s;const w=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),y=a>w.selectionStart;d?(u=this._text.slice(a,A),v+=A-a):i<s&&(u=y?this._text.slice(A+v,A):this._text.slice(a,a-v));const B=o.slice(w.selectionEnd-v,w.selectionEnd);if(u&&u.length&&(B.length&&(c=this.getSelectionStyles(a,a+1,!1),c=B.map(()=>c[0])),d?(h=a,p=A):y?(h=A-u.length,p=A):(h=A,p=A+u.length),this.removeStyleFromTo(h,p)),B.length){const{copyPasteData:C}=Ha();t&&B.join("")===C.copiedText&&!mn.disableStyleCopyPaste&&(c=C.copiedTextStyle),this.insertNewStyleBlock(B,a,c)}r()}onCompositionStart(){this.inCompositionMode=!0}onCompositionEnd(){this.inCompositionMode=!1}onCompositionUpdate(e){let{target:t}=e;const{selectionStart:r,selectionEnd:o}=t;this.compositionStart=r,this.compositionEnd=o,this.updateTextareaPosition()}copy(){if(this.selectionStart===this.selectionEnd)return;const{copyPasteData:e}=Ha();e.copiedText=this.getSelectedText(),mn.disableStyleCopyPaste?e.copiedTextStyle=void 0:e.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0}paste(){this.fromPaste=!0}_getWidthBeforeCursor(e,t){let r,o=this._getLineLeftOffset(e);return t>0&&(r=this.__charBounds[e][t-1],o+=r.left+r.width),o}getDownCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(r),s=o.lineIndex;if(s===this._textLines.length-1||e.metaKey||e.keyCode===34)return this._text.length-r;const i=o.charIndex,a=this._getWidthBeforeCursor(s,i),A=this._getIndexOnLine(s+1,a);return this._textLines[s].slice(i).length+A+1+this.missingNewlineOffset(s)}_getSelectionForOffset(e,t){return e.shiftKey&&this.selectionStart!==this.selectionEnd&&t?this.selectionEnd:this.selectionStart}getUpCursorOffset(e,t){const r=this._getSelectionForOffset(e,t),o=this.get2DCursorLocation(r),s=o.lineIndex;if(s===0||e.metaKey||e.keyCode===33)return-r;const i=o.charIndex,a=this._getWidthBeforeCursor(s,i),A=this._getIndexOnLine(s-1,a),d=this._textLines[s].slice(0,i),c=this.missingNewlineOffset(s-1);return-this._textLines[s-1].length+A-d.length+(1-c)}_getIndexOnLine(e,t){const r=this._textLines[e];let o,s,i=this._getLineLeftOffset(e),a=0;for(let A=0,d=r.length;A<d;A++)if(o=this.__charBounds[e][A].width,i+=o,i>t){s=!0;const c=i-o,u=i,h=Math.abs(c-t);a=Math.abs(u-t)<h?A:A-1;break}return s||(a=r.length-1),a}moveCursorDown(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",e)}moveCursorUp(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",e)}_moveCursorUpOrDown(e,t){const r=this["get".concat(e,"CursorOffset")](t,this._selectionDirection===So);if(t.shiftKey?this.moveCursorWithShift(r):this.moveCursorWithoutShift(r),r!==0){const o=this.text.length;this.selectionStart=Cc(0,this.selectionStart,o),this.selectionEnd=Cc(0,this.selectionEnd,o),this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea()}}moveCursorWithShift(e){const t=this._selectionDirection===zn?this.selectionStart+e:this.selectionEnd+e;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,t),e!==0}moveCursorWithoutShift(e){return e<0?(this.selectionStart+=e,this.selectionEnd=this.selectionStart):(this.selectionEnd+=e,this.selectionStart=this.selectionEnd),e!==0}moveCursorLeft(e){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",e)}_move(e,t,r){let o;if(e.altKey)o=this["findWordBoundary".concat(r)](this[t]);else{if(!e.metaKey&&e.keyCode!==35&&e.keyCode!==36)return this[t]+=r==="Left"?-1:1,!0;o=this["findLineBoundary".concat(r)](this[t])}return o!==void 0&&this[t]!==o&&(this[t]=o,!0)}_moveLeft(e,t){return this._move(e,t,"Left")}_moveRight(e,t){return this._move(e,t,"Right")}moveCursorLeftWithoutShift(e){let t=!0;return this._selectionDirection=zn,this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(t=this._moveLeft(e,"selectionStart")),this.selectionEnd=this.selectionStart,t}moveCursorLeftWithShift(e){return this._selectionDirection===So&&this.selectionStart!==this.selectionEnd?this._moveLeft(e,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection=zn,this._moveLeft(e,"selectionStart")):void 0}moveCursorRight(e){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",e)}_moveCursorLeftOrRight(e,t){const r="moveCursor".concat(e).concat(t.shiftKey?"WithShift":"WithoutShift");this._currentCursorOpacity=1,this[r](t)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())}moveCursorRightWithShift(e){return this._selectionDirection===zn&&this.selectionStart!==this.selectionEnd?this._moveRight(e,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection=So,this._moveRight(e,"selectionEnd")):void 0}moveCursorRightWithoutShift(e){let t=!0;return this._selectionDirection=So,this.selectionStart===this.selectionEnd?(t=this._moveRight(e,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,t}}const Iv=n=>!!n.button;class nQ extends rQ{constructor(){super(...arguments),Xe(this,"draggableTextDelegate",void 0)}initBehavior(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore),this.on("mouseup",this.mouseUpHandler),this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler),this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown),this.draggableTextDelegate=new eQ(this),super.initBehavior()}shouldStartDragging(){return this.draggableTextDelegate.isActive()}onDragStart(e){return this.draggableTextDelegate.onDragStart(e)}canDrop(e){return this.draggableTextDelegate.canDrop(e)}onMouseDown(e){if(!this.canvas)return;this.__newClickTime=+new Date;const t=e.pointer;this.isTripleClick(t)&&(this.fire("tripleclick",e),q0(e.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=t,this.__lastSelected=this.selected&&!this.getActiveControl()}isTripleClick(e){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===e.x&&this.__lastPointer.y===e.y}doubleClickHandler(e){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(e.e))}tripleClickHandler(e){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(e.e))}_mouseDownHandler(e){let{e:t}=e;this.canvas&&this.editable&&!Iv(t)&&!this.getActiveControl()&&(this.draggableTextDelegate.start(t)||(this.canvas.textEditingManager.register(this),this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(t)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection())))}_mouseDownHandlerBefore(e){let{e:t}=e;this.canvas&&this.editable&&!Iv(t)&&(this.selected=this===this.canvas._activeObject)}mouseUpHandler(e){let{e:t,transform:r}=e;const o=this.draggableTextDelegate.end(t);if(this.canvas){this.canvas.textEditingManager.unregister(this);const s=this.canvas._activeObject;if(s&&s!==this)return}!this.editable||this.group&&!this.group.interactive||r&&r.actionPerformed||Iv(t)||o||(this.__lastSelected&&!this.getActiveControl()?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(t),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0)}setCursorByClick(e){const t=this.getSelectionStartFromPointer(e),r=this.selectionStart,o=this.selectionEnd;e.shiftKey?this.setSelectionStartEndWithShift(r,o,t):(this.selectionStart=t,this.selectionEnd=t),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())}getSelectionStartFromPointer(e){const t=this.canvas.getScenePoint(e).transform(sa(this.calcTransformMatrix())).add(new zt(-this._getLeftOffset(),-this._getTopOffset()));let r=0,o=0,s=0;for(let d=0;d<this._textLines.length&&r<=t.y;d++)r+=this.getHeightOfLine(d),s=d,d>0&&(o+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));let i=Math.abs(this._getLineLeftOffset(s));const a=this._textLines[s].length,A=this.__charBounds[s];for(let d=0;d<a;d++){const c=i+A[d].kernedWidth;if(t.x<=c){Math.abs(t.x-c)<=Math.abs(t.x-i)&&o++;break}i=c,o++}return Math.min(this.flipX?a-o:o,this._text.length)}}const ef="moveCursorUp",tf="moveCursorDown",rf="moveCursorLeft",nf="moveCursorRight",of="exitEditing",oQ=Je({selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,keysMap:{9:of,27:of,33:ef,34:tf,35:nf,36:rf,37:rf,38:ef,39:nf,40:tf},keysMapRtl:{9:of,27:of,33:ef,34:tf,35:rf,36:nf,37:nf,38:ef,39:rf,40:tf},ctrlKeysMapDown:{65:"selectAll"},ctrlKeysMapUp:{67:"copy",88:"cut"}},{_selectionDirection:null,_reSpace:/\s|\r?\n/,inCompositionMode:!1});class gA extends nQ{static getDefaults(){return Je(Je({},super.getDefaults()),gA.ownDefaults)}get type(){const e=super.type;return e==="itext"?"i-text":e}constructor(e,t){super(e,Je(Je({},gA.ownDefaults),t)),this.initBehavior()}_set(e,t){return this.isEditing&&this._savedProps&&e in this._savedProps?(this._savedProps[e]=t,this):(e==="canvas"&&(this.canvas instanceof J0&&this.canvas.textEditingManager.remove(this),t instanceof J0&&t.textEditingManager.add(this)),super._set(e,t))}setSelectionStart(e){e=Math.max(e,0),this._updateAndFire("selectionStart",e)}setSelectionEnd(e){e=Math.min(e,this.text.length),this._updateAndFire("selectionEnd",e)}_updateAndFire(e,t){this[e]!==t&&(this._fireSelectionChanged(),this[e]=t),this._updateTextarea()}_fireSelectionChanged(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})}initDimensions(){this.isEditing&&this.initDelayedCursor(),super.initDimensions()}getSelectionStyles(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart||0,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionEnd,r=arguments.length>2?arguments[2]:void 0;return super.getSelectionStyles(e,t,r)}setSelectionStyles(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.selectionStart||0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.selectionEnd;return super.setSelectionStyles(e,t,r)}get2DCursorLocation(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;return super.get2DCursorLocation(e,t)}render(e){super.render(e),this.cursorOffsetCache={},this.renderCursorOrSelection()}toCanvasElement(e){const t=this.isEditing;this.isEditing=!1;const r=super.toCanvasElement(e);return this.isEditing=t,r}renderCursorOrSelection(){if(!this.isEditing)return;const e=this.clearContextTop(!0);if(!e)return;const t=this._getCursorBoundaries();this.selectionStart!==this.selectionEnd||this.inCompositionMode?this.renderSelection(e,t):this.renderCursor(e,t),this.canvas.contextTopDirty=!0,e.restore()}_getCursorBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1?arguments[1]:void 0;const r=this._getLeftOffset(),o=this._getTopOffset(),s=this._getCursorBoundariesOffsets(e,t);return{left:r,top:o,leftOffset:s.left,topOffset:s.top}}_getCursorBoundariesOffsets(e,t){return t?this.__getCursorBoundariesOffsets(e):this.cursorOffsetCache&&"top"in this.cursorOffsetCache?this.cursorOffsetCache:this.cursorOffsetCache=this.__getCursorBoundariesOffsets(e)}__getCursorBoundariesOffsets(e){let t=0,r=0;const{charIndex:o,lineIndex:s}=this.get2DCursorLocation(e);for(let d=0;d<s;d++)t+=this.getHeightOfLine(d);const i=this._getLineLeftOffset(s),a=this.__charBounds[s][o];a&&(r=a.left),this.charSpacing!==0&&o===this._textLines[s].length&&(r-=this._getWidthOfCharSpacing());const A={top:t,left:i+(r>0?r:0)};return this.direction==="rtl"&&(this.textAlign===So||this.textAlign===Ua||this.textAlign===Iu?A.left*=-1:this.textAlign===zn||this.textAlign===Pp?A.left=i-(r>0?r:0):this.textAlign!==Gr&&this.textAlign!==Uu||(A.left=i-(r>0?r:0))),A}renderCursorAt(e){this._renderCursor(this.canvas.contextTop,this._getCursorBoundaries(e,!0),e)}renderCursor(e,t){this._renderCursor(e,t,this.selectionStart)}getCursorRenderingData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.selectionStart,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this._getCursorBoundaries(e);const r=this.get2DCursorLocation(e),o=r.lineIndex,s=r.charIndex>0?r.charIndex-1:0,i=this.getValueOfPropertyAt(o,s,"fontSize"),a=this.getObjectScaling().x*this.canvas.getZoom(),A=this.cursorWidth/a,d=this.getValueOfPropertyAt(o,s,"deltaY"),c=t.topOffset+(1-this._fontSizeFraction)*this.getHeightOfLine(o)/this.lineHeight-i*(1-this._fontSizeFraction);return{color:this.cursorColor||this.getValueOfPropertyAt(o,s,"fill"),opacity:this._currentCursorOpacity,left:t.left+t.leftOffset-A/2,top:c+t.top+d,width:A,height:i}}_renderCursor(e,t,r){const{color:o,opacity:s,left:i,top:a,width:A,height:d}=this.getCursorRenderingData(r,t);e.fillStyle=o,e.globalAlpha=s,e.fillRect(i,a,A,d)}renderSelection(e,t){const r={selectionStart:this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,selectionEnd:this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd};this._renderSelection(e,r,t)}renderDragSourceEffect(){const e=this.draggableTextDelegate.getDragStartSelection();this._renderSelection(this.canvas.contextTop,e,this._getCursorBoundaries(e.selectionStart,!0))}renderDropTargetEffect(e){const t=this.getSelectionStartFromPointer(e);this.renderCursorAt(t)}_renderSelection(e,t,r){const o=t.selectionStart,s=t.selectionEnd,i=this.textAlign.includes(Ua),a=this.get2DCursorLocation(o),A=this.get2DCursorLocation(s),d=a.lineIndex,c=A.lineIndex,u=a.charIndex<0?0:a.charIndex,h=A.charIndex<0?0:A.charIndex;for(let p=d;p<=c;p++){const v=this._getLineLeftOffset(p)||0;let w=this.getHeightOfLine(p),y=0,B=0,C=0;if(p===d&&(B=this.__charBounds[d][u].left),p>=d&&p<c)C=i&&!this.isEndOfWrapping(p)?this.width:this.getLineWidth(p)||5;else if(p===c)if(h===0)C=this.__charBounds[c][h].left;else{const q=this._getWidthOfCharSpacing();C=this.__charBounds[c][h-1].left+this.__charBounds[c][h-1].width-q}y=w,(this.lineHeight<1||p===c&&this.lineHeight>1)&&(w/=this.lineHeight);let Q=r.left+v+B,k=w,H=0;const Z=C-B;this.inCompositionMode?(e.fillStyle=this.compositionColor||"black",k=1,H=w):e.fillStyle=this.selectionColor,this.direction==="rtl"&&(this.textAlign===So||this.textAlign===Ua||this.textAlign===Iu?Q=this.width-Q-Z:this.textAlign===zn||this.textAlign===Pp?Q=r.left+v-C:this.textAlign!==Gr&&this.textAlign!==Uu||(Q=r.left+v-C)),e.fillRect(Q,r.top+r.topOffset+H,Z,k),r.topOffset+=y}}getCurrentCharFontSize(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,"fontSize")}getCurrentCharColor(){const e=this._getCurrentCharIndex();return this.getValueOfPropertyAt(e.l,e.c,Ko)}_getCurrentCharIndex(){const e=this.get2DCursorLocation(this.selectionStart,!0),t=e.charIndex>0?e.charIndex-1:0;return{l:e.lineIndex,c:t}}dispose(){this.exitEditingImpl(),this.draggableTextDelegate.dispose(),super.dispose()}}Xe(gA,"ownDefaults",oQ),Xe(gA,"type","IText"),lr.setClass(gA),lr.setClass(gA,"i-text");class Rl extends gA{static getDefaults(){return Je(Je({},super.getDefaults()),Rl.ownDefaults)}constructor(e,t){super(e,Je(Je({},Rl.ownDefaults),t))}static createControls(){return{controls:LI()}}initDimensions(){this.initialized&&(this.isEditing&&this.initDelayedCursor(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.includes(Ua)&&this.enlargeSpaces(),this.height=this.calcTextHeight())}_generateStyleMap(e){let t=0,r=0,o=0;const s={};for(let i=0;i<e.graphemeLines.length;i++)e.graphemeText[o]===`
`&&i>0?(r=0,o++,t++):!this.splitByGrapheme&&this._reSpaceAndTab.test(e.graphemeText[o])&&i>0&&(r++,o++),s[i]={line:t,offset:r},o+=e.graphemeLines[i].length,r+=e.graphemeLines[i].length;return s}styleHas(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[t];r&&(t=r.line)}return super.styleHas(e,t)}isEmptyStyles(e){if(!this.styles)return!0;let t,r=0,o=e+1,s=!1;const i=this._styleMap[e],a=this._styleMap[e+1];i&&(e=i.line,r=i.offset),a&&(o=a.line,s=o===e,t=a.offset);const A=e===void 0?this.styles:{line:this.styles[e]};for(const d in A)for(const c in A[d]){const u=parseInt(c,10);if(u>=r&&(!s||u<t))for(const h in A[d][c])return!1}return!0}_getStyleDeclaration(e,t){if(this._styleMap&&!this.isWrapping){const r=this._styleMap[e];if(!r)return{};e=r.line,t=r.offset+t}return super._getStyleDeclaration(e,t)}_setStyleDeclaration(e,t,r){const o=this._styleMap[e];super._setStyleDeclaration(o.line,o.offset+t,r)}_deleteStyleDeclaration(e,t){const r=this._styleMap[e];super._deleteStyleDeclaration(r.line,r.offset+t)}_getLineStyle(e){const t=this._styleMap[e];return!!this.styles[t.line]}_setLineStyle(e){const t=this._styleMap[e];super._setLineStyle(t.line)}_wrapText(e,t){this.isWrapping=!0;const r=this.getGraphemeDataForRender(e),o=[];for(let s=0;s<r.wordsData.length;s++)o.push(...this._wrapLine(s,t,r));return this.isWrapping=!1,o}getGraphemeDataForRender(e){const t=this.splitByGrapheme,r=t?"":" ";let o=0;return{wordsData:e.map((s,i)=>{let a=0;const A=t?this.graphemeSplit(s):this.wordSplit(s);return A.length===0?[{word:[],width:0}]:A.map(d=>{const c=t?[d]:this.graphemeSplit(d),u=this._measureWord(c,i,a);return o=Math.max(u,o),a+=c.length+r.length,{word:c,width:u}})}),largestWordWidth:o}}_measureWord(e,t){let r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=0;for(let i=0,a=e.length;i<a;i++)s+=this._getGraphemeBox(e[i],t,i+o,r,!0).kernedWidth,r=e[i];return s}wordSplit(e){return e.split(this._wordJoiners)}_wrapLine(e,t,r){let{largestWordWidth:o,wordsData:s}=r,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const a=this._getWidthOfCharSpacing(),A=this.splitByGrapheme,d=[],c=A?"":" ";let u=0,h=[],p=0,v=0,w=!0;t-=i;const y=Math.max(t,o,this.dynamicMinWidth),B=s[e];let C;for(p=0,C=0;C<B.length;C++){const{word:Q,width:k}=B[C];p+=Q.length,u+=v+k-a,u>y&&!w?(d.push(h),h=[],u=k,w=!0):u+=a,w||A||h.push(c),h=h.concat(Q),v=A?0:this._measureWord([c],e,p),p++,w=!1}return C&&d.push(h),o+i>this.dynamicMinWidth&&(this.dynamicMinWidth=o-a+i),d}isEndOfWrapping(e){return!this._styleMap[e+1]||this._styleMap[e+1].line!==this._styleMap[e].line}missingNewlineOffset(e,t){return this.splitByGrapheme&&!t?this.isEndOfWrapping(e)?1:0:1}_splitTextIntoLines(e){const t=super._splitTextIntoLines(e),r=this._wrapText(t.lines,this.width),o=new Array(r.length);for(let s=0;s<r.length;s++)o[s]=r[s].join("");return t.lines=o,t.graphemeLines=r,t}getMinWidth(){return Math.max(this.minWidth,this.dynamicMinWidth)}_removeExtraneousStyles(){const e=new Map;for(const t in this._styleMap){const r=parseInt(t,10);if(this._textLines[r]){const o=this._styleMap[t].line;e.set("".concat(o),!0)}}for(const t in this.styles)e.has(t)||delete this.styles[t]}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return super.toObject(["minWidth","splitByGrapheme",...e])}}Xe(Rl,"type","Textbox"),Xe(Rl,"textLayoutProperties",[...gA.textLayoutProperties,"width"]),Xe(Rl,"ownDefaults",{minWidth:20,dynamicMinWidth:2,lockScalingFlip:!0,noScaleCache:!1,_wordJoiners:/[ \t\r]/,splitByGrapheme:!1}),lr.setClass(Rl);class sy extends bg{shouldPerformLayout(e){return!!e.target.clipPath&&super.shouldPerformLayout(e)}shouldLayoutClipPath(){return!1}calcLayoutResult(e,t){const{target:r}=e,{clipPath:o,group:s}=r;if(!o||!this.shouldPerformLayout(e))return;const{width:i,height:a}=yA(xx(r,o)),A=new zt(i,a);if(o.absolutePositioned)return{center:hc(o.getRelativeCenterPoint(),void 0,s?s.calcTransformMatrix():void 0),size:A};{const d=o.getRelativeCenterPoint().transform(r.calcOwnMatrix(),!0);if(this.shouldPerformLayout(e)){const{center:c=new zt,correction:u=new zt}=this.calcBoundingBox(t,e)||{};return{center:c.add(d),correction:u.subtract(d),size:A}}return{center:r.getRelativeCenterPoint().add(d),size:A}}}}Xe(sy,"type","clip-path"),lr.setClass(sy);class iy extends bg{getInitialSize(e,t){let{target:r}=e,{size:o}=t;return new zt(r.width||o.x,r.height||o.y)}}Xe(iy,"type","fixed"),lr.setClass(iy);class sQ extends th{subscribeTargets(e){const t=e.target;e.targets.reduce((r,o)=>(o.parent&&r.add(o.parent),r),new Set).forEach(r=>{r.layoutManager.subscribeTargets({target:r,targets:[t]})})}unsubscribeTargets(e){const t=e.target,r=t.getObjects();e.targets.reduce((o,s)=>(s.parent&&o.add(s.parent),o),new Set).forEach(o=>{!r.some(s=>s.parent===o)&&o.layoutManager.unsubscribeTargets({target:o,targets:[t]})})}}class ql extends Xl{static getDefaults(){return Je(Je({},super.getDefaults()),ql.ownDefaults)}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),Object.assign(this,ql.ownDefaults),this.setOptions(t);const{left:r,top:o,layoutManager:s}=t;this.groupInit(e,{left:r,top:o,layoutManager:s??new sQ})}_shouldSetNestedCoords(){return!0}__objectSelectionMonitor(){}multiSelectAdd(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];this.multiSelectionStacking==="selection-order"?this.add(...t):t.forEach(o=>{const s=this._objects.findIndex(a=>a.isInFrontOf(o)),i=s===-1?this.size():s;this.insertAt(i,o)})}canEnterGroup(e){return this.getObjects().some(t=>t.isDescendantOf(e)||e.isDescendantOf(t))?(fl("error","ActiveSelection: circular object trees are not supported, this call has no effect"),!1):super.canEnterGroup(e)}enterGroup(e,t){e.parent&&e.parent===e.group?e.parent._exitGroup(e):e.group&&e.parent!==e.group&&e.group.remove(e),this._enterGroup(e,t)}exitGroup(e,t){this._exitGroup(e,t),e.parent&&e.parent._enterGroup(e,!0)}_onAfterObjectsChange(e,t){super._onAfterObjectsChange(e,t);const r=new Set;t.forEach(o=>{const{parent:s}=o;s&&r.add(s)}),e===j1?r.forEach(o=>{o._onAfterObjectsChange(Qp,t)}):r.forEach(o=>{o._set("dirty",!0)})}onDeselect(){return this.removeAll(),!1}toString(){return"#<ActiveSelection: (".concat(this.complexity(),")>")}shouldCache(){return!1}isOnACache(){return!1}_renderControls(e,t,r){e.save(),e.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1;const o=Je(Je({hasControls:!1},r),{},{forActiveSelection:!0});for(let s=0;s<this._objects.length;s++)this._objects[s]._renderControls(e,o);super._renderControls(e,t),e.restore()}}Xe(ql,"type","ActiveSelection"),Xe(ql,"ownDefaults",{multiSelectionStacking:"canvas-stacking"}),lr.setClass(ql),lr.setClass(ql,"activeSelection");class iQ{constructor(){Xe(this,"resources",{})}applyFilters(e,t,r,o,s){const i=s.getContext("2d");if(!i)return;i.drawImage(t,0,0,r,o);const a={sourceWidth:r,sourceHeight:o,imageData:i.getImageData(0,0,r,o),originalEl:t,originalImageData:i.getImageData(0,0,r,o),canvasEl:s,ctx:i,filterBackend:this};e.forEach(d=>{d.applyTo(a)});const{imageData:A}=a;return A.width===r&&A.height===o||(s.width=A.width,s.height=A.height),i.putImageData(A,0,0),a}}class Rx{constructor(){let{tileSize:e=mn.textureSize}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Xe(this,"aPosition",new Float32Array([0,0,0,1,1,0,1,1])),Xe(this,"resources",{}),this.tileSize=e,this.setupGLContext(e,e),this.captureGPUInfo()}setupGLContext(e,t){this.dispose(),this.createWebGLCanvas(e,t)}createWebGLCanvas(e,t){const r=ja({width:e,height:t}),o=r.getContext("webgl",{alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1});o&&(o.clearColor(0,0,0,0),this.canvas=r,this.gl=o)}applyFilters(e,t,r,o,s,i){const a=this.gl,A=s.getContext("2d");if(!a||!A)return;let d;i&&(d=this.getCachedTexture(i,t));const c={originalWidth:t.width||t.naturalWidth||0,originalHeight:t.height||t.naturalHeight||0,sourceWidth:r,sourceHeight:o,destinationWidth:r,destinationHeight:o,context:a,sourceTexture:this.createTexture(a,r,o,d?void 0:t),targetTexture:this.createTexture(a,r,o),originalTexture:d||this.createTexture(a,r,o,d?void 0:t),passes:e.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:s},u=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,u),e.forEach(h=>{h&&h.applyTo(c)}),function(h){const p=h.targetCanvas,v=p.width,w=p.height,y=h.destinationWidth,B=h.destinationHeight;v===y&&w===B||(p.width=y,p.height=B)}(c),this.copyGLTo2D(a,c),a.bindTexture(a.TEXTURE_2D,null),a.deleteTexture(c.sourceTexture),a.deleteTexture(c.targetTexture),a.deleteFramebuffer(u),A.setTransform(1,0,0,1,0,0),c}dispose(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()}clearWebGLCaches(){this.programCache={},this.textureCache={}}createTexture(e,t,r,o,s){const{NEAREST:i,TEXTURE_2D:a,RGBA:A,UNSIGNED_BYTE:d,CLAMP_TO_EDGE:c,TEXTURE_MAG_FILTER:u,TEXTURE_MIN_FILTER:h,TEXTURE_WRAP_S:p,TEXTURE_WRAP_T:v}=e,w=e.createTexture();return e.bindTexture(a,w),e.texParameteri(a,u,s||i),e.texParameteri(a,h,s||i),e.texParameteri(a,p,c),e.texParameteri(a,v,c),o?e.texImage2D(a,0,A,A,d,o):e.texImage2D(a,0,A,t,r,0,A,d,null),w}getCachedTexture(e,t,r){const{textureCache:o}=this;if(o[e])return o[e];{const s=this.createTexture(this.gl,t.width,t.height,t,r);return s&&(o[e]=s),s}}evictCachesForKey(e){this.textureCache[e]&&(this.gl.deleteTexture(this.textureCache[e]),delete this.textureCache[e])}copyGLTo2D(e,t){const r=e.canvas,o=t.targetCanvas,s=o.getContext("2d");if(!s)return;s.translate(0,o.height),s.scale(1,-1);const i=r.height-o.height;s.drawImage(r,0,i,o.width,o.height,0,0,o.width,o.height)}copyGLTo2DPutImageData(e,t){const r=t.targetCanvas.getContext("2d"),o=t.destinationWidth,s=t.destinationHeight,i=o*s*4;if(!r)return;const a=new Uint8Array(this.imageBuffer,0,i),A=new Uint8ClampedArray(this.imageBuffer,0,i);e.readPixels(0,0,o,s,e.RGBA,e.UNSIGNED_BYTE,a);const d=new ImageData(A,o,s);r.putImageData(d,0,0)}captureGPUInfo(){if(this.gpuInfo)return this.gpuInfo;const e=this.gl,t={renderer:"",vendor:""};if(!e)return t;const r=e.getExtension("WEBGL_debug_renderer_info");if(r){const o=e.getParameter(r.UNMASKED_RENDERER_WEBGL),s=e.getParameter(r.UNMASKED_VENDOR_WEBGL);o&&(t.renderer=o.toLowerCase()),s&&(t.vendor=s.toLowerCase())}return this.gpuInfo=t,t}}let Uv;function aQ(){const{WebGLProbe:n}=Ha();return n.queryWebGL(la()),mn.enableGLFiltering&&n.isSupported(mn.textureSize)?new Rx({tileSize:mn.textureSize}):new iQ}function Qv(){return!Uv&&(!(arguments.length>0&&arguments[0]!==void 0)||arguments[0])&&(Uv=aQ()),Uv}const AQ=["filters","resizeFilter","src","crossOrigin","type"],qx=["cropX","cropY"];class Ms extends os{static getDefaults(){return Je(Je({},super.getDefaults()),Ms.ownDefaults)}constructor(e,t){super(),Xe(this,"_lastScaleX",1),Xe(this,"_lastScaleY",1),Xe(this,"_filterScalingX",1),Xe(this,"_filterScalingY",1),this.filters=[],Object.assign(this,Ms.ownDefaults),this.setOptions(t),this.cacheKey="texture".concat(pl()),this.setElement(typeof e=="string"?(this.canvas&&oa(this.canvas.getElement())||Oc()).getElementById(e):e,t)}getElement(){return this._element}setElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._element=e,this._originalElement=e,this._setWidthHeight(t),e.classList.add(Ms.CSS_CANVAS),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters()}removeTexture(e){const t=Qv(!1);t instanceof Rx&&t.evictCachesForKey(e)}dispose(){super.dispose(),this.removeTexture(this.cacheKey),this.removeTexture("".concat(this.cacheKey,"_filtered")),this._cacheContext=null,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(e=>{const t=this[e];t&&Ha().dispose(t),this[e]=void 0})}getCrossOrigin(){return this._originalElement&&(this._originalElement.crossOrigin||null)}getOriginalSize(){const e=this.getElement();return e?{width:e.naturalWidth||e.width,height:e.naturalHeight||e.height}:{width:0,height:0}}_stroke(e){if(!this.stroke||this.strokeWidth===0)return;const t=this.width/2,r=this.height/2;e.beginPath(),e.moveTo(-t,-r),e.lineTo(t,-r),e.lineTo(t,r),e.lineTo(-t,r),e.lineTo(-t,-r),e.closePath()}toObject(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];const t=[];return this.filters.forEach(r=>{r&&t.push(r.toObject())}),Je(Je({},super.toObject([...qx,...e])),{},{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:t},this.resizeFilter?{resizeFilter:this.resizeFilter.toObject()}:{})}hasCrop(){return!!this.cropX||!!this.cropY||this.width<this._element.width||this.height<this._element.height}_toSVG(){const e=[],t=this._element,r=-this.width/2,o=-this.height/2;let s=[],i=[],a="",A="";if(!t)return[];if(this.hasCrop()){const d=pl();s.push('<clipPath id="imageCrop_'+d+`">
`,'	<rect x="'+r+'" y="'+o+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),a=' clip-path="url(#imageCrop_'+d+')" '}if(this.imageSmoothing||(A=' image-rendering="optimizeSpeed"'),e.push("	<image ","COMMON_PARTS",'xlink:href="'.concat(this.getSvgSrc(!0),'" x="').concat(r-this.cropX,'" y="').concat(o-this.cropY,'" width="').concat(t.width||t.naturalWidth,'" height="').concat(t.height||t.naturalHeight,'"').concat(A).concat(a,`></image>
`)),this.stroke||this.strokeDashArray){const d=this.fill;this.fill=null,i=['	<rect x="'.concat(r,'" y="').concat(o,'" width="').concat(this.width,'" height="').concat(this.height,'" style="').concat(this.getSvgStyles(),`" />
`)],this.fill=d}return s=this.paintFirst!==Ko?s.concat(i,e):s.concat(e,i),s}getSrc(e){const t=e?this._element:this._originalElement;return t?t.toDataURL?t.toDataURL():this.srcFromAttribute?t.getAttribute("src")||"":t.src:this.src||""}getSvgSrc(e){return this.getSrc(e)}setSrc(e){let{crossOrigin:t,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return rp(e,{crossOrigin:t,signal:r}).then(o=>{t!==void 0&&this.set({crossOrigin:t}),this.setElement(o)})}toString(){return'#<Image: { src: "'.concat(this.getSrc(),'" }>')}applyResizeFilters(){const e=this.resizeFilter,t=this.minimumScaleTrigger,r=this.getTotalObjectScaling(),o=r.x,s=r.y,i=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!e||o>t&&s>t)return this._element=i,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=o,void(this._lastScaleY=s);const a=ja(i),{width:A,height:d}=i;this._element=a,this._lastScaleX=e.scaleX=o,this._lastScaleY=e.scaleY=s,Qv().applyFilters([e],i,A,d,this._element),this._filterScalingX=a.width/this._originalElement.width,this._filterScalingY=a.height/this._originalElement.height}applyFilters(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.filters||[];if(e=e.filter(s=>s&&!s.isNeutralState()),this.set("dirty",!0),this.removeTexture("".concat(this.cacheKey,"_filtered")),e.length===0)return this._element=this._originalElement,this._filteredEl=void 0,this._filterScalingX=1,void(this._filterScalingY=1);const t=this._originalElement,r=t.naturalWidth||t.width,o=t.naturalHeight||t.height;if(this._element===this._originalElement){const s=ja({width:r,height:o});this._element=s,this._filteredEl=s}else this._filteredEl&&(this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,r,o),this._lastScaleX=1,this._lastScaleY=1);Qv().applyFilters(e,this._originalElement,r,o,this._element),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height)}_render(e){e.imageSmoothingEnabled=this.imageSmoothing,this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(e),this._renderPaintInOrder(e)}drawCacheOnCanvas(e){e.imageSmoothingEnabled=this.imageSmoothing,super.drawCacheOnCanvas(e)}shouldCache(){return this.needsItsOwnCache()}_renderFill(e){const t=this._element;if(!t)return;const r=this._filterScalingX,o=this._filterScalingY,s=this.width,i=this.height,a=Math.max(this.cropX,0),A=Math.max(this.cropY,0),d=t.naturalWidth||t.width,c=t.naturalHeight||t.height,u=a*r,h=A*o,p=Math.min(s*r,d-u),v=Math.min(i*o,c-h),w=-s/2,y=-i/2,B=Math.min(s,d/r-a),C=Math.min(i,c/o-A);t&&e.drawImage(t,u,h,p,v,w,y,B,C)}_needsResize(){const e=this.getTotalObjectScaling();return e.x!==this._lastScaleX||e.y!==this._lastScaleY}_resetWidthHeight(){this.set(this.getOriginalSize())}_setWidthHeight(){let{width:e,height:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=this.getOriginalSize();this.width=e||r.width,this.height=t||r.height}parsePreserveAspectRatioAttribute(){const e=qF(this.preserveAspectRatio||""),t=this.width,r=this.height,o={width:t,height:r};let s,i=this._element.width,a=this._element.height,A=1,d=1,c=0,u=0,h=0,p=0;return!e||e.alignX===Zs&&e.alignY===Zs?(A=t/i,d=r/a):(e.meetOrSlice==="meet"&&(A=d=hU(this._element,o),s=(t-i*A)/2,e.alignX==="Min"&&(c=-s),e.alignX==="Max"&&(c=s),s=(r-a*d)/2,e.alignY==="Min"&&(u=-s),e.alignY==="Max"&&(u=s)),e.meetOrSlice==="slice"&&(A=d=fU(this._element,o),s=i-t/A,e.alignX==="Mid"&&(h=s/2),e.alignX==="Max"&&(h=s),s=a-r/d,e.alignY==="Mid"&&(p=s/2),e.alignY==="Max"&&(p=s),i=t/A,a=r/d)),{width:i,height:a,scaleX:A,scaleY:d,offsetLeft:c,offsetTop:u,cropX:h,cropY:p}}static fromObject(e,t){let{filters:r,resizeFilter:o,src:s,crossOrigin:i,type:a}=e,A=so(e,AQ);return Promise.all([rp(s,Je(Je({},t),{},{crossOrigin:i})),r&&Ju(r,t),o&&Ju([o],t),mg(A,t)]).then(d=>{let[c,u=[],[h]=[],p={}]=d;return new this(c,Je(Je({},A),{},{src:s,filters:u,resizeFilter:h},p))})}static fromURL(e){let{crossOrigin:t=null,signal:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;return rp(e,{crossOrigin:t,signal:r}).then(s=>new this(s,o))}static async fromElement(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const o=FA(e,this.ATTRIBUTE_NAMES,r);return this.fromURL(o["xlink:href"],t,o).catch(s=>(fl("log","Unable to parse Image",s),null))}}Xe(Ms,"type","Image"),Xe(Ms,"cacheProperties",[...EA,...qx]),Xe(Ms,"ownDefaults",{strokeWidth:0,srcFromAttribute:!1,minimumScaleTrigger:.5,cropX:0,cropY:0,imageSmoothing:!0}),Xe(Ms,"CSS_CANVAS","canvas-img"),Xe(Ms,"ATTRIBUTE_NAMES",[...yl,"x","y","width","height","preserveAspectRatio","xlink:href","crossOrigin","image-rendering"]),lr.setClass(Ms),lr.setSVGClass(Ms);yg(["pattern","defs","symbol","metadata","clipPath","mask","desc"]);const Bg=n=>n.webgl!==void 0,R1="precision highp float",lQ=`
    `.concat(R1,`;
    varying vec2 vTexCoord;
    uniform sampler2D uTexture;
    void main() {
      gl_FragColor = texture2D(uTexture, vTexCoord);
    }`),dQ=["type"],cQ=["type"],uQ=new RegExp(R1,"g");class $o{get type(){return this.constructor.type}constructor(){let e=so(arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},dQ);Object.assign(this,this.constructor.defaults,e)}getFragmentSource(){return lQ}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    void main() {
      vTexCoord = aPosition;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }`}createProgram(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getFragmentSource(),r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getVertexSource();const{WebGLProbe:{GLPrecision:o="highp"}}=Ha();o!=="highp"&&(t=t.replace(uQ,R1.replace("highp",o)));const s=e.createShader(e.VERTEX_SHADER),i=e.createShader(e.FRAGMENT_SHADER),a=e.createProgram();if(!s||!i||!a)throw new Qa("Vertex, fragment shader or program creation error");if(e.shaderSource(s,r),e.compileShader(s),!e.getShaderParameter(s,e.COMPILE_STATUS))throw new Qa("Vertex shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(s)));if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Qa("Fragment shader compile error for ".concat(this.type,": ").concat(e.getShaderInfoLog(i)));if(e.attachShader(a,s),e.attachShader(a,i),e.linkProgram(a),!e.getProgramParameter(a,e.LINK_STATUS))throw new Qa('Shader link error for "'.concat(this.type,'" ').concat(e.getProgramInfoLog(a)));const A=this.getUniformLocations(e,a)||{};return A.uStepW=e.getUniformLocation(a,"uStepW"),A.uStepH=e.getUniformLocation(a,"uStepH"),{program:a,attributeLocations:this.getAttributeLocations(e,a),uniformLocations:A}}getAttributeLocations(e,t){return{aPosition:e.getAttribLocation(t,"aPosition")}}getUniformLocations(e,t){const r=this.constructor.uniformLocations,o={};for(let s=0;s<r.length;s++)o[r[s]]=e.getUniformLocation(t,r[s]);return o}sendAttributeData(e,t,r){const o=t.aPosition,s=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,s),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,r,e.STATIC_DRAW)}_setupFrameBuffer(e){const t=e.context;if(e.passes>1){const r=e.destinationWidth,o=e.destinationHeight;e.sourceWidth===r&&e.sourceHeight===o||(t.deleteTexture(e.targetTexture),e.targetTexture=e.filterBackend.createTexture(t,r,o)),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e.targetTexture,0)}else t.bindFramebuffer(t.FRAMEBUFFER,null),t.finish()}_swapTextures(e){e.passes--,e.pass++;const t=e.targetTexture;e.targetTexture=e.sourceTexture,e.sourceTexture=t}isNeutralState(e){return!1}applyTo(e){Bg(e)?(this._setupFrameBuffer(e),this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){}getCacheKey(){return this.type}retrieveShader(e){const t=this.getCacheKey();return e.programCache[t]||(e.programCache[t]=this.createProgram(e.context)),e.programCache[t]}applyToWebGL(e){const t=e.context,r=this.retrieveShader(e);e.pass===0&&e.originalTexture?t.bindTexture(t.TEXTURE_2D,e.originalTexture):t.bindTexture(t.TEXTURE_2D,e.sourceTexture),t.useProgram(r.program),this.sendAttributeData(t,r.attributeLocations,e.aPosition),t.uniform1f(r.uniformLocations.uStepW,1/e.sourceWidth),t.uniform1f(r.uniformLocations.uStepH,1/e.sourceHeight),this.sendUniformData(t,r.uniformLocations),t.viewport(0,0,e.destinationWidth,e.destinationHeight),t.drawArrays(t.TRIANGLE_STRIP,0,4)}bindAdditionalTexture(e,t,r){e.activeTexture(r),e.bindTexture(e.TEXTURE_2D,t),e.activeTexture(e.TEXTURE0)}unbindAdditionalTexture(e,t){e.activeTexture(t),e.bindTexture(e.TEXTURE_2D,null),e.activeTexture(e.TEXTURE0)}sendUniformData(e,t){}createHelpLayer(e){if(!e.helpLayer){const{sourceWidth:t,sourceHeight:r}=e,o=ja({width:t,height:r});e.helpLayer=o}}toObject(){const e=Object.keys(this.constructor.defaults||{});return Je({type:this.type},e.reduce((t,r)=>(t[r]=this[r],t),{}))}toJSON(){return this.toObject()}static async fromObject(e,t){return new this(so(e,cQ))}}Xe($o,"type","BaseFilter"),Xe($o,"uniformLocations",[]);const hQ={multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,difference:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`
    if (uColor.r < 0.5) {
      gl_FragColor.r *= 2.0 * uColor.r;
    } else {
      gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
    }
    if (uColor.g < 0.5) {
      gl_FragColor.g *= 2.0 * uColor.g;
    } else {
      gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
    }
    if (uColor.b < 0.5) {
      gl_FragColor.b *= 2.0 * uColor.b;
    } else {
      gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
    }
    `,tint:`
    gl_FragColor.rgb *= (1.0 - uColor.a);
    gl_FragColor.rgb += uColor.rgb;
    `};class sf extends $o{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec4 uColor;
      varying vec2 vTexCoord;
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        gl_FragColor = color;
        if (color.a > 0.0) {
          `.concat(hQ[this.mode],`
        }
      }
      `)}applyTo2d(e){let{imageData:{data:t}}=e;const r=new xi(this.color).getSource(),o=this.alpha,s=r[0]*o,i=r[1]*o,a=r[2]*o,A=1-o;for(let d=0;d<t.length;d+=4){const c=t[d],u=t[d+1],h=t[d+2];let p,v,w;switch(this.mode){case"multiply":p=c*s/255,v=u*i/255,w=h*a/255;break;case"screen":p=255-(255-c)*(255-s)/255,v=255-(255-u)*(255-i)/255,w=255-(255-h)*(255-a)/255;break;case"add":p=c+s,v=u+i,w=h+a;break;case"difference":p=Math.abs(c-s),v=Math.abs(u-i),w=Math.abs(h-a);break;case"subtract":p=c-s,v=u-i,w=h-a;break;case"darken":p=Math.min(c,s),v=Math.min(u,i),w=Math.min(h,a);break;case"lighten":p=Math.max(c,s),v=Math.max(u,i),w=Math.max(h,a);break;case"overlay":p=s<128?2*c*s/255:255-2*(255-c)*(255-s)/255,v=i<128?2*u*i/255:255-2*(255-u)*(255-i)/255,w=a<128?2*h*a/255:255-2*(255-h)*(255-a)/255;break;case"exclusion":p=s+c-2*s*c/255,v=i+u-2*i*u/255,w=a+h-2*a*h/255;break;case"tint":p=s+c*A,v=i+u*A,w=a+h*A}t[d]=p,t[d+1]=v,t[d+2]=w}}sendUniformData(e,t){const r=new xi(this.color).getSource();r[0]=this.alpha*r[0]/255,r[1]=this.alpha*r[1]/255,r[2]=this.alpha*r[2]/255,r[3]=this.alpha,e.uniform4fv(t.uColor,r)}}Xe(sf,"defaults",{color:"#F95C63",mode:"multiply",alpha:1}),Xe(sf,"type","BlendColor"),Xe(sf,"uniformLocations",["uColor"]),lr.setClass(sf);const fQ={multiply:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.rgba *= color2.rgba;
      gl_FragColor = color;
    }
    `,mask:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform sampler2D uImage;
    uniform vec4 uColor;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      vec4 color2 = texture2D(uImage, vTexCoord2);
      color.a = color2.a;
      gl_FragColor = color;
    }
    `},pQ=["type","image"];class af extends $o{getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return fQ[this.mode]}getVertexSource(){return`
    attribute vec2 aPosition;
    varying vec2 vTexCoord;
    varying vec2 vTexCoord2;
    uniform mat3 uTransformMatrix;
    void main() {
      vTexCoord = aPosition;
      vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
      gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
    }
    `}applyToWebGL(e){const t=e.context,r=this.createTexture(e.filterBackend,this.image);this.bindAdditionalTexture(t,r,t.TEXTURE1),super.applyToWebGL(e),this.unbindAdditionalTexture(t,t.TEXTURE1)}createTexture(e,t){return e.getCachedTexture(t.cacheKey,t.getElement())}calculateMatrix(){const e=this.image,{width:t,height:r}=e.getElement();return[1/e.scaleX,0,0,0,1/e.scaleY,0,-e.left/t,-e.top/r,1]}applyTo2d(e){let{imageData:{data:t,width:r,height:o},filterBackend:{resources:s}}=e;const i=this.image;s.blendImage||(s.blendImage=la());const a=s.blendImage,A=a.getContext("2d");a.width!==r||a.height!==o?(a.width=r,a.height=o):A.clearRect(0,0,r,o),A.setTransform(i.scaleX,0,0,i.scaleY,i.left,i.top),A.drawImage(i.getElement(),0,0,r,o);const d=A.getImageData(0,0,r,o).data;for(let c=0;c<t.length;c+=4){const u=t[c],h=t[c+1],p=t[c+2],v=t[c+3],w=d[c],y=d[c+1],B=d[c+2],C=d[c+3];switch(this.mode){case"multiply":t[c]=u*w/255,t[c+1]=h*y/255,t[c+2]=p*B/255,t[c+3]=v*C/255;break;case"mask":t[c+3]=C}}}sendUniformData(e,t){const r=this.calculateMatrix();e.uniform1i(t.uImage,1),e.uniformMatrix3fv(t.uTransformMatrix,!1,r)}toObject(){return Je(Je({},super.toObject()),{},{image:this.image&&this.image.toObject()})}static async fromObject(e,t){let{type:r,image:o}=e,s=so(e,pQ);return Ms.fromObject(o,t).then(i=>new this(Je(Je({},s),{},{image:i})))}}Xe(af,"type","BlendImage"),Xe(af,"defaults",{mode:"multiply",alpha:1}),Xe(af,"uniformLocations",["uTransformMatrix","uImage"]),lr.setClass(af);class Af extends $o{getFragmentSource(){return`
    precision highp float;
    uniform sampler2D uTexture;
    uniform vec2 uDelta;
    varying vec2 vTexCoord;
    const float nSamples = 15.0;
    vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
    float random(vec3 scale) {
      /* use the fragment position for a different seed per-pixel */
      return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
    }
    void main() {
      vec4 color = vec4(0.0);
      float total = 0.0;
      float offset = random(v3offset);
      for (float t = -nSamples; t <= nSamples; t++) {
        float percent = (t + offset - 0.5) / nSamples;
        float weight = 1.0 - abs(percent);
        color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
        total += weight;
      }
      gl_FragColor = color / total;
    }
  `}applyTo(e){Bg(e)?(this.aspectRatio=e.sourceWidth/e.sourceHeight,e.passes++,this._setupFrameBuffer(e),this.horizontal=!0,this.applyToWebGL(e),this._swapTextures(e),this._setupFrameBuffer(e),this.horizontal=!1,this.applyToWebGL(e),this._swapTextures(e)):this.applyTo2d(e)}applyTo2d(e){e.imageData=this.simpleBlur(e)}simpleBlur(e){let{ctx:t,imageData:r,filterBackend:{resources:o}}=e;const{width:s,height:i}=r;o.blurLayer1||(o.blurLayer1=la(),o.blurLayer2=la());const a=o.blurLayer1,A=o.blurLayer2;a.width===s&&a.height===i||(A.width=a.width=s,A.height=a.height=i);const d=a.getContext("2d"),c=A.getContext("2d"),u=15,h=.06*this.blur*.5;let p,v,w,y;for(d.putImageData(r,0,0),c.clearRect(0,0,s,i),y=-15;y<=u;y++)p=(Math.random()-.5)/4,v=y/u,w=h*v*s+p,c.globalAlpha=1-Math.abs(v),c.drawImage(a,w,p),d.drawImage(A,0,0),c.globalAlpha=1,c.clearRect(0,0,A.width,A.height);for(y=-15;y<=u;y++)p=(Math.random()-.5)/4,v=y/u,w=h*v*i+p,c.globalAlpha=1-Math.abs(v),c.drawImage(a,p,w),d.drawImage(A,0,0),c.globalAlpha=1,c.clearRect(0,0,A.width,A.height);t.drawImage(a,0,0);const B=t.getImageData(0,0,a.width,a.height);return d.globalAlpha=1,d.clearRect(0,0,a.width,a.height),B}sendUniformData(e,t){const r=this.chooseRightDelta();e.uniform2fv(t.uDelta,r)}isNeutralState(){return this.blur===0}chooseRightDelta(){let e=1;const t=[0,0];this.horizontal?this.aspectRatio>1&&(e=1/this.aspectRatio):this.aspectRatio<1&&(e=this.aspectRatio);const r=e*this.blur*.12;return this.horizontal?t[0]=r:t[1]=r,t}}Xe(Af,"type","Blur"),Xe(Af,"defaults",{blur:0}),Xe(Af,"uniformLocations",["uDelta"]),lr.setClass(Af);class lf extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBrightness;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += uBrightness;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.round(255*this.brightness);for(let o=0;o<t.length;o+=4)t[o]+=r,t[o+1]+=r,t[o+2]+=r}isNeutralState(){return this.brightness===0}sendUniformData(e,t){e.uniform1f(t.uBrightness,this.brightness)}}Xe(lf,"type","Brightness"),Xe(lf,"defaults",{brightness:0}),Xe(lf,"uniformLocations",["uBrightness"]),lr.setClass(lf);const Kx={matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],colorsOnly:!0};class nc extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  varying vec2 vTexCoord;
  uniform mat4 uColorMatrix;
  uniform vec4 uConstants;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color *= uColorMatrix;
    color += uConstants;
    gl_FragColor = color;
  }`}applyTo2d(e){const t=e.imageData.data,r=this.matrix,o=this.colorsOnly;for(let s=0;s<t.length;s+=4){const i=t[s],a=t[s+1],A=t[s+2];if(t[s]=i*r[0]+a*r[1]+A*r[2]+255*r[4],t[s+1]=i*r[5]+a*r[6]+A*r[7]+255*r[9],t[s+2]=i*r[10]+a*r[11]+A*r[12]+255*r[14],!o){const d=t[s+3];t[s]+=d*r[3],t[s+1]+=d*r[8],t[s+2]+=d*r[13],t[s+3]=i*r[15]+a*r[16]+A*r[17]+d*r[18]+255*r[19]}}}sendUniformData(e,t){const r=this.matrix,o=[r[0],r[1],r[2],r[3],r[5],r[6],r[7],r[8],r[10],r[11],r[12],r[13],r[15],r[16],r[17],r[18]],s=[r[4],r[9],r[14],r[19]];e.uniformMatrix4fv(t.uColorMatrix,!1,o),e.uniform4fv(t.uConstants,s)}toObject(){return Je(Je({},super.toObject()),{},{matrix:[...this.matrix]})}}function hd(n,e){var t;const r=(Xe(t=class extends nc{toObject(){return{type:this.type,colorsOnly:this.colorsOnly}}},"type",n),Xe(t,"defaults",{colorsOnly:!1,matrix:e}),t);return lr.setClass(r,n),r}Xe(nc,"type","ColorMatrix"),Xe(nc,"defaults",Kx),Xe(nc,"uniformLocations",["uColorMatrix","uConstants"]),lr.setClass(nc);hd("Brownie",[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0]);hd("Vintage",[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0]);hd("Kodachrome",[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0]);hd("Technicolor",[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0]);hd("Polaroid",[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0]);hd("Sepia",[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0]);hd("BlackWhite",[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]);class ay extends $o{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.subFilters=e.subFilters||[]}applyTo(e){Bg(e)&&(e.passes+=this.subFilters.length-1),this.subFilters.forEach(t=>{t.applyTo(e)})}toObject(){return{type:this.type,subFilters:this.subFilters.map(e=>e.toObject())}}isNeutralState(){return!this.subFilters.some(e=>!e.isNeutralState())}static fromObject(e,t){return Promise.all((e.subFilters||[]).map(r=>lr.getClass(r.type).fromObject(r,t))).then(r=>new this({subFilters:r}))}}Xe(ay,"type","Composed"),lr.setClass(ay);class df extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uContrast;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
    color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
    gl_FragColor = color;
  }`}isNeutralState(){return this.contrast===0}applyTo2d(e){let{imageData:{data:t}}=e;const r=Math.floor(255*this.contrast),o=259*(r+255)/(255*(259-r));for(let s=0;s<t.length;s+=4)t[s]=o*(t[s]-128)+128,t[s+1]=o*(t[s+1]-128)+128,t[s+2]=o*(t[s+2]-128)+128}sendUniformData(e,t){e.uniform1f(t.uContrast,this.contrast)}}Xe(df,"type","Contrast"),Xe(df,"defaults",{contrast:0}),Xe(df,"uniformLocations",["uContrast"]),lr.setClass(df);const gQ={Convolute_3_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_3_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[9];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 3.0; h+=1.0) {
        for (float w = 0.0; w < 3.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_5_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_5_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[25];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 5.0; h+=1.0) {
        for (float w = 0.0; w < 5.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_7_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_7_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[49];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 7.0; h+=1.0) {
        for (float w = 0.0; w < 7.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `,Convolute_9_1:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 0);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
        }
      }
      gl_FragColor = color;
    }
    `,Convolute_9_0:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform float uMatrix[81];
    uniform float uStepW;
    uniform float uStepH;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = vec4(0, 0, 0, 1);
      for (float h = 0.0; h < 9.0; h+=1.0) {
        for (float w = 0.0; w < 9.0; w+=1.0) {
          vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
          color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
        }
      }
      float alpha = texture2D(uTexture, vTexCoord).a;
      gl_FragColor = color;
      gl_FragColor.a = alpha;
    }
    `};class cf extends $o{getCacheKey(){return"".concat(this.type,"_").concat(Math.sqrt(this.matrix.length),"_").concat(this.opaque?1:0)}getFragmentSource(){return gQ[this.getCacheKey()]}applyTo2d(e){const t=e.imageData,r=t.data,o=this.matrix,s=Math.round(Math.sqrt(o.length)),i=Math.floor(s/2),a=t.width,A=t.height,d=e.ctx.createImageData(a,A),c=d.data,u=this.opaque?1:0;let h,p,v,w,y,B,C,Q,k,H,Z,q,N;for(Z=0;Z<A;Z++)for(H=0;H<a;H++){for(y=4*(Z*a+H),h=0,p=0,v=0,w=0,N=0;N<s;N++)for(q=0;q<s;q++)C=Z+N-i,B=H+q-i,C<0||C>=A||B<0||B>=a||(Q=4*(C*a+B),k=o[N*s+q],h+=r[Q]*k,p+=r[Q+1]*k,v+=r[Q+2]*k,u||(w+=r[Q+3]*k));c[y]=h,c[y+1]=p,c[y+2]=v,c[y+3]=u?r[y+3]:w}e.imageData=d}sendUniformData(e,t){e.uniform1fv(t.uMatrix,this.matrix)}toObject(){return Je(Je({},super.toObject()),{},{opaque:this.opaque,matrix:[...this.matrix]})}}Xe(cf,"type","Convolute"),Xe(cf,"defaults",{opaque:!1,matrix:[0,0,0,0,1,0,0,0,0]}),Xe(cf,"uniformLocations",["uMatrix","uOpaque","uHalfSize","uSize"]),lr.setClass(cf);const $x="Gamma";class uf extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform vec3 uGamma;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    vec3 correction = (1.0 / uGamma);
    color.r = pow(color.r, correction.r);
    color.g = pow(color.g, correction.g);
    color.b = pow(color.b, correction.b);
    gl_FragColor = color;
    gl_FragColor.rgb *= color.a;
  }
`}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(e),this.gamma=e.gamma||this.constructor.defaults.gamma.concat()}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.gamma,o=1/r[0],s=1/r[1],i=1/r[2];this.rgbValues||(this.rgbValues={r:new Uint8Array(256),g:new Uint8Array(256),b:new Uint8Array(256)});const a=this.rgbValues;for(let A=0;A<256;A++)a.r[A]=255*Math.pow(A/255,o),a.g[A]=255*Math.pow(A/255,s),a.b[A]=255*Math.pow(A/255,i);for(let A=0;A<t.length;A+=4)t[A]=a.r[t[A]],t[A+1]=a.g[t[A+1]],t[A+2]=a.b[t[A+2]]}sendUniformData(e,t){e.uniform3fv(t.uGamma,this.gamma)}isNeutralState(){const{gamma:e}=this;return e[0]===1&&e[1]===1&&e[2]===1}toObject(){return{type:$x,gamma:this.gamma.concat()}}}Xe(uf,"type",$x),Xe(uf,"defaults",{gamma:[1,1,1]}),Xe(uf,"uniformLocations",["uGamma"]),lr.setClass(uf);const vQ={average:`
    precision highp float;
    uniform sampler2D uTexture;
    varying vec2 vTexCoord;
    void main() {
      vec4 color = texture2D(uTexture, vTexCoord);
      float average = (color.r + color.b + color.g) / 3.0;
      gl_FragColor = vec4(average, average, average, color.a);
    }
    `,lightness:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `,luminosity:`
    precision highp float;
    uniform sampler2D uTexture;
    uniform int uMode;
    varying vec2 vTexCoord;
    void main() {
      vec4 col = texture2D(uTexture, vTexCoord);
      float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
      gl_FragColor = vec4(average, average, average, col.a);
    }
    `};class hf extends $o{applyTo2d(e){let{imageData:{data:t}}=e;for(let r,o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2];switch(this.mode){case"average":r=(s+i+a)/3;break;case"lightness":r=(Math.min(s,i,a)+Math.max(s,i,a))/2;break;case"luminosity":r=.21*s+.72*i+.07*a}t[o+2]=t[o+1]=t[o]=r}}getCacheKey(){return"".concat(this.type,"_").concat(this.mode)}getFragmentSource(){return vQ[this.mode]}sendUniformData(e,t){e.uniform1i(t.uMode,1)}isNeutralState(){return!1}}Xe(hf,"type","Grayscale"),Xe(hf,"defaults",{mode:"average"}),Xe(hf,"uniformLocations",["uMode"]),lr.setClass(hf);const mQ=Je(Je({},Kx),{},{rotation:0});class Tv extends nc{calculateMatrix(){const e=this.rotation*Math.PI,t=BA(e),r=zA(e),o=1/3,s=Math.sqrt(o)*r,i=1-t;this.matrix=[t+i/3,o*i-s,o*i+s,0,0,o*i+s,t+o*i,o*i-s,0,0,o*i-s,o*i+s,t+o*i,0,0,0,0,0,1,0]}isNeutralState(){return this.rotation===0}applyTo(e){this.calculateMatrix(),super.applyTo(e)}toObject(){return{type:this.type,rotation:this.rotation}}}Xe(Tv,"type","HueRotation"),Xe(Tv,"defaults",mQ),lr.setClass(Tv);class ff extends $o{applyTo2d(e){let{imageData:{data:t}}=e;for(let r=0;r<t.length;r+=4)t[r]=255-t[r],t[r+1]=255-t[r+1],t[r+2]=255-t[r+2],this.alpha&&(t[r+3]=255-t[r+3])}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform int uInvert;
  uniform int uAlpha;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    if (uInvert == 1) {
      if (uAlpha == 1) {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,1.0 -color.a);
      } else {
        gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
      }
    } else {
      gl_FragColor = color;
    }
  }
`}isNeutralState(){return!this.invert}sendUniformData(e,t){e.uniform1i(t.uInvert,Number(this.invert)),e.uniform1i(t.uAlpha,Number(this.alpha))}}Xe(ff,"type","Invert"),Xe(ff,"defaults",{alpha:!1,invert:!0}),Xe(ff,"uniformLocations",["uInvert","uAlpha"]),lr.setClass(ff);class pf extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uStepH;
  uniform float uNoise;
  uniform float uSeed;
  varying vec2 vTexCoord;
  float rand(vec2 co, float seed, float vScale) {
    return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
  }
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=this.noise;for(let o=0;o<t.length;o+=4){const s=(.5-Math.random())*r;t[o]+=s,t[o+1]+=s,t[o+2]+=s}}sendUniformData(e,t){e.uniform1f(t.uNoise,this.noise/255),e.uniform1f(t.uSeed,Math.random())}isNeutralState(){return this.noise===0}}Xe(pf,"type","Noise"),Xe(pf,"defaults",{noise:0}),Xe(pf,"uniformLocations",["uNoise","uSeed"]),lr.setClass(pf);class gf extends $o{applyTo2d(e){let{imageData:{data:t,width:r,height:o}}=e;for(let s=0;s<o;s+=this.blocksize)for(let i=0;i<r;i+=this.blocksize){const a=4*s*r+4*i,A=t[a],d=t[a+1],c=t[a+2],u=t[a+3];for(let h=s;h<Math.min(s+this.blocksize,o);h++)for(let p=i;p<Math.min(i+this.blocksize,r);p++){const v=4*h*r+4*p;t[v]=A,t[v+1]=d,t[v+2]=c,t[v+3]=u}}}isNeutralState(){return this.blocksize===1}getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uBlocksize;
  uniform float uStepW;
  uniform float uStepH;
  varying vec2 vTexCoord;
  void main() {
    float blockW = uBlocksize * uStepW;
    float blockH = uBlocksize * uStepH;
    int posX = int(vTexCoord.x / blockW);
    int posY = int(vTexCoord.y / blockH);
    float fposX = float(posX);
    float fposY = float(posY);
    vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
    vec4 color = texture2D(uTexture, squareCoords);
    gl_FragColor = color;
  }
`}sendUniformData(e,t){e.uniform1f(t.uBlocksize,this.blocksize)}}Xe(gf,"type","Pixelate"),Xe(gf,"defaults",{blocksize:4}),Xe(gf,"uniformLocations",["uBlocksize"]),lr.setClass(gf);class vf extends $o{getFragmentSource(){return`
precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
  gl_FragColor = texture2D(uTexture, vTexCoord);
  if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
    gl_FragColor.a = 0.0;
  }
}
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=255*this.distance,o=new xi(this.color).getSource(),s=[o[0]-r,o[1]-r,o[2]-r],i=[o[0]+r,o[1]+r,o[2]+r];for(let a=0;a<t.length;a+=4){const A=t[a],d=t[a+1],c=t[a+2];A>s[0]&&d>s[1]&&c>s[2]&&A<i[0]&&d<i[1]&&c<i[2]&&(t[a+3]=0)}}sendUniformData(e,t){const r=new xi(this.color).getSource(),o=this.distance,s=[0+r[0]/255-o,0+r[1]/255-o,0+r[2]/255-o,1],i=[r[0]/255+o,r[1]/255+o,r[2]/255+o,1];e.uniform4fv(t.uLow,s),e.uniform4fv(t.uHigh,i)}}Xe(vf,"type","RemoveColor"),Xe(vf,"defaults",{color:"#FFFFFF",distance:.02,useAlpha:!1}),Xe(vf,"uniformLocations",["uLow","uHigh"]),lr.setClass(vf);class mf extends $o{sendUniformData(e,t){e.uniform2fv(t.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),e.uniform1fv(t.uTaps,this.taps)}getFilterWindow(){const e=this.tempScale;return Math.ceil(this.lanczosLobes/e)}getCacheKey(){const e=this.getFilterWindow();return"".concat(this.type,"_").concat(e)}getFragmentSource(){const e=this.getFilterWindow();return this.generateShader(e)}getTaps(){const e=this.lanczosCreate(this.lanczosLobes),t=this.tempScale,r=this.getFilterWindow(),o=new Array(r);for(let s=1;s<=r;s++)o[s-1]=e(s*t);return o}generateShader(e){const t=new Array(e);for(let r=1;r<=e;r++)t[r-1]="".concat(r,".0 * uDelta");return`
      precision highp float;
      uniform sampler2D uTexture;
      uniform vec2 uDelta;
      varying vec2 vTexCoord;
      uniform float uTaps[`.concat(e,`];
      void main() {
        vec4 color = texture2D(uTexture, vTexCoord);
        float sum = 1.0;
        `).concat(t.map((r,o)=>`
              color += texture2D(uTexture, vTexCoord + `.concat(r,") * uTaps[").concat(o,"] + texture2D(uTexture, vTexCoord - ").concat(r,") * uTaps[").concat(o,`];
              sum += 2.0 * uTaps[`).concat(o,`];
            `)).join(`
`),`
        gl_FragColor = color / sum;
      }
    `)}applyToForWebgl(e){e.passes++,this.width=e.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=e.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),e.destinationWidth=this.dW,super.applyTo(e),e.sourceWidth=e.destinationWidth,this.height=e.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),e.destinationHeight=this.dH,super.applyTo(e),e.sourceHeight=e.destinationHeight}applyTo(e){Bg(e)?this.applyToForWebgl(e):this.applyTo2d(e)}isNeutralState(){return this.scaleX===1&&this.scaleY===1}lanczosCreate(e){return t=>{if(t>=e||t<=-e)return 0;if(t<11920929e-14&&t>-11920929e-14)return 1;const r=(t*=Math.PI)/e;return Math.sin(t)/t*Math.sin(r)/r}}applyTo2d(e){const t=e.imageData,r=this.scaleX,o=this.scaleY;this.rcpScaleX=1/r,this.rcpScaleY=1/o;const s=t.width,i=t.height,a=Math.round(s*r),A=Math.round(i*o);let d;d=this.resizeType==="sliceHack"?this.sliceByTwo(e,s,i,a,A):this.resizeType==="hermite"?this.hermiteFastResize(e,s,i,a,A):this.resizeType==="bilinear"?this.bilinearFiltering(e,s,i,a,A):this.resizeType==="lanczos"?this.lanczosResize(e,s,i,a,A):new ImageData(a,A),e.imageData=d}sliceByTwo(e,t,r,o,s){const i=e.imageData,a=.5;let A=!1,d=!1,c=t*a,u=r*a;const h=e.filterBackend.resources;let p=0,v=0;const w=t;let y=0;h.sliceByTwo||(h.sliceByTwo=la());const B=h.sliceByTwo;(B.width<1.5*t||B.height<r)&&(B.width=1.5*t,B.height=r);const C=B.getContext("2d");for(C.clearRect(0,0,1.5*t,r),C.putImageData(i,0,0),o=Math.floor(o),s=Math.floor(s);!A||!d;)t=c,r=u,o<Math.floor(c*a)?c=Math.floor(c*a):(c=o,A=!0),s<Math.floor(u*a)?u=Math.floor(u*a):(u=s,d=!0),C.drawImage(B,p,v,t,r,w,y,c,u),p=w,v=y,y+=u;return C.getImageData(p,v,o,s)}lanczosResize(e,t,r,o,s){const i=e.imageData.data,a=e.ctx.createImageData(o,s),A=a.data,d=this.lanczosCreate(this.lanczosLobes),c=this.rcpScaleX,u=this.rcpScaleY,h=2/this.rcpScaleX,p=2/this.rcpScaleY,v=Math.ceil(c*this.lanczosLobes/2),w=Math.ceil(u*this.lanczosLobes/2),y={},B={x:0,y:0},C={x:0,y:0};return function Q(k){let H,Z,q,N,re,be,L,R,J,se,fe;for(B.x=(k+.5)*c,C.x=Math.floor(B.x),H=0;H<s;H++){for(B.y=(H+.5)*u,C.y=Math.floor(B.y),re=0,be=0,L=0,R=0,J=0,Z=C.x-v;Z<=C.x+v;Z++)if(!(Z<0||Z>=t)){se=Math.floor(1e3*Math.abs(Z-B.x)),y[se]||(y[se]={});for(let ie=C.y-w;ie<=C.y+w;ie++)ie<0||ie>=r||(fe=Math.floor(1e3*Math.abs(ie-B.y)),y[se][fe]||(y[se][fe]=d(Math.sqrt(Math.pow(se*h,2)+Math.pow(fe*p,2))/1e3)),q=y[se][fe],q>0&&(N=4*(ie*t+Z),re+=q,be+=q*i[N],L+=q*i[N+1],R+=q*i[N+2],J+=q*i[N+3]))}N=4*(H*o+k),A[N]=be/re,A[N+1]=L/re,A[N+2]=R/re,A[N+3]=J/re}return++k<o?Q(k):a}(0)}bilinearFiltering(e,t,r,o,s){let i,a,A,d,c,u,h,p,v,w,y,B,C,Q=0;const k=this.rcpScaleX,H=this.rcpScaleY,Z=4*(t-1),q=e.imageData.data,N=e.ctx.createImageData(o,s),re=N.data;for(h=0;h<s;h++)for(p=0;p<o;p++)for(c=Math.floor(k*p),u=Math.floor(H*h),v=k*p-c,w=H*h-u,C=4*(u*t+c),y=0;y<4;y++)i=q[C+y],a=q[C+4+y],A=q[C+Z+y],d=q[C+Z+4+y],B=i*(1-v)*(1-w)+a*v*(1-w)+A*w*(1-v)+d*v*w,re[Q++]=B;return N}hermiteFastResize(e,t,r,o,s){const i=this.rcpScaleX,a=this.rcpScaleY,A=Math.ceil(i/2),d=Math.ceil(a/2),c=e.imageData.data,u=e.ctx.createImageData(o,s),h=u.data;for(let p=0;p<s;p++)for(let v=0;v<o;v++){const w=4*(v+p*o);let y=0,B=0,C=0,Q=0,k=0,H=0,Z=0;const q=(p+.5)*a;for(let N=Math.floor(p*a);N<(p+1)*a;N++){const re=Math.abs(q-(N+.5))/d,be=(v+.5)*i,L=re*re;for(let R=Math.floor(v*i);R<(v+1)*i;R++){let J=Math.abs(be-(R+.5))/A;const se=Math.sqrt(L+J*J);se>1&&se<-1||(y=2*se*se*se-3*se*se+1,y>0&&(J=4*(R+N*t),Z+=y*c[J+3],C+=y,c[J+3]<255&&(y=y*c[J+3]/250),Q+=y*c[J],k+=y*c[J+1],H+=y*c[J+2],B+=y))}}h[w]=Q/B,h[w+1]=k/B,h[w+2]=H/B,h[w+3]=Z/C}return u}}Xe(mf,"type","Resize"),Xe(mf,"defaults",{resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3}),Xe(mf,"uniformLocations",["uDelta","uTaps"]),lr.setClass(mf);class wf extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uSaturation;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float rgMax = max(color.r, color.g);
    float rgbMax = max(rgMax, color.b);
    color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
    color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
    color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.saturation;for(let o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2],A=Math.max(s,i,a);t[o]+=A!==s?(A-s)*r:0,t[o+1]+=A!==i?(A-i)*r:0,t[o+2]+=A!==a?(A-a)*r:0}}sendUniformData(e,t){e.uniform1f(t.uSaturation,-this.saturation)}isNeutralState(){return this.saturation===0}}Xe(wf,"type","Saturation"),Xe(wf,"defaults",{saturation:0}),Xe(wf,"uniformLocations",["uSaturation"]),lr.setClass(wf);class yf extends $o{getFragmentSource(){return`
  precision highp float;
  uniform sampler2D uTexture;
  uniform float uVibrance;
  varying vec2 vTexCoord;
  void main() {
    vec4 color = texture2D(uTexture, vTexCoord);
    float max = max(color.r, max(color.g, color.b));
    float avg = (color.r + color.g + color.b) / 3.0;
    float amt = (abs(max - avg) * 2.0) * uVibrance;
    color.r += max != color.r ? (max - color.r) * amt : 0.00;
    color.g += max != color.g ? (max - color.g) * amt : 0.00;
    color.b += max != color.b ? (max - color.b) * amt : 0.00;
    gl_FragColor = color;
  }
`}applyTo2d(e){let{imageData:{data:t}}=e;const r=-this.vibrance;for(let o=0;o<t.length;o+=4){const s=t[o],i=t[o+1],a=t[o+2],A=Math.max(s,i,a),d=(s+i+a)/3,c=2*Math.abs(A-d)/255*r;t[o]+=A!==s?(A-s)*c:0,t[o+1]+=A!==i?(A-i)*c:0,t[o+2]+=A!==a?(A-a)*c:0}}sendUniformData(e,t){e.uniform1f(t.uVibrance,-this.vibrance)}isNeutralState(){return this.vibrance===0}}Xe(yf,"type","Vibrance"),Xe(yf,"defaults",{vibrance:0}),Xe(yf,"uniformLocations",["uVibrance"]),lr.setClass(yf);os.prototype.toObject=function(n){return function(e=[]){return n.call(this,["data",...e])}}(os.prototype.toObject);class Vx{constructor(e,t){this.currentScale=1,this.SNAP_THRESHOLD=10,this.resizeTimeout=null,this.originalWidth=t.width,this.originalHeight=t.height,this.aspectRatio=this.originalHeight/this.originalWidth,this.containerElement=t.containerElement,this.containerElement.style.height=`${this.containerElement.offsetWidth*this.aspectRatio}px`,this.canvas=new J0(e,{width:this.originalWidth,height:this.originalHeight,controlsAboveOverlay:!0,preserveObjectStacking:!0,selection:!0}),this.setupResizeObserver(),this.setupSnapBehavior(),this.setupSelectionBehavior()}toOriginalCoordinate(e){return e/this.currentScale}toScaledCoordinate(e){return e*this.currentScale}setupResizeObserver(){this.resizeObserver=new ResizeObserver(this.handleResize.bind(this)),this.resizeObserver.observe(this.containerElement)}handleResize(){this.resizeTimeout&&clearTimeout(this.resizeTimeout),this.resizeTimeout=window.setTimeout(()=>{this.updateCanvasSize(),this.canvas.requestRenderAll()},100)}updateCanvasSize(){const e=this.containerElement.offsetWidth,t=this.canvas.backgroundImage?this.canvas.backgroundImage.height/this.canvas.backgroundImage.width:this.canvas.overlayImage?this.canvas.overlayImage.height/this.canvas.overlayImage.width:this.aspectRatio,r=e*t;this.containerElement.style.height=`${r}px`;const o=e/this.originalWidth;this.currentScale=o,this.canvas.setDimensions({width:e,height:r}),this.canvas.setViewportTransform([o,0,0,o,0,0]),this.canvas.requestRenderAll()}setupSnapBehavior(){this.canvas.on("object:moving",e=>{var A;const t=e.target;if(!t||((A=t.data)==null?void 0:A.editType)==="print")return;const o=this.canvas.getObjects().filter(d=>{var c;return((c=d.data)==null?void 0:c.editType)==="print"});let s=null,i=null;const a={left:t.left/this.currentScale,right:(t.left+t.width*t.scaleX)/this.currentScale,top:t.top,bottom:t.top+t.height*t.scaleY,centerX:t.left+t.width*t.scaleX/2,centerY:t.top+t.height*t.scaleY/2};for(const d of o){const c={left:d.left/this.currentScale,right:(d.left+d.width*d.scaleX)/this.currentScale,top:d.top,bottom:d.top+d.height*d.scaleY,centerX:d.left+d.width*d.scaleX/2,centerY:d.top+d.height*d.scaleY/2};Math.abs(a.left-c.left)<this.SNAP_THRESHOLD?s=c.left:Math.abs(a.right-c.right)<this.SNAP_THRESHOLD?s=c.right-t.width*t.scaleX:Math.abs(a.centerX-c.centerX)<this.SNAP_THRESHOLD&&(s=c.centerX-t.width*t.scaleX/2),Math.abs(a.top-c.top)<this.SNAP_THRESHOLD?i=c.top:Math.abs(a.bottom-c.bottom)<this.SNAP_THRESHOLD?i=c.bottom-t.height*t.scaleY:Math.abs(a.centerY-c.centerY)<this.SNAP_THRESHOLD&&(i=c.centerY-t.height*t.scaleY/2)}s!==null&&t.set("left",s),i!==null&&t.set("top",i)})}setupSelectionBehavior(){this.canvas.on("selection:created",e=>{var r,o;const t=(r=e.selected)==null?void 0:r[0];((o=t==null?void 0:t.data)==null?void 0:o.editType)==="print"&&this.canvas.discardActiveObject()}),this.canvas.on("mouse:down",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&t.data.objectId&&this.onPrintAreaClick&&this.onPrintAreaClick(t.data.objectId)}),this.canvas.on("mouse:over",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&(this.canvas.defaultCursor="pointer")}),this.canvas.on("mouse:out",e=>{var r;const t=e.target;((r=t==null?void 0:t.data)==null?void 0:r.editType)==="print"&&(this.canvas.defaultCursor="default")})}setPrintAreaClickListener(e){this.onPrintAreaClick=e}async setCanvasJSON(e){console.log("json",e),await this.canvas.loadFromJSON(e),this.canvas.requestRenderAll()}addEditableArea(e){if(e.type==="rect"){const t=new na({left:e.properties.x,top:e.properties.y,width:e.properties.width,height:e.properties.height,fill:"rgba(0,216,255,0.3)",stroke:"rgba(0,203,239,1)",strokeWidth:1,cornerStyle:"circle",transparentCorners:!1,cornerColor:"rgba(0,203,239,0.5)",cornerSize:10,lockRotation:!0,hasControls:!0,data:{editType:e.properties.editType,objectId:e.properties.objectId}});return this.canvas.add(t),this.canvas.requestRenderAll(),t}}removeObject(e){const r=this.canvas.getObjects().find(o=>{var s;return((s=o.data)==null?void 0:s.objectId)===e});r&&(this.canvas.remove(r),this.canvas.requestRenderAll())}setSelectionListener(e){this.canvas.on("selection:created",t=>{var r;return e(((r=t.selected)==null?void 0:r[0])??null)}),this.canvas.on("selection:updated",t=>{var r;return e(((r=t.selected)==null?void 0:r[0])??null)}),this.canvas.on("selection:cleared",()=>e(null))}zoomToPoint(e,t){const s=Math.min(Math.max(t,.1),3),i=new zt(e.x,e.y);this.canvas.zoomToPoint(i,s),this.canvas.requestRenderAll()}getCurrentScale(){return this.currentScale}destroy(){var e;(e=this.resizeObserver)==null||e.disconnect(),this.canvas.dispose()}getCanvas(){return this.canvas}getObjects(){return this.canvas.getObjects()}getCanvasJson(){return this.canvas.toJSON()}getCanvasImage(){return this.canvas.toDataURL({format:"png",quality:1,multiplier:1})}async setImage(e){return new Promise((t,r)=>{const o=new Image;o.onload=()=>{const s={width:o.width,height:o.height,dataUrl:e},i=800;let a=o.width,A=o.height;(a>i||A>i)&&(a>A?(A=i*A/a,a=i):(a=i*a/A,A=i));const d=document.createElement("canvas");d.width=a,d.height=A;const c=d.getContext("2d");c==null||c.drawImage(o,0,0,a,A);const u=d.toDataURL("image/jpeg",.9);Ms.fromURL(u,{crossOrigin:"anonymous"}).then(h=>{const p=this.canvas.getWidth(),v=this.canvas.getHeight(),w=A/a,y=v/p;w>y?h.scaleToHeight(v):h.scaleToWidth(p),this.canvas.getObjects().filter(C=>{var Q;return((Q=C.data)==null?void 0:Q.editType)==="print"}).forEach(async C=>{const Q=C;Q.absolutePositioned=!0,Q.fill="transparent";const k=C.width/h.width,H=C.height/h.height,Z=Math.max(k,H),q=h.width*Z,N=h.height*Z;h.left=C.left+(C.width-q)/2,h.top=C.top+(C.height-N)/2,h.scaleToWidth(q),h.scaleToHeight(N),h.clipPath=Q}),this.canvas.add(h),this.canvas.requestRenderAll(),t({thumbnail:{width:a,height:A,dataUrl:u},original:s})}).catch(r)},o.onerror=()=>{r(new Error("  "))},o.src=e})}async setOverlay(e){try{const t=await Ms.fromURL(e,{crossOrigin:"anonymous"});this.setBackgroundOverlaySize(t),this.canvas.overlayImage=t,this.canvas.renderAll()}catch(t){throw console.error("     :",t),t}}async setBackground(e){try{const t=await Ms.fromURL(e,{crossOrigin:"anonymous"});this.setBackgroundOverlaySize(t),this.canvas.backgroundImage=t,this.canvas.requestRenderAll()}catch(t){throw console.error("     :",t),t}}async setBackgroundOverlaySize(e){const t=this.containerElement.offsetWidth,r=t*(e.height/e.width);this.originalWidth=t,this.originalHeight=r,this.aspectRatio=r/t,this.containerElement.style.height=`${r}px`,e.scaleToWidth(t),e.scaleToHeight(r),e.set({top:0,left:0,originX:"left",originY:"top"})}updateObjectDisabled(e){const r=this.canvas.getObjects().find(o=>{var s;return((s=o.data)==null?void 0:s.objectId)===e});r&&(r.set("fill","#cccccc"),r.set("opacity",.5),r.set("stroke","#cccccc"),r.set("strokeWidth",0),r.set("evented",!1)),this.canvas.requestRenderAll()}updateAllObjectEnabled(){this.canvas.getObjects().forEach(t=>{t.set("fill","rgba(0,216,255,0.3)"),t.set("opacity",1),t.set("stroke","rgba(0,203,239,1)"),t.set("strokeWidth",1),t.set("evented",!0)}),this.canvas.requestRenderAll()}}async function wQ(n,e="estimates",t){try{console.log("   :",{name:n.name,size:n.size,type:n.type,folder:e});const r=bQ(n);if(!r.isValid)return console.error("   :",r.errors),{success:!1,error:r.errors.join(", ")};const o=Date.now(),s=Math.random().toString(36).substring(2,8),i=xQ(n.name),a=`${o}_${s}_${i}`,A=`${e}/${a}`;console.log("   :",{fileName:a,filePath:A});const{data:d,error:c}=await ft.storage.from("uploads").upload(A,n,{cacheControl:"3600",upsert:!1});if(c)return console.error(" Storage  :",c),{success:!1,error:`  : ${c.message}`};console.log(" Storage  :",d);const{data:u}=ft.storage.from("uploads").getPublicUrl(A);if(!u.publicUrl)return console.error("  URL  "),{success:!1,error:"  URL  ."};console.log("  URL  :",u.publicUrl);const h={id:s,name:n.name,size:n.size,type:n.type,url:u.publicUrl,path:A,uploadedAt:new Date().toISOString()};return console.log("   :",h),{success:!0,file:h}}catch(r){return console.error("      :",r),{success:!1,error:r instanceof Error?r.message:"    ."}}}async function yQ(n,e="estimates",t){console.log("    :",{count:n.length,folder:e});const r=[];for(let s=0;s<n.length;s++){const i=n[s];console.log(`  ${s+1}/${n.length}  :`,i.name);const a=await wQ(i,e);if(r.push(a),t){const A=s+1,d=n.length,c=Math.round(A/d*100);t(A,d,c)}a.success||console.warn(`    (${s+1}/${n.length}):`,{fileName:i.name,error:a.error})}const o=r.filter(s=>s.success).length;return console.log("    :",{total:n.length,success:o,failed:n.length-o}),r}async function _Q(n){try{console.log("   :",n);const{error:e}=await ft.storage.from("uploads").remove([n]);return e?(console.error("   :",e),!1):(console.log("   :",n),!0)}catch(e){return console.error("    :",e),!1}}async function Ay(n,e,t){try{console.log(" estimate_simple_prints   :",{estimateId:n,objectId:e,fileCount:t.length});const{data:r,error:o}=await ft.from("estimate_simple_prints").select("*").eq("estimate_id",n).eq("object_id",e).single();if(o&&o.code!=="PGRST116")return console.error("    :",o),{success:!1,error:`   : ${o.message}`};const s={files:t,updatedAt:new Date().toISOString(),totalFiles:t.length,totalSize:t.reduce((i,a)=>i+a.size,0)};if(r){const{error:i}=await ft.from("estimate_simple_prints").update({uploaded_files:s,updated_at:new Date().toISOString()}).eq("id",r.id);if(i)return console.error("   :",i),{success:!1,error:`  : ${i.message}`};console.log("    :",r.id)}else{const{error:i}=await ft.from("estimate_simple_prints").insert({estimate_id:n,object_id:e,title:` ${e}`,print_method:"file-upload",uploaded_files:s,price:0,original_price:0,discount_amount:0});if(i)return console.error("    :",i),{success:!1,error:`   : ${i.message}`};console.log("    ")}return{success:!0}}catch(r){return console.error(" estimate_simple_prints   :",r),{success:!1,error:r instanceof Error?r.message:"    ."}}}function bQ(n){const e=[];n.size>52428800&&e.push(`   .  50MB  . (: ${Math.round(n.size/1024/1024)}MB)`);const r=["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","application/pdf","application/postscript","application/illustrator","image/vnd.adobe.photoshop"],o=[".jpg",".jpeg",".png",".gif",".webp",".svg",".pdf",".eps",".ai",".psd"],s=n.name.toLowerCase(),i=o.some(A=>s.endsWith(A)),a=r.includes(n.type);return!i&&!a&&e.push("   . ( : JPG, PNG, GIF, PDF, AI, EPS, PSD, SVG)"),n.name.length>255&&e.push("  . 255  ."),{isValid:e.length===0,errors:e}}function xQ(n){return n.replace(/[^-a-zA-Z0-9._-]/g,"_").replace(/_{2,}/g,"_").replace(/^_+|_+$/g,"")}function BQ(n){if(n===0)return"0 Bytes";const e=1024,t=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(n)/Math.log(e));return parseFloat((n/Math.pow(e,r)).toFixed(2))+" "+t[r]}async function zQ(n,e){var t;try{console.log(" estimate_simple_prints   :",{estimateId:n,objectId:e});const{data:r,error:o}=await ft.from("estimate_simple_prints").select("uploaded_files, file_metadata").eq("estimate_id",n).eq("object_id",e).single();if(o)return o.code==="PGRST116"?{success:!0,files:[]}:(console.error("    :",o),{success:!1,files:[],error:`   : ${o.message}`});const s=r==null?void 0:r.uploaded_files;let i=(s==null?void 0:s.files)||[];return console.log(" DB  :",{hasUploadedFiles:!!s,uploadedFilesType:typeof s,uploadedFilesHasFiles:!!(s!=null&&s.files),uploadedFilesLength:((t=s==null?void 0:s.files)==null?void 0:t.length)||0,hasFileMetadata:!!(r!=null&&r.file_metadata),fileMetadataType:typeof(r==null?void 0:r.file_metadata),fileMetadataLength:Array.isArray(r==null?void 0:r.file_metadata)?r.file_metadata.length:0}),i.length===0&&(r!=null&&r.file_metadata)&&(console.log(" uploaded_files  - file_metadata  "),i=(Array.isArray(r.file_metadata)?r.file_metadata:[]).map(A=>({id:Math.random().toString(36).substring(2,8),name:A.name||"",size:A.size||0,type:A.type||"",url:A.url||"#",path:A.path||"",uploadedAt:new Date().toISOString()})),console.log(" file_metadata   :",{fileCount:i.length,files:i.map(A=>({name:A.name,hasUrl:A.url!=="#"}))})),console.log("    :",{fileCount:i.length,source:i.length>0&&(s!=null&&s.files)?"uploaded_files":"file_metadata"}),{success:!0,files:i}}catch(r){return console.error("     :",r),{success:!1,files:[],error:r instanceof Error?r.message:"    ."}}}var CQ=$('<div class="odz-absolute -odz-top-2 -odz-right-2 odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div>'),SQ=$('<button><!> <div class="odz-text-center"><span> </span></div></button>'),EQ=$('<div class="odz-mt-3 odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-lg odz-p-3"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-2"><svg class="odz-w-4 odz-h-4 odz-text-blue-500 odz-animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-blue-700"> </span></div> <div class="odz-w-full odz-bg-blue-200 odz-rounded-full odz-h-2"><div class="odz-bg-blue-600 odz-h-2 odz-rounded-full odz-transition-all odz-duration-300"></div></div></div>'),FQ=$('<div class="odz-mt-3 odz-flex odz-items-center odz-gap-2 odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-red-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-red-700"> </span></div>'),IQ=$('<a target="_blank" rel="noopener noreferrer" class="odz-p-1 odz-text-blue-600 hover:odz-text-blue-800 hover:odz-bg-blue-50 odz-rounded" title=" "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path></svg></a>'),UQ=$('<button class="odz-p-1 odz-text-gray-400 odz-cursor-not-allowed odz-rounded" disabled title="  .   ."><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"></path></svg></button>'),QQ=$('<div class="odz-flex odz-items-center odz-justify-between odz-bg-white odz-border odz-border-gray-200 odz-rounded-lg odz-p-3"><div class="odz-flex odz-items-center odz-gap-2 odz-min-w-0 odz-flex-1"><svg class="odz-w-4 odz-h-4 odz-text-gray-500 odz-flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <div class="odz-min-w-0 odz-flex-1"><p class="odz-text-sm odz-font-medium odz-text-gray-900 odz-truncate"> </p> <p class="odz-text-xs odz-text-gray-500"> </p></div></div> <div class="odz-flex odz-items-center odz-gap-2"><!> <button class="odz-p-1 odz-text-red-600 hover:odz-text-red-800 hover:odz-bg-red-50 odz-rounded" title=" "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg></button></div></div>'),TQ=$('<div class="odz-mt-3"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3 odz-bg-green-50 odz-border odz-border-green-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-green-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-green-700"> </span></div> <div class="odz-space-y-2"></div></div>'),LQ=$('<div class="odz-flex odz-items-center odz-gap-1 odz-text-xs odz-text-gray-600 odz-bg-gray-50 odz-px-2 odz-py-1 odz-rounded odz-min-w-0"><span class="odz-flex-shrink-0"></span> <span class="odz-truncate odz-min-w-0"> </span> <span class="odz-flex-shrink-0"> </span></div>'),PQ=$('<div class="odz-mt-3 odz-flex odz-items-center odz-gap-2 odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-lg odz-p-3"><svg class="odz-w-4 odz-h-4 odz-text-blue-500" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path></svg> <span class="odz-text-sm odz-font-medium odz-text-blue-700"> </span></div> <div class="odz-mt-2 odz-space-y-1"></div>',1),kQ=$(`<div class="odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-100 odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-justify-between odz-mb-6"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-w-8 odz-h-8 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><span class="odz-text-white odz-font-bold odz-text-sm"></span></div> <div><h3 class="odz-text-lg odz-font-bold odz-text-gray-800"> </h3> <p class="odz-text-sm odz-text-gray-600">  </p></div></div> <button class="odz-w-8 odz-h-8 odz-flex odz-items-center odz-justify-center odz-text-gray-400 hover:odz-text-red-500
                                   hover:odz-bg-red-50 odz-rounded-full odz-transition-all odz-duration-200" aria-label="  "><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="odz-mb-6"><div class="odz-block odz-text-sm odz-font-bold odz-text-gray-700 odz-mb-3"> </div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div></div> <div class="odz-mb-4"><label class="odz-block odz-text-sm odz-font-bold odz-text-gray-700 odz-mb-3">  </label> <div class="odz-relative"><input type="file" multiple accept="image/*,.pdf,.ai,.eps" class="odz-absolute odz-inset-0 odz-w-full odz-h-full odz-opacity-0 odz-cursor-pointer"> <div class="odz-bg-white odz-border-2 odz-border-dashed odz-border-gray-300 odz-rounded-xl odz-p-6
                                       hover:odz-border-red-300 hover:odz-bg-red-50 odz-transition-colors odz-duration-200"><div class="odz-text-center"><svg class="odz-w-8 odz-h-8 odz-text-gray-400 odz-mx-auto odz-mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <p class="odz-text-sm odz-text-gray-600 odz-mb-1">   </p> <p class="odz-text-xs odz-text-gray-500">, PDF, AI, EPS  </p></div></div></div> <!> <!> <!> <!></div></div>`),OQ=$('<div class="odz-mt-2 odz-flex odz-items-center odz-gap-2 odz-text-xs odz-text-gray-500"><svg class="odz-w-3 odz-h-3" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg> <span> </span></div>'),DQ=$(`<div><div class="odz-flex odz-items-center odz-gap-3 odz-mb-6"><div class="odz-w-10 odz-h-10 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-5 odz-h-5 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2c0-.552.448-1 1-1h8c.552 0 1 .448 1 1v2M7 4h10M7 4l-.5 14c-.051 1.096.846 2 1.5 2h8c.654 0 1.551-.904 1.5-2L17 4"></path></svg></div> <div><h2 class="odz-text-xl odz-font-bold odz-text-gray-800">  </h2> <p class="odz-text-sm odz-text-gray-600"> </p></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-4"></div> <div class="odz-mt-6"><div class="odz-bg-white odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-4"><div class="odz-w-8 odz-h-8 odz-bg-blue-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-4 odz-h-4 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg></div> <div><h3 class="odz-text-lg odz-font-bold odz-text-gray-800">  </h3> <p class="odz-text-sm odz-text-gray-600">    </p></div></div> <textarea class="odz-w-full odz-h-24 odz-p-4 odz-border-2 odz-border-gray-200 odz-rounded-xl
                           odz-resize-none odz-text-sm odz-text-gray-700
                           focus:odz-border-blue-400 focus:odz-ring-2 focus:odz-ring-blue-100 focus:odz-outline-none
                           placeholder:odz-text-gray-400 odz-transition-all odz-duration-200" placeholder=":    ,     ,     "></textarea> <!></div></div></div>`),NQ=$('<div><div class="odz-text-center odz-text-gray-500 odz-py-10 odz-border odz-border-dashed odz-border-gray-300 odz-rounded-2xl"><svg class="odz-w-12 odz-h-12 odz-text-gray-300 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 4V2c0-.552.448-1 1-1h8c.552 0 1 .448 1 1v2M7 4h10M7 4l-.5 14c-.051 1.096.846 2 1.5 2h8c.654 0 1.551-.904 1.5-2L17 4"></path></svg> <p class="odz-text-lg odz-font-medium odz-mb-2">  </p> <p class="odz-text-sm"><span class="lg:odz-hidden"> </span><span class="odz-hidden lg:odz-inline"> </span>      .</p></div></div>'),MQ=$('<div class="odz-flex odz-flex-col odz-gap-6"><h1 class="odz-text-xl odz-font-bold odz-my-3 odz-flex odz-items-center odz-gap-5">  <span class="odz-text-sm odz-font-normal odz-text-gray-500">   .</span></h1> <div class="odz-flex odz-flex-col lg:odz-flex-row odz-gap-6"><div class="odz-flex-1 lg:odz-w-1/2"><div class="odz-relative odz-w-full odz-bg-gray-50 odz-border-2 odz-border-gray-200 odz-rounded-xl" style="min-width: 200px; min-height: 400px;"><canvas class="odz-absolute odz-top-0 odz-left-0 odz-w-full odz-h-full odz-rounded-xl" style="image-rendering: pixelated;"></canvas></div> <p class="odz-text-sm odz-text-gray-500 odz-mt-4">          .</p></div> <div class="odz-flex-1 lg:odz-w-1/2"><!></div></div> <div class="odz-mt-8 odz-mb-48 odz-flex odz-gap-4"><button class="odz-btn odz-btn-outline odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> </button> <button class="odz-btn odz-btn-primary odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>  </button></div></div>');function HQ(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(ni,"$shopStore",t),s=()=>an(gt,"$estimateStore",t);let i=ht(e,"productId",8);ht(e,"estimateId",8,void 0);let a=ht(e,"idx",8,void 0),A=ht(e,"onComplete",8),d=ht(e,"onCancel",8,()=>{}),c,u=null,h=[],p=Be(),v=Be(),w=Be(),y=Be([]),B=Be(!1);to(async()=>{c=a()??0;let I=!1;try{await Promise.race([C(),new Promise((D,P)=>setTimeout(()=>P(new Error("  timeout (10)")),1e4))]),I=!0}catch{}try{I&&(await ra(),await new Promise(D=>setTimeout(D,100))),await Q()}catch{}const O=D=>{D.detail.productId===i()&&(console.log(" SimplePrint   :",i()),Z())};return window.addEventListener("saveSimplePrintState",O),()=>{window.removeEventListener("saveSimplePrintState",O)}}),gs(()=>{if(l(y).length>0){const I=l(y).map(O=>({objectId:O.objectId,title:O.title,printMethod:O.printMethod,savedFileInfo:O.savedFileInfo||O.uploadedFiles.map(D=>({name:D.name,size:D.size,type:D.type,url:D.url,path:D.path}))}));gt.updateSimplePrints(c,I)}l(w)&&l(w).destroy()});async function C(){await ra();let I=0;const O=50;for(;I<O&&!l(v);)await new Promise(D=>setTimeout(D,100)),I++;if(!l(v))throw new Error("    .");try{if(u=await j5(i(),o().id),u!=null&&u.id&&(h=await R5(u.id)),u!=null&&u.canvas_json){const D=typeof u.canvas_json=="string"?JSON.parse(u.canvas_json):u.canvas_json,P=D.backgroundImage.width*D.backgroundImage.scaleX,K=D.backgroundImage.height*D.backgroundImage.scaleY;_(w,new Vx(l(v),{width:P,height:K,containerElement:l(p)})),l(w).setPrintAreaClickListener(async M=>{q(M)}),await l(w).setCanvasJSON(D),await new Promise(M=>setTimeout(M,200))}}catch(D){throw D}}async function Q(){var I,O;if(l(w)){let D=0;const P=30;for(;D<P;){try{if((((O=(I=l(w)).getObjects)==null?void 0:O.call(I))||[]).length>0)break}catch{}D++,await new Promise(K=>setTimeout(K,100))}}try{let D=[];const P=s().products[c];P!=null&&P.simplePrints&&P.simplePrints.length>0?D=P.simplePrints:P!=null&&P.simplePrintState&&P.simplePrintState.length>0&&(D=P.simplePrintState),D&&Array.isArray(D)&&D.length>0&&(_(B,!0),_(y,D.map(K=>({objectId:K.objectId,title:K.title,printMethod:K.printMethod||"",uploadedFiles:[],savedFileInfo:K.savedFileInfo||[]}))),await k(),l(w)&&(await ra(),await new Promise(K=>setTimeout(K,50)),N()),_(B,!1))}catch{_(B,!1)}}async function k(){for(const I of l(y))try{if(s().estimateId){const O=await zQ(s().estimateId,I.objectId);if(O.success&&O.files.length>0){_(y,l(y).map(D=>D.objectId===I.objectId?{...D,uploadedFiles:O.files}:D));continue}}if(I.savedFileInfo&&I.savedFileInfo.length>0){const O=I.savedFileInfo.map(D=>({id:Math.random().toString(36).substring(2,8),name:D.name,size:D.size,type:D.type,url:D.url||"#",path:D.path||"",uploadedAt:new Date().toISOString()}));_(y,l(y).map(D=>D.objectId===I.objectId?{...D,uploadedFiles:O}:D))}}catch{if(I.savedFileInfo&&I.savedFileInfo.length>0){const D=I.savedFileInfo.map(P=>({id:Math.random().toString(36).substring(2,8),name:P.name,size:P.size,type:P.type,url:P.url||"#",path:P.path||"",uploadedAt:new Date().toISOString()}));_(y,l(y).map(P=>P.objectId===I.objectId?{...P,uploadedFiles:D}:P))}}}async function H(I,O){try{if(!await _Q(O.path))throw new Error("Storage   .");if(_(y,l(y).map(P=>{var K;return P.objectId===I?{...P,uploadedFiles:P.uploadedFiles.filter(M=>M.id!==O.id),savedFileInfo:(K=P.savedFileInfo)==null?void 0:K.filter(M=>M.name!==O.name)}:P})),s().estimateId){const P=l(y).find(K=>K.objectId===I);P&&await Ay(s().estimateId,I,P.uploadedFiles)}Z()}catch(D){_(y,l(y).map(P=>P.objectId===I?{...P,uploadError:`  : ${D instanceof Error?D.message:"   "}`}:P)),setTimeout(()=>{_(y,l(y).map(P=>P.objectId===I?{...P,uploadError:void 0}:P))},3e3)}}function Z(){if(!l(B))try{const I=l(y).map(O=>({objectId:O.objectId,title:O.title,printMethod:O.printMethod,savedFileInfo:O.savedFileInfo||O.uploadedFiles.map(D=>({name:D.name,size:D.size,type:D.type,url:D.url,path:D.path}))}));if(gt.updateSimplePrints(c,I),typeof window<"u")try{const O=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.saveCurrentState"}});window.dispatchEvent(O)}catch{}}catch{}}function q(I){if(l(y).find(M=>M.objectId===I))return;const D=h.find(M=>M.object_id===I),P=D?D.title:`${I} `,K={objectId:I,title:P,printMethod:"",uploadedFiles:[],isUploading:!1,uploadProgress:0,uploadError:void 0,savedFileInfo:[]};_(y,[...l(y),K]),N(),Z()}function N(){if(l(w))try{l(w).updateAllObjectEnabled(),l(y).forEach(I=>{l(w).updateObjectDisabled(I.objectId)})}catch{}}function re(I){var O,D;if(console.log(""),console.log(" [SimplePrint] removePrintFromArea :",{objectId:I,productId:i(),idx:a()}),console.log(" [BEFORE] selectedPrintAreas:",JSON.parse(JSON.stringify(l(y)))),console.log(" [BEFORE] estimateStore.products[idx].simple_prints:",JSON.parse(JSON.stringify(((O=s().products[a()??0])==null?void 0:O.simple_prints)||[]))),_(y,l(y).filter(P=>P.objectId!==I)),gt.cancelPrint(s().index,I),N(),Z(),console.log(" [AFTER] selectedPrintAreas:",JSON.parse(JSON.stringify(l(y)))),console.log(" [AFTER] estimateStore.products[idx].simple_prints:",JSON.parse(JSON.stringify(((D=s().products[a()??0])==null?void 0:D.simple_prints)||[]))),console.log(""),typeof window<"u")try{const P=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.removePrintFromArea"}});window.dispatchEvent(P)}catch{}}function be(I,O){if(_(y,l(y).map(D=>D.objectId===I?{...D,printMethod:O}:D)),Z(),typeof window<"u")try{const D=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.updatePrintMethod"}});window.dispatchEvent(D)}catch{}}async function L(I,O){const D=Array.from(O);_(y,l(y).map(P=>P.objectId===I?{...P,isUploading:!0,uploadProgress:0,uploadError:void 0}:P));try{const P=await yQ(D,`estimates/${s().estimateId||"temp"}`,(_e,Me,$e)=>{_(y,l(y).map(Y=>Y.objectId===I?{...Y,uploadProgress:$e}:Y))}),K=P.filter(_e=>_e.success&&_e.file).map(_e=>_e.file),M=P.filter(_e=>!_e.success);if(K.length>0&&s().estimateId){const _e=await Ay(s().estimateId,I,K);if(!_e.success)throw new Error(_e.error||"  .")}const ge=D.map(_e=>({name:_e.name,size:_e.size,type:_e.type}));if(_(y,l(y).map(_e=>_e.objectId===I?{..._e,uploadedFiles:K,isUploading:!1,uploadProgress:100,uploadError:M.length>0?`${M.length}   `:void 0,savedFileInfo:ge}:_e)),Z(),typeof window<"u")try{const _e=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),timestamp:Date.now(),source:"SimplePrint.handleFileUpload"}});window.dispatchEvent(_e)}catch{}if(M.length>0){const _e=M.map(Me=>Me.error).join(", ")}}catch(P){_(y,l(y).map(K=>K.objectId===I?{...K,isUploading:!1,uploadProgress:0,uploadError:P instanceof Error?P.message:"  ."}:K))}}function R(I){const D=I.target.value;gt.update(P=>({...P,uploadMemo:D}))}Yt(()=>(l(y),l(w),l(B)),()=>{l(y)&&l(w)&&!l(B)&&N()}),mo(),fn();var J=MQ(),se=x(g(J),2),fe=g(se),ie=g(fe),pe=g(ie);fs(pe,I=>_(v,I),()=>l(v)),fs(ie,I=>_(p,I),()=>l(p));var te=x(fe,2),Ce=g(te);{var ne=I=>{var O=DQ(),D=g(O),P=x(g(D),2),K=x(g(P),2),M=g(K),ge=x(D,2);tr(ge,5,()=>l(y),mr,(ee,ae,ue)=>{var me=kQ(),ye=g(me),Ee=g(ye),de=g(Ee),Qe=g(de);Qe.textContent=ue+1;var Fe=x(de,2),Oe=g(Fe),Te=g(Oe),De=x(Ee,2),ce=x(ye,2),Ie=x(g(ce),2);tr(Ie,4,()=>["","","",""," "],mr,(Ye,rt)=>{var lt=SQ();const vt=at(()=>l(ae).printMethod===rt);var Ft=g(lt);{var Qt=Ht=>{var Ut=CQ();U(Ht,Ut)};ve(Ft,Ht=>{l(vt)&&Ht(Qt)})}var Et=x(Ft,2),mt=g(Et),Gt=g(mt);Ne(()=>{Dr(lt,`odz-group odz-relative odz-bg-white odz-border-2 odz-rounded-xl odz-p-3 odz-transition-all odz-duration-200
                                           ${(l(vt)?"odz-border-red-400 odz-bg-gradient-to-br odz-from-red-50 odz-to-rose-50 odz-shadow-md odz-scale-105":"odz-border-gray-200 hover:odz-border-red-200 hover:odz-shadow-md hover:odz-scale-[1.02]")??""}`),Dr(mt,`odz-text-sm odz-font-semibold ${(l(vt)?"odz-text-red-700":"odz-text-gray-700")??""}`),Se(Gt,rt)}),At("click",lt,()=>be(l(ae).objectId,rt)),U(Ye,lt)});var V=x(ce,2),G=g(V),le=x(G,2),Le=g(le),He=x(le,2);{var je=Ye=>{var rt=EQ(),lt=g(rt),vt=x(g(lt),2),Ft=g(vt),Qt=x(lt,2),Et=g(Qt);Ne(()=>{Se(Ft,`  ... ${l(ae).uploadProgress||0}%`),cr(Et,"style",`width: ${l(ae).uploadProgress||0}%`)}),U(Ye,rt)};ve(He,Ye=>{l(ae).isUploading&&Ye(je)})}var xe=x(He,2);{var Re=Ye=>{var rt=FQ(),lt=x(g(rt),2),vt=g(lt);Ne(()=>Se(vt,l(ae).uploadError)),U(Ye,rt)};ve(xe,Ye=>{l(ae).uploadError&&Ye(Re)})}var et=x(xe,2);{var qe=Ye=>{var rt=TQ(),lt=g(rt),vt=x(g(lt),2),Ft=g(vt),Qt=x(lt,2);tr(Qt,5,()=>l(ae).uploadedFiles,mr,(Et,mt)=>{var Gt=QQ(),Ht=g(Gt),Ut=x(g(Ht),2),st=g(Ut),pt=g(st),_t=x(st,2),$t=g(_t),Rt=x(Ht,2),Ot=g(Rt);{var Ct=St=>{var jt=IQ();Ne(()=>cr(jt,"href",l(mt).url)),U(St,jt)},Wt=St=>{var jt=UQ();U(St,jt)};ve(Ot,St=>{l(mt).url&&l(mt).url!=="#"?St(Ct):St(Wt,!1)})}var It=x(Ot,2);Ne(St=>{cr(st,"title",l(mt).name),Se(pt,l(mt).name),Se($t,St)},[()=>BQ(l(mt).size)],at),At("click",It,()=>H(l(ae).objectId,l(mt))),U(Et,Gt)}),Ne(()=>Se(Ft,`${l(ae).uploadedFiles.length??""}  `)),U(Ye,rt)};ve(et,Ye=>{l(ae).uploadedFiles.length>0&&Ye(qe)})}var ot=x(et,2);{var Pe=Ye=>{var rt=PQ(),lt=it(rt),vt=x(g(lt),2),Ft=g(vt),Qt=x(lt,2);tr(Qt,5,()=>l(ae).savedFileInfo,mr,(Et,mt)=>{var Gt=LQ(),Ht=x(g(Gt),2),Ut=g(Ht),st=x(Ht,2),pt=g(st);Ne(_t=>{cr(Ht,"title",l(mt).name),Se(Ut,l(mt).name),Se(pt,`(${_t??""}KB)`)},[()=>Math.round(l(mt).size/1024)],at),U(Et,Gt)}),Ne(()=>Se(Ft,`  ${l(ae).savedFileInfo.length??""}    (  )`)),U(Ye,rt)};ve(ot,Ye=>{l(ae).savedFileInfo&&l(ae).savedFileInfo.length>0&&l(ae).uploadedFiles.length===0&&Ye(Pe)})}Ne(()=>{Se(Te,l(ae).title),cr(G,"for",`file-upload-${l(ae).objectId??""}`),cr(Le,"id",`file-upload-${l(ae).objectId??""}`)}),At("click",De,()=>re(l(ae).objectId)),At("change",Le,Ye=>L(l(ae).objectId,Ye.target.files)),U(ee,me)});var _e=x(ge,2),Me=g(_e),$e=x(g(Me),2),Y=x($e,2);{var j=ee=>{var ae=OQ(),ue=x(g(ae),2),me=g(ue);Ne(ye=>Se(me,`${ye??""} `),[()=>s().uploadMemo.trim().length],at),U(ee,ae)};ve(Y,ee=>{s().uploadMemo&&s().uploadMemo.trim().length>0&&ee(j)})}Ne(()=>Se(M,`${l(y).length??""}  `)),Cr($e,()=>s().uploadMemo,ee=>er(gt,dt(s).uploadMemo=ee,dt(s))),At("input",$e,R),U(I,O)},ze=I=>{var O=NQ();U(I,O)};ve(Ce,I=>{l(y).length>0?I(ne):I(ze,!1)})}var z=x(se,2),E=g(z),F=x(E,2);At("click",E,function(...I){var O;(O=d())==null||O.apply(this,I)}),At("click",F,function(...I){var O;(O=A())==null||O.apply(this,I)}),U(n,J),dn(),r()}const Qu="uploads";function jQ(n){try{const e=n.match(/^data:(.+);base64,(.+)$/);if(!e||e.length!==3)return console.error("Invalid base64 data URL format"),null;const t=e[1],r=e[2],o=atob(r),s=new Array(o.length);for(let A=0;A<o.length;A++)s[A]=o.charCodeAt(A);const i=new Uint8Array(s);return{blob:new Blob([i],{type:t}),contentType:t}}catch(e){return console.error("Error converting base64 to Blob:",e),null}}function RQ(n){const e=n.lastIndexOf("."),t=e>0?n.substring(0,e):n,r=e>0?n.substring(e):"";let o=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^\x00-\x7F]/g,"").replace(/\s+/g,"_").replace(/[<>:"/\\|?*]/g,"").replace(/_{2,}/g,"_").replace(/^_|_$/g,"").substring(0,200);o||(o=`file_${Date.now()}`);const s=r.replace(/[^\x00-\x7F]/g,"").toLowerCase();return o+s}async function qQ(n,e){var t;try{let r,o,s={};if(n instanceof File)o=n,s.contentType=n.type;else if(typeof n=="string"&&n.startsWith("data:")){const a=jQ(n);if(!a)throw new Error("Failed to convert base64 string to Blob.");o=a.blob,s.contentType=a.contentType}else throw new Error("Invalid data type provided. Must be a File object or a base64 data URL string.");if(console.log(`Uploading to bucket: ${Qu}, path: ${e}, contentType: ${s.contentType}`),r=await ft.storage.from(Qu).upload(e,o,{cacheControl:"3600",upsert:!0,contentType:s.contentType}),r.error)throw console.error("Supabase upload error:",r.error),r.error;if(!((t=r.data)!=null&&t.path))throw new Error("Upload successful but no path returned.");const{data:i}=ft.storage.from(Qu).getPublicUrl(r.data.path);return i!=null&&i.publicUrl?(console.log("File uploaded successfully:",i.publicUrl),i.publicUrl):(console.warn("Could not get public URL after upload."),null)}catch(r){return console.error("Error in uploadImage function:",r),null}}async function KQ(n){if(!n)return console.error("deleteImage: filePath is required."),!1;console.log(`Attempting to delete file from bucket: ${Qu}, path: ${n}`);try{const{data:e,error:t}=await ft.storage.from(Qu).remove([n]);if(t)throw console.error("Supabase delete error:",t),t;return e&&e.length>0?(console.log(`File deleted successfully: ${n}`),!0):(console.warn(`File deletion response for ${n} was successful but no data returned. It might have already been deleted or the path was incorrect.`),!0)}catch(e){return console.error("Error in deleteImage function:",e),!1}}var $Q=$('<th class="odz-bg-base-200"> </th>'),VQ=$('<td><input class="odz-input odz-input-bordered odz-w-full odz-input-sm" type="text" placeholder=" "></td>'),GQ=$('<tr><td><input type="checkbox" class="odz-checkbox"></td><th class="odz-text-sm odz-font-normal odz-whitespace-nowrap"> </th><!></tr>'),WQ=$('<td><div class="odz-flex odz-gap-1"><input class="odz-input odz-input-bordered odz-w-full odz-input-sm" type="text" placeholder="  "> <button class="odz-btn odz-btn-secondary odz-btn-sm"></button></div></td>'),XQ=$('<div class="odz-overflow-x-auto odz-mt-4"><table class="odz-table odz-table-zebra odz-w-full"><thead><tr><th class="odz-bg-base-200 odz-w-10"><input type="checkbox" class="odz-checkbox"></th><th class="odz-bg-base-200"></th><!></tr></thead><tbody><!><tr class="odz-bg-base-100"><td colspan="2" class="odz-font-bold">  </td><!></tr></tbody></table> <div class="odz-mt-4"><button class="odz-btn odz-btn-primary odz-w-full"></button></div></div>');function YQ(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=Be(),i=Be(),a=Be(),A=Be();let d=ht(e,"onComplete",8,()=>{}),c=ht(e,"nameSheet",28,()=>({})),u=Be({});to(()=>{_(u,JSON.parse(JSON.stringify(c())))});let h=Be({}),p=Be({});function v(ie){const pe={...l(h)};l(a).forEach(te=>{pe[te.id]=ie}),_(h,pe)}function w(ie){const pe=l(p)[ie]||"",te={...l(u)};l(a).forEach(Ce=>{l(h)[Ce.id]&&(te[Ce.title]||(te[Ce.title]={}),te[Ce.title][l(y)[ie]||ie]=pe)}),_(u,te)}let y=Be({});function B(ie,pe,te,Ce,ne){l(u)[pe]||br(u,l(u)[pe]={}),br(u,l(u)[pe][Ce]=ne)}function C(){l(a).forEach(ie=>{l(u)[ie.title]||br(u,l(u)[ie.title]={}),l(A).forEach(pe=>{const te=l(y)[pe.objectId]||pe.objectId;l(u)[ie.title][te]===void 0&&br(u,l(u)[ie.title][te]="")})}),c(JSON.parse(JSON.stringify(l(u)))),console.log("  :",c()),d()(c())}Yt(()=>o(),()=>{_(s,o().products[o().index])}),Yt(()=>l(s),()=>{var ie;_(i,((ie=l(s))==null?void 0:ie.variants)||[])}),Yt(()=>l(i),()=>{_(a,[...l(i)].sort((ie,pe)=>ie.title.localeCompare(pe.title)))}),Yt(()=>l(s),()=>{var ie;_(A,((ie=l(s))==null?void 0:ie.prints)||[])}),Yt(()=>(l(A),l(y),zc),()=>{l(A)&&l(A).length>0&&l(A).forEach(async ie=>{if(ie.objectId&&!l(y)[ie.objectId])try{const pe=await zc(ie.objectId);_(y,{...l(y),[ie.objectId]:(pe==null?void 0:pe.title)||ie.objectId})}catch{_(y,{...l(y),[ie.objectId]:ie.objectId})}})}),Yt(()=>(l(a),l(A),l(u),l(y),oo(c())),()=>{if(l(a).length>0&&l(A).length>0){const ie={...l(u)};l(a).forEach(pe=>{ie[pe.title]||(ie[pe.title]={}),l(A).forEach(te=>{var ne;const Ce=l(y)[te.objectId]||te.objectId;ie[pe.title][Ce]===void 0&&(ie[pe.title][Ce]=((ne=c()[pe.title])==null?void 0:ne[Ce])||"")})}),_(u,ie)}}),Yt(()=>(l(a),l(h)),()=>{l(a)&&l(a).length>0&&l(a).forEach(ie=>{l(h)[ie.id]===void 0&&_(h,{...l(h),[ie.id]:!0})})}),mo(),fn();var Q=XQ(),k=g(Q),H=g(k),Z=g(H),q=g(Z),N=g(q),re=x(q,2);tr(re,1,()=>l(A),mr,(ie,pe)=>{var te=$Q(),Ce=g(te);Ne(()=>Se(Ce,l(y)[l(pe).objectId]||l(pe).objectId)),U(ie,te)});var be=x(H),L=g(be);tr(L,1,()=>l(a),mr,(ie,pe)=>{var te=GQ(),Ce=g(te),ne=g(Ce),ze=x(Ce),z=g(ze),E=x(ze);tr(E,1,()=>l(A),mr,(F,I)=>{var O=VQ(),D=g(O);Ne(()=>{var P;return n1(D,((P=l(u)[l(pe).title])==null?void 0:P[l(y)[l(I).objectId]||l(I).objectId])||"")}),At("input",D,P=>B(l(pe).id,l(pe).title,l(I).objectId,l(y)[l(I).objectId]||l(I).objectId,P.target.value)),U(F,O)}),Ne(()=>Se(z,l(pe).title)),z0(ne,()=>l(h)[l(pe).id],F=>br(h,l(h)[l(pe).id]=F)),U(ie,te)});var R=x(L),J=x(g(R));tr(J,1,()=>l(A),mr,(ie,pe)=>{var te=WQ(),Ce=g(te),ne=g(Ce),ze=x(ne,2);Cr(ne,()=>l(p)[l(pe).objectId],z=>br(p,l(p)[l(pe).objectId]=z)),At("click",ze,()=>w(l(pe).objectId)),U(ie,te)});var se=x(k,2),fe=g(se);Ne(ie=>qu(N,ie),[()=>Object.values(l(h)).every(ie=>ie)],at),At("change",N,ie=>v(ie.target.checked)),At("click",fe,C),U(n,Q),dn(),r()}var JQ=$('<span class="odz-text-info odz-inline-flex odz-items-center odz-gap-1"><!>  ...</span>'),ZQ=$('<span class="odz-text-success"> </span>'),eT=$('<span class="odz-text-error"> </span>'),tT=$('<span class="odz-text-gray-500"> </span>'),rT=$('<a target="_blank" rel="noopener noreferrer" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square odz-text-blue-600 hover:odz-text-blue-800 hover:odz-bg-blue-50" aria-label=" " title="   "><!></a>'),nT=$('<div class="odz-flex odz-items-center odz-gap-4 odz-p-3 odz-bg-base-200 odz-rounded-lg odz-relative"><div class="odz-flex-1 odz-min-w-0"><p class="odz-font-medium odz-truncate"> </p> <p class="odz-text-sm odz-text-base-content/70"><!> <!></p></div> <!> <button class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square" aria-label=" "><!></button></div>'),oT=$('<div class="odz-mt-4 odz-flex odz-flex-col odz-gap-2"></div>'),sT=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button></form> <!></div></dialog>'),iT=$('<label for="nameSheet" class="odz-label odz-label-text odz-text-sm odz-mt-4 odz-ml-4 odz-font-bold">       .</label> <div class="odz-card-actions odz-p-4 odz-justify-start"><button class="odz-btn odz-btn-secondary odz-min-w-32"> </button></div> <!>',1),aT=$("<!>  ...",1),AT=$("<!>  ...",1),lT=$('<div class="odz-card odz-bg-base-100 odz-w-full"><div class="odz-card-body odz-p-4"><h2 class="odz-card-title odz-text-base"> </h2> <div role="presentation"><div class="odz-flex odz-flex-col odz-items-center odz-gap-4"><svg xmlns="http://www.w3.org/2000/svg" class="odz-w-12 odz-h-12 odz-text-base-300" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg> <div class="odz-text-base-content"><p class="odz-font-medium">   </p> <label class="odz-btn odz-btn-primary odz-btn-sm odz-mt-2">  <input type="file" multiple class="odz-hidden" accept="image/*"></label></div></div></div> <!> <h2 class="odz-card-title odz-text-base odz-mt-4"> </h2> <textarea name="" id="" rows="5" class="odz-textarea odz-text-sm odz-textarea-bordered odz-textarea-lg odz-w-full odz-mt-4"></textarea></div> <!> <div class="odz-card-actions odz-p-4 odz-justify-center"><button class="odz-btn odz-btn-primary odz-min-w-32"><!></button></div></div>');function dT(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(ni,"$shopStore",t),s=Be(),i=Be(),a=Be();let A=ht(e,"fileUploadTitle",8," "),d=ht(e,"callback",8),c=ht(e,"uploadMemo",12,""),u=ht(e,"initialFiles",24,()=>[]),h=ht(e,"useNameSheet",8,!1),p=ht(e,"nameSheet",28,()=>({})),v=Be([]),w=Be(),y=Be(!1),B=Be(!1),C=Be(!1);async function Q(K){const M=Array.from(K);for(const ge of M){const _e=crypto.randomUUID(),Me=RQ(ge.name),$e=`estimate-uploads/${o().id}/${Date.now()}-${Me}`,Y={id:_e,file:ge,status:"uploading",path:$e};_(v,[...l(v),Y]);try{const j=await qQ(ge,$e);_(v,l(v).map(ee=>ee.id===_e?{...ee,status:j?"uploaded":"error",url:j,error:j?null:"Upload failed to return URL"}:ee))}catch(j){console.error("Upload error for file:",ge.name,j),_(v,l(v).map(ee=>ee.id===_e?{...ee,status:"error",error:j.message||"Unknown upload error"}:ee))}}}function k(K){K.preventDefault(),_(y,!0)}function H(K){K.preventDefault(),_(y,!1)}function Z(K){var ge;K.preventDefault(),_(y,!1);const M=(ge=K.dataTransfer)==null?void 0:ge.files;M&&Q(M)}function q(K){const M=K.target;M.files&&(Q(M.files),M.value="")}async function N(K){const M=l(v).find(_e=>_e.id===K);if(!M)return;const ge=[...l(v)];if(_(v,l(v).filter(_e=>_e.id!==K)),M.status==="uploaded"&&M.path)try{await KQ(M.path)||(console.warn(`Failed to delete file from storage: ${M.path}`),alert("   ."),_(v,ge))}catch(_e){console.error("Error deleting file from storage:",_e),alert("     ."),_(v,ge)}else M.status==="uploading"?console.log("Deleting an item that was still uploading."):console.log("Deleting an item not present in storage or in error state.")}function re(){_(B,!0);const K=l(v).filter(ge=>ge.status==="uploaded"&&ge.url),M={uploadTitle:A(),uploadMemo:c(),files:K.map(ge=>{var _e;return{name:((_e=ge.file)==null?void 0:_e.name)||ge.initialName||"Unknown File",url:ge.url}})};try{d()(M,p())}catch(ge){console.error("Error executing callback:",ge),alert("     .")}finally{_(B,!1)}}to(()=>{console.log("upload component mounted"),u()&&u().length>0&&_(v,u().map(K=>({id:K.path||crypto.randomUUID(),file:null,initialName:K.name,status:"uploaded",url:K.url,path:K.path,error:null})))}),Yt(()=>l(v),()=>{_(s,l(v).every(K=>K.status==="uploaded"||K.status==="error"))}),Yt(()=>l(v),()=>{_(i,l(v).some(K=>K.status==="error"))}),Yt(()=>l(v),()=>{_(a,l(v).some(K=>K.status==="uploading"))}),mo(),fn();var be=lT(),L=g(be),R=x(g(L),2),J=g(R),se=x(g(J),2),fe=x(g(se),2),ie=x(g(fe));fs(ie,K=>_(w,K),()=>l(w));var pe=x(R,2);{var te=K=>{var M=oT();tr(M,5,()=>l(v),ge=>ge.id,(ge,_e)=>{var Me=nT(),$e=g(Me),Y=g($e),j=g(Y),ee=x(Y,2),ae=g(ee);{var ue=Te=>{var De=bn();Ne(ce=>Se(De,`${ce??""} MB -`),[()=>(l(_e).file.size/1024/1024).toFixed(2)],at),U(Te,De)};ve(ae,Te=>{l(_e).file&&Te(ue)})}var me=x(ae,2);{var ye=Te=>{var De=JQ(),ce=g(De);dc(ce,{class:"odz-animate-spin odz-w-3 odz-h-3"}),U(Te,De)},Ee=Te=>{var De=kt(),ce=it(De);{var Ie=G=>{var le=ZQ();U(G,le)},V=G=>{var le=kt(),Le=it(le);{var He=xe=>{var Re=eT();Ne(()=>cr(Re,"title",l(_e).error||"Unknown error")),U(xe,Re)},je=xe=>{var Re=tT();U(xe,Re)};ve(Le,xe=>{l(_e).status==="error"?xe(He):xe(je,!1)},!0)}U(G,le)};ve(ce,G=>{l(_e).status==="uploaded"?G(Ie):G(V,!1)},!0)}U(Te,De)};ve(me,Te=>{l(_e).status==="uploading"?Te(ye):Te(Ee,!1)})}var de=x($e,2);{var Qe=Te=>{var De=rT(),ce=g(De);i5(ce,{class:"odz-w-5 odz-h-5"}),Ne(()=>cr(De,"href",l(_e).url)),U(Te,De)};ve(de,Te=>{l(_e).status==="uploaded"&&l(_e).url&&Te(Qe)})}var Fe=x(de,2),Oe=g(Fe);Vu(Oe,{class:"odz-w-5 odz-h-5"}),Ne(()=>{var Te;Se(j,((Te=l(_e).file)==null?void 0:Te.name)||l(_e).initialName||"Unknown File"),Fe.disabled=l(_e).status==="uploading"}),At("click",Fe,()=>N(l(_e).id)),U(ge,Me)}),U(K,M)};ve(pe,K=>{l(v)&&l(v).length>0&&K(te)})}var Ce=x(pe,2),ne=g(Ce),ze=x(Ce,2),z=x(L,2);{var E=K=>{var M=iT(),ge=x(it(M),2),_e=g(ge),Me=x(ge,2);{var $e=Y=>{var j=sT(),ee=g(j),ae=g(ee),ue=g(ae),me=x(ae,2);YQ(me,{get nameSheet(){return p()},onComplete:ye=>{p(ye),_(C,!1)}}),At("click",ue,()=>_(C,!1)),U(Y,j)};ve(Me,Y=>{l(C)&&Y($e)})}At("click",_e,()=>_(C,!0)),U(K,M)};ve(z,K=>{h()&&K(E)})}var F=x(z,2),I=g(F),O=g(I);{var D=K=>{var M=bn("");U(K,M)},P=K=>{var M=kt(),ge=it(M);{var _e=$e=>{var Y=aT(),j=it(Y);dc(j,{class:"odz-animate-spin odz-mr-2"}),U($e,Y)},Me=$e=>{var Y=kt(),j=it(Y);{var ee=ue=>{var me=AT(),ye=it(me);dc(ye,{class:"odz-animate-spin odz-mr-2"}),U(ue,me)},ae=ue=>{var me=bn("");U(ue,me)};ve(j,ue=>{l(a)?ue(ee):ue(ae,!1)},!0)}U($e,Y)};ve(ge,$e=>{l(B)?$e(_e):$e(Me,!1)},!0)}U(K,M)};ve(O,K=>{l(v).length===0&&!l(B)&&!l(a)?K(D):K(P,!1)})}Ne(()=>{Dr(R,`odz-border-2 odz-border-dashed odz-rounded-lg odz-p-5 odz-text-center odz-mt-4 odz-transition-colors ${(l(y)?"odz-border-primary odz-bg-primary/5":"odz-border-base-300")??""}`),Se(ne,A()),cr(ze,"placeholder",A()),I.disabled=l(B)||l(a)}),At("change",ie,q),At("dragover",R,k),At("dragleave",R,H),At("drop",R,Z),Cr(ze,c),At("click",I,re),U(n,be),dn(),r()}async function cT(n){const{data:e,error:t}=await ft.from("color_groups").select("*").eq("id",n).single();if(t)throw t;return e}var uT=$('<div class="odz-absolute odz-inset-0 odz-flex odz-items-center odz-justify-center"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div>'),hT=$('<div class="odz-tooltip odz-tooltip-secondary"><button><!></button></div>'),fT=$('<div class="odz-mt-4"><h3 class="odz-text-sm odz-font-medium odz-mb-2">  </h3> <div class="odz-flex odz-items-center odz-gap-2"><input type="color" class="odz-h-10 odz-w-10 odz-p-0.5 odz-rounded-full odz-cursor-pointer odz-border odz-border-base-300 [&amp;::-webkit-color-swatch-wrapper]:odz-p-0 [&amp;::-webkit-color-swatch]:odz-rounded-full [&amp;::-moz-color-swatch]:odz-rounded-full"> <input type="text" placeholder="   " class="odz-input odz-input-bordered odz-flex-1"> <button class="odz-btn odz-btn-primary"></button></div></div>'),pT=$('<div class="odz-flex odz-items-center odz-gap-2 odz-bg-base-200 odz-rounded-full odz-px-3 odz-py-1"><div class="odz-w-4 odz-h-4 odz-rounded-full"></div> <span class="odz-text-sm"> </span> <button class="odz-btn odz-btn-ghost odz-btn-xs odz-rounded-full"></button></div>'),gT=$('<div class="odz-mt-4"><h3 class="odz-text-sm odz-font-medium odz-mb-2"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),vT=$('<div class="odz-card odz-bg-base-100"><div class="odz-card-body odz-p-4"><h2 class="odz-card-title odz-text-base odz-mb-4">  <span class="odz-text-sm odz-font-normal"> </span></h2> <div class="odz-flex odz-flex-wrap odz-gap-2"></div> <!> <!></div> <div class="odz-card-actions odz-justify-end odz-p-5"><button class="odz-btn odz-btn-primary odz-w-full"></button></div></div> <!> <!>',1);function mT(n,e){ln(e,!1);let t=ht(e,"colorGroupId",8,null),r=ht(e,"selectedTemplateId",8,null),o=ht(e,"callback",8),s=ht(e,"selectedColors",28,()=>[]),i=Be(!1),a=Be([]),A=Be(0),d=Be(!1),c=Be("#000000"),u=Be(""),h=Be(!1),p=Be("");async function v(){if(t()){_(i,!0);try{const te=await cT(t());_(a,(te==null?void 0:te.colors)||[]),_(d,(te==null?void 0:te.use_custom)||!1)}finally{_(i,!1)}}}async function w(){if(!r())return;const te=await Lc(r());console.log({templateProduct:te}),_(A,Math.max(...te.template_product_variants.map(Ce=>Ce.color_count))),console.log({colorCount:l(A)})}function y(te){if(s().findIndex(ne=>ne.hex===te.hex)===-1){if(s().length>=l(A))return;s([...s(),te])}else s(s().filter(ne=>ne.hex!==te.hex))}function B(te){const Ce=te.replace("#",""),ne=parseInt(Ce.substr(0,2),16),ze=parseInt(Ce.substr(2,2),16),z=parseInt(Ce.substr(4,2),16);return(ne*299+ze*587+z*114)/1e3<128}function C(){if(s().length===0){_(h,!0),_(p,"  .");return}console.log("selectedColors",s()),o()(s())}to(async()=>{await v(),await w()}),fn();var Q=vT(),k=it(Q),H=g(k),Z=g(H),q=x(g(Z)),N=g(q),re=x(Z,2);tr(re,5,()=>l(a),mr,(te,Ce)=>{var ne=hT(),ze=g(ne),z=g(ze);{var E=F=>{var I=uT(),O=g(I);Ne(D=>cr(O,"stroke",D),[()=>B(l(Ce).hex)?"white":"black"],at),U(F,I)};ve(z,F=>{s().some(I=>I.hex===l(Ce).hex)&&F(E)})}Ne(F=>{cr(ne,"data-tip",l(Ce).name),Dr(ze,`odz-relative odz-w-10 odz-h-10 odz-rounded-full odz-transition-all odz-border hover:odz-scale-110 ${F??""}`),cr(ze,"style",`background-color: ${l(Ce).hex??""};`)},[()=>s().some(F=>F.hex===l(Ce).hex)?"odz-border-primary odz-scale-110":"odz-border"],at),At("click",ze,()=>y(l(Ce))),U(te,ne)});var be=x(re,2);{var L=te=>{var Ce=fT(),ne=x(g(Ce),2),ze=g(ne),z=x(ze,2),E=x(z,2);Cr(ze,()=>l(c),F=>_(c,F)),Cr(z,()=>l(u),F=>_(u,F)),At("click",E,()=>{if(l(u).trim()){const F={name:l(u),hex:l(c)};y(F),_(u,""),_(c,"#000000")}}),U(te,Ce)};ve(be,te=>{l(d)&&te(L)})}var R=x(be,2);{var J=te=>{var Ce=gT(),ne=x(g(Ce),2);tr(ne,5,s,mr,(ze,z)=>{var E=pT(),F=g(E),I=x(F,2),O=g(I),D=x(I,2);Ne(()=>{cr(F,"style",`background-color: ${l(z).hex??""};`),Se(O,l(z).name)}),At("click",D,()=>y(l(z))),U(ze,E)}),U(te,Ce)};ve(R,te=>{s().length>0&&te(J)})}var se=x(H,2),fe=g(se),ie=x(k,2);kc(ie,{get isLoading(){return l(i)}});var pe=x(ie,2);Pc(pe,{get isOpen(){return l(h)},set isOpen(te){_(h,te)},get message(){return l(p)},set message(te){_(p,te)},$$legacy:!0}),Ne(()=>Se(N,`(${s().length??""}/${l(A)??""}   .)`)),At("click",fe,C),U(n,Q),dn()}var wT=$('<li><button class="odz-btn odz-btn-ghost hover:odz-text-primary-focus"> </button></li>'),yT=$('<div class="odz-text-sm odz-breadcrumbs odz-mb-6"><ul><li><button class="odz-btn odz-btn-ghost hover:odz-text-primary-focus"></button></li> <!></ul></div>'),_T=$('<figure class="odz-aspect-square odz-overflow-hidden"><img class="odz-w-full odz-h-full odz-object-cover"></figure>'),bT=$('<div class="odz-aspect-square odz-bg-base-200 odz-flex odz-items-center odz-justify-center"><span class="odz-text-base-content/50"> </span></div>'),xT=$('<p class="odz-text-sm odz-text-sm odz-text-base-content/70"> </p>'),BT=$('<button class="odz-btn odz-btn-outline odz-w-full odz-mb-2"> </button>'),zT=$('<div class="odz-card odz-bg-base-100 odz-shadow hover:odz-shadow-lg odz-rounded-lg odz-transition-shadow odz-cursor-pointer"><!> <div class="odz-card-body odz-p-5"><h2 class="odz-card-title odz-text-base"> </h2> <!></div> <div class="odz-card-actions odz-justify-end odz-p-5"><!> <button class="odz-btn odz-btn-primary odz-w-full"></button></div></div>'),CT=$('<div class="odz-grid odz-grid-cols-1 sm:odz-grid-cols-2 md:odz-grid-cols-3 odz-gap-4 odz-w-full"></div>'),ST=$('<div class="odz-p-2 odz-w-full"><h1 class="odz-text-2xl odz-font-bold odz-mb-6"> </h1> <!> <!></div> <!>',1);function ET(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t);let s=ht(e,"objectId",12),i=ht(e,"isTemplateModal",12),a=ht(e,"updateObjectDisabled",8),A=ht(e,"selectedPrintIndex",12),d=ht(e,"productId",8,null),c=ht(e,"estimateId",8,void 0),u=ht(e,"idx",8,void 0),h=Be(!1),p=Be(null),v=Be([]),w=Be([]),y=Be(!1),B=Be(!1),C=Be(null),Q="",k=Be({uploads:null,memo:"",colors:null,uploadMemo:"",nameSheet:{}}),H=null;function Z(z){if(u()!==void 0){const E=z.products.findIndex(F=>(F==null?void 0:F.idx)===u());if(E!==-1)return E}if(d()){const E=z.products.findIndex(F=>{var I;return((I=F==null?void 0:F.product)==null?void 0:I.id)===d()});if(E!==-1)return E}return z.index??0}async function q(z){var I;const E=await D5(z.id);if(_(v,await ud(z.id)),console.log("selectTemplate called:",{template:z,selectedPrintIndex:A()}),_(p,{...E}),l(p).is_last){_(y,l(p).use_file_upload),_(B,l(p).use_color),_(C,l(p).color_group_id);const O=await Lc(l(p).id),D=o(),P=Z(D),K=D.products[P],M=A()!==null?(I=K==null?void 0:K.prints)==null?void 0:I[A()]:null,ge=(M==null?void 0:M.id)||`print_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;H={...M?{...M}:{},id:ge,parentTemplates:l(v),template:{...z,templateProduct:O},objectId:s(),title:Q},M!=null&&M.uploads?(br(k,l(k).uploads=M.uploads),br(k,l(k).nameSheet=M.nameSheet||{})):(br(k,l(k).uploads=null),br(k,l(k).nameSheet={})),M!=null&&M.colors?br(k,l(k).colors=M.colors):br(k,l(k).colors=null),l(y)||(H={...H,uploads:null,nameSheet:{}},br(k,l(k).uploads=null),br(k,l(k).nameSheet={})),l(B)||(H={...H,colors:null},br(k,l(k).colors=null)),!l(y)&&!l(B)&&(await J(),R())}else{_(y,!1),_(B,!1);const O=await N5(z.id);_(w,O)}}async function N(){re()}async function re(){var z,E,F;_(h,!0),_(y,!1),_(B,!1),_(v,[]),H=null;try{if(A()!==null){const O=Z(o()),D=o().products[O],P=(z=D==null?void 0:D.prints)==null?void 0:z[A()];P?(console.log({print:P}),P.uploads&&br(k,l(k).uploads=P.uploads),P.colors&&br(k,l(k).colors=P.colors),(E=P.uploads)!=null&&E.uploadMemo&&br(k,l(k).uploadMemo=P.uploads.uploadMemo),P.nameSheet&&br(k,l(k).nameSheet=P.nameSheet)):A(null)}const I=await zc(s());if(_(w,I.process_print_area_templates.map(({template:O})=>O)),Q=I.title,A()!==null){const O=Z(o()),D=o().products[O],P=(F=D==null?void 0:D.prints)==null?void 0:F[A()];P!=null&&P.template}}catch(I){console.error(I)}finally{console.log("isUpload",l(y)),_(h,!1)}}async function be(z,E){if(_(y,!1),br(k,l(k).uploads=z),br(k,l(k).nameSheet=E),!H){console.warn("selectUpload: pendingPrintData ");return}H={...H,uploads:z,nameSheet:E},l(B)===!1&&(await J(),R())}async function L(z){if(_(B,!1),br(k,l(k).colors=z),!H){console.warn("selectColor: pendingPrintData ");return}H={...H,colors:z},await J(),R()}function R(){!l(y)&&!l(B)&&(i(!1),s(null),H=null,_(k,{uploads:null,memo:"",colors:null,uploadMemo:"",nameSheet:{}})),a()()}async function J(){var E;if(!H)return;gt.update(F=>{const I=Z(F),O=[...F.products];if(!O[I])return F;const D=[...O[I].prints||[]];return A()===null?D.push(H):D[A()]=H,O[I]={...O[I],prints:D},{...F,products:O}});const z=Z(o());if(await gt.calculatePrintPrice(z),await new Promise(F=>setTimeout(F,50)),typeof window<"u"&&d())try{const F=((E=o().products[z])==null?void 0:E.prints)||[],I=c()||o().estimateId||"temp",O=`detailedPrint_${d()}_${I}`,D=JSON.stringify(F);window.sessionStorage.setItem(O,D),console.log(" Templates.svelte - SessionStorage :",{key:O,printsCount:F.length,productId:d(),estimateId:I,mode:c()?"Edit":"Create"});const P=F.reduce((M,ge)=>M+(ge.price||0),0),K=new CustomEvent("detailedPrintUpdate",{detail:{productId:d(),idx:u(),prints:F,printAmount:P,timestamp:Date.now(),source:"Templates",estimateId:I}});window.dispatchEvent(K),console.log(" Templates.svelte -    :",{productId:d(),idx:u(),printAmount:P,estimateId:I,timestamp:Date.now()})}catch(F){console.error(" Templates.svelte - SessionStorage  :",F)}console.log("Decision point - finalized",{selectedPrintIndex:A(),objectId:H.objectId}),H=null}to(async()=>{re()}),fn();var se=ST(),fe=it(se),ie=x(g(fe),2);{var pe=z=>{var E=yT(),F=g(E),I=g(F),O=g(I),D=x(I,2);tr(D,1,()=>l(v),mr,(P,K)=>{var M=wT(),ge=g(M),_e=g(ge);Ne(()=>Se(_e,l(K).name)),At("click",ge,gv(()=>q(l(K)))),U(P,M)}),At("click",O,gv(()=>N())),U(z,E)};ve(ie,z=>{l(p)&&z(pe)})}var te=x(ie,2);{var Ce=z=>{const E=at(()=>{var D;return(D=l(p))==null?void 0:D.file_upload_title}),F=at(()=>l(k).uploadMemo||""),I=at(()=>{var D;return((D=l(k).uploads)==null?void 0:D.files)||[]}),O=at(()=>{var D;return(D=l(p))==null?void 0:D.use_name_list});dT(z,{get fileUploadTitle(){return l(E)},callback:be,get uploadMemo(){return l(F)},get initialFiles(){return l(I)},get nameSheet(){return l(k).nameSheet},get useNameSheet(){return l(O)}})},ne=z=>{var E=kt(),F=it(E);{var I=D=>{const P=at(()=>{var M;return(M=l(p))==null?void 0:M.id}),K=at(()=>l(k).colors||[]);mT(D,{get colorGroupId(){return l(C)},get selectedTemplateId(){return l(P)},callback:L,get selectedColors(){return l(K)}})},O=D=>{var P=CT();tr(P,5,()=>l(w),mr,(K,M)=>{var ge=zT(),_e=g(ge);{var Me=Qe=>{var Fe=_T(),Oe=g(Fe);Ne(()=>{cr(Oe,"src",l(M).image_url),cr(Oe,"alt",l(M).name)}),U(Qe,Fe)},$e=Qe=>{var Fe=bT();U(Qe,Fe)};ve(_e,Qe=>{l(M).image_url?Qe(Me):Qe($e,!1)})}var Y=x(_e,2),j=g(Y),ee=g(j),ae=x(j,2);{var ue=Qe=>{var Fe=xT(),Oe=g(Fe);Ne(()=>Se(Oe,l(M).description)),U(Qe,Fe)};ve(ae,Qe=>{l(M).description&&Qe(ue)})}var me=x(Y,2),ye=g(me);{var Ee=Qe=>{var Fe=BT();At("click",Fe,gv(()=>window.open(l(M).detail_url,"_blank","width=800,height=600"))),U(Qe,Fe)};ve(ye,Qe=>{l(M).detail_url&&Qe(Ee)})}var de=x(ye,2);Ne(()=>Se(ee,l(M).name)),At("click",de,()=>q(l(M))),U(K,ge)}),U(D,P)};ve(F,D=>{l(B)?D(I):D(O,!1)},!0)}U(z,E)};ve(te,z=>{l(y)?z(Ce):z(ne,!1)})}var ze=x(fe,2);kc(ze,{get isLoading(){return l(h)},set isLoading(z){_(h,z)},$$legacy:!0}),U(n,se),dn(),r()}var FT=$('<div class="odz-alert odz-alert-error odz-flex odz-items-center odz-justify-between"><div class="odz-flex odz-items-center odz-gap-3"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div> <button class="odz-btn odz-btn-sm odz-btn-outline"> </button></div>'),IT=$('<div class="odz-absolute odz-inset-0 odz-flex odz-items-center odz-justify-center"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-blue-500 odz-animate-spin" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg> <span class="odz-text-gray-600">  ...</span></div></div>'),UT=$('<img class="odz-h-6 odz-w-6 odz-rounded-md odz-object-cover">'),QT=$('<div class="odz-inline-flex odz-items-center odz-gap-2 odz-rounded-lg odz-border odz-border-slate-200 odz-bg-slate-50 odz-px-3 odz-py-2"><!> <span class="odz-text-xs odz-font-medium odz-text-slate-700"> </span></div>'),TT=$('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"> </p> <div class="odz-flex odz-flex-wrap odz-gap-2"></div></div>'),LT=$('<span class="odz-inline-flex odz-items-center odz-gap-1 odz-rounded-full odz-bg-slate-100 odz-px-2 odz-py-1"><span class="odz-h-3.5 odz-w-3.5 odz-rounded-full odz-border odz-border-slate-300"></span> <span class="odz-text-[11px] odz-text-slate-600"> </span></span>'),PT=$('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"></p> <div class="odz-flex odz-flex-wrap odz-gap-1.5"></div></div>'),kT=$('<div class="odz-space-y-2"><p class="odz-text-[11px] odz-font-medium odz-uppercase odz-tracking-wide odz-text-slate-400"></p> <div class="odz-flex odz-items-center odz-gap-2 odz-rounded-lg odz-border odz-border-slate-200 odz-bg-slate-50 odz-px-3 odz-py-2 odz-text-xs odz-text-slate-600"><svg class="odz-h-3.5 odz-w-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.172 7l-6.586 6.586a2 2 0 102.828 2.828L18 9.828m-2.828-2.828L16 5l3 3-1.828 1.828m-2.828-2.828L9 5l3 3"></path></svg> <span> </span></div></div>'),OT=$('<div class="odz-grid odz-gap-3 sm:odz-grid-cols-2"><!> <!></div>'),DT=$('<div class="odz-rounded-2xl odz-border odz-border-slate-200 odz-bg-white odz-shadow-sm odz-transition-shadow hover:odz-shadow-md"><div class="odz-flex odz-items-start odz-justify-between odz-gap-4 odz-border-b odz-border-slate-100 odz-bg-slate-50 odz-rounded-t-2xl odz-px-5 odz-py-4"><div class="odz-space-y-1"><span class="odz-inline-flex odz-items-center odz-gap-2 odz-text-xs odz-font-semibold odz-text-slate-500"><span class="odz-inline-flex odz-h-5 odz-w-5 odz-items-center odz-justify-center odz-rounded-full odz-bg-slate-200 odz-text-[10px] odz-font-bold odz-text-slate-700"></span>  </span> <h3 class="odz-text-base odz-font-semibold odz-text-slate-900"> </h3></div> <div class="odz-flex odz-shrink-0 odz-items-center odz-gap-2"><button class="odz-btn odz-btn-xs odz-btn-outline"></button> <button class="odz-btn odz-btn-xs odz-btn-outline"></button></div></div> <div class="odz-space-y-4 odz-p-5"><!> <!></div></div>'),NT=$('<div><div class="odz-flex odz-items-center odz-gap-3 odz-mb-6"><div class="odz-w-10 odz-h-10 odz-bg-blue-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-5 odz-h-5 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg></div> <div><h2 class="odz-text-xl odz-font-bold odz-text-gray-800">  </h2> <p class="odz-text-sm odz-text-gray-600"> </p></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-5"></div></div>'),MT=$('<div><div class="odz-text-center odz-text-gray-500 odz-py-10 odz-border odz-border-dashed odz-border-gray-300 odz-rounded-2xl"><svg class="odz-w-12 odz-h-12 odz-text-gray-300 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path></svg> <p class="odz-text-lg odz-font-medium odz-mb-2">  </p> <p class="odz-text-sm"><span class="lg:odz-hidden"> </span><span class="odz-hidden lg:odz-inline"> </span>         .</p></div></div>'),HT=$('<dialog id="detailed-print-template-modal" class="odz-modal odz-modal-open odz-items-center"><div class="odz-modal-box odz-w-11/12 odz-max-w-6xl odz-max-h-[85vh] odz-overflow-hidden odz-flex odz-flex-col odz-items-stretch odz-relative odz-p-4"><div class="odz-flex odz-items-center odz-justify-end odz-pb-2 odz-flex-shrink-0 odz-w-full"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost"></button></form></div> <div class="odz-overflow-y-auto odz-flex-1 odz-w-full odz-min-w-0"><!></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),jT=$('<div class="odz-flex odz-flex-col odz-gap-6"><h1 class="odz-text-xl odz-font-bold odz-my-3 odz-flex odz-items-center odz-gap-5">   <span class="odz-text-sm odz-font-normal odz-text-gray-500">     .</span></h1> <!> <div class="odz-flex odz-flex-col lg:odz-flex-row odz-gap-6"><div class="odz-flex-1 lg:odz-w-1/2"><div><div class="odz-relative odz-w-full odz-bg-gray-50 odz-border-2 odz-border-gray-200 odz-rounded-xl" style="min-width: 200px; min-height: 400px;"><canvas class="odz-absolute odz-top-0 odz-left-0 odz-w-full odz-h-full odz-rounded-xl" style="image-rendering: pixelated;"></canvas> <!></div> <p class="odz-text-sm odz-text-gray-500">         .</p></div></div> <div class="odz-flex-1 lg:odz-w-1/2"><!></div></div></div> <div class="odz-mt-8 odz-mb-48 odz-flex odz-gap-4"><button class="odz-btn odz-btn-outline odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> </button> <button class="odz-btn odz-btn-primary odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>  </button></div> <!>',1);function RT(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(ni,"$shopStore",t),s=()=>an(gt,"$estimateStore",t);let i=ht(e,"productId",8),a=ht(e,"estimateId",8,void 0),A=ht(e,"idx",8,void 0),d=ht(e,"onComplete",8),c=ht(e,"onCancel",8,()=>{}),u=null,h=[],p=Be(),v=Be(),w=Be(),y=Be(!0),B=Be(null),C=Be(!1),Q=Be(null),k=Be(null),H=Be(""),Z=Be(null),q=Be([]),N=Be(!1),re=Be(""),be=Be(!1),L=Be(null),R=Be(""),J=Be(null),se=Be(!1),fe=Be(!1),ie=Be(!1),pe=Be();const te=".main-estimate-modal-box";function Ce(){if(typeof window<"u")try{const V=l(q).reduce((le,Le)=>le+(Le.price||0),0),G=new CustomEvent("detailedPrintUpdate",{detail:{productId:i(),idx:A(),prints:l(q),printAmount:V,timestamp:Date.now(),source:"DetailedPrint"}});window.dispatchEvent(G),console.log(" DetailedPrint -    :",{productId:i(),idx:A(),printAmount:V,timestamp:Date.now()})}catch(V){console.error(" DetailedPrint -    :",V)}}to(async()=>{_(pe,A()??0);try{await K(),await ne(),I()}finally{_(fe,!0)}}),gs(()=>{var V;(V=l(w))==null||V.destroy(),P()});async function ne(){try{_(y,!0),_(B,null),await ze(),await ra(),I()}catch(V){console.error("DetailedPrint initialize failed:",V),_(B,V instanceof Error?V.message:"   .")}finally{_(y,!1)}}async function ze(){await ra();let V=0;const G=50;for(;!l(v)&&V<G;)await new Promise(je=>setTimeout(je,100)),V++;if(!l(v))throw new Error("    .");if(u=await j5(i(),o().id),u!=null&&u.id&&(h=await R5(u.id)),!(u!=null&&u.canvas_json))throw new Error("    .");const le=typeof u.canvas_json=="string"?JSON.parse(u.canvas_json):u.canvas_json,Le=le.backgroundImage.width*le.backgroundImage.scaleX,He=le.backgroundImage.height*le.backgroundImage.scaleY;_(w,new Vx(l(v),{width:Le,height:He,containerElement:l(p)})),l(w).setPrintAreaClickListener(je=>{z(je)}),await l(w).setCanvasJSON(le)}function z(V){var Le,He,je;if(!l(w))return;_(Q,V),_(H,((Le=h.find(xe=>xe.object_id===V))==null?void 0:Le.title)||`${V} `);const le=(((je=(He=l(w)).getObjects)==null?void 0:je.call(He))||[]).find(xe=>{var Re;return((Re=xe==null?void 0:xe.data)==null?void 0:Re.objectId)===V});le?_(Z,{x:Math.round(le.left||0),y:Math.round(le.top||0),width:Math.round((le.width||0)*(le.scaleX||1)),height:Math.round((le.height||0)*(le.scaleY||1))}):_(Z,null),_(k,null),_(C,!0),E()}function E(){const V=document.querySelector(te);V&&(V.scrollTop=0)}function F(V,G){var Le,He;(V||G)&&(console.log(""),console.log(" [DetailedPrint] cancelPrint :",{printId:V,objectId:G,productId:i(),idx:A()}),console.log(" [BEFORE] currentPrints:",JSON.parse(JSON.stringify(l(q)))),console.log(" [BEFORE] estimateStore.products[idx].prints:",JSON.parse(JSON.stringify(((Le=s().products[l(pe)])==null?void 0:Le.prints)||[]))),V?_(q,l(q).filter(je=>je.id!==V)):_(q,l(q).filter(je=>je.objectId!==G)),l(pe)!==void 0&&s().products[l(pe)]&&gt.cancelPrint(l(pe),V,G),I(),P(),console.log(" [AFTER] currentPrints:",JSON.parse(JSON.stringify(l(q)))),console.log(" [AFTER] estimateStore.products[idx].prints:",JSON.parse(JSON.stringify(((He=s().products[l(pe)])==null?void 0:He.prints)||[]))),console.log(""),Ce())}function I(){l(w)&&l(w).updateAllObjectEnabled()}function O(V){const G=l(q)[V];G!=null&&G.objectId&&(_(Q,G.objectId),_(k,V),_(H,G.title||`${G.objectId} `),_(Z,null),_(C,!0),E())}function D(){_(C,!1)}function P(V){try{const G=V??JSON.stringify(l(q)??[]),le=JSON.parse(G);_(re,G),_(J,le),gt.updateDetailedPrints(l(pe),le),Ce();try{gr.selectPrintMethod("detailed")}catch{}try{Xn.selectPrintMethod(i(),"detailed")}catch{}}catch(G){console.error("DetailedPrint  :",G)}}async function K(){let V=null;const G=Er(gt),le=G.products[l(pe)];if(le!=null&&le.prints&&le.prints.length>0&&(V=le.prints),!(!V||!Array.isArray(V)||V.length===0))try{const Le=V;if(_(J,[...Le]),_(q,[...Le]),_(re,JSON.stringify(Le)),!G.products[l(pe)]){_(L,Le),_(R,l(re)),_(be,!0);return}if(_(be,!0),M(Le),await ra(),Array.isArray(Le)&&Le.length>0){try{gr.selectPrintMethod("detailed")}catch{}try{Xn.selectPrintMethod(i(),"detailed")}catch{}Ce()}}catch(Le){console.error("DetailedPrint  :",Le)}finally{l(L)||_(be,!1)}}function M(V){if(!(!V||V.length===0)){if(l(pe)===void 0||!s().products[l(pe)]){console.warn("DetailedPrint applyPrintsToStore:    .",{productId:i(),idx:A(),capturedIdx:l(pe)});return}_(se,!0),console.log("DetailedPrint applyPrintsToStore ",{productId:i(),capturedIdx:l(pe),printsCount:V.length}),_(ie,!1),gt.update(G=>{const le=[...G.products];return le[l(pe)]={...le[l(pe)],prints:V},{...G,products:le,index:l(pe)}}),_(re,JSON.stringify(V??[])),ra().then(()=>{_(se,!1)})}}Yt(()=>(l(J),s(),l(q)),()=>{var V;l(J)&&l(J).length>0&&(((V=s())==null?void 0:V.estimateId)||"temp")!=="temp"&&(_(q,[...l(J)]),console.log(" Edit  (reactive): Supabase DB  :",{printsCount:l(q).length,colors:l(q).map(Le=>{var He,je;return{colorsCount:((He=Le.colors)==null?void 0:He.length)||0,colorNames:(je=Le.colors)==null?void 0:je.map(xe=>xe.name)}})}))}),Yt(()=>(s(),l(J),l(pe)),()=>{var Le;if(!((((Le=s())==null?void 0:Le.estimateId)||"temp")!=="temp"&&l(J)&&l(J).length>0)&&l(pe)!==void 0){const He=s().products[l(pe)],je=(He==null?void 0:He.prints)??[];je.length>0?_(q,[...je]):l(J)&&l(J).length>0&&_(q,[...l(J)])}}),Yt(()=>(l(L),l(pe),s(),l(R),ra),()=>{if(l(L)&&l(pe)!==void 0&&s().products[l(pe)]){const G=l(L),le=l(R)||JSON.stringify(G??[]);_(be,!0),M(G),_(re,le),_(L,null),_(R,""),ra().then(()=>{_(be,!1)})}}),Yt(()=>(l(be),l(se),l(J),l(pe),s()),()=>{var V;if(!l(be)&&!l(se)&&((V=l(J))!=null&&V.length)&&l(pe)!==void 0){const G=s().products[l(pe)],le=(G==null?void 0:G.prints)??[];(!le||le.length===0)&&M(l(J))}}),Yt(()=>(l(C),l(be),l(se),l(q),l(re)),()=>{if(l(C)&&!l(be)&&!l(se))try{JSON.stringify(l(q)??[])!==l(re)&&_(ie,!0)}catch(V){console.error("DetailedPrint    :",V)}}),Yt(()=>l(w),()=>{l(w)&&I()}),Yt(()=>l(C),()=>{_(N,l(C))}),Yt(()=>(l(C),l(N),l(ie),l(fe)),()=>{!l(C)&&l(N)&&(_(Q,null),_(k,null),_(H,""),_(Z,null),l(ie)&&l(fe)&&P(),_(ie,!1),I())}),Yt(()=>(l(fe),l(C),l(be),l(se),l(q),l(re)),()=>{if(l(fe)&&!l(C)&&!l(be)&&!l(se))try{const V=JSON.stringify(l(q)??[]);V!==l(re)&&P(V)}catch(V){console.error("DetailedPrint   :",V)}}),mo(),fn();var ge=jT(),_e=it(ge),Me=x(g(_e),2);{var $e=V=>{var G=FT(),le=g(G),Le=x(g(le),2),He=g(Le),je=x(le,2);Ne(()=>Se(He,l(B))),At("click",je,ne),U(V,G)};ve(Me,V=>{l(B)&&V($e)})}var Y=x(Me,2),j=g(Y),ee=g(j),ae=g(ee),ue=g(ae);fs(ue,V=>_(v,V),()=>l(v));var me=x(ue,2);{var ye=V=>{var G=IT();U(V,G)};ve(me,V=>{l(y)&&!l(B)&&V(ye)})}fs(ae,V=>_(p,V),()=>l(p));var Ee=x(j,2),de=g(Ee);{var Qe=V=>{var G=NT(),le=g(G),Le=x(g(le),2),He=x(g(Le),2),je=g(He),xe=x(le,2);tr(xe,5,()=>l(q),mr,(Re,et,qe)=>{var ot=DT(),Pe=g(ot),Ye=g(Pe),rt=g(Ye),lt=g(rt);lt.textContent=qe+1;var vt=x(rt,2),Ft=g(vt),Qt=x(Ye,2),Et=g(Qt),mt=x(Et,2),Gt=x(Pe,2),Ht=g(Gt);{var Ut=_t=>{var $t=TT(),Rt=x(g($t),2);tr(Rt,5,()=>l(et).parentTemplates,mr,(Ot,Ct)=>{var Wt=QT(),It=g(Wt);{var St=pr=>{var ar=UT();Ne(()=>{cr(ar,"src",l(Ct).image_url),cr(ar,"alt",l(Ct).name)}),U(pr,ar)};ve(It,pr=>{l(Ct).image_url&&pr(St)})}var jt=x(It,2),dr=g(jt);Ne(()=>Se(dr,l(Ct).name)),U(Ot,Wt)}),U(_t,$t)};ve(Ht,_t=>{var $t;($t=l(et).parentTemplates)!=null&&$t.length&&_t(Ut)})}var st=x(Ht,2);{var pt=_t=>{var $t=OT(),Rt=g($t);{var Ot=It=>{var St=PT(),jt=x(g(St),2);tr(jt,5,()=>l(et).colors,mr,(dr,pr)=>{var ar=LT(),ur=g(ar),Ir=x(ur,2),Yr=g(Ir);Ne(()=>{cr(ur,"style",`background-color: ${l(pr).hex??""};`),Se(Yr,l(pr).name)}),U(dr,ar)}),U(It,St)};ve(Rt,It=>{var St;(St=l(et).colors)!=null&&St.length&&It(Ot)})}var Ct=x(Rt,2);{var Wt=It=>{var St=kT(),jt=x(g(St),2),dr=x(g(jt),2),pr=g(dr);Ne(()=>Se(pr,` ${l(et).uploads.files.length??""}`)),U(It,St)};ve(Ct,It=>{var St,jt;(jt=(St=l(et).uploads)==null?void 0:St.files)!=null&&jt.length&&It(Wt)})}U(_t,$t)};ve(st,_t=>{var $t,Rt,Ot;(($t=l(et).colors)!=null&&$t.length||(Ot=(Rt=l(et).uploads)==null?void 0:Rt.files)!=null&&Ot.length)&&_t(pt)})}Ne(()=>Se(Ft,l(et).title)),At("click",Et,()=>O(qe)),At("click",mt,()=>F(l(et).id,l(et).objectId)),U(Re,ot)}),Ne(()=>Se(je,`${l(q).length??""}  `)),U(V,G)},Fe=V=>{var G=MT();U(V,G)};ve(de,V=>{l(q).length>0?V(Qe):V(Fe,!1)})}var Oe=x(_e,2),Te=g(Oe),De=x(Te,2),ce=x(Oe,2);{var Ie=V=>{var G=HT(),le=g(G),Le=g(le),He=g(Le),je=g(He),xe=x(Le,2),Re=g(xe);ET(Re,{get productId(){return i()},get estimateId(){return a()},get idx(){return A()},updateObjectDisabled:I,get objectId(){return l(Q)},set objectId(ot){_(Q,ot)},get isTemplateModal(){return l(C)},set isTemplateModal(ot){_(C,ot)},get selectedPrintIndex(){return l(k)},set selectedPrintIndex(ot){_(k,ot)},$$legacy:!0});var et=x(le,2),qe=g(et);At("click",je,D),At("click",qe,D),U(V,G)};ve(ce,V=>{l(C)&&V(Ie)})}Ne(()=>Dr(ee,`odz-space-y-4 ${l(y)?"odz-opacity-50":""}`)),At("click",Te,function(...V){var G;(G=c())==null||G.apply(this,V)}),At("click",De,function(...V){var G;(G=d())==null||G.apply(this,V)}),U(n,ge),dn(),r()}var qT=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-gap-6 odz-py-10"><div class="odz-text-center"><h2 class="odz-text-xl odz-font-bold odz-mb-2"> </h2> <p class="odz-text-sm odz-text-gray-500">      </p></div> <div class="odz-bg-gray-50 odz-p-8 odz-rounded-lg odz-border-2 odz-border-dashed odz-border-gray-300"><p class="odz-text-gray-600 odz-text-center">    </p></div> <button class="odz-btn odz-btn-secondary odz-px-8"> </button></div>');function KT(n,e){let t=ht(e,"productId",8),r=ht(e,"onComplete",8);console.log("    - productId:",t());var o=qT(),s=x(g(o),4);At("click",s,function(...i){var a;(a=r())==null||a.apply(this,i)}),U(n,o)}var $T=$('<p class="odz-text-[11px] odz-text-gray-400 odz-line-through odz-mt-1"> </p> <p class="odz-text-[11px] odz-text-emerald-600 odz-font-semibold odz-mt-0.5"> </p>',1),VT=$('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p><!></p>',1),GT=$('<p class="odz-mt-1 odz-text-[11px] odz-text-blue-600">   -  </p>'),WT=$('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">     </p>'),XT=$('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-400"></p> <!>',1),YT=$('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">    </p>',1),JT=$('<p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-400"></p> <p class="odz-mt-1 odz-text-[11px] odz-text-gray-500">   </p>',1),ZT=$('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!></p>'),e6=$('<span class="odz-text-blue-600">+ ( )</span>'),t6=$("<span>+ ( )</span>"),r6=$('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!> <!></p>'),n6=$('<p class="odz-mt-1 odz-text-[11px] odz-text-gray-500"> <!> + ( )</p>'),o6=lg('<svg class="odz-w-4 odz-h-4 sm:odz-w-5 sm:odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><!></svg>'),s6=$("<button><!> <span> </span></button>"),i6=$('<div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-2.5"></div>'),a6=$('<button class="odz-w-full odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-font-semibold odz-py-2.5 odz-px-4 odz-rounded-xl odz-transition-colors odz-duration-200 odz-flex odz-items-center odz-justify-center odz-gap-2"><svg class="odz-w-4 odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path></svg> <span> </span></button>'),A6=$('<div class="odz-mt-5 odz-border-t odz-border-gray-200/70 odz-pt-3.5"><!></div>'),l6=$('<div class="odz-mt-5 odz-px-4"><div class="odz-sticky odz-bottom-4 md:odz-static md:odz-bottom-auto"><div class="odz-rounded-3xl odz-border odz-border-gray-200 odz-bg-white/90 odz-backdrop-blur-md odz-shadow-xl odz-p-4 sm:odz-p-5 lg:odz-p-6"><div class="odz-grid sm:odz-grid-cols-2 lg:odz-grid-cols-5 odz-gap-2.5 lg:odz-gap-3"><div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"> </span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <p class="odz-mt-1 odz-text-xs odz-text-gray-500"> </p></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-gray-900"> </p> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"></span> <!></div> <div class="odz-rounded-2xl odz-border odz-border-gray-100 odz-bg-white/80 odz-p-3.5 sm:odz-p-4 odz-shadow-sm"><span class="odz-text-xs odz-font-semibold odz-text-gray-500"> </span> <p class="odz-mt-1.5 odz-text-xl sm:odz-text-2xl odz-font-bold odz-text-red-600"> </p> <!></div></div> <!></div></div></div>');function kp(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gr,"$fixedEstimateStore",t),s=()=>an(Xn,"$extendedProductDataStore",t),i=()=>an(ni,"$shopStore",t),a=Be(),A=Be(),d=Be(),c=Be(),u=Be(),h=Be(),p=Be(),v=Be(),w=Be(),y=Be(),B=Be(),C=Be(),Q=Be(),k=Be(),H=Be();let Z=ht(e,"productId",8),q=ht(e,"showNextButton",8,!1),N=ht(e,"nextButtonText",8,"  "),re=ht(e,"onNext",8,void 0),be=ht(e,"estimateId",8,null),L=ht(e,"idx",8,null),R=ht(e,"buttonConfig",8,null),J=Be(0),se=Be(null),fe=Be(!1),ie=Be(!1);async function pe(){var ae,ue;if(l(fe))return;const ee=Er(Xn);if((ue=(ae=ee==null?void 0:ee.productDataCache)==null?void 0:ae[Z()])!=null&&ue.product){console.log(" SelectedProductSummary: product   ()",{productId:Z()});return}_(fe,!0);try{console.log(" SelectedProductSummary: product  fallback  ",{productId:Z()}),await Xn.loadIntegratedProductData(Z(),i().id),console.log(" SelectedProductSummary: product  fallback  ",{productId:Z()}),_(J,Date.now())}catch(me){console.error(" SelectedProductSummary: product  fallback  ",me)}finally{_(fe,!1)}}function te(){if(l(a)&&l(a).productId===Z()&&l(a).idx===L()&&l(a).printSelection&&l(a).printSelection.currentMethod!=="selection")return l(a).printSelection;if(L()!==null&&L()!==void 0){const ae=Er(gt).products.find(ue=>ue.idx===L());if(ae!=null&&ae.print_type&&ae.print_type!=="selection")return{currentMethod:ae.print_type,productId:Z()}}return l(d)&&l(d).printSelection&&l(d).printSelection.currentMethod!=="selection"?l(d).printSelection:null}async function Ce(ee,ae,ue,me){var De;if(me==="simple"||me==="none")return console.log(" resolvePrintAmount: simple/none   null ",{overrideMethod:me}),null;const ye=L()??0,Ee=Er(gt).products,de=Ee.find(ce=>ce.idx===ye)||Ee[0],Qe=de==null?void 0:de.print_type;if((me||(ae?"detailed":null)||(Qe==="detailed"?"detailed":"none"))!=="detailed")return null;if(de!=null&&de.prints&&Array.isArray(de.prints)&&de.prints.length===0)return console.log(" resolvePrintAmount: prints    DB   null ",{idx:ye,print_type:Qe}),null;if(de!=null&&de.prints&&Array.isArray(de.prints)&&de.prints.length>0){const ce=ue;if(ce<=0)return null;let Ie=0;console.log(" estimateStore.products[idx].prints    :",{idx:ye,printsCount:de.prints.length});for(const V of de.prints){const G=await ne(V,ce);G!==null?Ie+=G:V.price&&typeof V.price=="number"&&(Ie+=V.price,console.log("      ():",{title:V.title,fallbackPrice:V.price,currentTotal:Ie}))}if(Ie>0)return Ie}const Oe=Er(gr);if((Oe==null?void 0:Oe.productId)===Z()&&(Oe==null?void 0:Oe.idx)===L()&&(de==null?void 0:de.prints)!==void 0)return console.log(" resolvePrintAmount: fixedEstimateStore   - DB  ",{productId:Z(),idx:L(),printsLength:((De=de==null?void 0:de.prints)==null?void 0:De.length)??"undefined"}),0;if(be()&&L()!==null)try{const Ie=(await Bc(be())).filter(V=>V.idx===L());if(Ie.length>0){const V=ue;if(V<=0)return null;let G=0;for(const le of Ie){const Le={id:le.id,template:{id:le.template_id},colors:le.colors||[],price:le.price},He=await ne(Le,V);He!==null?G+=He:(G+=le.price||0,console.log("   - DB   ():",{objectId:le.object_id,dbPrice:le.price}))}return G}}catch{}if(ee!=null&&ee.printConfig){let ce=null;if(typeof ee.printConfig=="string")try{ce=JSON.parse(ee.printConfig)}catch{return null}else typeof ee.printConfig=="object"&&ee.printConfig!==null&&(ce=ee.printConfig);if(ce){const Ie=["totalAmount","total","totalPrice","price","amount"];for(const G of Ie){const le=ce[G];if(typeof le=="number"&&!Number.isNaN(le))return le}const V=ce.summary;if(V&&typeof V=="object")for(const G of Ie){const le=V[G];if(typeof le=="number"&&!Number.isNaN(le))return le}}}return null}async function ne(ee,ae){var ue,me;try{if(!((ue=ee.template)!=null&&ue.id))return null;let ye=ee.template.templateProduct;if(ye||(ye=await Lc(ee.template.id)),!(ye!=null&&ye.template_product_variants))return null;let Ee;if(ee.variant_id?(Ee=ye.template_product_variants.find(Fe=>Fe.variant_id===ee.variant_id),console.log(" STEP 4  (variant_id ):",{found:!!Ee,selectedVariant:Ee})):ee.colors&&ee.colors.length>0?(Ee=ye.template_product_variants.find(Fe=>Fe.color_count===ee.colors.length),console.log(" STEP 4  (  ):",{found:!!Ee,selectedVariant:Ee})):(Ee=ye.template_product_variants[0],console.log(" STEP 4  ():",{selectedVariant:Ee})),!Ee)return null;const de=await hl(Ee.variant_id);if(!de||!de.prices||de.prices.length===0)return null;const Qe=de.prices[0].amount;if(Ee.min_quantity<=ae){let Fe=Qe*ae;if((me=ye.product)!=null&&me.quantity_discounts&&ye.product.quantity_discounts.length>0){const Oe=ia(ae,Qe,ye.product.quantity_discounts);if(Oe.hasDiscount){const Te=Oe.discountedPrice*ae;return console.log(" =====   ( ) =====:",{discountedUnitPrice:Oe.discountedPrice,quantity:ae,finalPrice:Te}),Te}}return Fe}else{const Fe=Ee.plate_price||0;return console.log(" =====   (  , plate_price ) =====:",{min_quantity:Ee.min_quantity,productQuantity:ae,platePrice:Fe}),Fe}}catch{return null}}function ze(ee,ae,ue){const me=ue??0,ye=Er(gt).products,Ee=ye.find(Qe=>Qe.idx===me)||ye[0],de=(Ee==null?void 0:Ee.prints)&&Array.isArray(Ee.prints)&&Ee.prints.length>0;return de&&console.log(" checkDetailedPrintSession - estimateStore.products idx   :",{idx:me,foundProductIdx:Ee==null?void 0:Ee.idx,dataLength:Ee.prints.length}),de}let z=Be(0),E=Be(!1),F=Be(null);to(()=>{if(typeof window<"u"){const ee=ye=>{const{productId:Ee,idx:de,prints:Qe,printAmount:Fe,timestamp:Oe,source:Te}=ye.detail;Ee===Z()&&(de===L()||de===null||de===void 0)&&(typeof Fe=="number"&&Fe>=0&&(_(I,Fe),console.log(" SelectedProductSummary:   printAmount :",{printAmount:Fe,source:Te,idx:de})),_(J,Date.now()),_(z,Date.now()))},ae=async ye=>{var Te,De,ce;const{productId:Ee,addonId:de,selectedAddons:Qe,timestamp:Fe,source:Oe}=ye.detail;if(Ee===Z()){console.log(" SelectedProductSummary -     ():",{eventProductId:Ee,addonId:de,selectedAddonsCount:Object.keys(Qe||{}).length,timestamp:Fe,source:Oe,currentProductId:Z()}),await new Promise(le=>setTimeout(le,50));let Ie=Er(gr),V=0;const G=5;for(;V<G&&Ie;){const le=(De=(Te=Ie==null?void 0:Ie.addonSelection)==null?void 0:Te.selectedAddons)==null?void 0:De[de];if(le&&le.variantId===ye.detail.variantId)break;console.log(` Store    (${V+1}/${G}):`,{storeVariantId:le==null?void 0:le.variantId,expectedVariantId:ye.detail.variantId}),await new Promise(Le=>setTimeout(Le,25)),Ie=Er(gr),V++}if(Ie&&l(u)&&l(d)){const le=K(Ie,l(u),Date.now(),(ce=Ie.addonSelection)==null?void 0:ce.selectedAddons);_(Q,le)}_(J,Date.now()),_(z,Date.now())}},ue=ye=>{const{productId:Ee,action:de,color:Qe,variantId:Fe,oldQuantity:Oe,newQuantity:Te,newTotalQuantity:De,timestamp:ce,source:Ie}=ye.detail;Ee===Z()&&(_(J,Date.now()),_(z,Date.now()))},me=async ye=>{var ce,Ie,V;const{productId:Ee,toMethod:de,idx:Qe,estimateId:Fe,prints:Oe,printAmount:Te,source:De}=ye.detail;Ee===Z()&&(console.log(""),console.log(" [SelectedProductSummary] printAmountRecalc  :",{toMethod:de,printAmount:Te,source:De,idx:Qe}),console.log(" [EVENT] estimateStore.products[idx]:",JSON.parse(JSON.stringify(Er(gt).products[L()??0]||{}))),console.log(" [EVENT] fixedEstimateStore.printSelection:",JSON.parse(JSON.stringify(((ce=Er(gr))==null?void 0:ce.printSelection)||{}))),console.log(" [EVENT]  resolvedPrintAmount:",l(I)),console.log(" [EVENT]  isDetailedPrintSelected:",l(E)),console.log(""),_(se,de||null),de==="simple"||de==="none"?(_(ie,!0),_(I,0),_(E,!1),console.log(" printAmountRecalc: simple/none     &  0 ",{toMethod:de,source:De,skipPrintAmountRecalc:!0,resolvedPrintAmount:0,isDetailedPrintSelected:!1})):typeof Te=="number"&&(_(I,Te),console.log(" printAmountRecalc:  printAmount :",{printAmount:Te,toMethod:de,source:De})),de&&gr.updatePrintSelection({currentMethod:de,isCompleted:de==="none",lastUpdated:Date.now()}),_(J,Date.now()),_(z,Date.now()),de==="detailed"&&typeof Te!="number"?(await new Promise(G=>setTimeout(G,100)),_(ie,!1),D(de)):setTimeout(()=>{_(ie,!1),console.log(" skipPrintAmountRecalc   (200ms )")},200),console.log(""),console.log(" [SelectedProductSummary]     :"),console.log(" resolvedPrintAmount:",l(I)),console.log(" isDetailedPrintSelected:",l(E)),console.log(" skipPrintAmountRecalc:",l(ie)),console.log(" eventOverrideMethod:",l(se)),console.log(" estimateStore.products[idx].prints:",JSON.parse(JSON.stringify(((Ie=Er(gt).products[L()??0])==null?void 0:Ie.prints)||[]))),console.log(" estimateStore.products[idx].print_type:",(V=Er(gt).products[L()??0])==null?void 0:V.print_type),console.log(""))};return window.addEventListener("detailedPrintUpdate",ee),window.addEventListener("addonSelectionUpdate",ae),window.addEventListener("productQuantityUpdate",ue),window.addEventListener("printAmountRecalc",me),setTimeout(()=>{_(z,Date.now())},100),()=>{window.removeEventListener("detailedPrintUpdate",ee),window.removeEventListener("addonSelectionUpdate",ae),window.removeEventListener("productQuantityUpdate",ue),window.removeEventListener("printAmountRecalc",me)}}});let I=Be(null),O=!1;async function D(ee){var ae,ue,me;if(!O){console.log(" [calculatePrintAmountAsync] :",{overrideMethod:ee,skipPrintAmountRecalc:l(ie),isDetailedPrintSelected:l(E),currentPrintMethod:l(p),"estimateStore.products[idx].prints.length":((ue=(ae=Er(gt).products[L()??0])==null?void 0:ae.prints)==null?void 0:ue.length)||0,"estimateStore.products[idx].print_type":(me=Er(gt).products[L()??0])==null?void 0:me.print_type});try{O=!0;const ye=l(I);_(I,await Ce(l(h),l(E),l(u).totalQuantity,ee)),console.log(" [calculatePrintAmountAsync] :",{previousAmount:ye,newAmount:l(I),changed:ye!==l(I)})}catch(ye){_(I,null),console.error(" [calculatePrintAmountAsync] :",ye)}finally{O=!1}}}let P=null;function K(ee,ae,ue,me){var Fe,Oe,Te;let ye=ee;if(typeof window<"u"&&Z())try{const De=Er(gr);De&&De.productId===Z()&&(ye=De)}catch{}if(ue&&typeof window<"u"&&Z())try{const De=Er(gr);De&&De.productId===Z()&&(ye=De)}catch{}let Ee=me||((Fe=ye==null?void 0:ye.addonSelection)==null?void 0:Fe.selectedAddons);if(typeof window<"u"&&ue)try{const De=Er(gr);if(De&&De.productId===Z()){const ce=(Oe=De.addonSelection)==null?void 0:Oe.selectedAddons;ce&&Object.keys(ce).length>0&&(Ee=ce)}}catch{}if(!Ee||!((Te=l(d))!=null&&Te.addons))return 0;const de=ae.totalQuantity;let Qe=0;return Object.entries(Ee).forEach(([De,ce])=>{var je,xe,Re;if(!ce||typeof ce!="object"||!("productId"in ce)||!("variantId"in ce))return;const Ie=ce,V=l(d).addons.find(et=>et.id===De);if(!V)return;const G=V.items.find(et=>et.addon_product.id===Ie.productId);if(!G)return;(je=G.addon_product.variants)!=null&&je.map(et=>{var qe,ot;return{id:et.id,title:et.title,price:(ot=(qe=et.prices)==null?void 0:qe[0])==null?void 0:ot.amount}});let le=(xe=G.addon_product.variants)==null?void 0:xe.find(et=>et.id===Ie.variantId);if(!le){(Re=G.addon_product.variants)==null||Re.forEach((et,qe)=>{});return}if(!le.prices||le.prices.length===0)return;const Le=le.prices[0].amount,He=Le*de;Qe+=He,console.log("    ():",{addonName:V.name,variantTitle:le.title||G.addon_product.title,selectedVariantId:Ie.variantId,foundVariantId:le.id,addonUnitPrice:Le,totalQuantity:de,addonItemTotal:He,currentAddonTotal:Qe,calculationValid:le.id===Ie.variantId})}),Qe}function M(ee,ae,ue){var ce,Ie;if(!((ce=l(a))!=null&&ce.productSelection)||!l(c)||l(a).productId!==Z())return{totalQuantity:0,selectedColors:[],totalAmount:{originalTotal:0,discountedTotal:0,hasDiscount:!1}};const{quantityByVariant:me,variantsByColor:ye={},variantDiscounts:Ee}=l(a).productSelection,de=Object.values(me||{}).reduce((V,G)=>V+Object.values(G||{}).reduce((le,Le)=>le+Le,0),0),Qe=Object.keys(me||{}).filter(V=>Object.values(me[V]||{}).some(G=>G>0));let Fe=0,Oe=0,Te=!1;for(const V in me||{})for(const G in me[V]||{}){const le=me[V][G];if(le>0){const Le=(Ie=ye[V])==null?void 0:Ie.find(He=>He.id===G);if(Le&&Le.prices&&Le.prices.length>0){const He=Le.prices[0].amount,je=Ee==null?void 0:Ee[G];Fe+=He*le,je!=null&&je.hasDiscount?(Oe+=je.discountedPrice*le,Te=!0):Oe+=He*le}}}return{totalQuantity:de,selectedColors:Qe,totalAmount:{originalTotal:Fe,discountedTotal:Te?Oe:Fe,hasDiscount:Te}}}to(()=>{P=gr.subscribe(ee=>{(ee==null?void 0:ee.productId)===Z()&&_(J,Date.now())})}),gs(()=>{P&&P()});function ge(){re()&&re()()}function _e(ee){switch(ee){case"arrow-left":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>';case"arrow-right":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>';case"check":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>';case"save":return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3-3m0 0l-3 3m3-3v12"></path>';default:return'<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>'}}function Me(ee,ae="normal"){const ue="odz-font-semibold odz-rounded-lg odz-transition-colors odz-duration-200 odz-flex odz-items-center odz-justify-center odz-gap-2",me=ae==="large"?"odz-py-3 odz-px-5 odz-text-base":"odz-py-2.5 odz-px-4 odz-text-sm";return ee==="primary"?`${ue} ${me} odz-bg-red-600 hover:odz-bg-red-700 odz-text-white`:`${ue} ${me} odz-bg-gray-100 hover:odz-bg-gray-200 odz-text-gray-700 hover:odz-text-gray-800 odz-border odz-border-gray-300`}Yt(()=>o(),()=>{_(a,o())}),Yt(()=>s(),()=>{_(A,s())}),Yt(()=>(l(A),oo(Z())),()=>{var ee,ae;_(d,(ae=(ee=l(A))==null?void 0:ee.productDataCache)==null?void 0:ae[Z()])}),Yt(()=>l(d),()=>{var ee;_(c,(ee=l(d))==null?void 0:ee.product)}),Yt(()=>(oo(Z()),l(c),l(fe),i()),()=>{var ee;Z()&&!l(c)&&!l(fe)&&((ee=i())!=null&&ee.id)&&pe()}),Yt(()=>(l(J),l(a),l(c)),()=>{_(u,M(l(J),l(a),l(c)))}),Yt(()=>{},()=>{_(h,te())}),Yt(()=>l(h),()=>{var ee;_(p,((ee=l(h))==null?void 0:ee.currentMethod)??"selection")}),Yt(()=>(l(z),l(se),l(p),l(h),oo(Z()),oo(be()),oo(L()),l(F),l(E)),()=>{l(z);const ee=l(se)||l(p),ae=!!l(h),ue=ze(Z(),be(),L());let me=!1;ee==="detailed"?me=!0:ee==="simple"||ee==="none"?me=!1:ee==="selection"&&(me=ue);const ye=`${ee}|${ae}|${ue}`;ye!==l(F)&&_(F,ye),l(E)!==me&&_(E,me)}),Yt(()=>l(I),()=>{_(v,l(I)??0)}),Yt(()=>l(u),()=>{_(w,l(u).totalAmount.hasDiscount?l(u).totalAmount.discountedTotal:l(u).totalAmount.originalTotal)}),Yt(()=>l(u),()=>{_(y,l(u).totalAmount.hasDiscount?l(u).totalAmount.originalTotal-l(u).totalAmount.discountedTotal:0)}),Yt(()=>l(y),()=>{_(B,l(y)>0)}),Yt(()=>o(),()=>{var ee,ae;_(C,(ae=(ee=o())==null?void 0:ee.addonSelection)==null?void 0:ae.selectedAddons)}),Yt(()=>(l(a),l(u),l(J),l(C)),()=>{_(Q,K(l(a),l(u),l(J),l(C)))}),Yt(()=>(l(E),l(w),l(v),l(Q)),()=>{_(k,l(E)?l(w)+l(v)+l(Q):l(w)+l(Q))}),Yt(()=>(l(ie),l(h),l(E),l(u),l(J),l(se),l(p)),()=>{if(!l(ie)&&(l(h)||l(E)||l(u).totalQuantity||l(J))){const ee=l(se)||l(p);ee==="detailed"||ee==="selection"?(console.log(" [reactive block]    :",{effectiveMethod:ee,skipPrintAmountRecalc:l(ie),currentPrintMethod:l(p),eventOverrideMethod:l(se)}),D(l(se)||void 0)):console.log(" [reactive block]   (effectiveMethod simple/none):",{effectiveMethod:ee,skipPrintAmountRecalc:l(ie)})}else l(ie)&&console.log(" [reactive block]   (skipPrintAmountRecalc=true)")}),Yt(()=>{},()=>{}),Yt(()=>(oo(R()),oo(q())),()=>{_(H,R()||q())}),mo(),fn();var $e=kt(),Y=it($e);{var j=ee=>{var ae=l6(),ue=g(ae),me=g(ue),ye=g(me),Ee=g(ye),de=x(g(Ee),2),Qe=g(de),Fe=x(de,2),Oe=g(Fe),Te=x(Ee,2),De=x(g(Te),2),ce=g(De),Ie=x(De,2);{var V=Qt=>{var Et=$T(),mt=it(Et),Gt=g(mt),Ht=x(mt,2),Ut=g(Ht);Ne((st,pt)=>{Se(Gt,`${st??""}`),Se(Ut,`-${pt??""} `)},[()=>yr(l(u).totalAmount.originalTotal),()=>yr(l(y))],at),U(Qt,Et)};ve(Ie,Qt=>{l(B)&&Qt(V)})}var G=x(Te,2),le=x(g(G),2);{var Le=Qt=>{var Et=VT(),mt=it(Et),Gt=g(mt),Ht=x(mt,2),Ut=g(Ht);{var st=_t=>{var $t=bn("    .");U(_t,$t)},pt=_t=>{var $t=bn("    .");U(_t,$t)};ve(Ut,_t=>{l(v)>0?_t(st):_t(pt,!1)})}Ne(_t=>{Se(Gt,`${_t??""}`),Dr(Ht,`odz-mt-1 odz-text-[11px] ${l(v)>0?"odz-text-gray-500":"odz-text-orange-500"}`)},[()=>yr(l(v))],at),U(Qt,Et)},He=Qt=>{var Et=XT(),mt=x(it(Et),2);{var Gt=Ut=>{var st=GT();U(Ut,st)},Ht=Ut=>{var st=WT();U(Ut,st)};ve(mt,Ut=>{(l(se)||l(p))==="simple"?Ut(Gt):Ut(Ht,!1)})}U(Qt,Et)};ve(le,Qt=>{l(E)?Qt(Le):Qt(He,!1)})}var je=x(G,2),xe=x(g(je),2);{var Re=Qt=>{var Et=YT(),mt=it(Et),Gt=g(mt);Ne(Ht=>Se(Gt,`${Ht??""}`),[()=>yr(l(Q))],at),U(Qt,Et)},et=Qt=>{var Et=JT();U(Qt,Et)};ve(xe,Qt=>{l(Q)>0?Qt(Re):Qt(et,!1)})}var qe=x(je,2),ot=x(g(qe),2),Pe=g(ot),Ye=x(ot,2);{var rt=Qt=>{var Et=ZT(),mt=g(Et),Gt=x(mt);{var Ht=Ut=>{var st=bn();Ne(pt=>Se(st,`+ ${pt??""}`),[()=>yr(l(Q))],at),U(Ut,st)};ve(Gt,Ut=>{l(Q)>0&&Ut(Ht)})}Ne((Ut,st)=>Se(mt,`${Ut??""} + ${st??""} `),[()=>yr(l(w)),()=>yr(l(v))],at),U(Qt,Et)},lt=Qt=>{var Et=kt(),mt=it(Et);{var Gt=Ut=>{var st=r6(),pt=g(st),_t=x(pt);{var $t=Wt=>{var It=bn();Ne(St=>Se(It,`+  ${St??""}`),[()=>yr(l(Q))],at),U(Wt,It)};ve(_t,Wt=>{l(Q)>0&&Wt($t)})}var Rt=x(_t,2);{var Ot=Wt=>{var It=e6();U(Wt,It)},Ct=Wt=>{var It=t6();U(Wt,It)};ve(Rt,Wt=>{l(p)==="simple"?Wt(Ot):Wt(Ct,!1)})}Ne(Wt=>Se(pt,` ${Wt??""} `),[()=>yr(l(w))],at),U(Ut,st)},Ht=Ut=>{var st=n6(),pt=g(st),_t=x(pt);{var $t=Rt=>{var Ot=bn();Ne(Ct=>Se(Ot,`+  ${Ct??""}`),[()=>yr(l(Q))],at),U(Rt,Ot)};ve(_t,Rt=>{l(Q)>0&&Rt($t)})}Ne(Rt=>Se(pt,` ${Rt??""} `),[()=>yr(l(w))],at),U(Ut,st)};ve(mt,Ut=>{l(E)?Ut(Ht,!1):Ut(Gt)},!0)}U(Qt,Et)};ve(Ye,Qt=>{l(E)&&l(v)>0?Qt(rt):Qt(lt,!1)})}var vt=x(ye,2);{var Ft=Qt=>{var Et=A6(),mt=g(Et);{var Gt=Ut=>{var st=i6();tr(st,5,()=>R().buttons,mr,(pt,_t,$t)=>{var Rt=s6(),Ot=g(Rt);{var Ct=St=>{var jt=o6(),dr=g(jt);x0(dr,()=>_e(l(_t).icon),!0,!1),U(St,jt)};ve(Ot,St=>{l(_t).icon&&St(Ct)})}var Wt=x(Ot,2),It=g(Wt);Ne(St=>{Dr(Rt,St),Se(It,l(_t).text)},[()=>`${R().type==="single"?"odz-w-full":$t===0?"odz-flex-1":"odz-flex-1 sm:odz-flex-[1.35]"} ${Me(l(_t).style,l(_t).size||"normal")}`],at),At("click",Rt,function(...St){var jt;(jt=l(_t).action)==null||jt.apply(this,St)}),U(pt,Rt)}),U(Ut,st)},Ht=Ut=>{var st=a6(),pt=x(g(st),2),_t=g(pt);Ne(()=>Se(_t,N())),At("click",st,ge),U(Ut,st)};ve(mt,Ut=>{R()?Ut(Gt):Ut(Ht,!1)})}U(Qt,Et)};ve(vt,Qt=>{l(H)&&Qt(Ft)})}Ne((Qt,Et)=>{Se(Qe,`${l(u).totalQuantity??""}`),Se(Oe,`${l(u).selectedColors.length??""}  `),Se(ce,`${Qt??""}`),Se(Pe,`${Et??""}`)},[()=>yr(l(w)),()=>yr(l(k))],at),U(ee,ae)};ve(Y,ee=>{l(u).totalQuantity>0&&l(c)&&ee(j)})}U(n,$e),dn(),r()}var d6=$('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),c6=$('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div> <button class="odz-mt-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-px-4 odz-py-2 odz-rounded-lg odz-text-sm"> </button></div>'),u6=$('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-green-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">    ...</p></div></div></div>'),h6=$('<div class="odz-flex odz-items-center odz-justify-center odz-gap-2"><div class="odz-w-1.5 odz-h-1.5 odz-bg-gray-400 odz-rounded-full"></div> <span class="odz-text-xs odz-text-gray-600"> </span></div>'),f6=$(`<button class="odz-group odz-cursor-pointer odz-w-full odz-text-left"><div class="odz-relative odz-bg-white odz-border-2 odz-border-gray-200 odz-rounded-xl odz-p-6
                               odz-transition-all odz-duration-300 odz-shadow-sm odz-overflow-visible
                               hover:odz-border-gray-300 hover:odz-shadow-lg hover:odz-scale-105"><div></div> <div class="odz-relative odz-z-10"><div class="odz-text-4xl odz-mb-4 odz-text-center"> </div> <h3 class="odz-text-lg odz-font-bold odz-text-gray-800 odz-text-center odz-mb-2"> </h3> <p class="odz-text-sm odz-text-gray-600 odz-text-center odz-mb-4"> </p> <div class="odz-space-y-2"></div></div></div></button>`),p6=$('<div class="odz-flex odz-flex-col odz-gap-6 odz-p-4 odz-pb-48"><div class="odz-text-center odz-mb-6"><h1 class="odz-text-2xl odz-font-bold odz-text-gray-800 odz-mb-2">  </h1> <p class="odz-text-sm odz-text-gray-600">   </p></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-6 odz-p-4"></div> <!></div>'),g6=$('<div class="odz-relative"><!></div>'),v6=$('<div class="odz-relative"><!></div>'),m6=$('<div class="odz-relative odz-pb-48"><!> <!></div>'),w6=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-gap-6 odz-py-16"><div class="odz-text-center"><div class="odz-text-6xl odz-mb-4"></div> <h2 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2">  </h2> <p class="odz-text-sm odz-text-gray-600">        </p></div> <div class="odz-w-full odz-mt-8 odz-mb-48 odz-flex odz-gap-4"><button class="odz-btn odz-btn-outline odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> </button> <button class="odz-btn odz-btn-primary odz-flex-1"><svg class="odz-w-5 odz-h-5 odz-mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>  </button></div></div>');function Gx(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=()=>an(gr,"$fixedEstimateStore",t),i=()=>an(ni,"$shopStore",t),a=Be();let A=ht(e,"productId",8),d=ht(e,"estimateId",8,void 0),c=ht(e,"idx",8,void 0),u=ht(e,"step",12,0),h=ht(e,"onNext",8,void 0),p=Be(null),v=Be(!1),w=Be(null),y=Be(!1);function B(){if(d()&&d()!=="temp")return"selection";if(c()!==void 0){const z=o().products[c()];if(z!=null&&z.print_type&&z.print_type!=="selection")return z.print_type}return"selection"}let C=Be(B()),Q=null;const k=[{id:"simple",title:"  ",description:"   ",icon:"",features:[" ","  "," "],color:"from-green-500 to-emerald-600"},{id:"detailed",title:"  ",description:"  ",icon:"",features:[" "," "," /"],color:"from-blue-500 to-indigo-600"},{id:"self-design",title:" ",description:"  ",icon:"",features:[" "," "," "],color:"from-purple-500 to-pink-600"},{id:"none",title:"  ",description:"    ",icon:"",features:[" ","  "," "],color:"from-gray-500 to-slate-600"}];function H(ne){const ze=ne;_(C,ze),console.log(""),console.log(" [print.svelte] selectPrintMethod :",{method:ze,idx:c(),productId:A()}),console.log(" [BEFORE] estimateStore.products[idx]:",JSON.parse(JSON.stringify(Er(gt).products[c()??0]||{}))),console.log(" [BEFORE] fixedEstimateStore:",JSON.parse(JSON.stringify(Er(gr)||{}))),ze!=="selection"&&Xn.selectPrintMethod(A(),ze),ze!=="selection"&&gr.selectPrintMethod(ze),ze!=="selection"&&c()!==void 0&&(gt.updateProductPrintType(c(),ze),ze==="simple"||ze==="none"?(gt.clearDetailedPrints(c()),console.log(" [print.svelte] clearDetailedPrints  (idx:",c(),")")):ze==="detailed"&&gt.clearSimplePrints(c())),console.log(" [AFTER] estimateStore.products[idx]:",JSON.parse(JSON.stringify(Er(gt).products[c()??0]||{}))),console.log(" [AFTER] fixedEstimateStore:",JSON.parse(JSON.stringify(Er(gr)||{}))),console.log(""),(ze==="simple"||ze==="none")&&d()&&d()!=="temp"&&c()!==void 0&&ft.from("estimate_prints").delete().eq("estimate_id",d()).eq("idx",c()).then(({error:z})=>{z&&console.error(" estimate_prints  :",z)}),typeof window<"u"&&ze!=="selection"&&requestAnimationFrame(()=>{const z=new CustomEvent("printAmountRecalc",{detail:{productId:A(),fromMethod:"unknown",toMethod:ze,idx:c(),estimateId:d(),printAmount:ze==="simple"||ze==="none"?0:void 0,source:"printMethodChange"}});window.dispatchEvent(z),console.log(" printAmountRecalc   (requestAnimationFrame ):",{productId:A(),method:ze,printAmount:ze==="simple"||ze==="none"?0:void 0})}),ze==="none"&&(u(0),Xn.completePrintSelection(A()),gr.completePrintSelection(),h()&&h()())}function Z(){console.log(""),console.log(" [print.svelte] backToSelection "),console.log(" [BEFORE] estimateStore.products[idx]:",JSON.parse(JSON.stringify(Er(gt).products[c()??0]||{}))),console.log(" [BEFORE] fixedEstimateStore:",JSON.parse(JSON.stringify(Er(gr)||{}))),_(C,"selection"),Xn.updatePrintSelection(A(),{currentMethod:"selection",isCompleted:!1}),gr.updatePrintSelection({currentMethod:"selection",isCompleted:!1,lastUpdated:Date.now()}),c()!==void 0&&(gt.clearDetailedPrints(c()),gt.clearSimplePrints(c()),gt.updateProductPrintType(c(),"selection"),console.log(" [backToSelection] estimateStore prints ")),console.log(" [AFTER] estimateStore.products[idx]:",JSON.parse(JSON.stringify(Er(gt).products[c()??0]||{}))),console.log(" [AFTER] fixedEstimateStore:",JSON.parse(JSON.stringify(Er(gr)||{}))),console.log(""),typeof window<"u"&&requestAnimationFrame(()=>{const ne=new CustomEvent("printAmountRecalc",{detail:{productId:A(),fromMethod:"unknown",toMethod:"selection",idx:c(),estimateId:d(),printAmount:0,source:"backToSelection"}});window.dispatchEvent(ne),console.log(" [backToSelection] printAmountRecalc   (toMethod: selection, printAmount: 0)")})}function q(){_(C,"selection"),A()&&Xn.updatePrintSelection(A(),{currentMethod:"selection",isCompleted:!1})}async function N(){var z;u(0),Xn.completePrintSelection(A()),gr.completePrintSelection();let ne=0,ze=[];if(l(C)==="detailed"&&c()!==void 0&&(await gt.calculatePrintPrice(c()),ze=((z=o().products[c()])==null?void 0:z.prints)||[],ne=ze.reduce((E,F)=>E+(F.price||0),0)),typeof window<"u"){const E=new CustomEvent("printAmountRecalc",{detail:{productId:A(),fromMethod:l(C),toMethod:l(C),idx:c(),estimateId:d(),prints:ze,printAmount:ne,source:"printComplete"}});window.dispatchEvent(E),console.log(" print.svelte - completePrint  :",{productId:A(),idx:c(),currentMethod:l(C),printAmount:ne})}h()&&h()()}function re(ne){ne!=null&&ne.product&&gt.update(ze=>{const z=[...ze.products];let E=z.findIndex(F=>{var I;return((I=F==null?void 0:F.product)==null?void 0:I.id)===ne.product.id});if(E===-1){const F={product:ne.product,variants:[],quantity:0,prints:[],addons:{},addonProductsMap:ne.addonProductsMap||{},productAmount:0,printAmount:0,addonAmount:0,totalAmount:0,isLoaded:!0};z.push(F),E=z.length-1}else z[E].prints||(z[E]={...z[E],prints:[]});return{...ze,products:z,index:E}})}async function be(ne=!1){var ze;if(A()){_(v,!0),_(w,null);try{const z=s().productSelection;if(ne&&z&&z.product&&z.productId===A()){if(_(p,{product:z.product,addons:z.addons||[],addonItems:z.addonItems||[]}),re(l(p)),c()!==void 0){const F=o().products[c()];F!=null&&F.print_type&&F.print_type!=="selection"&&_(C,F.print_type)}return}if(!ne){const F=Xn.restoreFromSession(A());if(F!=null&&F.isLoaded){_(p,F),re(l(p)),F.printSelection&&_(C,F.printSelection.currentMethod);return}}const E=Xn.getProductData(A());E!=null&&E.isLoaded?(_(p,E),re(l(p)),!ne&&E.printSelection&&_(C,E.printSelection.currentMethod)):(_(p,await Xn.loadIntegratedProductData(A(),i().id)),re(l(p))),(ze=l(p))!=null&&ze.process}catch(z){_(w,z instanceof Error?z.message:"   .")}finally{_(v,!1)}}}function L(){const ne=Xn.getProductData(A());if(!(ne!=null&&ne.printSelection))return;const ze=ne.printSelection;_(C,ze.currentMethod)}function R(){Q=Xn.subscribe(ne=>{const ze=ne.productDataCache[A()];if(ze!=null&&ze.printSelection){const E=ze.printSelection.currentMethod;E!==l(C)&&_(C,E)}})}function J(ne,ze){if(typeof window>"u")return;const z=`simplePrint_${A()}_${d()}`,E=`detailedPrint_${A()}_${d()}`;if(ze==="simple"){const F=window.sessionStorage.getItem(z);if(F)try{const I=JSON.parse(F);Array.isArray(I)&&I.length>0&&(gt.updateSimplePrints(ne,I),gt.updateProductPrintType(ne,"simple"))}catch(I){console.warn("[print.svelte] QNA simplePrint  :",I)}}else if(ze==="detailed"){const F=window.sessionStorage.getItem(E);if(F)try{const I=JSON.parse(F);Array.isArray(I)&&I.length>0&&(gt.updateDetailedPrints(ne,I),gt.updateProductPrintType(ne,"detailed"))}catch(I){console.warn("[print.svelte] QNA detailedPrint  :",I)}}}async function se(){if(!d()||d()==="temp")return"selection";const ne=c()??o().index??0;let ze="selection";try{const E=o().products[ne];if(E!=null&&E.print_type&&E.print_type!=="selection")return E.print_type;const I=(await p1(d())).filter(O=>O.idx===ne);if(I.length>0){const O=I.map(D=>({objectId:D.object_id||"",title:D.title||"",printMethod:D.print_method||"",savedFileInfo:D.uploads?typeof D.uploads=="string"?JSON.parse(D.uploads):D.uploads:[]}));gt.updateSimplePrints(ne,O),ze="simple"}return E!=null&&E.prints&&E.prints.length>0&&(ze="detailed"),ze!=="selection"&&gt.updateProductPrintType(ne,ze),ze}catch(z){return console.error(" detectPrintMethodFromDB :",z),"selection"}}to(async()=>{var z,E,F;const ne=d()&&d()!=="temp",ze=(z=d())==null?void 0:z.startsWith("qna_");if(ne){_(y,!0);try{if(ze){const I=s().printSelection;I!=null&&I.currentMethod&&I.currentMethod!=="selection"&&_(C,I.currentMethod)}else{const I=await se();I!=="selection"&&_(C,I)}}finally{_(y,!1)}}if(ne||gr.initialize(A(),d(),c()),R(),await be(ne),ze&&l(C)!=="selection"){const I=c()??0;J(I,l(C))}if(ne||L(),!ne){const I=o().products.find(D=>{var P;return((P=D==null?void 0:D.product)==null?void 0:P.id)===A()});if((!((E=l(p))!=null&&E.printSelection)||!l(p).printSelection.currentMethod||l(p).printSelection.currentMethod==="selection")&&(I!=null&&I.prints)&&I.prints.length>0)try{const D=I.prints[0],P=(D==null?void 0:D.method)??((F=D==null?void 0:D.parentTemplates)!=null&&F.length?"detailed":"simple");Xn.updatePrintSelection(A(),{currentMethod:P??l(C),selectedTemplate:D==null?void 0:D.template,selectedColors:D==null?void 0:D.colors,printConfig:D==null?void 0:D.config}),_(C,P??l(C)),console.log("      (currentMethod ):",{derivedMethod:P,fallbackMethod:l(C)})}catch{}}}),gs(()=>{Q&&Q()}),Yt(()=>l(p),()=>{_(a,k.filter(ne=>{var ze,z;return ne.id==="self-design"?((z=(ze=l(p))==null?void 0:ze.product)==null?void 0:z.self_design_enabled)===!0:!0}))}),Yt(()=>(l(C),l(a)),()=>{l(C)!=="selection"&&(l(a).some(ze=>ze.id===l(C))||_(C,"selection"))}),mo(),fn();var fe=kt(),ie=it(fe);{var pe=ne=>{var ze=d6();U(ne,ze)},te=ne=>{var ze=kt(),z=it(ze);{var E=I=>{var O=c6(),D=g(O),P=x(g(D),2),K=x(g(P),2),M=g(K),ge=x(D,2);Ne(()=>Se(M,l(w))),At("click",ge,()=>be(d()&&d()!=="temp")),U(I,O)},F=I=>{var O=kt(),D=it(O);{var P=M=>{var ge=u6();U(M,ge)},K=M=>{var ge=kt(),_e=it(ge);{var Me=Y=>{var j=p6(),ee=x(g(j),2);tr(ee,5,()=>l(a),mr,(ye,Ee)=>{var de=f6(),Qe=g(de),Fe=g(Qe),Oe=x(Fe,2),Te=g(Oe),De=g(Te),ce=x(Te,2),Ie=g(ce),V=x(ce,2),G=g(V),le=x(V,2);tr(le,5,()=>l(Ee).features,mr,(Le,He)=>{var je=h6(),xe=x(g(je),2),Re=g(xe);Ne(()=>Se(Re,l(He))),U(Le,je)}),Ne(()=>{Dr(Fe,`odz-absolute odz-inset-0 odz-bg-gradient-to-br ${l(Ee).color??""}
                                   odz-rounded-xl odz-opacity-0 group-hover:odz-opacity-10 odz-transition-opacity odz-duration-300`),Se(De,l(Ee).icon),Se(Ie,l(Ee).title),Se(G,l(Ee).description)}),At("click",de,()=>H(l(Ee).id)),U(ye,de)});var ae=x(ee,2);const ue=at(()=>d()||null),me=at(()=>c()!==void 0?c():null);kp(ae,{get productId(){return A()},get estimateId(){return l(ue)},get idx(){return l(me)},debugSource:"print-selection",buttonConfig:{type:"double",buttons:[{text:" ",action:()=>{if(typeof window<"u"){const ye=new CustomEvent("changeTab",{detail:"product"});window.dispatchEvent(ye)}},style:"secondary",icon:"arrow-left"},{text:"",action:N,style:"primary",icon:"check"}]}}),U(Y,j)},$e=Y=>{var j=kt(),ee=it(j);{var ae=me=>{var ye=g6(),Ee=g(ye);HQ(Ee,{get productId(){return A()},get estimateId(){return d()},get idx(){return c()},onComplete:N,onCancel:Z}),U(me,ye)},ue=me=>{var ye=kt(),Ee=it(ye);{var de=Fe=>{var Oe=v6(),Te=g(Oe);RT(Te,{get productId(){return A()},get estimateId(){return d()},get idx(){return c()},onComplete:N,onCancel:Z}),U(Fe,Oe)},Qe=Fe=>{var Oe=kt(),Te=it(Oe);{var De=Ie=>{var V=m6(),G=g(V);KT(G,{get productId(){return A()},onComplete:N});var le=x(G,2);const Le=at(()=>d()||null),He=at(()=>c()!==void 0?c():null);kp(le,{get productId(){return A()},get estimateId(){return l(Le)},get idx(){return l(He)},debugSource:"print-self-design",buttonConfig:{type:"single",buttons:[{text:"",action:N,style:"primary",icon:"check",size:"large"}]}}),U(Ie,V)},ce=Ie=>{var V=kt(),G=it(V);{var le=Le=>{var He=w6(),je=x(g(He),2),xe=g(je),Re=x(xe,2);At("click",xe,Z),At("click",Re,N),U(Le,He)};ve(G,Le=>{l(C)==="none"&&Le(le)},!0)}U(Ie,V)};ve(Te,Ie=>{l(C)==="self-design"?Ie(De):Ie(ce,!1)},!0)}U(Fe,Oe)};ve(Ee,Fe=>{l(C)==="detailed"?Fe(de):Fe(Qe,!1)},!0)}U(me,ye)};ve(ee,me=>{l(C)==="simple"?me(ae):me(ue,!1)},!0)}U(Y,j)};ve(_e,Y=>{l(C)==="selection"?Y(Me):Y($e,!1)},!0)}U(M,ge)};ve(D,M=>{l(y)?M(P):M(K,!1)},!0)}U(I,O)};ve(z,I=>{l(w)?I(E):I(F,!1)},!0)}U(ne,ze)};ve(ie,ne=>{l(v)?ne(pe):ne(te,!1)})}U(n,fe),Pb(e,"resetPrintTab",q);var Ce=dn({resetPrintTab:q});return r(),Ce}/*!
* html2canvas-pro 1.5.8 <https://yorickshan.github.io/html2canvas-pro/>
* Copyright (c) 2024 yorickshan <https://github.com/yorickshan>
* Released under MIT License
*//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var em=function(n,e){return em=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])},em(n,e)};function da(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");em(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var tm=function(){return tm=Object.assign||function(e){for(var t,r=1,o=arguments.length;r<o;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},tm.apply(this,arguments)};function Os(n,e,t,r){function o(s){return s instanceof t?s:new t(function(i){i(s)})}return new(t||(t=Promise))(function(s,i){function a(c){try{d(r.next(c))}catch(u){i(u)}}function A(c){try{d(r.throw(c))}catch(u){i(u)}}function d(c){c.done?s(c.value):o(c.value).then(a,A)}d((r=r.apply(n,[])).next())})}function zs(n,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,i;return i={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function a(d){return function(c){return A([d,c])}}function A(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,o&&(s=d[0]&2?o.return:d[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,d[1])).done)return s;switch(o=0,s&&(d=[d[0]&2,s.value]),d[0]){case 0:case 1:s=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,o=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!s||d[1]>s[0]&&d[1]<s[3])){t.label=d[1];break}if(d[0]===6&&t.label<s[1]){t.label=s[1],s=d;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(d);break}s[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(c){d=[6,c],o=0}finally{r=s=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function _f(n,e,t){if(arguments.length===2)for(var r=0,o=e.length,s;r<o;r++)(s||!(r in e))&&(s||(s=Array.prototype.slice.call(e,0,r)),s[r]=e[r]);return n.concat(s||e)}var CA=function(){function n(e,t,r,o){this.left=e,this.top=t,this.width=r,this.height=o}return n.prototype.add=function(e,t,r,o){return new n(this.left+e,this.top+t,this.width+r,this.height+o)},n.fromClientRect=function(e,t){return new n(t.left+e.windowBounds.left,t.top+e.windowBounds.top,t.width,t.height)},n.fromDOMRectList=function(e,t){var r=Array.from(t).find(function(o){return o.width!==0});return r?new n(r.left+e.windowBounds.left,r.top+e.windowBounds.top,r.width,r.height):n.EMPTY},n.EMPTY=new n(0,0,0,0),n}(),zg=function(n,e){return CA.fromClientRect(n,e.getBoundingClientRect())},y6=function(n){var e=n.body,t=n.documentElement;if(!e||!t)throw new Error("Unable to get document size");var r=Math.max(Math.max(e.scrollWidth,t.scrollWidth),Math.max(e.offsetWidth,t.offsetWidth),Math.max(e.clientWidth,t.clientWidth)),o=Math.max(Math.max(e.scrollHeight,t.scrollHeight),Math.max(e.offsetHeight,t.offsetHeight),Math.max(e.clientHeight,t.clientHeight));return new CA(0,0,r,o)},Cg=function(n){for(var e=[],t=0,r=n.length;t<r;){var o=n.charCodeAt(t++);if(o>=55296&&o<=56319&&t<r){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),t--)}else e.push(o)}return e},Co=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],o=-1,s="";++o<t;){var i=n[o];i<=65535?r.push(i):(i-=65536,r.push((i>>10)+55296,i%1024+56320)),(o+1===t||r.length>16384)&&(s+=String.fromCharCode.apply(String,r),r.length=0)}return s},ly="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_6=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var bf=0;bf<ly.length;bf++)_6[ly.charCodeAt(bf)]=bf;var dy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",mu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var xf=0;xf<dy.length;xf++)mu[dy.charCodeAt(xf)]=xf;var b6=function(n){var e=n.length*.75,t=n.length,r,o=0,s,i,a,A;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),c=Array.isArray(d)?d:new Uint8Array(d);for(r=0;r<t;r+=4)s=mu[n.charCodeAt(r)],i=mu[n.charCodeAt(r+1)],a=mu[n.charCodeAt(r+2)],A=mu[n.charCodeAt(r+3)],c[o++]=s<<2|i>>4,c[o++]=(i&15)<<4|a>>2,c[o++]=(a&3)<<6|A&63;return d},x6=function(n){for(var e=n.length,t=[],r=0;r<e;r+=2)t.push(n[r+1]<<8|n[r]);return t},B6=function(n){for(var e=n.length,t=[],r=0;r<e;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},Yl=5,q1=11,Lv=2,z6=q1-Yl,Wx=65536>>Yl,C6=1<<Yl,Pv=C6-1,S6=1024>>Yl,E6=Wx+S6,F6=E6,I6=32,U6=F6+I6,Q6=65536>>q1,T6=1<<z6,L6=T6-1,cy=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},P6=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},k6=function(n,e){var t=b6(n),r=Array.isArray(t)?B6(t):new Uint32Array(t),o=Array.isArray(t)?x6(t):new Uint16Array(t),s=24,i=cy(o,s/2,r[4]/2),a=r[5]===2?cy(o,(s+r[4])/2):P6(r,Math.ceil((s+r[4])/4));return new O6(r[0],r[1],r[2],r[3],i,a)},O6=function(){function n(e,t,r,o,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=o,this.index=s,this.data=i}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Yl],t=(t<<Lv)+(e&Pv),this.data[t];if(e<=65535)return t=this.index[Wx+(e-55296>>Yl)],t=(t<<Lv)+(e&Pv),this.data[t];if(e<this.highStart)return t=U6-Q6+(e>>q1),t=this.index[t],t+=e>>Yl&L6,t=this.index[t],t=(t<<Lv)+(e&Pv),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),uy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",D6=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Bf=0;Bf<uy.length;Bf++)D6[uy.charCodeAt(Bf)]=Bf;var N6="KwAAAAAAAAAACA4AUD0AADAgAAACAAAAAAAIABAAGABAAEgAUABYAGAAaABgAGgAYgBqAF8AZwBgAGgAcQB5AHUAfQCFAI0AlQCdAKIAqgCyALoAYABoAGAAaABgAGgAwgDKAGAAaADGAM4A0wDbAOEA6QDxAPkAAQEJAQ8BFwF1AH0AHAEkASwBNAE6AUIBQQFJAVEBWQFhAWgBcAF4ATAAgAGGAY4BlQGXAZ8BpwGvAbUBvQHFAc0B0wHbAeMB6wHxAfkBAQIJAvEBEQIZAiECKQIxAjgCQAJGAk4CVgJeAmQCbAJ0AnwCgQKJApECmQKgAqgCsAK4ArwCxAIwAMwC0wLbAjAA4wLrAvMC+AIAAwcDDwMwABcDHQMlAy0DNQN1AD0DQQNJA0kDSQNRA1EDVwNZA1kDdQB1AGEDdQBpA20DdQN1AHsDdQCBA4kDkQN1AHUAmQOhA3UAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AKYDrgN1AHUAtgO+A8YDzgPWAxcD3gPjA+sD8wN1AHUA+wMDBAkEdQANBBUEHQQlBCoEFwMyBDgEYABABBcDSARQBFgEYARoBDAAcAQzAXgEgASIBJAEdQCXBHUAnwSnBK4EtgS6BMIEyAR1AHUAdQB1AHUAdQCVANAEYABgAGAAYABgAGAAYABgANgEYADcBOQEYADsBPQE/AQEBQwFFAUcBSQFLAU0BWQEPAVEBUsFUwVbBWAAYgVgAGoFcgV6BYIFigWRBWAAmQWfBaYFYABgAGAAYABgAKoFYACxBbAFuQW6BcEFwQXHBcEFwQXPBdMF2wXjBeoF8gX6BQIGCgYSBhoGIgYqBjIGOgZgAD4GRgZMBmAAUwZaBmAAYABgAGAAYABgAGAAYABgAGAAYABgAGIGYABpBnAGYABgAGAAYABgAGAAYABgAGAAYAB4Bn8GhQZgAGAAYAB1AHcDFQSLBmAAYABgAJMGdQA9A3UAmwajBqsGqwaVALMGuwbDBjAAywbSBtIG1QbSBtIG0gbSBtIG0gbdBuMG6wbzBvsGAwcLBxMHAwcbByMHJwcsBywHMQcsB9IGOAdAB0gHTgfSBkgHVgfSBtIG0gbSBtIG0gbSBtIG0gbSBiwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdgAGAALAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAdbB2MHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB2kH0gZwB64EdQB1AHUAdQB1AHUAdQB1AHUHfQdgAIUHjQd1AHUAlQedB2AAYAClB6sHYACzB7YHvgfGB3UAzgfWBzMB3gfmB1EB7gf1B/0HlQENAQUIDQh1ABUIHQglCBcDLQg1CD0IRQhNCEEDUwh1AHUAdQBbCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIaQhjCGQIZQhmCGcIaAhpCGMIZAhlCGYIZwhoCGkIYwhkCGUIZghnCGgIcAh3CHoIMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIgggwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAALAcsBywHLAcsBywHLAcsBywHLAcsB4oILAcsB44I0gaWCJ4Ipgh1AHUAqgiyCHUAdQB1AHUAdQB1AHUAdQB1AHUAtwh8AXUAvwh1AMUIyQjRCNkI4AjoCHUAdQB1AO4I9gj+CAYJDgkTCS0HGwkjCYIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiCCIIIggiAAIAAAAFAAYABgAGIAXwBgAHEAdQBFAJUAogCyAKAAYABgAEIA4ABGANMA4QDxAMEBDwE1AFwBLAE6AQEBUQF4QkhCmEKoQrhCgAHIQsAB0MLAAcABwAHAAeDC6ABoAHDCwMMAAcABwAHAAdDDGMMAAcAB6MM4wwjDWMNow3jDaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAGgAaABoAEjDqABWw6bDqABpg6gAaABoAHcDvwOPA+gAaABfA/8DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DvwO/A78DpcPAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcAB9cPKwkyCToJMAB1AHUAdQBCCUoJTQl1AFUJXAljCWcJawkwADAAMAAwAHMJdQB2CX4JdQCECYoJjgmWCXUAngkwAGAAYABxAHUApgn3A64JtAl1ALkJdQDACTAAMAAwADAAdQB1AHUAdQB1AHUAdQB1AHUAowYNBMUIMAAwADAAMADICcsJ0wnZCRUE4QkwAOkJ8An4CTAAMAB1AAAKvwh1AAgKDwoXCh8KdQAwACcKLgp1ADYKqAmICT4KRgowADAAdQB1AE4KMAB1AFYKdQBeCnUAZQowADAAMAAwADAAMAAwADAAMAAVBHUAbQowADAAdQC5CXUKMAAwAHwBxAijBogEMgF9CoQKiASMCpQKmgqIBKIKqgquCogEDQG2Cr4KxgrLCjAAMADTCtsKCgHjCusK8Qr5CgELMAAwADAAMAB1AIsECQsRC3UANAEZCzAAMAAwADAAMAB1ACELKQswAHUANAExCzkLdQBBC0kLMABRC1kLMAAwADAAMAAwADAAdQBhCzAAMAAwAGAAYABpC3ELdwt/CzAAMACHC4sLkwubC58Lpwt1AK4Ltgt1APsDMAAwADAAMAAwADAAMAAwAL4LwwvLC9IL1wvdCzAAMADlC+kL8Qv5C/8LSQswADAAMAAwADAAMAAwADAAMAAHDDAAMAAwADAAMAAODBYMHgx1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1ACYMMAAwADAAdQB1AHUALgx1AHUAdQB1AHUAdQA2DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AD4MdQBGDHUAdQB1AHUAdQB1AEkMdQB1AHUAdQB1AFAMMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQBYDHUAdQB1AF8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUA+wMVBGcMMAAwAHwBbwx1AHcMfwyHDI8MMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAYABgAJcMMAAwADAAdQB1AJ8MlQClDDAAMACtDCwHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsB7UMLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHdQB1AHUAdQB1AHUAdQB1AHUAdQB1AHUAdQB1AA0EMAC9DDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAsBywHLAcsBywHLAcsBywHLQcwAMEMyAwsBywHLAcsBywHLAcsBywHLAcsBywHzAwwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwAHUAdQB1ANQM2QzhDDAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMABgAGAAYABgAGAAYABgAOkMYADxDGAA+AwADQYNYABhCWAAYAAODTAAMAAwADAAFg1gAGAAHg37AzAAMAAwADAAYABgACYNYAAsDTQNPA1gAEMNPg1LDWAAYABgAGAAYABgAGAAYABgAGAAUg1aDYsGVglhDV0NcQBnDW0NdQ15DWAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAlQCBDZUAiA2PDZcNMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAnw2nDTAAMAAwADAAMAAwAHUArw23DTAAMAAwADAAMAAwADAAMAAwADAAMAB1AL8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAB1AHUAdQB1AHUAdQDHDTAAYABgAM8NMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA1w11ANwNMAAwAD0B5A0wADAAMAAwADAAMADsDfQN/A0EDgwOFA4wABsOMAAwADAAMAAwADAAMAAwANIG0gbSBtIG0gbSBtIG0gYjDigOwQUuDsEFMw7SBjoO0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGQg5KDlIOVg7SBtIGXg5lDm0OdQ7SBtIGfQ6EDooOjQ6UDtIGmg6hDtIG0gaoDqwO0ga0DrwO0gZgAGAAYADEDmAAYAAkBtIGzA5gANIOYADaDokO0gbSBt8O5w7SBu8O0gb1DvwO0gZgAGAAxA7SBtIG0gbSBtIGYABgAGAAYAAED2AAsAUMD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHJA8sBywHLAcsBywHLAccDywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywPLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAc0D9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAccD9IG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIGFA8sBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHLAcsBywHPA/SBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gbSBtIG0gYUD0QPlQCVAJUAMAAwADAAMACVAJUAlQCVAJUAlQCVAEwPMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAA//8EAAQABAAEAAQABAAEAAQABAANAAMAAQABAAIABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQACgATABcAHgAbABoAHgAXABYAEgAeABsAGAAPABgAHABLAEsASwBLAEsASwBLAEsASwBLABgAGAAeAB4AHgATAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABYAGwASAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWAA0AEQAeAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAFAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJABYAGgAbABsAGwAeAB0AHQAeAE8AFwAeAA0AHgAeABoAGwBPAE8ADgBQAB0AHQAdAE8ATwAXAE8ATwBPABYAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AHgAeAFAATwBAAE8ATwBPAEAATwBQAFAATwBQAB4AHgAeAB4AHgAeAB0AHQAdAB0AHgAdAB4ADgBQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgBQAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAJAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAkACQAJAAkACQAJAAkABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAFAAHgAeAB4AKwArAFAAUABQAFAAGABQACsAKwArACsAHgAeAFAAHgBQAFAAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUAAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAYAA0AKwArAB4AHgAbACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAB4ABAAEAB4ABAAEABMABAArACsAKwArACsAKwArACsAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAKwArACsAKwBWAFYAVgBWAB4AHgArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AGgAaABoAGAAYAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQAEwAEACsAEwATAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABLAEsASwBLAEsASwBLAEsASwBLABoAGQAZAB4AUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQABMAUAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABABQAFAABAAEAB4ABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUAAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAFAABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQAUABQAB4AHgAYABMAUAArACsABAAbABsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAFAABAAEAAQABAAEAFAABAAEAAQAUAAEAAQABAAEAAQAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArACsAHgArAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAUAAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEAA0ADQBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUAArACsAKwBQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABABQACsAKwArACsAKwArACsAKwAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUAAaABoAUABQAFAAUABQAEwAHgAbAFAAHgAEACsAKwAEAAQABAArAFAAUABQAFAAUABQACsAKwArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQACsAUABQACsAKwAEACsABAAEAAQABAAEACsAKwArACsABAAEACsAKwAEAAQABAArACsAKwAEACsAKwArACsAKwArACsAUABQAFAAUAArAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLAAQABABQAFAAUAAEAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsAKwAEAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAArACsAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AGwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAKwArACsAKwArAAQABAAEACsAKwArACsAUABQACsAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAAQAUAArAFAAUABQAFAAUABQACsAKwArAFAAUABQACsAUABQAFAAUAArACsAKwBQAFAAKwBQACsAUABQACsAKwArAFAAUAArACsAKwBQAFAAUAArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArAAQABAAEAAQABAArACsAKwAEAAQABAArAAQABAAEAAQAKwArAFAAKwArACsAKwArACsABAArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAHgAeAB4AHgAeAB4AGwAeACsAKwArACsAKwAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAUABQAFAAKwArACsAKwArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwAOAFAAUABQAFAAUABQAFAAHgBQAAQABAAEAA4AUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAKwArAAQAUAAEAAQABAAEAAQABAAEACsABAAEAAQAKwAEAAQABAAEACsAKwArACsAKwArACsABAAEACsAKwArACsAKwArACsAUAArAFAAUAAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAFAABAAEAAQABAAEAAQABAArAAQABAAEACsABAAEAAQABABQAB4AKwArACsAKwBQAFAAUAAEAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQABoAUABQAFAAUABQAFAAKwAEAAQABAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQACsAUAArACsAUABQAFAAUABQAFAAUAArACsAKwAEACsAKwArACsABAAEAAQABAAEAAQAKwAEACsABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArAAQABAAeACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAXAAqACoAKgAqACoAKgAqACsAKwArACsAGwBcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAeAEsASwBLAEsASwBLAEsASwBLAEsADQANACsAKwArACsAKwBcAFwAKwBcACsAXABcAFwAXABcACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAXAArAFwAXABcAFwAXABcAFwAXABcAFwAKgBcAFwAKgAqACoAKgAqACoAKgAqACoAXAArACsAXABcAFwAXABcACsAXAArACoAKgAqACoAKgAqACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwBcAFwAXABcAFAADgAOAA4ADgAeAA4ADgAJAA4ADgANAAkAEwATABMAEwATAAkAHgATAB4AHgAeAAQABAAeAB4AHgAeAB4AHgBLAEsASwBLAEsASwBLAEsASwBLAFAAUABQAFAAUABQAFAAUABQAFAADQAEAB4ABAAeAAQAFgARABYAEQAEAAQAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQADQAEAAQABAAEAAQADQAEAAQAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAA0ADQAeAB4AHgAeAB4AHgAEAB4AHgAeAB4AHgAeACsAHgAeAA4ADgANAA4AHgAeAB4AHgAeAAkACQArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgBcAEsASwBLAEsASwBLAEsASwBLAEsADQANAB4AHgAeAB4AXABcAFwAXABcAFwAKgAqACoAKgBcAFwAXABcACoAKgAqAFwAKgAqACoAXABcACoAKgAqACoAKgAqACoAXABcAFwAKgAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKgAqAFwAKgBLAEsASwBLAEsASwBLAEsASwBLACoAKgAqACoAKgAqAFAAUABQAFAAUABQACsAUAArACsAKwArACsAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAKwBQACsAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsABAAEAAQAHgANAB4AHgAeAB4AHgAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUAArACsADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAWABEAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQANAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAANAA0AKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUAArAAQABAArACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqAA0ADQAVAFwADQAeAA0AGwBcACoAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwAeAB4AEwATAA0ADQAOAB4AEwATAB4ABAAEAAQACQArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAHgArACsAKwATABMASwBLAEsASwBLAEsASwBLAEsASwBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAXABcAFwAXABcACsAKwArACsAKwArACsAKwArACsAKwBcAFwAXABcAFwAXABcAFwAXABcAFwAXAArACsAKwArAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAXAArACsAKwAqACoAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAArACsAHgAeAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcACoAKgAqACoAKgAqACoAKgAqACoAKwAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKwArAAQASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACoAKgAqACoAKgAqACoAXAAqACoAKgAqACoAKgArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABABQAFAAUABQAFAAUABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwANAA0AHgANAA0ADQANAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAEAAQABAAEAAQAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwAeAB4AHgAeAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArAA0ADQANAA0ADQBLAEsASwBLAEsASwBLAEsASwBLACsAKwArAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAA0ADQBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUAAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArAAQABAAEAB4ABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAAQAUABQAFAAUABQAFAABABQAFAABAAEAAQAUAArACsAKwArACsABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQACsAUAArAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAFAAUABQACsAHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQACsAKwAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQACsAHgAeAB4AHgAeAB4AHgAOAB4AKwANAA0ADQANAA0ADQANAAkADQANAA0ACAAEAAsABAAEAA0ACQANAA0ADAAdAB0AHgAXABcAFgAXABcAFwAWABcAHQAdAB4AHgAUABQAFAANAAEAAQAEAAQABAAEAAQACQAaABoAGgAaABoAGgAaABoAHgAXABcAHQAVABUAHgAeAB4AHgAeAB4AGAAWABEAFQAVABUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ADQAeAA0ADQANAA0AHgANAA0ADQAHAB4AHgAeAB4AKwAEAAQABAAEAAQABAAEAAQABAAEAFAAUAArACsATwBQAFAAUABQAFAAHgAeAB4AFgARAE8AUABPAE8ATwBPAFAAUABQAFAAUAAeAB4AHgAWABEAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArABsAGwAbABsAGwAbABsAGgAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGgAbABsAGwAbABoAGwAbABoAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbABsAGwAbAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAHgAeAFAAGgAeAB0AHgBQAB4AGgAeAB4AHgAeAB4AHgAeAB4AHgBPAB4AUAAbAB4AHgBQAFAAUABQAFAAHgAeAB4AHQAdAB4AUAAeAFAAHgBQAB4AUABPAFAAUAAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAHgBQAFAAUABQAE8ATwBQAFAAUABQAFAATwBQAFAATwBQAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAUABQAFAATwBPAE8ATwBPAE8ATwBPAE8ATwBQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABPAB4AHgArACsAKwArAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHQAdAB4AHgAeAB0AHQAeAB4AHQAeAB4AHgAdAB4AHQAbABsAHgAdAB4AHgAeAB4AHQAeAB4AHQAdAB0AHQAeAB4AHQAeAB0AHgAdAB0AHQAdAB0AHQAeAB0AHgAeAB4AHgAeAB0AHQAdAB0AHgAeAB4AHgAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB4AHgAeAB0AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAeAB0AHQAdAB0AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAdAB4AHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAWABEAHgAeAB4AHgAeAB4AHQAeAB4AHgAeAB4AHgAeACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAWABEAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAFAAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAeAB4AHQAdAB0AHQAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB0AHQAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB0AHQAeAB4AHQAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AHQAdAB0AHgAeAB0AHgAeAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlAB4AHQAdAB4AHgAdAB4AHgAeAB4AHQAdAB4AHgAeAB4AJQAlAB0AHQAlAB4AJQAlACUAIAAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAeAB4AHgAeAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHgAdAB0AHQAeAB0AJQAdAB0AHgAdAB0AHgAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHQAdAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAdAB0AHQAdACUAHgAlACUAJQAdACUAJQAdAB0AHQAlACUAHQAdACUAHQAdACUAJQAlAB4AHQAeAB4AHgAeAB0AHQAlAB0AHQAdAB0AHQAdACUAJQAlACUAJQAdACUAJQAgACUAHQAdACUAJQAlACUAJQAlACUAJQAeAB4AHgAlACUAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB0AHgAeAB4AFwAXABcAFwAXABcAHgATABMAJQAeAB4AHgAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARABYAEQAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAWABEAFgARABYAEQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAWABEAFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AFgARAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAdAB0AHQAdAB0AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAFAAUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAEAAQABAAeAB4AKwArACsAKwArABMADQANAA0AUAATAA0AUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUAANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAA0ADQANAA0ADQANAA0ADQAeAA0AFgANAB4AHgAXABcAHgAeABcAFwAWABEAFgARABYAEQAWABEADQANAA0ADQATAFAADQANAB4ADQANAB4AHgAeAB4AHgAMAAwADQANAA0AHgANAA0AFgANAA0ADQANAA0ADQANAA0AHgANAB4ADQANAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArACsAKwArACsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArAA0AEQARACUAJQBHAFcAVwAWABEAFgARABYAEQAWABEAFgARACUAJQAWABEAFgARABYAEQAWABEAFQAWABEAEQAlAFcAVwBXAFcAVwBXAFcAVwBXAAQABAAEAAQABAAEACUAVwBXAFcAVwA2ACUAJQBXAFcAVwBHAEcAJQAlACUAKwBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBRAFcAUQBXAFEAVwBXAFcAVwBXAFcAUQBXAFcAVwBXAFcAVwBRAFEAKwArAAQABAAVABUARwBHAFcAFQBRAFcAUQBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFEAVwBRAFcAUQBXAFcAVwBXAFcAVwBRAFcAVwBXAFcAVwBXAFEAUQBXAFcAVwBXABUAUQBHAEcAVwArACsAKwArACsAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwAlACUAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACsAKwArACsAKwArACsAKwArACsAKwArAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAUQBRAFEAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBPAE8ATwBPAE8ATwBPAE8AJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADQATAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABLAEsASwBLAEsASwBLAEsASwBLAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAABAAEAAQABAAeAAQABAAEAAQABAAEAAQABAAEAAQAHgBQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUABQAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAeAA0ADQANAA0ADQArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AUAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAB4AHgAeAB4AHgAeAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AUABQAFAAUABQAFAAUABQAFAAUABQAAQAUABQAFAABABQAFAAUABQAAQAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAeAB4AHgAeAAQAKwArACsAUABQAFAAUABQAFAAHgAeABoAHgArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAADgAOABMAEwArACsAKwArACsAKwArACsABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwANAA0ASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUAAeAB4AHgBQAA4AUABQAAQAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArAB4AWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYAFgAWABYACsAKwArAAQAHgAeAB4AHgAeAB4ADQANAA0AHgAeAB4AHgArAFAASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArAB4AHgBcAFwAXABcAFwAKgBcAFwAXABcAFwAXABcAFwAXABcAEsASwBLAEsASwBLAEsASwBLAEsAXABcAFwAXABcACsAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAFAAUABQAAQAUABQAFAAUABQAFAAUABQAAQABAArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAHgANAA0ADQBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKgAqACoAXAAqACoAKgBcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXAAqAFwAKgAqACoAXABcACoAKgBcAFwAXABcAFwAKgAqAFwAKgBcACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFwAXABcACoAKgBQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAA0ADQBQAFAAUAAEAAQAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQADQAEAAQAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAVABVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBUAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVAFUAVQBVACsAKwArACsAKwArACsAKwArACsAKwArAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAWQBZAFkAKwArACsAKwBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAWgBaAFoAKwArACsAKwAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYABgAGAAYAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAKwArACsAKwArAFYABABWAFYAVgBWAFYAVgBWAFYAVgBWAB4AVgBWAFYAVgBWAFYAVgBWAFYAVgBWAFYAVgArAFYAVgBWAFYAVgArAFYAKwBWAFYAKwBWAFYAKwBWAFYAVgBWAFYAVgBWAFYAVgBWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAEQAWAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAaAB4AKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAGAARABEAGAAYABMAEwAWABEAFAArACsAKwArACsAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACUAJQAlACUAJQAWABEAFgARABYAEQAWABEAFgARABYAEQAlACUAFgARACUAJQAlACUAJQAlACUAEQAlABEAKwAVABUAEwATACUAFgARABYAEQAWABEAJQAlACUAJQAlACUAJQAlACsAJQAbABoAJQArACsAKwArAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAcAKwATACUAJQAbABoAJQAlABYAEQAlACUAEQAlABEAJQBXAFcAVwBXAFcAVwBXAFcAVwBXABUAFQAlACUAJQATACUAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXABYAJQARACUAJQAlAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAWACUAEQAlABYAEQARABYAEQARABUAVwBRAFEAUQBRAFEAUQBRAFEAUQBRAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAEcARwArACsAVwBXAFcAVwBXAFcAKwArAFcAVwBXAFcAVwBXACsAKwBXAFcAVwBXAFcAVwArACsAVwBXAFcAKwArACsAGgAbACUAJQAlABsAGwArAB4AHgAeAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwAEAAQABAAQAB0AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsADQANAA0AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAA0AUABQAFAAUAArACsAKwArAFAAUABQAFAAUABQAFAAUAANAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwArAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwBQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwANAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAB4AUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAUABQAFAAUABQAAQABAAEACsABAAEACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAKwBQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAA0ADQANAA0ADQANAA0ADQAeACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAArACsAKwArAFAAUABQAFAAUAANAA0ADQANAA0ADQAUACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsADQANAA0ADQANAA0ADQBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAB4AHgAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArAAQABAANACsAKwBQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAB4AHgAeAB4AHgArACsAKwArACsAKwAEAAQABAAEAAQABAAEAA0ADQAeAB4AHgAeAB4AKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwAeACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEACsASwBLAEsASwBLAEsASwBLAEsASwANAA0ADQANAFAABAAEAFAAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAeAA4AUAArACsAKwArACsAKwArACsAKwAEAFAAUABQAFAADQANAB4ADQAEAAQABAAEAB4ABAAEAEsASwBLAEsASwBLAEsASwBLAEsAUAAOAFAADQANAA0AKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAANAA0AHgANAA0AHgAEACsAUABQAFAAUABQAFAAUAArAFAAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAA0AKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsABAAEAAQABAArAFAAUABQAFAAUABQAFAAUAArACsAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQACsABAAEAFAABAAEAAQABAAEAAQABAArACsABAAEACsAKwAEAAQABAArACsAUAArACsAKwArACsAKwAEACsAKwArACsAKwBQAFAAUABQAFAABAAEACsAKwAEAAQABAAEAAQABAAEACsAKwArAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsABAAEAAQABAAEAAQABABQAFAAUABQAA0ADQANAA0AHgBLAEsASwBLAEsASwBLAEsASwBLAA0ADQArAB4ABABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAFAAUAAeAFAAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABAAEAAQADgANAA0AEwATAB4AHgAeAA0ADQANAA0ADQANAA0ADQANAA0ADQANAA0ADQANAFAAUABQAFAABAAEACsAKwAEAA0ADQAeAFAAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAFAAKwArACsAKwArACsAKwBLAEsASwBLAEsASwBLAEsASwBLACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAXABcAFwAKwArACoAKgAqACoAKgAqACoAKgAqACoAKgAqACoAKgAqACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBcAFwADQANAA0AKgBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAKwArAFAAKwArAFAAUABQAFAAUABQAFAAUAArAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQAKwAEAAQAKwArAAQABAAEAAQAUAAEAFAABAAEAA0ADQANACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAArACsABAAEAAQABAAEAAQABABQAA4AUAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAABAAEAAQABAAEAAQABAAEAAQABABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAFAABAAEAAQABAAOAB4ADQANAA0ADQAOAB4ABAArACsAKwArACsAKwArACsAUAAEAAQABAAEAAQABAAEAAQABAAEAAQAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAA0ADQANAFAADgAOAA4ADQANACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAEAAQABAAEACsABAAEAAQABAAEAAQABAAEAFAADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAOABMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQACsAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAArACsAKwAEACsABAAEACsABAAEAAQABAAEAAQABABQAAQAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAUABQAFAAUABQAFAAKwBQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAUAArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAABAAEAAQABAAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAaABoAGgAaAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArAA0AUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsADQANAA0ADQANACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABIAEgAQwBDAEMAUABQAFAAUABDAFAAUABQAEgAQwBIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAASABDAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwAJAAkACQAJAAkACQAJABYAEQArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABIAEMAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwANAA0AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArAAQABAAEAAQABAANACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEAA0ADQANAB4AHgAeAB4AHgAeAFAAUABQAFAADQAeACsAKwArACsAKwArACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAANAA0AHgAeACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwAEAFAABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwAEAAQABAAEAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAARwBHABUARwAJACsAKwArACsAKwArACsAKwArACsAKwAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUQBRAFEAKwArACsAKwArACsAKwArACsAKwArACsAKwBRAFEAUQBRACsAKwArACsAKwArACsAKwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUAArACsAHgAEAAQADQAEAAQABAAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAAQABAAEAAQABAAeAB4AHgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAB4AHgAEAAQABAAEAAQABAAEAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4ABAAEAAQAHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwArACsAKwArACsAKwArACsAKwArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAKwArAFAAKwArAFAAUAArACsAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACsAUAArAFAAUABQAFAAUABQAFAAKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwBQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAHgAeAFAAUABQAFAAUAArAFAAKwArACsAUABQAFAAUABQAFAAUAArAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAB4AHgAeAB4AHgAeAB4AHgAeACsAKwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAEsASwBLAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAeAB4AHgAeAB4AHgAeAB4ABAAeAB4AHgAeAB4AHgAeAB4AHgAeAAQAHgAeAA0ADQANAA0AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQAKwAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArAAQABAAEAAQABAAEAAQAKwAEAAQAKwAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwAEAAQABAAEAAQABAAEAFAAUABQAFAAUABQAFAAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwBQAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArABsAUABQAFAAUABQACsAKwBQAFAAUABQAFAAUABQAFAAUAAEAAQABAAEAAQABAAEACsAKwArACsAKwArACsAKwArAB4AHgAeAB4ABAAEAAQABAAEAAQABABQACsAKwArACsASwBLAEsASwBLAEsASwBLAEsASwArACsAKwArABYAFgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAGgBQAFAAUAAaAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAeAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQACsAKwBQAFAAUABQACsAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUAArACsAKwArACsAKwBQACsAKwArACsAUAArAFAAKwBQACsAUABQAFAAKwBQAFAAKwBQACsAKwBQACsAUAArAFAAKwBQACsAUAArAFAAUAArAFAAKwArAFAAUABQAFAAKwBQAFAAUABQAFAAUABQACsAUABQAFAAUAArAFAAUABQAFAAKwBQACsAUABQAFAAUABQAFAAUABQAFAAUAArAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAArACsAKwArACsAUABQAFAAKwBQAFAAUABQAFAAKwBQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwAeAB4AKwArACsAKwArACsAKwArACsAKwArACsAKwArAE8ATwBPAE8ATwBPAE8ATwBPAE8ATwBPAE8AJQAlACUAHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHgAeAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB4AHgAeACUAJQAlAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAdAB0AHQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAKQApACkAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAlACUAJQAlACUAHgAlACUAJQAlACUAIAAgACAAJQAlACAAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACEAIQAhACEAIQAlACUAIAAgACUAJQAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlACUAIAAlACUAJQAlACAAIAAgACUAIAAgACAAJQAlACUAJQAlACUAJQAgACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAlAB4AJQAeACUAJQAlACUAJQAgACUAJQAlACUAHgAlAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAgACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACAAIAAgACAAIAAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeABcAFwAXABUAFQAVAB4AHgAeAB4AJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAgACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlACUAJQAeAB4AHgAeAB4AHgAeAB4AHgAeACUAJQAlACUAJQAlAB4AHgAeAB4AHgAeAB4AHgAlACUAJQAlACUAJQAlACUAHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAgACUAJQAgACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAJQAlACUAJQAlACUAIAAlACUAJQAlACUAJQAlACUAJQAgACAAIAAgACAAIAAgACAAIAAgACUAJQAgACAAIAAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACAAIAAlACAAIAAlACAAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAgACAAIAAlACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAJQAlAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AKwAeAB4AHgAeAB4AHgAeAB4AHgAeAB4AHgArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAEsASwBLAEsASwBLAEsASwBLAEsAKwArACsAKwArACsAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwArAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwAlACUAJQAlACUAJQAlACUAJQAlACUAVwBXACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQBXAFcAVwBXAFcAVwBXAFcAVwBXAFcAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAJQAlACUAKwAEACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArACsAKwArAA==",hy=50,M6=1,Xx=2,Yx=3,H6=4,j6=5,fy=7,Jx=8,py=9,sl=10,rm=11,gy=12,nm=13,R6=14,wu=15,om=16,zf=17,au=18,q6=19,vy=20,sm=21,Au=22,kv=23,Nd=24,vi=25,yu=26,_u=27,Md=28,K6=29,Ol=30,$6=31,Cf=32,Sf=33,im=34,am=35,Am=36,rh=37,lm=38,op=39,sp=40,Ov=41,Zx=42,V6=43,G6=[9001,65288],eB="!",nn="",Ef="",dm=k6(N6),aA=[Ol,Am],cm=[M6,Xx,Yx,j6],tB=[sl,Jx],my=[_u,yu],W6=cm.concat(tB),wy=[lm,op,sp,im,am],X6=[wu,nm],Y6=function(n,e){e===void 0&&(e="strict");var t=[],r=[],o=[];return n.forEach(function(s,i){var a=dm.get(s);if(a>hy?(o.push(!0),a-=hy):o.push(!1),["normal","auto","loose"].indexOf(e)!==-1&&[8208,8211,12316,12448].indexOf(s)!==-1)return r.push(i),t.push(om);if(a===H6||a===rm){if(i===0)return r.push(i),t.push(Ol);var A=t[i-1];return W6.indexOf(A)===-1?(r.push(r[i-1]),t.push(A)):(r.push(i),t.push(Ol))}if(r.push(i),a===$6)return t.push(e==="strict"?sm:rh);if(a===Zx||a===K6)return t.push(Ol);if(a===V6)return s>=131072&&s<=196605||s>=196608&&s<=262141?t.push(rh):t.push(Ol);t.push(a)}),[r,t,o]},Dv=function(n,e,t,r){var o=r[t];if(Array.isArray(n)?n.indexOf(o)!==-1:n===o)for(var s=t;s<=r.length;){s++;var i=r[s];if(i===e)return!0;if(i!==sl)break}if(o===sl)for(var s=t;s>0;){s--;var a=r[s];if(Array.isArray(n)?n.indexOf(a)!==-1:n===a)for(var A=t;A<=r.length;){A++;var i=r[A];if(i===e)return!0;if(i!==sl)break}if(a!==sl)break}return!1},yy=function(n,e){for(var t=n;t>=0;){var r=e[t];if(r===sl)t--;else return r}return 0},J6=function(n,e,t,r,o){if(t[r]===0)return nn;var s=r-1;if(Array.isArray(o)&&o[s]===!0)return nn;var i=s-1,a=s+1,A=e[s],d=i>=0?e[i]:0,c=e[a];if(A===Xx&&c===Yx)return nn;if(cm.indexOf(A)!==-1)return eB;if(cm.indexOf(c)!==-1||tB.indexOf(c)!==-1)return nn;if(yy(s,e)===Jx)return Ef;if(dm.get(n[s])===rm||(A===Cf||A===Sf)&&dm.get(n[a])===rm||A===fy||c===fy||A===py||[sl,nm,wu].indexOf(A)===-1&&c===py||[zf,au,q6,Nd,Md].indexOf(c)!==-1||yy(s,e)===Au||Dv(kv,Au,s,e)||Dv([zf,au],sm,s,e)||Dv(gy,gy,s,e))return nn;if(A===sl)return Ef;if(A===kv||c===kv)return nn;if(c===om||A===om)return Ef;if([nm,wu,sm].indexOf(c)!==-1||A===R6||d===Am&&X6.indexOf(A)!==-1||A===Md&&c===Am||c===vy||aA.indexOf(c)!==-1&&A===vi||aA.indexOf(A)!==-1&&c===vi||A===_u&&[rh,Cf,Sf].indexOf(c)!==-1||[rh,Cf,Sf].indexOf(A)!==-1&&c===yu||aA.indexOf(A)!==-1&&my.indexOf(c)!==-1||my.indexOf(A)!==-1&&aA.indexOf(c)!==-1||[_u,yu].indexOf(A)!==-1&&(c===vi||[Au,wu].indexOf(c)!==-1&&e[a+1]===vi)||[Au,wu].indexOf(A)!==-1&&c===vi||A===vi&&[vi,Md,Nd].indexOf(c)!==-1)return nn;if([vi,Md,Nd,zf,au].indexOf(c)!==-1)for(var u=s;u>=0;){var h=e[u];if(h===vi)return nn;if([Md,Nd].indexOf(h)!==-1)u--;else break}if([_u,yu].indexOf(c)!==-1)for(var u=[zf,au].indexOf(A)!==-1?i:s;u>=0;){var h=e[u];if(h===vi)return nn;if([Md,Nd].indexOf(h)!==-1)u--;else break}if(lm===A&&[lm,op,im,am].indexOf(c)!==-1||[op,im].indexOf(A)!==-1&&[op,sp].indexOf(c)!==-1||[sp,am].indexOf(A)!==-1&&c===sp||wy.indexOf(A)!==-1&&[vy,yu].indexOf(c)!==-1||wy.indexOf(c)!==-1&&A===_u||aA.indexOf(A)!==-1&&aA.indexOf(c)!==-1||A===Nd&&aA.indexOf(c)!==-1||aA.concat(vi).indexOf(A)!==-1&&c===Au&&G6.indexOf(n[a])===-1||aA.concat(vi).indexOf(c)!==-1&&A===au)return nn;if(A===Ov&&c===Ov){for(var p=t[s],v=1;p>0&&(p--,e[p]===Ov);)v++;if(v%2!==0)return nn}return A===Cf&&c===Sf?nn:Ef},Z6=function(n,e){e||(e={lineBreak:"normal",wordBreak:"normal"});var t=Y6(n,e.lineBreak),r=t[0],o=t[1],s=t[2];(e.wordBreak==="break-all"||e.wordBreak==="break-word")&&(o=o.map(function(a){return[vi,Ol,Zx].indexOf(a)!==-1?rh:a}));var i=e.wordBreak==="keep-all"?s.map(function(a,A){return a&&n[A]>=19968&&n[A]<=40959}):void 0;return[r,o,i]},eL=function(){function n(e,t,r,o){this.codePoints=e,this.required=t===eB,this.start=r,this.end=o}return n.prototype.slice=function(){return Co.apply(void 0,this.codePoints.slice(this.start,this.end))},n}(),tL=function(n,e){var t=Cg(n),r=Z6(t,e),o=r[0],s=r[1],i=r[2],a=t.length,A=0,d=0;return{next:function(){if(d>=a)return{done:!0,value:null};for(var c=nn;d<a&&(c=J6(t,s,o,++d,i))===nn;);if(c!==nn||d===a){var u=new eL(t,c,A,d);return A=d,{value:u,done:!1}}return{done:!0,value:null}}}},rL=1,nL=2,vh=4,_y=8,Op=10,by=47,Tu=92,oL=9,sL=32,Ff=34,lu=61,iL=35,aL=36,AL=37,If=39,Uf=40,du=41,lL=95,Ys=45,dL=33,cL=60,uL=62,hL=64,fL=91,pL=93,gL=61,vL=123,Qf=63,mL=125,xy=124,wL=126,yL=128,By=65533,Nv=42,Kl=43,_L=44,bL=58,xL=59,nh=46,BL=0,zL=8,CL=11,SL=14,EL=31,FL=127,za=-1,rB=48,nB=97,oB=101,IL=102,UL=117,QL=122,sB=65,iB=69,aB=70,TL=85,LL=90,Ss=function(n){return n>=rB&&n<=57},PL=function(n){return n>=55296&&n<=57343},Hd=function(n){return Ss(n)||n>=sB&&n<=aB||n>=nB&&n<=IL},kL=function(n){return n>=nB&&n<=QL},OL=function(n){return n>=sB&&n<=LL},DL=function(n){return kL(n)||OL(n)},NL=function(n){return n>=yL},Tf=function(n){return n===Op||n===oL||n===sL},Dp=function(n){return DL(n)||NL(n)||n===lL},zy=function(n){return Dp(n)||Ss(n)||n===Ys},ML=function(n){return n>=BL&&n<=zL||n===CL||n>=SL&&n<=EL||n===FL},tl=function(n,e){return n!==Tu?!1:e!==Op},Lf=function(n,e,t){return n===Ys?Dp(e)||tl(e,t):Dp(n)?!0:!!(n===Tu&&tl(n,e))},Mv=function(n,e,t){return n===Kl||n===Ys?Ss(e)?!0:e===nh&&Ss(t):Ss(n===nh?e:n)},HL=function(n){var e=0,t=1;(n[e]===Kl||n[e]===Ys)&&(n[e]===Ys&&(t=-1),e++);for(var r=[];Ss(n[e]);)r.push(n[e++]);var o=r.length?parseInt(Co.apply(void 0,r),10):0;n[e]===nh&&e++;for(var s=[];Ss(n[e]);)s.push(n[e++]);var i=s.length,a=i?parseInt(Co.apply(void 0,s),10):0;(n[e]===iB||n[e]===oB)&&e++;var A=1;(n[e]===Kl||n[e]===Ys)&&(n[e]===Ys&&(A=-1),e++);for(var d=[];Ss(n[e]);)d.push(n[e++]);var c=d.length?parseInt(Co.apply(void 0,d),10):0;return t*(o+a*Math.pow(10,-i))*Math.pow(10,A*c)},jL={type:2},RL={type:3},qL={type:4},KL={type:13},$L={type:8},VL={type:21},GL={type:9},WL={type:10},XL={type:11},YL={type:12},JL={type:14},Pf={type:23},ZL={type:1},eP={type:25},tP={type:24},rP={type:26},nP={type:27},oP={type:28},sP={type:29},iP={type:31},um={type:32},AB=function(){function n(){this._value=[]}return n.prototype.write=function(e){this._value=this._value.concat(Cg(e))},n.prototype.read=function(){for(var e=[],t=this.consumeToken();t!==um;)e.push(t),t=this.consumeToken();return e},n.prototype.consumeToken=function(){var e=this.consumeCodePoint();switch(e){case Ff:return this.consumeStringToken(Ff);case iL:var t=this.peekCodePoint(0),r=this.peekCodePoint(1),o=this.peekCodePoint(2);if(zy(t)||tl(r,o)){var s=Lf(t,r,o)?nL:rL,i=this.consumeName();return{type:5,value:i,flags:s}}break;case aL:if(this.peekCodePoint(0)===lu)return this.consumeCodePoint(),KL;break;case If:return this.consumeStringToken(If);case Uf:return jL;case du:return RL;case Nv:if(this.peekCodePoint(0)===lu)return this.consumeCodePoint(),JL;break;case Kl:if(Mv(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case _L:return qL;case Ys:var a=e,A=this.peekCodePoint(0),d=this.peekCodePoint(1);if(Mv(a,A,d))return this.reconsumeCodePoint(e),this.consumeNumericToken();if(Lf(a,A,d))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();if(A===Ys&&d===uL)return this.consumeCodePoint(),this.consumeCodePoint(),tP;break;case nh:if(Mv(e,this.peekCodePoint(0),this.peekCodePoint(1)))return this.reconsumeCodePoint(e),this.consumeNumericToken();break;case by:if(this.peekCodePoint(0)===Nv)for(this.consumeCodePoint();;){var c=this.consumeCodePoint();if(c===Nv&&(c=this.consumeCodePoint(),c===by))return this.consumeToken();if(c===za)return this.consumeToken()}break;case bL:return rP;case xL:return nP;case cL:if(this.peekCodePoint(0)===dL&&this.peekCodePoint(1)===Ys&&this.peekCodePoint(2)===Ys)return this.consumeCodePoint(),this.consumeCodePoint(),eP;break;case hL:var u=this.peekCodePoint(0),h=this.peekCodePoint(1),p=this.peekCodePoint(2);if(Lf(u,h,p)){var i=this.consumeName();return{type:7,value:i}}break;case fL:return oP;case Tu:if(tl(e,this.peekCodePoint(0)))return this.reconsumeCodePoint(e),this.consumeIdentLikeToken();break;case pL:return sP;case gL:if(this.peekCodePoint(0)===lu)return this.consumeCodePoint(),$L;break;case vL:return XL;case mL:return YL;case UL:case TL:var v=this.peekCodePoint(0),w=this.peekCodePoint(1);return v===Kl&&(Hd(w)||w===Qf)&&(this.consumeCodePoint(),this.consumeUnicodeRangeToken()),this.reconsumeCodePoint(e),this.consumeIdentLikeToken();case xy:if(this.peekCodePoint(0)===lu)return this.consumeCodePoint(),GL;if(this.peekCodePoint(0)===xy)return this.consumeCodePoint(),VL;break;case wL:if(this.peekCodePoint(0)===lu)return this.consumeCodePoint(),WL;break;case za:return um}return Tf(e)?(this.consumeWhiteSpace(),iP):Ss(e)?(this.reconsumeCodePoint(e),this.consumeNumericToken()):Dp(e)?(this.reconsumeCodePoint(e),this.consumeIdentLikeToken()):{type:6,value:Co(e)}},n.prototype.consumeCodePoint=function(){var e=this._value.shift();return typeof e>"u"?-1:e},n.prototype.reconsumeCodePoint=function(e){this._value.unshift(e)},n.prototype.peekCodePoint=function(e){return e>=this._value.length?-1:this._value[e]},n.prototype.consumeUnicodeRangeToken=function(){for(var e=[],t=this.consumeCodePoint();Hd(t)&&e.length<6;)e.push(t),t=this.consumeCodePoint();for(var r=!1;t===Qf&&e.length<6;)e.push(t),t=this.consumeCodePoint(),r=!0;if(r){var o=parseInt(Co.apply(void 0,e.map(function(A){return A===Qf?rB:A})),16),s=parseInt(Co.apply(void 0,e.map(function(A){return A===Qf?aB:A})),16);return{type:30,start:o,end:s}}var i=parseInt(Co.apply(void 0,e),16);if(this.peekCodePoint(0)===Ys&&Hd(this.peekCodePoint(1))){this.consumeCodePoint(),t=this.consumeCodePoint();for(var a=[];Hd(t)&&a.length<6;)a.push(t),t=this.consumeCodePoint();var s=parseInt(Co.apply(void 0,a),16);return{type:30,start:i,end:s}}else return{type:30,start:i,end:i}},n.prototype.consumeIdentLikeToken=function(){var e=this.consumeName();return e.toLowerCase()==="url"&&this.peekCodePoint(0)===Uf?(this.consumeCodePoint(),this.consumeUrlToken()):this.peekCodePoint(0)===Uf?(this.consumeCodePoint(),{type:19,value:e}):{type:20,value:e}},n.prototype.consumeUrlToken=function(){var e=[];if(this.consumeWhiteSpace(),this.peekCodePoint(0)===za)return{type:22,value:""};var t=this.peekCodePoint(0);if(t===If||t===Ff){var r=this.consumeStringToken(this.consumeCodePoint());return r.type===0&&(this.consumeWhiteSpace(),this.peekCodePoint(0)===za||this.peekCodePoint(0)===du)?(this.consumeCodePoint(),{type:22,value:r.value}):(this.consumeBadUrlRemnants(),Pf)}for(;;){var o=this.consumeCodePoint();if(o===za||o===du)return{type:22,value:Co.apply(void 0,e)};if(Tf(o))return this.consumeWhiteSpace(),this.peekCodePoint(0)===za||this.peekCodePoint(0)===du?(this.consumeCodePoint(),{type:22,value:Co.apply(void 0,e)}):(this.consumeBadUrlRemnants(),Pf);if(o===Ff||o===If||o===Uf||ML(o))return this.consumeBadUrlRemnants(),Pf;if(o===Tu)if(tl(o,this.peekCodePoint(0)))e.push(this.consumeEscapedCodePoint());else return this.consumeBadUrlRemnants(),Pf;else e.push(o)}},n.prototype.consumeWhiteSpace=function(){for(;Tf(this.peekCodePoint(0));)this.consumeCodePoint()},n.prototype.consumeBadUrlRemnants=function(){for(;;){var e=this.consumeCodePoint();if(e===du||e===za)return;tl(e,this.peekCodePoint(0))&&this.consumeEscapedCodePoint()}},n.prototype.consumeStringSlice=function(e){for(var t=5e4,r="";e>0;){var o=Math.min(t,e);r+=Co.apply(void 0,this._value.splice(0,o)),e-=o}return this._value.shift(),r},n.prototype.consumeStringToken=function(e){var t="",r=0;do{var o=this._value[r];if(o===za||o===void 0||o===e)return t+=this.consumeStringSlice(r),{type:0,value:t};if(o===Op)return this._value.splice(0,r),ZL;if(o===Tu){var s=this._value[r+1];s!==za&&s!==void 0&&(s===Op?(t+=this.consumeStringSlice(r),r=-1,this._value.shift()):tl(o,s)&&(t+=this.consumeStringSlice(r),t+=Co(this.consumeEscapedCodePoint()),r=-1))}r++}while(!0)},n.prototype.consumeNumber=function(){var e=[],t=vh,r=this.peekCodePoint(0);for((r===Kl||r===Ys)&&e.push(this.consumeCodePoint());Ss(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0);var o=this.peekCodePoint(1);if(r===nh&&Ss(o))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=_y;Ss(this.peekCodePoint(0));)e.push(this.consumeCodePoint());r=this.peekCodePoint(0),o=this.peekCodePoint(1);var s=this.peekCodePoint(2);if((r===iB||r===oB)&&((o===Kl||o===Ys)&&Ss(s)||Ss(o)))for(e.push(this.consumeCodePoint(),this.consumeCodePoint()),t=_y;Ss(this.peekCodePoint(0));)e.push(this.consumeCodePoint());return[HL(e),t]},n.prototype.consumeNumericToken=function(){var e=this.consumeNumber(),t=e[0],r=e[1],o=this.peekCodePoint(0),s=this.peekCodePoint(1),i=this.peekCodePoint(2);if(Lf(o,s,i)){var a=this.consumeName();return{type:15,number:t,flags:r,unit:a}}return o===AL?(this.consumeCodePoint(),{type:16,number:t,flags:r}):{type:17,number:t,flags:r}},n.prototype.consumeEscapedCodePoint=function(){var e=this.consumeCodePoint();if(Hd(e)){for(var t=Co(e);Hd(this.peekCodePoint(0))&&t.length<6;)t+=Co(this.consumeCodePoint());Tf(this.peekCodePoint(0))&&this.consumeCodePoint();var r=parseInt(t,16);return r===0||PL(r)||r>1114111?By:r}return e===za?By:e},n.prototype.consumeName=function(){for(var e="";;){var t=this.consumeCodePoint();if(zy(t))e+=Co(t);else if(tl(t,this.peekCodePoint(0)))e+=Co(this.consumeEscapedCodePoint());else return this.reconsumeCodePoint(t),e}},n}(),lB=function(){function n(e){this._tokens=e}return n.create=function(e){var t=new AB;return t.write(e),new n(t.read())},n.parseValue=function(e){return n.create(e).parseComponentValue()},n.parseValues=function(e){return n.create(e).parseComponentValues()},n.prototype.parseComponentValue=function(){for(var e=this.consumeToken();e.type===31;)e=this.consumeToken();if(e.type===32)throw new SyntaxError("Error parsing CSS component value, unexpected EOF");this.reconsumeToken(e);var t=this.consumeComponentValue();do e=this.consumeToken();while(e.type===31);if(e.type===32)return t;throw new SyntaxError("Error parsing CSS component value, multiple values found when expecting only one")},n.prototype.parseComponentValues=function(){for(var e=[];;){var t=this.consumeComponentValue();if(t.type===32)return e;e.push(t),e.push()}},n.prototype.consumeComponentValue=function(){var e=this.consumeToken();switch(e.type){case 11:case 28:case 2:return this.consumeSimpleBlock(e.type);case 19:return this.consumeFunction(e)}return e},n.prototype.consumeSimpleBlock=function(e){for(var t={type:e,values:[]},r=this.consumeToken();;){if(r.type===32||AP(r,e))return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue()),r=this.consumeToken()}},n.prototype.consumeFunction=function(e){for(var t={name:e.value,values:[],type:18};;){var r=this.consumeToken();if(r.type===32||r.type===3)return t;this.reconsumeToken(r),t.values.push(this.consumeComponentValue())}},n.prototype.consumeToken=function(){var e=this._tokens.shift();return typeof e>"u"?um:e},n.prototype.reconsumeToken=function(e){this._tokens.unshift(e)},n}(),_l=function(n){return n.type===15},ko=function(n){return n.type===17},sn=function(n){return n.type===20},aP=function(n){return n.type===0},hm=function(n,e){return sn(n)&&n.value===e},dB=function(n){return n.type!==31},ps=function(n){return n.type!==31&&n.type!==4},Ka=function(n){var e=[],t=[];return n.forEach(function(r){if(r.type===4){if(t.length===0)throw new Error("Error parsing function args, zero tokens for arg");e.push(t),t=[];return}r.type!==31&&t.push(r)}),t.length&&e.push(t),e},AP=function(n,e){return e===11&&n.type===12||e===28&&n.type===29?!0:e===2&&n.type===3},gl=function(n){return n.type===17||n.type===15},Zn=function(n){return n.type===16||gl(n)},cB=function(n){return n.length>1?[n[0],n[1]]:[n[0]]},hs={type:17,number:0,flags:vh},K1={type:16,number:50,flags:vh},il={type:16,number:100,flags:vh},bu=function(n,e,t){var r=n[0],o=n[1];return[Ln(r,e),Ln(typeof o<"u"?o:r,t)]},Ln=function(n,e){if(n.type===16)return n.number/100*e;if(_l(n))switch(n.unit){case"rem":case"em":return 16*n.number;case"px":default:return n.number}return n.number},uB="deg",hB="grad",fB="rad",pB="turn",Sg={name:"angle",parse:function(n,e){if(e.type===15)switch(e.unit){case uB:return Math.PI*e.number/180;case hB:return Math.PI/200*e.number;case fB:return e.number;case pB:return Math.PI*2*e.number}throw new Error("Unsupported angle type")}},gB=function(n){return n.type===15&&(n.unit===uB||n.unit===hB||n.unit===fB||n.unit===pB)},vB=function(n){var e=n.filter(sn).map(function(t){return t.value}).join(" ");switch(e){case"to bottom right":case"to right bottom":case"left top":case"top left":return[hs,hs];case"to top":case"bottom":return Di(0);case"to bottom left":case"to left bottom":case"right top":case"top right":return[hs,il];case"to right":case"left":return Di(90);case"to top left":case"to left top":case"right bottom":case"bottom right":return[il,il];case"to bottom":case"top":return Di(180);case"to top right":case"to right top":case"left bottom":case"bottom left":return[il,hs];case"to left":case"right":return Di(270)}return 0},Di=function(n){return Math.PI*n/180},ll=function(n){return(255&n)===0},ts=function(n){var e=255&n,t=255&n>>8,r=255&n>>16,o=255&n>>24;return e<255?"rgba(".concat(o,",").concat(r,",").concat(t,",").concat(e/255,")"):"rgb(".concat(o,",").concat(r,",").concat(t,")")},Ra=function(n,e,t,r){return(n<<24|e<<16|t<<8|Math.round(r*255)<<0)>>>0},Np=function(n,e){if(n.type===17)return n.number;if(n.type===16){var t=e===3?1:255;return e===3?n.number/100*t:Math.round(n.number/100*t)}return 0},fd=function(n){return(n[0].type===20?n[0].value:"unknown")==="from"},vo=function(n,e,t){return Math.min(Math.max(n,e),t)},si=function(n,e){return[n[0]*e[0]+n[1]*e[1]+n[2]*e[2],n[3]*e[0]+n[4]*e[1]+n[5]*e[2],n[6]*e[0]+n[7]*e[1]+n[8]*e[2]]},lP=function(n){return Ra(vo(Math.round(n[0]*255),0,255),vo(Math.round(n[1]*255),0,255),vo(Math.round(n[2]*255),0,255),vo(n[3],0,1))},$1=function(n){var e=n[0],t=n[1],r=n[2],o=n[3],s=pd([e,t,r]);return Ra(vo(Math.round(s[0]*255),0,255),vo(Math.round(s[1]*255),0,255),vo(Math.round(s[2]*255),0,255),o)},mh=function(n){var e=bl([n[0],n[1],n[2]]);return $1([e[0],e[1],e[2],n[3]])},dP=function(n,e){if(fd(e.filter(ps)))throw new Error("Relative color not supported for lab()");var t=Eg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=pd(bl(Ug([r,o,s])));return Ra(vo(Math.round(a[0]*255),0,255),vo(Math.round(a[1]*255),0,255),vo(Math.round(a[2]*255),0,255),i)},cP=function(n,e){if(fd(e.filter(ps)))throw new Error("Relative color not supported for oklab()");var t=Eg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=pd(bl(Ig([r,o,s])));return Ra(vo(Math.round(a[0]*255),0,255),vo(Math.round(a[1]*255),0,255),vo(Math.round(a[2]*255),0,255),i)},uP=function(n,e){if(fd(e.filter(ps)))throw new Error("Relative color not supported for oklch()");var t=yB(e),r=t[0],o=t[1],s=t[2],i=t[3],a=pd(bl(Ig(Fg([r,o,s]))));return Ra(vo(Math.round(a[0]*255),0,255),vo(Math.round(a[1]*255),0,255),vo(Math.round(a[2]*255),0,255),i)},hP=function(n,e){if(fd(e.filter(ps)))throw new Error("Relative color not supported for lch()");var t=wB(e),r=t[0],o=t[1],s=t[2],i=t[3],a=pd(bl(Ug(Fg([r,o,s]))));return Ra(vo(Math.round(a[0]*255),0,255),vo(Math.round(a[1]*255),0,255),vo(Math.round(a[2]*255),0,255),i)},mB=function(n,e){var t=e.filter(ps),r=t[0],o=t[1],s=t[2],i=t[3],a=(r.type===17?Di(r.number):Sg.parse(n,r))/(Math.PI*2),A=Zn(o)?o.number/100:0,d=Zn(s)?s.number/100:0,c=typeof i<"u"&&Zn(i)?Ln(i,1):1;return[a,A,d,c]},Cy=function(n,e){if(fd(e))throw new Error("Relative color not supported for hsl()");var t=mB(n,e),r=t[0],o=t[1],s=t[2],i=t[3],a=bB([r,o,s]);return Ra(a[0]*255,a[1]*255,a[2]*255,o===0?1:i)},wB=function(n){var e=n.filter(ps),t=Zn(e[0])?e[0].number:0,r=Zn(e[1])?e[1].number:0,o=ko(e[2])||_l(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Zn(e[4])?Ln(e[4],1):1;return[t,r,o,s]},Eg=function(n){var e=n.filter(ps),t=e[0].type===16?e[0].number/100:ko(e[0])?e[0].number:0,r=e[1].type===16?e[1].number/100:ko(e[1])?e[1].number:0,o=ko(e[2])||_l(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Zn(e[4])?Ln(e[4],1):1;return[t,r,o,s]},yB=function(n){var e=n.filter(ps),t=e[0].type===16?e[0].number/100:ko(e[0])?e[0].number:0,r=e[1].type===16?e[1].number/100:ko(e[1])?e[1].number:0,o=ko(e[2])||_l(e[2])?e[2].number:0,s=typeof e[4]<"u"&&Zn(e[4])?Ln(e[4],1):1;return[t,r,o,s]},_B=function(n){return si([1.0479297925449969,.022946870601609652,-.05019226628920524,.02962780877005599,.9904344267538799,-.017073799063418826,-.009243040646204504,.015055191490298152,.7518742814281371],n)},V1=function(n){return si([.955473421488075,-.02309845494876471,.06325924320057072,-.0283697093338637,1.0099953980813041,.021041441191917323,.012314014864481998,-.020507649298898964,1.330365926242124],n)},Hv=function(n,e,t){return t<0&&(t+=1),t>=1&&(t-=1),t<1/6?(e-n)*t*6+n:t<1/2?e:t<2/3?(e-n)*6*(2/3-t)+n:n},bB=function(n){var e=n[0],t=n[1],r=n[2];if(t===0)return[r*255,r*255,r*255];var o=r<=.5?r*(t+1):r+t-r*t,s=r*2-o,i=Hv(s,o,e+1/3),a=Hv(s,o,e),A=Hv(s,o,e-1/3);return[i,a,A]},Fg=function(n){var e=n[0],t=n[1],r=n[2];return t<0&&(t=0),isNaN(r)&&(r=0),[e,t*Math.cos(r*Math.PI/180),t*Math.sin(r*Math.PI/180)]},Ig=function(n){var e=si([1,.3963377773761749,.2158037573099136,1,-.1055613458156586,-.0638541728258133,1,-.0894841775298119,-1.2914855480194092],n),t=e.map(function(r){return Math.pow(r,3)});return si([1.2268798758459243,-.5578149944602171,.2813910456659647,-.0405757452148008,1.112286803280317,-.0717110580655164,-.0763729366746601,-.4214933324022432,1.5869240198367816],t)},Ug=function(n){var e=(n[0]+16)/116,t=n[1]/500+e,r=e-n[2]/200,o=24389/27,s=24/116,i=[(t>s?Math.pow(t,3):(116*t-16)/o)*.3457/.3585,n[0]>8?Math.pow(e,3):n[0]/o,(r>s?Math.pow(r,3):(116*r-16)/o)*(1-.3457-.3585)/.3585];return V1([i[0],i[1],i[2]])},fP=function(n,e){var t=e.filter(ps);if(t.length===3){var r=t.map(Np),o=r[0],s=r[1],i=r[2],a=pm([o/255,s/255,i/255]),A=fm([a[0],a[1],a[2]]),d=A[0],c=A[1],u=A[2];return[d,c,u,1]}if(t.length===4){var h=t.map(Np),o=h[0],s=h[1],i=h[2],p=h[3],a=pm([o/255,s/255,i/255]),v=fm([a[0],a[1],a[2]]),d=v[0],c=v[1],u=v[2];return[d,c,u,p]}return[0,0,0,1]},pP=function(n,e){var t=mB(n,e),r=t[0],o=t[1],s=t[2],i=t[3],a=pm(bB([r,o,s])),A=fm([a[0],a[1],a[2]]),d=A[0],c=A[1],u=A[2];return[d,c,u,i]},gP=function(n,e){var t=Eg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=Ug([r,o,s]),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},vP=function(n,e){var t=wB(e),r=t[0],o=t[1],s=t[2],i=t[3],a=Ug(Fg([r,o,s])),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},mP=function(n,e){var t=yB(e),r=t[0],o=t[1],s=t[2],i=t[3],a=Ig(Fg([r,o,s])),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},wP=function(n,e){var t=Eg(e),r=t[0],o=t[1],s=t[2],i=t[3],a=Ig([r,o,s]),A=a[0],d=a[1],c=a[2];return[A,d,c,i]},yP=function(n){return V1([n[0],n[1],n[2]])},Sy=function(n){return n},_P=function(n){var e=_B([n[0],n[2],n[3]]),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},Ey=function(n){return mh([n[0],n[1],n[2],n[3]])},bP=function(n){var e=yP([n[0],n[1],n[2]]);return mh([e[0],e[1],e[2],n[3]])},bl=function(n){return si([3.2409699419045226,-1.537383177570094,-.4986107602930034,-.9692436362808796,1.8759675015077202,.04155505740717559,.05563007969699366,-.20397695888897652,1.0569715142428786],n)},fm=function(n){return si([.41239079926595934,.357584339383878,.1804807884018343,.21263900587151027,.715168678767756,.07219231536073371,.01933081871559182,.11919477979462598,.9505321522496607],n)},pd=function(n){return n.map(function(e){var t=e<0?-1:1,r=Math.abs(e);return r>.0031308?t*(1.055*Math.pow(r,1/2.4)-.055):12.92*e})},pm=function(n){return n.map(function(e){var t=e<0?-1:1,r=Math.abs(e);return r<=.04045?e/12.92:t*Math.pow((r+.055)/1.055,2.4)})},xP=function(n){var e=pd(bl([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},BP=function(n){var e=bl([n[0],n[1],n[2]]),t=e[0],r=e[1],o=e[2];return[vo(Math.round(t*255),0,255),vo(Math.round(r*255),0,255),vo(Math.round(o*255),0,255),n[3]]},zP=function(n){return si([.4865709486482162,.26566769316909306,.1982172852343625,.2289745640697488,.6917385218365064,.079286914093745,0,.04511338185890264,1.043944368900976],n)},CP=function(n){return si([2.493496911941425,-.9313836179191239,-.40271078445071684,-.8294889695615747,1.7626640603183463,.023624685841943577,.03584583024378447,-.07617238926804182,.9568845240076872],n)},SP=function(n){return n.map(function(e){var t=e<0?-1:1,r=e*t;return r<=.04045?e/12.92:t*Math.pow((e+.055)/1.055,2.4)||0})},EP=function(n){return pd(n)},FP=function(n){var e=SP([n[0],n[1],n[2]]);return zP([e[0],e[1],e[2]])},IP=function(n){var e=EP(CP([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},UP=function(n){var e=FP([n[0],n[1],n[2]]);return mh([e[0],e[1],e[2],n[3]])},QP=function(n){return si([2.0415879038107465,-.5650069742788596,-.34473135077832956,-.9692436362808795,1.8759675015077202,.04155505740717557,.013444280632031142,-.11836239223101838,1.0151749943912054],n)},TP=function(n){return si([.5766690429101305,.1855582379065463,.1882286462349947,.29734497525053605,.6273635662554661,.0752914584939978,.02703136138641234,.07068885253582723,.9913375368376388],n)},LP=function(n){var e=n.map(function(t){var r=t<0?-1:1,o=Math.abs(t);return r*Math.pow(o,2.19921875)});return[e[0],e[1],e[2]]},PP=function(n){var e=n.map(function(t){var r=t<0?-1:1,o=Math.abs(t);return r*Math.pow(o,.4547069271758437)});return[e[0],e[1],e[2]]},kP=function(n){var e=PP(QP([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},OP=function(n){var e=bl(TP(LP([n[0],n[1],n[2]])));return $1([e[0],e[1],e[2],n[3]])},DP=function(n){return si([.7977666449006423,.13518129740053308,.0313477341283922,.2880748288194013,.711835234241873,8993693872564e-17,0,0,.8251046025104602],n)},NP=function(n){return si([1.3457868816471583,-.25557208737979464,-.05110186497554526,-.5446307051249019,1.5082477428451468,.02052744743642139,0,0,1.2119675456389452],n)},MP=function(n){return n.map(function(e){return e<16/512?e/16:Math.pow(e,1.8)})},HP=function(n){return n.map(function(e){return e>1/512?Math.pow(e,1/1.8):e*16})},jP=function(n){var e=MP([n[0],n[1],n[2]]);return V1(DP([e[0],e[1],e[2]]))},RP=function(n){var e=HP(NP(_B([n[0],n[1],n[2]]))),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},qP=function(n){var e=jP([n[0],n[1],n[2]]);return mh([e[0],e[1],e[2],n[3]])},Mp=1.09929682680944,xB=.018053968510807,KP=function(n){return n.map(function(e){return e<xB*4.5?e/4.5:Math.pow((e+Mp-1)/Mp,1/.45)})},$P=function(n){return n.map(function(e){return e>=xB?Mp*Math.pow(e,.45)-(Mp-1):4.5*e})},VP=function(n){return si([.6369580483012914,.14461690358620832,.1688809751641721,.2627002120112671,.6779980715188708,.05930171646986196,0,.028072693049087428,1.060985057710791],n)},GP=function(n){return si([1.716651187971268,-.355670783776392,-.25336628137366,-.666684351832489,1.616481236634939,.0157685458139111,.017639857445311,-.042770613257809,.942103121235474],n)},WP=function(n){var e=KP([n[0],n[1],n[2]]);return VP([e[0],e[1],e[2]])},XP=function(n){var e=$P(GP([n[0],n[1],n[2]])),t=e[0],r=e[1],o=e[2];return[t,r,o,n[3]]},YP=function(n){var e=WP([n[0],n[1],n[2]]);return mh([e[0],e[1],e[2],n[3]])},dl={name:"color",parse:function(n,e){if(e.type===18){var t=tk[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported color function "'.concat(e.name,'"'));return t(n,e.values)}if(e.type===5){var r=BB(e),o=r[0],s=r[1],i=r[2],a=r[3];return Ra(o,s,i,a)}if(e.type===20){var A=ka[e.value.toUpperCase()];if(typeof A<"u")return A}return ka.TRANSPARENT}},BB=function(n){if(n.value.length===3){var e=n.value.substring(0,1),t=n.value.substring(1,2),r=n.value.substring(2,3);return[parseInt(e+e,16),parseInt(t+t,16),parseInt(r+r,16),1]}if(n.value.length===4){var e=n.value.substring(0,1),t=n.value.substring(1,2),r=n.value.substring(2,3),o=n.value.substring(3,4);return[parseInt(e+e,16),parseInt(t+t,16),parseInt(r+r,16),parseInt(o+o,16)/255]}if(n.value.length===6){var e=n.value.substring(0,2),t=n.value.substring(2,4),r=n.value.substring(4,6);return[parseInt(e,16),parseInt(t,16),parseInt(r,16),1]}if(n.value.length===8){var e=n.value.substring(0,2),t=n.value.substring(2,4),r=n.value.substring(4,6),o=n.value.substring(6,8);return[parseInt(e,16),parseInt(t,16),parseInt(r,16),parseInt(o,16)/255]}return[0,0,0,1]},Fy=function(n,e){var t=e.filter(ps);if(fd(t))throw new Error("Relative color not supported for rgb()");if(t.length===3){var r=t.map(Np),o=r[0],s=r[1],i=r[2];return Ra(o,s,i,1)}if(t.length===4){var a=t.map(Np),o=a[0],s=a[1],i=a[2],A=a[3];return Ra(o,s,i,A)}return 0},JP=function(n,e){var t=e.filter(ps),r=t[0].type===20?t[0].value:"unknown",o=!fd(t);if(o){var s=r,i=Iy[s];if(typeof i>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(s,'" for color() function'));var a=ko(t[1])?t[1].number:0,A=ko(t[2])?t[2].number:0,d=ko(t[3])?t[3].number:0,c=t.length>4&&t[4].type===6&&t[4].value==="/"&&ko(t[5])?t[5].number:1;return i([a,A,d,c])}else{var u=function(fe,ie){if(ko(ie))return ie.number;var pe=function(z){return z==="r"||z==="x"?0:z==="g"||z==="y"?1:2};if(sn(ie)){var te=pe(ie.value);return fe[te]}var Ce=function(z){for(var E=z.filter(ps),F="(",I=0,O=E;I<O.length;I++){var D=O[I];F+=D.type===18&&D.name==="calc"?Ce(D.values):ko(D)?D.number:D.type===6||sn(D)?D.value:""}return F+=")",F};if(ie.type===18){var ne=ie.values.filter(ps);if(ie.name==="calc"){var ze=Ce(ne).replace(/r|x/,fe[0].toString()).replace(/g|y/,fe[1].toString()).replace(/b|z/,fe[2].toString());return new Function("return "+ze)()}}return null},h=t[1].type===18?t[1].name:sn(t[1])||t[1].type===5?"rgb":"unknown",p=sn(t[2])?t[2].value:"unknown",v=t[1].type===18?t[1].values:sn(t[1])?[t[1]]:[];if(sn(t[1])){var w=ka[t[1].value.toUpperCase()];if(typeof w>"u")throw new Error("Attempting to use unknown color in relative color 'from'");var y=pc(n,t[1].value),B=255&y,C=255&y>>8,Q=255&y>>16,k=255&y>>24;v=[{type:17,number:k,flags:1},{type:17,number:Q,flags:1},{type:17,number:C,flags:1},{type:17,number:B>1?B/255:B,flags:1}]}else if(t[1].type===5){var H=BB(t[1]),k=H[0],Q=H[1],C=H[2],B=H[3];v=[{type:17,number:k,flags:1},{type:17,number:Q,flags:1},{type:17,number:C,flags:1},{type:17,number:B>1?B/255:B,flags:1}]}if(v.length===0)throw new Error("Attempting to use unknown color in relative color 'from'");if(p==="unknown")throw new Error("Attempting to use unknown colorspace in relative color 'to'");var Z=ZP[h],q=ek[p],N=Iy[p];if(typeof Z>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(h,'" for color() function'));if(typeof q>"u")throw new Error('Attempting to parse an unsupported color space "'.concat(p,'" for color() function'));var re=Z(n,v),be=q(re),a=u(be,t[3]),A=u(be,t[4]),d=u(be,t[5]),c=t.length>6&&t[6].type===6&&t[6].value==="/"&&ko(t[7])?t[7].number:1;if(a===null||A===null||d===null)throw new Error("Invalid relative color in color() function");return N([a,A,d,c])}},Iy={srgb:lP,"srgb-linear":$1,"display-p3":UP,"a98-rgb":OP,"prophoto-rgb":qP,xyz:Ey,"xyz-d50":bP,"xyz-d65":Ey,rec2020:YP},ZP={rgb:fP,hsl:pP,lab:gP,lch:vP,oklab:wP,oklch:mP},ek={srgb:xP,"srgb-linear":BP,"display-p3":IP,"a98-rgb":kP,"prophoto-rgb":RP,xyz:Sy,"xyz-d50":_P,"xyz-d65":Sy,rec2020:XP},tk={hsl:Cy,hsla:Cy,rgb:Fy,rgba:Fy,lch:hP,oklch:uP,oklab:cP,lab:dP,color:JP},pc=function(n,e){return dl.parse(n,lB.create(e).parseComponentValue())},ka={ALICEBLUE:4042850303,ANTIQUEWHITE:4209760255,AQUA:16777215,AQUAMARINE:2147472639,AZURE:4043309055,BEIGE:4126530815,BISQUE:4293182719,BLACK:255,BLANCHEDALMOND:4293643775,BLUE:65535,BLUEVIOLET:2318131967,BROWN:2771004159,BURLYWOOD:3736635391,CADETBLUE:1604231423,CHARTREUSE:2147418367,CHOCOLATE:3530104575,CORAL:4286533887,CORNFLOWERBLUE:1687547391,CORNSILK:4294499583,CRIMSON:3692313855,CYAN:16777215,DARKBLUE:35839,DARKCYAN:9145343,DARKGOLDENROD:3095837695,DARKGRAY:2846468607,DARKGREEN:6553855,DARKGREY:2846468607,DARKKHAKI:3182914559,DARKMAGENTA:2332068863,DARKOLIVEGREEN:1433087999,DARKORANGE:4287365375,DARKORCHID:2570243327,DARKRED:2332033279,DARKSALMON:3918953215,DARKSEAGREEN:2411499519,DARKSLATEBLUE:1211993087,DARKSLATEGRAY:793726975,DARKSLATEGREY:793726975,DARKTURQUOISE:13554175,DARKVIOLET:2483082239,DEEPPINK:4279538687,DEEPSKYBLUE:12582911,DIMGRAY:1768516095,DIMGREY:1768516095,DODGERBLUE:512819199,FIREBRICK:2988581631,FLORALWHITE:4294635775,FORESTGREEN:579543807,FUCHSIA:4278255615,GAINSBORO:3705462015,GHOSTWHITE:4177068031,GOLD:4292280575,GOLDENROD:3668254975,GRAY:2155905279,GREEN:8388863,GREENYELLOW:2919182335,GREY:2155905279,HONEYDEW:4043305215,HOTPINK:4285117695,INDIANRED:3445382399,INDIGO:1258324735,IVORY:4294963455,KHAKI:4041641215,LAVENDER:3873897215,LAVENDERBLUSH:4293981695,LAWNGREEN:2096890111,LEMONCHIFFON:4294626815,LIGHTBLUE:2916673279,LIGHTCORAL:4034953471,LIGHTCYAN:3774873599,LIGHTGOLDENRODYELLOW:4210742015,LIGHTGRAY:3553874943,LIGHTGREEN:2431553791,LIGHTGREY:3553874943,LIGHTPINK:4290167295,LIGHTSALMON:4288707327,LIGHTSEAGREEN:548580095,LIGHTSKYBLUE:2278488831,LIGHTSLATEGRAY:2005441023,LIGHTSLATEGREY:2005441023,LIGHTSTEELBLUE:2965692159,LIGHTYELLOW:4294959359,LIME:16711935,LIMEGREEN:852308735,LINEN:4210091775,MAGENTA:4278255615,MAROON:2147483903,MEDIUMAQUAMARINE:1724754687,MEDIUMBLUE:52735,MEDIUMORCHID:3126187007,MEDIUMPURPLE:2473647103,MEDIUMSEAGREEN:1018393087,MEDIUMSLATEBLUE:2070474495,MEDIUMSPRINGGREEN:16423679,MEDIUMTURQUOISE:1221709055,MEDIUMVIOLETRED:3340076543,MIDNIGHTBLUE:421097727,MINTCREAM:4127193855,MISTYROSE:4293190143,MOCCASIN:4293178879,NAVAJOWHITE:4292783615,NAVY:33023,OLDLACE:4260751103,OLIVE:2155872511,OLIVEDRAB:1804477439,ORANGE:4289003775,ORANGERED:4282712319,ORCHID:3664828159,PALEGOLDENROD:4008225535,PALEGREEN:2566625535,PALETURQUOISE:2951671551,PALEVIOLETRED:3681588223,PAPAYAWHIP:4293907967,PEACHPUFF:4292524543,PERU:3448061951,PINK:4290825215,PLUM:3718307327,POWDERBLUE:2967529215,PURPLE:2147516671,REBECCAPURPLE:1714657791,RED:4278190335,ROSYBROWN:3163525119,ROYALBLUE:1097458175,SADDLEBROWN:2336560127,SALMON:4202722047,SANDYBROWN:4104413439,SEAGREEN:780883967,SEASHELL:4294307583,SIENNA:2689740287,SILVER:3233857791,SKYBLUE:2278484991,SLATEBLUE:1784335871,SLATEGRAY:1887473919,SLATEGREY:1887473919,SNOW:4294638335,SPRINGGREEN:16744447,STEELBLUE:1182971135,TAN:3535047935,TEAL:8421631,THISTLE:3636451583,TOMATO:4284696575,TRANSPARENT:0,TURQUOISE:1088475391,VIOLET:4001558271,WHEAT:4125012991,WHITE:4294967295,WHITESMOKE:4126537215,YELLOW:4294902015,YELLOWGREEN:2597139199},rk={name:"background-clip",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(sn(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},nk={name:"background-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Qg=function(n,e){var t=dl.parse(n,e[0]),r=e[1];return r&&Zn(r)?{color:t,stop:r}:{color:t,stop:null}},Uy=function(n,e){var t=n[0],r=n[n.length-1];t.stop===null&&(t.stop=hs),r.stop===null&&(r.stop=il);for(var o=[],s=0,i=0;i<n.length;i++){var a=n[i].stop;if(a!==null){var A=Ln(a,e);A>s?o.push(A):o.push(s),s=A}else o.push(null)}for(var d=null,i=0;i<o.length;i++){var c=o[i];if(c===null)d===null&&(d=i);else if(d!==null){for(var u=i-d,h=o[d-1],p=(c-h)/(u+1),v=1;v<=u;v++)o[d+v-1]=p*v;d=null}}return n.map(function(w,y){var B=w.color;return{color:B,stop:Math.max(Math.min(1,o[y]/e),0)}})},ok=function(n,e,t){var r=e/2,o=t/2,s=Ln(n[0],e)-r,i=o-Ln(n[1],t);return(Math.atan2(i,s)+Math.PI*2)%(Math.PI*2)},sk=function(n,e,t){var r=typeof n=="number"?n:ok(n,e,t),o=Math.abs(e*Math.sin(r))+Math.abs(t*Math.cos(r)),s=e/2,i=t/2,a=o/2,A=Math.sin(r-Math.PI/2)*a,d=Math.cos(r-Math.PI/2)*a;return[o,s-d,s+d,i-A,i+A]},Xi=function(n,e){return Math.sqrt(n*n+e*e)},Qy=function(n,e,t,r,o){var s=[[0,0],[0,e],[n,0],[n,e]];return s.reduce(function(i,a){var A=a[0],d=a[1],c=Xi(t-A,r-d);return(o?c<i.optimumDistance:c>i.optimumDistance)?{optimumCorner:a,optimumDistance:c}:i},{optimumDistance:o?1/0:-1/0,optimumCorner:null}).optimumCorner},ik=function(n,e,t,r,o){var s=0,i=0;switch(n.size){case 0:n.shape===0?s=i=Math.min(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-o)):n.shape===1&&(s=Math.min(Math.abs(e),Math.abs(e-r)),i=Math.min(Math.abs(t),Math.abs(t-o)));break;case 2:if(n.shape===0)s=i=Math.min(Xi(e,t),Xi(e,t-o),Xi(e-r,t),Xi(e-r,t-o));else if(n.shape===1){var a=Math.min(Math.abs(t),Math.abs(t-o))/Math.min(Math.abs(e),Math.abs(e-r)),A=Qy(r,o,e,t,!0),d=A[0],c=A[1];s=Xi(d-e,(c-t)/a),i=a*s}break;case 1:n.shape===0?s=i=Math.max(Math.abs(e),Math.abs(e-r),Math.abs(t),Math.abs(t-o)):n.shape===1&&(s=Math.max(Math.abs(e),Math.abs(e-r)),i=Math.max(Math.abs(t),Math.abs(t-o)));break;case 3:if(n.shape===0)s=i=Math.max(Xi(e,t),Xi(e,t-o),Xi(e-r,t),Xi(e-r,t-o));else if(n.shape===1){var a=Math.max(Math.abs(t),Math.abs(t-o))/Math.max(Math.abs(e),Math.abs(e-r)),u=Qy(r,o,e,t,!1),d=u[0],c=u[1];s=Xi(d-e,(c-t)/a),i=a*s}break}return Array.isArray(n.size)&&(s=Ln(n.size[0],r),i=n.size.length===2?Ln(n.size[1],o):s),[s,i]},ak=function(n,e){var t=Di(180),r=[];return Ka(e).forEach(function(o,s){if(s===0){var i=o[0];if(i.type===20&&i.value==="to"){t=vB(o);return}else if(gB(i)){t=Sg.parse(n,i);return}}var a=Qg(n,o);r.push(a)}),{angle:t,stops:r,type:1}},kf=function(n,e){var t=Di(180),r=[];return Ka(e).forEach(function(o,s){if(s===0){var i=o[0];if(i.type===20&&["top","left","right","bottom"].indexOf(i.value)!==-1){t=vB(o);return}else if(gB(i)){t=(Sg.parse(n,i)+Di(270))%Di(360);return}}var a=Qg(n,o);r.push(a)}),{angle:t,stops:r,type:1}},Ak=function(n,e){var t=Di(180),r=[],o=1,s=0,i=3,a=[];return Ka(e).forEach(function(A,d){var c=A[0];if(d===0){if(sn(c)&&c.value==="linear"){o=1;return}else if(sn(c)&&c.value==="radial"){o=2;return}}if(c.type===18){if(c.name==="from"){var u=dl.parse(n,c.values[0]);r.push({stop:hs,color:u})}else if(c.name==="to"){var u=dl.parse(n,c.values[0]);r.push({stop:il,color:u})}else if(c.name==="color-stop"){var h=c.values.filter(ps);if(h.length===2){var u=dl.parse(n,h[1]),p=h[0];ko(p)&&r.push({stop:{type:16,number:p.number*100,flags:p.flags},color:u})}}}}),o===1?{angle:(t+Di(180))%Di(360),stops:r,type:o}:{size:i,shape:s,stops:r,position:a,type:o}},zB="closest-side",CB="farthest-side",SB="closest-corner",EB="farthest-corner",FB="circle",IB="ellipse",UB="cover",QB="contain",lk=function(n,e){var t=0,r=3,o=[],s=[];return Ka(e).forEach(function(i,a){var A=!0;if(a===0){var d=!1;A=i.reduce(function(u,h){if(d)if(sn(h))switch(h.value){case"center":return s.push(K1),u;case"top":case"left":return s.push(hs),u;case"right":case"bottom":return s.push(il),u}else(Zn(h)||gl(h))&&s.push(h);else if(sn(h))switch(h.value){case FB:return t=0,!1;case IB:return t=1,!1;case"at":return d=!0,!1;case zB:return r=0,!1;case UB:case CB:return r=1,!1;case QB:case SB:return r=2,!1;case EB:return r=3,!1}else if(gl(h)||Zn(h))return Array.isArray(r)||(r=[]),r.push(h),!1;return u},A)}if(A){var c=Qg(n,i);o.push(c)}}),{size:r,shape:t,stops:o,position:s,type:2}},Of=function(n,e){var t=0,r=3,o=[],s=[];return Ka(e).forEach(function(i,a){var A=!0;if(a===0?A=i.reduce(function(c,u){if(sn(u))switch(u.value){case"center":return s.push(K1),!1;case"top":case"left":return s.push(hs),!1;case"right":case"bottom":return s.push(il),!1}else if(Zn(u)||gl(u))return s.push(u),!1;return c},A):a===1&&(A=i.reduce(function(c,u){if(sn(u))switch(u.value){case FB:return t=0,!1;case IB:return t=1,!1;case QB:case zB:return r=0,!1;case CB:return r=1,!1;case SB:return r=2,!1;case UB:case EB:return r=3,!1}else if(gl(u)||Zn(u))return Array.isArray(r)||(r=[]),r.push(u),!1;return c},A)),A){var d=Qg(n,i);o.push(d)}}),{size:r,shape:t,stops:o,position:s,type:2}},dk=function(n){return n.type===1},ck=function(n){return n.type===2},G1={name:"image",parse:function(n,e){if(e.type===22){var t={url:e.value,type:0};return n.cache.addImage(e.value),t}if(e.type===18){var r=TB[e.name];if(typeof r>"u")throw new Error('Attempting to parse an unsupported image function "'.concat(e.name,'"'));return r(n,e.values)}throw new Error("Unsupported image type ".concat(e.type))}};function uk(n){return!(n.type===20&&n.value==="none")&&(n.type!==18||!!TB[n.name])}var TB={"linear-gradient":ak,"-moz-linear-gradient":kf,"-ms-linear-gradient":kf,"-o-linear-gradient":kf,"-webkit-linear-gradient":kf,"radial-gradient":lk,"-moz-radial-gradient":Of,"-ms-radial-gradient":Of,"-o-radial-gradient":Of,"-webkit-radial-gradient":Of,"-webkit-gradient":Ak},hk={name:"background-image",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e.filter(function(r){return ps(r)&&uk(r)}).map(function(r){return G1.parse(n,r)})}},fk={name:"background-origin",initialValue:"border-box",prefix:!1,type:1,parse:function(n,e){return e.map(function(t){if(sn(t))switch(t.value){case"padding-box":return 1;case"content-box":return 2}return 0})}},pk={name:"background-position",initialValue:"0% 0%",type:1,prefix:!1,parse:function(n,e){return Ka(e).map(function(t){return t.filter(Zn)}).map(cB)}},gk={name:"background-repeat",initialValue:"repeat",prefix:!1,type:1,parse:function(n,e){return Ka(e).map(function(t){return t.filter(sn).map(function(r){return r.value}).join(" ")}).map(vk)}},vk=function(n){switch(n){case"no-repeat":return 1;case"repeat-x":case"repeat no-repeat":return 2;case"repeat-y":case"no-repeat repeat":return 3;case"repeat":default:return 0}},gc;(function(n){n.AUTO="auto",n.CONTAIN="contain",n.COVER="cover"})(gc||(gc={}));var mk={name:"background-size",initialValue:"0",prefix:!1,type:1,parse:function(n,e){return Ka(e).map(function(t){return t.filter(wk)})}},wk=function(n){return sn(n)||Zn(n)},Tg=function(n){return{name:"border-".concat(n,"-color"),initialValue:"transparent",prefix:!1,type:3,format:"color"}},yk=Tg("top"),_k=Tg("right"),bk=Tg("bottom"),xk=Tg("left"),Lg=function(n){return{name:"border-radius-".concat(n),initialValue:"0 0",prefix:!1,type:1,parse:function(e,t){return cB(t.filter(Zn))}}},Bk=Lg("top-left"),zk=Lg("top-right"),Ck=Lg("bottom-right"),Sk=Lg("bottom-left"),Pg=function(n){return{name:"border-".concat(n,"-style"),initialValue:"solid",prefix:!1,type:2,parse:function(e,t){switch(t){case"none":return 0;case"dashed":return 2;case"dotted":return 3;case"double":return 4}return 1}}},Ek=Pg("top"),Fk=Pg("right"),Ik=Pg("bottom"),Uk=Pg("left"),kg=function(n){return{name:"border-".concat(n,"-width"),initialValue:"0",type:0,prefix:!1,parse:function(e,t){return _l(t)?t.number:0}}},Qk=kg("top"),Tk=kg("right"),Lk=kg("bottom"),Pk=kg("left"),kk={name:"color",initialValue:"transparent",prefix:!1,type:3,format:"color"},Ok={name:"direction",initialValue:"ltr",prefix:!1,type:2,parse:function(n,e){switch(e){case"rtl":return 1;case"ltr":default:return 0}}},Dk={name:"display",initialValue:"inline-block",prefix:!1,type:1,parse:function(n,e){return e.filter(sn).reduce(function(t,r){return t|Nk(r.value)},0)}},Nk=function(n){switch(n){case"block":case"-webkit-box":return 2;case"inline":return 4;case"run-in":return 8;case"flow":return 16;case"flow-root":return 32;case"table":return 64;case"flex":case"-webkit-flex":return 128;case"grid":case"-ms-grid":return 256;case"ruby":return 512;case"subgrid":return 1024;case"list-item":return 2048;case"table-row-group":return 4096;case"table-header-group":return 8192;case"table-footer-group":return 16384;case"table-row":return 32768;case"table-cell":return 65536;case"table-column-group":return 131072;case"table-column":return 262144;case"table-caption":return 524288;case"ruby-base":return 1048576;case"ruby-text":return 2097152;case"ruby-base-container":return 4194304;case"ruby-text-container":return 8388608;case"contents":return 16777216;case"inline-block":return 33554432;case"inline-list-item":return 67108864;case"inline-table":return 134217728;case"inline-flex":return 268435456;case"inline-grid":return 536870912}return 0},Mk={name:"float",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"left":return 1;case"right":return 2;case"inline-start":return 3;case"inline-end":return 4}return 0}},Hk={name:"letter-spacing",initialValue:"0",prefix:!1,type:0,parse:function(n,e){return e.type===20&&e.value==="normal"?0:e.type===17||e.type===15?e.number:0}},Hp;(function(n){n.NORMAL="normal",n.STRICT="strict"})(Hp||(Hp={}));var jk={name:"line-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"strict":return Hp.STRICT;case"normal":default:return Hp.NORMAL}}},Rk={name:"line-height",initialValue:"normal",prefix:!1,type:4},Ty=function(n,e){return sn(n)&&n.value==="normal"?1.2*e:n.type===17?e*n.number:Zn(n)?Ln(n,e):e},qk={name:"list-style-image",initialValue:"none",type:0,prefix:!1,parse:function(n,e){return e.type===20&&e.value==="none"?null:G1.parse(n,e)}},Kk={name:"list-style-position",initialValue:"outside",prefix:!1,type:2,parse:function(n,e){switch(e){case"inside":return 0;case"outside":default:return 1}}},gm={name:"list-style-type",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"disc":return 0;case"circle":return 1;case"square":return 2;case"decimal":return 3;case"cjk-decimal":return 4;case"decimal-leading-zero":return 5;case"lower-roman":return 6;case"upper-roman":return 7;case"lower-greek":return 8;case"lower-alpha":return 9;case"upper-alpha":return 10;case"arabic-indic":return 11;case"armenian":return 12;case"bengali":return 13;case"cambodian":return 14;case"cjk-earthly-branch":return 15;case"cjk-heavenly-stem":return 16;case"cjk-ideographic":return 17;case"devanagari":return 18;case"ethiopic-numeric":return 19;case"georgian":return 20;case"gujarati":return 21;case"gurmukhi":return 22;case"hebrew":return 22;case"hiragana":return 23;case"hiragana-iroha":return 24;case"japanese-formal":return 25;case"japanese-informal":return 26;case"kannada":return 27;case"katakana":return 28;case"katakana-iroha":return 29;case"khmer":return 30;case"korean-hangul-formal":return 31;case"korean-hanja-formal":return 32;case"korean-hanja-informal":return 33;case"lao":return 34;case"lower-armenian":return 35;case"malayalam":return 36;case"mongolian":return 37;case"myanmar":return 38;case"oriya":return 39;case"persian":return 40;case"simp-chinese-formal":return 41;case"simp-chinese-informal":return 42;case"tamil":return 43;case"telugu":return 44;case"thai":return 45;case"tibetan":return 46;case"trad-chinese-formal":return 47;case"trad-chinese-informal":return 48;case"upper-armenian":return 49;case"disclosure-open":return 50;case"disclosure-closed":return 51;case"none":default:return-1}}},Og=function(n){return{name:"margin-".concat(n),initialValue:"0",prefix:!1,type:4}},$k=Og("top"),Vk=Og("right"),Gk=Og("bottom"),Wk=Og("left"),Xk={name:"overflow",initialValue:"visible",prefix:!1,type:1,parse:function(n,e){return e.filter(sn).map(function(t){switch(t.value){case"hidden":return 1;case"scroll":return 2;case"clip":return 3;case"auto":return 4;case"visible":default:return 0}})}},Yk={name:"overflow-wrap",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-word":return"break-word";case"normal":default:return"normal"}}},Dg=function(n){return{name:"padding-".concat(n),initialValue:"0",prefix:!1,type:3,format:"length-percentage"}},Jk=Dg("top"),Zk=Dg("right"),eO=Dg("bottom"),tO=Dg("left"),rO={name:"text-align",initialValue:"left",prefix:!1,type:2,parse:function(n,e){switch(e){case"right":return 2;case"center":case"justify":return 1;case"left":default:return 0}}},nO={name:"position",initialValue:"static",prefix:!1,type:2,parse:function(n,e){switch(e){case"relative":return 1;case"absolute":return 2;case"fixed":return 3;case"sticky":return 4}return 0}},oO={name:"text-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&hm(e[0],"none")?[]:Ka(e).map(function(t){for(var r={color:ka.TRANSPARENT,offsetX:hs,offsetY:hs,blur:hs},o=0,s=0;s<t.length;s++){var i=t[s];gl(i)?(o===0?r.offsetX=i:o===1?r.offsetY=i:r.blur=i,o++):r.color=dl.parse(n,i)}return r})}},sO={name:"text-transform",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"uppercase":return 2;case"lowercase":return 1;case"capitalize":return 3}return 0}},iO={name:"transform",initialValue:"none",prefix:!0,type:0,parse:function(n,e){if(e.type===20&&e.value==="none")return null;if(e.type===18){var t=lO[e.name];if(typeof t>"u")throw new Error('Attempting to parse an unsupported transform function "'.concat(e.name,'"'));return t(e.values)}return null}},aO=function(n){var e=n.filter(function(t){return t.type===17}).map(function(t){return t.number});return e.length===6?e:null},AO=function(n){var e=n.filter(function(A){return A.type===17}).map(function(A){return A.number}),t=e[0],r=e[1];e[2],e[3];var o=e[4],s=e[5];e[6],e[7],e[8],e[9],e[10],e[11];var i=e[12],a=e[13];return e[14],e[15],e.length===16?[t,r,o,s,i,a]:null},lO={matrix:aO,matrix3d:AO},Ly={type:16,number:50,flags:vh},dO=[Ly,Ly],cO={name:"transform-origin",initialValue:"50% 50%",prefix:!0,type:1,parse:function(n,e){var t=e.filter(Zn);return t.length!==2?dO:[t[0],t[1]]}},uO={name:"visible",initialValue:"none",prefix:!1,type:2,parse:function(n,e){switch(e){case"hidden":return 1;case"collapse":return 2;case"visible":default:return 0}}},Lu;(function(n){n.NORMAL="normal",n.BREAK_ALL="break-all",n.KEEP_ALL="keep-all"})(Lu||(Lu={}));var hO={name:"word-break",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"break-all":return Lu.BREAK_ALL;case"keep-all":return Lu.KEEP_ALL;case"normal":default:return Lu.NORMAL}}},fO={name:"z-index",initialValue:"auto",prefix:!1,type:0,parse:function(n,e){if(e.type===20)return{auto:!0,order:0};if(ko(e))return{auto:!1,order:e.number};throw new Error("Invalid z-index number parsed")}},LB={name:"time",parse:function(n,e){if(e.type===15)switch(e.unit.toLowerCase()){case"s":return 1e3*e.number;case"ms":return e.number}throw new Error("Unsupported time type")}},pO={name:"opacity",initialValue:"1",type:0,prefix:!1,parse:function(n,e){return ko(e)?e.number:1}},gO={name:"text-decoration-color",initialValue:"transparent",prefix:!1,type:3,format:"color"},vO={name:"text-decoration-line",initialValue:"none",prefix:!1,type:1,parse:function(n,e){return e.filter(sn).map(function(t){switch(t.value){case"underline":return 1;case"overline":return 2;case"line-through":return 3;case"none":return 4}return 0}).filter(function(t){return t!==0})}},mO={name:"font-family",initialValue:"",prefix:!1,type:1,parse:function(n,e){var t=[],r=[];return e.forEach(function(o){switch(o.type){case 20:case 0:t.push(o.value);break;case 17:t.push(o.number.toString());break;case 4:r.push(t.join(" ")),t.length=0;break}}),t.length&&r.push(t.join(" ")),r.map(function(o){return o.indexOf(" ")===-1?o:"'".concat(o,"'")})}},wO={name:"font-size",initialValue:"0",prefix:!1,type:3,format:"length"},yO={name:"font-weight",initialValue:"normal",type:0,prefix:!1,parse:function(n,e){if(ko(e))return e.number;if(sn(e))switch(e.value){case"bold":return 700;case"normal":default:return 400}return 400}},_O={name:"font-variant",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.filter(sn).map(function(t){return t.value})}},bO={name:"font-style",initialValue:"normal",prefix:!1,type:2,parse:function(n,e){switch(e){case"oblique":return"oblique";case"italic":return"italic";case"normal":default:return"normal"}}},qo=function(n,e){return(n&e)!==0},xO={name:"content",initialValue:"none",type:1,prefix:!1,parse:function(n,e){if(e.length===0)return[];var t=e[0];return t.type===20&&t.value==="none"?[]:e}},BO={name:"counter-increment",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;for(var r=[],o=e.filter(dB),s=0;s<o.length;s++){var i=o[s],a=o[s+1];if(i.type===20){var A=a&&ko(a)?a.number:1;r.push({counter:i.value,increment:A})}}return r}},zO={name:"counter-reset",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return[];for(var t=[],r=e.filter(dB),o=0;o<r.length;o++){var s=r[o],i=r[o+1];if(sn(s)&&s.value!=="none"){var a=i&&ko(i)?i.number:0;t.push({counter:s.value,reset:a})}}return t}},CO={name:"duration",initialValue:"0s",prefix:!1,type:1,parse:function(n,e){return e.filter(_l).map(function(t){return LB.parse(n,t)})}},SO={name:"quotes",initialValue:"none",prefix:!0,type:1,parse:function(n,e){if(e.length===0)return null;var t=e[0];if(t.type===20&&t.value==="none")return null;var r=[],o=e.filter(aP);if(o.length%2!==0)return null;for(var s=0;s<o.length;s+=2){var i=o[s].value,a=o[s+1].value;r.push({open:i,close:a})}return r}},Py=function(n,e,t){if(!n)return"";var r=n[Math.min(e,n.length-1)];return r?t?r.open:r.close:""},EO={name:"box-shadow",initialValue:"none",type:1,prefix:!1,parse:function(n,e){return e.length===1&&hm(e[0],"none")?[]:Ka(e).map(function(t){for(var r={color:255,offsetX:hs,offsetY:hs,blur:hs,spread:hs,inset:!1},o=0,s=0;s<t.length;s++){var i=t[s];hm(i,"inset")?r.inset=!0:gl(i)?(o===0?r.offsetX=i:o===1?r.offsetY=i:o===2?r.blur=i:r.spread=i,o++):r.color=dl.parse(n,i)}return r})}},FO={name:"paint-order",initialValue:"normal",prefix:!1,type:1,parse:function(n,e){var t=[0,1,2],r=[];return e.filter(sn).forEach(function(o){switch(o.value){case"stroke":r.push(1);break;case"fill":r.push(0);break;case"markers":r.push(2);break}}),t.forEach(function(o){r.indexOf(o)===-1&&r.push(o)}),r}},IO={name:"-webkit-text-stroke-color",initialValue:"currentcolor",prefix:!1,type:3,format:"color"},UO={name:"-webkit-text-stroke-width",initialValue:"0",type:0,prefix:!1,parse:function(n,e){return _l(e)?e.number:0}},QO={name:"objectFit",initialValue:"fill",prefix:!1,type:1,parse:function(n,e){return e.filter(sn).reduce(function(t,r){return t|TO(r.value)},0)}},TO=function(n){switch(n){case"contain":return 2;case"cover":return 4;case"none":return 8;case"scale-down":return 16}return 0},LO=function(){function n(e,t){var r,o;this.animationDuration=sr(e,CO,t.animationDuration),this.backgroundClip=sr(e,rk,t.backgroundClip),this.backgroundColor=sr(e,nk,t.backgroundColor),this.backgroundImage=sr(e,hk,t.backgroundImage),this.backgroundOrigin=sr(e,fk,t.backgroundOrigin),this.backgroundPosition=sr(e,pk,t.backgroundPosition),this.backgroundRepeat=sr(e,gk,t.backgroundRepeat),this.backgroundSize=sr(e,mk,t.backgroundSize),this.borderTopColor=sr(e,yk,t.borderTopColor),this.borderRightColor=sr(e,_k,t.borderRightColor),this.borderBottomColor=sr(e,bk,t.borderBottomColor),this.borderLeftColor=sr(e,xk,t.borderLeftColor),this.borderTopLeftRadius=sr(e,Bk,t.borderTopLeftRadius),this.borderTopRightRadius=sr(e,zk,t.borderTopRightRadius),this.borderBottomRightRadius=sr(e,Ck,t.borderBottomRightRadius),this.borderBottomLeftRadius=sr(e,Sk,t.borderBottomLeftRadius),this.borderTopStyle=sr(e,Ek,t.borderTopStyle),this.borderRightStyle=sr(e,Fk,t.borderRightStyle),this.borderBottomStyle=sr(e,Ik,t.borderBottomStyle),this.borderLeftStyle=sr(e,Uk,t.borderLeftStyle),this.borderTopWidth=sr(e,Qk,t.borderTopWidth),this.borderRightWidth=sr(e,Tk,t.borderRightWidth),this.borderBottomWidth=sr(e,Lk,t.borderBottomWidth),this.borderLeftWidth=sr(e,Pk,t.borderLeftWidth),this.boxShadow=sr(e,EO,t.boxShadow),this.color=sr(e,kk,t.color),this.direction=sr(e,Ok,t.direction),this.display=sr(e,Dk,t.display),this.float=sr(e,Mk,t.cssFloat),this.fontFamily=sr(e,mO,t.fontFamily),this.fontSize=sr(e,wO,t.fontSize),this.fontStyle=sr(e,bO,t.fontStyle),this.fontVariant=sr(e,_O,t.fontVariant),this.fontWeight=sr(e,yO,t.fontWeight),this.letterSpacing=sr(e,Hk,t.letterSpacing),this.lineBreak=sr(e,jk,t.lineBreak),this.lineHeight=sr(e,Rk,t.lineHeight),this.listStyleImage=sr(e,qk,t.listStyleImage),this.listStylePosition=sr(e,Kk,t.listStylePosition),this.listStyleType=sr(e,gm,t.listStyleType),this.marginTop=sr(e,$k,t.marginTop),this.marginRight=sr(e,Vk,t.marginRight),this.marginBottom=sr(e,Gk,t.marginBottom),this.marginLeft=sr(e,Wk,t.marginLeft),this.opacity=sr(e,pO,t.opacity);var s=sr(e,Xk,t.overflow);this.overflowX=s[0],this.overflowY=s[s.length>1?1:0],this.overflowWrap=sr(e,Yk,t.overflowWrap),this.paddingTop=sr(e,Jk,t.paddingTop),this.paddingRight=sr(e,Zk,t.paddingRight),this.paddingBottom=sr(e,eO,t.paddingBottom),this.paddingLeft=sr(e,tO,t.paddingLeft),this.paintOrder=sr(e,FO,t.paintOrder),this.position=sr(e,nO,t.position),this.textAlign=sr(e,rO,t.textAlign),this.textDecorationColor=sr(e,gO,(r=t.textDecorationColor)!==null&&r!==void 0?r:t.color),this.textDecorationLine=sr(e,vO,(o=t.textDecorationLine)!==null&&o!==void 0?o:t.textDecoration),this.textShadow=sr(e,oO,t.textShadow),this.textTransform=sr(e,sO,t.textTransform),this.transform=sr(e,iO,t.transform),this.transformOrigin=sr(e,cO,t.transformOrigin),this.visibility=sr(e,uO,t.visibility),this.webkitTextStrokeColor=sr(e,IO,t.webkitTextStrokeColor),this.webkitTextStrokeWidth=sr(e,UO,t.webkitTextStrokeWidth),this.wordBreak=sr(e,hO,t.wordBreak),this.zIndex=sr(e,fO,t.zIndex),this.objectFit=sr(e,QO,t.objectFit)}return n.prototype.isVisible=function(){return this.display>0&&this.opacity>0&&this.visibility===0},n.prototype.isTransparent=function(){return ll(this.backgroundColor)},n.prototype.isTransformed=function(){return this.transform!==null},n.prototype.isPositioned=function(){return this.position!==0},n.prototype.isPositionedWithZIndex=function(){return this.isPositioned()&&!this.zIndex.auto},n.prototype.isFloating=function(){return this.float!==0},n.prototype.isInlineLevel=function(){return qo(this.display,4)||qo(this.display,33554432)||qo(this.display,268435456)||qo(this.display,536870912)||qo(this.display,67108864)||qo(this.display,134217728)},n}(),PO=function(){function n(e,t){this.content=sr(e,xO,t.content),this.quotes=sr(e,SO,t.quotes)}return n}(),ky=function(){function n(e,t){this.counterIncrement=sr(e,BO,t.counterIncrement),this.counterReset=sr(e,zO,t.counterReset)}return n}(),sr=function(n,e,t){var r=new AB,o=t!==null&&typeof t<"u"?t.toString():e.initialValue;r.write(o);var s=new lB(r.read());switch(e.type){case 2:var i=s.parseComponentValue();return e.parse(n,sn(i)?i.value:e.initialValue);case 0:return e.parse(n,s.parseComponentValue());case 1:return e.parse(n,s.parseComponentValues());case 4:return s.parseComponentValue();case 3:switch(e.format){case"angle":return Sg.parse(n,s.parseComponentValue());case"color":return dl.parse(n,s.parseComponentValue());case"image":return G1.parse(n,s.parseComponentValue());case"length":var a=s.parseComponentValue();return gl(a)?a:hs;case"length-percentage":var A=s.parseComponentValue();return Zn(A)?A:hs;case"time":return LB.parse(n,s.parseComponentValue())}break}},kO="data-html2canvas-debug",OO=function(n){var e=n.getAttribute(kO);switch(e){case"all":return 1;case"clone":return 2;case"parse":return 3;case"render":return 4;default:return 0}},vm=function(n,e){var t=OO(n);return t===1||e===t},$a=function(){function n(e,t){if(this.context=e,this.textNodes=[],this.elements=[],this.flags=0,vm(t,3))debugger;this.styles=new LO(e,window.getComputedStyle(t,null)),ym(t)&&(this.styles.animationDuration.some(function(r){return r>0})&&(t.style.animationDuration="0s"),this.styles.transform!==null&&(t.style.transform="none")),this.bounds=zg(this.context,t),vm(t,4)&&(this.flags|=16)}return n}(),DO="AAAAAAAAAAAAEA4AGBkAAFAaAAACAAAAAAAIABAAGAAwADgACAAQAAgAEAAIABAACAAQAAgAEAAIABAACAAQAAgAEAAIABAAQABIAEQATAAIABAACAAQAAgAEAAIABAAVABcAAgAEAAIABAACAAQAGAAaABwAHgAgACIAI4AlgAIABAAmwCjAKgAsAC2AL4AvQDFAMoA0gBPAVYBWgEIAAgACACMANoAYgFkAWwBdAF8AX0BhQGNAZUBlgGeAaMBlQGWAasBswF8AbsBwwF0AcsBYwHTAQgA2wG/AOMBdAF8AekB8QF0AfkB+wHiAHQBfAEIAAMC5gQIAAsCEgIIAAgAFgIeAggAIgIpAggAMQI5AkACygEIAAgASAJQAlgCYAIIAAgACAAKBQoFCgUTBRMFGQUrBSsFCAAIAAgACAAIAAgACAAIAAgACABdAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABoAmgCrwGvAQgAbgJ2AggAHgEIAAgACADnAXsCCAAIAAgAgwIIAAgACAAIAAgACACKAggAkQKZAggAPADJAAgAoQKkAqwCsgK6AsICCADJAggA0AIIAAgACAAIANYC3gIIAAgACAAIAAgACABAAOYCCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAkASoB+QIEAAgACAA8AEMCCABCBQgACABJBVAFCAAIAAgACAAIAAgACAAIAAgACABTBVoFCAAIAFoFCABfBWUFCAAIAAgACAAIAAgAbQUIAAgACAAIAAgACABzBXsFfQWFBYoFigWKBZEFigWKBYoFmAWfBaYFrgWxBbkFCAAIAAgACAAIAAgACAAIAAgACAAIAMEFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAMgFCADQBQgACAAIAAgACAAIAAgACAAIAAgACAAIAO4CCAAIAAgAiQAIAAgACABAAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAD0AggACAD8AggACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIANYFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAMDvwAIAAgAJAIIAAgACAAIAAgACAAIAAgACwMTAwgACAB9BOsEGwMjAwgAKwMyAwsFYgE3A/MEPwMIAEUDTQNRAwgAWQOsAGEDCAAIAAgACAAIAAgACABpAzQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFOgU0BTUFNgU3BTgFOQU6BTQFNQU2BTcFOAU5BToFNAU1BTYFNwU4BTkFIQUoBSwFCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABtAwgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABMAEwACAAIAAgACAAIABgACAAIAAgACAC/AAgACAAyAQgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACAAIAAwAAgACAAIAAgACAAIAAgACAAIAAAARABIAAgACAAIABQASAAIAAgAIABwAEAAjgCIABsAqAC2AL0AigDQAtwC+IJIQqVAZUBWQqVAZUBlQGVAZUBlQGrC5UBlQGVAZUBlQGVAZUBlQGVAXsKlQGVAbAK6wsrDGUMpQzlDJUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAZUBlQGVAfAKAAuZA64AtwCJALoC6ADwAAgAuACgA/oEpgO6AqsD+AAIAAgAswMIAAgACAAIAIkAuwP5AfsBwwPLAwgACAAIAAgACADRA9kDCAAIAOED6QMIAAgACAAIAAgACADuA/YDCAAIAP4DyQAIAAgABgQIAAgAXQAOBAgACAAIAAgACAAIABMECAAIAAgACAAIAAgACAD8AAQBCAAIAAgAGgQiBCoECAExBAgAEAEIAAgACAAIAAgACAAIAAgACAAIAAgACAA4BAgACABABEYECAAIAAgATAQYAQgAVAQIAAgACAAIAAgACAAIAAgACAAIAFoECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAOQEIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAB+BAcACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAEABhgSMBAgACAAIAAgAlAQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAwAEAAQABAADAAMAAwADAAQABAAEAAQABAAEAAQABHATAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAdQMIAAgACAAIAAgACAAIAMkACAAIAAgAfQMIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACACFA4kDCAAIAAgACAAIAOcBCAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAIcDCAAIAAgACAAIAAgACAAIAAgACAAIAJEDCAAIAAgACADFAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABgBAgAZgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAbAQCBXIECAAIAHkECAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACABAAJwEQACjBKoEsgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAC6BMIECAAIAAgACAAIAAgACABmBAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAxwQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAGYECAAIAAgAzgQIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBd0FXwUIAOIF6gXxBYoF3gT5BQAGCAaKBYoFigWKBYoFigWKBYoFigWKBYoFigXWBIoFigWKBYoFigWKBYoFigWKBYsFEAaKBYoFigWKBYoFigWKBRQGCACKBYoFigWKBQgACAAIANEECAAIABgGigUgBggAJgYIAC4GMwaKBYoF0wQ3Bj4GigWKBYoFigWKBYoFigWKBYoFigWKBYoFigUIAAgACAAIAAgACAAIAAgAigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWKBYoFigWLBf///////wQABAAEAAQABAAEAAQABAAEAAQAAwAEAAQAAgAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAQADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUAAAAFAAUAAAAFAAUAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUAAQAAAAUABQAFAAUABQAFAAAAAAAFAAUAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAFAAUAAQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAAABwAHAAcAAAAHAAcABwAFAAEAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAcABwAFAAUAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAAAAQABAAAAAAAAAAAAAAAFAAUABQAFAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAHAAcAAAAHAAcAAAAAAAUABQAHAAUAAQAHAAEABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwABAAUABQAFAAUAAAAAAAAAAAAAAAEAAQABAAEAAQABAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABQANAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQABAAEAAQABAAEAAQABAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAABQAHAAUABQAFAAAAAAAAAAcABQAFAAUABQAFAAQABAAEAAQABAAEAAQABAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAEAAQABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUAAAAFAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAUAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAcABwAFAAcABwAAAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUABwAHAAUABQAFAAUAAAAAAAcABwAAAAAABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAABQAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAAAAAAAAAAABQAFAAAAAAAFAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAFAAUABQAFAAUAAAAFAAUABwAAAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABwAFAAUABQAFAAAAAAAHAAcAAAAAAAcABwAFAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAAAAAAAAAHAAcABwAAAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAABQAHAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAUABQAFAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAHAAcABQAHAAcAAAAFAAcABwAAAAcABwAFAAUAAAAAAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAFAAcABwAFAAUABQAAAAUAAAAHAAcABwAHAAcABwAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAHAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAABwAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAUAAAAFAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABwAFAAUABQAFAAUAAAAFAAUAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABwAFAAUABQAFAAUABQAAAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABQAFAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABQAFAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAHAAUABQAFAAUABQAFAAUABwAHAAcABwAHAAcABwAHAAUABwAHAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABwAHAAcABwAFAAUABwAHAAcAAAAAAAAAAAAHAAcABQAHAAcABwAHAAcABwAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAcABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAUABQAFAAUABQAFAAUAAAAFAAAABQAAAAAABQAFAAUABQAFAAUABQAFAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAFAAUAAAAAAAUABQAFAAUABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABwAFAAcABwAHAAcABwAFAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAUABQAFAAUABwAHAAUABQAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABQAFAAcABwAHAAUABwAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAcABQAFAAUABQAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAAAAAABwAFAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAAAAAAAAAFAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAUABQAHAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAUABQAFAAUABQAHAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAcABwAFAAUABQAFAAcABwAFAAUABwAHAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAFAAcABwAFAAUABwAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAFAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAFAAUABQAAAAAABQAFAAAAAAAAAAAAAAAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAcABwAAAAAAAAAAAAAABwAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAcABwAFAAcABwAAAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAFAAUABQAAAAUABQAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABwAFAAUABQAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAUABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAHAAcABQAHAAUABQAAAAAAAAAAAAAAAAAFAAAABwAHAAcABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAHAAcABwAAAAAABwAHAAAAAAAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABwAHAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAFAAUABwAFAAcABwAFAAcABQAFAAcABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAHAAcABQAFAAUABQAAAAAABwAHAAcABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAHAAUABQAFAAUABQAFAAUABQAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABwAFAAcABwAFAAUABQAFAAUABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAcABwAFAAUABQAFAAcABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAUABQAFAAUABQAHAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAFAAUABQAFAAAAAAAFAAUABwAHAAcABwAFAAAAAAAAAAcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABwAHAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAcABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUAAAAHAAUABQAFAAUABQAFAAUABwAFAAUABwAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUAAAAAAAAABQAAAAUABQAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAHAAcABwAHAAcAAAAFAAUAAAAHAAcABQAHAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAAAAUABQAFAAAAAAAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAFAAUABQAAAAAABQAFAAUABQAFAAUABQAAAAUABQAAAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAUABQAFAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABQAFAAUABQAFAAUABQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAFAAUABQAFAAUADgAOAA4ADgAOAA4ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAA8ADwAPAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAcABwAHAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAgACAAIAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAMAAwADAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkACQAJAAkAAAAAAAAAAAAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAKAAoACgAAAAAAAAAAAAsADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwACwAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAMAAwADAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAADgAOAA4AAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAAAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4AAAAOAAAAAAAAAAAAAAAAAA4AAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAAAAAAAAAAAA4AAAAOAAAAAAAAAAAADgAOAA4AAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4AAAAAAA4ADgAOAA4ADgAOAA4ADgAOAAAADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4ADgAOAAAAAAAAAAAAAAAAAAAAAAAAAAAADgAOAA4ADgAOAA4AAAAAAAAAAAAAAAAAAAAAAA4ADgAOAA4ADgAOAA4ADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAOAA4ADgAOAA4ADgAAAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4ADgAOAA4AAAAAAAAAAAA=",Oy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",xu=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Df=0;Df<Oy.length;Df++)xu[Oy.charCodeAt(Df)]=Df;var NO=function(n){var e=n.length*.75,t=n.length,r,o=0,s,i,a,A;n[n.length-1]==="="&&(e--,n[n.length-2]==="="&&e--);var d=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"&&typeof Uint8Array.prototype.slice<"u"?new ArrayBuffer(e):new Array(e),c=Array.isArray(d)?d:new Uint8Array(d);for(r=0;r<t;r+=4)s=xu[n.charCodeAt(r)],i=xu[n.charCodeAt(r+1)],a=xu[n.charCodeAt(r+2)],A=xu[n.charCodeAt(r+3)],c[o++]=s<<2|i>>4,c[o++]=(i&15)<<4|a>>2,c[o++]=(a&3)<<6|A&63;return d},MO=function(n){for(var e=n.length,t=[],r=0;r<e;r+=2)t.push(n[r+1]<<8|n[r]);return t},HO=function(n){for(var e=n.length,t=[],r=0;r<e;r+=4)t.push(n[r+3]<<24|n[r+2]<<16|n[r+1]<<8|n[r]);return t},Jl=5,W1=11,jv=2,jO=W1-Jl,PB=65536>>Jl,RO=1<<Jl,Rv=RO-1,qO=1024>>Jl,KO=PB+qO,$O=KO,VO=32,GO=$O+VO,WO=65536>>W1,XO=1<<jO,YO=XO-1,Dy=function(n,e,t){return n.slice?n.slice(e,t):new Uint16Array(Array.prototype.slice.call(n,e,t))},JO=function(n,e,t){return n.slice?n.slice(e,t):new Uint32Array(Array.prototype.slice.call(n,e,t))},ZO=function(n,e){var t=NO(n),r=Array.isArray(t)?HO(t):new Uint32Array(t),o=Array.isArray(t)?MO(t):new Uint16Array(t),s=24,i=Dy(o,s/2,r[4]/2),a=r[5]===2?Dy(o,(s+r[4])/2):JO(r,Math.ceil((s+r[4])/4));return new e8(r[0],r[1],r[2],r[3],i,a)},e8=function(){function n(e,t,r,o,s,i){this.initialValue=e,this.errorValue=t,this.highStart=r,this.highValueIndex=o,this.index=s,this.data=i}return n.prototype.get=function(e){var t;if(e>=0){if(e<55296||e>56319&&e<=65535)return t=this.index[e>>Jl],t=(t<<jv)+(e&Rv),this.data[t];if(e<=65535)return t=this.index[PB+(e-55296>>Jl)],t=(t<<jv)+(e&Rv),this.data[t];if(e<this.highStart)return t=GO-WO+(e>>W1),t=this.index[t],t+=e>>Jl&YO,t=this.index[t],t=(t<<jv)+(e&Rv),this.data[t];if(e<=1114111)return this.data[this.highValueIndex]}return this.errorValue},n}(),Ny="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t8=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(var Nf=0;Nf<Ny.length;Nf++)t8[Ny.charCodeAt(Nf)]=Nf;var r8=1,qv=2,Kv=3,My=4,Hy=5,n8=7,jy=8,$v=9,Vv=10,Ry=11,qy=12,Ky=13,$y=14,Gv=15,o8=function(n){for(var e=[],t=0,r=n.length;t<r;){var o=n.charCodeAt(t++);if(o>=55296&&o<=56319&&t<r){var s=n.charCodeAt(t++);(s&64512)===56320?e.push(((o&1023)<<10)+(s&1023)+65536):(e.push(o),t--)}else e.push(o)}return e},s8=function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(String.fromCodePoint)return String.fromCodePoint.apply(String,n);var t=n.length;if(!t)return"";for(var r=[],o=-1,s="";++o<t;){var i=n[o];i<=65535?r.push(i):(i-=65536,r.push((i>>10)+55296,i%1024+56320)),(o+1===t||r.length>16384)&&(s+=String.fromCharCode.apply(String,r),r.length=0)}return s},i8=ZO(DO),Pi="",Wv="",a8=function(n){return i8.get(n)},A8=function(n,e,t){var r=t-2,o=e[r],s=e[t-1],i=e[t];if(s===qv&&i===Kv)return Pi;if(s===qv||s===Kv||s===My||i===qv||i===Kv||i===My)return Wv;if(s===jy&&[jy,$v,Ry,qy].indexOf(i)!==-1||(s===Ry||s===$v)&&(i===$v||i===Vv)||(s===qy||s===Vv)&&i===Vv||i===Ky||i===Hy||i===n8||s===r8)return Pi;if(s===Ky&&i===$y){for(;o===Hy;)o=e[--r];if(o===$y)return Pi}if(s===Gv&&i===Gv){for(var a=0;o===Gv;)a++,o=e[--r];if(a%2===0)return Pi}return Wv},l8=function(n){var e=o8(n),t=e.length,r=0,o=0,s=e.map(a8);return{next:function(){if(r>=t)return{done:!0,value:null};for(var i=Pi;r<t&&(i=A8(e,s,++r))===Pi;);if(i!==Pi||r===t){var a=s8.apply(null,e.slice(o,r));return o=r,{value:a,done:!1}}return{done:!0,value:null}}}},d8=function(n){for(var e=l8(n),t=[],r;!(r=e.next()).done;)r.value&&t.push(r.value.slice());return t},c8=function(n){var e=123;if(n.createRange){var t=n.createRange();if(t.getBoundingClientRect){var r=n.createElement("boundtest");r.style.height="".concat(e,"px"),r.style.display="block",n.body.appendChild(r),t.selectNode(r);var o=t.getBoundingClientRect(),s=Math.round(o.height);if(n.body.removeChild(r),s===e)return!0}}return!1},u8=function(n){var e=n.createElement("boundtest");e.style.width="50px",e.style.display="block",e.style.fontSize="12px",e.style.letterSpacing="0px",e.style.wordSpacing="0px",n.body.appendChild(e);var t=n.createRange();e.innerHTML=typeof"".repeat=="function"?"&#128104;".repeat(10):"";var r=e.firstChild,o=Cg(r.data).map(function(A){return Co(A)}),s=0,i={},a=o.every(function(A,d){t.setStart(r,s),t.setEnd(r,s+A.length);var c=t.getBoundingClientRect();s+=A.length;var u=c.x>i.x||c.y>i.y;return i=c,d===0?!0:u});return n.body.removeChild(e),a},h8=function(){return typeof new Image().crossOrigin<"u"},f8=function(){return typeof new XMLHttpRequest().responseType=="string"},p8=function(n){var e=new Image,t=n.createElement("canvas"),r=t.getContext("2d");if(!r)return!1;e.src="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'></svg>";try{r.drawImage(e,0,0),t.toDataURL()}catch{return!1}return!0},Vy=function(n){return n[0]===0&&n[1]===255&&n[2]===0&&n[3]===255},g8=function(n){var e=n.createElement("canvas"),t=100;e.width=t,e.height=t;var r=e.getContext("2d");if(!r)return Promise.reject(!1);r.fillStyle="rgb(0, 255, 0)",r.fillRect(0,0,t,t);var o=new Image,s=e.toDataURL();o.src=s;var i=mm(t,t,0,0,o);return r.fillStyle="red",r.fillRect(0,0,t,t),Gy(i).then(function(a){r.drawImage(a,0,0);var A=r.getImageData(0,0,t,t).data;r.fillStyle="red",r.fillRect(0,0,t,t);var d=n.createElement("div");return d.style.backgroundImage="url(".concat(s,")"),d.style.height="".concat(t,"px"),Vy(A)?Gy(mm(t,t,0,0,d)):Promise.reject(!1)}).then(function(a){return r.drawImage(a,0,0),Vy(r.getImageData(0,0,t,t).data)}).catch(function(){return!1})},mm=function(n,e,t,r,o){var s="http://www.w3.org/2000/svg",i=document.createElementNS(s,"svg"),a=document.createElementNS(s,"foreignObject");return i.setAttributeNS(null,"width",n.toString()),i.setAttributeNS(null,"height",e.toString()),a.setAttributeNS(null,"width","100%"),a.setAttributeNS(null,"height","100%"),a.setAttributeNS(null,"x",t.toString()),a.setAttributeNS(null,"y",r.toString()),a.setAttributeNS(null,"externalResourcesRequired","true"),i.appendChild(a),a.appendChild(o),i},Gy=function(n){return new Promise(function(e,t){var r=new Image;r.onload=function(){return e(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(n)))})},cs={get SUPPORT_RANGE_BOUNDS(){var n=c8(document);return Object.defineProperty(cs,"SUPPORT_RANGE_BOUNDS",{value:n}),n},get SUPPORT_WORD_BREAKING(){var n=cs.SUPPORT_RANGE_BOUNDS&&u8(document);return Object.defineProperty(cs,"SUPPORT_WORD_BREAKING",{value:n}),n},get SUPPORT_SVG_DRAWING(){var n=p8(document);return Object.defineProperty(cs,"SUPPORT_SVG_DRAWING",{value:n}),n},get SUPPORT_FOREIGNOBJECT_DRAWING(){var n=typeof Array.from=="function"&&typeof window.fetch=="function"?g8(document):Promise.resolve(!1);return Object.defineProperty(cs,"SUPPORT_FOREIGNOBJECT_DRAWING",{value:n}),n},get SUPPORT_CORS_IMAGES(){var n=h8();return Object.defineProperty(cs,"SUPPORT_CORS_IMAGES",{value:n}),n},get SUPPORT_RESPONSE_TYPE(){var n=f8();return Object.defineProperty(cs,"SUPPORT_RESPONSE_TYPE",{value:n}),n},get SUPPORT_CORS_XHR(){var n="withCredentials"in new XMLHttpRequest;return Object.defineProperty(cs,"SUPPORT_CORS_XHR",{value:n}),n},get SUPPORT_NATIVE_TEXT_SEGMENTATION(){var n=!!(typeof Intl<"u"&&Intl.Segmenter);return Object.defineProperty(cs,"SUPPORT_NATIVE_TEXT_SEGMENTATION",{value:n}),n}},Pu=function(){function n(e,t){this.text=e,this.bounds=t}return n}(),v8=function(n,e,t,r){var o=y8(e,t),s=[],i=0;return o.forEach(function(a){if(t.textDecorationLine.length||a.trim().length>0)if(cs.SUPPORT_RANGE_BOUNDS){var A=Wy(r,i,a.length).getClientRects();if(A.length>1){var d=X1(a),c=0;d.forEach(function(h){s.push(new Pu(h,CA.fromDOMRectList(n,Wy(r,c+i,h.length).getClientRects()))),c+=h.length})}else s.push(new Pu(a,CA.fromDOMRectList(n,A)))}else{var u=r.splitText(a.length);s.push(new Pu(a,m8(n,r))),r=u}else cs.SUPPORT_RANGE_BOUNDS||(r=r.splitText(a.length));i+=a.length}),s},m8=function(n,e){var t=e.ownerDocument;if(t){var r=t.createElement("html2canvaswrapper");r.appendChild(e.cloneNode(!0));var o=e.parentNode;if(o){o.replaceChild(r,e);var s=zg(n,r);return r.firstChild&&o.replaceChild(r.firstChild,r),s}}return CA.EMPTY},Wy=function(n,e,t){var r=n.ownerDocument;if(!r)throw new Error("Node has no owner document");var o=r.createRange();return o.setStart(n,e),o.setEnd(n,e+t),o},X1=function(n){if(cs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var e=new Intl.Segmenter(void 0,{granularity:"grapheme"});return Array.from(e.segment(n)).map(function(t){return t.segment})}return d8(n)},w8=function(n,e){if(cs.SUPPORT_NATIVE_TEXT_SEGMENTATION){var t=new Intl.Segmenter(void 0,{granularity:"word"});return Array.from(t.segment(n)).map(function(r){return r.segment})}return b8(n,e)},y8=function(n,e){return e.letterSpacing!==0?X1(n):w8(n,e)},_8=[32,160,4961,65792,65793,4153,4241],b8=function(n,e){for(var t=tL(n,{lineBreak:e.lineBreak,wordBreak:e.overflowWrap==="break-word"?"break-word":e.wordBreak}),r=[],o,s=function(){if(o.value){var i=o.value.slice(),a=Cg(i),A="";a.forEach(function(d){_8.indexOf(d)===-1?A+=Co(d):(A.length&&r.push(A),r.push(Co(d)),A="")}),A.length&&r.push(A)}};!(o=t.next()).done;)s();return r},x8=function(){function n(e,t,r){this.text=B8(t.data,r.textTransform),this.textBounds=v8(e,this.text,r,t)}return n}(),B8=function(n,e){switch(e){case 1:return n.toLowerCase();case 3:return n.replace(z8,C8);case 2:return n.toUpperCase();default:return n}},z8=/(^|\s|:|-|\(|\))([a-z])/g,C8=function(n,e,t){return n.length>0?e+t.toUpperCase():n},kB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.src=r.currentSrc||r.src,o.intrinsicWidth=r.naturalWidth,o.intrinsicHeight=r.naturalHeight,o.context.cache.addImage(o.src),o}return e}($a),OB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.canvas=r,o.intrinsicWidth=r.width,o.intrinsicHeight=r.height,o}return e}($a),DB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this,s=new XMLSerializer,i=zg(t,r);return r.setAttribute("width","".concat(i.width,"px")),r.setAttribute("height","".concat(i.height,"px")),o.svg="data:image/svg+xml,".concat(encodeURIComponent(s.serializeToString(r))),o.intrinsicWidth=r.width.baseVal.value,o.intrinsicHeight=r.height.baseVal.value,o.context.cache.addImage(o.svg),o}return e}($a),NB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.value=r.value,o}return e}($a),wm=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.start=r.start,o.reversed=typeof r.reversed=="boolean"&&r.reversed===!0,o}return e}($a),S8=[{type:15,flags:0,unit:"px",number:3}],E8=[{type:16,flags:0,number:50}],F8=function(n){return n.width>n.height?new CA(n.left+(n.width-n.height)/2,n.top,n.height,n.height):n.width<n.height?new CA(n.left,n.top+(n.height-n.width)/2,n.width,n.width):n},I8=function(n){var e=n.type===U8?new Array(n.value.length+1).join(""):n.value;return e.length===0?n.placeholder||"":e},jp="checkbox",Rp="radio",U8="password",Xy=707406591,Y1=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;switch(o.type=r.type.toLowerCase(),o.checked=r.checked,o.value=I8(r),(o.type===jp||o.type===Rp)&&(o.styles.backgroundColor=3739148031,o.styles.borderTopColor=o.styles.borderRightColor=o.styles.borderBottomColor=o.styles.borderLeftColor=2779096575,o.styles.borderTopWidth=o.styles.borderRightWidth=o.styles.borderBottomWidth=o.styles.borderLeftWidth=1,o.styles.borderTopStyle=o.styles.borderRightStyle=o.styles.borderBottomStyle=o.styles.borderLeftStyle=1,o.styles.backgroundClip=[0],o.styles.backgroundOrigin=[0],o.bounds=F8(o.bounds)),o.type){case jp:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=S8;break;case Rp:o.styles.borderTopRightRadius=o.styles.borderTopLeftRadius=o.styles.borderBottomRightRadius=o.styles.borderBottomLeftRadius=E8;break}return o}return e}($a),MB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this,s=r.options[r.selectedIndex||0];return o.value=s&&s.text||"",o}return e}($a),HB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.value=r.value,o}return e}($a),jB=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;o.src=r.src,o.width=parseInt(r.width,10)||0,o.height=parseInt(r.height,10)||0,o.backgroundColor=o.styles.backgroundColor;try{if(r.contentWindow&&r.contentWindow.document&&r.contentWindow.document.documentElement){o.tree=qB(t,r.contentWindow.document.documentElement);var s=r.contentWindow.document.documentElement?pc(t,getComputedStyle(r.contentWindow.document.documentElement).backgroundColor):ka.TRANSPARENT,i=r.contentWindow.document.body?pc(t,getComputedStyle(r.contentWindow.document.body).backgroundColor):ka.TRANSPARENT;o.backgroundColor=ll(s)?ll(i)?o.styles.backgroundColor:i:s}}catch{}return o}return e}($a),Q8=["OL","UL","MENU"],ip=function(n,e,t,r){for(var o=e.firstChild,s=void 0;o;o=s)if(s=o.nextSibling,KB(o)&&o.data.length>0)t.textNodes.push(new x8(n,o,t.styles));else if(oc(o))if(WB(o)&&o.assignedNodes)o.assignedNodes().forEach(function(a){return ip(n,a,t,r)});else{var i=RB(n,o);i.styles.isVisible()&&(T8(o,i,r)?i.flags|=4:L8(i.styles)&&(i.flags|=2),Q8.indexOf(o.tagName)!==-1&&(i.flags|=8),t.elements.push(i),o.slot,o.shadowRoot?ip(n,o.shadowRoot,i,r):!qp(o)&&!$B(o)&&!Kp(o)&&ip(n,o,i,r))}},RB=function(n,e){return _m(e)?new kB(n,e):VB(e)?new OB(n,e):$B(e)?new DB(n,e):P8(e)?new NB(n,e):k8(e)?new wm(n,e):O8(e)?new Y1(n,e):Kp(e)?new MB(n,e):qp(e)?new HB(n,e):GB(e)?new jB(n,e):new $a(n,e)},qB=function(n,e){var t=RB(n,e);return t.flags|=4,ip(n,e,t,t),t},T8=function(n,e,t){return e.styles.isPositionedWithZIndex()||e.styles.opacity<1||e.styles.isTransformed()||J1(n)&&t.styles.isTransparent()},L8=function(n){return n.isPositioned()||n.isFloating()},KB=function(n){return n.nodeType===Node.TEXT_NODE},oc=function(n){return n.nodeType===Node.ELEMENT_NODE},ym=function(n){return oc(n)&&typeof n.style<"u"&&!ap(n)},ap=function(n){return typeof n.className=="object"},P8=function(n){return n.tagName==="LI"},k8=function(n){return n.tagName==="OL"},O8=function(n){return n.tagName==="INPUT"},D8=function(n){return n.tagName==="HTML"},$B=function(n){return n.tagName==="svg"},J1=function(n){return n.tagName==="BODY"},VB=function(n){return n.tagName==="CANVAS"},Yy=function(n){return n.tagName==="VIDEO"},_m=function(n){return n.tagName==="IMG"},GB=function(n){return n.tagName==="IFRAME"},Jy=function(n){return n.tagName==="STYLE"},N8=function(n){return n.tagName==="SCRIPT"},qp=function(n){return n.tagName==="TEXTAREA"},Kp=function(n){return n.tagName==="SELECT"},WB=function(n){return n.tagName==="SLOT"},Zy=function(n){return n.tagName.indexOf("-")>0},M8=function(){function n(){this.counters={}}return n.prototype.getCounterValue=function(e){var t=this.counters[e];return t&&t.length?t[t.length-1]:1},n.prototype.getCounterValues=function(e){var t=this.counters[e];return t||[]},n.prototype.pop=function(e){var t=this;e.forEach(function(r){return t.counters[r].pop()})},n.prototype.parse=function(e){var t=this,r=e.counterIncrement,o=e.counterReset,s=!0;r!==null&&r.forEach(function(a){var A=t.counters[a.counter];A&&a.increment!==0&&(s=!1,A.length||A.push(1),A[Math.max(0,A.length-1)]+=a.increment)});var i=[];return s&&o.forEach(function(a){var A=t.counters[a.counter];i.push(a.counter),A||(A=t.counters[a.counter]=[]),A.push(a.reset)}),i},n}(),e_={integers:[1e3,900,500,400,100,90,50,40,10,9,5,4,1],values:["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"]},t_={integers:[9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},H8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,400,300,200,100,90,80,70,60,50,40,30,20,19,18,17,16,15,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},j8={integers:[1e4,9e3,8e3,7e3,6e3,5e3,4e3,3e3,2e3,1e3,900,800,700,600,500,400,300,200,100,90,80,70,60,50,40,30,20,10,9,8,7,6,5,4,3,2,1],values:["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]},jd=function(n,e,t,r,o,s){return n<e||n>t?oh(n,o,s.length>0):r.integers.reduce(function(i,a,A){for(;n>=a;)n-=a,i+=r.values[A];return i},"")+s},XB=function(n,e,t,r){var o="";do t||n--,o=r(n)+o,n/=e;while(n*e>=e);return o},Bo=function(n,e,t,r,o){var s=t-e+1;return(n<0?"-":"")+(XB(Math.abs(n),s,r,function(i){return Co(Math.floor(i%s)+e)})+o)},Il=function(n,e,t){t===void 0&&(t=". ");var r=e.length;return XB(Math.abs(n),r,!1,function(o){return e[Math.floor(o%r)]})+t},Wd=1,YA=2,JA=4,Bu=8,AA=function(n,e,t,r,o,s){if(n<-9999||n>9999)return oh(n,4,o.length>0);var i=Math.abs(n),a=o;if(i===0)return e[0]+a;for(var A=0;i>0&&A<=4;A++){var d=i%10;d===0&&qo(s,Wd)&&a!==""?a=e[d]+a:d>1||d===1&&A===0||d===1&&A===1&&qo(s,YA)||d===1&&A===1&&qo(s,JA)&&n>100||d===1&&A>1&&qo(s,Bu)?a=e[d]+(A>0?t[A-1]:"")+a:d===1&&A>0&&(a=t[A-1]+a),i=Math.floor(i/10)}return(n<0?r:"")+a},r_="",n_="",o_="",Xv="",oh=function(n,e,t){var r=t?". ":"",o=t?"":"",s=t?", ":"",i=t?" ":"";switch(e){case 0:return""+i;case 1:return""+i;case 2:return""+i;case 5:var a=Bo(n,48,57,!0,r);return a.length<4?"0".concat(a):a;case 4:return Il(n,"",o);case 6:return jd(n,1,3999,e_,3,r).toLowerCase();case 7:return jd(n,1,3999,e_,3,r);case 8:return Bo(n,945,969,!1,r);case 9:return Bo(n,97,122,!1,r);case 10:return Bo(n,65,90,!1,r);case 11:return Bo(n,1632,1641,!0,r);case 12:case 49:return jd(n,1,9999,t_,3,r);case 35:return jd(n,1,9999,t_,3,r).toLowerCase();case 13:return Bo(n,2534,2543,!0,r);case 14:case 30:return Bo(n,6112,6121,!0,r);case 15:return Il(n,"",o);case 16:return Il(n,"",o);case 17:case 48:return AA(n,"",r_,"",o,YA|JA|Bu);case 47:return AA(n,"",n_,"",o,Wd|YA|JA|Bu);case 42:return AA(n,"",r_,"",o,YA|JA|Bu);case 41:return AA(n,"",n_,"",o,Wd|YA|JA|Bu);case 26:return AA(n,"","",o_,o,0);case 25:return AA(n,"","",o_,o,Wd|YA|JA);case 31:return AA(n,"","",Xv,s,Wd|YA|JA);case 33:return AA(n,"","",Xv,s,0);case 32:return AA(n,"","",Xv,s,Wd|YA|JA);case 18:return Bo(n,2406,2415,!0,r);case 20:return jd(n,1,19999,j8,3,r);case 21:return Bo(n,2790,2799,!0,r);case 22:return Bo(n,2662,2671,!0,r);case 22:return jd(n,1,10999,H8,3,r);case 23:return Il(n,"");case 24:return Il(n,"");case 27:return Bo(n,3302,3311,!0,r);case 28:return Il(n,"",o);case 29:return Il(n,"",o);case 34:return Bo(n,3792,3801,!0,r);case 37:return Bo(n,6160,6169,!0,r);case 38:return Bo(n,4160,4169,!0,r);case 39:return Bo(n,2918,2927,!0,r);case 40:return Bo(n,1776,1785,!0,r);case 43:return Bo(n,3046,3055,!0,r);case 44:return Bo(n,3174,3183,!0,r);case 45:return Bo(n,3664,3673,!0,r);case 46:return Bo(n,3872,3881,!0,r);case 3:default:return Bo(n,48,57,!0,r)}},YB="data-html2canvas-ignore",s_=function(){function n(e,t,r){if(this.context=e,this.options=r,this.scrolledElements=[],this.referenceElement=t,this.counters=new M8,this.quoteDepth=0,!t.ownerDocument)throw new Error("Cloned element does not have an owner document");this.documentElement=this.cloneNode(t.ownerDocument.documentElement,!1)}return n.prototype.toIFrame=function(e,t){var r=this,o=R8(e,t);if(!o.contentWindow)return Promise.reject("Unable to find iframe window");var s=e.defaultView.pageXOffset,i=e.defaultView.pageYOffset,a=o.contentWindow,A=a.document,d=$8(o).then(function(){return Os(r,void 0,void 0,function(){var u,h;return zs(this,function(p){switch(p.label){case 0:return this.scrolledElements.forEach(X8),a&&(a.scrollTo(t.left,t.top),/(iPad|iPhone|iPod)/g.test(navigator.userAgent)&&(a.scrollY!==t.top||a.scrollX!==t.left)&&(this.context.logger.warn("Unable to restore scroll position for cloned document"),this.context.windowBounds=this.context.windowBounds.add(a.scrollX-t.left,a.scrollY-t.top,0,0))),u=this.options.onclone,h=this.clonedReferenceElement,typeof h>"u"?[2,Promise.reject("Error finding the ".concat(this.referenceElement.nodeName," in the cloned document"))]:A.fonts&&A.fonts.ready?[4,A.fonts.ready]:[3,2];case 1:p.sent(),p.label=2;case 2:return/(AppleWebKit)/g.test(navigator.userAgent)?[4,K8(A)]:[3,4];case 3:p.sent(),p.label=4;case 4:return typeof u=="function"?[2,Promise.resolve().then(function(){return u(A,h)}).then(function(){return o})]:[2,o]}})})}),c=A.adoptNode(this.documentElement);return tD(c,A),A.open(),A.write("".concat(G8(document.doctype),"<html></html>")),W8(this.referenceElement.ownerDocument,s,i),A.replaceChild(c,A.documentElement),A.close(),d},n.prototype.createElementClone=function(e){if(vm(e,2))debugger;if(VB(e))return this.createCanvasClone(e);if(Yy(e))return this.createVideoClone(e);if(Jy(e))return this.createStyleClone(e);var t=e.cloneNode(!1);return _m(t)&&(_m(e)&&e.currentSrc&&e.currentSrc!==e.src&&(t.src=e.currentSrc,t.srcset=""),t.loading==="lazy"&&(t.loading="eager")),Zy(t)?this.createCustomElementClone(t):t},n.prototype.createCustomElementClone=function(e){var t=document.createElement("html2canvascustomelement");return Yv(e.style,t),t},n.prototype.createStyleClone=function(e){try{var t=e.sheet;if(t&&t.cssRules){var r=[].slice.call(t.cssRules,0).reduce(function(s,i){return i&&typeof i.cssText=="string"?s+i.cssText:s},""),o=e.cloneNode(!1);return o.textContent=r,o}}catch(s){if(this.context.logger.error("Unable to access cssRules property",s),s.name!=="SecurityError")throw s}return e.cloneNode(!1)},n.prototype.createCanvasClone=function(e){var t;if(this.options.inlineImages&&e.ownerDocument){var r=e.ownerDocument.createElement("img");try{return r.src=e.toDataURL(),r}catch{this.context.logger.info("Unable to inline canvas contents, canvas is tainted",e)}}var o=e.cloneNode(!1);try{o.width=e.width,o.height=e.height;var s=e.getContext("2d"),i=o.getContext("2d",{willReadFrequently:!0});if(i)if(!this.options.allowTaint&&s)i.putImageData(s.getImageData(0,0,e.width,e.height),0,0);else{var a=(t=e.getContext("webgl2"))!==null&&t!==void 0?t:e.getContext("webgl");if(a){var A=a.getContextAttributes();(A==null?void 0:A.preserveDrawingBuffer)===!1&&this.context.logger.warn("Unable to clone WebGL context as it has preserveDrawingBuffer=false",e)}i.drawImage(e,0,0)}return o}catch{this.context.logger.info("Unable to clone canvas as it is tainted",e)}return o},n.prototype.createVideoClone=function(e){var t=e.ownerDocument.createElement("canvas");t.width=e.offsetWidth,t.height=e.offsetHeight;var r=t.getContext("2d");try{return r&&(r.drawImage(e,0,0,t.width,t.height),this.options.allowTaint||r.getImageData(0,0,t.width,t.height)),t}catch{this.context.logger.info("Unable to clone video as it is tainted",e)}var o=e.ownerDocument.createElement("canvas");return o.width=e.offsetWidth,o.height=e.offsetHeight,o},n.prototype.appendChildNode=function(e,t,r){(!oc(t)||!N8(t)&&!t.hasAttribute(YB)&&(typeof this.options.ignoreElements!="function"||!this.options.ignoreElements(t)))&&(!this.options.copyStyles||!oc(t)||!Jy(t))&&e.appendChild(this.cloneNode(t,r))},n.prototype.cloneChildNodes=function(e,t,r){for(var o=this,s=e.shadowRoot?e.shadowRoot.firstChild:e.firstChild;s;s=s.nextSibling)if(oc(s)&&WB(s)&&typeof s.assignedNodes=="function"){var i=s.assignedNodes();i.length&&i.forEach(function(a){return o.appendChildNode(t,a,r)})}else this.appendChildNode(t,s,r)},n.prototype.cloneNode=function(e,t){if(KB(e))return document.createTextNode(e.data);if(!e.ownerDocument)return e.cloneNode(!1);var r=e.ownerDocument.defaultView;if(r&&oc(e)&&(ym(e)||ap(e))){var o=this.createElementClone(e);o.style.transitionProperty="none";var s=r.getComputedStyle(e),i=r.getComputedStyle(e,":before"),a=r.getComputedStyle(e,":after");this.referenceElement===e&&ym(o)&&(this.clonedReferenceElement=o),J1(o)&&Z8(o);var A=this.counters.parse(new ky(this.context,s)),d=this.resolvePseudoContent(e,o,i,ku.BEFORE);Zy(e)&&(t=!0),Yy(e)||this.cloneChildNodes(e,o,t),d&&o.insertBefore(d,o.firstChild);var c=this.resolvePseudoContent(e,o,a,ku.AFTER);return c&&o.appendChild(c),this.counters.pop(A),(s&&(this.options.copyStyles||ap(e))&&!GB(e)||t)&&Yv(s,o),(e.scrollTop!==0||e.scrollLeft!==0)&&this.scrolledElements.push([o,e.scrollLeft,e.scrollTop]),(qp(e)||Kp(e))&&(qp(o)||Kp(o))&&(o.value=e.value),o}return e.cloneNode(!1)},n.prototype.resolvePseudoContent=function(e,t,r,o){var s=this;if(r){var i=r.content,a=t.ownerDocument;if(!(!a||!i||i==="none"||i==="-moz-alt-content"||r.display==="none")){this.counters.parse(new ky(this.context,r));var A=new PO(this.context,r),d=a.createElement("html2canvaspseudoelement");Yv(r,d),A.content.forEach(function(u){if(u.type===0)d.appendChild(a.createTextNode(u.value));else if(u.type===22){var h=a.createElement("img");h.src=u.value,h.style.opacity="1",d.appendChild(h)}else if(u.type===18){if(u.name==="attr"){var p=u.values.filter(sn);p.length&&d.appendChild(a.createTextNode(e.getAttribute(p[0].value)||""))}else if(u.name==="counter"){var v=u.values.filter(ps),w=v[0],y=v[1];if(w&&sn(w)){var B=s.counters.getCounterValue(w.value),C=y&&sn(y)?gm.parse(s.context,y.value):3;d.appendChild(a.createTextNode(oh(B,C,!1)))}}else if(u.name==="counters"){var Q=u.values.filter(ps),w=Q[0],k=Q[1],y=Q[2];if(w&&sn(w)){var H=s.counters.getCounterValues(w.value),Z=y&&sn(y)?gm.parse(s.context,y.value):3,q=k&&k.type===0?k.value:"",N=H.map(function(L){return oh(L,Z,!1)}).join(q);d.appendChild(a.createTextNode(N))}}}else if(u.type===20)switch(u.value){case"open-quote":d.appendChild(a.createTextNode(Py(A.quotes,s.quoteDepth++,!0)));break;case"close-quote":d.appendChild(a.createTextNode(Py(A.quotes,--s.quoteDepth,!1)));break;default:d.appendChild(a.createTextNode(u.value))}}),d.className="".concat(bm," ").concat(xm);var c=o===ku.BEFORE?" ".concat(bm):" ".concat(xm);return ap(t)?t.className.baseValue+=c:t.className+=c,d}}},n.destroy=function(e){return e.parentNode?(e.parentNode.removeChild(e),!0):!1},n}(),ku;(function(n){n[n.BEFORE=0]="BEFORE",n[n.AFTER=1]="AFTER"})(ku||(ku={}));var R8=function(n,e){var t=n.createElement("iframe");return t.className="html2canvas-container",t.style.visibility="hidden",t.style.position="fixed",t.style.left="-10000px",t.style.top="0px",t.style.border="0",t.width=e.width.toString(),t.height=e.height.toString(),t.scrolling="no",t.setAttribute(YB,"true"),n.body.appendChild(t),t},q8=function(n){return new Promise(function(e){if(n.complete){e();return}if(!n.src){e();return}n.onload=e,n.onerror=e})},K8=function(n){return Promise.all([].slice.call(n.images,0).map(q8))},$8=function(n){return new Promise(function(e,t){var r=n.contentWindow;if(!r)return t("No window assigned for iframe");var o=r.document;r.onload=n.onload=function(){r.onload=n.onload=null;var s=setInterval(function(){o.body.childNodes.length>0&&o.readyState==="complete"&&(clearInterval(s),e(n))},50)}})},V8=["all","d","content"],Yv=function(n,e){for(var t=n.length-1;t>=0;t--){var r=n.item(t);V8.indexOf(r)===-1&&e.style.setProperty(r,n.getPropertyValue(r))}return e},G8=function(n){var e="";return n&&(e+="<!DOCTYPE ",n.name&&(e+=n.name),n.internalSubset&&(e+=n.internalSubset),n.publicId&&(e+='"'.concat(n.publicId,'"')),n.systemId&&(e+='"'.concat(n.systemId,'"')),e+=">"),e},W8=function(n,e,t){n&&n.defaultView&&(e!==n.defaultView.pageXOffset||t!==n.defaultView.pageYOffset)&&n.defaultView.scrollTo(e,t)},X8=function(n){var e=n[0],t=n[1],r=n[2];e.scrollLeft=t,e.scrollTop=r},Y8=":before",J8=":after",bm="___html2canvas___pseudoelement_before",xm="___html2canvas___pseudoelement_after",i_=`{
    content: "" !important;
    display: none !important;
}`,Z8=function(n){eD(n,".".concat(bm).concat(Y8).concat(i_,`
         .`).concat(xm).concat(J8).concat(i_))},eD=function(n,e){var t=n.ownerDocument;if(t){var r=t.createElement("style");r.textContent=e,n.appendChild(r)}},tD=function(n,e){var t,r=e.createElement("base");r.href=e.baseURI;var o=n.getElementsByTagName("head").item(0);o==null||o.insertBefore(r,(t=o==null?void 0:o.firstChild)!==null&&t!==void 0?t:null)},JB=function(){function n(){}return n.getOrigin=function(e){var t=n._link;return t?(t.href=e,t.href=t.href,t.protocol+t.hostname+t.port):"about:blank"},n.isSameOrigin=function(e){return n.getOrigin(e)===n._origin},n.setContext=function(e){n._link=e.document.createElement("a"),n._origin=n.getOrigin(e.location.href)},n._origin="about:blank",n}(),rD=function(){function n(e,t){this.context=e,this._options=t,this._cache={}}return n.prototype.addImage=function(e){var t=Promise.resolve();return this.has(e)||(Zv(e)||iD(e))&&(this._cache[e]=this.loadImage(e)).catch(function(){}),t},n.prototype.match=function(e){return this._cache[e]},n.prototype.loadImage=function(e){return Os(this,void 0,void 0,function(){var t,r,o,s,i=this;return zs(this,function(a){switch(a.label){case 0:return t=JB.isSameOrigin(e),r=!Jv(e)&&this._options.useCORS===!0&&cs.SUPPORT_CORS_IMAGES&&!t,o=!Jv(e)&&!t&&!Zv(e)&&typeof this._options.proxy=="string"&&cs.SUPPORT_CORS_XHR&&!r,!t&&this._options.allowTaint===!1&&!Jv(e)&&!Zv(e)&&!o&&!r?[2]:(s=e,o?[4,this.proxy(s)]:[3,2]);case 1:s=a.sent(),a.label=2;case 2:return this.context.logger.debug("Added image ".concat(e.substring(0,256))),[4,new Promise(function(A,d){var c=new Image;c.onload=function(){return A(c)},c.onerror=d,(aD(s)||r)&&(c.crossOrigin="anonymous"),c.src=s,c.complete===!0&&setTimeout(function(){return A(c)},500),i._options.imageTimeout>0&&setTimeout(function(){return d("Timed out (".concat(i._options.imageTimeout,"ms) loading image"))},i._options.imageTimeout)})];case 3:return[2,a.sent()]}})})},n.prototype.has=function(e){return typeof this._cache[e]<"u"},n.prototype.keys=function(){return Promise.resolve(Object.keys(this._cache))},n.prototype.proxy=function(e){var t=this,r=this._options.proxy;if(!r)throw new Error("No proxy defined");var o=e.substring(0,256);return new Promise(function(s,i){var a=cs.SUPPORT_RESPONSE_TYPE?"blob":"text",A=new XMLHttpRequest;A.onload=function(){if(A.status===200)if(a==="text")s(A.response);else{var u=new FileReader;u.addEventListener("load",function(){return s(u.result)},!1),u.addEventListener("error",function(h){return i(h)},!1),u.readAsDataURL(A.response)}else i("Failed to proxy resource ".concat(o," with status code ").concat(A.status))},A.onerror=i;var d=r.indexOf("?")>-1?"&":"?";if(A.open("GET","".concat(r).concat(d,"url=").concat(encodeURIComponent(e),"&responseType=").concat(a)),a!=="text"&&A instanceof XMLHttpRequest&&(A.responseType=a),t._options.imageTimeout){var c=t._options.imageTimeout;A.timeout=c,A.ontimeout=function(){return i("Timed out (".concat(c,"ms) proxying ").concat(o))}}A.send()})},n}(),nD=/^data:image\/svg\+xml/i,oD=/^data:image\/.*;base64,/i,sD=/^data:image\/.*/i,iD=function(n){return cs.SUPPORT_SVG_DRAWING||!AD(n)},Jv=function(n){return sD.test(n)},aD=function(n){return oD.test(n)},Zv=function(n){return n.substr(0,4)==="blob"},AD=function(n){return n.substr(-3).toLowerCase()==="svg"||nD.test(n)},nr=function(){function n(e,t){this.type=0,this.x=e,this.y=t}return n.prototype.add=function(e,t){return new n(this.x+e,this.y+t)},n}(),Rd=function(n,e,t){return new nr(n.x+(e.x-n.x)*t,n.y+(e.y-n.y)*t)},Mf=function(){function n(e,t,r,o){this.type=1,this.start=e,this.startControl=t,this.endControl=r,this.end=o}return n.prototype.subdivide=function(e,t){var r=Rd(this.start,this.startControl,e),o=Rd(this.startControl,this.endControl,e),s=Rd(this.endControl,this.end,e),i=Rd(r,o,e),a=Rd(o,s,e),A=Rd(i,a,e);return t?new n(this.start,r,i,A):new n(A,a,s,this.end)},n.prototype.add=function(e,t){return new n(this.start.add(e,t),this.startControl.add(e,t),this.endControl.add(e,t),this.end.add(e,t))},n.prototype.reverse=function(){return new n(this.end,this.endControl,this.startControl,this.start)},n}(),ki=function(n){return n.type===1},lD=function(){function n(e){var t=e.styles,r=e.bounds,o=bu(t.borderTopLeftRadius,r.width,r.height),s=o[0],i=o[1],a=bu(t.borderTopRightRadius,r.width,r.height),A=a[0],d=a[1],c=bu(t.borderBottomRightRadius,r.width,r.height),u=c[0],h=c[1],p=bu(t.borderBottomLeftRadius,r.width,r.height),v=p[0],w=p[1],y=[];y.push((s+A)/r.width),y.push((v+u)/r.width),y.push((i+w)/r.height),y.push((d+h)/r.height);var B=Math.max.apply(Math,y);B>1&&(s/=B,i/=B,A/=B,d/=B,u/=B,h/=B,v/=B,w/=B);var C=r.width-A,Q=r.height-h,k=r.width-u,H=r.height-w,Z=t.borderTopWidth,q=t.borderRightWidth,N=t.borderBottomWidth,re=t.borderLeftWidth,be=Ln(t.paddingTop,e.bounds.width),L=Ln(t.paddingRight,e.bounds.width),R=Ln(t.paddingBottom,e.bounds.width),J=Ln(t.paddingLeft,e.bounds.width);this.topLeftBorderDoubleOuterBox=s>0||i>0?no(r.left+re/3,r.top+Z/3,s-re/3,i-Z/3,Bn.TOP_LEFT):new nr(r.left+re/3,r.top+Z/3),this.topRightBorderDoubleOuterBox=s>0||i>0?no(r.left+C,r.top+Z/3,A-q/3,d-Z/3,Bn.TOP_RIGHT):new nr(r.left+r.width-q/3,r.top+Z/3),this.bottomRightBorderDoubleOuterBox=u>0||h>0?no(r.left+k,r.top+Q,u-q/3,h-N/3,Bn.BOTTOM_RIGHT):new nr(r.left+r.width-q/3,r.top+r.height-N/3),this.bottomLeftBorderDoubleOuterBox=v>0||w>0?no(r.left+re/3,r.top+H,v-re/3,w-N/3,Bn.BOTTOM_LEFT):new nr(r.left+re/3,r.top+r.height-N/3),this.topLeftBorderDoubleInnerBox=s>0||i>0?no(r.left+re*2/3,r.top+Z*2/3,s-re*2/3,i-Z*2/3,Bn.TOP_LEFT):new nr(r.left+re*2/3,r.top+Z*2/3),this.topRightBorderDoubleInnerBox=s>0||i>0?no(r.left+C,r.top+Z*2/3,A-q*2/3,d-Z*2/3,Bn.TOP_RIGHT):new nr(r.left+r.width-q*2/3,r.top+Z*2/3),this.bottomRightBorderDoubleInnerBox=u>0||h>0?no(r.left+k,r.top+Q,u-q*2/3,h-N*2/3,Bn.BOTTOM_RIGHT):new nr(r.left+r.width-q*2/3,r.top+r.height-N*2/3),this.bottomLeftBorderDoubleInnerBox=v>0||w>0?no(r.left+re*2/3,r.top+H,v-re*2/3,w-N*2/3,Bn.BOTTOM_LEFT):new nr(r.left+re*2/3,r.top+r.height-N*2/3),this.topLeftBorderStroke=s>0||i>0?no(r.left+re/2,r.top+Z/2,s-re/2,i-Z/2,Bn.TOP_LEFT):new nr(r.left+re/2,r.top+Z/2),this.topRightBorderStroke=s>0||i>0?no(r.left+C,r.top+Z/2,A-q/2,d-Z/2,Bn.TOP_RIGHT):new nr(r.left+r.width-q/2,r.top+Z/2),this.bottomRightBorderStroke=u>0||h>0?no(r.left+k,r.top+Q,u-q/2,h-N/2,Bn.BOTTOM_RIGHT):new nr(r.left+r.width-q/2,r.top+r.height-N/2),this.bottomLeftBorderStroke=v>0||w>0?no(r.left+re/2,r.top+H,v-re/2,w-N/2,Bn.BOTTOM_LEFT):new nr(r.left+re/2,r.top+r.height-N/2),this.topLeftBorderBox=s>0||i>0?no(r.left,r.top,s,i,Bn.TOP_LEFT):new nr(r.left,r.top),this.topRightBorderBox=A>0||d>0?no(r.left+C,r.top,A,d,Bn.TOP_RIGHT):new nr(r.left+r.width,r.top),this.bottomRightBorderBox=u>0||h>0?no(r.left+k,r.top+Q,u,h,Bn.BOTTOM_RIGHT):new nr(r.left+r.width,r.top+r.height),this.bottomLeftBorderBox=v>0||w>0?no(r.left,r.top+H,v,w,Bn.BOTTOM_LEFT):new nr(r.left,r.top+r.height),this.topLeftPaddingBox=s>0||i>0?no(r.left+re,r.top+Z,Math.max(0,s-re),Math.max(0,i-Z),Bn.TOP_LEFT):new nr(r.left+re,r.top+Z),this.topRightPaddingBox=A>0||d>0?no(r.left+Math.min(C,r.width-q),r.top+Z,C>r.width+q?0:Math.max(0,A-q),Math.max(0,d-Z),Bn.TOP_RIGHT):new nr(r.left+r.width-q,r.top+Z),this.bottomRightPaddingBox=u>0||h>0?no(r.left+Math.min(k,r.width-re),r.top+Math.min(Q,r.height-N),Math.max(0,u-q),Math.max(0,h-N),Bn.BOTTOM_RIGHT):new nr(r.left+r.width-q,r.top+r.height-N),this.bottomLeftPaddingBox=v>0||w>0?no(r.left+re,r.top+Math.min(H,r.height-N),Math.max(0,v-re),Math.max(0,w-N),Bn.BOTTOM_LEFT):new nr(r.left+re,r.top+r.height-N),this.topLeftContentBox=s>0||i>0?no(r.left+re+J,r.top+Z+be,Math.max(0,s-(re+J)),Math.max(0,i-(Z+be)),Bn.TOP_LEFT):new nr(r.left+re+J,r.top+Z+be),this.topRightContentBox=A>0||d>0?no(r.left+Math.min(C,r.width+re+J),r.top+Z+be,C>r.width+re+J?0:A-re+J,d-(Z+be),Bn.TOP_RIGHT):new nr(r.left+r.width-(q+L),r.top+Z+be),this.bottomRightContentBox=u>0||h>0?no(r.left+Math.min(k,r.width-(re+J)),r.top+Math.min(Q,r.height+Z+be),Math.max(0,u-(q+L)),h-(N+R),Bn.BOTTOM_RIGHT):new nr(r.left+r.width-(q+L),r.top+r.height-(N+R)),this.bottomLeftContentBox=v>0||w>0?no(r.left+re+J,r.top+H,Math.max(0,v-(re+J)),w-(N+R),Bn.BOTTOM_LEFT):new nr(r.left+re+J,r.top+r.height-(N+R))}return n}(),Bn;(function(n){n[n.TOP_LEFT=0]="TOP_LEFT",n[n.TOP_RIGHT=1]="TOP_RIGHT",n[n.BOTTOM_RIGHT=2]="BOTTOM_RIGHT",n[n.BOTTOM_LEFT=3]="BOTTOM_LEFT"})(Bn||(Bn={}));var no=function(n,e,t,r,o){var s=4*((Math.sqrt(2)-1)/3),i=t*s,a=r*s,A=n+t,d=e+r;switch(o){case Bn.TOP_LEFT:return new Mf(new nr(n,d),new nr(n,d-a),new nr(A-i,e),new nr(A,e));case Bn.TOP_RIGHT:return new Mf(new nr(n,e),new nr(n+i,e),new nr(A,d-a),new nr(A,d));case Bn.BOTTOM_RIGHT:return new Mf(new nr(A,e),new nr(A,e+a),new nr(n+i,d),new nr(n,d));case Bn.BOTTOM_LEFT:default:return new Mf(new nr(A,d),new nr(A-i,d),new nr(n,e+a),new nr(n,e))}},$p=function(n){return[n.topLeftBorderBox,n.topRightBorderBox,n.bottomRightBorderBox,n.bottomLeftBorderBox]},dD=function(n){return[n.topLeftContentBox,n.topRightContentBox,n.bottomRightContentBox,n.bottomLeftContentBox]},Vp=function(n){return[n.topLeftPaddingBox,n.topRightPaddingBox,n.bottomRightPaddingBox,n.bottomLeftPaddingBox]},cD=function(){function n(e,t,r){this.offsetX=e,this.offsetY=t,this.matrix=r,this.type=0,this.target=6}return n}(),Hf=function(){function n(e,t){this.path=e,this.target=t,this.type=1}return n}(),uD=function(){function n(e){this.opacity=e,this.type=2,this.target=6}return n}(),hD=function(n){return n.type===0},ZB=function(n){return n.type===1},fD=function(n){return n.type===2},a_=function(n,e){return n.length===e.length?n.some(function(t,r){return t===e[r]}):!1},pD=function(n,e,t,r,o){return n.map(function(s,i){switch(i){case 0:return s.add(e,t);case 1:return s.add(e+r,t);case 2:return s.add(e+r,t+o);case 3:return s.add(e,t+o)}return s})},ez=function(){function n(e){this.element=e,this.inlineLevel=[],this.nonInlineLevel=[],this.negativeZIndex=[],this.zeroOrAutoZIndexOrTransformedOrOpacity=[],this.positiveZIndex=[],this.nonPositionedFloats=[],this.nonPositionedInlineLevel=[]}return n}(),tz=function(){function n(e,t){if(this.container=e,this.parent=t,this.effects=[],this.curves=new lD(this.container),this.container.styles.opacity<1&&this.effects.push(new uD(this.container.styles.opacity)),this.container.styles.transform!==null){var r=this.container.bounds.left+this.container.styles.transformOrigin[0].number,o=this.container.bounds.top+this.container.styles.transformOrigin[1].number,s=this.container.styles.transform;this.effects.push(new cD(r,o,s))}if(this.container.styles.overflowX!==0){var i=$p(this.curves),a=Vp(this.curves);a_(i,a)?this.effects.push(new Hf(i,6)):(this.effects.push(new Hf(i,2)),this.effects.push(new Hf(a,4)))}}return n.prototype.getEffects=function(e){for(var t=[2,3].indexOf(this.container.styles.position)===-1,r=this.parent,o=this.effects.slice(0);r;){var s=r.effects.filter(function(A){return!ZB(A)});if(t||r.container.styles.position!==0||!r.parent){if(t=[2,3].indexOf(r.container.styles.position)===-1,r.container.styles.overflowX!==0){var i=$p(r.curves),a=Vp(r.curves);a_(i,a)||o.unshift(new Hf(a,6))}o.unshift.apply(o,s)}else o.unshift.apply(o,s);r=r.parent}return o.filter(function(A){return qo(A.target,e)})},n}(),Bm=function(n,e,t,r){n.container.elements.forEach(function(o){var s=qo(o.flags,4),i=qo(o.flags,2),a=new tz(o,n);qo(o.styles.display,2048)&&r.push(a);var A=qo(o.flags,8)?[]:r;if(s||i){var d=s||o.styles.isPositioned()?t:e,c=new ez(a);if(o.styles.isPositioned()||o.styles.opacity<1||o.styles.isTransformed()){var u=o.styles.zIndex.order;if(u<0){var h=0;d.negativeZIndex.some(function(v,w){return u>v.element.container.styles.zIndex.order?(h=w,!1):h>0}),d.negativeZIndex.splice(h,0,c)}else if(u>0){var p=0;d.positiveZIndex.some(function(v,w){return u>=v.element.container.styles.zIndex.order?(p=w+1,!1):p>0}),d.positiveZIndex.splice(p,0,c)}else d.zeroOrAutoZIndexOrTransformedOrOpacity.push(c)}else o.styles.isFloating()?d.nonPositionedFloats.push(c):d.nonPositionedInlineLevel.push(c);Bm(a,c,s?c:t,A)}else o.styles.isInlineLevel()?e.inlineLevel.push(a):e.nonInlineLevel.push(a),Bm(a,e,t,A);qo(o.flags,8)&&rz(o,A)})},rz=function(n,e){for(var t=n instanceof wm?n.start:1,r=n instanceof wm?n.reversed:!1,o=0;o<e.length;o++){var s=e[o];s.container instanceof NB&&typeof s.container.value=="number"&&s.container.value!==0&&(t=s.container.value),s.listValue=oh(t,s.container.styles.listStyleType,!0),t+=r?-1:1}},gD=function(n){var e=new tz(n,null),t=new ez(e),r=[];return Bm(e,t,t,r),rz(e.container,r),t},A_=function(n,e){switch(e){case 0:return Ni(n.topLeftBorderBox,n.topLeftPaddingBox,n.topRightBorderBox,n.topRightPaddingBox);case 1:return Ni(n.topRightBorderBox,n.topRightPaddingBox,n.bottomRightBorderBox,n.bottomRightPaddingBox);case 2:return Ni(n.bottomRightBorderBox,n.bottomRightPaddingBox,n.bottomLeftBorderBox,n.bottomLeftPaddingBox);case 3:default:return Ni(n.bottomLeftBorderBox,n.bottomLeftPaddingBox,n.topLeftBorderBox,n.topLeftPaddingBox)}},vD=function(n,e){switch(e){case 0:return Ni(n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox,n.topRightBorderBox,n.topRightBorderDoubleOuterBox);case 1:return Ni(n.topRightBorderBox,n.topRightBorderDoubleOuterBox,n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox);case 2:return Ni(n.bottomRightBorderBox,n.bottomRightBorderDoubleOuterBox,n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox);case 3:default:return Ni(n.bottomLeftBorderBox,n.bottomLeftBorderDoubleOuterBox,n.topLeftBorderBox,n.topLeftBorderDoubleOuterBox)}},mD=function(n,e){switch(e){case 0:return Ni(n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox,n.topRightBorderDoubleInnerBox,n.topRightPaddingBox);case 1:return Ni(n.topRightBorderDoubleInnerBox,n.topRightPaddingBox,n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox);case 2:return Ni(n.bottomRightBorderDoubleInnerBox,n.bottomRightPaddingBox,n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox);case 3:default:return Ni(n.bottomLeftBorderDoubleInnerBox,n.bottomLeftPaddingBox,n.topLeftBorderDoubleInnerBox,n.topLeftPaddingBox)}},wD=function(n,e){switch(e){case 0:return jf(n.topLeftBorderStroke,n.topRightBorderStroke);case 1:return jf(n.topRightBorderStroke,n.bottomRightBorderStroke);case 2:return jf(n.bottomRightBorderStroke,n.bottomLeftBorderStroke);case 3:default:return jf(n.bottomLeftBorderStroke,n.topLeftBorderStroke)}},jf=function(n,e){var t=[];return ki(n)?t.push(n.subdivide(.5,!1)):t.push(n),ki(e)?t.push(e.subdivide(.5,!0)):t.push(e),t},Ni=function(n,e,t,r){var o=[];return ki(n)?o.push(n.subdivide(.5,!1)):o.push(n),ki(t)?o.push(t.subdivide(.5,!0)):o.push(t),ki(r)?o.push(r.subdivide(.5,!0).reverse()):o.push(r),ki(e)?o.push(e.subdivide(.5,!1).reverse()):o.push(e),o},nz=function(n){var e=n.bounds,t=n.styles;return e.add(t.borderLeftWidth,t.borderTopWidth,-(t.borderRightWidth+t.borderLeftWidth),-(t.borderTopWidth+t.borderBottomWidth))},Gp=function(n){var e=n.styles,t=n.bounds,r=Ln(e.paddingLeft,t.width),o=Ln(e.paddingRight,t.width),s=Ln(e.paddingTop,t.width),i=Ln(e.paddingBottom,t.width);return t.add(r+e.borderLeftWidth,s+e.borderTopWidth,-(e.borderRightWidth+e.borderLeftWidth+r+o),-(e.borderTopWidth+e.borderBottomWidth+s+i))},yD=function(n,e){return n===0?e.bounds:n===2?Gp(e):nz(e)},_D=function(n,e){return n===0?e.bounds:n===2?Gp(e):nz(e)},e0=function(n,e,t){var r=yD(Xd(n.styles.backgroundOrigin,e),n),o=_D(Xd(n.styles.backgroundClip,e),n),s=bD(Xd(n.styles.backgroundSize,e),t,r),i=s[0],a=s[1],A=bu(Xd(n.styles.backgroundPosition,e),r.width-i,r.height-a),d=xD(Xd(n.styles.backgroundRepeat,e),A,s,r,o),c=Math.round(r.left+A[0]),u=Math.round(r.top+A[1]);return i=Math.max(1,i),a=Math.max(1,a),[d,c,u,i,a]},qd=function(n){return sn(n)&&n.value===gc.AUTO},Rf=function(n){return typeof n=="number"},bD=function(n,e,t){var r=e[0],o=e[1],s=e[2],i=n[0],a=n[1];if(!i)return[0,0];if(Zn(i)&&a&&Zn(a))return[Ln(i,t.width),Ln(a,t.height)];var A=Rf(s);if(sn(i)&&(i.value===gc.CONTAIN||i.value===gc.COVER)){if(Rf(s)){var d=t.width/t.height;return d<s!=(i.value===gc.COVER)?[t.width,t.width/s]:[t.height*s,t.height]}return[t.width,t.height]}var c=Rf(r),u=Rf(o),h=c||u;if(qd(i)&&(!a||qd(a))){if(c&&u)return[r,o];if(!A&&!h)return[t.width,t.height];if(h&&A){var p=c?r:o*s,v=u?o:r/s;return[p,v]}var w=c?r:t.width,y=u?o:t.height;return[w,y]}if(A){var B=0,C=0;return Zn(i)?B=Ln(i,t.width):Zn(a)&&(C=Ln(a,t.height)),qd(i)?B=C*s:(!a||qd(a))&&(C=B/s),[B,C]}var Q=null,k=null;if(Zn(i)?Q=Ln(i,t.width):a&&Zn(a)&&(k=Ln(a,t.height)),Q!==null&&(!a||qd(a))&&(k=c&&u?Q/r*o:t.height),k!==null&&qd(i)&&(Q=c&&u?k/o*r:t.width),Q!==null&&k!==null)return[Q,k];throw new Error("Unable to calculate background-size for element")},Xd=function(n,e){var t=n[e];return typeof t>"u"?n[0]:t},xD=function(n,e,t,r,o){var s=e[0],i=e[1],a=t[0],A=t[1];switch(n){case 2:return[new nr(Math.round(r.left),Math.round(r.top+i)),new nr(Math.round(r.left+r.width),Math.round(r.top+i)),new nr(Math.round(r.left+r.width),Math.round(A+r.top+i)),new nr(Math.round(r.left),Math.round(A+r.top+i))];case 3:return[new nr(Math.round(r.left+s),Math.round(r.top)),new nr(Math.round(r.left+s+a),Math.round(r.top)),new nr(Math.round(r.left+s+a),Math.round(r.height+r.top)),new nr(Math.round(r.left+s),Math.round(r.height+r.top))];case 1:return[new nr(Math.round(r.left+s),Math.round(r.top+i)),new nr(Math.round(r.left+s+a),Math.round(r.top+i)),new nr(Math.round(r.left+s+a),Math.round(r.top+i+A)),new nr(Math.round(r.left+s),Math.round(r.top+i+A))];default:return[new nr(Math.round(o.left),Math.round(o.top)),new nr(Math.round(o.left+o.width),Math.round(o.top)),new nr(Math.round(o.left+o.width),Math.round(o.height+o.top)),new nr(Math.round(o.left),Math.round(o.height+o.top))]}},BD="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",l_="Hidden Text",zD=function(){function n(e){this._data={},this._document=e}return n.prototype.parseMetrics=function(e,t){var r=this._document.createElement("div"),o=this._document.createElement("img"),s=this._document.createElement("span"),i=this._document.body;r.style.visibility="hidden",r.style.fontFamily=e,r.style.fontSize=t,r.style.margin="0",r.style.padding="0",r.style.whiteSpace="nowrap",i.appendChild(r),o.src=BD,o.width=1,o.height=1,o.style.margin="0",o.style.padding="0",o.style.verticalAlign="baseline",s.style.fontFamily=e,s.style.fontSize=t,s.style.margin="0",s.style.padding="0",s.appendChild(this._document.createTextNode(l_)),r.appendChild(s),r.appendChild(o);var a=o.offsetTop-s.offsetTop+2;r.removeChild(s),r.appendChild(this._document.createTextNode(l_)),r.style.lineHeight="normal",o.style.verticalAlign="super";var A=o.offsetTop-r.offsetTop+2;return i.removeChild(r),{baseline:a,middle:A}},n.prototype.getMetrics=function(e,t){var r="".concat(e," ").concat(t);return typeof this._data[r]>"u"&&(this._data[r]=this.parseMetrics(e,t)),this._data[r]},n}(),oz=function(){function n(e,t){this.context=e,this.options=t}return n}(),CD=1e4,SD=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o._activeEffects=[],o.canvas=r.canvas?r.canvas:document.createElement("canvas"),o.ctx=o.canvas.getContext("2d"),r.canvas||(o.canvas.width=Math.floor(r.width*r.scale),o.canvas.height=Math.floor(r.height*r.scale),o.canvas.style.width="".concat(r.width,"px"),o.canvas.style.height="".concat(r.height,"px")),o.fontMetrics=new zD(document),o.ctx.scale(o.options.scale,o.options.scale),o.ctx.translate(-r.x,-r.y),o.ctx.textBaseline="bottom",o._activeEffects=[],o.context.logger.debug("Canvas renderer initialized (".concat(r.width,"x").concat(r.height,") with scale ").concat(r.scale)),o}return e.prototype.applyEffects=function(t){for(var r=this;this._activeEffects.length;)this.popEffect();t.forEach(function(o){return r.applyEffect(o)})},e.prototype.applyEffect=function(t){this.ctx.save(),fD(t)&&(this.ctx.globalAlpha=t.opacity),hD(t)&&(this.ctx.translate(t.offsetX,t.offsetY),this.ctx.transform(t.matrix[0],t.matrix[1],t.matrix[2],t.matrix[3],t.matrix[4],t.matrix[5]),this.ctx.translate(-t.offsetX,-t.offsetY)),ZB(t)&&(this.path(t.path),this.ctx.clip()),this._activeEffects.push(t)},e.prototype.popEffect=function(){this._activeEffects.pop(),this.ctx.restore()},e.prototype.renderStack=function(t){return Os(this,void 0,void 0,function(){var r;return zs(this,function(o){switch(o.label){case 0:return r=t.element.container.styles,r.isVisible()?[4,this.renderStackContent(t)]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})},e.prototype.renderNode=function(t){return Os(this,void 0,void 0,function(){return zs(this,function(r){switch(r.label){case 0:if(qo(t.container.flags,16))debugger;return t.container.styles.isVisible()?[4,this.renderNodeBackgroundAndBorders(t)]:[3,3];case 1:return r.sent(),[4,this.renderNodeContent(t)];case 2:r.sent(),r.label=3;case 3:return[2]}})})},e.prototype.renderTextWithLetterSpacing=function(t,r,o){var s=this;if(r===0)navigator.userAgent.indexOf("Firefox")===-1?(this.ctx.textBaseline="ideographic",this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+t.bounds.height)):this.ctx.fillText(t.text,t.bounds.left,t.bounds.top+o);else{var i=X1(t.text);i.reduce(function(a,A){return s.ctx.fillText(A,a,t.bounds.top+o),a+s.ctx.measureText(A).width},t.bounds.left)}},e.prototype.createFontStyle=function(t){var r=t.fontVariant.filter(function(i){return i==="normal"||i==="small-caps"}).join(""),o=QD(t.fontFamily).join(", "),s=_l(t.fontSize)?"".concat(t.fontSize.number).concat(t.fontSize.unit):"".concat(t.fontSize.number,"px");return[[t.fontStyle,r,t.fontWeight,s,o].join(" "),o,s]},e.prototype.renderTextNode=function(t,r){return Os(this,void 0,void 0,function(){var o,s,i=this;return zs(this,function(a){return o=this.createFontStyle(r)[0],this.ctx.font=o,this.ctx.direction=r.direction===1?"rtl":"ltr",this.ctx.textAlign="left",this.ctx.textBaseline="alphabetic",s=r.paintOrder,t.textBounds.forEach(function(A){s.forEach(function(d){switch(d){case 0:i.ctx.fillStyle=ts(r.color),i.renderTextWithLetterSpacing(A,r.letterSpacing,r.fontSize.number);var c=r.textShadow;if(c.length&&A.text.trim().length&&(c.slice(0).reverse().forEach(function(h){i.ctx.shadowColor=ts(h.color),i.ctx.shadowOffsetX=h.offsetX.number*i.options.scale,i.ctx.shadowOffsetY=h.offsetY.number*i.options.scale,i.ctx.shadowBlur=h.blur.number,i.renderTextWithLetterSpacing(A,r.letterSpacing,r.fontSize.number)}),i.ctx.shadowColor="",i.ctx.shadowOffsetX=0,i.ctx.shadowOffsetY=0,i.ctx.shadowBlur=0),r.textDecorationLine.length){i.ctx.fillStyle=ts(r.textDecorationColor||r.color);var u=1;r.textDecorationLine.forEach(function(h){switch(h){case 1:i.ctx.fillRect(A.bounds.left,A.bounds.top+A.bounds.height-u,A.bounds.width,u);break;case 2:i.ctx.fillRect(A.bounds.left,A.bounds.top,A.bounds.width,u);break;case 3:i.ctx.fillRect(A.bounds.left,A.bounds.top+(A.bounds.height/2-u/2),A.bounds.width,u);break}})}break;case 1:r.webkitTextStrokeWidth&&A.text.trim().length&&(i.ctx.strokeStyle=ts(r.webkitTextStrokeColor),i.ctx.lineWidth=r.webkitTextStrokeWidth,i.ctx.lineJoin=window.chrome?"miter":"round",i.ctx.strokeText(A.text,A.bounds.left,A.bounds.top+A.bounds.height)),i.ctx.strokeStyle="",i.ctx.lineWidth=0,i.ctx.lineJoin="miter";break}})}),[2]})})},e.prototype.renderReplacedElement=function(t,r,o){var s=o.naturalWidth||t.intrinsicWidth,i=o.naturalHeight||t.intrinsicHeight;if(o&&s>0&&i>0){var a=Gp(t),A=Vp(r);this.path(A),this.ctx.save(),this.ctx.clip();var d=0,c=0,u=s,h=i,p=a.left,v=a.top,w=a.width,y=a.height,B=t.styles.objectFit,C=w/y,Q=u/h;if(B===2)Q>C?(y=w/Q,v+=(a.height-y)/2):(w=y*Q,p+=(a.width-w)/2);else if(B===4)Q>C?(u=h*C,d+=(s-u)/2):(h=u/C,c+=(i-h)/2);else if(B===8)u>w?(d+=(u-w)/2,u=w):(p+=(w-u)/2,w=u),h>y?(c+=(h-y)/2,h=y):(v+=(y-h)/2,y=h);else if(B===16){var k=Q>C?w:y*Q,H=u>w?u:w;k<H?Q>C?(y=w/Q,v+=(a.height-y)/2):(w=y*Q,p+=(a.width-w)/2):(u>w?(d+=(u-w)/2,u=w):(p+=(w-u)/2,w=u),h>y?(c+=(h-y)/2,h=y):(v+=(y-h)/2,y=h))}this.ctx.drawImage(o,d,c,u,h,p,v,w,y),this.ctx.restore()}},e.prototype.renderNodeContent=function(t){return Os(this,void 0,void 0,function(){var r,o,s,i,a,A,C,C,d,c,u,h,k,p,v,H,w,y,B,C,Q,k,H;return zs(this,function(Z){switch(Z.label){case 0:this.applyEffects(t.getEffects(4)),r=t.container,o=t.curves,s=r.styles,i=0,a=r.textNodes,Z.label=1;case 1:return i<a.length?(A=a[i],[4,this.renderTextNode(A,s)]):[3,4];case 2:Z.sent(),Z.label=3;case 3:return i++,[3,1];case 4:if(!(r instanceof kB))return[3,8];Z.label=5;case 5:return Z.trys.push([5,7,,8]),[4,this.context.cache.match(r.src)];case 6:return C=Z.sent(),this.renderReplacedElement(r,o,C),[3,8];case 7:return Z.sent(),this.context.logger.error("Error loading image ".concat(r.src)),[3,8];case 8:if(r instanceof OB&&this.renderReplacedElement(r,o,r.canvas),!(r instanceof DB))return[3,12];Z.label=9;case 9:return Z.trys.push([9,11,,12]),[4,this.context.cache.match(r.svg)];case 10:return C=Z.sent(),this.renderReplacedElement(r,o,C),[3,12];case 11:return Z.sent(),this.context.logger.error("Error loading svg ".concat(r.svg.substring(0,255))),[3,12];case 12:return r instanceof jB&&r.tree?(d=new e(this.context,{scale:this.options.scale,backgroundColor:r.backgroundColor,x:0,y:0,width:r.width,height:r.height}),[4,d.render(r.tree)]):[3,14];case 13:c=Z.sent(),r.width&&r.height&&this.ctx.drawImage(c,0,0,r.width,r.height,r.bounds.left,r.bounds.top,r.bounds.width,r.bounds.height),Z.label=14;case 14:if(r instanceof Y1&&(u=Math.min(r.bounds.width,r.bounds.height),r.type===jp?r.checked&&(this.ctx.save(),this.path([new nr(r.bounds.left+u*.39363,r.bounds.top+u*.79),new nr(r.bounds.left+u*.16,r.bounds.top+u*.5549),new nr(r.bounds.left+u*.27347,r.bounds.top+u*.44071),new nr(r.bounds.left+u*.39694,r.bounds.top+u*.5649),new nr(r.bounds.left+u*.72983,r.bounds.top+u*.23),new nr(r.bounds.left+u*.84,r.bounds.top+u*.34085),new nr(r.bounds.left+u*.39363,r.bounds.top+u*.79)]),this.ctx.fillStyle=ts(Xy),this.ctx.fill(),this.ctx.restore()):r.type===Rp&&r.checked&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.arc(r.bounds.left+u/2,r.bounds.top+u/2,u/4,0,Math.PI*2,!0),this.ctx.fillStyle=ts(Xy),this.ctx.fill(),this.ctx.restore())),ED(r)&&r.value.length){switch(h=this.createFontStyle(s),k=h[0],p=h[1],v=this.fontMetrics.getMetrics(k,p).baseline,this.ctx.font=k,this.ctx.fillStyle=ts(s.color),this.ctx.textBaseline="alphabetic",this.ctx.textAlign=ID(r.styles.textAlign),H=Gp(r),w=0,r.styles.textAlign){case 1:w+=H.width/2;break;case 2:w+=H.width;break}y=H.add(w,0,0,-H.height/2+1),this.ctx.save(),this.path([new nr(H.left,H.top),new nr(H.left+H.width,H.top),new nr(H.left+H.width,H.top+H.height),new nr(H.left,H.top+H.height)]),this.ctx.clip(),this.renderTextWithLetterSpacing(new Pu(r.value,y),s.letterSpacing,v),this.ctx.restore(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left"}if(!qo(r.styles.display,2048))return[3,20];if(r.styles.listStyleImage===null)return[3,19];if(B=r.styles.listStyleImage,B.type!==0)return[3,18];C=void 0,Q=B.url,Z.label=15;case 15:return Z.trys.push([15,17,,18]),[4,this.context.cache.match(Q)];case 16:return C=Z.sent(),this.ctx.drawImage(C,r.bounds.left-(C.width+10),r.bounds.top),[3,18];case 17:return Z.sent(),this.context.logger.error("Error loading list-style-image ".concat(Q)),[3,18];case 18:return[3,20];case 19:t.listValue&&r.styles.listStyleType!==-1&&(k=this.createFontStyle(s)[0],this.ctx.font=k,this.ctx.fillStyle=ts(s.color),this.ctx.textBaseline="middle",this.ctx.textAlign="right",H=new CA(r.bounds.left,r.bounds.top+Ln(r.styles.paddingTop,r.bounds.width),r.bounds.width,Ty(s.lineHeight,s.fontSize.number)/2+1),this.renderTextWithLetterSpacing(new Pu(t.listValue,H),s.letterSpacing,Ty(s.lineHeight,s.fontSize.number)/2+2),this.ctx.textBaseline="bottom",this.ctx.textAlign="left"),Z.label=20;case 20:return[2]}})})},e.prototype.renderStackContent=function(t){return Os(this,void 0,void 0,function(){var r,o,B,s,i,B,a,A,B,d,c,B,u,h,B,p,v,B,w,y,B;return zs(this,function(C){switch(C.label){case 0:if(qo(t.element.container.flags,16))debugger;return[4,this.renderNodeBackgroundAndBorders(t.element)];case 1:C.sent(),r=0,o=t.negativeZIndex,C.label=2;case 2:return r<o.length?(B=o[r],[4,this.renderStack(B)]):[3,5];case 3:C.sent(),C.label=4;case 4:return r++,[3,2];case 5:return[4,this.renderNodeContent(t.element)];case 6:C.sent(),s=0,i=t.nonInlineLevel,C.label=7;case 7:return s<i.length?(B=i[s],[4,this.renderNode(B)]):[3,10];case 8:C.sent(),C.label=9;case 9:return s++,[3,7];case 10:a=0,A=t.nonPositionedFloats,C.label=11;case 11:return a<A.length?(B=A[a],[4,this.renderStack(B)]):[3,14];case 12:C.sent(),C.label=13;case 13:return a++,[3,11];case 14:d=0,c=t.nonPositionedInlineLevel,C.label=15;case 15:return d<c.length?(B=c[d],[4,this.renderStack(B)]):[3,18];case 16:C.sent(),C.label=17;case 17:return d++,[3,15];case 18:u=0,h=t.inlineLevel,C.label=19;case 19:return u<h.length?(B=h[u],[4,this.renderNode(B)]):[3,22];case 20:C.sent(),C.label=21;case 21:return u++,[3,19];case 22:p=0,v=t.zeroOrAutoZIndexOrTransformedOrOpacity,C.label=23;case 23:return p<v.length?(B=v[p],[4,this.renderStack(B)]):[3,26];case 24:C.sent(),C.label=25;case 25:return p++,[3,23];case 26:w=0,y=t.positiveZIndex,C.label=27;case 27:return w<y.length?(B=y[w],[4,this.renderStack(B)]):[3,30];case 28:C.sent(),C.label=29;case 29:return w++,[3,27];case 30:return[2]}})})},e.prototype.mask=function(t){this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(this.canvas.width,0),this.ctx.lineTo(this.canvas.width,this.canvas.height),this.ctx.lineTo(0,this.canvas.height),this.ctx.lineTo(0,0),this.formatPath(t.slice(0).reverse()),this.ctx.closePath()},e.prototype.path=function(t){this.ctx.beginPath(),this.formatPath(t),this.ctx.closePath()},e.prototype.formatPath=function(t){var r=this;t.forEach(function(o,s){var i=ki(o)?o.start:o;s===0?r.ctx.moveTo(i.x,i.y):r.ctx.lineTo(i.x,i.y),ki(o)&&r.ctx.bezierCurveTo(o.startControl.x,o.startControl.y,o.endControl.x,o.endControl.y,o.end.x,o.end.y)})},e.prototype.renderRepeat=function(t,r,o,s){this.path(t),this.ctx.fillStyle=r,this.ctx.translate(o,s),this.ctx.fill(),this.ctx.translate(-o,-s)},e.prototype.resizeImage=function(t,r,o){var s,i=(s=this.canvas.ownerDocument)!==null&&s!==void 0?s:document,a=i.createElement("canvas");a.width=Math.max(1,r),a.height=Math.max(1,o);var A=a.getContext("2d");return A.drawImage(t,0,0,t.width,t.height,0,0,r,o),a},e.prototype.renderBackgroundImage=function(t){return Os(this,void 0,void 0,function(){var r,o,s,i,a,A;return zs(this,function(d){switch(d.label){case 0:r=t.styles.backgroundImage.length-1,o=function(c){var u,h,p,v,w,R,te,Ce,fe,ie,be,y,R,te,Ce,fe,ie,B,C,Q,k,H,Z,q,N,re,be,L,R,J,se,fe,ie,pe,te,Ce,ne,ze,z,E,F,I,O,D;return zs(this,function(P){switch(P.label){case 0:if(c.type!==0)return[3,5];u=void 0,h=c.url,P.label=1;case 1:return P.trys.push([1,3,,4]),[4,s.context.cache.match(h)];case 2:return u=P.sent(),[3,4];case 3:return P.sent(),s.context.logger.error("Error loading background-image ".concat(h)),[3,4];case 4:return u&&(p=isNaN(u.width)||u.width===0?1:u.width,v=isNaN(u.height)||u.height===0?1:u.height,w=e0(t,r,[p,v,p/v]),R=w[0],te=w[1],Ce=w[2],fe=w[3],ie=w[4],be=s.ctx.createPattern(s.resizeImage(u,fe,ie),"repeat"),s.renderRepeat(R,be,te,Ce)),[3,6];case 5:dk(c)?(y=e0(t,r,[null,null,null]),R=y[0],te=y[1],Ce=y[2],fe=y[3],ie=y[4],B=sk(c.angle,fe,ie),C=B[0],Q=B[1],k=B[2],H=B[3],Z=B[4],q=document.createElement("canvas"),q.width=fe,q.height=ie,N=q.getContext("2d"),re=N.createLinearGradient(Q,H,k,Z),Uy(c.stops,C).forEach(function(K){return re.addColorStop(K.stop,ts(K.color))}),N.fillStyle=re,N.fillRect(0,0,fe,ie),fe>0&&ie>0&&(be=s.ctx.createPattern(q,"repeat"),s.renderRepeat(R,be,te,Ce))):ck(c)&&(L=e0(t,r,[null,null,null]),R=L[0],J=L[1],se=L[2],fe=L[3],ie=L[4],pe=c.position.length===0?[K1]:c.position,te=Ln(pe[0],fe),Ce=Ln(pe[pe.length-1],ie),ne=ik(c,te,Ce,fe,ie),ze=ne[0],z=ne[1],ze>0&&z>0&&(E=s.ctx.createRadialGradient(J+te,se+Ce,0,J+te,se+Ce,ze),Uy(c.stops,ze*2).forEach(function(K){return E.addColorStop(K.stop,ts(K.color))}),s.path(R),s.ctx.fillStyle=E,ze!==z?(F=t.bounds.left+.5*t.bounds.width,I=t.bounds.top+.5*t.bounds.height,O=z/ze,D=1/O,s.ctx.save(),s.ctx.translate(F,I),s.ctx.transform(1,0,0,O,0,0),s.ctx.translate(-F,-I),s.ctx.fillRect(J,D*(se-I)+I,fe,ie*D),s.ctx.restore()):s.ctx.fill())),P.label=6;case 6:return r--,[2]}})},s=this,i=0,a=t.styles.backgroundImage.slice(0).reverse(),d.label=1;case 1:return i<a.length?(A=a[i],[5,o(A)]):[3,4];case 2:d.sent(),d.label=3;case 3:return i++,[3,1];case 4:return[2]}})})},e.prototype.renderSolidBorder=function(t,r,o){return Os(this,void 0,void 0,function(){return zs(this,function(s){return this.path(A_(o,r)),this.ctx.fillStyle=ts(t),this.ctx.fill(),[2]})})},e.prototype.renderDoubleBorder=function(t,r,o,s){return Os(this,void 0,void 0,function(){var i,a;return zs(this,function(A){switch(A.label){case 0:return r<3?[4,this.renderSolidBorder(t,o,s)]:[3,2];case 1:return A.sent(),[2];case 2:return i=vD(s,o),this.path(i),this.ctx.fillStyle=ts(t),this.ctx.fill(),a=mD(s,o),this.path(a),this.ctx.fill(),[2]}})})},e.prototype.renderNodeBackgroundAndBorders=function(t){return Os(this,void 0,void 0,function(){var r,o,s,i,a,A,d,c,u=this;return zs(this,function(h){switch(h.label){case 0:return this.applyEffects(t.getEffects(2)),r=t.container.styles,o=!ll(r.backgroundColor)||r.backgroundImage.length,s=[{style:r.borderTopStyle,color:r.borderTopColor,width:r.borderTopWidth},{style:r.borderRightStyle,color:r.borderRightColor,width:r.borderRightWidth},{style:r.borderBottomStyle,color:r.borderBottomColor,width:r.borderBottomWidth},{style:r.borderLeftStyle,color:r.borderLeftColor,width:r.borderLeftWidth}],i=FD(Xd(r.backgroundClip,0),t.curves),o||r.boxShadow.length?(this.ctx.save(),this.path(i),this.ctx.clip(),ll(r.backgroundColor)||(this.ctx.fillStyle=ts(r.backgroundColor),this.ctx.fill()),[4,this.renderBackgroundImage(t.container)]):[3,2];case 1:h.sent(),this.ctx.restore(),r.boxShadow.slice(0).reverse().forEach(function(p){u.ctx.save();var v=$p(t.curves),w=p.inset?0:CD,y=pD(v,-w+(p.inset?1:-1)*p.spread.number,(p.inset?1:-1)*p.spread.number,p.spread.number*(p.inset?-2:2),p.spread.number*(p.inset?-2:2));p.inset?(u.path(v),u.ctx.clip(),u.mask(y)):(u.mask(v),u.ctx.clip(),u.path(y)),u.ctx.shadowOffsetX=p.offsetX.number+w,u.ctx.shadowOffsetY=p.offsetY.number,u.ctx.shadowColor=ts(p.color),u.ctx.shadowBlur=p.blur.number,u.ctx.fillStyle=p.inset?ts(p.color):"rgba(0,0,0,1)",u.ctx.fill(),u.ctx.restore()}),h.label=2;case 2:a=0,A=0,d=s,h.label=3;case 3:return A<d.length?(c=d[A],c.style!==0&&!ll(c.color)&&c.width>0?c.style!==2?[3,5]:[4,this.renderDashedDottedBorder(c.color,c.width,a,t.curves,2)]:[3,11]):[3,13];case 4:return h.sent(),[3,11];case 5:return c.style!==3?[3,7]:[4,this.renderDashedDottedBorder(c.color,c.width,a,t.curves,3)];case 6:return h.sent(),[3,11];case 7:return c.style!==4?[3,9]:[4,this.renderDoubleBorder(c.color,c.width,a,t.curves)];case 8:return h.sent(),[3,11];case 9:return[4,this.renderSolidBorder(c.color,a,t.curves)];case 10:h.sent(),h.label=11;case 11:a++,h.label=12;case 12:return A++,[3,3];case 13:return[2]}})})},e.prototype.renderDashedDottedBorder=function(t,r,o,s,i){return Os(this,void 0,void 0,function(){var a,A,d,c,u,h,p,v,w,y,B,C,Q,k,H,Z,H,Z;return zs(this,function(q){return this.ctx.save(),a=wD(s,o),A=A_(s,o),i===2&&(this.path(A),this.ctx.clip()),ki(A[0])?(d=A[0].start.x,c=A[0].start.y):(d=A[0].x,c=A[0].y),ki(A[1])?(u=A[1].end.x,h=A[1].end.y):(u=A[1].x,h=A[1].y),o===0||o===2?p=Math.abs(d-u):p=Math.abs(c-h),this.ctx.beginPath(),i===3?this.formatPath(a):this.formatPath(A.slice(0,2)),v=r<3?r*3:r*2,w=r<3?r*2:r,i===3&&(v=r,w=r),y=!0,p<=v*2?y=!1:p<=v*2+w?(B=p/(2*v+w),v*=B,w*=B):(C=Math.floor((p+w)/(v+w)),Q=(p-C*v)/(C-1),k=(p-(C+1)*v)/C,w=k<=0||Math.abs(w-Q)<Math.abs(w-k)?Q:k),y&&(i===3?this.ctx.setLineDash([0,v+w]):this.ctx.setLineDash([v,w])),i===3?(this.ctx.lineCap="round",this.ctx.lineWidth=r):this.ctx.lineWidth=r*2+1.1,this.ctx.strokeStyle=ts(t),this.ctx.stroke(),this.ctx.setLineDash([]),i===2&&(ki(A[0])&&(H=A[3],Z=A[0],this.ctx.beginPath(),this.formatPath([new nr(H.end.x,H.end.y),new nr(Z.start.x,Z.start.y)]),this.ctx.stroke()),ki(A[1])&&(H=A[1],Z=A[2],this.ctx.beginPath(),this.formatPath([new nr(H.end.x,H.end.y),new nr(Z.start.x,Z.start.y)]),this.ctx.stroke())),this.ctx.restore(),[2]})})},e.prototype.render=function(t){return Os(this,void 0,void 0,function(){var r;return zs(this,function(o){switch(o.label){case 0:return this.options.backgroundColor&&(this.ctx.fillStyle=ts(this.options.backgroundColor),this.ctx.fillRect(this.options.x,this.options.y,this.options.width,this.options.height)),r=gD(t),[4,this.renderStack(r)];case 1:return o.sent(),this.applyEffects([]),[2,this.canvas]}})})},e}(oz),ED=function(n){return n instanceof HB||n instanceof MB?!0:n instanceof Y1&&n.type!==Rp&&n.type!==jp},FD=function(n,e){switch(n){case 0:return $p(e);case 2:return dD(e);case 1:default:return Vp(e)}},ID=function(n){switch(n){case 1:return"center";case 2:return"right";case 0:default:return"left"}},UD=["-apple-system","system-ui"],QD=function(n){return/iPhone OS 15_(0|1)/.test(window.navigator.userAgent)?n.filter(function(e){return UD.indexOf(e)===-1}):n},TD=function(n){da(e,n);function e(t,r){var o=n.call(this,t,r)||this;return o.canvas=r.canvas?r.canvas:document.createElement("canvas"),o.ctx=o.canvas.getContext("2d"),o.options=r,o.canvas.width=Math.floor(r.width*r.scale),o.canvas.height=Math.floor(r.height*r.scale),o.canvas.style.width="".concat(r.width,"px"),o.canvas.style.height="".concat(r.height,"px"),o.ctx.scale(o.options.scale,o.options.scale),o.ctx.translate(-r.x,-r.y),o.context.logger.debug("EXPERIMENTAL ForeignObject renderer initialized (".concat(r.width,"x").concat(r.height," at ").concat(r.x,",").concat(r.y,") with scale ").concat(r.scale)),o}return e.prototype.render=function(t){return Os(this,void 0,void 0,function(){var r,o;return zs(this,function(s){switch(s.label){case 0:return r=mm(this.options.width*this.options.scale,this.options.height*this.options.scale,this.options.scale,this.options.scale,t),[4,LD(r)];case 1:return o=s.sent(),this.options.backgroundColor&&(this.ctx.fillStyle=ts(this.options.backgroundColor),this.ctx.fillRect(0,0,this.options.width*this.options.scale,this.options.height*this.options.scale)),this.ctx.drawImage(o,-this.options.x*this.options.scale,-this.options.y*this.options.scale),[2,this.canvas]}})})},e}(oz),LD=function(n){return new Promise(function(e,t){var r=new Image;r.onload=function(){e(r)},r.onerror=t,r.src="data:image/svg+xml;charset=utf-8,".concat(encodeURIComponent(new XMLSerializer().serializeToString(n)))})},PD=function(){function n(e){var t=e.id,r=e.enabled;this.id=t,this.enabled=r,this.start=Date.now()}return n.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.debug=="function"?console.debug.apply(console,_f([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.prototype.getTime=function(){return Date.now()-this.start},n.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&typeof window<"u"&&window.console&&typeof console.info=="function"&&console.info.apply(console,_f([this.id,"".concat(this.getTime(),"ms")],e,!1))},n.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.warn=="function"?console.warn.apply(console,_f([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.enabled&&(typeof window<"u"&&window.console&&typeof console.error=="function"?console.error.apply(console,_f([this.id,"".concat(this.getTime(),"ms")],e,!1)):this.info.apply(this,e))},n.instances={},n}(),kD=function(){function n(e,t){var r;this.windowBounds=t,this.instanceName="#".concat(n.instanceCount++),this.logger=new PD({id:this.instanceName,enabled:e.logging}),this.cache=(r=e.cache)!==null&&r!==void 0?r:new rD(this,e)}return n.instanceCount=1,n}(),OD=function(n,e){return e===void 0&&(e={}),DD(n,e)};typeof window<"u"&&JB.setContext(window);var DD=function(n,e){return Os(void 0,void 0,void 0,function(){var t,r,o,s,i,a,A,d,c,u,h,p,v,w,y,B,C,Q,k,H,q,Z,q,N,re,be,L,R,J,se,fe,ie,pe,te,Ce,ne,ze,z,E,F;return zs(this,function(I){switch(I.label){case 0:if(!n||typeof n!="object")return[2,Promise.reject("Invalid element provided as first argument")];if(t=n.ownerDocument,!t)throw new Error("Element is not attached to a Document");if(r=t.defaultView,!r)throw new Error("Document is not attached to a Window");return o={allowTaint:(N=e.allowTaint)!==null&&N!==void 0?N:!1,imageTimeout:(re=e.imageTimeout)!==null&&re!==void 0?re:15e3,proxy:e.proxy,useCORS:(be=e.useCORS)!==null&&be!==void 0?be:!1},s=tm({logging:(L=e.logging)!==null&&L!==void 0?L:!0,cache:e.cache},o),i={windowWidth:(R=e.windowWidth)!==null&&R!==void 0?R:r.innerWidth,windowHeight:(J=e.windowHeight)!==null&&J!==void 0?J:r.innerHeight,scrollX:(se=e.scrollX)!==null&&se!==void 0?se:r.pageXOffset,scrollY:(fe=e.scrollY)!==null&&fe!==void 0?fe:r.pageYOffset},a=new CA(i.scrollX,i.scrollY,i.windowWidth,i.windowHeight),A=new kD(s,a),d=(ie=e.foreignObjectRendering)!==null&&ie!==void 0?ie:!1,c={allowTaint:(pe=e.allowTaint)!==null&&pe!==void 0?pe:!1,onclone:e.onclone,ignoreElements:e.ignoreElements,inlineImages:d,copyStyles:d},A.logger.debug("Starting document clone with size ".concat(a.width,"x").concat(a.height," scrolled to ").concat(-a.left,",").concat(-a.top)),u=new s_(A,n,c),h=u.clonedReferenceElement,h?[4,u.toIFrame(t,a)]:[2,Promise.reject("Unable to find element in cloned iframe")];case 1:return p=I.sent(),v=J1(h)||D8(h)?y6(h.ownerDocument):zg(A,h),w=v.width,y=v.height,B=v.left,C=v.top,Q=ND(A,h,e.backgroundColor),k={canvas:e.canvas,backgroundColor:Q,scale:(Ce=(te=e.scale)!==null&&te!==void 0?te:r.devicePixelRatio)!==null&&Ce!==void 0?Ce:1,x:((ne=e.x)!==null&&ne!==void 0?ne:0)+B,y:((ze=e.y)!==null&&ze!==void 0?ze:0)+C,width:(z=e.width)!==null&&z!==void 0?z:Math.ceil(w),height:(E=e.height)!==null&&E!==void 0?E:Math.ceil(y)},d?(A.logger.debug("Document cloned, using foreign object rendering"),q=new TD(A,k),[4,q.render(h)]):[3,3];case 2:return H=I.sent(),[3,5];case 3:return A.logger.debug("Document cloned, element located at ".concat(B,",").concat(C," with size ").concat(w,"x").concat(y," using computed rendering")),A.logger.debug("Starting DOM parsing"),Z=qB(A,h),Q===Z.styles.backgroundColor&&(Z.styles.backgroundColor=ka.TRANSPARENT),A.logger.debug("Starting renderer for element at ".concat(k.x,",").concat(k.y," with size ").concat(k.width,"x").concat(k.height)),q=new SD(A,k),[4,q.render(Z)];case 4:H=I.sent(),I.label=5;case 5:return(!((F=e.removeContainer)!==null&&F!==void 0)||F)&&(s_.destroy(p)||A.logger.error("Cannot detach cloned iframe as it is not in the DOM anymore")),A.logger.debug("Finished rendering"),[2,H]}})})},ND=function(n,e,t){var r=e.ownerDocument,o=r.documentElement?pc(n,getComputedStyle(r.documentElement).backgroundColor):ka.TRANSPARENT,s=r.body?pc(n,getComputedStyle(r.body).backgroundColor):ka.TRANSPARENT,i=typeof t=="string"?pc(n,t):t===null?ka.TRANSPARENT:4294967295;return e===r.documentElement?ll(o)?ll(s)?i:s:o:i};function Pn(n){"@babel/helpers - typeof";return Pn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pn(n)}var Es=Uint8Array,bi=Uint16Array,Z1=Int32Array,Ng=new Es([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Mg=new Es([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),zm=new Es([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),sz=function(n,e){for(var t=new bi(31),r=0;r<31;++r)t[r]=e+=1<<n[r-1];for(var o=new Z1(t[30]),r=1;r<30;++r)for(var s=t[r];s<t[r+1];++s)o[s]=s-t[r]<<5|r;return{b:t,r:o}},iz=sz(Ng,2),az=iz.b,Cm=iz.r;az[28]=258,Cm[258]=28;var Az=sz(Mg,0),MD=Az.b,d_=Az.r,Sm=new bi(32768);for(var eo=0;eo<32768;++eo){var VA=(eo&43690)>>1|(eo&21845)<<1;VA=(VA&52428)>>2|(VA&13107)<<2,VA=(VA&61680)>>4|(VA&3855)<<4,Sm[eo]=((VA&65280)>>8|(VA&255)<<8)>>1}var Oa=function(n,e,t){for(var r=n.length,o=0,s=new bi(e);o<r;++o)n[o]&&++s[n[o]-1];var i=new bi(e);for(o=1;o<e;++o)i[o]=i[o-1]+s[o-1]<<1;var a;if(t){a=new bi(1<<e);var A=15-e;for(o=0;o<r;++o)if(n[o])for(var d=o<<4|n[o],c=e-n[o],u=i[n[o]-1]++<<c,h=u|(1<<c)-1;u<=h;++u)a[Sm[u]>>A]=d}else for(a=new bi(r),o=0;o<r;++o)n[o]&&(a[o]=Sm[i[n[o]-1]++]>>15-n[o]);return a},vl=new Es(288);for(var eo=0;eo<144;++eo)vl[eo]=8;for(var eo=144;eo<256;++eo)vl[eo]=9;for(var eo=256;eo<280;++eo)vl[eo]=7;for(var eo=280;eo<288;++eo)vl[eo]=8;var sh=new Es(32);for(var eo=0;eo<32;++eo)sh[eo]=5;var HD=Oa(vl,9,0),jD=Oa(vl,9,1),RD=Oa(sh,5,0),qD=Oa(sh,5,1),t0=function(n){for(var e=n[0],t=1;t<n.length;++t)n[t]>e&&(e=n[t]);return e},Gi=function(n,e,t){var r=e/8|0;return(n[r]|n[r+1]<<8)>>(e&7)&t},r0=function(n,e){var t=e/8|0;return(n[t]|n[t+1]<<8|n[t+2]<<16)>>(e&7)},e2=function(n){return(n+7)/8|0},lz=function(n,e,t){return(t==null||t>n.length)&&(t=n.length),new Es(n.subarray(e,t))},KD=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Zi=function(n,e,t){var r=new Error(e||KD[n]);if(r.code=n,Error.captureStackTrace&&Error.captureStackTrace(r,Zi),!t)throw r;return r},$D=function(n,e,t,r){var o=n.length,s=0;if(!o||e.f&&!e.l)return t||new Es(0);var i=!t,a=i||e.i!=2,A=e.i;i&&(t=new Es(o*3));var d=function(ge){var _e=t.length;if(ge>_e){var Me=new Es(Math.max(_e*2,ge));Me.set(t),t=Me}},c=e.f||0,u=e.p||0,h=e.b||0,p=e.l,v=e.d,w=e.m,y=e.n,B=o*8;do{if(!p){c=Gi(n,u,1);var C=Gi(n,u+1,3);if(u+=3,C)if(C==1)p=jD,v=qD,w=9,y=5;else if(C==2){var Z=Gi(n,u,31)+257,q=Gi(n,u+10,15)+4,N=Z+Gi(n,u+5,31)+1;u+=14;for(var re=new Es(N),be=new Es(19),L=0;L<q;++L)be[zm[L]]=Gi(n,u+L*3,7);u+=q*3;for(var R=t0(be),J=(1<<R)-1,se=Oa(be,R,1),L=0;L<N;){var fe=se[Gi(n,u,J)];u+=fe&15;var Q=fe>>4;if(Q<16)re[L++]=Q;else{var ie=0,pe=0;for(Q==16?(pe=3+Gi(n,u,3),u+=2,ie=re[L-1]):Q==17?(pe=3+Gi(n,u,7),u+=3):Q==18&&(pe=11+Gi(n,u,127),u+=7);pe--;)re[L++]=ie}}var te=re.subarray(0,Z),Ce=re.subarray(Z);w=t0(te),y=t0(Ce),p=Oa(te,w,1),v=Oa(Ce,y,1)}else Zi(1);else{var Q=e2(u)+4,k=n[Q-4]|n[Q-3]<<8,H=Q+k;if(H>o){A&&Zi(0);break}a&&d(h+k),t.set(n.subarray(Q,H),h),e.b=h+=k,e.p=u=H*8,e.f=c;continue}if(u>B){A&&Zi(0);break}}a&&d(h+131072);for(var ne=(1<<w)-1,ze=(1<<y)-1,z=u;;z=u){var ie=p[r0(n,u)&ne],E=ie>>4;if(u+=ie&15,u>B){A&&Zi(0);break}if(ie||Zi(2),E<256)t[h++]=E;else if(E==256){z=u,p=null;break}else{var F=E-254;if(E>264){var L=E-257,I=Ng[L];F=Gi(n,u,(1<<I)-1)+az[L],u+=I}var O=v[r0(n,u)&ze],D=O>>4;O||Zi(3),u+=O&15;var Ce=MD[D];if(D>3){var I=Mg[D];Ce+=r0(n,u)&(1<<I)-1,u+=I}if(u>B){A&&Zi(0);break}a&&d(h+131072);var P=h+F;if(h<Ce){var K=s-Ce,M=Math.min(Ce,P);for(K+h<0&&Zi(3);h<M;++h)t[h]=r[K+h]}for(;h<P;++h)t[h]=t[h-Ce]}}e.l=p,e.p=z,e.b=h,e.f=c,p&&(c=1,e.m=w,e.d=v,e.n=y)}while(!c);return h!=t.length&&i?lz(t,0,h):t.subarray(0,h)},lA=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8},cu=function(n,e,t){t<<=e&7;var r=e/8|0;n[r]|=t,n[r+1]|=t>>8,n[r+2]|=t>>16},n0=function(n,e){for(var t=[],r=0;r<n.length;++r)n[r]&&t.push({s:r,f:n[r]});var o=t.length,s=t.slice();if(!o)return{t:cz,l:0};if(o==1){var i=new Es(t[0].s+1);return i[t[0].s]=1,{t:i,l:1}}t.sort(function(H,Z){return H.f-Z.f}),t.push({s:-1,f:25001});var a=t[0],A=t[1],d=0,c=1,u=2;for(t[0]={s:-1,f:a.f+A.f,l:a,r:A};c!=o-1;)a=t[t[d].f<t[u].f?d++:u++],A=t[d!=c&&t[d].f<t[u].f?d++:u++],t[c++]={s:-1,f:a.f+A.f,l:a,r:A};for(var h=s[0].s,r=1;r<o;++r)s[r].s>h&&(h=s[r].s);var p=new bi(h+1),v=Em(t[c-1],p,0);if(v>e){var r=0,w=0,y=v-e,B=1<<y;for(s.sort(function(Z,q){return p[q.s]-p[Z.s]||Z.f-q.f});r<o;++r){var C=s[r].s;if(p[C]>e)w+=B-(1<<v-p[C]),p[C]=e;else break}for(w>>=y;w>0;){var Q=s[r].s;p[Q]<e?w-=1<<e-p[Q]++-1:++r}for(;r>=0&&w;--r){var k=s[r].s;p[k]==e&&(--p[k],++w)}v=e}return{t:new Es(p),l:v}},Em=function(n,e,t){return n.s==-1?Math.max(Em(n.l,e,t+1),Em(n.r,e,t+1)):e[n.s]=t},c_=function(n){for(var e=n.length;e&&!n[--e];);for(var t=new bi(++e),r=0,o=n[0],s=1,i=function(A){t[r++]=A},a=1;a<=e;++a)if(n[a]==o&&a!=e)++s;else{if(!o&&s>2){for(;s>138;s-=138)i(32754);s>2&&(i(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(i(o),--s;s>6;s-=6)i(8304);s>2&&(i(s-3<<5|8208),s=0)}for(;s--;)i(o);s=1,o=n[a]}return{c:t.subarray(0,r),n:e}},uu=function(n,e){for(var t=0,r=0;r<e.length;++r)t+=n[r]*e[r];return t},dz=function(n,e,t){var r=t.length,o=e2(e+2);n[o]=r&255,n[o+1]=r>>8,n[o+2]=n[o]^255,n[o+3]=n[o+1]^255;for(var s=0;s<r;++s)n[o+s+4]=t[s];return(o+4+r)*8},u_=function(n,e,t,r,o,s,i,a,A,d,c){lA(e,c++,t),++o[256];for(var u=n0(o,15),h=u.t,p=u.l,v=n0(s,15),w=v.t,y=v.l,B=c_(h),C=B.c,Q=B.n,k=c_(w),H=k.c,Z=k.n,q=new bi(19),N=0;N<C.length;++N)++q[C[N]&31];for(var N=0;N<H.length;++N)++q[H[N]&31];for(var re=n0(q,7),be=re.t,L=re.l,R=19;R>4&&!be[zm[R-1]];--R);var J=d+5<<3,se=uu(o,vl)+uu(s,sh)+i,fe=uu(o,h)+uu(s,w)+i+14+3*R+uu(q,be)+2*q[16]+3*q[17]+7*q[18];if(A>=0&&J<=se&&J<=fe)return dz(e,c,n.subarray(A,A+d));var ie,pe,te,Ce;if(lA(e,c,1+(fe<se)),c+=2,fe<se){ie=Oa(h,p,0),pe=h,te=Oa(w,y,0),Ce=w;var ne=Oa(be,L,0);lA(e,c,Q-257),lA(e,c+5,Z-1),lA(e,c+10,R-4),c+=14;for(var N=0;N<R;++N)lA(e,c+3*N,be[zm[N]]);c+=3*R;for(var ze=[C,H],z=0;z<2;++z)for(var E=ze[z],N=0;N<E.length;++N){var F=E[N]&31;lA(e,c,ne[F]),c+=be[F],F>15&&(lA(e,c,E[N]>>5&127),c+=E[N]>>12)}}else ie=HD,pe=vl,te=RD,Ce=sh;for(var N=0;N<a;++N){var I=r[N];if(I>255){var F=I>>18&31;cu(e,c,ie[F+257]),c+=pe[F+257],F>7&&(lA(e,c,I>>23&31),c+=Ng[F]);var O=I&31;cu(e,c,te[O]),c+=Ce[O],O>3&&(cu(e,c,I>>5&8191),c+=Mg[O])}else cu(e,c,ie[I]),c+=pe[I]}return cu(e,c,ie[256]),c+pe[256]},VD=new Z1([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),cz=new Es(0),GD=function(n,e,t,r,o,s){var i=s.z||n.length,a=new Es(r+i+5*(1+Math.ceil(i/7e3))+o),A=a.subarray(r,a.length-o),d=s.l,c=(s.r||0)&7;if(e){c&&(A[0]=s.r>>3);for(var u=VD[e-1],h=u>>13,p=u&8191,v=(1<<t)-1,w=s.p||new bi(32768),y=s.h||new bi(v+1),B=Math.ceil(t/3),C=2*B,Q=function($e){return(n[$e]^n[$e+1]<<B^n[$e+2]<<C)&v},k=new Z1(25e3),H=new bi(288),Z=new bi(32),q=0,N=0,re=s.i||0,be=0,L=s.w||0,R=0;re+2<i;++re){var J=Q(re),se=re&32767,fe=y[J];if(w[se]=fe,y[J]=se,L<=re){var ie=i-re;if((q>7e3||be>24576)&&(ie>423||!d)){c=u_(n,A,0,k,H,Z,N,be,R,re-R,c),be=q=N=0,R=re;for(var pe=0;pe<286;++pe)H[pe]=0;for(var pe=0;pe<30;++pe)Z[pe]=0}var te=2,Ce=0,ne=p,ze=se-fe&32767;if(ie>2&&J==Q(re-ze))for(var z=Math.min(h,ie)-1,E=Math.min(32767,re),F=Math.min(258,ie);ze<=E&&--ne&&se!=fe;){if(n[re+te]==n[re+te-ze]){for(var I=0;I<F&&n[re+I]==n[re+I-ze];++I);if(I>te){if(te=I,Ce=ze,I>z)break;for(var O=Math.min(ze,I-2),D=0,pe=0;pe<O;++pe){var P=re-ze+pe&32767,K=w[P],M=P-K&32767;M>D&&(D=M,fe=P)}}}se=fe,fe=w[se],ze+=se-fe&32767}if(Ce){k[be++]=268435456|Cm[te]<<18|d_[Ce];var ge=Cm[te]&31,_e=d_[Ce]&31;N+=Ng[ge]+Mg[_e],++H[257+ge],++Z[_e],L=re+te,++q}else k[be++]=n[re],++H[n[re]]}}for(re=Math.max(re,L);re<i;++re)k[be++]=n[re],++H[n[re]];c=u_(n,A,d,k,H,Z,N,be,R,re-R,c),d||(s.r=c&7|A[c/8|0]<<3,c-=7,s.h=y,s.p=w,s.i=re,s.w=L)}else{for(var re=s.w||0;re<i+d;re+=65535){var Me=re+65535;Me>=i&&(A[c/8|0]=d,Me=i),c=dz(A,c+1,n.subarray(re,Me))}s.i=i}return lz(a,0,r+e2(c)+o)},uz=function(){var n=1,e=0;return{p:function(t){for(var r=n,o=e,s=t.length|0,i=0;i!=s;){for(var a=Math.min(i+2655,s);i<a;++i)o+=r+=t[i];r=(r&65535)+15*(r>>16),o=(o&65535)+15*(o>>16)}n=r,e=o},d:function(){return n%=65521,e%=65521,(n&255)<<24|(n&65280)<<8|(e&255)<<8|e>>8}}},WD=function(n,e,t,r,o){if(!o&&(o={l:1},e.dictionary)){var s=e.dictionary.subarray(-32768),i=new Es(s.length+n.length);i.set(s),i.set(n,s.length),n=i,o.w=s.length}return GD(n,e.level==null?6:e.level,e.mem==null?o.l?Math.ceil(Math.max(8,Math.min(13,Math.log(n.length)))*1.5):20:12+e.mem,t,r,o)},hz=function(n,e,t){for(;t;++e)n[e]=t,t>>>=8},XD=function(n,e){var t=e.level,r=t==0?0:t<6?1:t==9?3:2;if(n[0]=120,n[1]=r<<6|(e.dictionary&&32),n[1]|=31-(n[0]<<8|n[1])%31,e.dictionary){var o=uz();o.p(e.dictionary),hz(n,2,o.d())}},YD=function(n,e){return((n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31)&&Zi(6,"invalid zlib data"),(n[1]>>5&1)==1&&Zi(6,"invalid zlib data: "+(n[1]&32?"need":"unexpected")+" dictionary"),(n[1]>>3&4)+2};function Fm(n,e){e||(e={});var t=uz();t.p(n);var r=WD(n,e,e.dictionary?6:2,4);return XD(r,e),hz(r,r.length-4,t.d()),r}function JD(n,e){return $D(n.subarray(YD(n),-4),{i:2},e,e)}var ZD=typeof TextDecoder<"u"&&new TextDecoder,eN=0;try{ZD.decode(cz,{stream:!0}),eN=1}catch{}var Fr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function o0(){Fr.console&&typeof Fr.console.log=="function"&&Fr.console.log.apply(Fr.console,arguments)}var Hn={log:o0,warn:function(n){Fr.console&&(typeof Fr.console.warn=="function"?Fr.console.warn.apply(Fr.console,arguments):o0.call(null,arguments))},error:function(n){Fr.console&&(typeof Fr.console.error=="function"?Fr.console.error.apply(Fr.console,arguments):o0(n))}};function s0(n,e,t){var r=new XMLHttpRequest;r.open("GET",n),r.responseType="blob",r.onload=function(){Ql(r.response,e,t)},r.onerror=function(){Hn.error("could not download file")},r.send()}function h_(n){var e=new XMLHttpRequest;e.open("HEAD",n,!1);try{e.send()}catch{}return e.status>=200&&e.status<=299}function qf(n){try{n.dispatchEvent(new MouseEvent("click"))}catch{var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),n.dispatchEvent(e)}}var Ou,Im,Ql=Fr.saveAs||((typeof window>"u"?"undefined":Pn(window))!=="object"||window!==Fr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(n,e,t){var r=Fr.URL||Fr.webkitURL,o=document.createElement("a");e=e||n.name||"download",o.download=e,o.rel="noopener",typeof n=="string"?(o.href=n,o.origin!==location.origin?h_(o.href)?s0(n,e,t):qf(o,o.target="_blank"):qf(o)):(o.href=r.createObjectURL(n),setTimeout(function(){r.revokeObjectURL(o.href)},4e4),setTimeout(function(){qf(o)},0))}:"msSaveOrOpenBlob"in navigator?function(n,e,t){if(e=e||n.name||"download",typeof n=="string")if(h_(n))s0(n,e,t);else{var r=document.createElement("a");r.href=n,r.target="_blank",setTimeout(function(){qf(r)})}else navigator.msSaveOrOpenBlob(function(o,s){return s===void 0?s={autoBom:!1}:Pn(s)!=="object"&&(Hn.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\uFEFF",o],{type:o.type}):o}(n,t),e)}:function(n,e,t,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof n=="string")return s0(n,e,t);var o=n.type==="application/octet-stream",s=/constructor/i.test(Fr.HTMLElement)||Fr.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||o&&s)&&(typeof FileReader>"u"?"undefined":Pn(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var c=a.result;c=i?c:c.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=c:location=c,r=null},a.readAsDataURL(n)}else{var A=Fr.URL||Fr.webkitURL,d=A.createObjectURL(n);r?r.location=d:location.href=d,r=null,setTimeout(function(){A.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function fz(n){var e;n=n||"",this.ok=!1,n.charAt(0)=="#"&&(n=n.substr(1,6)),n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[n=(n=n.replace(/ /g,"")).toLowerCase()]||n;for(var t=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<t.length;r++){var o=t[r].re,s=t[r].process,i=o.exec(n);i&&(e=s(i),this.r=e[0],this.g=e[1],this.b=e[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),A=this.g.toString(16),d=this.b.toString(16);return a.length==1&&(a="0"+a),A.length==1&&(A="0"+A),d.length==1&&(d="0"+d),"#"+a+A+d}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function i0(n,e){var t=n[0],r=n[1],o=n[2],s=n[3];t=ys(t,r,o,s,e[0],7,-680876936),s=ys(s,t,r,o,e[1],12,-389564586),o=ys(o,s,t,r,e[2],17,606105819),r=ys(r,o,s,t,e[3],22,-1044525330),t=ys(t,r,o,s,e[4],7,-176418897),s=ys(s,t,r,o,e[5],12,1200080426),o=ys(o,s,t,r,e[6],17,-1473231341),r=ys(r,o,s,t,e[7],22,-45705983),t=ys(t,r,o,s,e[8],7,1770035416),s=ys(s,t,r,o,e[9],12,-1958414417),o=ys(o,s,t,r,e[10],17,-42063),r=ys(r,o,s,t,e[11],22,-1990404162),t=ys(t,r,o,s,e[12],7,1804603682),s=ys(s,t,r,o,e[13],12,-40341101),o=ys(o,s,t,r,e[14],17,-1502002290),t=_s(t,r=ys(r,o,s,t,e[15],22,1236535329),o,s,e[1],5,-165796510),s=_s(s,t,r,o,e[6],9,-1069501632),o=_s(o,s,t,r,e[11],14,643717713),r=_s(r,o,s,t,e[0],20,-373897302),t=_s(t,r,o,s,e[5],5,-701558691),s=_s(s,t,r,o,e[10],9,38016083),o=_s(o,s,t,r,e[15],14,-660478335),r=_s(r,o,s,t,e[4],20,-405537848),t=_s(t,r,o,s,e[9],5,568446438),s=_s(s,t,r,o,e[14],9,-1019803690),o=_s(o,s,t,r,e[3],14,-187363961),r=_s(r,o,s,t,e[8],20,1163531501),t=_s(t,r,o,s,e[13],5,-1444681467),s=_s(s,t,r,o,e[2],9,-51403784),o=_s(o,s,t,r,e[7],14,1735328473),t=bs(t,r=_s(r,o,s,t,e[12],20,-1926607734),o,s,e[5],4,-378558),s=bs(s,t,r,o,e[8],11,-2022574463),o=bs(o,s,t,r,e[11],16,1839030562),r=bs(r,o,s,t,e[14],23,-35309556),t=bs(t,r,o,s,e[1],4,-1530992060),s=bs(s,t,r,o,e[4],11,1272893353),o=bs(o,s,t,r,e[7],16,-155497632),r=bs(r,o,s,t,e[10],23,-1094730640),t=bs(t,r,o,s,e[13],4,681279174),s=bs(s,t,r,o,e[0],11,-358537222),o=bs(o,s,t,r,e[3],16,-722521979),r=bs(r,o,s,t,e[6],23,76029189),t=bs(t,r,o,s,e[9],4,-640364487),s=bs(s,t,r,o,e[12],11,-421815835),o=bs(o,s,t,r,e[15],16,530742520),t=xs(t,r=bs(r,o,s,t,e[2],23,-995338651),o,s,e[0],6,-198630844),s=xs(s,t,r,o,e[7],10,1126891415),o=xs(o,s,t,r,e[14],15,-1416354905),r=xs(r,o,s,t,e[5],21,-57434055),t=xs(t,r,o,s,e[12],6,1700485571),s=xs(s,t,r,o,e[3],10,-1894986606),o=xs(o,s,t,r,e[10],15,-1051523),r=xs(r,o,s,t,e[1],21,-2054922799),t=xs(t,r,o,s,e[8],6,1873313359),s=xs(s,t,r,o,e[15],10,-30611744),o=xs(o,s,t,r,e[6],15,-1560198380),r=xs(r,o,s,t,e[13],21,1309151649),t=xs(t,r,o,s,e[4],6,-145523070),s=xs(s,t,r,o,e[11],10,-1120210379),o=xs(o,s,t,r,e[2],15,718787259),r=xs(r,o,s,t,e[9],21,-343485551),n[0]=al(t,n[0]),n[1]=al(r,n[1]),n[2]=al(o,n[2]),n[3]=al(s,n[3])}function Hg(n,e,t,r,o,s){return e=al(al(e,n),al(r,s)),al(e<<o|e>>>32-o,t)}function ys(n,e,t,r,o,s,i){return Hg(e&t|~e&r,n,e,o,s,i)}function _s(n,e,t,r,o,s,i){return Hg(e&r|t&~r,n,e,o,s,i)}function bs(n,e,t,r,o,s,i){return Hg(e^t^r,n,e,o,s,i)}function xs(n,e,t,r,o,s,i){return Hg(t^(e|~r),n,e,o,s,i)}function pz(n){var e,t=n.length,r=[1732584193,-271733879,-1732584194,271733878];for(e=64;e<=n.length;e+=64)i0(r,tN(n.substring(e-64,e)));n=n.substring(e-64);var o=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<n.length;e++)o[e>>2]|=n.charCodeAt(e)<<(e%4<<3);if(o[e>>2]|=128<<(e%4<<3),e>55)for(i0(r,o),e=0;e<16;e++)o[e]=0;return o[14]=8*t,i0(r,o),r}function tN(n){var e,t=[];for(e=0;e<64;e+=4)t[e>>2]=n.charCodeAt(e)+(n.charCodeAt(e+1)<<8)+(n.charCodeAt(e+2)<<16)+(n.charCodeAt(e+3)<<24);return t}Ou=Fr.atob.bind(Fr),Im=Fr.btoa.bind(Fr);var f_="0123456789abcdef".split("");function rN(n){for(var e="",t=0;t<4;t++)e+=f_[n>>8*t+4&15]+f_[n>>8*t&15];return e}function nN(n){return String.fromCharCode((255&n)>>0,(65280&n)>>8,(16711680&n)>>16,(4278190080&n)>>24)}function Um(n){return pz(n).map(nN).join("")}var oN=function(n){for(var e=0;e<n.length;e++)n[e]=rN(n[e]);return n.join("")}(pz("hello"))!="5d41402abc4b2a76b9719d911017c592";function al(n,e){if(oN){var t=(65535&n)+(65535&e);return(n>>16)+(e>>16)+(t>>16)<<16|65535&t}return n+e&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Qm(n,e){var t,r,o,s;if(n!==t){for(var i=(o=n,s=1+(256/n.length>>0),new Array(s+1).join(o)),a=[],A=0;A<256;A++)a[A]=A;var d=0;for(A=0;A<256;A++){var c=a[A];d=(d+c+i.charCodeAt(A))%256,a[A]=a[d],a[d]=c}t=n,r=a}else a=r;var u=e.length,h=0,p=0,v="";for(A=0;A<u;A++)p=(p+(c=a[h=(h+1)%256]))%256,a[h]=a[p],a[p]=c,i=a[(a[h]+a[p])%256],v+=String.fromCharCode(e.charCodeAt(A)^i);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var p_={print:4,modify:8,copy:16,"annot-forms":32};function Yd(n,e,t,r){this.v=1,this.r=2;var o=192;n.forEach(function(a){if(p_.perm!==void 0)throw new Error("Invalid permission: "+a);o+=p_[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var s=(e+this.padding).substr(0,32),i=(t+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,i),this.P=-(1+(255^o)),this.encryptionKey=Um(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=Qm(this.encryptionKey,this.padding)}function Jd(n){if(/[^\u0000-\u00ff]/.test(n))throw new Error("Invalid PDF Name Object: "+n+", Only accept ASCII characters.");for(var e="",t=n.length,r=0;r<t;r++){var o=n.charCodeAt(r);o<33||o===35||o===37||o===40||o===41||o===47||o===60||o===62||o===91||o===93||o===123||o===125||o>126?e+="#"+("0"+o.toString(16)).slice(-2):e+=n[r]}return e}function g_(n){if(Pn(n)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var e={};this.subscribe=function(t,r,o){if(o=o||!1,typeof t!="string"||typeof r!="function"||typeof o!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");e.hasOwnProperty(t)||(e[t]={});var s=Math.random().toString(35);return e[t][s]=[r,!!o],s},this.unsubscribe=function(t){for(var r in e)if(e[r][t])return delete e[r][t],Object.keys(e[r]).length===0&&delete e[r],!0;return!1},this.publish=function(t){if(e.hasOwnProperty(t)){var r=Array.prototype.slice.call(arguments,1),o=[];for(var s in e[t]){var i=e[t][s];try{i[0].apply(n,r)}catch(a){Fr.console&&Hn.error("jsPDF PubSub Error",a.message,a)}i[1]&&o.push(s)}o.length&&o.forEach(this.unsubscribe)}},this.getTopics=function(){return e}}function Wp(n){if(!(this instanceof Wp))return new Wp(n);var e="opacity,stroke-opacity".split(",");for(var t in n)n.hasOwnProperty(t)&&e.indexOf(t)>=0&&(this[t]=n[t]);this.id="",this.objectNumber=-1}function gz(n,e){this.gState=n,this.matrix=e,this.id="",this.objectNumber=-1}function Dl(n,e,t,r,o){if(!(this instanceof Dl))return new Dl(n,e,t,r,o);this.type=n==="axial"?2:3,this.coords=e,this.colors=t,gz.call(this,r,o)}function sc(n,e,t,r,o){if(!(this instanceof sc))return new sc(n,e,t,r,o);this.boundingBox=n,this.xStep=e,this.yStep=t,this.stream="",this.cloneIndex=0,gz.call(this,r,o)}function zr(n){var e,t=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],o=arguments[2],s=arguments[3],i=[],a=1,A=16,d="S",c=null;Pn(n=n||{})==="object"&&(t=n.orientation,r=n.unit||r,o=n.format||o,s=n.compress||n.compressPdf||s,(c=n.encryption||null)!==null&&(c.userPassword=c.userPassword||"",c.ownerPassword=c.ownerPassword||"",c.userPermissions=c.userPermissions||[]),a=typeof n.userUnit=="number"?Math.abs(n.userUnit):1,n.precision!==void 0&&(e=n.precision),n.floatPrecision!==void 0&&(A=n.floatPrecision),d=n.defaultPathOperation||"S"),i=n.filters||(s===!0?["FlateEncode"]:i),r=r||"mm",t=(""+(t||"P")).toLowerCase();var u=n.putOnlyUsedFonts||!1,h={},p={internal:{},__private__:{}};p.__private__.PubSub=g_;var v="1.3",w=p.__private__.getPdfVersion=function(){return v};p.__private__.setPdfVersion=function(b){v=b};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};p.__private__.getPageFormats=function(){return y};var B=p.__private__.getPageFormat=function(b){return y[b]};o=o||"a4";var C={COMPAT:"compat",ADVANCED:"advanced"},Q=C.COMPAT;function k(){this.saveGraphicsState(),j(new mt(V,0,0,-V,0,Si()*V).toString()+" cm"),this.setFontSize(this.getFontSize()/V),d="n",Q=C.ADVANCED}function H(){this.restoreGraphicsState(),d="S",Q=C.COMPAT}var Z=p.__private__.combineFontStyleAndFontWeight=function(b,W){if(b=="bold"&&W=="normal"||b=="bold"&&W==400||b=="normal"&&W=="italic"||b=="bold"&&W=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return W&&(b=W==400||W==="normal"?b==="italic"?"italic":"normal":W!=700&&W!=="bold"||b!=="normal"?(W==700?"bold":W)+""+b:"bold"),b};p.advancedAPI=function(b){var W=Q===C.COMPAT;return W&&k.call(this),typeof b!="function"||(b(this),W&&H.call(this)),this},p.compatAPI=function(b){var W=Q===C.ADVANCED;return W&&H.call(this),typeof b!="function"||(b(this),W&&k.call(this)),this},p.isAdvancedAPI=function(){return Q===C.ADVANCED};var q,N=function(b){if(Q!==C.ADVANCED)throw new Error(b+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},re=p.roundToPrecision=p.__private__.roundToPrecision=function(b,W){var ke=e||W;if(isNaN(b)||isNaN(ke))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return b.toFixed(ke).replace(/0+$/,"")};q=p.hpf=p.__private__.hpf=typeof A=="number"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return re(b,A)}:A==="smart"?function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return re(b,b>-1&&b<1?16:5)}:function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.hpf");return re(b,16)};var be=p.f2=p.__private__.f2=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f2");return re(b,2)},L=p.__private__.f3=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.f3");return re(b,3)},R=p.scale=p.__private__.scale=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.scale");return Q===C.COMPAT?b*V:Q===C.ADVANCED?b:void 0},J=function(b){return Q===C.COMPAT?Si()-b:Q===C.ADVANCED?b:void 0},se=function(b){return R(J(b))};p.__private__.setPrecision=p.setPrecision=function(b){typeof parseInt(b,10)=="number"&&(e=parseInt(b,10))};var fe,ie="00000000000000000000000000000000",pe=p.__private__.getFileId=function(){return ie},te=p.__private__.setFileId=function(b){return ie=b!==void 0&&/^[a-fA-F0-9]{32}$/.test(b)?b.toUpperCase():ie.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),c!==null&&(Sr=new Yd(c.userPermissions,c.userPassword,c.ownerPassword,ie)),ie};p.setFileId=function(b){return te(b),this},p.getFileId=function(){return pe()};var Ce=p.__private__.convertDateToPDFDate=function(b){var W=b.getTimezoneOffset(),ke=W<0?"+":"-",Ke=Math.floor(Math.abs(W/60)),nt=Math.abs(W%60),Bt=[ke,F(Ke),"'",F(nt),"'"].join("");return["D:",b.getFullYear(),F(b.getMonth()+1),F(b.getDate()),F(b.getHours()),F(b.getMinutes()),F(b.getSeconds()),Bt].join("")},ne=p.__private__.convertPDFDateToDate=function(b){var W=parseInt(b.substr(2,4),10),ke=parseInt(b.substr(6,2),10)-1,Ke=parseInt(b.substr(8,2),10),nt=parseInt(b.substr(10,2),10),Bt=parseInt(b.substr(12,2),10),Nt=parseInt(b.substr(14,2),10);return new Date(W,ke,Ke,nt,Bt,Nt,0)},ze=p.__private__.setCreationDate=function(b){var W;if(b===void 0&&(b=new Date),b instanceof Date)W=Ce(b);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(b))throw new Error("Invalid argument passed to jsPDF.setCreationDate");W=b}return fe=W},z=p.__private__.getCreationDate=function(b){var W=fe;return b==="jsDate"&&(W=ne(fe)),W};p.setCreationDate=function(b){return ze(b),this},p.getCreationDate=function(b){return z(b)};var E,F=p.__private__.padd2=function(b){return("0"+parseInt(b)).slice(-2)},I=p.__private__.padd2Hex=function(b){return("00"+(b=b.toString())).substr(b.length)},O=0,D=[],P=[],K=0,M=[],ge=[],_e=!1,Me=P,$e=function(){O=0,K=0,P=[],D=[],M=[],Rt=pt(),Ot=pt()};p.__private__.setCustomOutputDestination=function(b){_e=!0,Me=b};var Y=function(b){_e||(Me=b)};p.__private__.resetCustomOutputDestination=function(){_e=!1,Me=P};var j=p.__private__.out=function(b){return b=b.toString(),K+=b.length+1,Me.push(b),Me},ee=p.__private__.write=function(b){return j(arguments.length===1?b.toString():Array.prototype.join.call(arguments," "))},ae=p.__private__.getArrayBuffer=function(b){for(var W=b.length,ke=new ArrayBuffer(W),Ke=new Uint8Array(ke);W--;)Ke[W]=b.charCodeAt(W);return ke},ue=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];p.__private__.getStandardFonts=function(){return ue};var me=n.fontSize||16;p.__private__.setFontSize=p.setFontSize=function(b){return me=Q===C.ADVANCED?b/V:b,this};var ye,Ee=p.__private__.getFontSize=p.getFontSize=function(){return Q===C.COMPAT?me:me*V},de=n.R2L||!1;p.__private__.setR2L=p.setR2L=function(b){return de=b,this},p.__private__.getR2L=p.getR2L=function(){return de};var Qe,Fe=p.__private__.setZoomMode=function(b){var W=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(b))ye=b;else if(isNaN(b)){if(W.indexOf(b)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+b+'" is not recognized.');ye=b}else ye=parseInt(b,10)};p.__private__.getZoomMode=function(){return ye};var Oe,Te=p.__private__.setPageMode=function(b){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(b)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+b+'" is not recognized.');Qe=b};p.__private__.getPageMode=function(){return Qe};var De=p.__private__.setLayoutMode=function(b){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(b)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+b+'" is not recognized.');Oe=b};p.__private__.getLayoutMode=function(){return Oe},p.__private__.setDisplayMode=p.setDisplayMode=function(b,W,ke){return Fe(b),De(W),Te(ke),this};var ce={title:"",subject:"",author:"",keywords:"",creator:""};p.__private__.getDocumentProperty=function(b){if(Object.keys(ce).indexOf(b)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return ce[b]},p.__private__.getDocumentProperties=function(){return ce},p.__private__.setDocumentProperties=p.setProperties=p.setDocumentProperties=function(b){for(var W in ce)ce.hasOwnProperty(W)&&b[W]&&(ce[W]=b[W]);return this},p.__private__.setDocumentProperty=function(b,W){if(Object.keys(ce).indexOf(b)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return ce[b]=W};var Ie,V,G,le,Le,He={},je={},xe=[],Re={},et={},qe={},ot={},Pe=null,Ye=0,rt=[],lt=new g_(p),vt=n.hotfixes||[],Ft={},Qt={},Et=[],mt=function b(W,ke,Ke,nt,Bt,Nt){if(!(this instanceof b))return new b(W,ke,Ke,nt,Bt,Nt);isNaN(W)&&(W=1),isNaN(ke)&&(ke=0),isNaN(Ke)&&(Ke=0),isNaN(nt)&&(nt=1),isNaN(Bt)&&(Bt=0),isNaN(Nt)&&(Nt=0),this._matrix=[W,ke,Ke,nt,Bt,Nt]};Object.defineProperty(mt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(mt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(mt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(mt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(mt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(mt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(mt.prototype,"a",{get:function(){return this._matrix[0]},set:function(b){this._matrix[0]=b}}),Object.defineProperty(mt.prototype,"b",{get:function(){return this._matrix[1]},set:function(b){this._matrix[1]=b}}),Object.defineProperty(mt.prototype,"c",{get:function(){return this._matrix[2]},set:function(b){this._matrix[2]=b}}),Object.defineProperty(mt.prototype,"d",{get:function(){return this._matrix[3]},set:function(b){this._matrix[3]=b}}),Object.defineProperty(mt.prototype,"e",{get:function(){return this._matrix[4]},set:function(b){this._matrix[4]=b}}),Object.defineProperty(mt.prototype,"f",{get:function(){return this._matrix[5]},set:function(b){this._matrix[5]=b}}),Object.defineProperty(mt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(mt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(mt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(mt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),mt.prototype.join=function(b){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(q).join(b)},mt.prototype.multiply=function(b){var W=b.sx*this.sx+b.shy*this.shx,ke=b.sx*this.shy+b.shy*this.sy,Ke=b.shx*this.sx+b.sy*this.shx,nt=b.shx*this.shy+b.sy*this.sy,Bt=b.tx*this.sx+b.ty*this.shx+this.tx,Nt=b.tx*this.shy+b.ty*this.sy+this.ty;return new mt(W,ke,Ke,nt,Bt,Nt)},mt.prototype.decompose=function(){var b=this.sx,W=this.shy,ke=this.shx,Ke=this.sy,nt=this.tx,Bt=this.ty,Nt=Math.sqrt(b*b+W*W),Zt=(b/=Nt)*ke+(W/=Nt)*Ke;ke-=b*Zt,Ke-=W*Zt;var vr=Math.sqrt(ke*ke+Ke*Ke);return Zt/=vr,b*(Ke/=vr)<W*(ke/=vr)&&(b=-b,W=-W,Zt=-Zt,Nt=-Nt),{scale:new mt(Nt,0,0,vr,0,0),translate:new mt(1,0,0,1,nt,Bt),rotate:new mt(b,W,-W,b,0,0),skew:new mt(1,0,Zt,1,0,0)}},mt.prototype.toString=function(b){return this.join(" ")},mt.prototype.inversed=function(){var b=this.sx,W=this.shy,ke=this.shx,Ke=this.sy,nt=this.tx,Bt=this.ty,Nt=1/(b*Ke-W*ke),Zt=Ke*Nt,vr=-W*Nt,Qr=-ke*Nt,Tr=b*Nt;return new mt(Zt,vr,Qr,Tr,-Zt*nt-Qr*Bt,-vr*nt-Tr*Bt)},mt.prototype.applyToPoint=function(b){var W=b.x*this.sx+b.y*this.shx+this.tx,ke=b.x*this.shy+b.y*this.sy+this.ty;return new Ci(W,ke)},mt.prototype.applyToRectangle=function(b){var W=this.applyToPoint(b),ke=this.applyToPoint(new Ci(b.x+b.w,b.y+b.h));return new ga(W.x,W.y,ke.x-W.x,ke.y-W.y)},mt.prototype.clone=function(){var b=this.sx,W=this.shy,ke=this.shx,Ke=this.sy,nt=this.tx,Bt=this.ty;return new mt(b,W,ke,Ke,nt,Bt)},p.Matrix=mt;var Gt=p.matrixMult=function(b,W){return W.multiply(b)},Ht=new mt(1,0,0,1,0,0);p.unitMatrix=p.identityMatrix=Ht;var Ut=function(b,W){if(!et[b]){var ke=(W instanceof Dl?"Sh":"P")+(Object.keys(Re).length+1).toString(10);W.id=ke,et[b]=ke,Re[ke]=W,lt.publish("addPattern",W)}};p.ShadingPattern=Dl,p.TilingPattern=sc,p.addShadingPattern=function(b,W){return N("addShadingPattern()"),Ut(b,W),this},p.beginTilingPattern=function(b){N("beginTilingPattern()"),Ja(b.boundingBox[0],b.boundingBox[1],b.boundingBox[2]-b.boundingBox[0],b.boundingBox[3]-b.boundingBox[1],b.matrix)},p.endTilingPattern=function(b,W){N("endTilingPattern()"),W.stream=ge[E].join(`
`),Ut(b,W),lt.publish("endTilingPattern",W),Et.pop().restore()};var st=p.__private__.newObject=function(){var b=pt();return _t(b,!0),b},pt=p.__private__.newObjectDeferred=function(){return O++,D[O]=function(){return K},O},_t=function(b,W){return W=typeof W=="boolean"&&W,D[b]=K,W&&j(b+" 0 obj"),b},$t=p.__private__.newAdditionalObject=function(){var b={objId:pt(),content:""};return M.push(b),b},Rt=pt(),Ot=pt(),Ct=p.__private__.decodeColorString=function(b){var W=b.split(" ");if(W.length!==2||W[1]!=="g"&&W[1]!=="G")W.length===5&&(W[4]==="k"||W[4]==="K")&&(W=[(1-W[0])*(1-W[3]),(1-W[1])*(1-W[3]),(1-W[2])*(1-W[3]),"r"]);else{var ke=parseFloat(W[0]);W=[ke,ke,ke,"r"]}for(var Ke="#",nt=0;nt<3;nt++)Ke+=("0"+Math.floor(255*parseFloat(W[nt])).toString(16)).slice(-2);return Ke},Wt=p.__private__.encodeColorString=function(b){var W;typeof b=="string"&&(b={ch1:b});var ke=b.ch1,Ke=b.ch2,nt=b.ch3,Bt=b.ch4,Nt=b.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ke=="string"&&ke.charAt(0)!=="#"){var Zt=new fz(ke);if(Zt.ok)ke=Zt.toHex();else if(!/^\d*\.?\d*$/.test(ke))throw new Error('Invalid color "'+ke+'" passed to jsPDF.encodeColorString.')}if(typeof ke=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ke)&&(ke="#"+ke[1]+ke[1]+ke[2]+ke[2]+ke[3]+ke[3]),typeof ke=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ke)){var vr=parseInt(ke.substr(1),16);ke=vr>>16&255,Ke=vr>>8&255,nt=255&vr}if(Ke===void 0||Bt===void 0&&ke===Ke&&Ke===nt)if(typeof ke=="string")W=ke+" "+Nt[0];else switch(b.precision){case 2:W=be(ke/255)+" "+Nt[0];break;case 3:default:W=L(ke/255)+" "+Nt[0]}else if(Bt===void 0||Pn(Bt)==="object"){if(Bt&&!isNaN(Bt.a)&&Bt.a===0)return W=["1.","1.","1.",Nt[1]].join(" ");if(typeof ke=="string")W=[ke,Ke,nt,Nt[1]].join(" ");else switch(b.precision){case 2:W=[be(ke/255),be(Ke/255),be(nt/255),Nt[1]].join(" ");break;default:case 3:W=[L(ke/255),L(Ke/255),L(nt/255),Nt[1]].join(" ")}}else if(typeof ke=="string")W=[ke,Ke,nt,Bt,Nt[2]].join(" ");else switch(b.precision){case 2:W=[be(ke),be(Ke),be(nt),be(Bt),Nt[2]].join(" ");break;case 3:default:W=[L(ke),L(Ke),L(nt),L(Bt),Nt[2]].join(" ")}return W},It=p.__private__.getFilters=function(){return i},St=p.__private__.putStream=function(b){var W=(b=b||{}).data||"",ke=b.filters||It(),Ke=b.alreadyAppliedFilters||[],nt=b.addLength1||!1,Bt=W.length,Nt=b.objectId,Zt=function(To){return To};if(c!==null&&Nt===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");c!==null&&(Zt=Sr.encryptor(Nt,0));var vr={};ke===!0&&(ke=["FlateEncode"]);var Qr=b.additionalKeyValues||[],Tr=(vr=zr.API.processDataByFilters!==void 0?zr.API.processDataByFilters(W,ke):{data:W,reverseChain:[]}).reverseChain+(Array.isArray(Ke)?Ke.join(" "):Ke.toString());if(vr.data.length!==0&&(Qr.push({key:"Length",value:vr.data.length}),nt===!0&&Qr.push({key:"Length1",value:Bt})),Tr.length!=0)if(Tr.split("/").length-1==1)Qr.push({key:"Filter",value:Tr});else{Qr.push({key:"Filter",value:"["+Tr+"]"});for(var Vr=0;Vr<Qr.length;Vr+=1)if(Qr[Vr].key==="DecodeParms"){for(var kn=[],Kn=0;Kn<vr.reverseChain.split("/").length-1;Kn+=1)kn.push("null");kn.push(Qr[Vr].value),Qr[Vr].value="["+kn.join(" ")+"]"}}j("<<");for(var ro=0;ro<Qr.length;ro++)j("/"+Qr[ro].key+" "+Qr[ro].value);j(">>"),vr.data.length!==0&&(j("stream"),j(Zt(vr.data)),j("endstream"))},jt=p.__private__.putPage=function(b){var W=b.number,ke=b.data,Ke=b.objId,nt=b.contentsObjId;_t(Ke,!0),j("<</Type /Page"),j("/Parent "+b.rootDictionaryObjId+" 0 R"),j("/Resources "+b.resourceDictionaryObjId+" 0 R"),j("/MediaBox ["+parseFloat(q(b.mediaBox.bottomLeftX))+" "+parseFloat(q(b.mediaBox.bottomLeftY))+" "+q(b.mediaBox.topRightX)+" "+q(b.mediaBox.topRightY)+"]"),b.cropBox!==null&&j("/CropBox ["+q(b.cropBox.bottomLeftX)+" "+q(b.cropBox.bottomLeftY)+" "+q(b.cropBox.topRightX)+" "+q(b.cropBox.topRightY)+"]"),b.bleedBox!==null&&j("/BleedBox ["+q(b.bleedBox.bottomLeftX)+" "+q(b.bleedBox.bottomLeftY)+" "+q(b.bleedBox.topRightX)+" "+q(b.bleedBox.topRightY)+"]"),b.trimBox!==null&&j("/TrimBox ["+q(b.trimBox.bottomLeftX)+" "+q(b.trimBox.bottomLeftY)+" "+q(b.trimBox.topRightX)+" "+q(b.trimBox.topRightY)+"]"),b.artBox!==null&&j("/ArtBox ["+q(b.artBox.bottomLeftX)+" "+q(b.artBox.bottomLeftY)+" "+q(b.artBox.topRightX)+" "+q(b.artBox.topRightY)+"]"),typeof b.userUnit=="number"&&b.userUnit!==1&&j("/UserUnit "+b.userUnit),lt.publish("putPage",{objId:Ke,pageContext:rt[W],pageNumber:W,page:ke}),j("/Contents "+nt+" 0 R"),j(">>"),j("endobj");var Bt=ke.join(`
`);return Q===C.ADVANCED&&(Bt+=`
Q`),_t(nt,!0),St({data:Bt,filters:It(),objectId:nt}),j("endobj"),Ke},dr=p.__private__.putPages=function(){var b,W,ke=[];for(b=1;b<=Ye;b++)rt[b].objId=pt(),rt[b].contentsObjId=pt();for(b=1;b<=Ye;b++)ke.push(jt({number:b,data:ge[b],objId:rt[b].objId,contentsObjId:rt[b].contentsObjId,mediaBox:rt[b].mediaBox,cropBox:rt[b].cropBox,bleedBox:rt[b].bleedBox,trimBox:rt[b].trimBox,artBox:rt[b].artBox,userUnit:rt[b].userUnit,rootDictionaryObjId:Rt,resourceDictionaryObjId:Ot}));_t(Rt,!0),j("<</Type /Pages");var Ke="/Kids [";for(W=0;W<Ye;W++)Ke+=ke[W]+" 0 R ";j(Ke+"]"),j("/Count "+Ye),j(">>"),j("endobj"),lt.publish("postPutPages")},pr=function(b){lt.publish("putFont",{font:b,out:j,newObject:st,putStream:St}),b.isAlreadyPutted!==!0&&(b.objectNumber=st(),j("<<"),j("/Type /Font"),j("/BaseFont /"+Jd(b.postScriptName)),j("/Subtype /Type1"),typeof b.encoding=="string"&&j("/Encoding /"+b.encoding),j("/FirstChar 32"),j("/LastChar 255"),j(">>"),j("endobj"))},ar=function(){for(var b in He)He.hasOwnProperty(b)&&(u===!1||u===!0&&h.hasOwnProperty(b))&&pr(He[b])},ur=function(b){b.objectNumber=st();var W=[];W.push({key:"Type",value:"/XObject"}),W.push({key:"Subtype",value:"/Form"}),W.push({key:"BBox",value:"["+[q(b.x),q(b.y),q(b.x+b.width),q(b.y+b.height)].join(" ")+"]"}),W.push({key:"Matrix",value:"["+b.matrix.toString()+"]"});var ke=b.pages[1].join(`
`);St({data:ke,additionalKeyValues:W,objectId:b.objectNumber}),j("endobj")},Ir=function(){for(var b in Ft)Ft.hasOwnProperty(b)&&ur(Ft[b])},Yr=function(b,W){var ke,Ke=[],nt=1/(W-1);for(ke=0;ke<1;ke+=nt)Ke.push(ke);if(Ke.push(1),b[0].offset!=0){var Bt={offset:0,color:b[0].color};b.unshift(Bt)}if(b[b.length-1].offset!=1){var Nt={offset:1,color:b[b.length-1].color};b.push(Nt)}for(var Zt="",vr=0,Qr=0;Qr<Ke.length;Qr++){for(ke=Ke[Qr];ke>b[vr+1].offset;)vr++;var Tr=b[vr].offset,Vr=(ke-Tr)/(b[vr+1].offset-Tr),kn=b[vr].color,Kn=b[vr+1].color;Zt+=I(Math.round((1-Vr)*kn[0]+Vr*Kn[0]).toString(16))+I(Math.round((1-Vr)*kn[1]+Vr*Kn[1]).toString(16))+I(Math.round((1-Vr)*kn[2]+Vr*Kn[2]).toString(16))}return Zt.trim()},Jr=function(b,W){W||(W=21);var ke=st(),Ke=Yr(b.colors,W),nt=[];nt.push({key:"FunctionType",value:"0"}),nt.push({key:"Domain",value:"[0.0 1.0]"}),nt.push({key:"Size",value:"["+W+"]"}),nt.push({key:"BitsPerSample",value:"8"}),nt.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),nt.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),St({data:Ke,additionalKeyValues:nt,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ke}),j("endobj"),b.objectNumber=st(),j("<< /ShadingType "+b.type),j("/ColorSpace /DeviceRGB");var Bt="/Coords ["+q(parseFloat(b.coords[0]))+" "+q(parseFloat(b.coords[1]))+" ";b.type===2?Bt+=q(parseFloat(b.coords[2]))+" "+q(parseFloat(b.coords[3])):Bt+=q(parseFloat(b.coords[2]))+" "+q(parseFloat(b.coords[3]))+" "+q(parseFloat(b.coords[4]))+" "+q(parseFloat(b.coords[5])),j(Bt+="]"),b.matrix&&j("/Matrix ["+b.matrix.toString()+"]"),j("/Function "+ke+" 0 R"),j("/Extend [true true]"),j(">>"),j("endobj")},qr=function(b,W){var ke=pt(),Ke=st();W.push({resourcesOid:ke,objectOid:Ke}),b.objectNumber=Ke;var nt=[];nt.push({key:"Type",value:"/Pattern"}),nt.push({key:"PatternType",value:"1"}),nt.push({key:"PaintType",value:"1"}),nt.push({key:"TilingType",value:"1"}),nt.push({key:"BBox",value:"["+b.boundingBox.map(q).join(" ")+"]"}),nt.push({key:"XStep",value:q(b.xStep)}),nt.push({key:"YStep",value:q(b.yStep)}),nt.push({key:"Resources",value:ke+" 0 R"}),b.matrix&&nt.push({key:"Matrix",value:"["+b.matrix.toString()+"]"}),St({data:b.stream,additionalKeyValues:nt,objectId:b.objectNumber}),j("endobj")},Ar=function(b){var W;for(W in Re)Re.hasOwnProperty(W)&&(Re[W]instanceof Dl?Jr(Re[W]):Re[W]instanceof sc&&qr(Re[W],b))},Lr=function(b){for(var W in b.objectNumber=st(),j("<<"),b)switch(W){case"opacity":j("/ca "+be(b[W]));break;case"stroke-opacity":j("/CA "+be(b[W]))}j(">>"),j("endobj")},Kr=function(){var b;for(b in qe)qe.hasOwnProperty(b)&&Lr(qe[b])},xr=function(){for(var b in j("/XObject <<"),Ft)Ft.hasOwnProperty(b)&&Ft[b].objectNumber>=0&&j("/"+b+" "+Ft[b].objectNumber+" 0 R");lt.publish("putXobjectDict"),j(">>")},Pr=function(){Sr.oid=st(),j("<<"),j("/Filter /Standard"),j("/V "+Sr.v),j("/R "+Sr.r),j("/U <"+Sr.toHexString(Sr.U)+">"),j("/O <"+Sr.toHexString(Sr.O)+">"),j("/P "+Sr.P),j(">>"),j("endobj")},Hr=function(){for(var b in j("/Font <<"),He)He.hasOwnProperty(b)&&(u===!1||u===!0&&h.hasOwnProperty(b))&&j("/"+b+" "+He[b].objectNumber+" 0 R");j(">>")},cn=function(){if(Object.keys(Re).length>0){for(var b in j("/Shading <<"),Re)Re.hasOwnProperty(b)&&Re[b]instanceof Dl&&Re[b].objectNumber>=0&&j("/"+b+" "+Re[b].objectNumber+" 0 R");lt.publish("putShadingPatternDict"),j(">>")}},pn=function(b){if(Object.keys(Re).length>0){for(var W in j("/Pattern <<"),Re)Re.hasOwnProperty(W)&&Re[W]instanceof p.TilingPattern&&Re[W].objectNumber>=0&&Re[W].objectNumber<b&&j("/"+W+" "+Re[W].objectNumber+" 0 R");lt.publish("putTilingPatternDict"),j(">>")}},Wr=function(){if(Object.keys(qe).length>0){var b;for(b in j("/ExtGState <<"),qe)qe.hasOwnProperty(b)&&qe[b].objectNumber>=0&&j("/"+b+" "+qe[b].objectNumber+" 0 R");lt.publish("putGStateDict"),j(">>")}},wr=function(b){_t(b.resourcesOid,!0),j("<<"),j("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Hr(),cn(),pn(b.objectOid),Wr(),xr(),j(">>"),j("endobj")},En=function(){var b=[];ar(),Kr(),Ir(),Ar(b),lt.publish("putResources"),b.forEach(wr),wr({resourcesOid:Ot,objectOid:Number.MAX_SAFE_INTEGER}),lt.publish("postPutResources")},Do=function(){lt.publish("putAdditionalObjects");for(var b=0;b<M.length;b++){var W=M[b];_t(W.objId,!0),j(W.content),j("endobj")}lt.publish("postPutAdditionalObjects")},wo=function(b){je[b.fontName]=je[b.fontName]||{},je[b.fontName][b.fontStyle]=b.id},yo=function(b,W,ke,Ke,nt){var Bt={id:"F"+(Object.keys(He).length+1).toString(10),postScriptName:b,fontName:W,fontStyle:ke,encoding:Ke,isStandardFont:nt||!1,metadata:{}};return lt.publish("addFont",{font:Bt,instance:this}),He[Bt.id]=Bt,wo(Bt),Bt.id},vs=function(b){for(var W=0,ke=ue.length;W<ke;W++){var Ke=yo.call(this,b[W][0],b[W][1],b[W][2],ue[W][3],!0);u===!1&&(h[Ke]=!0);var nt=b[W][0].split("-");wo({id:Ke,fontName:nt[0],fontStyle:nt[1]||""})}lt.publish("addFonts",{fonts:He,dictionary:je})},io=function(b){return b.foo=function(){try{return b.apply(this,arguments)}catch(Ke){var W=Ke.stack||"";~W.indexOf(" at ")&&(W=W.split(" at ")[1]);var ke="Error in function "+W.split(`
`)[0].split("<")[0]+": "+Ke.message;if(!Fr.console)throw new Error(ke);Fr.console.error(ke,Ke),Fr.alert&&alert(ke)}},b.foo.bar=b,b.foo},No=function(b,W){var ke,Ke,nt,Bt,Nt,Zt,vr,Qr,Tr;if(nt=(W=W||{}).sourceEncoding||"Unicode",Nt=W.outputEncoding,(W.autoencode||Nt)&&He[Ie].metadata&&He[Ie].metadata[nt]&&He[Ie].metadata[nt].encoding&&(Bt=He[Ie].metadata[nt].encoding,!Nt&&He[Ie].encoding&&(Nt=He[Ie].encoding),!Nt&&Bt.codePages&&(Nt=Bt.codePages[0]),typeof Nt=="string"&&(Nt=Bt[Nt]),Nt)){for(vr=!1,Zt=[],ke=0,Ke=b.length;ke<Ke;ke++)(Qr=Nt[b.charCodeAt(ke)])?Zt.push(String.fromCharCode(Qr)):Zt.push(b[ke]),Zt[ke].charCodeAt(0)>>8&&(vr=!0);b=Zt.join("")}for(ke=b.length;vr===void 0&&ke!==0;)b.charCodeAt(ke-1)>>8&&(vr=!0),ke--;if(!vr)return b;for(Zt=W.noBOM?[]:[254,255],ke=0,Ke=b.length;ke<Ke;ke++){if((Tr=(Qr=b.charCodeAt(ke))>>8)>>8)throw new Error("Character at position "+ke+" of string '"+b+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Zt.push(Tr),Zt.push(Qr-(Tr<<8))}return String.fromCharCode.apply(void 0,Zt)},Rn=p.__private__.pdfEscape=p.pdfEscape=function(b,W){return No(b,W).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ve=p.__private__.beginPage=function(b){ge[++Ye]=[],rt[Ye]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(b[0]),topRightY:Number(b[1])}},Kt(Ye),Y(ge[E])},wt=function(b,W){var ke,Ke,nt;switch(t=W||t,typeof b=="string"&&(ke=B(b.toLowerCase()),Array.isArray(ke)&&(Ke=ke[0],nt=ke[1])),Array.isArray(b)&&(Ke=b[0]*V,nt=b[1]*V),isNaN(Ke)&&(Ke=o[0],nt=o[1]),(Ke>14400||nt>14400)&&(Hn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Ke=Math.min(14400,Ke),nt=Math.min(14400,nt)),o=[Ke,nt],t.substr(0,1)){case"l":nt>Ke&&(o=[nt,Ke]);break;case"p":Ke>nt&&(o=[nt,Ke])}Ve(o),tn(Go),j(ms),Xa!==0&&j(Xa+" J"),Ya!==0&&j(Ya+" j"),lt.publish("addPage",{pageNumber:Ye})},qt=function(b){b>0&&b<=Ye&&(ge.splice(b,1),rt.splice(b,1),Ye--,E>Ye&&(E=Ye),this.setPage(E))},Kt=function(b){b>0&&b<=Ye&&(E=b)},kr=p.__private__.getNumberOfPages=p.getNumberOfPages=function(){return ge.length-1},fr=function(b,W,ke){var Ke,nt=void 0;return ke=ke||{},b=b!==void 0?b:He[Ie].fontName,W=W!==void 0?W:He[Ie].fontStyle,Ke=b.toLowerCase(),je[Ke]!==void 0&&je[Ke][W]!==void 0?nt=je[Ke][W]:je[b]!==void 0&&je[b][W]!==void 0?nt=je[b][W]:ke.disableWarning===!1&&Hn.warn("Unable to look up font label for font '"+b+"', '"+W+"'. Refer to getFontList() for available fonts."),nt||ke.noFallback||(nt=je.times[W])==null&&(nt=je.times.normal),nt},ir=p.__private__.putInfo=function(){var b=st(),W=function(Ke){return Ke};for(var ke in c!==null&&(W=Sr.encryptor(b,0)),j("<<"),j("/Producer ("+Rn(W("jsPDF "+zr.version))+")"),ce)ce.hasOwnProperty(ke)&&ce[ke]&&j("/"+ke.substr(0,1).toUpperCase()+ke.substr(1)+" ("+Rn(W(ce[ke]))+")");j("/CreationDate ("+Rn(W(fe))+")"),j(">>"),j("endobj")},Ur=p.__private__.putCatalog=function(b){var W=(b=b||{}).rootDictionaryObjId||Rt;switch(st(),j("<<"),j("/Type /Catalog"),j("/Pages "+W+" 0 R"),ye||(ye="fullwidth"),ye){case"fullwidth":j("/OpenAction [3 0 R /FitH null]");break;case"fullheight":j("/OpenAction [3 0 R /FitV null]");break;case"fullpage":j("/OpenAction [3 0 R /Fit]");break;case"original":j("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ke=""+ye;ke.substr(ke.length-1)==="%"&&(ye=parseInt(ye)/100),typeof ye=="number"&&j("/OpenAction [3 0 R /XYZ null null "+be(ye)+"]")}switch(Oe||(Oe="continuous"),Oe){case"continuous":j("/PageLayout /OneColumn");break;case"single":j("/PageLayout /SinglePage");break;case"two":case"twoleft":j("/PageLayout /TwoColumnLeft");break;case"tworight":j("/PageLayout /TwoColumnRight")}Qe&&j("/PageMode /"+Qe),lt.publish("putCatalog"),j(">>"),j("endobj")},Or=p.__private__.putTrailer=function(){j("trailer"),j("<<"),j("/Size "+(O+1)),j("/Root "+O+" 0 R"),j("/Info "+(O-1)+" 0 R"),c!==null&&j("/Encrypt "+Sr.oid+" 0 R"),j("/ID [ <"+ie+"> <"+ie+"> ]"),j(">>")},Yn=p.__private__.putHeader=function(){j("%PDF-"+v),j("%")},yt=p.__private__.putXRef=function(){var b="0000000000";j("xref"),j("0 "+(O+1)),j("0000000000 65535 f ");for(var W=1;W<=O;W++)typeof D[W]=="function"?j((b+D[W]()).slice(-10)+" 00000 n "):D[W]!==void 0?j((b+D[W]).slice(-10)+" 00000 n "):j("0000000000 00000 n ")},rr=p.__private__.buildDocument=function(){$e(),Y(P),lt.publish("buildDocument"),Yn(),dr(),Do(),En(),c!==null&&Pr(),ir(),Ur();var b=K;return yt(),Or(),j("startxref"),j(""+b),j("%%EOF"),Y(ge[E]),P.join(`
`)},Br=p.__private__.getBlob=function(b){return new Blob([ae(b)],{type:"application/pdf"})},gn=p.output=p.__private__.output=io(function(b,W){switch(typeof(W=W||{})=="string"?W={filename:W}:W.filename=W.filename||"generated.pdf",b){case void 0:return rr();case"save":p.save(W.filename);break;case"arraybuffer":return ae(rr());case"blob":return Br(rr());case"bloburi":case"bloburl":if(Fr.URL!==void 0&&typeof Fr.URL.createObjectURL=="function")return Fr.URL&&Fr.URL.createObjectURL(Br(rr()))||void 0;Hn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ke="",Ke=rr();try{ke=Im(Ke)}catch{ke=Im(unescape(encodeURIComponent(Ke)))}return"data:application/pdf;filename="+W.filename+";base64,"+ke;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Fr)==="[object Window]"){var nt="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Bt=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';W.pdfObjectUrl&&(nt=W.pdfObjectUrl,Bt="");var Nt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+nt+'"'+Bt+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(W)+");<\/script></body></html>",Zt=Fr.open();return Zt!==null&&Zt.document.write(Nt),Zt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Fr)==="[object Window]"){var vr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(W.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+W.filename+'" width="500px" height="400px" /></body></html>',Qr=Fr.open();if(Qr!==null){Qr.document.write(vr);var Tr=this;Qr.document.documentElement.querySelector("#pdfViewer").onload=function(){Qr.document.title=W.filename,Qr.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Tr.output("bloburl"))}}return Qr}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Fr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Vr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",W)+'"></iframe></body></html>',kn=Fr.open();if(kn!==null&&(kn.document.write(Vr),kn.document.title=W.filename),kn||typeof safari>"u")return kn;break;case"datauri":case"dataurl":return Fr.document.location.href=this.output("datauristring",W);default:return null}}),Dn=function(b){return Array.isArray(vt)===!0&&vt.indexOf(b)>-1};switch(r){case"pt":V=1;break;case"mm":V=72/25.4;break;case"cm":V=72/2.54;break;case"in":V=72;break;case"px":V=Dn("px_scaling")==1?.75:96/72;break;case"pc":case"em":V=12;break;case"ex":V=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);V=r}var Sr=null;ze(),te();var Xr=function(b){return c!==null?Sr.encryptor(b,0):function(W){return W}},Fn=p.__private__.getPageInfo=p.getPageInfo=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:rt[b].objId,pageNumber:b,pageContext:rt[b]}},Dt=p.__private__.getPageInfoByObjId=function(b){if(isNaN(b)||b%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var W in rt)if(rt[W].objId===b)break;return Fn(W)},Mo=p.__private__.getCurrentPageInfo=p.getCurrentPageInfo=function(){return{objId:rt[E].objId,pageNumber:E,pageContext:rt[E]}};p.addPage=function(){return wt.apply(this,arguments),this},p.setPage=function(){return Kt.apply(this,arguments),Y.call(this,ge[E]),this},p.insertPage=function(b){return this.addPage(),this.movePage(E,b),this},p.movePage=function(b,W){var ke,Ke;if(b>W){ke=ge[b],Ke=rt[b];for(var nt=b;nt>W;nt--)ge[nt]=ge[nt-1],rt[nt]=rt[nt-1];ge[W]=ke,rt[W]=Ke,this.setPage(W)}else if(b<W){ke=ge[b],Ke=rt[b];for(var Bt=b;Bt<W;Bt++)ge[Bt]=ge[Bt+1],rt[Bt]=rt[Bt+1];ge[W]=ke,rt[W]=Ke,this.setPage(W)}return this},p.deletePage=function(){return qt.apply(this,arguments),this},p.__private__.text=p.text=function(b,W,ke,Ke,nt){var Bt,Nt,Zt,vr,Qr,Tr,Vr,kn,Kn,ro=(Ke=Ke||{}).scope||this;if(typeof b=="number"&&typeof W=="number"&&(typeof ke=="string"||Array.isArray(ke))){var To=ke;ke=W,W=b,b=To}if(arguments[3]instanceof mt?(N("The transform parameter of text() with a Matrix value"),Kn=nt):(Zt=arguments[4],vr=arguments[5],Pn(Vr=arguments[3])==="object"&&Vr!==null||(typeof Zt=="string"&&(vr=Zt,Zt=null),typeof Vr=="string"&&(vr=Vr,Vr=null),typeof Vr=="number"&&(Zt=Vr,Vr=null),Ke={flags:Vr,angle:Zt,align:vr})),isNaN(W)||isNaN(ke)||b==null)throw new Error("Invalid arguments passed to jsPDF.text");if(b.length===0)return ro;var ao="",Wo=!1,ss=typeof Ke.lineHeightFactor=="number"?Ke.lineHeightFactor:qn,ws=ro.internal.scaleFactor;function _a(Vn){return Vn=Vn.split("	").join(Array(Ke.TabLen||9).join(" ")),Rn(Vn,Vr)}function ba(Vn){for(var Gn,xo=Vn.concat(),Ro=[],nA=xo.length;nA--;)typeof(Gn=xo.shift())=="string"?Ro.push(Gn):Array.isArray(Vn)&&(Gn.length===1||Gn[1]===void 0&&Gn[2]===void 0)?Ro.push(Gn[0]):Ro.push([Gn[0],Gn[1],Gn[2]]);return Ro}function Za(Vn,Gn){var xo;if(typeof Vn=="string")xo=Gn(Vn)[0];else if(Array.isArray(Vn)){for(var Ro,nA,Gc=Vn.concat(),_d=[],bh=Gc.length;bh--;)typeof(Ro=Gc.shift())=="string"?_d.push(Gn(Ro)[0]):Array.isArray(Ro)&&typeof Ro[0]=="string"&&(nA=Gn(Ro[0],Ro[1],Ro[2]),_d.push([nA[0],nA[1],nA[2]]));xo=_d}return xo}var Un=!1,Ao=!0;if(typeof b=="string")Un=!0;else if(Array.isArray(b)){var Xo=b.concat();Nt=[];for(var is,_o=Xo.length;_o--;)(typeof(is=Xo.shift())!="string"||Array.isArray(is)&&typeof is[0]!="string")&&(Ao=!1);Un=Ao}if(Un===!1)throw new Error('Type of text must be string or Array. "'+b+'" is not recognized.');typeof b=="string"&&(b=b.match(/[\r?\n]/)?b.split(/\r\n|\r|\n/g):[b]);var Nr=me/ro.internal.scaleFactor,un=Nr*(ss-1);switch(Ke.baseline){case"bottom":ke-=un;break;case"top":ke+=Nr-un;break;case"hanging":ke+=Nr-2*un;break;case"middle":ke+=Nr/2-un}if((Tr=Ke.maxWidth||0)>0&&(typeof b=="string"?b=ro.splitTextToSize(b,Tr):Object.prototype.toString.call(b)==="[object Array]"&&(b=b.reduce(function(Vn,Gn){return Vn.concat(ro.splitTextToSize(Gn,Tr))},[]))),Bt={text:b,x:W,y:ke,options:Ke,mutex:{pdfEscape:Rn,activeFontKey:Ie,fonts:He,activeFontSize:me}},lt.publish("preProcessText",Bt),b=Bt.text,Zt=(Ke=Bt.options).angle,!(Kn instanceof mt)&&Zt&&typeof Zt=="number"){Zt*=Math.PI/180,Ke.rotationDirection===0&&(Zt=-Zt),Q===C.ADVANCED&&(Zt=-Zt);var xn=Math.cos(Zt),Ho=Math.sin(Zt);Kn=new mt(xn,Ho,-Ho,xn,0,0)}else Zt&&Zt instanceof mt&&(Kn=Zt);Q!==C.ADVANCED||Kn||(Kn=Ht),(Qr=Ke.charSpace||Ri)!==void 0&&(ao+=q(R(Qr))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(kn=Ke.horizontalScale)!==void 0&&(ao+=q(100*kn)+` Tz
`),Ke.lang;var $n=-1,jo=Ke.renderingMode!==void 0?Ke.renderingMode:Ke.stroke,lo=ro.internal.getCurrentPageInfo().pageContext;switch(jo){case 0:case!1:case"fill":$n=0;break;case 1:case!0:case"stroke":$n=1;break;case 2:case"fillThenStroke":$n=2;break;case 3:case"invisible":$n=3;break;case 4:case"fillAndAddForClipping":$n=4;break;case 5:case"strokeAndAddPathForClipping":$n=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":$n=6;break;case 7:case"addToPathForClipping":$n=7}var ci=lo.usedRenderingMode!==void 0?lo.usedRenderingMode:-1;$n!==-1?ao+=$n+` Tr
`:ci!==-1&&(ao+=`0 Tr
`),$n!==-1&&(lo.usedRenderingMode=$n),vr=Ke.align||"left";var Yo,eA=me*ss,xl=ro.internal.pageSize.getWidth(),vd=He[Ie];Qr=Ke.charSpace||Ri,Tr=Ke.maxWidth||0,Vr=Object.assign({autoencode:!0,noBOM:!0},Ke.flags);var xa=[],tA=function(Vn){return ro.getStringUnitWidth(Vn,{font:vd,charSpace:Qr,fontSize:me,doKerning:!1})*me/ws};if(Object.prototype.toString.call(b)==="[object Array]"){var as;Nt=ba(b),vr!=="left"&&(Yo=Nt.map(tA));var As,Us=0;if(vr==="right"){W-=Yo[0],b=[],_o=Nt.length;for(var ls=0;ls<_o;ls++)ls===0?(As=Ks(W),as=$s(ke)):(As=R(Us-Yo[ls]),as=-eA),b.push([Nt[ls],As,as]),Us=Yo[ls]}else if(vr==="center"){W-=Yo[0]/2,b=[],_o=Nt.length;for(var ui=0;ui<_o;ui++)ui===0?(As=Ks(W),as=$s(ke)):(As=R((Us-Yo[ui])/2),as=-eA),b.push([Nt[ui],As,as]),Us=Yo[ui]}else if(vr==="left"){b=[],_o=Nt.length;for(var md=0;md<_o;md++)b.push(Nt[md])}else if(vr==="justify"&&vd.encoding==="Identity-H"){b=[],_o=Nt.length,Tr=Tr!==0?Tr:xl;for(var rA=0,bo=0;bo<_o;bo++)if(as=bo===0?$s(ke):-eA,As=bo===0?Ks(W):rA,bo<_o-1){var Kc=R((Tr-Yo[bo])/(Nt[bo].split(" ").length-1)),Qs=Nt[bo].split(" ");b.push([Qs[0]+" ",As,as]),rA=0;for(var Ei=1;Ei<Qs.length;Ei++){var wd=(tA(Qs[Ei-1]+" "+Qs[Ei])-tA(Qs[Ei]))*ws+Kc;Ei==Qs.length-1?b.push([Qs[Ei],wd,0]):b.push([Qs[Ei]+" ",wd,0]),rA-=wd}}else b.push([Nt[bo],As,as]);b.push(["",rA,0])}else{if(vr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(b=[],_o=Nt.length,Tr=Tr!==0?Tr:xl,bo=0;bo<_o;bo++)as=bo===0?$s(ke):-eA,As=bo===0?Ks(W):0,bo<_o-1?xa.push(q(R((Tr-Yo[bo])/(Nt[bo].split(" ").length-1)))):xa.push(0),b.push([Nt[bo],As,as])}}var _h=typeof Ke.R2L=="boolean"?Ke.R2L:de;_h===!0&&(b=Za(b,function(Vn,Gn,xo){return[Vn.split("").reverse().join(""),Gn,xo]})),Bt={text:b,x:W,y:ke,options:Ke,mutex:{pdfEscape:Rn,activeFontKey:Ie,fonts:He,activeFontSize:me}},lt.publish("postProcessText",Bt),b=Bt.text,Wo=Bt.mutex.isHex||!1;var $c=He[Ie].encoding;$c!=="WinAnsiEncoding"&&$c!=="StandardEncoding"||(b=Za(b,function(Vn,Gn,xo){return[_a(Vn),Gn,xo]})),Nt=ba(b),b=[];for(var Bl,zl,PA,Cl=0,yd=1,Sl=Array.isArray(Nt[0])?yd:Cl,kA="",Vc=function(Vn,Gn,xo){var Ro="";return xo instanceof mt?(xo=typeof Ke.angle=="number"?Gt(xo,new mt(1,0,0,1,Vn,Gn)):Gt(new mt(1,0,0,1,Vn,Gn),xo),Q===C.ADVANCED&&(xo=Gt(new mt(1,0,0,-1,0,0),xo)),Ro=xo.join(" ")+` Tm
`):Ro=q(Vn)+" "+q(Gn)+` Td
`,Ro},Fi=0;Fi<Nt.length;Fi++){switch(kA="",Sl){case yd:PA=(Wo?"<":"(")+Nt[Fi][0]+(Wo?">":")"),Bl=parseFloat(Nt[Fi][1]),zl=parseFloat(Nt[Fi][2]);break;case Cl:PA=(Wo?"<":"(")+Nt[Fi]+(Wo?">":")"),Bl=Ks(W),zl=$s(ke)}xa!==void 0&&xa[Fi]!==void 0&&(kA=xa[Fi]+` Tw
`),Fi===0?b.push(kA+Vc(Bl,zl,Kn)+PA):Sl===Cl?b.push(kA+PA):Sl===yd&&b.push(kA+Vc(Bl,zl,Kn)+PA)}b=Sl===Cl?b.join(` Tj
T* `):b.join(` Tj
`),b+=` Tj
`;var Ii=`BT
/`;return Ii+=Ie+" "+me+` Tf
`,Ii+=q(me*ss)+` TL
`,Ii+=di+`
`,Ii+=ao,Ii+=b,j(Ii+="ET"),h[Ie]=!0,ro};var Nn=p.__private__.clip=p.clip=function(b){return j(b==="evenodd"?"W*":"W"),this};p.clipEvenOdd=function(){return Nn("evenodd")},p.__private__.discardPath=p.discardPath=function(){return j("n"),this};var Zr=p.__private__.isValidStyle=function(b){var W=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(b)!==-1&&(W=!0),W};p.__private__.setDefaultPathOperation=p.setDefaultPathOperation=function(b){return Zr(b)&&(d=b),this};var Vt=p.__private__.getStyle=p.getStyle=function(b){var W=d;switch(b){case"D":case"S":W="S";break;case"F":W="f";break;case"FD":case"DF":W="B";break;case"f":case"f*":case"B":case"B*":W=b}return W},en=p.close=function(){return j("h"),this};p.stroke=function(){return j("S"),this},p.fill=function(b){return In("f",b),this},p.fillEvenOdd=function(b){return In("f*",b),this},p.fillStroke=function(b){return In("B",b),this},p.fillStrokeEvenOdd=function(b){return In("B*",b),this};var In=function(b,W){Pn(W)==="object"?ai(W,b):j(b)},fo=function(b){b===null||Q===C.ADVANCED&&b===void 0||(b=Vt(b),j(b))};function Qo(b,W,ke,Ke,nt){var Bt=new sc(W||this.boundingBox,ke||this.xStep,Ke||this.yStep,this.gState,nt||this.matrix);Bt.stream=this.stream;var Nt=b+"$$"+this.cloneIndex+++"$$";return Ut(Nt,Bt),Bt}var ai=function(b,W){var ke=et[b.key],Ke=Re[ke];if(Ke instanceof Dl)j("q"),j(Bi(W)),Ke.gState&&p.setGState(Ke.gState),j(b.matrix.toString()+" cm"),j("/"+ke+" sh"),j("Q");else if(Ke instanceof sc){var nt=new mt(1,0,0,-1,0,Si());b.matrix&&(nt=nt.multiply(b.matrix||Ht),ke=Qo.call(Ke,b.key,b.boundingBox,b.xStep,b.yStep,nt).id),j("q"),j("/Pattern cs"),j("/"+ke+" scn"),Ke.gState&&p.setGState(Ke.gState),j(W),j("Q")}},Bi=function(b){switch(b){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},zi=p.moveTo=function(b,W){return j(q(R(b))+" "+q(se(W))+" m"),this},Ai=p.lineTo=function(b,W){return j(q(R(b))+" "+q(se(W))+" l"),this},qs=p.curveTo=function(b,W,ke,Ke,nt,Bt){return j([q(R(b)),q(se(W)),q(R(ke)),q(se(Ke)),q(R(nt)),q(se(Bt)),"c"].join(" ")),this};p.__private__.line=p.line=function(b,W,ke,Ke,nt){if(isNaN(b)||isNaN(W)||isNaN(ke)||isNaN(Ke)||!Zr(nt))throw new Error("Invalid arguments passed to jsPDF.line");return Q===C.COMPAT?this.lines([[ke-b,Ke-W]],b,W,[1,1],nt||"S"):this.lines([[ke-b,Ke-W]],b,W,[1,1]).stroke()},p.__private__.lines=p.lines=function(b,W,ke,Ke,nt,Bt){var Nt,Zt,vr,Qr,Tr,Vr,kn,Kn,ro,To,ao,Wo;if(typeof b=="number"&&(Wo=ke,ke=W,W=b,b=Wo),Ke=Ke||[1,1],Bt=Bt||!1,isNaN(W)||isNaN(ke)||!Array.isArray(b)||!Array.isArray(Ke)||!Zr(nt)||typeof Bt!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(zi(W,ke),Nt=Ke[0],Zt=Ke[1],Qr=b.length,To=W,ao=ke,vr=0;vr<Qr;vr++)(Tr=b[vr]).length===2?(To=Tr[0]*Nt+To,ao=Tr[1]*Zt+ao,Ai(To,ao)):(Vr=Tr[0]*Nt+To,kn=Tr[1]*Zt+ao,Kn=Tr[2]*Nt+To,ro=Tr[3]*Zt+ao,To=Tr[4]*Nt+To,ao=Tr[5]*Zt+ao,qs(Vr,kn,Kn,ro,To,ao));return Bt&&en(),fo(nt),this},p.path=function(b){for(var W=0;W<b.length;W++){var ke=b[W],Ke=ke.c;switch(ke.op){case"m":zi(Ke[0],Ke[1]);break;case"l":Ai(Ke[0],Ke[1]);break;case"c":qs.apply(this,Ke);break;case"h":en()}}return this},p.__private__.rect=p.rect=function(b,W,ke,Ke,nt){if(isNaN(b)||isNaN(W)||isNaN(ke)||isNaN(Ke)||!Zr(nt))throw new Error("Invalid arguments passed to jsPDF.rect");return Q===C.COMPAT&&(Ke=-Ke),j([q(R(b)),q(se(W)),q(R(ke)),q(R(Ke)),"re"].join(" ")),fo(nt),this},p.__private__.triangle=p.triangle=function(b,W,ke,Ke,nt,Bt,Nt){if(isNaN(b)||isNaN(W)||isNaN(ke)||isNaN(Ke)||isNaN(nt)||isNaN(Bt)||!Zr(Nt))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ke-b,Ke-W],[nt-ke,Bt-Ke],[b-nt,W-Bt]],b,W,[1,1],Nt,!0),this},p.__private__.roundedRect=p.roundedRect=function(b,W,ke,Ke,nt,Bt,Nt){if(isNaN(b)||isNaN(W)||isNaN(ke)||isNaN(Ke)||isNaN(nt)||isNaN(Bt)||!Zr(Nt))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Zt=4/3*(Math.SQRT2-1);return nt=Math.min(nt,.5*ke),Bt=Math.min(Bt,.5*Ke),this.lines([[ke-2*nt,0],[nt*Zt,0,nt,Bt-Bt*Zt,nt,Bt],[0,Ke-2*Bt],[0,Bt*Zt,-nt*Zt,Bt,-nt,Bt],[2*nt-ke,0],[-nt*Zt,0,-nt,-Bt*Zt,-nt,-Bt],[0,2*Bt-Ke],[0,-Bt*Zt,nt*Zt,-Bt,nt,-Bt]],b+nt,W,[1,1],Nt,!0),this},p.__private__.ellipse=p.ellipse=function(b,W,ke,Ke,nt){if(isNaN(b)||isNaN(W)||isNaN(ke)||isNaN(Ke)||!Zr(nt))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Bt=4/3*(Math.SQRT2-1)*ke,Nt=4/3*(Math.SQRT2-1)*Ke;return zi(b+ke,W),qs(b+ke,W-Nt,b+Bt,W-Ke,b,W-Ke),qs(b-Bt,W-Ke,b-ke,W-Nt,b-ke,W),qs(b-ke,W+Nt,b-Bt,W+Ke,b,W+Ke),qs(b+Bt,W+Ke,b+ke,W+Nt,b+ke,W),fo(nt),this},p.__private__.circle=p.circle=function(b,W,ke,Ke){if(isNaN(b)||isNaN(W)||isNaN(ke)||!Zr(Ke))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(b,W,ke,ke,Ke)},p.setFont=function(b,W,ke){return ke&&(W=Z(W,ke)),Ie=fr(b,W,{disableWarning:!1}),this};var ji=p.__private__.getFont=p.getFont=function(){return He[fr.apply(p,arguments)]};p.__private__.getFontList=p.getFontList=function(){var b,W,ke={};for(b in je)if(je.hasOwnProperty(b))for(W in ke[b]=[],je[b])je[b].hasOwnProperty(W)&&ke[b].push(W);return ke},p.addFont=function(b,W,ke,Ke,nt){var Bt=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Bt.indexOf(arguments[3])!==-1?nt=arguments[3]:arguments[3]&&Bt.indexOf(arguments[3])==-1&&(ke=Z(ke,Ke)),nt=nt||"Identity-H",yo.call(this,b,W,ke,nt)};var qn,Go=n.lineWidth||.200025,Jn=p.__private__.getLineWidth=p.getLineWidth=function(){return Go},tn=p.__private__.setLineWidth=p.setLineWidth=function(b){return Go=b,j(q(R(b))+" w"),this};p.__private__.setLineDash=zr.API.setLineDash=zr.API.setLineDashPattern=function(b,W){if(b=b||[],W=W||0,isNaN(W)||!Array.isArray(b))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return b=b.map(function(ke){return q(R(ke))}).join(" "),W=q(R(W)),j("["+b+"] "+W+" d"),this};var fa=p.__private__.getLineHeight=p.getLineHeight=function(){return me*qn};p.__private__.getLineHeight=p.getLineHeight=function(){return me*qn};var Ga=p.__private__.setLineHeightFactor=p.setLineHeightFactor=function(b){return typeof(b=b||1.15)=="number"&&(qn=b),this},pa=p.__private__.getLineHeightFactor=p.getLineHeightFactor=function(){return qn};Ga(n.lineHeight);var Ks=p.__private__.getHorizontalCoordinate=function(b){return R(b)},$s=p.__private__.getVerticalCoordinate=function(b){return Q===C.ADVANCED?b:rt[E].mediaBox.topRightY-rt[E].mediaBox.bottomLeftY-R(b)},IA=p.__private__.getHorizontalCoordinateString=p.getHorizontalCoordinateString=function(b){return q(Ks(b))},li=p.__private__.getVerticalCoordinateString=p.getVerticalCoordinateString=function(b){return q($s(b))},ms=n.strokeColor||"0 G";p.__private__.getStrokeColor=p.getDrawColor=function(){return Ct(ms)},p.__private__.setStrokeColor=p.setDrawColor=function(b,W,ke,Ke){return ms=Wt({ch1:b,ch2:W,ch3:ke,ch4:Ke,pdfColorType:"draw",precision:2}),j(ms),this};var Wa=n.fillColor||"0 g";p.__private__.getFillColor=p.getFillColor=function(){return Ct(Wa)},p.__private__.setFillColor=p.setFillColor=function(b,W,ke,Ke){return Wa=Wt({ch1:b,ch2:W,ch3:ke,ch4:Ke,pdfColorType:"fill",precision:2}),j(Wa),this};var di=n.textColor||"0 g",UA=p.__private__.getTextColor=p.getTextColor=function(){return Ct(di)};p.__private__.setTextColor=p.setTextColor=function(b,W,ke,Ke){return di=Wt({ch1:b,ch2:W,ch3:ke,ch4:Ke,pdfColorType:"text",precision:3}),this};var Ri=n.charSpace,QA=p.__private__.getCharSpace=p.getCharSpace=function(){return parseFloat(Ri||0)};p.__private__.setCharSpace=p.setCharSpace=function(b){if(isNaN(b))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ri=b,this};var Xa=0;p.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},p.__private__.setLineCap=p.setLineCap=function(b){var W=p.CapJoinStyles[b];if(W===void 0)throw new Error("Line cap style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Xa=W,j(W+" J"),this};var Ya=0;p.__private__.setLineJoin=p.setLineJoin=function(b){var W=p.CapJoinStyles[b];if(W===void 0)throw new Error("Line join style of '"+b+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Ya=W,j(W+" j"),this},p.__private__.setLineMiterLimit=p.__private__.setMiterLimit=p.setLineMiterLimit=p.setMiterLimit=function(b){if(b=b||0,isNaN(b))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return j(q(R(b))+" M"),this},p.GState=Wp,p.setGState=function(b){(b=typeof b=="string"?qe[ot[b]]:TA(null,b)).equals(Pe)||(j("/"+b.id+" gs"),Pe=b)};var TA=function(b,W){if(!b||!ot[b]){var ke=!1;for(var Ke in qe)if(qe.hasOwnProperty(Ke)&&qe[Ke].equals(W)){ke=!0;break}if(ke)W=qe[Ke];else{var nt="GS"+(Object.keys(qe).length+1).toString(10);qe[nt]=W,W.id=nt}return b&&(ot[b]=W.id),lt.publish("addGState",W),W}};p.addGState=function(b,W){return TA(b,W),this},p.saveGraphicsState=function(){return j("q"),xe.push({key:Ie,size:me,color:di}),this},p.restoreGraphicsState=function(){j("Q");var b=xe.pop();return Ie=b.key,me=b.size,di=b.color,Pe=null,this},p.setCurrentTransformationMatrix=function(b){return j(b.toString()+" cm"),this},p.comment=function(b){return j("#"+b),this};var Ci=function(b,W){var ke=b||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ke},set:function(Bt){isNaN(Bt)||(ke=parseFloat(Bt))}});var Ke=W||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Ke},set:function(Bt){isNaN(Bt)||(Ke=parseFloat(Bt))}});var nt="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return nt},set:function(Bt){nt=Bt.toString()}}),this},ga=function(b,W,ke,Ke){Ci.call(this,b,W),this.type="rect";var nt=ke||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return nt},set:function(Nt){isNaN(Nt)||(nt=parseFloat(Nt))}});var Bt=Ke||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Bt},set:function(Nt){isNaN(Nt)||(Bt=parseFloat(Nt))}}),this},va=function(){this.page=Ye,this.currentPage=E,this.pages=ge.slice(0),this.pagesContext=rt.slice(0),this.x=G,this.y=le,this.matrix=Le,this.width=qi(E),this.height=Si(E),this.outputDestination=Me,this.id="",this.objectNumber=-1};va.prototype.restore=function(){Ye=this.page,E=this.currentPage,rt=this.pagesContext,ge=this.pages,G=this.x,le=this.y,Le=this.matrix,wa(E,this.width),ya(E,this.height),Me=this.outputDestination};var Ja=function(b,W,ke,Ke,nt){Et.push(new va),Ye=E=0,ge=[],G=b,le=W,Le=nt,Ve([ke,Ke])},LA=function(b){if(Qt[b])Et.pop().restore();else{var W=new va,ke="Xo"+(Object.keys(Ft).length+1).toString(10);W.id=ke,Qt[b]=ke,Ft[ke]=W,lt.publish("addFormObject",W),Et.pop().restore()}};for(var ma in p.beginFormObject=function(b,W,ke,Ke,nt){return Ja(b,W,ke,Ke,nt),this},p.endFormObject=function(b){return LA(b),this},p.doFormObject=function(b,W){var ke=Ft[Qt[b]];return j("q"),j(W.toString()+" cm"),j("/"+ke.id+" Do"),j("Q"),this},p.getFormObject=function(b){var W=Ft[Qt[b]];return{x:W.x,y:W.y,width:W.width,height:W.height,matrix:W.matrix}},p.save=function(b,W){return b=b||"generated.pdf",(W=W||{}).returnPromise=W.returnPromise||!1,W.returnPromise===!1?(Ql(Br(rr()),b),typeof Ql.unload=="function"&&Fr.setTimeout&&setTimeout(Ql.unload,911),this):new Promise(function(ke,Ke){try{var nt=Ql(Br(rr()),b);typeof Ql.unload=="function"&&Fr.setTimeout&&setTimeout(Ql.unload,911),ke(nt)}catch(Bt){Ke(Bt.message)}})},zr.API)zr.API.hasOwnProperty(ma)&&(ma==="events"&&zr.API.events.length?function(b,W){var ke,Ke,nt;for(nt=W.length-1;nt!==-1;nt--)ke=W[nt][0],Ke=W[nt][1],b.subscribe.apply(b,[ke].concat(typeof Ke=="function"?[Ke]:Ke))}(lt,zr.API.events):p[ma]=zr.API[ma]);var qi=p.getPageWidth=function(b){return(rt[b=b||E].mediaBox.topRightX-rt[b].mediaBox.bottomLeftX)/V},wa=p.setPageWidth=function(b,W){rt[b].mediaBox.topRightX=W*V+rt[b].mediaBox.bottomLeftX},Si=p.getPageHeight=function(b){return(rt[b=b||E].mediaBox.topRightY-rt[b].mediaBox.bottomLeftY)/V},ya=p.setPageHeight=function(b,W){rt[b].mediaBox.topRightY=W*V+rt[b].mediaBox.bottomLeftY};return p.internal={pdfEscape:Rn,getStyle:Vt,getFont:ji,getFontSize:Ee,getCharSpace:QA,getTextColor:UA,getLineHeight:fa,getLineHeightFactor:pa,getLineWidth:Jn,write:ee,getHorizontalCoordinate:Ks,getVerticalCoordinate:$s,getCoordinateString:IA,getVerticalCoordinateString:li,collections:{},newObject:st,newAdditionalObject:$t,newObjectDeferred:pt,newObjectDeferredBegin:_t,getFilters:It,putStream:St,events:lt,scaleFactor:V,pageSize:{getWidth:function(){return qi(E)},setWidth:function(b){wa(E,b)},getHeight:function(){return Si(E)},setHeight:function(b){ya(E,b)}},encryptionOptions:c,encryption:Sr,getEncryptor:Xr,output:gn,getNumberOfPages:kr,pages:ge,out:j,f2:be,f3:L,getPageInfo:Fn,getPageInfoByObjId:Dt,getCurrentPageInfo:Mo,getPDFVersion:w,Point:Ci,Rectangle:ga,Matrix:mt,hasHotfix:Dn},Object.defineProperty(p.internal.pageSize,"width",{get:function(){return qi(E)},set:function(b){wa(E,b)},enumerable:!0,configurable:!0}),Object.defineProperty(p.internal.pageSize,"height",{get:function(){return Si(E)},set:function(b){ya(E,b)},enumerable:!0,configurable:!0}),vs.call(p,ue),Ie="F1",wt(o,t),lt.publish("initialized"),p}Yd.prototype.lsbFirstWord=function(n){return String.fromCharCode(n>>0&255,n>>8&255,n>>16&255,n>>24&255)},Yd.prototype.toHexString=function(n){return n.split("").map(function(e){return("0"+(255&e.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Yd.prototype.hexToBytes=function(n){for(var e=[],t=0;t<n.length;t+=2)e.push(String.fromCharCode(parseInt(n.substr(t,2),16)));return e.join("")},Yd.prototype.processOwnerPassword=function(n,e){return Qm(Um(e).substr(0,5),n)},Yd.prototype.encryptor=function(n,e){var t=Um(this.encryptionKey+String.fromCharCode(255&n,n>>8&255,n>>16&255,255&e,e>>8&255)).substr(0,10);return function(r){return Qm(t,r)}},Wp.prototype.equals=function(n){var e,t="id,objectNumber,equals";if(!n||Pn(n)!==Pn(this))return!1;var r=0;for(e in this)if(!(t.indexOf(e)>=0)){if(this.hasOwnProperty(e)&&!n.hasOwnProperty(e)||this[e]!==n[e])return!1;r++}for(e in n)n.hasOwnProperty(e)&&t.indexOf(e)<0&&r--;return r===0},zr.API={events:[]},zr.version="3.0.0";var go=zr.API,t2=1,gd=function(n){return n.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Kd=function(n){return n.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Mr=function(n){return n.toFixed(2)},GA=function(n){return n.toFixed(5)};go.__acroform__={};var ii=function(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n},v_=function(n){return n*t2},Fa=function(n){var e=new mz,t=hr.internal.getHeight(n)||0,r=hr.internal.getWidth(n)||0;return e.BBox=[0,0,Number(Mr(r)),Number(Mr(t))],e},sN=go.__acroform__.setBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return n|=1<<e},iN=go.__acroform__.clearBit=function(n,e){if(n=n||0,e=e||0,isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return n&=~(1<<e)},aN=go.__acroform__.getBit=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return n&1<<e?1:0},Eo=go.__acroform__.getBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return aN(n,e-1)},Fo=go.__acroform__.setBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return sN(n,e-1)},Io=go.__acroform__.clearBitForPdf=function(n,e){if(isNaN(n)||isNaN(e))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return iN(n,e-1)},AN=go.__acroform__.calculateCoordinates=function(n,e){var t=e.internal.getHorizontalCoordinate,r=e.internal.getVerticalCoordinate,o=n[0],s=n[1],i=n[2],a=n[3],A={};return A.lowerLeft_X=t(o)||0,A.lowerLeft_Y=r(s+a)||0,A.upperRight_X=t(o+i)||0,A.upperRight_Y=r(s)||0,[Number(Mr(A.lowerLeft_X)),Number(Mr(A.lowerLeft_Y)),Number(Mr(A.upperRight_X)),Number(Mr(A.upperRight_Y))]},lN=function(n){if(n.appearanceStreamContent)return n.appearanceStreamContent;if(n.V||n.DV){var e=[],t=n._V||n.DV,r=Tm(n,t),o=n.scope.internal.getFont(n.fontName,n.fontStyle).id;e.push("/Tx BMC"),e.push("q"),e.push("BT"),e.push(n.scope.__private__.encodeColorString(n.color)),e.push("/"+o+" "+Mr(r.fontSize)+" Tf"),e.push("1 0 0 1 0 0 Tm"),e.push(r.text),e.push("ET"),e.push("Q"),e.push("EMC");var s=Fa(n);return s.scope=n.scope,s.stream=e.join(`
`),s}},Tm=function(n,e){var t=n.fontSize===0?n.maxFontSize:n.fontSize,r={text:"",fontSize:""},o=(e=(e=e.substr(0,1)=="("?e.substr(1):e).substr(e.length-1)==")"?e.substr(0,e.length-1):e).split(" ");o=n.multiline?o.map(function(L){return L.split(`
`)}):o.map(function(L){return[L]});var s=t,i=hr.internal.getHeight(n)||0;i=i<0?-i:i;var a=hr.internal.getWidth(n)||0;a=a<0?-a:a;var A=function(L,R,J){if(L+1<o.length){var se=R+" "+o[L+1][0];return Kf(se,n,J).width<=a-4}return!1};s++;e:for(;s>0;){e="",s--;var d,c,u=Kf("3",n,s).height,h=n.multiline?i-s:(i-u)/2,p=h+=2,v=0,w=0,y=0;if(s<=0){e=`(...) Tj
`,e+="% Width of Text: "+Kf(e,n,s=12).width+", FieldWidth:"+a+`
`;break}for(var B="",C=0,Q=0;Q<o.length;Q++)if(o.hasOwnProperty(Q)){var k=!1;if(o[Q].length!==1&&y!==o[Q].length-1){if((u+2)*(C+2)+2>i)continue e;B+=o[Q][y],k=!0,w=Q,Q--}else{B=(B+=o[Q][y]+" ").substr(B.length-1)==" "?B.substr(0,B.length-1):B;var H=parseInt(Q),Z=A(H,B,s),q=Q>=o.length-1;if(Z&&!q){B+=" ",y=0;continue}if(Z||q){if(q)w=H;else if(n.multiline&&(u+2)*(C+2)+2>i)continue e}else{if(!n.multiline||(u+2)*(C+2)+2>i)continue e;w=H}}for(var N="",re=v;re<=w;re++){var be=o[re];if(n.multiline){if(re===w){N+=be[y]+" ",y=(y+1)%be.length;continue}if(re===v){N+=be[be.length-1]+" ";continue}}N+=be[0]+" "}switch(N=N.substr(N.length-1)==" "?N.substr(0,N.length-1):N,c=Kf(N,n,s).width,n.textAlign){case"right":d=a-c-2;break;case"center":d=(a-c)/2;break;case"left":default:d=2}e+=Mr(d)+" "+Mr(p)+` Td
`,e+="("+gd(N)+`) Tj
`,e+=-Mr(d)+` 0 Td
`,p=-(s+2),c=0,v=k?w:w+1,C++,B=""}break}return r.text=e,r.fontSize=s,r},Kf=function(n,e,t){var r=e.scope.internal.getFont(e.fontName,e.fontStyle),o=e.scope.getStringUnitWidth(n,{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t);return{height:e.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(t),charSpace:0})*parseFloat(t)*1.5,width:o}},dN={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},cN=function(n,e){var t={type:"reference",object:n};e.internal.getPageInfo(n.page).pageContext.annotations.find(function(r){return r.type===t.type&&r.object===t.object})===void 0&&e.internal.getPageInfo(n.page).pageContext.annotations.push(t)},uN=function(n,e){for(var t in n)if(n.hasOwnProperty(t)){var r=t,o=n[t];e.internal.newObjectDeferredBegin(o.objId,!0),Pn(o)==="object"&&typeof o.putStream=="function"&&o.putStream(),delete n[r]}},hN=function(n,e){if(e.scope=n,n.internal!==void 0&&(n.internal.acroformPlugin===void 0||n.internal.acroformPlugin.isInitialized===!1)){if(ca.FieldNum=0,n.internal.acroformPlugin=JSON.parse(JSON.stringify(dN)),n.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");t2=n.internal.scaleFactor,n.internal.acroformPlugin.acroFormDictionaryRoot=new wz,n.internal.acroformPlugin.acroFormDictionaryRoot.scope=n,n.internal.acroformPlugin.acroFormDictionaryRoot._eventID=n.internal.events.subscribe("postPutResources",function(){(function(t){t.internal.events.unsubscribe(t.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete t.internal.acroformPlugin.acroFormDictionaryRoot._eventID,t.internal.acroformPlugin.printedOut=!0})(n)}),n.internal.events.subscribe("buildDocument",function(){(function(t){t.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=t.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var o in r)if(r.hasOwnProperty(o)){var s=r[o];s.objId=void 0,s.hasAnnotation&&cN(s,t)}})(n)}),n.internal.events.subscribe("putCatalog",function(){(function(t){if(t.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");t.internal.write("/AcroForm "+t.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(n)}),n.internal.events.subscribe("postPutPages",function(t){(function(r,o){var s=!r;for(var i in r||(o.internal.newObjectDeferredBegin(o.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),o.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||o.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(i)){var a=r[i],A=[],d=a.Rect;if(a.Rect&&(a.Rect=AN(a.Rect,o)),o.internal.newObjectDeferredBegin(a.objId,!0),a.DA=hr.createDefaultAppearanceStream(a),Pn(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(A=a.getKeyValueListForStream()),a.Rect=d,a.hasAppearanceStream&&!a.appearanceStreamContent){var c=lN(a);A.push({key:"AP",value:"<</N "+c+">>"}),o.internal.acroformPlugin.xForms.push(c)}if(a.appearanceStreamContent){var u="";for(var h in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(h)){var p=a.appearanceStreamContent[h];if(u+="/"+h+" ",u+="<<",Object.keys(p).length>=1||Array.isArray(p)){for(var i in p)if(p.hasOwnProperty(i)){var v=p[i];typeof v=="function"&&(v=v.call(o,a)),u+="/"+i+" "+v+" ",o.internal.acroformPlugin.xForms.indexOf(v)>=0||o.internal.acroformPlugin.xForms.push(v)}}else typeof(v=p)=="function"&&(v=v.call(o,a)),u+="/"+i+" "+v,o.internal.acroformPlugin.xForms.indexOf(v)>=0||o.internal.acroformPlugin.xForms.push(v);u+=">>"}A.push({key:"AP",value:`<<
`+u+">>"})}o.internal.putStream({additionalKeyValues:A,objectId:a.objId}),o.internal.out("endobj")}s&&uN(o.internal.acroformPlugin.xForms,o)})(t,n)}),n.internal.acroformPlugin.isInitialized=!0}},vz=go.__acroform__.arrayToPdfArray=function(n,e,t){var r=function(i){return i};if(Array.isArray(n)){for(var o="[",s=0;s<n.length;s++)switch(s!==0&&(o+=" "),Pn(n[s])){case"boolean":case"number":case"object":o+=n[s].toString();break;case"string":n[s].substr(0,1)!=="/"?(e!==void 0&&t&&(r=t.internal.getEncryptor(e)),o+="("+gd(r(n[s].toString()))+")"):o+=n[s].toString()}return o+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},a0=function(n,e,t){var r=function(o){return o};return e!==void 0&&t&&(r=t.internal.getEncryptor(e)),(n=n||"").toString(),n="("+gd(r(n))+")"},Ta=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(n){this._objId=n}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ta.prototype.toString=function(){return this.objId+" 0 R"},Ta.prototype.putStream=function(){var n=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:n,objectId:this.objId}),this.scope.internal.out("endobj")},Ta.prototype.getKeyValueListForStream=function(){var n=[],e=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var t in e)if(Object.getOwnPropertyDescriptor(this,e[t]).configurable===!1){var r=e[t],o=this[r];o&&(Array.isArray(o)?n.push({key:r,value:vz(o,this.objId,this.scope)}):o instanceof Ta?(o.scope=this.scope,n.push({key:r,value:o.objId+" 0 R"})):typeof o!="function"&&n.push({key:r,value:o}))}return n};var mz=function(){Ta.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var n,e=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(t){n=t.trim()},get:function(){return n||null}})};ii(mz,Ta);var wz=function(){Ta.call(this);var n,e=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return e.length>0?e:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return e}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(n){var t=function(r){return r};return this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),"("+gd(t(n))+")"}},set:function(t){n=t}})};ii(wz,Ta);var ca=function n(){Ta.call(this);var e=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return e},set:function(B){if(isNaN(B))throw new Error('Invalid value "'+B+'" for attribute F supplied.');e=B}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Eo(e,3)},set:function(B){B?this.F=Fo(e,3):this.F=Io(e,3)}});var t=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return t},set:function(B){if(isNaN(B))throw new Error('Invalid value "'+B+'" for attribute Ff supplied.');t=B}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(B){r=B!==void 0?B:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(B){r[0]=B}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(B){r[1]=B}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(B){r[2]=B}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(B){r[3]=B}});var o="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return o},set:function(B){switch(B){case"/Btn":case"/Tx":case"/Ch":case"/Sig":o=B;break;default:throw new Error('Invalid value "'+B+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof Xp)return;s="FieldObject"+n.FieldNum++}var B=function(C){return C};return this.scope&&(B=this.scope.internal.getEncryptor(this.objId)),"("+gd(B(s))+")"},set:function(B){s=B.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(B){s=B}});var i="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return i},set:function(B){i=B}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(B){a=B}});var A=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return A},set:function(B){A=B}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/t2:d},set:function(B){d=B}});var c="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return c},set:function(B){c=B}});var u="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!u||this instanceof Xp||this instanceof Zl))return a0(u,this.objId,this.scope)},set:function(B){B=B.toString(),u=B}});var h=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ns?h:a0(h,this.objId,this.scope)},set:function(B){B=B.toString(),h=this instanceof ns?B:B.substr(0,1)==="("?Kd(B.substr(1,B.length-2)):Kd(B)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns?Kd(h.substr(1,h.length-1)):h},set:function(B){B=B.toString(),h=this instanceof ns?"/"+B:B}});var p=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(p)return p},set:function(B){this.V=B}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof ns?p:a0(p,this.objId,this.scope)},set:function(B){B=B.toString(),p=this instanceof ns?B:B.substr(0,1)==="("?Kd(B.substr(1,B.length-2)):Kd(B)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ns?Kd(p.substr(1,p.length-1)):p},set:function(B){B=B.toString(),p=this instanceof ns?"/"+B:B}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,w=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return w},set:function(B){B=!!B,w=B}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(B){v=B}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,1)},set:function(B){B?this.Ff=Fo(this.Ff,1):this.Ff=Io(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,2)},set:function(B){B?this.Ff=Fo(this.Ff,2):this.Ff=Io(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,3)},set:function(B){B?this.Ff=Fo(this.Ff,3):this.Ff=Io(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(B){if([0,1,2].indexOf(B)===-1)throw new Error('Invalid value "'+B+'" for attribute Q supplied.');y=B}}),Object.defineProperty(this,"textAlign",{get:function(){var B;switch(y){case 0:default:B="left";break;case 1:B="center";break;case 2:B="right"}return B},configurable:!0,enumerable:!0,set:function(B){switch(B){case"right":case 2:y=2;break;case"center":case 1:y=1;break;case"left":case 0:default:y=0}}})};ii(ca,Ta);var vc=function(){ca.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var n=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return n},set:function(t){n=t}});var e=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return vz(e,this.objId,this.scope)},set:function(t){var r,o;o=[],typeof(r=t)=="string"&&(o=function(s,i,a){a||(a=1);for(var A,d=[];A=i.exec(s);)d.push(A[a]);return d}(r,/\((.*?)\)/g)),e=o}}),this.getOptions=function(){return e},this.setOptions=function(t){e=t,this.sort&&e.sort()},this.addOption=function(t){t=(t=t||"").toString(),e.push(t),this.sort&&e.sort()},this.removeOption=function(t,r){for(r=r||!1,t=(t=t||"").toString();e.indexOf(t)!==-1&&(e.splice(e.indexOf(t),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,18)},set:function(t){t?this.Ff=Fo(this.Ff,18):this.Ff=Io(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,19)},set:function(t){this.combo===!0&&(t?this.Ff=Fo(this.Ff,19):this.Ff=Io(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,20)},set:function(t){t?(this.Ff=Fo(this.Ff,20),e.sort()):this.Ff=Io(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,22)},set:function(t){t?this.Ff=Fo(this.Ff,22):this.Ff=Io(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,23)},set:function(t){t?this.Ff=Fo(this.Ff,23):this.Ff=Io(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,27)},set:function(t){t?this.Ff=Fo(this.Ff,27):this.Ff=Io(this.Ff,27)}}),this.hasAppearanceStream=!1};ii(vc,ca);var mc=function(){vc.call(this),this.fontName="helvetica",this.combo=!1};ii(mc,vc);var wc=function(){mc.call(this),this.combo=!0};ii(wc,mc);var Ap=function(){wc.call(this),this.edit=!0};ii(Ap,wc);var ns=function(){ca.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,15)},set:function(t){t?this.Ff=Fo(this.Ff,15):this.Ff=Io(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,16)},set:function(t){t?this.Ff=Fo(this.Ff,16):this.Ff=Io(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,17)},set:function(t){t?this.Ff=Fo(this.Ff,17):this.Ff=Io(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,26)},set:function(t){t?this.Ff=Fo(this.Ff,26):this.Ff=Io(this.Ff,26)}});var n,e={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var t=function(s){return s};if(this.scope&&(t=this.scope.internal.getEncryptor(this.objId)),Object.keys(e).length!==0){var r,o=[];for(r in o.push("<<"),e)o.push("/"+r+" ("+gd(t(e[r]))+")");return o.push(">>"),o.join(`
`)}},set:function(t){Pn(t)==="object"&&(e=t)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return e.CA||""},set:function(t){typeof t=="string"&&(e.CA=t)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(t){n=t}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(t){n="/"+t}})};ii(ns,ca);var lp=function(){ns.call(this),this.pushButton=!0};ii(lp,ns);var yc=function(){ns.call(this),this.radio=!0,this.pushButton=!1;var n=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e!==void 0?e:[]}})};ii(yc,ns);var Xp=function(){var n,e;ca.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return n},set:function(o){n=o}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return e},set:function(o){e=o}});var t,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var o=function(a){return a};this.scope&&(o=this.scope.internal.getEncryptor(this.objId));var s,i=[];for(s in i.push("<<"),r)i.push("/"+s+" ("+gd(o(r[s]))+")");return i.push(">>"),i.join(`
`)},set:function(o){Pn(o)==="object"&&(r=o)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(o){typeof o=="string"&&(r.CA=o)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return t},set:function(o){t=o}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return t.substr(1,t.length-1)},set:function(o){t="/"+o}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=hr.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ii(Xp,ca),yc.prototype.setAppearance=function(n){if(!("createAppearanceStream"in n)||!("getCA"in n))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var e in this.Kids)if(this.Kids.hasOwnProperty(e)){var t=this.Kids[e];t.appearanceStreamContent=n.createAppearanceStream(t.optionName),t.caption=n.getCA()}},yc.prototype.createOption=function(n){var e=new Xp;return e.Parent=this,e.optionName=n,this.Kids.push(e),fN.call(this.scope,e),e};var dp=function(){ns.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=hr.CheckBox.createAppearanceStream()};ii(dp,ns);var Zl=function(){ca.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,13)},set:function(e){e?this.Ff=Fo(this.Ff,13):this.Ff=Io(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,21)},set:function(e){e?this.Ff=Fo(this.Ff,21):this.Ff=Io(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,23)},set:function(e){e?this.Ff=Fo(this.Ff,23):this.Ff=Io(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,24)},set:function(e){e?this.Ff=Fo(this.Ff,24):this.Ff=Io(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,25)},set:function(e){e?this.Ff=Fo(this.Ff,25):this.Ff=Io(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,26)},set:function(e){e?this.Ff=Fo(this.Ff,26):this.Ff=Io(this.Ff,26)}});var n=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return n},set:function(e){n=e}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return n},set:function(e){Number.isInteger(e)&&(n=e)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ii(Zl,ca);var cp=function(){Zl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Eo(this.Ff,14)},set:function(n){n?this.Ff=Fo(this.Ff,14):this.Ff=Io(this.Ff,14)}}),this.password=!0};ii(cp,Zl);var hr={CheckBox:{createAppearanceStream:function(){return{N:{On:hr.CheckBox.YesNormal},D:{On:hr.CheckBox.YesPushDown,Off:hr.CheckBox.OffPushDown}}},YesPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=[],r=n.scope.internal.getFont(n.fontName,n.fontStyle).id,o=n.scope.__private__.encodeColorString(n.color),s=Tm(n,n.caption);return t.push("0.749023 g"),t.push("0 0 "+Mr(hr.internal.getWidth(n))+" "+Mr(hr.internal.getHeight(n))+" re"),t.push("f"),t.push("BMC"),t.push("q"),t.push("0 0 1 rg"),t.push("/"+r+" "+Mr(s.fontSize)+" Tf "+o),t.push("BT"),t.push(s.text),t.push("ET"),t.push("Q"),t.push("EMC"),e.stream=t.join(`
`),e},YesNormal:function(n){var e=Fa(n);e.scope=n.scope;var t=n.scope.internal.getFont(n.fontName,n.fontStyle).id,r=n.scope.__private__.encodeColorString(n.color),o=[],s=hr.internal.getHeight(n),i=hr.internal.getWidth(n),a=Tm(n,n.caption);return o.push("1 g"),o.push("0 0 "+Mr(i)+" "+Mr(s)+" re"),o.push("f"),o.push("q"),o.push("0 0 1 rg"),o.push("0 0 "+Mr(i-1)+" "+Mr(s-1)+" re"),o.push("W"),o.push("n"),o.push("0 g"),o.push("BT"),o.push("/"+t+" "+Mr(a.fontSize)+" Tf "+r),o.push(a.text),o.push("ET"),o.push("Q"),e.stream=o.join(`
`),e},OffPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Mr(hr.internal.getWidth(n))+" "+Mr(hr.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}},RadioButton:{Circle:{createAppearanceStream:function(n){var e={D:{Off:hr.RadioButton.Circle.OffPushDown},N:{}};return e.N[n]=hr.RadioButton.Circle.YesNormal,e.D[n]=hr.RadioButton.Circle.YesPushDown,e},getCA:function(){return"l"},YesNormal:function(n){var e=Fa(n);e.scope=n.scope;var t=[],r=hr.internal.getWidth(n)<=hr.internal.getHeight(n)?hr.internal.getWidth(n)/4:hr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=hr.internal.Bezier_C,s=Number((r*o).toFixed(5));return t.push("q"),t.push("1 0 0 1 "+GA(hr.internal.getWidth(n)/2)+" "+GA(hr.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+s+" "+s+" "+r+" 0 "+r+" c"),t.push("-"+s+" "+r+" -"+r+" "+s+" -"+r+" 0 c"),t.push("-"+r+" -"+s+" -"+s+" -"+r+" 0 -"+r+" c"),t.push(s+" -"+r+" "+r+" -"+s+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=[],r=hr.internal.getWidth(n)<=hr.internal.getHeight(n)?hr.internal.getWidth(n)/4:hr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*hr.internal.Bezier_C).toFixed(5)),i=Number((r*hr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+GA(hr.internal.getWidth(n)/2)+" "+GA(hr.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),t.push("0 g"),t.push("q"),t.push("1 0 0 1 "+GA(hr.internal.getWidth(n)/2)+" "+GA(hr.internal.getHeight(n)/2)+" cm"),t.push(r+" 0 m"),t.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),t.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),t.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),t.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e},OffPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=[],r=hr.internal.getWidth(n)<=hr.internal.getHeight(n)?hr.internal.getWidth(n)/4:hr.internal.getHeight(n)/4;r=Number((.9*r).toFixed(5));var o=Number((2*r).toFixed(5)),s=Number((o*hr.internal.Bezier_C).toFixed(5));return t.push("0.749023 g"),t.push("q"),t.push("1 0 0 1 "+GA(hr.internal.getWidth(n)/2)+" "+GA(hr.internal.getHeight(n)/2)+" cm"),t.push(o+" 0 m"),t.push(o+" "+s+" "+s+" "+o+" 0 "+o+" c"),t.push("-"+s+" "+o+" -"+o+" "+s+" -"+o+" 0 c"),t.push("-"+o+" -"+s+" -"+s+" -"+o+" 0 -"+o+" c"),t.push(s+" -"+o+" "+o+" -"+s+" "+o+" 0 c"),t.push("f"),t.push("Q"),e.stream=t.join(`
`),e}},Cross:{createAppearanceStream:function(n){var e={D:{Off:hr.RadioButton.Cross.OffPushDown},N:{}};return e.N[n]=hr.RadioButton.Cross.YesNormal,e.D[n]=hr.RadioButton.Cross.YesPushDown,e},getCA:function(){return"8"},YesNormal:function(n){var e=Fa(n);e.scope=n.scope;var t=[],r=hr.internal.calculateCross(n);return t.push("q"),t.push("1 1 "+Mr(hr.internal.getWidth(n)-2)+" "+Mr(hr.internal.getHeight(n)-2)+" re"),t.push("W"),t.push("n"),t.push(Mr(r.x1.x)+" "+Mr(r.x1.y)+" m"),t.push(Mr(r.x2.x)+" "+Mr(r.x2.y)+" l"),t.push(Mr(r.x4.x)+" "+Mr(r.x4.y)+" m"),t.push(Mr(r.x3.x)+" "+Mr(r.x3.y)+" l"),t.push("s"),t.push("Q"),e.stream=t.join(`
`),e},YesPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=hr.internal.calculateCross(n),r=[];return r.push("0.749023 g"),r.push("0 0 "+Mr(hr.internal.getWidth(n))+" "+Mr(hr.internal.getHeight(n))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+Mr(hr.internal.getWidth(n)-2)+" "+Mr(hr.internal.getHeight(n)-2)+" re"),r.push("W"),r.push("n"),r.push(Mr(t.x1.x)+" "+Mr(t.x1.y)+" m"),r.push(Mr(t.x2.x)+" "+Mr(t.x2.y)+" l"),r.push(Mr(t.x4.x)+" "+Mr(t.x4.y)+" m"),r.push(Mr(t.x3.x)+" "+Mr(t.x3.y)+" l"),r.push("s"),r.push("Q"),e.stream=r.join(`
`),e},OffPushDown:function(n){var e=Fa(n);e.scope=n.scope;var t=[];return t.push("0.749023 g"),t.push("0 0 "+Mr(hr.internal.getWidth(n))+" "+Mr(hr.internal.getHeight(n))+" re"),t.push("f"),e.stream=t.join(`
`),e}}},createDefaultAppearanceStream:function(n){var e=n.scope.internal.getFont(n.fontName,n.fontStyle).id,t=n.scope.__private__.encodeColorString(n.color);return"/"+e+" "+n.fontSize+" Tf "+t}};hr.internal={Bezier_C:.551915024494,calculateCross:function(n){var e=hr.internal.getWidth(n),t=hr.internal.getHeight(n),r=Math.min(e,t);return{x1:{x:(e-r)/2,y:(t-r)/2+r},x2:{x:(e-r)/2+r,y:(t-r)/2},x3:{x:(e-r)/2,y:(t-r)/2},x4:{x:(e-r)/2+r,y:(t-r)/2+r}}}},hr.internal.getWidth=function(n){var e=0;return Pn(n)==="object"&&(e=v_(n.Rect[2])),e},hr.internal.getHeight=function(n){var e=0;return Pn(n)==="object"&&(e=v_(n.Rect[3])),e};var fN=go.addField=function(n){if(hN(this,n),!(n instanceof ca))throw new Error("Invalid argument passed to jsPDF.addField.");var e;return(e=n).scope.internal.acroformPlugin.printedOut&&(e.scope.internal.acroformPlugin.printedOut=!1,e.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),e.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(e),n.page=n.scope.internal.getCurrentPageInfo().pageNumber,this};go.AcroFormChoiceField=vc,go.AcroFormListBox=mc,go.AcroFormComboBox=wc,go.AcroFormEditBox=Ap,go.AcroFormButton=ns,go.AcroFormPushButton=lp,go.AcroFormRadioButton=yc,go.AcroFormCheckBox=dp,go.AcroFormTextField=Zl,go.AcroFormPasswordField=cp,go.AcroFormAppearance=hr,go.AcroForm={ChoiceField:vc,ListBox:mc,ComboBox:wc,EditBox:Ap,Button:ns,PushButton:lp,RadioButton:yc,CheckBox:dp,TextField:Zl,PasswordField:cp,Appearance:hr},zr.AcroForm={ChoiceField:vc,ListBox:mc,ComboBox:wc,EditBox:Ap,Button:ns,PushButton:lp,RadioButton:yc,CheckBox:dp,TextField:Zl,PasswordField:cp,Appearance:hr};zr.AcroForm;function yz(n){return n.reduce(function(e,t,r){return e[t]=r,e},{})}(function(n){n.__addimage__={};var e="UNKNOWN",t={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},r=n.__addimage__.getImageFileTypeByImageData=function(L,R){var J,se,fe,ie,pe,te=e;if((R=R||e)==="RGBA"||L.data!==void 0&&L.data instanceof Uint8ClampedArray&&"height"in L&&"width"in L)return"RGBA";if(Z(L))for(pe in t)for(fe=t[pe],J=0;J<fe.length;J+=1){for(ie=!0,se=0;se<fe[J].length;se+=1)if(fe[J][se]!==void 0&&fe[J][se]!==L[se]){ie=!1;break}if(ie===!0){te=pe;break}}else for(pe in t)for(fe=t[pe],J=0;J<fe.length;J+=1){for(ie=!0,se=0;se<fe[J].length;se+=1)if(fe[J][se]!==void 0&&fe[J][se]!==L.charCodeAt(se)){ie=!1;break}if(ie===!0){te=pe;break}}return te===e&&R!==e&&(te=R),te},o=function L(R){for(var J=this.internal.write,se=this.internal.putStream,fe=(0,this.internal.getFilters)();fe.indexOf("FlateEncode")!==-1;)fe.splice(fe.indexOf("FlateEncode"),1);R.objectId=this.internal.newObject();var ie=[];if(ie.push({key:"Type",value:"/XObject"}),ie.push({key:"Subtype",value:"/Image"}),ie.push({key:"Width",value:R.width}),ie.push({key:"Height",value:R.height}),R.colorSpace===y.INDEXED?ie.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(R.palette.length/3-1)+" "+("sMask"in R&&R.sMask!==void 0?R.objectId+2:R.objectId+1)+" 0 R]"}):(ie.push({key:"ColorSpace",value:"/"+R.colorSpace}),R.colorSpace===y.DEVICE_CMYK&&ie.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),ie.push({key:"BitsPerComponent",value:R.bitsPerComponent}),"decodeParameters"in R&&R.decodeParameters!==void 0&&ie.push({key:"DecodeParms",value:"<<"+R.decodeParameters+">>"}),"transparency"in R&&Array.isArray(R.transparency)){for(var pe="",te=0,Ce=R.transparency.length;te<Ce;te++)pe+=R.transparency[te]+" "+R.transparency[te]+" ";ie.push({key:"Mask",value:"["+pe+"]"})}R.sMask!==void 0&&ie.push({key:"SMask",value:R.objectId+1+" 0 R"});var ne=R.filter!==void 0?["/"+R.filter]:void 0;if(se({data:R.data,additionalKeyValues:ie,alreadyAppliedFilters:ne,objectId:R.objectId}),J("endobj"),"sMask"in R&&R.sMask!==void 0){var ze="/Predictor "+R.predictor+" /Colors 1 /BitsPerComponent "+R.bitsPerComponent+" /Columns "+R.width,z={width:R.width,height:R.height,colorSpace:"DeviceGray",bitsPerComponent:R.bitsPerComponent,decodeParameters:ze,data:R.sMask};"filter"in R&&(z.filter=R.filter),L.call(this,z)}if(R.colorSpace===y.INDEXED){var E=this.internal.newObject();se({data:N(new Uint8Array(R.palette)),objectId:E}),J("endobj")}},s=function(){var L=this.internal.collections.addImage_images;for(var R in L)o.call(this,L[R])},i=function(){var L,R=this.internal.collections.addImage_images,J=this.internal.write;for(var se in R)J("/I"+(L=R[se]).index,L.objectId,"0","R")},a=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",i))},A=function(){var L=this.internal.collections.addImage_images;return a.call(this),L},d=function(){return Object.keys(this.internal.collections.addImage_images).length},c=function(L){return typeof n["process"+L.toUpperCase()]=="function"},u=function(L){return Pn(L)==="object"&&L.nodeType===1},h=function(L,R){if(L.nodeName==="IMG"&&L.hasAttribute("src")){var J=""+L.getAttribute("src");if(J.indexOf("data:image/")===0)return Ou(unescape(J).split("base64,").pop());var se=n.loadFile(J,!0);if(se!==void 0)return se}if(L.nodeName==="CANVAS"){if(L.width===0||L.height===0)throw new Error("Given canvas must have data. Canvas width: "+L.width+", height: "+L.height);var fe;switch(R){case"PNG":fe="image/png";break;case"WEBP":fe="image/webp";break;case"JPEG":case"JPG":default:fe="image/jpeg"}return Ou(L.toDataURL(fe,1).split("base64,").pop())}},p=function(L){var R=this.internal.collections.addImage_images;if(R){for(var J in R)if(L===R[J].alias)return R[J]}},v=function(L,R,J){return L||R||(L=-96,R=-96),L<0&&(L=-1*J.width*72/L/this.internal.scaleFactor),R<0&&(R=-1*J.height*72/R/this.internal.scaleFactor),L===0&&(L=R*J.width/J.height),R===0&&(R=L*J.height/J.width),[L,R]},w=function(L,R,J,se,fe,ie){var pe=v.call(this,J,se,fe),te=this.internal.getCoordinateString,Ce=this.internal.getVerticalCoordinateString,ne=A.call(this);if(J=pe[0],se=pe[1],ne[fe.index]=fe,ie){ie*=Math.PI/180;var ze=Math.cos(ie),z=Math.sin(ie),E=function(I){return I.toFixed(4)},F=[E(ze),E(z),E(-1*z),E(ze),0,0,"cm"]}this.internal.write("q"),ie?(this.internal.write([1,"0","0",1,te(L),Ce(R+se),"cm"].join(" ")),this.internal.write(F.join(" ")),this.internal.write([te(J),"0","0",te(se),"0","0","cm"].join(" "))):this.internal.write([te(J),"0","0",te(se),te(L),Ce(R+se),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+fe.index+" Do"),this.internal.write("Q")},y=n.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};n.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var B=n.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},C=n.__addimage__.sHashCode=function(L){var R,J,se=0;if(typeof L=="string")for(J=L.length,R=0;R<J;R++)se=(se<<5)-se+L.charCodeAt(R),se|=0;else if(Z(L))for(J=L.byteLength/2,R=0;R<J;R++)se=(se<<5)-se+L[R],se|=0;return se},Q=n.__addimage__.validateStringAsBase64=function(L){(L=L||"").toString().trim();var R=!0;return L.length===0&&(R=!1),L.length%4!=0&&(R=!1),/^[A-Za-z0-9+/]+$/.test(L.substr(0,L.length-2))===!1&&(R=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(L.substr(-2))===!1&&(R=!1),R},k=n.__addimage__.extractImageFromDataUrl=function(L){var R=(L=L||"").split("base64,"),J=null;if(R.length===2){var se=/^data:(\w*\/\w*);*(charset=(?!charset=)[\w=-]*)*;*$/.exec(R[0]);Array.isArray(se)&&(J={mimeType:se[1],charset:se[2],data:R[1]})}return J},H=n.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};n.__addimage__.isArrayBuffer=function(L){return H()&&L instanceof ArrayBuffer};var Z=n.__addimage__.isArrayBufferView=function(L){return H()&&typeof Uint32Array<"u"&&(L instanceof Int8Array||L instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&L instanceof Uint8ClampedArray||L instanceof Int16Array||L instanceof Uint16Array||L instanceof Int32Array||L instanceof Uint32Array||L instanceof Float32Array||L instanceof Float64Array)},q=n.__addimage__.binaryStringToUint8Array=function(L){for(var R=L.length,J=new Uint8Array(R),se=0;se<R;se++)J[se]=L.charCodeAt(se);return J},N=n.__addimage__.arrayBufferToBinaryString=function(L){for(var R="",J=Z(L)?L:new Uint8Array(L),se=0;se<J.length;se+=8192)R+=String.fromCharCode.apply(null,J.subarray(se,se+8192));return R};n.addImage=function(){var L,R,J,se,fe,ie,pe,te,Ce;if(typeof arguments[1]=="number"?(R=e,J=arguments[1],se=arguments[2],fe=arguments[3],ie=arguments[4],pe=arguments[5],te=arguments[6],Ce=arguments[7]):(R=arguments[1],J=arguments[2],se=arguments[3],fe=arguments[4],ie=arguments[5],pe=arguments[6],te=arguments[7],Ce=arguments[8]),Pn(L=arguments[0])==="object"&&!u(L)&&"imageData"in L){var ne=L;L=ne.imageData,R=ne.format||R||e,J=ne.x||J||0,se=ne.y||se||0,fe=ne.w||ne.width||fe,ie=ne.h||ne.height||ie,pe=ne.alias||pe,te=ne.compression||te,Ce=ne.rotation||ne.angle||Ce}var ze=this.internal.getFilters();if(te===void 0&&ze.indexOf("FlateEncode")!==-1&&(te="SLOW"),isNaN(J)||isNaN(se))throw new Error("Invalid coordinates passed to jsPDF.addImage");a.call(this);var z=re.call(this,L,R,pe,te);return w.call(this,J,se,fe,ie,z,Ce),this};var re=function(L,R,J,se){var fe,ie,pe;if(typeof L=="string"&&r(L)===e){L=unescape(L);var te=be(L,!1);(te!==""||(te=n.loadFile(L,!0))!==void 0)&&(L=te)}if(u(L)&&(L=h(L,R)),R=r(L,R),!c(R))throw new Error("addImage does not support files of type '"+R+"', please ensure that a plugin for '"+R+"' support is added.");if(((pe=J)==null||pe.length===0)&&(J=function(Ce){return typeof Ce=="string"||Z(Ce)?C(Ce):Z(Ce.data)?C(Ce.data):null}(L)),(fe=p.call(this,J))||(H()&&(L instanceof Uint8Array||R==="RGBA"||(ie=L,L=q(L))),fe=this["process"+R.toUpperCase()](L,d.call(this),J,function(Ce){return Ce&&typeof Ce=="string"&&(Ce=Ce.toUpperCase()),Ce in n.image_compression?Ce:B.NONE}(se),ie)),!fe)throw new Error("An unknown error occurred whilst processing the image.");return fe},be=n.__addimage__.convertBase64ToBinaryString=function(L,R){var J;R=typeof R!="boolean"||R;var se,fe="";if(typeof L=="string"){se=(J=k(L))!==null?J.data:L;try{fe=Ou(se)}catch(ie){if(R)throw Q(se)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+ie.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return fe};n.getImageProperties=function(L){var R,J,se="";if(u(L)&&(L=h(L)),typeof L=="string"&&r(L)===e&&((se=be(L,!1))===""&&(se=n.loadFile(L)||""),L=se),J=r(L),!c(J))throw new Error("addImage does not support files of type '"+J+"', please ensure that a plugin for '"+J+"' support is added.");if(!H()||L instanceof Uint8Array||(L=q(L)),!(R=this["process"+J.toUpperCase()](L)))throw new Error("An unknown error occurred whilst processing the image");return R.fileType=J,R}})(zr.API),function(n){var e=function(t){if(t!==void 0&&t!="")return!0};zr.API.events.push(["addPage",function(t){this.internal.getPageInfo(t.pageNumber).pageContext.annotations=[]}]),n.events.push(["putPage",function(t){for(var r,o,s,i=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,A=this.internal.getPageInfoByObjId(t.objId),d=t.pageContext.annotations,c=!1,u=0;u<d.length&&!c;u++)switch((r=d[u]).type){case"link":(e(r.options.url)||e(r.options.pageNumber))&&(c=!0);break;case"reference":case"text":case"freetext":c=!0}if(c!=0){this.internal.write("/Annots [");for(var h=0;h<d.length;h++){r=d[h];var p=this.internal.pdfEscape,v=this.internal.getEncryptor(t.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var w=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),B=this.internal.getEncryptor(w.objId),C=r.title||"Note";s="<</Type /Annot /Subtype /Text "+(o="/Rect ["+i(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+i(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+p(B(r.contents))+")",s+=" /Popup "+y.objId+" 0 R",s+=" /P "+A.objId+" 0 R",s+=" /T ("+p(B(C))+") >>",w.content=s;var Q=w.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(o="/Rect ["+i(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+i(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+Q,r.open&&(s+=" /Open true"),s+=" >>",y.content=s,this.internal.write(w.objId,"0 R",y.objId,"0 R");break;case"freetext":o="/Rect ["+i(r.bounds.x)+" "+a(r.bounds.y)+" "+i(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var k=r.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+o+"/Contents ("+p(v(r.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(r.options.name){var H=this.annotations._nameMap[r.options.name];r.options.pageNumber=H.page,r.options.top=H.y}else r.options.top||(r.options.top=0);if(o="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",s="",r.options.url)s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /A <</S /URI /URI ("+p(v(r.options.url))+") >>";else if(r.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+o+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,s+=" /FitV "+r.options.left+"]";break;case"XYZ":default:var Z=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),s+=" /XYZ "+r.options.left+" "+Z+" "+r.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),n.createAnnotation=function(t){var r=this.internal.getCurrentPageInfo();switch(t.type){case"link":this.link(t.bounds.x,t.bounds.y,t.bounds.w,t.bounds.h,t);break;case"text":case"freetext":r.pageContext.annotations.push(t)}},n.link=function(t,r,o,s,i){var a=this.internal.getCurrentPageInfo(),A=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:A(t),y:d(r),w:A(t+o),h:d(r+s)},options:i,type:"link"})},n.textWithLink=function(t,r,o,s){var i,a,A=this.getTextWidth(t),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){a=s.maxWidth;var c=this.splitTextToSize(t,a).length;i=Math.ceil(d*c)}else a=A,i=d;return this.text(t,r,o,s),o+=.2*d,s.align==="center"&&(r-=A/2),s.align==="right"&&(r-=A),this.link(r,o-d,a,i,s),A},n.getTextWidth=function(t){var r=this.internal.getFontSize();return this.getStringUnitWidth(t)*r/this.internal.scaleFactor}}(zr.API),function(n){var e={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},t={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},o=[1570,1571,1573,1575];n.__arabicParser__={};var s=n.__arabicParser__.isInArabicSubstitutionA=function(w){return e[w.charCodeAt(0)]!==void 0},i=n.__arabicParser__.isArabicLetter=function(w){return typeof w=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(w)},a=n.__arabicParser__.isArabicEndLetter=function(w){return i(w)&&s(w)&&e[w.charCodeAt(0)].length<=2},A=n.__arabicParser__.isArabicAlfLetter=function(w){return i(w)&&o.indexOf(w.charCodeAt(0))>=0};n.__arabicParser__.arabicLetterHasIsolatedForm=function(w){return i(w)&&s(w)&&e[w.charCodeAt(0)].length>=1};var d=n.__arabicParser__.arabicLetterHasFinalForm=function(w){return i(w)&&s(w)&&e[w.charCodeAt(0)].length>=2};n.__arabicParser__.arabicLetterHasInitialForm=function(w){return i(w)&&s(w)&&e[w.charCodeAt(0)].length>=3};var c=n.__arabicParser__.arabicLetterHasMedialForm=function(w){return i(w)&&s(w)&&e[w.charCodeAt(0)].length==4},u=n.__arabicParser__.resolveLigatures=function(w){var y=0,B=t,C="",Q=0;for(y=0;y<w.length;y+=1)B[w.charCodeAt(y)]!==void 0?(Q++,typeof(B=B[w.charCodeAt(y)])=="number"&&(C+=String.fromCharCode(B),B=t,Q=0),y===w.length-1&&(B=t,C+=w.charAt(y-(Q-1)),y-=Q-1,Q=0)):(B=t,C+=w.charAt(y-Q),y-=Q,Q=0);return C};n.__arabicParser__.isArabicDiacritic=function(w){return w!==void 0&&r[w.charCodeAt(0)]!==void 0};var h=n.__arabicParser__.getCorrectForm=function(w,y,B){return i(w)?s(w)===!1?-1:!d(w)||!i(y)&&!i(B)||!i(B)&&a(y)||a(w)&&!i(y)||a(w)&&A(y)||a(w)&&a(y)?0:c(w)&&i(y)&&!a(y)&&i(B)&&d(B)?3:a(w)||!i(B)?1:2:-1},p=function(w){var y=0,B=0,C=0,Q="",k="",H="",Z=(w=w||"").split("\\s+"),q=[];for(y=0;y<Z.length;y+=1){for(q.push(""),B=0;B<Z[y].length;B+=1)Q=Z[y][B],k=Z[y][B-1],H=Z[y][B+1],i(Q)?(C=h(Q,k,H),q[y]+=C!==-1?String.fromCharCode(e[Q.charCodeAt(0)][C]):Q):q[y]+=Q;q[y]=u(q[y])}return q.join(" ")},v=n.__arabicParser__.processArabic=n.processArabic=function(){var w,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,B=[];if(Array.isArray(y)){var C=0;for(B=[],C=0;C<y.length;C+=1)Array.isArray(y[C])?B.push([p(y[C][0]),y[C][1],y[C][2]]):B.push([p(y[C])]);w=B}else w=p(y);return typeof arguments[0]=="string"?w:(arguments[0].text=w,arguments[0])};n.events.push(["preProcessText",v])}(zr.API),zr.API.autoPrint=function(n){var e;switch((n=n||{}).variant=n.variant||"non-conform",n.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){e=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+e+" 0 R")})}return this},function(n){var e=function(){var t=void 0;Object.defineProperty(this,"pdf",{get:function(){return t},set:function(a){t=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var o=300;Object.defineProperty(this,"height",{get:function(){return o},set:function(a){o=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=o+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(a){s=a}});var i={};Object.defineProperty(this,"style",{get:function(){return i},set:function(a){i=a}}),Object.defineProperty(this,"parentNode",{})};e.prototype.getContext=function(t,r){var o;if((t=t||"2d")!=="2d")return null;for(o in r)this.pdf.context2d.hasOwnProperty(o)&&(this.pdf.context2d[o]=r[o]);return this.pdf.context2d._canvas=this,this.pdf.context2d},e.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},n.events.push(["initialized",function(){this.canvas=new e,this.canvas.pdf=this}])}(zr.API),function(n){var e={left:0,top:0,bottom:0,right:0},t=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},e),this.internal.__cell__.margins.width=this.getPageWidth(),o.call(this))},o=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var A=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return A},set:function(w){A=w}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(w){d=w}});var c=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return c},set:function(w){c=w}});var u=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return u},set:function(w){u=w}});var h=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return h},set:function(w){h=w}});var p=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return p},set:function(w){p=w}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(w){v=w}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},n.setHeaderFunction=function(A){return r.call(this),this.internal.__cell__.headerFunction=typeof A=="function"?A:void 0,this},n.getTextDimensions=function(A,d){r.call(this);var c=(d=d||{}).fontSize||this.getFontSize(),u=d.font||this.getFont(),h=d.scaleFactor||this.internal.scaleFactor,p=0,v=0,w=0,y=this;if(!Array.isArray(A)&&typeof A!="string"){if(typeof A!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");A=String(A)}var B=d.maxWidth;B>0?typeof A=="string"?A=this.splitTextToSize(A,B):Object.prototype.toString.call(A)==="[object Array]"&&(A=A.reduce(function(Q,k){return Q.concat(y.splitTextToSize(k,B))},[])):A=Array.isArray(A)?A:[A];for(var C=0;C<A.length;C++)p<(w=this.getStringUnitWidth(A[C],{font:u})*c)&&(p=w);return p!==0&&(v=A.length),{w:p/=h,h:Math.max((v*c*this.getLineHeightFactor()-c*(this.getLineHeightFactor()-1))/h,0)}},n.cellAddPage=function(){r.call(this),this.addPage();var A=this.internal.__cell__.margins||e;return this.internal.__cell__.lastCell=new s(A.left,A.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var i=n.cell=function(){var A;A=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,c=this.internal.__cell__.padding,u=this.internal.__cell__.margins||e,h=this.internal.__cell__.tableHeaderRow,p=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===A.lineNumber?(A.x=(d.x||0)+(d.width||0),A.y=d.y||0):d.y+d.height+A.height+u.bottom>this.getPageHeight()?(this.cellAddPage(),A.y=u.top,p&&h&&(this.printHeaderRow(A.lineNumber,!0),A.y+=h[0].height)):A.y=d.y+d.height||A.y),A.text[0]!==void 0&&(this.rect(A.x,A.y,A.width,A.height,t===!0?"FD":void 0),A.align==="right"?this.text(A.text,A.x+A.width-c,A.y+c,{align:"right",baseline:"top"}):A.align==="center"?this.text(A.text,A.x+A.width/2,A.y+c,{align:"center",baseline:"top",maxWidth:A.width-c-c}):this.text(A.text,A.x+c,A.y+c,{align:"left",baseline:"top",maxWidth:A.width-c-c})),this.internal.__cell__.lastCell=A,this};n.table=function(A,d,c,u,h){if(r.call(this),!c)throw new Error("No data for PDF table.");var p,v,w,y,B=[],C=[],Q=[],k={},H={},Z=[],q=[],N=(h=h||{}).autoSize||!1,re=h.printHeaders!==!1,be=h.css&&h.css["font-size"]!==void 0?16*h.css["font-size"]:h.fontSize||12,L=h.margins||Object.assign({width:this.getPageWidth()},e),R=typeof h.padding=="number"?h.padding:3,J=h.headerBackgroundColor||"#c8c8c8",se=h.headerTextColor||"#000";if(o.call(this),this.internal.__cell__.printHeaders=re,this.internal.__cell__.margins=L,this.internal.__cell__.table_font_size=be,this.internal.__cell__.padding=R,this.internal.__cell__.headerBackgroundColor=J,this.internal.__cell__.headerTextColor=se,this.setFontSize(be),u==null)C=B=Object.keys(c[0]),Q=B.map(function(){return"left"});else if(Array.isArray(u)&&Pn(u[0])==="object")for(B=u.map(function(ne){return ne.name}),C=u.map(function(ne){return ne.prompt||ne.name||""}),Q=u.map(function(ne){return ne.align||"left"}),p=0;p<u.length;p+=1)H[u[p].name]=u[p].width*(19.049976/25.4);else Array.isArray(u)&&typeof u[0]=="string"&&(C=B=u,Q=B.map(function(){return"left"}));if(N||Array.isArray(u)&&typeof u[0]=="string")for(p=0;p<B.length;p+=1){for(k[y=B[p]]=c.map(function(ne){return ne[y]}),this.setFont(void 0,"bold"),Z.push(this.getTextDimensions(C[p],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=k[y],this.setFont(void 0,"normal"),w=0;w<v.length;w+=1)Z.push(this.getTextDimensions(v[w],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);H[y]=Math.max.apply(null,Z)+R+R,Z=[]}if(re){var fe={};for(p=0;p<B.length;p+=1)fe[B[p]]={},fe[B[p]].text=C[p],fe[B[p]].align=Q[p];var ie=a.call(this,fe,H);q=B.map(function(ne){return new s(A,d,H[ne],ie,fe[ne].text,void 0,fe[ne].align)}),this.setTableHeaderRow(q),this.printHeaderRow(1,!1)}var pe=u.reduce(function(ne,ze){return ne[ze.name]=ze.align,ne},{});for(p=0;p<c.length;p+=1){"rowStart"in h&&h.rowStart instanceof Function&&h.rowStart({row:p,data:c[p]},this);var te=a.call(this,c[p],H);for(w=0;w<B.length;w+=1){var Ce=c[p][B[w]];"cellStart"in h&&h.cellStart instanceof Function&&h.cellStart({row:p,col:w,data:Ce},this),i.call(this,new s(A,d,H[B[w]],te,Ce,p+2,pe[B[w]]))}}return this.internal.__cell__.table_x=A,this.internal.__cell__.table_y=d,this};var a=function(A,d){var c=this.internal.__cell__.padding,u=this.internal.__cell__.table_font_size,h=this.internal.scaleFactor;return Object.keys(A).map(function(p){var v=A[p];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,d[p]-c-c)},this).map(function(p){return this.getLineHeightFactor()*p.length*u/h+c+c},this).reduce(function(p,v){return Math.max(p,v)},0)};n.setTableHeaderRow=function(A){r.call(this),this.internal.__cell__.tableHeaderRow=A},n.printHeaderRow=function(A,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var c;if(t=!0,typeof this.internal.__cell__.headerFunction=="function"){var u=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(u[0],u[1],u[2],u[3],void 0,-1)}this.setFont(void 0,"bold");for(var h=[],p=0;p<this.internal.__cell__.tableHeaderRow.length;p+=1){c=this.internal.__cell__.tableHeaderRow[p].clone(),d&&(c.y=this.internal.__cell__.margins.top||0,h.push(c)),c.lineNumber=A;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),i.call(this,c),this.setTextColor(v)}h.length>0&&this.setTableHeaderRow(h),this.setFont(void 0,"normal"),t=!1}}(zr.API);var _z={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},bz=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Lm=yz(bz),xz=[100,200,300,400,500,600,700,800,900],pN=yz(xz);function Pm(n){var e=n.family.replace(/"|'/g,"").toLowerCase(),t=function(s){return _z[s=s||"normal"]?s:"normal"}(n.style),r=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(n.weight),o=function(s){return typeof Lm[s=s||"normal"]=="number"?s:"normal"}(n.stretch);return{family:e,style:t,weight:r,stretch:o,src:n.src||[],ref:n.ref||{name:e,style:[o,t,r].join(" ")}}}function m_(n,e,t,r){var o;for(o=t;o>=0&&o<e.length;o+=r)if(n[e[o]])return n[e[o]];for(o=t;o>=0&&o<e.length;o-=r)if(n[e[o]])return n[e[o]]}var gN={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},w_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function y_(n){return[n.stretch,n.style,n.weight,n.family].join(" ")}function vN(n,e,t){for(var r=(t=t||{}).defaultFontFamily||"times",o=Object.assign({},gN,t.genericFontFamilies||{}),s=null,i=null,a=0;a<e.length;++a)if(o[(s=Pm(e[a])).family]&&(s.family=o[s.family]),n.hasOwnProperty(s.family)){i=n[s.family];break}if(!(i=i||n[r]))throw new Error("Could not find a font-family for the rule '"+y_(s)+"' and default family '"+r+"'.");if(i=function(A,d){if(d[A])return d[A];var c=Lm[A],u=c<=Lm.normal?-1:1,h=m_(d,bz,c,u);if(!h)throw new Error("Could not find a matching font-stretch value for "+A);return h}(s.stretch,i),i=function(A,d){if(d[A])return d[A];for(var c=_z[A],u=0;u<c.length;++u)if(d[c[u]])return d[c[u]];throw new Error("Could not find a matching font-style for "+A)}(s.style,i),!(i=function(A,d){if(d[A])return d[A];if(A===400&&d[500])return d[500];if(A===500&&d[400])return d[400];var c=pN[A],u=m_(d,xz,c,A<400?-1:1);if(!u)throw new Error("Could not find a matching font-weight for value "+A);return u}(s.weight,i)))throw new Error("Failed to resolve a font for the rule '"+y_(s)+"'.");return i}function __(n){return n.trimLeft()}function mN(n,e){for(var t=0;t<n.length;){if(n.charAt(t)===e)return[n.substring(0,t),n.substring(t+1)];t+=1}return null}function wN(n){var e=n.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return e===null?null:[e[0],n.substring(e[0].length)]}var $f,b_,x_,A0=["times"];(function(n){var e,t,r,o,s,i,a,A,d,c=function(z){return z=z||{},this.isStrokeTransparent=z.isStrokeTransparent||!1,this.strokeOpacity=z.strokeOpacity||1,this.strokeStyle=z.strokeStyle||"#000000",this.fillStyle=z.fillStyle||"#000000",this.isFillTransparent=z.isFillTransparent||!1,this.fillOpacity=z.fillOpacity||1,this.font=z.font||"10px sans-serif",this.textBaseline=z.textBaseline||"alphabetic",this.textAlign=z.textAlign||"left",this.lineWidth=z.lineWidth||1,this.lineJoin=z.lineJoin||"miter",this.lineCap=z.lineCap||"butt",this.path=z.path||[],this.transform=z.transform!==void 0?z.transform.clone():new A,this.globalCompositeOperation=z.globalCompositeOperation||"normal",this.globalAlpha=z.globalAlpha||1,this.clip_path=z.clip_path||[],this.currentPoint=z.currentPoint||new i,this.miterLimit=z.miterLimit||10,this.lastPoint=z.lastPoint||new i,this.lineDashOffset=z.lineDashOffset||0,this.lineDash=z.lineDash||[],this.margin=z.margin||[0,0,0,0],this.prevPageLastElemOffset=z.prevPageLastElemOffset||0,this.ignoreClearRect=typeof z.ignoreClearRect!="boolean"||z.ignoreClearRect,this};n.events.push(["initialized",function(){this.context2d=new u(this),e=this.internal.f2,t=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,o=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,i=this.internal.Point,a=this.internal.Rectangle,A=this.internal.Matrix,d=new c}]);var u=function(z){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var E=z;Object.defineProperty(this,"pdf",{get:function(){return E}});var F=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return F},set:function(Y){F=!!Y}});var I=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return I},set:function(Y){I=!!Y}});var O=0;Object.defineProperty(this,"posX",{get:function(){return O},set:function(Y){isNaN(Y)||(O=Y)}});var D=0;Object.defineProperty(this,"posY",{get:function(){return D},set:function(Y){isNaN(Y)||(D=Y)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(Y){var j;typeof Y=="number"?j=[Y,Y,Y,Y]:((j=new Array(4))[0]=Y[0],j[1]=Y.length>=2?Y[1]:j[0],j[2]=Y.length>=3?Y[2]:j[0],j[3]=Y.length>=4?Y[3]:j[1]),d.margin=j}});var P=!1;Object.defineProperty(this,"autoPaging",{get:function(){return P},set:function(Y){P=Y}});var K=0;Object.defineProperty(this,"lastBreak",{get:function(){return K},set:function(Y){K=Y}});var M=[];Object.defineProperty(this,"pageBreaks",{get:function(){return M},set:function(Y){M=Y}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(Y){Y instanceof c&&(d=Y)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(Y){d.path=Y}});var ge=[];Object.defineProperty(this,"ctxStack",{get:function(){return ge},set:function(Y){ge=Y}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Y){var j;j=h(Y),this.ctx.fillStyle=j.style,this.ctx.isFillTransparent=j.a===0,this.ctx.fillOpacity=j.a,this.pdf.setFillColor(j.r,j.g,j.b,{a:j.a}),this.pdf.setTextColor(j.r,j.g,j.b,{a:j.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Y){var j=h(Y);this.ctx.strokeStyle=j.style,this.ctx.isStrokeTransparent=j.a===0,this.ctx.strokeOpacity=j.a,j.a===0?this.pdf.setDrawColor(255,255,255):(j.a,this.pdf.setDrawColor(j.r,j.g,j.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Y){["butt","round","square"].indexOf(Y)!==-1&&(this.ctx.lineCap=Y,this.pdf.setLineCap(Y))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Y){isNaN(Y)||(this.ctx.lineWidth=Y,this.pdf.setLineWidth(Y))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Y){["bevel","round","miter"].indexOf(Y)!==-1&&(this.ctx.lineJoin=Y,this.pdf.setLineJoin(Y))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Y){isNaN(Y)||(this.ctx.miterLimit=Y,this.pdf.setMiterLimit(Y))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Y){this.ctx.textBaseline=Y}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Y){["right","end","center","left","start"].indexOf(Y)!==-1&&(this.ctx.textAlign=Y)}});var _e=null;function Me(Y,j){if(_e===null){var ee=function(ae){var ue=[];return Object.keys(ae).forEach(function(me){ae[me].forEach(function(ye){var Ee=null;switch(ye){case"bold":Ee={family:me,weight:"bold"};break;case"italic":Ee={family:me,style:"italic"};break;case"bolditalic":Ee={family:me,weight:"bold",style:"italic"};break;case"":case"normal":Ee={family:me}}Ee!==null&&(Ee.ref={name:me,style:ye},ue.push(Ee))})}),ue}(Y.getFontList());_e=function(ae){for(var ue={},me=0;me<ae.length;++me){var ye=Pm(ae[me]),Ee=ye.family,de=ye.stretch,Qe=ye.style,Fe=ye.weight;ue[Ee]=ue[Ee]||{},ue[Ee][de]=ue[Ee][de]||{},ue[Ee][de][Qe]=ue[Ee][de][Qe]||{},ue[Ee][de][Qe][Fe]=ye}return ue}(ee.concat(j))}return _e}var $e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(Y){_e=null,$e=Y}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Y){var j;if(this.ctx.font=Y,(j=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(Y))!==null){var ee=j[1],ae=(j[2],j[3]),ue=j[4],me=(j[5],j[6]),ye=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ue)[2];ue=Math.floor(ye==="px"?parseFloat(ue)*this.pdf.internal.scaleFactor:ye==="em"?parseFloat(ue)*this.pdf.getFontSize():parseFloat(ue)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ue);var Ee=function(ce){var Ie,V,G=[],le=ce.trim();if(le==="")return A0;if(le in w_)return[w_[le]];for(;le!=="";){switch(V=null,Ie=(le=__(le)).charAt(0)){case'"':case"'":V=mN(le.substring(1),Ie);break;default:V=wN(le)}if(V===null||(G.push(V[0]),(le=__(V[1]))!==""&&le.charAt(0)!==","))return A0;le=le.replace(/^,/,"")}return G}(me);if(this.fontFaces){var de=vN(Me(this.pdf,this.fontFaces),Ee.map(function(ce){return{family:ce,stretch:"normal",weight:ae,style:ee}}));this.pdf.setFont(de.ref.name,de.ref.style)}else{var Qe="";(ae==="bold"||parseInt(ae,10)>=700||ee==="bold")&&(Qe="bold"),ee==="italic"&&(Qe+="italic"),Qe.length===0&&(Qe="normal");for(var Fe="",Oe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Te=0;Te<Ee.length;Te++){if(this.pdf.internal.getFont(Ee[Te],Qe,{noFallback:!0,disableWarning:!0})!==void 0){Fe=Ee[Te];break}if(Qe==="bolditalic"&&this.pdf.internal.getFont(Ee[Te],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Fe=Ee[Te],Qe="bold";else if(this.pdf.internal.getFont(Ee[Te],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Fe=Ee[Te],Qe="normal";break}}if(Fe===""){for(var De=0;De<Ee.length;De++)if(Oe[Ee[De]]){Fe=Oe[Ee[De]];break}}Fe=Fe===""?"Times":Fe,this.pdf.setFont(Fe,Qe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Y){this.ctx.globalCompositeOperation=Y}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Y){this.ctx.globalAlpha=Y}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Y){this.ctx.lineDashOffset=Y,ze.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Y){this.ctx.lineDash=Y,ze.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Y){this.ctx.ignoreClearRect=!!Y}})};u.prototype.setLineDash=function(z){this.lineDash=z},u.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},u.prototype.fill=function(){k.call(this,"fill",!1)},u.prototype.stroke=function(){k.call(this,"stroke",!1)},u.prototype.beginPath=function(){this.path=[{type:"begin"}]},u.prototype.moveTo=function(z,E){if(isNaN(z)||isNaN(E))throw Hn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var F=this.ctx.transform.applyToPoint(new i(z,E));this.path.push({type:"mt",x:F.x,y:F.y}),this.ctx.lastPoint=new i(z,E)},u.prototype.closePath=function(){var z=new i(0,0),E=0;for(E=this.path.length-1;E!==-1;E--)if(this.path[E].type==="begin"&&Pn(this.path[E+1])==="object"&&typeof this.path[E+1].x=="number"){z=new i(this.path[E+1].x,this.path[E+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new i(z.x,z.y)},u.prototype.lineTo=function(z,E){if(isNaN(z)||isNaN(E))throw Hn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var F=this.ctx.transform.applyToPoint(new i(z,E));this.path.push({type:"lt",x:F.x,y:F.y}),this.ctx.lastPoint=new i(F.x,F.y)},u.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},u.prototype.quadraticCurveTo=function(z,E,F,I){if(isNaN(F)||isNaN(I)||isNaN(z)||isNaN(E))throw Hn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var O=this.ctx.transform.applyToPoint(new i(F,I)),D=this.ctx.transform.applyToPoint(new i(z,E));this.path.push({type:"qct",x1:D.x,y1:D.y,x:O.x,y:O.y}),this.ctx.lastPoint=new i(O.x,O.y)},u.prototype.bezierCurveTo=function(z,E,F,I,O,D){if(isNaN(O)||isNaN(D)||isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I))throw Hn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var P=this.ctx.transform.applyToPoint(new i(O,D)),K=this.ctx.transform.applyToPoint(new i(z,E)),M=this.ctx.transform.applyToPoint(new i(F,I));this.path.push({type:"bct",x1:K.x,y1:K.y,x2:M.x,y2:M.y,x:P.x,y:P.y}),this.ctx.lastPoint=new i(P.x,P.y)},u.prototype.arc=function(z,E,F,I,O,D){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I)||isNaN(O))throw Hn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(D=!!D,!this.ctx.transform.isIdentity){var P=this.ctx.transform.applyToPoint(new i(z,E));z=P.x,E=P.y;var K=this.ctx.transform.applyToPoint(new i(0,F)),M=this.ctx.transform.applyToPoint(new i(0,0));F=Math.sqrt(Math.pow(K.x-M.x,2)+Math.pow(K.y-M.y,2))}Math.abs(O-I)>=2*Math.PI&&(I=0,O=2*Math.PI),this.path.push({type:"arc",x:z,y:E,radius:F,startAngle:I,endAngle:O,counterclockwise:D})},u.prototype.arcTo=function(z,E,F,I,O){throw new Error("arcTo not implemented.")},u.prototype.rect=function(z,E,F,I){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I))throw Hn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(z,E),this.lineTo(z+F,E),this.lineTo(z+F,E+I),this.lineTo(z,E+I),this.lineTo(z,E),this.lineTo(z+F,E),this.lineTo(z,E)},u.prototype.fillRect=function(z,E,F,I){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I))throw Hn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!p.call(this)){var O={};this.lineCap!=="butt"&&(O.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(O.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(z,E,F,I),this.fill(),O.hasOwnProperty("lineCap")&&(this.lineCap=O.lineCap),O.hasOwnProperty("lineJoin")&&(this.lineJoin=O.lineJoin)}},u.prototype.strokeRect=function(z,E,F,I){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I))throw Hn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(z,E,F,I),this.stroke())},u.prototype.clearRect=function(z,E,F,I){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I))throw Hn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(z,E,F,I))},u.prototype.save=function(z){z=typeof z!="boolean"||z;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("q");if(this.pdf.setPage(E),z){this.ctx.fontSize=this.pdf.internal.getFontSize();var I=new c(this.ctx);this.ctxStack.push(this.ctx),this.ctx=I}},u.prototype.restore=function(z){z=typeof z!="boolean"||z;for(var E=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("Q");this.pdf.setPage(E),z&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},u.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var h=function(z){var E,F,I,O;if(z.isCanvasGradient===!0&&(z=z.getColor()),!z)return{r:0,g:0,b:0,a:0,style:z};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(z))E=0,F=0,I=0,O=0;else{var D=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(z);if(D!==null)E=parseInt(D[1]),F=parseInt(D[2]),I=parseInt(D[3]),O=1;else if((D=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(z))!==null)E=parseInt(D[1]),F=parseInt(D[2]),I=parseInt(D[3]),O=parseFloat(D[4]);else{if(O=1,typeof z=="string"&&z.charAt(0)!=="#"){var P=new fz(z);z=P.ok?P.toHex():"#000000"}z.length===4?(E=z.substring(1,2),E+=E,F=z.substring(2,3),F+=F,I=z.substring(3,4),I+=I):(E=z.substring(1,3),F=z.substring(3,5),I=z.substring(5,7)),E=parseInt(E,16),F=parseInt(F,16),I=parseInt(I,16)}}return{r:E,g:F,b:I,a:O,style:z}},p=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};u.prototype.fillText=function(z,E,F,I){if(isNaN(E)||isNaN(F)||typeof z!="string")throw Hn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(I=isNaN(I)?void 0:I,!p.call(this)){var O=te(this.ctx.transform.rotation),D=this.ctx.transform.scaleX;R.call(this,{text:z,x:E,y:F,scale:D,angle:O,align:this.textAlign,maxWidth:I})}},u.prototype.strokeText=function(z,E,F,I){if(isNaN(E)||isNaN(F)||typeof z!="string")throw Hn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){I=isNaN(I)?void 0:I;var O=te(this.ctx.transform.rotation),D=this.ctx.transform.scaleX;R.call(this,{text:z,x:E,y:F,scale:D,renderingMode:"stroke",angle:O,align:this.textAlign,maxWidth:I})}},u.prototype.measureText=function(z){if(typeof z!="string")throw Hn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var E=this.pdf,F=this.pdf.internal.scaleFactor,I=E.internal.getFontSize(),O=E.getStringUnitWidth(z)*I/E.internal.scaleFactor,D=function(P){var K=(P=P||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return K}}),this};return new D({width:O*=Math.round(96*F/72*1e4)/1e4})},u.prototype.scale=function(z,E){if(isNaN(z)||isNaN(E))throw Hn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var F=new A(z,0,0,E,0,0);this.ctx.transform=this.ctx.transform.multiply(F)},u.prototype.rotate=function(z){if(isNaN(z))throw Hn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var E=new A(Math.cos(z),Math.sin(z),-Math.sin(z),Math.cos(z),0,0);this.ctx.transform=this.ctx.transform.multiply(E)},u.prototype.translate=function(z,E){if(isNaN(z)||isNaN(E))throw Hn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var F=new A(1,0,0,1,z,E);this.ctx.transform=this.ctx.transform.multiply(F)},u.prototype.transform=function(z,E,F,I,O,D){if(isNaN(z)||isNaN(E)||isNaN(F)||isNaN(I)||isNaN(O)||isNaN(D))throw Hn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var P=new A(z,E,F,I,O,D);this.ctx.transform=this.ctx.transform.multiply(P)},u.prototype.setTransform=function(z,E,F,I,O,D){z=isNaN(z)?1:z,E=isNaN(E)?0:E,F=isNaN(F)?0:F,I=isNaN(I)?1:I,O=isNaN(O)?0:O,D=isNaN(D)?0:D,this.ctx.transform=new A(z,E,F,I,O,D)};var w=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};u.prototype.drawImage=function(z,E,F,I,O,D,P,K,M){var ge=this.pdf.getImageProperties(z),_e=1,Me=1,$e=1,Y=1;I!==void 0&&K!==void 0&&($e=K/I,Y=M/O,_e=ge.width/I*K/I,Me=ge.height/O*M/O),D===void 0&&(D=E,P=F,E=0,F=0),I!==void 0&&K===void 0&&(K=I,M=O),I===void 0&&K===void 0&&(K=ge.width,M=ge.height);for(var j,ee=this.ctx.transform.decompose(),ae=te(ee.rotate.shx),ue=new A,me=(ue=(ue=(ue=ue.multiply(ee.translate)).multiply(ee.skew)).multiply(ee.scale)).applyToRectangle(new a(D-E*$e,P-F*Y,I*_e,O*Me)),ye=y.call(this,me),Ee=[],de=0;de<ye.length;de+=1)Ee.indexOf(ye[de])===-1&&Ee.push(ye[de]);if(Q(Ee),this.autoPaging)for(var Qe=Ee[0],Fe=Ee[Ee.length-1],Oe=Qe;Oe<Fe+1;Oe++){this.pdf.setPage(Oe);var Te=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],De=Oe===1?this.posY+this.margin[0]:this.margin[0],ce=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ie=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],V=Oe===1?0:ce+(Oe-2)*Ie;if(this.ctx.clip_path.length!==0){var G=this.path;j=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(j,this.posX+this.margin[3],-V+De+this.ctx.prevPageLastElemOffset),H.call(this,"fill",!0),this.path=G}var le=JSON.parse(JSON.stringify(me));le=C([le],this.posX+this.margin[3],-V+De+this.ctx.prevPageLastElemOffset)[0];var Le=(Oe>Qe||Oe<Fe)&&w.call(this);Le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Te,Ie,null).clip().discardPath()),this.pdf.addImage(z,"JPEG",le.x,le.y,le.w,le.h,null,null,ae),Le&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(z,"JPEG",me.x,me.y,me.w,me.h,null,null,ae)};var y=function(z,E,F){var I=[];E=E||this.pdf.internal.pageSize.width,F=F||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var O=this.posY+this.ctx.prevPageLastElemOffset;switch(z.type){default:case"mt":case"lt":I.push(Math.floor((z.y+O)/F)+1);break;case"arc":I.push(Math.floor((z.y+O-z.radius)/F)+1),I.push(Math.floor((z.y+O+z.radius)/F)+1);break;case"qct":var D=Ce(this.ctx.lastPoint.x,this.ctx.lastPoint.y,z.x1,z.y1,z.x,z.y);I.push(Math.floor((D.y+O)/F)+1),I.push(Math.floor((D.y+D.h+O)/F)+1);break;case"bct":var P=ne(this.ctx.lastPoint.x,this.ctx.lastPoint.y,z.x1,z.y1,z.x2,z.y2,z.x,z.y);I.push(Math.floor((P.y+O)/F)+1),I.push(Math.floor((P.y+P.h+O)/F)+1);break;case"rect":I.push(Math.floor((z.y+O)/F)+1),I.push(Math.floor((z.y+z.h+O)/F)+1)}for(var K=0;K<I.length;K+=1)for(;this.pdf.internal.getNumberOfPages()<I[K];)B.call(this);return I},B=function(){var z=this.fillStyle,E=this.strokeStyle,F=this.font,I=this.lineCap,O=this.lineWidth,D=this.lineJoin;this.pdf.addPage(),this.fillStyle=z,this.strokeStyle=E,this.font=F,this.lineCap=I,this.lineWidth=O,this.lineJoin=D},C=function(z,E,F){for(var I=0;I<z.length;I++)switch(z[I].type){case"bct":z[I].x2+=E,z[I].y2+=F;case"qct":z[I].x1+=E,z[I].y1+=F;case"mt":case"lt":case"arc":default:z[I].x+=E,z[I].y+=F}return z},Q=function(z){return z.sort(function(E,F){return E-F})},k=function(z,E){for(var F,I,O=this.fillStyle,D=this.strokeStyle,P=this.lineCap,K=this.lineWidth,M=Math.abs(K*this.ctx.transform.scaleX),ge=this.lineJoin,_e=JSON.parse(JSON.stringify(this.path)),Me=JSON.parse(JSON.stringify(this.path)),$e=[],Y=0;Y<Me.length;Y++)if(Me[Y].x!==void 0)for(var j=y.call(this,Me[Y]),ee=0;ee<j.length;ee+=1)$e.indexOf(j[ee])===-1&&$e.push(j[ee]);for(var ae=0;ae<$e.length;ae++)for(;this.pdf.internal.getNumberOfPages()<$e[ae];)B.call(this);if(Q($e),this.autoPaging)for(var ue=$e[0],me=$e[$e.length-1],ye=ue;ye<me+1;ye++){this.pdf.setPage(ye),this.fillStyle=O,this.strokeStyle=D,this.lineCap=P,this.lineWidth=M,this.lineJoin=ge;var Ee=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],de=ye===1?this.posY+this.margin[0]:this.margin[0],Qe=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Oe=ye===1?0:Qe+(ye-2)*Fe;if(this.ctx.clip_path.length!==0){var Te=this.path;F=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(F,this.posX+this.margin[3],-Oe+de+this.ctx.prevPageLastElemOffset),H.call(this,z,!0),this.path=Te}if(I=JSON.parse(JSON.stringify(_e)),this.path=C(I,this.posX+this.margin[3],-Oe+de+this.ctx.prevPageLastElemOffset),E===!1||ye===0){var De=(ye>ue||ye<me)&&w.call(this);De&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ee,Fe,null).clip().discardPath()),H.call(this,z,E),De&&this.pdf.restoreGraphicsState()}this.lineWidth=K}else this.lineWidth=M,H.call(this,z,E),this.lineWidth=K;this.path=_e},H=function(z,E){if((z!=="stroke"||E||!v.call(this))&&(z==="stroke"||E||!p.call(this))){for(var F,I,O=[],D=this.path,P=0;P<D.length;P++){var K=D[P];switch(K.type){case"begin":O.push({begin:!0});break;case"close":O.push({close:!0});break;case"mt":O.push({start:K,deltas:[],abs:[]});break;case"lt":var M=O.length;if(D[P-1]&&!isNaN(D[P-1].x)&&(F=[K.x-D[P-1].x,K.y-D[P-1].y],M>0)){for(;M>=0;M--)if(O[M-1].close!==!0&&O[M-1].begin!==!0){O[M-1].deltas.push(F),O[M-1].abs.push(K);break}}break;case"bct":F=[K.x1-D[P-1].x,K.y1-D[P-1].y,K.x2-D[P-1].x,K.y2-D[P-1].y,K.x-D[P-1].x,K.y-D[P-1].y],O[O.length-1].deltas.push(F);break;case"qct":var ge=D[P-1].x+2/3*(K.x1-D[P-1].x),_e=D[P-1].y+2/3*(K.y1-D[P-1].y),Me=K.x+2/3*(K.x1-K.x),$e=K.y+2/3*(K.y1-K.y),Y=K.x,j=K.y;F=[ge-D[P-1].x,_e-D[P-1].y,Me-D[P-1].x,$e-D[P-1].y,Y-D[P-1].x,j-D[P-1].y],O[O.length-1].deltas.push(F);break;case"arc":O.push({deltas:[],abs:[],arc:!0}),Array.isArray(O[O.length-1].abs)&&O[O.length-1].abs.push(K)}}I=E?null:z==="stroke"?"stroke":"fill";for(var ee=!1,ae=0;ae<O.length;ae++)if(O[ae].arc)for(var ue=O[ae].abs,me=0;me<ue.length;me++){var ye=ue[me];ye.type==="arc"?N.call(this,ye.x,ye.y,ye.radius,ye.startAngle,ye.endAngle,ye.counterclockwise,void 0,E,!ee):J.call(this,ye.x,ye.y),ee=!0}else if(O[ae].close===!0)this.pdf.internal.out("h"),ee=!1;else if(O[ae].begin!==!0){var Ee=O[ae].start.x,de=O[ae].start.y;se.call(this,O[ae].deltas,Ee,de),ee=!0}I&&re.call(this,I),E&&be.call(this)}},Z=function(z){var E=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,F=E*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return z-F;case"top":return z+E-F;case"hanging":return z+E-2*F;case"middle":return z+E/2-F;case"ideographic":return z;case"alphabetic":default:return z}},q=function(z){return z+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};u.prototype.createLinearGradient=function(){var z=function(){};return z.colorStops=[],z.addColorStop=function(E,F){this.colorStops.push([E,F])},z.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},z.isCanvasGradient=!0,z},u.prototype.createPattern=function(){return this.createLinearGradient()},u.prototype.createRadialGradient=function(){return this.createLinearGradient()};var N=function(z,E,F,I,O,D,P,K,M){for(var ge=ie.call(this,F,I,O,D),_e=0;_e<ge.length;_e++){var Me=ge[_e];_e===0&&(M?L.call(this,Me.x1+z,Me.y1+E):J.call(this,Me.x1+z,Me.y1+E)),fe.call(this,z,E,Me.x2,Me.y2,Me.x3,Me.y3,Me.x4,Me.y4)}K?be.call(this):re.call(this,P)},re=function(z){switch(z){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},be=function(){this.pdf.clip(),this.pdf.discardPath()},L=function(z,E){this.pdf.internal.out(t(z)+" "+r(E)+" m")},R=function(z){var E;switch(z.align){case"right":case"end":E="right";break;case"center":E="center";break;case"left":case"start":default:E="left"}var F=this.pdf.getTextDimensions(z.text),I=Z.call(this,z.y),O=q.call(this,I)-F.h,D=this.ctx.transform.applyToPoint(new i(z.x,I)),P=this.ctx.transform.decompose(),K=new A;K=(K=(K=K.multiply(P.translate)).multiply(P.skew)).multiply(P.scale);for(var M,ge,_e,Me=this.ctx.transform.applyToRectangle(new a(z.x,I,F.w,F.h)),$e=K.applyToRectangle(new a(z.x,O,F.w,F.h)),Y=y.call(this,$e),j=[],ee=0;ee<Y.length;ee+=1)j.indexOf(Y[ee])===-1&&j.push(Y[ee]);if(Q(j),this.autoPaging)for(var ae=j[0],ue=j[j.length-1],me=ae;me<ue+1;me++){this.pdf.setPage(me);var ye=me===1?this.posY+this.margin[0]:this.margin[0],Ee=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],de=this.pdf.internal.pageSize.height-this.margin[2],Qe=de-this.margin[0],Fe=this.pdf.internal.pageSize.width-this.margin[1],Oe=Fe-this.margin[3],Te=me===1?0:Ee+(me-2)*Qe;if(this.ctx.clip_path.length!==0){var De=this.path;M=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=C(M,this.posX+this.margin[3],-1*Te+ye),H.call(this,"fill",!0),this.path=De}var ce=C([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-Te+ye+this.ctx.prevPageLastElemOffset)[0];z.scale>=.01&&(ge=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ge*z.scale),_e=this.lineWidth,this.lineWidth=_e*z.scale);var Ie=this.autoPaging!=="text";if(Ie||ce.y+ce.h<=de){if(Ie||ce.y>=ye&&ce.x<=Fe){var V=Ie?z.text:this.pdf.splitTextToSize(z.text,z.maxWidth||Fe-ce.x)[0],G=C([JSON.parse(JSON.stringify(Me))],this.posX+this.margin[3],-Te+ye+this.ctx.prevPageLastElemOffset)[0],le=Ie&&(me>ae||me<ue)&&w.call(this);le&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Oe,Qe,null).clip().discardPath()),this.pdf.text(V,G.x,G.y,{angle:z.angle,align:E,renderingMode:z.renderingMode}),le&&this.pdf.restoreGraphicsState()}}else ce.y<de&&(this.ctx.prevPageLastElemOffset+=de-ce.y);z.scale>=.01&&(this.pdf.setFontSize(ge),this.lineWidth=_e)}else z.scale>=.01&&(ge=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ge*z.scale),_e=this.lineWidth,this.lineWidth=_e*z.scale),this.pdf.text(z.text,D.x+this.posX,D.y+this.posY,{angle:z.angle,align:E,renderingMode:z.renderingMode,maxWidth:z.maxWidth}),z.scale>=.01&&(this.pdf.setFontSize(ge),this.lineWidth=_e)},J=function(z,E,F,I){F=F||0,I=I||0,this.pdf.internal.out(t(z+F)+" "+r(E+I)+" l")},se=function(z,E,F){return this.pdf.lines(z,E,F,null,null)},fe=function(z,E,F,I,O,D,P,K){this.pdf.internal.out([e(o(F+z)),e(s(I+E)),e(o(O+z)),e(s(D+E)),e(o(P+z)),e(s(K+E)),"c"].join(" "))},ie=function(z,E,F,I){for(var O=2*Math.PI,D=Math.PI/2;E>F;)E-=O;var P=Math.abs(F-E);P<O&&I&&(P=O-P);for(var K=[],M=I?-1:1,ge=E;P>1e-5;){var _e=ge+M*Math.min(P,D);K.push(pe.call(this,z,ge,_e)),P-=Math.abs(_e-ge),ge=_e}return K},pe=function(z,E,F){var I=(F-E)/2,O=z*Math.cos(I),D=z*Math.sin(I),P=O,K=-D,M=P*P+K*K,ge=M+P*O+K*D,_e=4/3*(Math.sqrt(2*M*ge)-ge)/(P*D-K*O),Me=P-_e*K,$e=K+_e*P,Y=Me,j=-$e,ee=I+E,ae=Math.cos(ee),ue=Math.sin(ee);return{x1:z*Math.cos(E),y1:z*Math.sin(E),x2:Me*ae-$e*ue,y2:Me*ue+$e*ae,x3:Y*ae-j*ue,y3:Y*ue+j*ae,x4:z*Math.cos(F),y4:z*Math.sin(F)}},te=function(z){return 180*z/Math.PI},Ce=function(z,E,F,I,O,D){var P=z+.5*(F-z),K=E+.5*(I-E),M=O+.5*(F-O),ge=D+.5*(I-D),_e=Math.min(z,O,P,M),Me=Math.max(z,O,P,M),$e=Math.min(E,D,K,ge),Y=Math.max(E,D,K,ge);return new a(_e,$e,Me-_e,Y-$e)},ne=function(z,E,F,I,O,D,P,K){var M,ge,_e,Me,$e,Y,j,ee,ae,ue,me,ye,Ee,de,Qe=F-z,Fe=I-E,Oe=O-F,Te=D-I,De=P-O,ce=K-D;for(ge=0;ge<41;ge++)ae=(j=(_e=z+(M=ge/40)*Qe)+M*(($e=F+M*Oe)-_e))+M*($e+M*(O+M*De-$e)-j),ue=(ee=(Me=E+M*Fe)+M*((Y=I+M*Te)-Me))+M*(Y+M*(D+M*ce-Y)-ee),ge==0?(me=ae,ye=ue,Ee=ae,de=ue):(me=Math.min(me,ae),ye=Math.min(ye,ue),Ee=Math.max(Ee,ae),de=Math.max(de,ue));return new a(Math.round(me),Math.round(ye),Math.round(Ee-me),Math.round(de-ye))},ze=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var z,E,F=(z=this.ctx.lineDash,E=this.ctx.lineDashOffset,JSON.stringify({lineDash:z,lineDashOffset:E}));this.prevLineDash!==F&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=F)}}})(zr.API),function(n){var e=function(s){var i,a,A,d,c,u,h,p,v,w;for(a=[],A=0,d=(s+=i="\0\0\0\0".slice(s.length%4||4)).length;d>A;A+=4)(c=(s.charCodeAt(A)<<24)+(s.charCodeAt(A+1)<<16)+(s.charCodeAt(A+2)<<8)+s.charCodeAt(A+3))!==0?(u=(c=((c=((c=((c=(c-(w=c%85))/85)-(v=c%85))/85)-(p=c%85))/85)-(h=c%85))/85)%85,a.push(u+33,h+33,p+33,v+33,w+33)):a.push(122);return function(y,B){for(var C=B;C>0;C--)y.pop()}(a,i.length),String.fromCharCode.apply(String,a)+"~>"},t=function(s){var i,a,A,d,c,u=String,h="length",p=255,v="charCodeAt",w="slice",y="replace";for(s[w](-2),s=s[w](0,-2)[y](/\s/g,"")[y]("z","!!!!!"),A=[],d=0,c=(s+=i="uuuuu"[w](s[h]%5||5))[h];c>d;d+=5)a=52200625*(s[v](d)-33)+614125*(s[v](d+1)-33)+7225*(s[v](d+2)-33)+85*(s[v](d+3)-33)+(s[v](d+4)-33),A.push(p&a>>24,p&a>>16,p&a>>8,p&a);return function(B,C){for(var Q=C;Q>0;Q--)B.pop()}(A,i[h]),u.fromCharCode.apply(u,A)},r=function(s){var i=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),i.test(s)===!1)return"";for(var a="",A=0;A<s.length;A+=2)a+=String.fromCharCode("0x"+(s[A]+s[A+1]));return a},o=function(s){for(var i=new Uint8Array(s.length),a=s.length;a--;)i[a]=s.charCodeAt(a);return s=(i=Fm(i)).reduce(function(A,d){return A+String.fromCharCode(d)},"")};n.processDataByFilters=function(s,i){var a=0,A=s||"",d=[];for(typeof(i=i||[])=="string"&&(i=[i]),a=0;a<i.length;a+=1)switch(i[a]){case"ASCII85Decode":case"/ASCII85Decode":A=t(A),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":A=e(A),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":A=r(A),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":A=A.split("").map(function(c){return("0"+c.charCodeAt().toString(16)).slice(-2)}).join("")+">",d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":A=o(A),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+i[a]+'" is not implemented')}return{data:A,reverseChain:d.reverse().join(" ")}}}(zr.API),function(n){n.loadFile=function(e,t,r){return function(o,s,i){s=s!==!1,i=typeof i=="function"?i:function(){};var a=void 0;try{a=function(A,d,c){var u=new XMLHttpRequest,h=0,p=function(v){var w=v.length,y=[],B=String.fromCharCode;for(h=0;h<w;h+=1)y.push(B(255&v.charCodeAt(h)));return y.join("")};if(u.open("GET",A,!d),u.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(u.onload=function(){u.status===200?c(p(this.responseText)):c(void 0)}),u.send(null),d&&u.status===200)return p(u.responseText)}(o,s,i)}catch{}return a}(e,t,r)},n.loadImageFile=n.loadFile}(zr.API),function(n){function e(){return(Fr.html2canvas?Promise.resolve(Fr.html2canvas):js(()=>import("./html2canvas.esm.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load html2canvas: "+i))}).then(function(i){return i.default?i.default:i})}function t(){return(Fr.DOMPurify?Promise.resolve(Fr.DOMPurify):js(()=>import("./purify.es.js"),[])).catch(function(i){return Promise.reject(new Error("Could not load dompurify: "+i))}).then(function(i){return i.default?i.default:i})}var r=function(i){var a=Pn(i);return a==="undefined"?"undefined":a==="string"||i instanceof String?"string":a==="number"||i instanceof Number?"number":a==="function"||i instanceof Function?"function":i&&i.constructor===Array?"array":i&&i.nodeType===1?"element":a==="object"?"object":"unknown"},o=function(i,a){var A=document.createElement(i);for(var d in a.className&&(A.className=a.className),a.innerHTML&&a.dompurify&&(A.innerHTML=a.dompurify.sanitize(a.innerHTML)),a.style)A.style[d]=a.style[d];return A},s=function i(a){var A=Object.assign(i.convert(Promise.resolve()),JSON.parse(JSON.stringify(i.template))),d=i.convert(Promise.resolve(),A);return d=(d=d.setProgress(1,i,1,[i])).set(a)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(i,a){return i.__proto__=a||s.prototype,i},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(i,a){return this.then(function(){switch(a=a||function(A){switch(r(A)){case"string":return"string";case"element":return A.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(i)){case"string":return this.then(t).then(function(A){return this.set({src:o("div",{innerHTML:i,dompurify:A})})});case"element":return this.set({src:i});case"canvas":return this.set({canvas:i});case"img":return this.set({img:i});default:return this.error("Unknown source type.")}})},s.prototype.to=function(i){switch(i){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var i={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},a=function A(d,c){for(var u=d.nodeType===3?document.createTextNode(d.nodeValue):d.cloneNode(!1),h=d.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(A(h,c));return d.nodeType===1&&(d.nodeName==="CANVAS"?(u.width=d.width,u.height=d.height,u.getContext("2d").drawImage(d,0,0)):d.nodeName!=="TEXTAREA"&&d.nodeName!=="SELECT"||(u.value=d.value),u.addEventListener("load",function(){u.scrollTop=d.scrollTop,u.scrollLeft=d.scrollLeft},!0)),u}(this.prop.src,this.opt.html2canvas.javascriptEnabled);a.tagName==="BODY"&&(i.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=o("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=o("div",{className:"html2pdf__container",style:i}),this.prop.container.appendChild(a),this.prop.container.firstChild.appendChild(o("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(a){var A=Object.assign({},this.opt.html2canvas);return delete A.onrendered,a(this.prop.container,A)}).then(function(a){(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var i=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(i).then(e).then(function(a){var A=this.opt.jsPDF,d=this.opt.fontFaces,c=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,u=Object.assign({async:!0,allowTaint:!0,scale:c,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete u.onrendered,A.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,A.context2d.posX=this.opt.x,A.context2d.posY=this.opt.y,A.context2d.margin=this.opt.margin,A.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var p=d[h],v=p.src.find(function(w){return w.format==="truetype"});v&&A.addFont(v.url,p.ref.name,p.ref.style)}return u.windowHeight=u.windowHeight||0,u.windowHeight=u.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):u.windowHeight,A.context2d.save(!0),a(this.prop.container,u)}).then(function(a){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(a),this.prop.canvas=a,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var i=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=i})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(i,a,A){return(A=A||"pdf").toLowerCase()==="img"||A.toLowerCase()==="image"?this.outputImg(i,a):this.outputPdf(i,a)},s.prototype.outputPdf=function(i,a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(i,a)})},s.prototype.outputImg=function(i){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(i){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+i+'" is not supported.'}})},s.prototype.save=function(i){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(i?{filename:i}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(i){if(r(i)!=="object")return this;var a=Object.keys(i||{}).map(function(A){if(A in s.template.prop)return function(){this.prop[A]=i[A]};switch(A){case"margin":return this.setMargin.bind(this,i.margin);case"jsPDF":return function(){return this.opt.jsPDF=i.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,i.pageSize);default:return function(){this.opt[A]=i[A]}}},this);return this.then(function(){return this.thenList(a)})},s.prototype.get=function(i,a){return this.then(function(){var A=i in s.template.prop?this.prop[i]:this.opt[i];return a?a(A):A})},s.prototype.setMargin=function(i){return this.then(function(){switch(r(i)){case"number":i=[i,i,i,i];case"array":if(i.length===2&&(i=[i[0],i[1],i[0],i[1]]),i.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=i}).then(this.setPageSize)},s.prototype.setPageSize=function(i){function a(A,d){return Math.floor(A*d/72*96)}return this.then(function(){(i=i||zr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(i.inner={width:i.width-this.opt.margin[1]-this.opt.margin[3],height:i.height-this.opt.margin[0]-this.opt.margin[2]},i.inner.px={width:a(i.inner.width,i.k),height:a(i.inner.height,i.k)},i.inner.ratio=i.inner.height/i.inner.width),this.prop.pageSize=i})},s.prototype.setProgress=function(i,a,A,d){return i!=null&&(this.progress.val=i),a!=null&&(this.progress.state=a),A!=null&&(this.progress.n=A),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(i,a,A,d){return this.setProgress(i?this.progress.val+i:null,a||null,A?this.progress.n+A:null,d?this.progress.stack.concat(d):null)},s.prototype.then=function(i,a){var A=this;return this.thenCore(i,a,function(d,c){return A.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(u){return A.updateProgress(null,d),u}).then(d,c).then(function(u){return A.updateProgress(1),u})})},s.prototype.thenCore=function(i,a,A){A=A||Promise.prototype.then,i&&(i=i.bind(this)),a&&(a=a.bind(this));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),c=A.call(d,i,a);return s.convert(c,this.__proto__)},s.prototype.thenExternal=function(i,a){return Promise.prototype.then.call(this,i,a)},s.prototype.thenList=function(i){var a=this;return i.forEach(function(A){a=a.thenCore(A)}),a},s.prototype.catch=function(i){i&&(i=i.bind(this));var a=Promise.prototype.catch.call(this,i);return s.convert(a,this)},s.prototype.catchExternal=function(i){return Promise.prototype.catch.call(this,i)},s.prototype.error=function(i){return this.then(function(){throw new Error(i)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,zr.getPageSize=function(i,a,A){if(Pn(i)==="object"){var d=i;i=d.orientation,a=d.unit||a,A=d.format||A}a=a||"mm",A=A||"a4",i=(""+(i||"P")).toLowerCase();var c,u=(""+A).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(a){case"pt":c=1;break;case"mm":c=72/25.4;break;case"cm":c=72/2.54;break;case"in":c=72;break;case"px":c=.75;break;case"pc":case"em":c=12;break;case"ex":c=6;break;default:throw"Invalid unit: "+a}var p,v=0,w=0;if(h.hasOwnProperty(u))v=h[u][1]/c,w=h[u][0]/c;else try{v=A[1],w=A[0]}catch{throw new Error("Invalid format: "+A)}if(i==="p"||i==="portrait")i="p",w>v&&(p=w,w=v,v=p);else{if(i!=="l"&&i!=="landscape")throw"Invalid orientation: "+i;i="l",v>w&&(p=w,w=v,v=p)}return{width:w,height:v,unit:a,k:c,orientation:i}},n.html=function(i,a){(a=a||{}).callback=a.callback||function(){},a.html2canvas=a.html2canvas||{},a.html2canvas.canvas=a.html2canvas.canvas||this.canvas,a.jsPDF=a.jsPDF||this,a.fontFaces=a.fontFaces?a.fontFaces.map(Pm):null;var A=new s(a);return a.worker?A:A.from(i).doCallback()}}(zr.API),zr.API.addJS=function(n){return x_=n,this.internal.events.subscribe("postPutResources",function(){$f=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+($f+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),b_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+x_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){$f!==void 0&&b_!==void 0&&this.internal.out("/Names <</JavaScript "+$f+" 0 R>>")}),this},function(n){var e;n.events.push(["postPutResources",function(){var t=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var o=t.outline.render().split(/\r\n/),s=0;s<o.length;s++){var i=o[s],a=r.exec(i);if(a!=null){var A=a[1];t.internal.newObjectDeferredBegin(A,!1)}t.internal.write(i)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,c=[];for(s=0;s<d;s++){var u=t.internal.newObject();c.push(u);var h=t.internal.getPageInfo(s+1);t.internal.write("<< /D["+h.objId+" 0 R /XYZ null null null]>> endobj")}var p=t.internal.newObject();for(t.internal.write("<< /Names [ "),s=0;s<c.length;s++)t.internal.write("(page_"+(s+1)+")"+c[s]+" 0 R");t.internal.write(" ] >>","endobj"),e=t.internal.newObject(),t.internal.write("<< /Dests "+p+" 0 R"),t.internal.write(">>","endobj")}}]),n.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+e+" 0 R"))}]),n.events.push(["initialized",function(){var t=this;t.outline={createNamedDestinations:!1,root:{children:[]}},t.outline.add=function(r,o,s){var i={title:o,options:s,children:[]};return r==null&&(r=this.root),r.children.push(i),i},t.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=t,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},t.outline.genIds_r=function(r){r.id=t.internal.newObjectDeferred();for(var o=0;o<r.children.length;o++)this.genIds_r(r.children[o])},t.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},t.outline.renderItems=function(r){for(var o=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<r.children.length;s++){var i=r.children[s];this.objStart(i),this.line("/Title "+this.makeString(i.title)),this.line("/Parent "+this.makeRef(r)),s>0&&this.line("/Prev "+this.makeRef(r.children[s-1])),s<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[s+1])),i.children.length>0&&(this.line("/First "+this.makeRef(i.children[0])),this.line("/Last "+this.makeRef(i.children[i.children.length-1])));var a=this.count=this.count_r({count:0},i);if(a>0&&this.line("/Count "+a),i.options&&i.options.pageNumber){var A=t.internal.getPageInfo(i.options.pageNumber);this.line("/Dest ["+A.objId+" 0 R /XYZ 0 "+o(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},t.outline.line=function(r){this.ctx.val+=r+`\r
`},t.outline.makeRef=function(r){return r.id+" 0 R"},t.outline.makeString=function(r){return"("+t.internal.pdfEscape(r)+")"},t.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},t.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},t.outline.count_r=function(r,o){for(var s=0;s<o.children.length;s++)r.count++,this.count_r(r,o.children[s]);return r.count}}])}(zr.API),function(n){var e=[192,193,194,195,196,197,198,199];n.processJPEG=function(t,r,o,s,i,a){var A,d=this.decode.DCT_DECODE,c=null;if(typeof t=="string"||this.__addimage__.isArrayBuffer(t)||this.__addimage__.isArrayBufferView(t)){switch(t=i||t,t=this.__addimage__.isArrayBuffer(t)?new Uint8Array(t):t,(A=function(u){for(var h,p=256*u.charCodeAt(4)+u.charCodeAt(5),v=u.length,w={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=p,e.indexOf(u.charCodeAt(y+1))!==-1){h=256*u.charCodeAt(y+5)+u.charCodeAt(y+6),w={width:256*u.charCodeAt(y+7)+u.charCodeAt(y+8),height:h,numcomponents:u.charCodeAt(y+9)};break}p=256*u.charCodeAt(y+2)+u.charCodeAt(y+3)}return w}(t=this.__addimage__.isArrayBufferView(t)?this.__addimage__.arrayBufferToBinaryString(t):t)).numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}c={data:t,width:A.width,height:A.height,colorSpace:a,bitsPerComponent:8,filter:d,index:r,alias:o}}return c}}(zr.API);var $d,Vf,B_,z_,C_,yN=function(){var n,e,t;function r(s){var i,a,A,d,c,u,h,p,v,w,y,B,C,Q;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},u=null;;){switch(i=this.readUInt32(),v=(function(){var k,H;for(H=[],k=0;k<4;++k)H.push(String.fromCharCode(this.data[this.pos++]));return H}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(i);break;case"fcTL":u&&this.animation.frames.push(u),this.pos+=4,u={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},c=this.readUInt16(),d=this.readUInt16()||100,u.delay=1e3*c/d,u.disposeOp=this.data[this.pos++],u.blendOp=this.data[this.pos++],u.data=[];break;case"IDAT":case"fdAT":for(v==="fdAT"&&(this.pos+=4,i-=4),s=(u!=null?u.data:void 0)||this.imgData,B=0;0<=i?B<i:B>i;0<=i?++B:--B)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(A=this.palette.length/3,this.transparency.indexed=this.read(i),this.transparency.indexed.length>A)throw new Error("More transparent colors than palette size");if((w=A-this.transparency.indexed.length)>0)for(C=0;0<=w?C<w:C>w;0<=w?++C:--C)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(i)[0];break;case 2:this.transparency.rgb=this.read(i)}break;case"tEXt":h=(y=this.read(i)).indexOf(0),p=String.fromCharCode.apply(String,y.slice(0,h)),this.text[p]=String.fromCharCode.apply(String,y.slice(h+1));break;case"IEND":return u&&this.animation.frames.push(u),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(Q=this.colorType)===4||Q===6,a=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*a,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=i}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}r.prototype.read=function(s){var i,a;for(a=[],i=0;0<=s?i<s:i>s;0<=s?++i:--i)a.push(this.data[this.pos++]);return a},r.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},r.prototype.decodePixels=function(s){var i=this.pixelBitlength/8,a=new Uint8Array(this.width*this.height*i),A=0,d=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function c(u,h,p,v){var w,y,B,C,Q,k,H,Z,q,N,re,be,L,R,J,se,fe,ie,pe,te,Ce,ne=Math.ceil((d.width-u)/p),ze=Math.ceil((d.height-h)/v),z=d.width==ne&&d.height==ze;for(R=i*ne,be=z?a:new Uint8Array(R*ze),k=s.length,L=0,y=0;L<ze&&A<k;){switch(s[A++]){case 0:for(C=fe=0;fe<R;C=fe+=1)be[y++]=s[A++];break;case 1:for(C=ie=0;ie<R;C=ie+=1)w=s[A++],Q=C<i?0:be[y-i],be[y++]=(w+Q)%256;break;case 2:for(C=pe=0;pe<R;C=pe+=1)w=s[A++],B=(C-C%i)/i,J=L&&be[(L-1)*R+B*i+C%i],be[y++]=(J+w)%256;break;case 3:for(C=te=0;te<R;C=te+=1)w=s[A++],B=(C-C%i)/i,Q=C<i?0:be[y-i],J=L&&be[(L-1)*R+B*i+C%i],be[y++]=(w+Math.floor((Q+J)/2))%256;break;case 4:for(C=Ce=0;Ce<R;C=Ce+=1)w=s[A++],B=(C-C%i)/i,Q=C<i?0:be[y-i],L===0?J=se=0:(J=be[(L-1)*R+B*i+C%i],se=B&&be[(L-1)*R+(B-1)*i+C%i]),H=Q+J-se,Z=Math.abs(H-Q),N=Math.abs(H-J),re=Math.abs(H-se),q=Z<=N&&Z<=re?Q:N<=re?J:se,be[y++]=(w+q)%256;break;default:throw new Error("Invalid filter algorithm: "+s[A-1])}if(!z){var E=((h+L*v)*d.width+u)*i,F=L*R;for(C=0;C<ne;C+=1){for(var I=0;I<i;I+=1)a[E++]=be[F++];E+=(p-1)*i}}L++}}return s=JD(s),d.interlaceMethod==1?(c(0,0,8,8),c(4,0,8,8),c(0,4,4,8),c(2,0,4,4),c(0,2,2,4),c(1,0,2,2),c(0,1,1,2)):c(0,0,1,1),a},r.prototype.decodePalette=function(){var s,i,a,A,d,c,u,h,p;for(a=this.palette,c=this.transparency.indexed||[],d=new Uint8Array((c.length||0)+a.length),A=0,s=0,i=u=0,h=a.length;u<h;i=u+=3)d[A++]=a[i],d[A++]=a[i+1],d[A++]=a[i+2],d[A++]=(p=c[s++])!=null?p:255;return d},r.prototype.copyToImageData=function(s,i){var a,A,d,c,u,h,p,v,w,y,B;if(A=this.colors,w=null,a=this.hasAlphaChannel,this.palette.length&&(w=(B=this._decodedPalette)!=null?B:this._decodedPalette=this.decodePalette(),A=4,a=!0),v=(d=s.data||s).length,u=w||i,c=h=0,A===1)for(;c<v;)p=w?4*i[c/4]:h,y=u[p++],d[c++]=y,d[c++]=y,d[c++]=y,d[c++]=a?u[p++]:255,h=p;else for(;c<v;)p=w?4*i[c/4]:h,d[c++]=u[p++],d[c++]=u[p++],d[c++]=u[p++],d[c++]=a?u[p++]:255,h=p},r.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var o=function(){if(Object.prototype.toString.call(Fr)==="[object Window]"){try{e=Fr.document.createElement("canvas"),t=e.getContext("2d")}catch{return!1}return!0}return!1};return o(),n=function(s){var i;if(o()===!0)return t.width=s.width,t.height=s.height,t.clearRect(0,0,s.width,s.height),t.putImageData(s,0,0),(i=new Image).src=e.toDataURL(),i;throw new Error("This method requires a Browser with Canvas-capability.")},r.prototype.decodeFrames=function(s){var i,a,A,d,c,u,h,p;if(this.animation){for(p=[],a=c=0,u=(h=this.animation.frames).length;c<u;a=++c)i=h[a],A=s.createImageData(i.width,i.height),d=this.decodePixels(new Uint8Array(i.data)),this.copyToImageData(A,d),i.imageData=A,p.push(i.image=n(A));return p}},r.prototype.renderFrame=function(s,i){var a,A,d;return a=(A=this.animation.frames)[i],d=A[i-1],i===0&&s.clearRect(0,0,this.width,this.height),(d!=null?d.disposeOp:void 0)===1?s.clearRect(d.xOffset,d.yOffset,d.width,d.height):(d!=null?d.disposeOp:void 0)===2&&s.putImageData(d.imageData,d.xOffset,d.yOffset),a.blendOp===0&&s.clearRect(a.xOffset,a.yOffset,a.width,a.height),s.drawImage(a.image,a.xOffset,a.yOffset)},r.prototype.animate=function(s){var i,a,A,d,c,u,h=this;return a=0,u=this.animation,d=u.numFrames,A=u.frames,c=u.numPlays,(i=function(){var p,v;if(p=a++%d,v=A[p],h.renderFrame(s,p),d>1&&a/d<c)return h.animation._timeout=setTimeout(i,v.delay)})()},r.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},r.prototype.render=function(s){var i,a;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,i=s.getContext("2d"),this.animation?(this.decodeFrames(i),this.animate(i)):(a=i.createImageData(this.width,this.height),this.copyToImageData(a,this.decodePixels()),i.putImageData(a,0,0))},r}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function _N(n){var e=0;if(n[e++]!==71||n[e++]!==73||n[e++]!==70||n[e++]!==56||(n[e++]+1&253)!=56||n[e++]!==97)throw new Error("Invalid GIF 87a/89a header.");var t=n[e++]|n[e++]<<8,r=n[e++]|n[e++]<<8,o=n[e++],s=o>>7,i=1<<(7&o)+1;n[e++],n[e++];var a=null,A=null;s&&(a=e,A=i,e+=3*i);var d=!0,c=[],u=0,h=null,p=0,v=null;for(this.width=t,this.height=r;d&&e<n.length;)switch(n[e++]){case 33:switch(n[e++]){case 255:if(n[e]!==11||n[e+1]==78&&n[e+2]==69&&n[e+3]==84&&n[e+4]==83&&n[e+5]==67&&n[e+6]==65&&n[e+7]==80&&n[e+8]==69&&n[e+9]==50&&n[e+10]==46&&n[e+11]==48&&n[e+12]==3&&n[e+13]==1&&n[e+16]==0)e+=14,v=n[e++]|n[e++]<<8,e++;else for(e+=12;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;case 249:if(n[e++]!==4||n[e+4]!==0)throw new Error("Invalid graphics extension block.");var w=n[e++];u=n[e++]|n[e++]<<8,h=n[e++],!(1&w)&&(h=null),p=w>>2&7,e++;break;case 254:for(;;){if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}break;default:throw new Error("Unknown graphic control label: 0x"+n[e-1].toString(16))}break;case 44:var y=n[e++]|n[e++]<<8,B=n[e++]|n[e++]<<8,C=n[e++]|n[e++]<<8,Q=n[e++]|n[e++]<<8,k=n[e++],H=k>>6&1,Z=1<<(7&k)+1,q=a,N=A,re=!1;k>>7&&(re=!0,q=e,N=Z,e+=3*Z);var be=e;for(e++;;){var L;if(!((L=n[e++])>=0))throw Error("Invalid block size");if(L===0)break;e+=L}c.push({x:y,y:B,width:C,height:Q,has_local_palette:re,palette_offset:q,palette_size:N,data_offset:be,data_length:e-be,transparent_index:h,interlaced:!!H,delay:u,disposal:p});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+n[e-1].toString(16))}this.numFrames=function(){return c.length},this.loopCount=function(){return v},this.frameInfo=function(R){if(R<0||R>=c.length)throw new Error("Frame index out of range.");return c[R]},this.decodeAndBlitFrameBGRA=function(R,J){var se=this.frameInfo(R),fe=se.width*se.height,ie=new Uint8Array(fe);S_(n,se.data_offset,ie,fe);var pe=se.palette_offset,te=se.transparent_index;te===null&&(te=256);var Ce=se.width,ne=t-Ce,ze=Ce,z=4*(se.y*t+se.x),E=4*((se.y+se.height)*t+se.x),F=z,I=4*ne;se.interlaced===!0&&(I+=4*t*7);for(var O=8,D=0,P=ie.length;D<P;++D){var K=ie[D];if(ze===0&&(ze=Ce,(F+=I)>=E&&(I=4*ne+4*t*(O-1),F=z+(Ce+ne)*(O<<1),O>>=1)),K===te)F+=4;else{var M=n[pe+3*K],ge=n[pe+3*K+1],_e=n[pe+3*K+2];J[F++]=_e,J[F++]=ge,J[F++]=M,J[F++]=255}--ze}},this.decodeAndBlitFrameRGBA=function(R,J){var se=this.frameInfo(R),fe=se.width*se.height,ie=new Uint8Array(fe);S_(n,se.data_offset,ie,fe);var pe=se.palette_offset,te=se.transparent_index;te===null&&(te=256);var Ce=se.width,ne=t-Ce,ze=Ce,z=4*(se.y*t+se.x),E=4*((se.y+se.height)*t+se.x),F=z,I=4*ne;se.interlaced===!0&&(I+=4*t*7);for(var O=8,D=0,P=ie.length;D<P;++D){var K=ie[D];if(ze===0&&(ze=Ce,(F+=I)>=E&&(I=4*ne+4*t*(O-1),F=z+(Ce+ne)*(O<<1),O>>=1)),K===te)F+=4;else{var M=n[pe+3*K],ge=n[pe+3*K+1],_e=n[pe+3*K+2];J[F++]=M,J[F++]=ge,J[F++]=_e,J[F++]=255}--ze}}}function S_(n,e,t,r){for(var o=n[e++],s=1<<o,i=s+1,a=i+1,A=o+1,d=(1<<A)-1,c=0,u=0,h=0,p=n[e++],v=new Int32Array(4096),w=null;;){for(;c<16&&p!==0;)u|=n[e++]<<c,c+=8,p===1?p=n[e++]:--p;if(c<A)break;var y=u&d;if(u>>=A,c-=A,y!==s){if(y===i)break;for(var B=y<a?y:w,C=0,Q=B;Q>s;)Q=v[Q]>>8,++C;var k=Q;if(h+C+(B!==y?1:0)>r)return void Hn.log("Warning, gif stream longer than expected.");t[h++]=k;var H=h+=C;for(B!==y&&(t[h++]=k),Q=B;C--;)Q=v[Q],t[--H]=255&Q,Q>>=8;w!==null&&a<4096&&(v[a++]=w<<8|k,a>=d+1&&A<12&&(++A,d=d<<1|1)),w=y}else a=i+1,d=(1<<(A=o+1))-1,w=null}return h!==r&&Hn.log("Warning, gif stream shorter than expected."),t}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function l0(n){var e,t,r,o,s,i=Math.floor,a=new Array(64),A=new Array(64),d=new Array(64),c=new Array(64),u=new Array(65535),h=new Array(65535),p=new Array(64),v=new Array(64),w=[],y=0,B=7,C=new Array(64),Q=new Array(64),k=new Array(64),H=new Array(256),Z=new Array(2048),q=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],N=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],re=[0,1,2,3,4,5,6,7,8,9,10,11],be=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],L=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],R=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],J=[0,1,2,3,4,5,6,7,8,9,10,11],se=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],fe=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function ie(z,E){for(var F=0,I=0,O=new Array,D=1;D<=16;D++){for(var P=1;P<=z[D];P++)O[E[I]]=[],O[E[I]][0]=F,O[E[I]][1]=D,I++,F++;F*=2}return O}function pe(z){for(var E=z[0],F=z[1]-1;F>=0;)E&1<<F&&(y|=1<<B),F--,--B<0&&(y==255?(te(255),te(0)):te(y),B=7,y=0)}function te(z){w.push(z)}function Ce(z){te(z>>8&255),te(255&z)}function ne(z,E,F,I,O){for(var D,P=O[0],K=O[240],M=function(ue,me){var ye,Ee,de,Qe,Fe,Oe,Te,De,ce,Ie,V=0;for(ce=0;ce<8;++ce){ye=ue[V],Ee=ue[V+1],de=ue[V+2],Qe=ue[V+3],Fe=ue[V+4],Oe=ue[V+5],Te=ue[V+6];var G=ye+(De=ue[V+7]),le=ye-De,Le=Ee+Te,He=Ee-Te,je=de+Oe,xe=de-Oe,Re=Qe+Fe,et=Qe-Fe,qe=G+Re,ot=G-Re,Pe=Le+je,Ye=Le-je;ue[V]=qe+Pe,ue[V+4]=qe-Pe;var rt=.707106781*(Ye+ot);ue[V+2]=ot+rt,ue[V+6]=ot-rt;var lt=.382683433*((qe=et+xe)-(Ye=He+le)),vt=.5411961*qe+lt,Ft=1.306562965*Ye+lt,Qt=.707106781*(Pe=xe+He),Et=le+Qt,mt=le-Qt;ue[V+5]=mt+vt,ue[V+3]=mt-vt,ue[V+1]=Et+Ft,ue[V+7]=Et-Ft,V+=8}for(V=0,ce=0;ce<8;++ce){ye=ue[V],Ee=ue[V+8],de=ue[V+16],Qe=ue[V+24],Fe=ue[V+32],Oe=ue[V+40],Te=ue[V+48];var Gt=ye+(De=ue[V+56]),Ht=ye-De,Ut=Ee+Te,st=Ee-Te,pt=de+Oe,_t=de-Oe,$t=Qe+Fe,Rt=Qe-Fe,Ot=Gt+$t,Ct=Gt-$t,Wt=Ut+pt,It=Ut-pt;ue[V]=Ot+Wt,ue[V+32]=Ot-Wt;var St=.707106781*(It+Ct);ue[V+16]=Ct+St,ue[V+48]=Ct-St;var jt=.382683433*((Ot=Rt+_t)-(It=st+Ht)),dr=.5411961*Ot+jt,pr=1.306562965*It+jt,ar=.707106781*(Wt=_t+st),ur=Ht+ar,Ir=Ht-ar;ue[V+40]=Ir+dr,ue[V+24]=Ir-dr,ue[V+8]=ur+pr,ue[V+56]=ur-pr,V++}for(ce=0;ce<64;++ce)Ie=ue[ce]*me[ce],p[ce]=Ie>0?Ie+.5|0:Ie-.5|0;return p}(z,E),ge=0;ge<64;++ge)v[q[ge]]=M[ge];var _e=v[0]-F;F=v[0],_e==0?pe(I[0]):(pe(I[h[D=32767+_e]]),pe(u[D]));for(var Me=63;Me>0&&v[Me]==0;)Me--;if(Me==0)return pe(P),F;for(var $e,Y=1;Y<=Me;){for(var j=Y;v[Y]==0&&Y<=Me;)++Y;var ee=Y-j;if(ee>=16){$e=ee>>4;for(var ae=1;ae<=$e;++ae)pe(K);ee&=15}D=32767+v[Y],pe(O[(ee<<4)+h[D]]),pe(u[D]),Y++}return Me!=63&&pe(P),F}function ze(z){z=Math.min(Math.max(z,1),100),s!=z&&(function(E){for(var F=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],I=0;I<64;I++){var O=i((F[I]*E+50)/100);O=Math.min(Math.max(O,1),255),a[q[I]]=O}for(var D=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],P=0;P<64;P++){var K=i((D[P]*E+50)/100);K=Math.min(Math.max(K,1),255),A[q[P]]=K}for(var M=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ge=0,_e=0;_e<8;_e++)for(var Me=0;Me<8;Me++)d[ge]=1/(a[q[ge]]*M[_e]*M[Me]*8),c[ge]=1/(A[q[ge]]*M[_e]*M[Me]*8),ge++}(z<50?Math.floor(5e3/z):Math.floor(200-2*z)),s=z)}this.encode=function(z,E){E&&ze(E),w=new Array,y=0,B=7,Ce(65496),Ce(65504),Ce(16),te(74),te(70),te(73),te(70),te(0),te(1),te(1),te(0),Ce(1),Ce(1),te(0),te(0),function(){Ce(65499),Ce(132),te(0);for(var Ee=0;Ee<64;Ee++)te(a[Ee]);te(1);for(var de=0;de<64;de++)te(A[de])}(),function(Ee,de){Ce(65472),Ce(17),te(8),Ce(de),Ce(Ee),te(3),te(1),te(17),te(0),te(2),te(17),te(1),te(3),te(17),te(1)}(z.width,z.height),function(){Ce(65476),Ce(418),te(0);for(var Ee=0;Ee<16;Ee++)te(N[Ee+1]);for(var de=0;de<=11;de++)te(re[de]);te(16);for(var Qe=0;Qe<16;Qe++)te(be[Qe+1]);for(var Fe=0;Fe<=161;Fe++)te(L[Fe]);te(1);for(var Oe=0;Oe<16;Oe++)te(R[Oe+1]);for(var Te=0;Te<=11;Te++)te(J[Te]);te(17);for(var De=0;De<16;De++)te(se[De+1]);for(var ce=0;ce<=161;ce++)te(fe[ce])}(),Ce(65498),Ce(12),te(3),te(1),te(0),te(2),te(17),te(3),te(17),te(0),te(63),te(0);var F=0,I=0,O=0;y=0,B=7,this.encode.displayName="_encode_";for(var D,P,K,M,ge,_e,Me,$e,Y,j=z.data,ee=z.width,ae=z.height,ue=4*ee,me=0;me<ae;){for(D=0;D<ue;){for(ge=ue*me+D,Me=-1,$e=0,Y=0;Y<64;Y++)_e=ge+($e=Y>>3)*ue+(Me=4*(7&Y)),me+$e>=ae&&(_e-=ue*(me+1+$e-ae)),D+Me>=ue&&(_e-=D+Me-ue+4),P=j[_e++],K=j[_e++],M=j[_e++],C[Y]=(Z[P]+Z[K+256>>0]+Z[M+512>>0]>>16)-128,Q[Y]=(Z[P+768>>0]+Z[K+1024>>0]+Z[M+1280>>0]>>16)-128,k[Y]=(Z[P+1280>>0]+Z[K+1536>>0]+Z[M+1792>>0]>>16)-128;F=ne(C,d,F,e,r),I=ne(Q,c,I,t,o),O=ne(k,c,O,t,o),D+=32}me+=8}if(B>=0){var ye=[];ye[1]=B+1,ye[0]=(1<<B+1)-1,pe(ye)}return Ce(65497),new Uint8Array(w)},n=n||50,function(){for(var z=String.fromCharCode,E=0;E<256;E++)H[E]=z(E)}(),e=ie(N,re),t=ie(R,J),r=ie(be,L),o=ie(se,fe),function(){for(var z=1,E=2,F=1;F<=15;F++){for(var I=z;I<E;I++)h[32767+I]=F,u[32767+I]=[],u[32767+I][1]=F,u[32767+I][0]=I;for(var O=-(E-1);O<=-z;O++)h[32767+O]=F,u[32767+O]=[],u[32767+O][1]=F,u[32767+O][0]=E-1+O;z<<=1,E<<=1}}(),function(){for(var z=0;z<256;z++)Z[z]=19595*z,Z[z+256>>0]=38470*z,Z[z+512>>0]=7471*z+32768,Z[z+768>>0]=-11059*z,Z[z+1024>>0]=-21709*z,Z[z+1280>>0]=32768*z+8421375,Z[z+1536>>0]=-27439*z,Z[z+1792>>0]=-5329*z}(),ze(n)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Wi(n,e){if(this.pos=0,this.buffer=n,this.datav=new DataView(n.buffer),this.is_with_alpha=!!e,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function E_(n){function e(N){if(!N)throw Error("assert :P")}function t(N,re,be){for(var L=0;4>L;L++)if(N[re+L]!=be.charCodeAt(L))return!0;return!1}function r(N,re,be,L,R){for(var J=0;J<R;J++)N[re+J]=be[L+J]}function o(N,re,be,L){for(var R=0;R<L;R++)N[re+R]=be}function s(N){return new Int32Array(N)}function i(N,re){for(var be=[],L=0;L<N;L++)be.push(new re);return be}function a(N,re){var be=[];return function L(R,J,se){for(var fe=se[J],ie=0;ie<fe&&(R.push(se.length>J+1?[]:new re),!(se.length<J+1));ie++)L(R[ie],J+1,se)}(be,0,N),be}var A=function(){var N=this;function re(f,m){for(var S=1<<m-1>>>0;f&S;)S>>>=1;return S?(f&S-1)+S:f}function be(f,m,S,T,X){e(!(T%S));do f[m+(T-=S)]=X;while(0<T)}function L(f,m,S,T,X){if(e(2328>=X),512>=X)var oe=s(512);else if((oe=s(X))==null)return 0;return function(Ae,he,we,Ue,Ge,ct){var ut,tt,Pt=he,xt=1<<we,We=s(16),Ze=s(16);for(e(Ge!=0),e(Ue!=null),e(Ae!=null),e(0<we),tt=0;tt<Ge;++tt){if(15<Ue[tt])return 0;++We[Ue[tt]]}if(We[0]==Ge)return 0;for(Ze[1]=0,ut=1;15>ut;++ut){if(We[ut]>1<<ut)return 0;Ze[ut+1]=Ze[ut]+We[ut]}for(tt=0;tt<Ge;++tt)ut=Ue[tt],0<Ue[tt]&&(ct[Ze[ut]++]=tt);if(Ze[15]==1)return(Ue=new R).g=0,Ue.value=ct[0],be(Ae,Pt,1,xt,Ue),xt;var Tt,Mt=-1,Lt=xt-1,or=0,Xt=1,_r=1,Jt=1<<we;for(tt=0,ut=1,Ge=2;ut<=we;++ut,Ge<<=1){if(Xt+=_r<<=1,0>(_r-=We[ut]))return 0;for(;0<We[ut];--We[ut])(Ue=new R).g=ut,Ue.value=ct[tt++],be(Ae,Pt+or,Ge,Jt,Ue),or=re(or,ut)}for(ut=we+1,Ge=2;15>=ut;++ut,Ge<<=1){if(Xt+=_r<<=1,0>(_r-=We[ut]))return 0;for(;0<We[ut];--We[ut]){if(Ue=new R,(or&Lt)!=Mt){for(Pt+=Jt,Tt=1<<(Mt=ut)-we;15>Mt&&!(0>=(Tt-=We[Mt]));)++Mt,Tt<<=1;xt+=Jt=1<<(Tt=Mt-we),Ae[he+(Mt=or&Lt)].g=Tt+we,Ae[he+Mt].value=Pt-he-Mt}Ue.g=ut-we,Ue.value=ct[tt++],be(Ae,Pt+(or>>we),Ge,Jt,Ue),or=re(or,ut)}}return Xt!=2*Ze[15]-1?0:xt}(f,m,S,T,X,oe)}function R(){this.value=this.g=0}function J(){this.value=this.g=0}function se(){this.G=i(5,R),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=i(_o,J)}function fe(f,m,S,T){e(f!=null),e(m!=null),e(2147483648>T),f.Ca=254,f.I=0,f.b=-8,f.Ka=0,f.oa=m,f.pa=S,f.Jd=m,f.Yc=S+T,f.Zc=4<=T?S+T-4+1:S,D(f)}function ie(f,m){for(var S=0;0<m--;)S|=K(f,128)<<m;return S}function pe(f,m){var S=ie(f,m);return P(f)?-S:S}function te(f,m,S,T){var X,oe=0;for(e(f!=null),e(m!=null),e(4294967288>T),f.Sb=T,f.Ra=0,f.u=0,f.h=0,4<T&&(T=4),X=0;X<T;++X)oe+=m[S+X]<<8*X;f.Ra=oe,f.bb=T,f.oa=m,f.pa=S}function Ce(f){for(;8<=f.u&&f.bb<f.Sb;)f.Ra>>>=8,f.Ra+=f.oa[f.pa+f.bb]<<xn-8>>>0,++f.bb,f.u-=8;F(f)&&(f.h=1,f.u=0)}function ne(f,m){if(e(0<=m),!f.h&&m<=un){var S=E(f)&Nr[m];return f.u+=m,Ce(f),S}return f.h=1,f.u=0}function ze(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function E(f){return f.Ra>>>(f.u&xn-1)>>>0}function F(f){return e(f.bb<=f.Sb),f.h||f.bb==f.Sb&&f.u>xn}function I(f,m){f.u=m,f.h=F(f)}function O(f){f.u>=Ho&&(e(f.u>=Ho),Ce(f))}function D(f){e(f!=null&&f.oa!=null),f.pa<f.Zc?(f.I=(f.oa[f.pa++]|f.I<<8)>>>0,f.b+=8):(e(f!=null&&f.oa!=null),f.pa<f.Yc?(f.b+=8,f.I=f.oa[f.pa++]|f.I<<8):f.Ka?f.b=0:(f.I<<=8,f.b+=8,f.Ka=1))}function P(f){return ie(f,1)}function K(f,m){var S=f.Ca;0>f.b&&D(f);var T=f.b,X=S*m>>>8,oe=(f.I>>>T>X)+0;for(oe?(S-=X,f.I-=X+1<<T>>>0):S=X+1,T=S,X=0;256<=T;)X+=8,T>>=8;return T=7^X+$n[T],f.b-=T,f.Ca=(S<<T)-1,oe}function M(f,m,S){f[m+0]=S>>24&255,f[m+1]=S>>16&255,f[m+2]=S>>8&255,f[m+3]=S>>0&255}function ge(f,m){return f[m+0]<<0|f[m+1]<<8}function _e(f,m){return ge(f,m)|f[m+2]<<16}function Me(f,m){return ge(f,m)|ge(f,m+2)<<16}function $e(f,m){var S=1<<m;return e(f!=null),e(0<m),f.X=s(S),f.X==null?0:(f.Mb=32-m,f.Xa=m,1)}function Y(f,m){e(f!=null),e(m!=null),e(f.Xa==m.Xa),r(m.X,0,f.X,0,1<<m.Xa)}function j(){this.X=[],this.Xa=this.Mb=0}function ee(f,m,S,T){e(S!=null),e(T!=null);var X=S[0],oe=T[0];return X==0&&(X=(f*oe+m/2)/m),oe==0&&(oe=(m*X+f/2)/f),0>=X||0>=oe?0:(S[0]=X,T[0]=oe,1)}function ae(f,m){return f+(1<<m)-1>>>m}function ue(f,m){return((4278255360&f)+(4278255360&m)>>>0&4278255360)+((16711935&f)+(16711935&m)>>>0&16711935)>>>0}function me(f,m){N[m]=function(S,T,X,oe,Ae,he,we){var Ue;for(Ue=0;Ue<Ae;++Ue){var Ge=N[f](he[we+Ue-1],X,oe+Ue);he[we+Ue]=ue(S[T+Ue],Ge)}}}function ye(){this.ud=this.hd=this.jd=0}function Ee(f,m){return((4278124286&(f^m))>>>1)+(f&m)>>>0}function de(f){return 0<=f&&256>f?f:0>f?0:255<f?255:void 0}function Qe(f,m){return de(f+(f-m+.5>>1))}function Fe(f,m,S){return Math.abs(m-S)-Math.abs(f-S)}function Oe(f,m,S,T,X,oe,Ae){for(T=oe[Ae-1],S=0;S<X;++S)oe[Ae+S]=T=ue(f[m+S],T)}function Te(f,m,S,T,X){var oe;for(oe=0;oe<S;++oe){var Ae=f[m+oe],he=Ae>>8&255,we=16711935&(we=(we=16711935&Ae)+((he<<16)+he));T[X+oe]=(4278255360&Ae)+we>>>0}}function De(f,m){m.jd=f>>0&255,m.hd=f>>8&255,m.ud=f>>16&255}function ce(f,m,S,T,X,oe){var Ae;for(Ae=0;Ae<T;++Ae){var he=m[S+Ae],we=he>>>8,Ue=he,Ge=255&(Ge=(Ge=he>>>16)+((f.jd<<24>>24)*(we<<24>>24)>>>5));Ue=255&(Ue=(Ue=Ue+((f.hd<<24>>24)*(we<<24>>24)>>>5))+((f.ud<<24>>24)*(Ge<<24>>24)>>>5)),X[oe+Ae]=(4278255360&he)+(Ge<<16)+Ue}}function Ie(f,m,S,T,X){N[m]=function(oe,Ae,he,we,Ue,Ge,ct,ut,tt){for(we=ct;we<ut;++we)for(ct=0;ct<tt;++ct)Ue[Ge++]=X(he[T(oe[Ae++])])},N[f]=function(oe,Ae,he,we,Ue,Ge,ct){var ut=8>>oe.b,tt=oe.Ea,Pt=oe.K[0],xt=oe.w;if(8>ut)for(oe=(1<<oe.b)-1,xt=(1<<ut)-1;Ae<he;++Ae){var We,Ze=0;for(We=0;We<tt;++We)We&oe||(Ze=T(we[Ue++])),Ge[ct++]=X(Pt[Ze&xt]),Ze>>=ut}else N["VP8LMapColor"+S](we,Ue,Pt,xt,Ge,ct,Ae,he,tt)}}function V(f,m,S,T,X){for(S=m+S;m<S;){var oe=f[m++];T[X++]=oe>>16&255,T[X++]=oe>>8&255,T[X++]=oe>>0&255}}function G(f,m,S,T,X){for(S=m+S;m<S;){var oe=f[m++];T[X++]=oe>>16&255,T[X++]=oe>>8&255,T[X++]=oe>>0&255,T[X++]=oe>>24&255}}function le(f,m,S,T,X){for(S=m+S;m<S;){var oe=(Ae=f[m++])>>16&240|Ae>>12&15,Ae=Ae>>0&240|Ae>>28&15;T[X++]=oe,T[X++]=Ae}}function Le(f,m,S,T,X){for(S=m+S;m<S;){var oe=(Ae=f[m++])>>16&248|Ae>>13&7,Ae=Ae>>5&224|Ae>>3&31;T[X++]=oe,T[X++]=Ae}}function He(f,m,S,T,X){for(S=m+S;m<S;){var oe=f[m++];T[X++]=oe>>0&255,T[X++]=oe>>8&255,T[X++]=oe>>16&255}}function je(f,m,S,T,X,oe){if(oe==0)for(S=m+S;m<S;)M(T,((oe=f[m++])[0]>>24|oe[1]>>8&65280|oe[2]<<8&16711680|oe[3]<<24)>>>0),X+=32;else r(T,X,f,m,S)}function xe(f,m){N[m][0]=N[f+"0"],N[m][1]=N[f+"1"],N[m][2]=N[f+"2"],N[m][3]=N[f+"3"],N[m][4]=N[f+"4"],N[m][5]=N[f+"5"],N[m][6]=N[f+"6"],N[m][7]=N[f+"7"],N[m][8]=N[f+"8"],N[m][9]=N[f+"9"],N[m][10]=N[f+"10"],N[m][11]=N[f+"11"],N[m][12]=N[f+"12"],N[m][13]=N[f+"13"],N[m][14]=N[f+"0"],N[m][15]=N[f+"0"]}function Re(f){return f==Jg||f==Zg||f==Eh||f==ev}function et(){this.eb=[],this.size=this.A=this.fb=0}function qe(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ot(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new et,this.f.kb=new qe,this.sd=null}function Pe(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ye(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function rt(f){return alert("todo:WebPSamplerProcessPlane"),f.T}function lt(f,m){var S=f.T,T=m.ba.f.RGBA,X=T.eb,oe=T.fb+f.ka*T.A,Ae=Qi[m.ba.S],he=f.y,we=f.O,Ue=f.f,Ge=f.N,ct=f.ea,ut=f.W,tt=m.cc,Pt=m.dc,xt=m.Mc,We=m.Nc,Ze=f.ka,Tt=f.ka+f.T,Mt=f.U,Lt=Mt+1>>1;for(Ze==0?Ae(he,we,null,null,Ue,Ge,ct,ut,Ue,Ge,ct,ut,X,oe,null,null,Mt):(Ae(m.ec,m.fc,he,we,tt,Pt,xt,We,Ue,Ge,ct,ut,X,oe-T.A,X,oe,Mt),++S);Ze+2<Tt;Ze+=2)tt=Ue,Pt=Ge,xt=ct,We=ut,Ge+=f.Rc,ut+=f.Rc,oe+=2*T.A,Ae(he,(we+=2*f.fa)-f.fa,he,we,tt,Pt,xt,We,Ue,Ge,ct,ut,X,oe-T.A,X,oe,Mt);return we+=f.fa,f.j+Tt<f.o?(r(m.ec,m.fc,he,we,Mt),r(m.cc,m.dc,Ue,Ge,Lt),r(m.Mc,m.Nc,ct,ut,Lt),S--):1&Tt||Ae(he,we,null,null,Ue,Ge,ct,ut,Ue,Ge,ct,ut,X,oe+T.A,null,null,Mt),S}function vt(f,m,S){var T=f.F,X=[f.J];if(T!=null){var oe=f.U,Ae=m.ba.S,he=Ae==Sh||Ae==Eh;m=m.ba.f.RGBA;var we=[0],Ue=f.ka;we[0]=f.T,f.Kb&&(Ue==0?--we[0]:(--Ue,X[0]-=f.width),f.j+f.ka+f.T==f.o&&(we[0]=f.o-f.j-Ue));var Ge=m.eb;Ue=m.fb+Ue*m.A,f=Gn(T,X[0],f.width,oe,we,Ge,Ue+(he?0:3),m.A),e(S==we),f&&Re(Ae)&&Ii(Ge,Ue,he,oe,we,m.A)}return 0}function Ft(f){var m=f.ma,S=m.ba.S,T=11>S,X=S==zh||S==Ch||S==Sh||S==Yg||S==12||Re(S);if(m.memory=null,m.Ib=null,m.Jb=null,m.Nd=null,!Ao(m.Oa,f,X?11:12))return 0;if(X&&Re(S)&&Nt(),f.da)alert("todo:use_scaling");else{if(T){if(m.Ib=rt,f.Kb){if(S=f.U+1>>1,m.memory=s(f.U+2*S),m.memory==null)return 0;m.ec=m.memory,m.fc=0,m.cc=m.ec,m.dc=m.fc+f.U,m.Mc=m.cc,m.Nc=m.dc+S,m.Ib=lt,Nt()}}else alert("todo:EmitYUV");X&&(m.Jb=vt,T&&nt())}if(T&&!x2){for(f=0;256>f;++f)zC[f]=89858*(f-128)+Ih>>Fh,EC[f]=-22014*(f-128)+Ih,SC[f]=-45773*(f-128),CC[f]=113618*(f-128)+Ih>>Fh;for(f=Xc;f<nv;++f)m=76283*(f-16)+Ih>>Fh,FC[f-Xc]=ss(m,255),IC[f-Xc]=ss(m+8>>4,15);x2=1}return 1}function Qt(f){var m=f.ma,S=f.U,T=f.T;return e(!(1&f.ka)),0>=S||0>=T?0:(S=m.Ib(f,m),m.Jb!=null&&m.Jb(f,m,S),m.Dc+=S,1)}function Et(f){f.ma.memory=null}function mt(f,m,S,T){return ne(f,8)!=47?0:(m[0]=ne(f,14)+1,S[0]=ne(f,14)+1,T[0]=ne(f,1),ne(f,3)!=0?0:!f.h)}function Gt(f,m){if(4>f)return f+1;var S=f-2>>1;return(2+(1&f)<<S)+ne(m,S)+1}function Ht(f,m){return 120<m?m-120:1<=(S=((S=cC[m-1])>>4)*f+(8-(15&S)))?S:1;var S}function Ut(f,m,S){var T=E(S),X=f[m+=255&T].g-8;return 0<X&&(I(S,S.u+8),T=E(S),m+=f[m].value,m+=T&(1<<X)-1),I(S,S.u+f[m].g),f[m].value}function st(f,m,S){return S.g+=f.g,S.value+=f.value<<m>>>0,e(8>=S.g),f.g}function pt(f,m,S){var T=f.xc;return e((m=T==0?0:f.vc[f.md*(S>>T)+(m>>T)])<f.Wb),f.Ya[m]}function _t(f,m,S,T){var X=f.ab,oe=f.c*m,Ae=f.C;m=Ae+m;var he=S,we=T;for(T=f.Ta,S=f.Ua;0<X--;){var Ue=f.gc[X],Ge=Ae,ct=m,ut=he,tt=we,Pt=(we=T,he=S,Ue.Ea);switch(e(Ge<ct),e(ct<=Ue.nc),Ue.hc){case 2:ci(ut,tt,(ct-Ge)*Pt,we,he);break;case 0:var xt=Ge,We=ct,Ze=we,Tt=he,Mt=(Jt=Ue).Ea;xt==0&&(jo(ut,tt,null,null,1,Ze,Tt),Oe(ut,tt+1,0,0,Mt-1,Ze,Tt+1),tt+=Mt,Tt+=Mt,++xt);for(var Lt=1<<Jt.b,or=Lt-1,Xt=ae(Mt,Jt.b),_r=Jt.K,Jt=Jt.w+(xt>>Jt.b)*Xt;xt<We;){var _n=_r,Qn=Jt,vn=1;for(lo(ut,tt,Ze,Tt-Mt,1,Ze,Tt);vn<Mt;){var rn=(vn&~or)+Lt;rn>Mt&&(rn=Mt),(0,xa[_n[Qn++]>>8&15])(ut,tt+ +vn,Ze,Tt+vn-Mt,rn-vn,Ze,Tt+vn),vn=rn}tt+=Mt,Tt+=Mt,++xt&or||(Jt+=Xt)}ct!=Ue.nc&&r(we,he-Pt,we,he+(ct-Ge-1)*Pt,Pt);break;case 1:for(Pt=ut,We=tt,Mt=(ut=Ue.Ea)-(Tt=ut&~(Ze=(tt=1<<Ue.b)-1)),xt=ae(ut,Ue.b),Lt=Ue.K,Ue=Ue.w+(Ge>>Ue.b)*xt;Ge<ct;){for(or=Lt,Xt=Ue,_r=new ye,Jt=We+Tt,_n=We+ut;We<Jt;)De(or[Xt++],_r),tA(_r,Pt,We,tt,we,he),We+=tt,he+=tt;We<_n&&(De(or[Xt++],_r),tA(_r,Pt,We,Mt,we,he),We+=Mt,he+=Mt),++Ge&Ze||(Ue+=xt)}break;case 3:if(ut==we&&tt==he&&0<Ue.b){for(We=we,ut=Pt=he+(ct-Ge)*Pt-(Tt=(ct-Ge)*ae(Ue.Ea,Ue.b)),tt=we,Ze=he,xt=[],Tt=(Mt=Tt)-1;0<=Tt;--Tt)xt[Tt]=tt[Ze+Tt];for(Tt=Mt-1;0<=Tt;--Tt)We[ut+Tt]=xt[Tt];Yo(Ue,Ge,ct,we,Pt,we,he)}else Yo(Ue,Ge,ct,ut,tt,we,he)}he=T,we=S}we!=S&&r(T,S,he,we,oe)}function $t(f,m){var S=f.V,T=f.Ba+f.c*f.C,X=m-f.C;if(e(m<=f.l.o),e(16>=X),0<X){var oe=f.l,Ae=f.Ta,he=f.Ua,we=oe.width;if(_t(f,X,S,T),X=he=[he],e((S=f.C)<(T=m)),e(oe.v<oe.va),T>oe.o&&(T=oe.o),S<oe.j){var Ue=oe.j-S;S=oe.j,X[0]+=Ue*we}if(S>=T?S=0:(X[0]+=4*oe.v,oe.ka=S-oe.j,oe.U=oe.va-oe.v,oe.T=T-S,S=1),S){if(he=he[0],11>(S=f.ca).S){var Ge=S.f.RGBA,ct=(T=S.S,X=oe.U,oe=oe.T,Ue=Ge.eb,Ge.A),ut=oe;for(Ge=Ge.fb+f.Ma*Ge.A;0<ut--;){var tt=Ae,Pt=he,xt=X,We=Ue,Ze=Ge;switch(T){case Bh:as(tt,Pt,xt,We,Ze);break;case zh:As(tt,Pt,xt,We,Ze);break;case Jg:As(tt,Pt,xt,We,Ze),Ii(We,Ze,0,xt,1,0);break;case f2:ui(tt,Pt,xt,We,Ze);break;case Ch:je(tt,Pt,xt,We,Ze,1);break;case Zg:je(tt,Pt,xt,We,Ze,1),Ii(We,Ze,0,xt,1,0);break;case Sh:je(tt,Pt,xt,We,Ze,0);break;case Eh:je(tt,Pt,xt,We,Ze,0),Ii(We,Ze,1,xt,1,0);break;case Yg:Us(tt,Pt,xt,We,Ze);break;case ev:Us(tt,Pt,xt,We,Ze),Vn(We,Ze,xt,1,0);break;case p2:ls(tt,Pt,xt,We,Ze);break;default:e(0)}he+=we,Ge+=ct}f.Ma+=oe}else alert("todo:EmitRescaledRowsYUVA");e(f.Ma<=S.height)}}f.C=m,e(f.C<=f.i)}function Rt(f){var m;if(0<f.ua)return 0;for(m=0;m<f.Wb;++m){var S=f.Ya[m].G,T=f.Ya[m].H;if(0<S[1][T[1]+0].g||0<S[2][T[2]+0].g||0<S[3][T[3]+0].g)return 0}return 1}function Ot(f,m,S,T,X,oe){if(f.Z!=0){var Ae=f.qd,he=f.rd;for(e(DA[f.Z]!=null);m<S;++m)DA[f.Z](Ae,he,T,X,T,X,oe),Ae=T,he=X,X+=oe;f.qd=Ae,f.rd=he}}function Ct(f,m){var S=f.l.ma,T=S.Z==0||S.Z==1?f.l.j:f.C;if(T=f.C<T?T:f.C,e(m<=f.l.o),m>T){var X=f.l.width,oe=S.ca,Ae=S.tb+X*T,he=f.V,we=f.Ba+f.c*T,Ue=f.gc;e(f.ab==1),e(Ue[0].hc==3),xl(Ue[0],T,m,he,we,oe,Ae),Ot(S,T,m,oe,Ae,X)}f.C=f.Ma=m}function Wt(f,m,S,T,X,oe,Ae){var he=f.$/T,we=f.$%T,Ue=f.m,Ge=f.s,ct=S+f.$,ut=ct;X=S+T*X;var tt=S+T*oe,Pt=280+Ge.ua,xt=f.Pb?he:16777216,We=0<Ge.ua?Ge.Wa:null,Ze=Ge.wc,Tt=ct<tt?pt(Ge,we,he):null;e(f.C<oe),e(tt<=X);var Mt=!1;e:for(;;){for(;Mt||ct<tt;){var Lt=0;if(he>=xt){var or=ct-S;e((xt=f).Pb),xt.wd=xt.m,xt.xd=or,0<xt.s.ua&&Y(xt.s.Wa,xt.s.vb),xt=he+hC}if(we&Ze||(Tt=pt(Ge,we,he)),e(Tt!=null),Tt.Qb&&(m[ct]=Tt.qb,Mt=!0),!Mt)if(O(Ue),Tt.jc){Lt=Ue,or=m;var Xt=ct,_r=Tt.pd[E(Lt)&_o-1];e(Tt.jc),256>_r.g?(I(Lt,Lt.u+_r.g),or[Xt]=_r.value,Lt=0):(I(Lt,Lt.u+_r.g-256),e(256<=_r.value),Lt=_r.value),Lt==0&&(Mt=!0)}else Lt=Ut(Tt.G[0],Tt.H[0],Ue);if(Ue.h)break;if(Mt||256>Lt){if(!Mt)if(Tt.nd)m[ct]=(Tt.qb|Lt<<8)>>>0;else{if(O(Ue),Mt=Ut(Tt.G[1],Tt.H[1],Ue),O(Ue),or=Ut(Tt.G[2],Tt.H[2],Ue),Xt=Ut(Tt.G[3],Tt.H[3],Ue),Ue.h)break;m[ct]=(Xt<<24|Mt<<16|Lt<<8|or)>>>0}if(Mt=!1,++ct,++we>=T&&(we=0,++he,Ae!=null&&he<=oe&&!(he%16)&&Ae(f,he),We!=null))for(;ut<ct;)Lt=m[ut++],We.X[(506832829*Lt&4294967295)>>>We.Mb]=Lt}else if(280>Lt){if(Lt=Gt(Lt-256,Ue),or=Ut(Tt.G[4],Tt.H[4],Ue),O(Ue),or=Ht(T,or=Gt(or,Ue)),Ue.h)break;if(ct-S<or||X-ct<Lt)break e;for(Xt=0;Xt<Lt;++Xt)m[ct+Xt]=m[ct+Xt-or];for(ct+=Lt,we+=Lt;we>=T;)we-=T,++he,Ae!=null&&he<=oe&&!(he%16)&&Ae(f,he);if(e(ct<=X),we&Ze&&(Tt=pt(Ge,we,he)),We!=null)for(;ut<ct;)Lt=m[ut++],We.X[(506832829*Lt&4294967295)>>>We.Mb]=Lt}else{if(!(Lt<Pt))break e;for(Mt=Lt-280,e(We!=null);ut<ct;)Lt=m[ut++],We.X[(506832829*Lt&4294967295)>>>We.Mb]=Lt;Lt=ct,e(!(Mt>>>(or=We).Xa)),m[Lt]=or.X[Mt],Mt=!0}Mt||e(Ue.h==F(Ue))}if(f.Pb&&Ue.h&&ct<X)e(f.m.h),f.a=5,f.m=f.wd,f.$=f.xd,0<f.s.ua&&Y(f.s.vb,f.s.Wa);else{if(Ue.h)break e;Ae!=null&&Ae(f,he>oe?oe:he),f.a=0,f.$=ct-S}return 1}return f.a=3,0}function It(f){e(f!=null),f.vc=null,f.yc=null,f.Ya=null;var m=f.Wa;m!=null&&(m.X=null),f.vb=null,e(f!=null)}function St(){var f=new LA;return f==null?null:(f.a=0,f.xb=m2,xe("Predictor","VP8LPredictors"),xe("Predictor","VP8LPredictors_C"),xe("PredictorAdd","VP8LPredictorsAdd"),xe("PredictorAdd","VP8LPredictorsAdd_C"),ci=Te,tA=ce,as=V,As=G,Us=le,ls=Le,ui=He,N.VP8LMapColor32b=eA,N.VP8LMapColor8b=vd,f)}function jt(f,m,S,T,X){var oe=1,Ae=[f],he=[m],we=T.m,Ue=T.s,Ge=null,ct=0;e:for(;;){if(S)for(;oe&&ne(we,1);){var ut=Ae,tt=he,Pt=T,xt=1,We=Pt.m,Ze=Pt.gc[Pt.ab],Tt=ne(We,2);if(Pt.Oc&1<<Tt)oe=0;else{switch(Pt.Oc|=1<<Tt,Ze.hc=Tt,Ze.Ea=ut[0],Ze.nc=tt[0],Ze.K=[null],++Pt.ab,e(4>=Pt.ab),Tt){case 0:case 1:Ze.b=ne(We,3)+2,xt=jt(ae(Ze.Ea,Ze.b),ae(Ze.nc,Ze.b),0,Pt,Ze.K),Ze.K=Ze.K[0];break;case 3:var Mt,Lt=ne(We,8)+1,or=16<Lt?0:4<Lt?1:2<Lt?2:3;if(ut[0]=ae(Ze.Ea,or),Ze.b=or,Mt=xt=jt(Lt,1,0,Pt,Ze.K)){var Xt,_r=Lt,Jt=Ze,_n=1<<(8>>Jt.b),Qn=s(_n);if(Qn==null)Mt=0;else{var vn=Jt.K[0],rn=Jt.w;for(Qn[0]=Jt.K[0][0],Xt=1;Xt<1*_r;++Xt)Qn[Xt]=ue(vn[rn+Xt],Qn[Xt-1]);for(;Xt<4*_n;++Xt)Qn[Xt]=0;Jt.K[0]=null,Jt.K[0]=Qn,Mt=1}}xt=Mt;break;case 2:break;default:e(0)}oe=xt}}if(Ae=Ae[0],he=he[0],oe&&ne(we,1)&&!(oe=1<=(ct=ne(we,4))&&11>=ct)){T.a=3;break e}var Mn;if(Mn=oe)t:{var On,jr,Lo,Vs=T,Po=Ae,Gs=he,Tn=ct,fi=S,pi=Vs.m,Jo=Vs.s,ds=[null],Ts=1,Ti=0,Ba=uC[Tn];r:for(;;){if(fi&&ne(pi,1)){var Zo=ne(pi,3)+2,sA=ae(Po,Zo),El=ae(Gs,Zo),bd=sA*El;if(!jt(sA,El,0,Vs,ds))break r;for(ds=ds[0],Jo.xc=Zo,On=0;On<bd;++On){var NA=ds[On]>>8&65535;ds[On]=NA,NA>=Ts&&(Ts=NA+1)}}if(pi.h)break r;for(jr=0;5>jr;++jr){var po=g2[jr];!jr&&0<Tn&&(po+=1<<Tn),Ti<po&&(Ti=po)}var ov=i(Ts*Ba,R),C2=Ts,S2=i(C2,se);if(S2==null)var Qh=null;else e(65536>=C2),Qh=S2;var Yc=s(Ti);if(Qh==null||Yc==null||ov==null){Vs.a=1;break r}var Th=ov;for(On=Lo=0;On<Ts;++On){var $i=Qh[On],xd=$i.G,Bd=$i.H,E2=0,Lh=1,F2=0;for(jr=0;5>jr;++jr){po=g2[jr],xd[jr]=Th,Bd[jr]=Lo,!jr&&0<Tn&&(po+=1<<Tn);o:{var Ph,sv=po,kh=Vs,Jc=Yc,TC=Th,LC=Lo,iv=0,MA=kh.m,PC=ne(MA,1);if(o(Jc,0,0,sv),PC){var kC=ne(MA,1)+1,OC=ne(MA,1),I2=ne(MA,OC==0?1:8);Jc[I2]=1,kC==2&&(Jc[I2=ne(MA,8)]=1);var Oh=1}else{var U2=s(19),Q2=ne(MA,4)+4;if(19<Q2){kh.a=3;var Dh=0;break o}for(Ph=0;Ph<Q2;++Ph)U2[dC[Ph]]=ne(MA,3);var av=void 0,Zc=void 0,T2=kh,DC=U2,Nh=sv,L2=Jc,Av=0,HA=T2.m,P2=8,k2=i(128,R);n:for(;L(k2,0,7,DC,19);){if(ne(HA,1)){var NC=2+2*ne(HA,3);if((av=2+ne(HA,NC))>Nh)break n}else av=Nh;for(Zc=0;Zc<Nh&&av--;){O(HA);var O2=k2[0+(127&E(HA))];I(HA,HA.u+O2.g);var zd=O2.value;if(16>zd)L2[Zc++]=zd,zd!=0&&(P2=zd);else{var MC=zd==16,D2=zd-16,HC=AC[D2],N2=ne(HA,aC[D2])+HC;if(Zc+N2>Nh)break n;for(var jC=MC?P2:0;0<N2--;)L2[Zc++]=jC}}Av=1;break n}Av||(T2.a=3),Oh=Av}(Oh=Oh&&!MA.h)&&(iv=L(TC,LC,8,Jc,sv)),Oh&&iv!=0?Dh=iv:(kh.a=3,Dh=0)}if(Dh==0)break r;if(Lh&&lC[jr]==1&&(Lh=Th[Lo].g==0),E2+=Th[Lo].g,Lo+=Dh,3>=jr){var eu,lv=Yc[0];for(eu=1;eu<po;++eu)Yc[eu]>lv&&(lv=Yc[eu]);F2+=lv}}if($i.nd=Lh,$i.Qb=0,Lh&&($i.qb=(xd[3][Bd[3]+0].value<<24|xd[1][Bd[1]+0].value<<16|xd[2][Bd[2]+0].value)>>>0,E2==0&&256>xd[0][Bd[0]+0].value&&($i.Qb=1,$i.qb+=xd[0][Bd[0]+0].value<<8)),$i.jc=!$i.Qb&&6>F2,$i.jc){var Mh,iA=$i;for(Mh=0;Mh<_o;++Mh){var jA=Mh,RA=iA.pd[jA],Hh=iA.G[0][iA.H[0]+jA];256<=Hh.value?(RA.g=Hh.g+256,RA.value=Hh.value):(RA.g=0,RA.value=0,jA>>=st(Hh,8,RA),jA>>=st(iA.G[1][iA.H[1]+jA],16,RA),jA>>=st(iA.G[2][iA.H[2]+jA],0,RA),st(iA.G[3][iA.H[3]+jA],24,RA))}}}Jo.vc=ds,Jo.Wb=Ts,Jo.Ya=Qh,Jo.yc=ov,Mn=1;break t}Mn=0}if(!(oe=Mn)){T.a=3;break e}if(0<ct){if(Ue.ua=1<<ct,!$e(Ue.Wa,ct)){T.a=1,oe=0;break e}}else Ue.ua=0;var dv=T,M2=Ae,RC=he,cv=dv.s,uv=cv.xc;if(dv.c=M2,dv.i=RC,cv.md=ae(M2,uv),cv.wc=uv==0?-1:(1<<uv)-1,S){T.xb=yC;break e}if((Ge=s(Ae*he))==null){T.a=1,oe=0;break e}oe=(oe=Wt(T,Ge,0,Ae,he,he,null))&&!we.h;break e}return oe?(X!=null?X[0]=Ge:(e(Ge==null),e(S)),T.$=0,S||It(Ue)):It(Ue),oe}function dr(f,m){var S=f.c*f.i,T=S+m+16*m;return e(f.c<=m),f.V=s(T),f.V==null?(f.Ta=null,f.Ua=0,f.a=1,0):(f.Ta=f.V,f.Ua=f.Ba+S+m,1)}function pr(f,m){var S=f.C,T=m-S,X=f.V,oe=f.Ba+f.c*S;for(e(m<=f.l.o);0<T;){var Ae=16<T?16:T,he=f.l.ma,we=f.l.width,Ue=we*Ae,Ge=he.ca,ct=he.tb+we*S,ut=f.Ta,tt=f.Ua;_t(f,Ae,X,oe),xo(ut,tt,Ge,ct,Ue),Ot(he,S,S+Ae,Ge,ct,we),T-=Ae,X+=Ae*f.c,S+=Ae}e(S==m),f.C=f.Ma=m}function ar(){this.ub=this.yd=this.td=this.Rb=0}function ur(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ir(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function Yr(){this.Yb=function(){var f=[];return function m(S,T,X){for(var oe=X[T],Ae=0;Ae<oe&&(S.push(X.length>T+1?[]:0),!(X.length<T+1));Ae++)m(S[Ae],T+1,X)}(f,0,[3,11]),f}()}function Jr(){this.jb=s(3),this.Wc=a([4,8],Yr),this.Xc=a([4,17],Yr)}function qr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ar(){this.ld=this.La=this.dd=this.tc=0}function Lr(){this.Na=this.la=0}function Kr(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function xr(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Pr(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ar),this.Y=0,this.ya=Array(new xr),this.aa=0,this.l=new pn}function Hr(){this.y=s(16),this.f=s(8),this.ea=s(8)}function cn(){this.cb=this.a=0,this.sc="",this.m=new ze,this.Od=new ar,this.Kc=new ur,this.ed=new qr,this.Qa=new Ir,this.Ic=this.$c=this.Aa=0,this.D=new Pr,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=i(8,ze),this.ia=0,this.pb=i(4,Kr),this.Pa=new Jr,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Hr),this.Hd=0,this.rb=Array(new Lr),this.sb=0,this.wa=Array(new Ar),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new xr),this.L=this.aa=0,this.gd=a([4,2],Ar),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function pn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wr(){var f=new cn;return f!=null&&(f.a=0,f.sc="OK",f.cb=0,f.Xb=0,Wc||(Wc=wo)),f}function wr(f,m,S){return f.a==0&&(f.a=m,f.sc=S,f.cb=0),0}function En(f,m,S){return 3<=S&&f[m+0]==157&&f[m+1]==1&&f[m+2]==42}function Do(f,m){if(f==null)return 0;if(f.a=0,f.sc="OK",m==null)return wr(f,2,"null VP8Io passed to VP8GetHeaders()");var S=m.data,T=m.w,X=m.ha;if(4>X)return wr(f,7,"Truncated header.");var oe=S[T+0]|S[T+1]<<8|S[T+2]<<16,Ae=f.Od;if(Ae.Rb=!(1&oe),Ae.td=oe>>1&7,Ae.yd=oe>>4&1,Ae.ub=oe>>5,3<Ae.td)return wr(f,3,"Incorrect keyframe parameters.");if(!Ae.yd)return wr(f,4,"Frame not displayable.");T+=3,X-=3;var he=f.Kc;if(Ae.Rb){if(7>X)return wr(f,7,"cannot parse picture header");if(!En(S,T,X))return wr(f,3,"Bad code word");he.c=16383&(S[T+4]<<8|S[T+3]),he.Td=S[T+4]>>6,he.i=16383&(S[T+6]<<8|S[T+5]),he.Ud=S[T+6]>>6,T+=7,X-=7,f.za=he.c+15>>4,f.Ub=he.i+15>>4,m.width=he.c,m.height=he.i,m.Da=0,m.j=0,m.v=0,m.va=m.width,m.o=m.height,m.da=0,m.ib=m.width,m.hb=m.height,m.U=m.width,m.T=m.height,o((oe=f.Pa).jb,0,255,oe.jb.length),e((oe=f.Qa)!=null),oe.Cb=0,oe.Bb=0,oe.Fb=1,o(oe.Zb,0,0,oe.Zb.length),o(oe.Lb,0,0,oe.Lb)}if(Ae.ub>X)return wr(f,7,"bad partition length");fe(oe=f.m,S,T,Ae.ub),T+=Ae.ub,X-=Ae.ub,Ae.Rb&&(he.Ld=P(oe),he.Kd=P(oe)),he=f.Qa;var we,Ue=f.Pa;if(e(oe!=null),e(he!=null),he.Cb=P(oe),he.Cb){if(he.Bb=P(oe),P(oe)){for(he.Fb=P(oe),we=0;4>we;++we)he.Zb[we]=P(oe)?pe(oe,7):0;for(we=0;4>we;++we)he.Lb[we]=P(oe)?pe(oe,6):0}if(he.Bb)for(we=0;3>we;++we)Ue.jb[we]=P(oe)?ie(oe,8):255}else he.Bb=0;if(oe.Ka)return wr(f,3,"cannot parse segment header");if((he=f.ed).zd=P(oe),he.Tb=ie(oe,6),he.wb=ie(oe,3),he.Pc=P(oe),he.Pc&&P(oe)){for(Ue=0;4>Ue;++Ue)P(oe)&&(he.vd[Ue]=pe(oe,6));for(Ue=0;4>Ue;++Ue)P(oe)&&(he.od[Ue]=pe(oe,6))}if(f.L=he.Tb==0?0:he.zd?1:2,oe.Ka)return wr(f,3,"cannot parse filter header");var Ge=X;if(X=we=T,T=we+Ge,he=Ge,f.Xb=(1<<ie(f.m,2))-1,Ge<3*(Ue=f.Xb))S=7;else{for(we+=3*Ue,he-=3*Ue,Ge=0;Ge<Ue;++Ge){var ct=S[X+0]|S[X+1]<<8|S[X+2]<<16;ct>he&&(ct=he),fe(f.Jc[+Ge],S,we,ct),we+=ct,he-=ct,X+=3}fe(f.Jc[+Ue],S,we,he),S=we<T?0:5}if(S!=0)return wr(f,S,"cannot parse partitions");for(S=ie(we=f.m,7),X=P(we)?pe(we,4):0,T=P(we)?pe(we,4):0,he=P(we)?pe(we,4):0,Ue=P(we)?pe(we,4):0,we=P(we)?pe(we,4):0,Ge=f.Qa,ct=0;4>ct;++ct){if(Ge.Cb){var ut=Ge.Zb[ct];Ge.Fb||(ut+=S)}else{if(0<ct){f.pb[ct]=f.pb[0];continue}ut=S}var tt=f.pb[ct];tt.Sc[0]=tv[ss(ut+X,127)],tt.Sc[1]=rv[ss(ut+0,127)],tt.Eb[0]=2*tv[ss(ut+T,127)],tt.Eb[1]=101581*rv[ss(ut+he,127)]>>16,8>tt.Eb[1]&&(tt.Eb[1]=8),tt.Qc[0]=tv[ss(ut+Ue,117)],tt.Qc[1]=rv[ss(ut+we,127)],tt.lc=ut+we}if(!Ae.Rb)return wr(f,4,"Not a key frame.");for(P(oe),Ae=f.Pa,S=0;4>S;++S){for(X=0;8>X;++X)for(T=0;3>T;++T)for(he=0;11>he;++he)Ue=K(oe,mC[S][X][T][he])?ie(oe,8):gC[S][X][T][he],Ae.Wc[S][X].Yb[T][he]=Ue;for(X=0;17>X;++X)Ae.Xc[S][X]=Ae.Wc[S][wC[X]]}return f.kc=P(oe),f.kc&&(f.Bd=ie(oe,8)),f.cb=1}function wo(f,m,S,T,X,oe,Ae){var he=m[X].Yb[S];for(S=0;16>X;++X){if(!K(f,he[S+0]))return X;for(;!K(f,he[S+1]);)if(he=m[++X].Yb[0],S=0,X==16)return 16;var we=m[X+1].Yb;if(K(f,he[S+2])){var Ue=f,Ge=0;if(K(Ue,(ut=he)[(ct=S)+3]))if(K(Ue,ut[ct+6])){for(he=0,ct=2*(Ge=K(Ue,ut[ct+8]))+(ut=K(Ue,ut[ct+9+Ge])),Ge=0,ut=fC[ct];ut[he];++he)Ge+=Ge+K(Ue,ut[he]);Ge+=3+(8<<ct)}else K(Ue,ut[ct+7])?(Ge=7+2*K(Ue,165),Ge+=K(Ue,145)):Ge=5+K(Ue,159);else Ge=K(Ue,ut[ct+4])?3+K(Ue,ut[ct+5]):2;he=we[2]}else Ge=1,he=we[1];we=Ae+pC[X],0>(Ue=f).b&&D(Ue);var ct,ut=Ue.b,tt=(ct=Ue.Ca>>1)-(Ue.I>>ut)>>31;--Ue.b,Ue.Ca+=tt,Ue.Ca|=1,Ue.I-=(ct+1&tt)<<ut,oe[we]=((Ge^tt)-tt)*T[(0<X)+0]}return 16}function yo(f){var m=f.rb[f.sb-1];m.la=0,m.Na=0,o(f.zc,0,0,f.zc.length),f.ja=0}function vs(f,m){if(f==null)return 0;if(m==null)return wr(f,2,"NULL VP8Io parameter in VP8Decode().");if(!f.cb&&!Do(f,m))return 0;if(e(f.cb),m.ac==null||m.ac(m)){m.ob&&(f.L=0);var S=Uh[f.L];if(f.L==2?(f.yb=0,f.zb=0):(f.yb=m.v-S>>4,f.zb=m.j-S>>4,0>f.yb&&(f.yb=0),0>f.zb&&(f.zb=0)),f.Va=m.o+15+S>>4,f.Hb=m.va+15+S>>4,f.Hb>f.za&&(f.Hb=f.za),f.Va>f.Ub&&(f.Va=f.Ub),0<f.L){var T=f.ed;for(S=0;4>S;++S){var X;if(f.Qa.Cb){var oe=f.Qa.Lb[S];f.Qa.Fb||(oe+=T.Tb)}else oe=T.Tb;for(X=0;1>=X;++X){var Ae=f.gd[S][X],he=oe;if(T.Pc&&(he+=T.vd[0],X&&(he+=T.od[0])),0<(he=0>he?0:63<he?63:he)){var we=he;0<T.wb&&(we=4<T.wb?we>>2:we>>1)>9-T.wb&&(we=9-T.wb),1>we&&(we=1),Ae.dd=we,Ae.tc=2*he+we,Ae.ld=40<=he?2:15<=he?1:0}else Ae.tc=0;Ae.La=X}}}S=0}else wr(f,6,"Frame setup failed"),S=f.a;if(S=S==0){if(S){f.$c=0,0<f.Aa||(f.Ic=QC);e:{S=f.Ic,T=4*(we=f.za);var Ue=32*we,Ge=we+1,ct=0<f.L?we*(0<f.Aa?2:1):0,ut=(f.Aa==2?2:1)*we;if((Ae=T+832+(X=3*(16*S+Uh[f.L])/2*Ue)+(oe=f.Fa!=null&&0<f.Fa.length?f.Kc.c*f.Kc.i:0))!=Ae)S=0;else{if(Ae>f.Vb){if(f.Vb=0,f.Ec=s(Ae),f.Fc=0,f.Ec==null){S=wr(f,1,"no memory during frame initialization.");break e}f.Vb=Ae}Ae=f.Ec,he=f.Fc,f.Ac=Ae,f.Bc=he,he+=T,f.Gd=i(Ue,Hr),f.Hd=0,f.rb=i(Ge+1,Lr),f.sb=1,f.wa=ct?i(ct,Ar):null,f.Y=0,f.D.Nb=0,f.D.wa=f.wa,f.D.Y=f.Y,0<f.Aa&&(f.D.Y+=we),e(!0),f.oc=Ae,f.pc=he,he+=832,f.ya=i(ut,xr),f.aa=0,f.D.ya=f.ya,f.D.aa=f.aa,f.Aa==2&&(f.D.aa+=we),f.R=16*we,f.B=8*we,we=(Ue=Uh[f.L])*f.R,Ue=Ue/2*f.B,f.sa=Ae,f.ta=he+we,f.qa=f.sa,f.ra=f.ta+16*S*f.R+Ue,f.Ha=f.qa,f.Ia=f.ra+8*S*f.B+Ue,f.$c=0,he+=X,f.mb=oe?Ae:null,f.nb=oe?he:null,e(he+oe<=f.Fc+f.Vb),yo(f),o(f.Ac,f.Bc,0,T),S=1}}if(S){if(m.ka=0,m.y=f.sa,m.O=f.ta,m.f=f.qa,m.N=f.ra,m.ea=f.Ha,m.Vd=f.Ia,m.fa=f.R,m.Rc=f.B,m.F=null,m.J=0,!bh){for(S=-255;255>=S;++S)Ro[255+S]=0>S?-S:S;for(S=-1020;1020>=S;++S)nA[1020+S]=-128>S?-128:127<S?127:S;for(S=-112;112>=S;++S)Gc[112+S]=-16>S?-16:15<S?15:S;for(S=-255;510>=S;++S)_d[255+S]=0>S?0:255<S?255:S;bh=1}md=ir,rA=qt,Kc=Kt,Qs=kr,Ei=fr,bo=wt,wd=Wa,_h=di,$c=QA,Bl=Xa,zl=UA,PA=Ri,Cl=Ya,yd=TA,Sl=pa,kA=Ks,Vc=$s,Fi=IA,Ki[0]=Zr,Ki[1]=Or,Ki[2]=Mo,Ki[3]=Nn,Ki[4]=Vt,Ki[5]=In,Ki[6]=en,Ki[7]=fo,Ki[8]=ai,Ki[9]=Qo,OA[0]=Dn,OA[1]=yt,OA[2]=rr,OA[3]=Br,OA[4]=Sr,OA[5]=Xr,OA[6]=Fn,oA[0]=qs,oA[1]=Yn,oA[2]=Bi,oA[3]=zi,oA[4]=qn,oA[5]=ji,oA[6]=Go,S=1}else S=0}S&&(S=function(tt,Pt){for(tt.M=0;tt.M<tt.Va;++tt.M){var xt,We=tt.Jc[tt.M&tt.Xb],Ze=tt.m,Tt=tt;for(xt=0;xt<Tt.za;++xt){var Mt=Ze,Lt=Tt,or=Lt.Ac,Xt=Lt.Bc+4*xt,_r=Lt.zc,Jt=Lt.ya[Lt.aa+xt];if(Lt.Qa.Bb?Jt.$b=K(Mt,Lt.Pa.jb[0])?2+K(Mt,Lt.Pa.jb[2]):K(Mt,Lt.Pa.jb[1]):Jt.$b=0,Lt.kc&&(Jt.Ad=K(Mt,Lt.Bd)),Jt.Za=!K(Mt,145)+0,Jt.Za){var _n=Jt.Ob,Qn=0;for(Lt=0;4>Lt;++Lt){var vn,rn=_r[0+Lt];for(vn=0;4>vn;++vn){rn=vC[or[Xt+vn]][rn];for(var Mn=v2[K(Mt,rn[0])];0<Mn;)Mn=v2[2*Mn+K(Mt,rn[Mn])];rn=-Mn,or[Xt+vn]=rn}r(_n,Qn,or,Xt,4),Qn+=4,_r[0+Lt]=rn}}else rn=K(Mt,156)?K(Mt,128)?1:3:K(Mt,163)?2:0,Jt.Ob[0]=rn,o(or,Xt,rn,4),o(_r,0,rn,4);Jt.Dd=K(Mt,142)?K(Mt,114)?K(Mt,183)?1:3:2:0}if(Tt.m.Ka)return wr(tt,7,"Premature end-of-partition0 encountered.");for(;tt.ja<tt.za;++tt.ja){if(Tt=We,Mt=(Ze=tt).rb[Ze.sb-1],or=Ze.rb[Ze.sb+Ze.ja],xt=Ze.ya[Ze.aa+Ze.ja],Xt=Ze.kc?xt.Ad:0)Mt.la=or.la=0,xt.Za||(Mt.Na=or.Na=0),xt.Hc=0,xt.Gc=0,xt.ia=0;else{var On,jr;if(Mt=or,or=Tt,Xt=Ze.Pa.Xc,_r=Ze.ya[Ze.aa+Ze.ja],Jt=Ze.pb[_r.$b],Lt=_r.ad,_n=0,Qn=Ze.rb[Ze.sb-1],rn=vn=0,o(Lt,_n,0,384),_r.Za)var Lo=0,Vs=Xt[3];else{Mn=s(16);var Po=Mt.Na+Qn.Na;if(Po=Wc(or,Xt[1],Po,Jt.Eb,0,Mn,0),Mt.Na=Qn.Na=(0<Po)+0,1<Po)md(Mn,0,Lt,_n);else{var Gs=Mn[0]+3>>3;for(Mn=0;256>Mn;Mn+=16)Lt[_n+Mn]=Gs}Lo=1,Vs=Xt[0]}var Tn=15&Mt.la,fi=15&Qn.la;for(Mn=0;4>Mn;++Mn){var pi=1&fi;for(Gs=jr=0;4>Gs;++Gs)Tn=Tn>>1|(pi=(Po=Wc(or,Vs,Po=pi+(1&Tn),Jt.Sc,Lo,Lt,_n))>Lo)<<7,jr=jr<<2|(3<Po?3:1<Po?2:Lt[_n+0]!=0),_n+=16;Tn>>=4,fi=fi>>1|pi<<7,vn=(vn<<8|jr)>>>0}for(Vs=Tn,Lo=fi>>4,On=0;4>On;On+=2){for(jr=0,Tn=Mt.la>>4+On,fi=Qn.la>>4+On,Mn=0;2>Mn;++Mn){for(pi=1&fi,Gs=0;2>Gs;++Gs)Po=pi+(1&Tn),Tn=Tn>>1|(pi=0<(Po=Wc(or,Xt[2],Po,Jt.Qc,0,Lt,_n)))<<3,jr=jr<<2|(3<Po?3:1<Po?2:Lt[_n+0]!=0),_n+=16;Tn>>=2,fi=fi>>1|pi<<5}rn|=jr<<4*On,Vs|=Tn<<4<<On,Lo|=(240&fi)<<On}Mt.la=Vs,Qn.la=Lo,_r.Hc=vn,_r.Gc=rn,_r.ia=43690&rn?0:Jt.ia,Xt=!(vn|rn)}if(0<Ze.L&&(Ze.wa[Ze.Y+Ze.ja]=Ze.gd[xt.$b][xt.Za],Ze.wa[Ze.Y+Ze.ja].La|=!Xt),Tt.Ka)return wr(tt,7,"Premature end-of-file encountered.")}if(yo(tt),Ze=Pt,Tt=1,xt=(We=tt).D,Mt=0<We.L&&We.M>=We.zb&&We.M<=We.Va,We.Aa==0)e:{if(xt.M=We.M,xt.uc=Mt,Za(We,xt),Tt=1,xt=(jr=We.D).Nb,Mt=(rn=Uh[We.L])*We.R,or=rn/2*We.B,Mn=16*xt*We.R,Gs=8*xt*We.B,Xt=We.sa,_r=We.ta-Mt+Mn,Jt=We.qa,Lt=We.ra-or+Gs,_n=We.Ha,Qn=We.Ia-or+Gs,fi=(Tn=jr.M)==0,vn=Tn>=We.Va-1,We.Aa==2&&Za(We,jr),jr.uc)for(pi=(Po=We).D.M,e(Po.D.uc),jr=Po.yb;jr<Po.Hb;++jr){Lo=jr,Vs=pi;var Jo=(ds=(po=Po).D).Nb;On=po.R;var ds=ds.wa[ds.Y+Lo],Ts=po.sa,Ti=po.ta+16*Jo*On+16*Lo,Ba=ds.dd,Zo=ds.tc;if(Zo!=0)if(e(3<=Zo),po.L==1)0<Lo&&kA(Ts,Ti,On,Zo+4),ds.La&&Fi(Ts,Ti,On,Zo),0<Vs&&Sl(Ts,Ti,On,Zo+4),ds.La&&Vc(Ts,Ti,On,Zo);else{var sA=po.B,El=po.qa,bd=po.ra+8*Jo*sA+8*Lo,NA=po.Ha,po=po.Ia+8*Jo*sA+8*Lo;Jo=ds.ld,0<Lo&&(_h(Ts,Ti,On,Zo+4,Ba,Jo),Bl(El,bd,NA,po,sA,Zo+4,Ba,Jo)),ds.La&&(PA(Ts,Ti,On,Zo,Ba,Jo),yd(El,bd,NA,po,sA,Zo,Ba,Jo)),0<Vs&&(wd(Ts,Ti,On,Zo+4,Ba,Jo),$c(El,bd,NA,po,sA,Zo+4,Ba,Jo)),ds.La&&(zl(Ts,Ti,On,Zo,Ba,Jo),Cl(El,bd,NA,po,sA,Zo,Ba,Jo))}}if(We.ia&&alert("todo:DitherRow"),Ze.put!=null){if(jr=16*Tn,Tn=16*(Tn+1),fi?(Ze.y=We.sa,Ze.O=We.ta+Mn,Ze.f=We.qa,Ze.N=We.ra+Gs,Ze.ea=We.Ha,Ze.W=We.Ia+Gs):(jr-=rn,Ze.y=Xt,Ze.O=_r,Ze.f=Jt,Ze.N=Lt,Ze.ea=_n,Ze.W=Qn),vn||(Tn-=rn),Tn>Ze.o&&(Tn=Ze.o),Ze.F=null,Ze.J=null,We.Fa!=null&&0<We.Fa.length&&jr<Tn&&(Ze.J=ya(We,Ze,jr,Tn-jr),Ze.F=We.mb,Ze.F==null&&Ze.F.length==0)){Tt=wr(We,3,"Could not decode alpha data.");break e}jr<Ze.j&&(rn=Ze.j-jr,jr=Ze.j,e(!(1&rn)),Ze.O+=We.R*rn,Ze.N+=We.B*(rn>>1),Ze.W+=We.B*(rn>>1),Ze.F!=null&&(Ze.J+=Ze.width*rn)),jr<Tn&&(Ze.O+=Ze.v,Ze.N+=Ze.v>>1,Ze.W+=Ze.v>>1,Ze.F!=null&&(Ze.J+=Ze.v),Ze.ka=jr-Ze.j,Ze.U=Ze.va-Ze.v,Ze.T=Tn-jr,Tt=Ze.put(Ze))}xt+1!=We.Ic||vn||(r(We.sa,We.ta-Mt,Xt,_r+16*We.R,Mt),r(We.qa,We.ra-or,Jt,Lt+8*We.B,or),r(We.Ha,We.Ia-or,_n,Qn+8*We.B,or))}if(!Tt)return wr(tt,6,"Output aborted.")}return 1}(f,m)),m.bc!=null&&m.bc(m),S&=1}return S?(f.cb=0,S):0}function io(f,m,S,T,X){X=f[m+S+32*T]+(X>>3),f[m+S+32*T]=-256&X?0>X?0:255:X}function No(f,m,S,T,X,oe){io(f,m,0,S,T+X),io(f,m,1,S,T+oe),io(f,m,2,S,T-oe),io(f,m,3,S,T-X)}function Rn(f){return(20091*f>>16)+f}function Ve(f,m,S,T){var X,oe=0,Ae=s(16);for(X=0;4>X;++X){var he=f[m+0]+f[m+8],we=f[m+0]-f[m+8],Ue=(35468*f[m+4]>>16)-Rn(f[m+12]),Ge=Rn(f[m+4])+(35468*f[m+12]>>16);Ae[oe+0]=he+Ge,Ae[oe+1]=we+Ue,Ae[oe+2]=we-Ue,Ae[oe+3]=he-Ge,oe+=4,m++}for(X=oe=0;4>X;++X)he=(f=Ae[oe+0]+4)+Ae[oe+8],we=f-Ae[oe+8],Ue=(35468*Ae[oe+4]>>16)-Rn(Ae[oe+12]),io(S,T,0,0,he+(Ge=Rn(Ae[oe+4])+(35468*Ae[oe+12]>>16))),io(S,T,1,0,we+Ue),io(S,T,2,0,we-Ue),io(S,T,3,0,he-Ge),oe++,T+=32}function wt(f,m,S,T){var X=f[m+0]+4,oe=35468*f[m+4]>>16,Ae=Rn(f[m+4]),he=35468*f[m+1]>>16;No(S,T,0,X+Ae,f=Rn(f[m+1]),he),No(S,T,1,X+oe,f,he),No(S,T,2,X-oe,f,he),No(S,T,3,X-Ae,f,he)}function qt(f,m,S,T,X){Ve(f,m,S,T),X&&Ve(f,m+16,S,T+4)}function Kt(f,m,S,T){rA(f,m+0,S,T,1),rA(f,m+32,S,T+128,1)}function kr(f,m,S,T){var X;for(f=f[m+0]+4,X=0;4>X;++X)for(m=0;4>m;++m)io(S,T,m,X,f)}function fr(f,m,S,T){f[m+0]&&Qs(f,m+0,S,T),f[m+16]&&Qs(f,m+16,S,T+4),f[m+32]&&Qs(f,m+32,S,T+128),f[m+48]&&Qs(f,m+48,S,T+128+4)}function ir(f,m,S,T){var X,oe=s(16);for(X=0;4>X;++X){var Ae=f[m+0+X]+f[m+12+X],he=f[m+4+X]+f[m+8+X],we=f[m+4+X]-f[m+8+X],Ue=f[m+0+X]-f[m+12+X];oe[0+X]=Ae+he,oe[8+X]=Ae-he,oe[4+X]=Ue+we,oe[12+X]=Ue-we}for(X=0;4>X;++X)Ae=(f=oe[0+4*X]+3)+oe[3+4*X],he=oe[1+4*X]+oe[2+4*X],we=oe[1+4*X]-oe[2+4*X],Ue=f-oe[3+4*X],S[T+0]=Ae+he>>3,S[T+16]=Ue+we>>3,S[T+32]=Ae-he>>3,S[T+48]=Ue-we>>3,T+=64}function Ur(f,m,S){var T,X=m-32,oe=hi,Ae=255-f[X-1];for(T=0;T<S;++T){var he,we=oe,Ue=Ae+f[m-1];for(he=0;he<S;++he)f[m+he]=we[Ue+f[X+he]];m+=32}}function Or(f,m){Ur(f,m,4)}function Yn(f,m){Ur(f,m,8)}function yt(f,m){Ur(f,m,16)}function rr(f,m){var S;for(S=0;16>S;++S)r(f,m+32*S,f,m-32,16)}function Br(f,m){var S;for(S=16;0<S;--S)o(f,m,f[m-1],16),m+=32}function gn(f,m,S){var T;for(T=0;16>T;++T)o(m,S+32*T,f,16)}function Dn(f,m){var S,T=16;for(S=0;16>S;++S)T+=f[m-1+32*S]+f[m+S-32];gn(T>>5,f,m)}function Sr(f,m){var S,T=8;for(S=0;16>S;++S)T+=f[m-1+32*S];gn(T>>4,f,m)}function Xr(f,m){var S,T=8;for(S=0;16>S;++S)T+=f[m+S-32];gn(T>>4,f,m)}function Fn(f,m){gn(128,f,m)}function Dt(f,m,S){return f+2*m+S+2>>2}function Mo(f,m){var S,T=m-32;for(T=new Uint8Array([Dt(f[T-1],f[T+0],f[T+1]),Dt(f[T+0],f[T+1],f[T+2]),Dt(f[T+1],f[T+2],f[T+3]),Dt(f[T+2],f[T+3],f[T+4])]),S=0;4>S;++S)r(f,m+32*S,T,0,T.length)}function Nn(f,m){var S=f[m-1],T=f[m-1+32],X=f[m-1+64],oe=f[m-1+96];M(f,m+0,16843009*Dt(f[m-1-32],S,T)),M(f,m+32,16843009*Dt(S,T,X)),M(f,m+64,16843009*Dt(T,X,oe)),M(f,m+96,16843009*Dt(X,oe,oe))}function Zr(f,m){var S,T=4;for(S=0;4>S;++S)T+=f[m+S-32]+f[m-1+32*S];for(T>>=3,S=0;4>S;++S)o(f,m+32*S,T,4)}function Vt(f,m){var S=f[m-1+0],T=f[m-1+32],X=f[m-1+64],oe=f[m-1-32],Ae=f[m+0-32],he=f[m+1-32],we=f[m+2-32],Ue=f[m+3-32];f[m+0+96]=Dt(T,X,f[m-1+96]),f[m+1+96]=f[m+0+64]=Dt(S,T,X),f[m+2+96]=f[m+1+64]=f[m+0+32]=Dt(oe,S,T),f[m+3+96]=f[m+2+64]=f[m+1+32]=f[m+0+0]=Dt(Ae,oe,S),f[m+3+64]=f[m+2+32]=f[m+1+0]=Dt(he,Ae,oe),f[m+3+32]=f[m+2+0]=Dt(we,he,Ae),f[m+3+0]=Dt(Ue,we,he)}function en(f,m){var S=f[m+1-32],T=f[m+2-32],X=f[m+3-32],oe=f[m+4-32],Ae=f[m+5-32],he=f[m+6-32],we=f[m+7-32];f[m+0+0]=Dt(f[m+0-32],S,T),f[m+1+0]=f[m+0+32]=Dt(S,T,X),f[m+2+0]=f[m+1+32]=f[m+0+64]=Dt(T,X,oe),f[m+3+0]=f[m+2+32]=f[m+1+64]=f[m+0+96]=Dt(X,oe,Ae),f[m+3+32]=f[m+2+64]=f[m+1+96]=Dt(oe,Ae,he),f[m+3+64]=f[m+2+96]=Dt(Ae,he,we),f[m+3+96]=Dt(he,we,we)}function In(f,m){var S=f[m-1+0],T=f[m-1+32],X=f[m-1+64],oe=f[m-1-32],Ae=f[m+0-32],he=f[m+1-32],we=f[m+2-32],Ue=f[m+3-32];f[m+0+0]=f[m+1+64]=oe+Ae+1>>1,f[m+1+0]=f[m+2+64]=Ae+he+1>>1,f[m+2+0]=f[m+3+64]=he+we+1>>1,f[m+3+0]=we+Ue+1>>1,f[m+0+96]=Dt(X,T,S),f[m+0+64]=Dt(T,S,oe),f[m+0+32]=f[m+1+96]=Dt(S,oe,Ae),f[m+1+32]=f[m+2+96]=Dt(oe,Ae,he),f[m+2+32]=f[m+3+96]=Dt(Ae,he,we),f[m+3+32]=Dt(he,we,Ue)}function fo(f,m){var S=f[m+0-32],T=f[m+1-32],X=f[m+2-32],oe=f[m+3-32],Ae=f[m+4-32],he=f[m+5-32],we=f[m+6-32],Ue=f[m+7-32];f[m+0+0]=S+T+1>>1,f[m+1+0]=f[m+0+64]=T+X+1>>1,f[m+2+0]=f[m+1+64]=X+oe+1>>1,f[m+3+0]=f[m+2+64]=oe+Ae+1>>1,f[m+0+32]=Dt(S,T,X),f[m+1+32]=f[m+0+96]=Dt(T,X,oe),f[m+2+32]=f[m+1+96]=Dt(X,oe,Ae),f[m+3+32]=f[m+2+96]=Dt(oe,Ae,he),f[m+3+64]=Dt(Ae,he,we),f[m+3+96]=Dt(he,we,Ue)}function Qo(f,m){var S=f[m-1+0],T=f[m-1+32],X=f[m-1+64],oe=f[m-1+96];f[m+0+0]=S+T+1>>1,f[m+2+0]=f[m+0+32]=T+X+1>>1,f[m+2+32]=f[m+0+64]=X+oe+1>>1,f[m+1+0]=Dt(S,T,X),f[m+3+0]=f[m+1+32]=Dt(T,X,oe),f[m+3+32]=f[m+1+64]=Dt(X,oe,oe),f[m+3+64]=f[m+2+64]=f[m+0+96]=f[m+1+96]=f[m+2+96]=f[m+3+96]=oe}function ai(f,m){var S=f[m-1+0],T=f[m-1+32],X=f[m-1+64],oe=f[m-1+96],Ae=f[m-1-32],he=f[m+0-32],we=f[m+1-32],Ue=f[m+2-32];f[m+0+0]=f[m+2+32]=S+Ae+1>>1,f[m+0+32]=f[m+2+64]=T+S+1>>1,f[m+0+64]=f[m+2+96]=X+T+1>>1,f[m+0+96]=oe+X+1>>1,f[m+3+0]=Dt(he,we,Ue),f[m+2+0]=Dt(Ae,he,we),f[m+1+0]=f[m+3+32]=Dt(S,Ae,he),f[m+1+32]=f[m+3+64]=Dt(T,S,Ae),f[m+1+64]=f[m+3+96]=Dt(X,T,S),f[m+1+96]=Dt(oe,X,T)}function Bi(f,m){var S;for(S=0;8>S;++S)r(f,m+32*S,f,m-32,8)}function zi(f,m){var S;for(S=0;8>S;++S)o(f,m,f[m-1],8),m+=32}function Ai(f,m,S){var T;for(T=0;8>T;++T)o(m,S+32*T,f,8)}function qs(f,m){var S,T=8;for(S=0;8>S;++S)T+=f[m+S-32]+f[m-1+32*S];Ai(T>>4,f,m)}function ji(f,m){var S,T=4;for(S=0;8>S;++S)T+=f[m+S-32];Ai(T>>3,f,m)}function qn(f,m){var S,T=4;for(S=0;8>S;++S)T+=f[m-1+32*S];Ai(T>>3,f,m)}function Go(f,m){Ai(128,f,m)}function Jn(f,m,S){var T=f[m-S],X=f[m+0],oe=3*(X-T)+Xg[1020+f[m-2*S]-f[m+S]],Ae=xh[112+(oe+4>>3)];f[m-S]=hi[255+T+xh[112+(oe+3>>3)]],f[m+0]=hi[255+X-Ae]}function tn(f,m,S,T){var X=f[m+0],oe=f[m+S];return Ui[255+f[m-2*S]-f[m-S]]>T||Ui[255+oe-X]>T}function fa(f,m,S,T){return 4*Ui[255+f[m-S]-f[m+0]]+Ui[255+f[m-2*S]-f[m+S]]<=T}function Ga(f,m,S,T,X){var oe=f[m-3*S],Ae=f[m-2*S],he=f[m-S],we=f[m+0],Ue=f[m+S],Ge=f[m+2*S],ct=f[m+3*S];return 4*Ui[255+he-we]+Ui[255+Ae-Ue]>T?0:Ui[255+f[m-4*S]-oe]<=X&&Ui[255+oe-Ae]<=X&&Ui[255+Ae-he]<=X&&Ui[255+ct-Ge]<=X&&Ui[255+Ge-Ue]<=X&&Ui[255+Ue-we]<=X}function pa(f,m,S,T){var X=2*T+1;for(T=0;16>T;++T)fa(f,m+T,S,X)&&Jn(f,m+T,S)}function Ks(f,m,S,T){var X=2*T+1;for(T=0;16>T;++T)fa(f,m+T*S,1,X)&&Jn(f,m+T*S,1)}function $s(f,m,S,T){var X;for(X=3;0<X;--X)pa(f,m+=4*S,S,T)}function IA(f,m,S,T){var X;for(X=3;0<X;--X)Ks(f,m+=4,S,T)}function li(f,m,S,T,X,oe,Ae,he){for(oe=2*oe+1;0<X--;){if(Ga(f,m,S,oe,Ae))if(tn(f,m,S,he))Jn(f,m,S);else{var we=f,Ue=m,Ge=S,ct=we[Ue-2*Ge],ut=we[Ue-Ge],tt=we[Ue+0],Pt=we[Ue+Ge],xt=we[Ue+2*Ge],We=27*(Tt=Xg[1020+3*(tt-ut)+Xg[1020+ct-Pt]])+63>>7,Ze=18*Tt+63>>7,Tt=9*Tt+63>>7;we[Ue-3*Ge]=hi[255+we[Ue-3*Ge]+Tt],we[Ue-2*Ge]=hi[255+ct+Ze],we[Ue-Ge]=hi[255+ut+We],we[Ue+0]=hi[255+tt-We],we[Ue+Ge]=hi[255+Pt-Ze],we[Ue+2*Ge]=hi[255+xt-Tt]}m+=T}}function ms(f,m,S,T,X,oe,Ae,he){for(oe=2*oe+1;0<X--;){if(Ga(f,m,S,oe,Ae))if(tn(f,m,S,he))Jn(f,m,S);else{var we=f,Ue=m,Ge=S,ct=we[Ue-Ge],ut=we[Ue+0],tt=we[Ue+Ge],Pt=xh[112+((xt=3*(ut-ct))+4>>3)],xt=xh[112+(xt+3>>3)],We=Pt+1>>1;we[Ue-2*Ge]=hi[255+we[Ue-2*Ge]+We],we[Ue-Ge]=hi[255+ct+xt],we[Ue+0]=hi[255+ut-Pt],we[Ue+Ge]=hi[255+tt-We]}m+=T}}function Wa(f,m,S,T,X,oe){li(f,m,S,1,16,T,X,oe)}function di(f,m,S,T,X,oe){li(f,m,1,S,16,T,X,oe)}function UA(f,m,S,T,X,oe){var Ae;for(Ae=3;0<Ae;--Ae)ms(f,m+=4*S,S,1,16,T,X,oe)}function Ri(f,m,S,T,X,oe){var Ae;for(Ae=3;0<Ae;--Ae)ms(f,m+=4,1,S,16,T,X,oe)}function QA(f,m,S,T,X,oe,Ae,he){li(f,m,X,1,8,oe,Ae,he),li(S,T,X,1,8,oe,Ae,he)}function Xa(f,m,S,T,X,oe,Ae,he){li(f,m,1,X,8,oe,Ae,he),li(S,T,1,X,8,oe,Ae,he)}function Ya(f,m,S,T,X,oe,Ae,he){ms(f,m+4*X,X,1,8,oe,Ae,he),ms(S,T+4*X,X,1,8,oe,Ae,he)}function TA(f,m,S,T,X,oe,Ae,he){ms(f,m+4,1,X,8,oe,Ae,he),ms(S,T+4,1,X,8,oe,Ae,he)}function Ci(){this.ba=new ot,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ye,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function ga(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function va(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ja(){this.ua=0,this.Wa=new j,this.vb=new j,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new se,this.yc=new R}function LA(){this.xb=this.a=0,this.l=new pn,this.ca=new ot,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ja,this.ab=0,this.gc=i(4,va),this.Oc=0}function ma(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new pn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function qi(f,m,S,T,X,oe,Ae){for(f=f==null?0:f[m+0],m=0;m<Ae;++m)X[oe+m]=f+S[T+m]&255,f=X[oe+m]}function wa(f,m,S,T,X,oe,Ae){var he;if(f==null)qi(null,null,S,T,X,oe,Ae);else for(he=0;he<Ae;++he)X[oe+he]=f[m+he]+S[T+he]&255}function Si(f,m,S,T,X,oe,Ae){if(f==null)qi(null,null,S,T,X,oe,Ae);else{var he,we=f[m+0],Ue=we,Ge=we;for(he=0;he<Ae;++he)Ue=Ge+(we=f[m+he])-Ue,Ge=S[T+he]+(-256&Ue?0>Ue?0:255:Ue)&255,Ue=we,X[oe+he]=Ge}}function ya(f,m,S,T){var X=m.width,oe=m.o;if(e(f!=null&&m!=null),0>S||0>=T||S+T>oe)return null;if(!f.Cc){if(f.ga==null){var Ae;if(f.ga=new ma,(Ae=f.ga==null)||(Ae=m.width*m.o,e(f.Gb.length==0),f.Gb=s(Ae),f.Uc=0,f.Gb==null?Ae=0:(f.mb=f.Gb,f.nb=f.Uc,f.rc=null,Ae=1),Ae=!Ae),!Ae){Ae=f.ga;var he=f.Fa,we=f.P,Ue=f.qc,Ge=f.mb,ct=f.nb,ut=we+1,tt=Ue-1,Pt=Ae.l;if(e(he!=null&&Ge!=null&&m!=null),DA[0]=null,DA[1]=qi,DA[2]=wa,DA[3]=Si,Ae.ca=Ge,Ae.tb=ct,Ae.c=m.width,Ae.i=m.height,e(0<Ae.c&&0<Ae.i),1>=Ue)m=0;else if(Ae.$a=he[we+0]>>0&3,Ae.Z=he[we+0]>>2&3,Ae.Lc=he[we+0]>>4&3,we=he[we+0]>>6&3,0>Ae.$a||1<Ae.$a||4<=Ae.Z||1<Ae.Lc||we)m=0;else if(Pt.put=Qt,Pt.ac=Ft,Pt.bc=Et,Pt.ma=Ae,Pt.width=m.width,Pt.height=m.height,Pt.Da=m.Da,Pt.v=m.v,Pt.va=m.va,Pt.j=m.j,Pt.o=m.o,Ae.$a)e:{e(Ae.$a==1),m=St();t:for(;;){if(m==null){m=0;break e}if(e(Ae!=null),Ae.mc=m,m.c=Ae.c,m.i=Ae.i,m.l=Ae.l,m.l.ma=Ae,m.l.width=Ae.c,m.l.height=Ae.i,m.a=0,te(m.m,he,ut,tt),!jt(Ae.c,Ae.i,1,m,null)||(m.ab==1&&m.gc[0].hc==3&&Rt(m.s)?(Ae.ic=1,he=m.c*m.i,m.Ta=null,m.Ua=0,m.V=s(he),m.Ba=0,m.V==null?(m.a=1,m=0):m=1):(Ae.ic=0,m=dr(m,Ae.c)),!m))break t;m=1;break e}Ae.mc=null,m=0}else m=tt>=Ae.c*Ae.i;Ae=!m}if(Ae)return null;f.ga.Lc!=1?f.Ga=0:T=oe-S}e(f.ga!=null),e(S+T<=oe);e:{if(m=(he=f.ga).c,oe=he.l.o,he.$a==0){if(ut=f.rc,tt=f.Vc,Pt=f.Fa,we=f.P+1+S*m,Ue=f.mb,Ge=f.nb+S*m,e(we<=f.P+f.qc),he.Z!=0)for(e(DA[he.Z]!=null),Ae=0;Ae<T;++Ae)DA[he.Z](ut,tt,Pt,we,Ue,Ge,m),ut=Ue,tt=Ge,Ge+=m,we+=m;else for(Ae=0;Ae<T;++Ae)r(Ue,Ge,Pt,we,m),ut=Ue,tt=Ge,Ge+=m,we+=m;f.rc=ut,f.Vc=tt}else{if(e(he.mc!=null),m=S+T,e((Ae=he.mc)!=null),e(m<=Ae.i),Ae.C>=m)m=1;else if(he.ic||nt(),he.ic){he=Ae.V,ut=Ae.Ba,tt=Ae.c;var xt=Ae.i,We=(Pt=1,we=Ae.$/tt,Ue=Ae.$%tt,Ge=Ae.m,ct=Ae.s,Ae.$),Ze=tt*xt,Tt=tt*m,Mt=ct.wc,Lt=We<Tt?pt(ct,Ue,we):null;e(We<=Ze),e(m<=xt),e(Rt(ct));t:for(;;){for(;!Ge.h&&We<Tt;){if(Ue&Mt||(Lt=pt(ct,Ue,we)),e(Lt!=null),O(Ge),256>(xt=Ut(Lt.G[0],Lt.H[0],Ge)))he[ut+We]=xt,++We,++Ue>=tt&&(Ue=0,++we<=m&&!(we%16)&&Ct(Ae,we));else{if(!(280>xt)){Pt=0;break t}xt=Gt(xt-256,Ge);var or,Xt=Ut(Lt.G[4],Lt.H[4],Ge);if(O(Ge),!(We>=(Xt=Ht(tt,Xt=Gt(Xt,Ge)))&&Ze-We>=xt)){Pt=0;break t}for(or=0;or<xt;++or)he[ut+We+or]=he[ut+We+or-Xt];for(We+=xt,Ue+=xt;Ue>=tt;)Ue-=tt,++we<=m&&!(we%16)&&Ct(Ae,we);We<Tt&&Ue&Mt&&(Lt=pt(ct,Ue,we))}e(Ge.h==F(Ge))}Ct(Ae,we>m?m:we);break t}!Pt||Ge.h&&We<Ze?(Pt=0,Ae.a=Ge.h?5:3):Ae.$=We,m=Pt}else m=Wt(Ae,Ae.V,Ae.Ba,Ae.c,Ae.i,m,pr);if(!m){T=0;break e}}S+T>=oe&&(f.Cc=1),T=1}if(!T)return null;if(f.Cc&&((T=f.ga)!=null&&(T.mc=null),f.ga=null,0<f.Ga))return alert("todo:WebPDequantizeLevels"),null}return f.nb+S*X}function b(f,m,S,T,X,oe){for(;0<X--;){var Ae,he=f,we=m+(S?1:0),Ue=f,Ge=m+(S?0:3);for(Ae=0;Ae<T;++Ae){var ct=Ue[Ge+4*Ae];ct!=255&&(ct*=32897,he[we+4*Ae+0]=he[we+4*Ae+0]*ct>>23,he[we+4*Ae+1]=he[we+4*Ae+1]*ct>>23,he[we+4*Ae+2]=he[we+4*Ae+2]*ct>>23)}m+=oe}}function W(f,m,S,T,X){for(;0<T--;){var oe;for(oe=0;oe<S;++oe){var Ae=f[m+2*oe+0],he=15&(Ue=f[m+2*oe+1]),we=4369*he,Ue=(240&Ue|Ue>>4)*we>>16;f[m+2*oe+0]=(240&Ae|Ae>>4)*we>>16&240|(15&Ae|Ae<<4)*we>>16>>4&15,f[m+2*oe+1]=240&Ue|he}m+=X}}function ke(f,m,S,T,X,oe,Ae,he){var we,Ue,Ge=255;for(Ue=0;Ue<X;++Ue){for(we=0;we<T;++we){var ct=f[m+we];oe[Ae+4*we]=ct,Ge&=ct}m+=S,Ae+=he}return Ge!=255}function Ke(f,m,S,T,X){var oe;for(oe=0;oe<X;++oe)S[T+oe]=f[m+oe]>>8}function nt(){Ii=b,Vn=W,Gn=ke,xo=Ke}function Bt(f,m,S){N[f]=function(T,X,oe,Ae,he,we,Ue,Ge,ct,ut,tt,Pt,xt,We,Ze,Tt,Mt){var Lt,or=Mt-1>>1,Xt=he[we+0]|Ue[Ge+0]<<16,_r=ct[ut+0]|tt[Pt+0]<<16;e(T!=null);var Jt=3*Xt+_r+131074>>2;for(m(T[X+0],255&Jt,Jt>>16,xt,We),oe!=null&&(Jt=3*_r+Xt+131074>>2,m(oe[Ae+0],255&Jt,Jt>>16,Ze,Tt)),Lt=1;Lt<=or;++Lt){var _n=he[we+Lt]|Ue[Ge+Lt]<<16,Qn=ct[ut+Lt]|tt[Pt+Lt]<<16,vn=Xt+_n+_r+Qn+524296,rn=vn+2*(_n+_r)>>3;Jt=rn+Xt>>1,Xt=(vn=vn+2*(Xt+Qn)>>3)+_n>>1,m(T[X+2*Lt-1],255&Jt,Jt>>16,xt,We+(2*Lt-1)*S),m(T[X+2*Lt-0],255&Xt,Xt>>16,xt,We+(2*Lt-0)*S),oe!=null&&(Jt=vn+_r>>1,Xt=rn+Qn>>1,m(oe[Ae+2*Lt-1],255&Jt,Jt>>16,Ze,Tt+(2*Lt-1)*S),m(oe[Ae+2*Lt+0],255&Xt,Xt>>16,Ze,Tt+(2*Lt+0)*S)),Xt=_n,_r=Qn}1&Mt||(Jt=3*Xt+_r+131074>>2,m(T[X+Mt-1],255&Jt,Jt>>16,xt,We+(Mt-1)*S),oe!=null&&(Jt=3*_r+Xt+131074>>2,m(oe[Ae+Mt-1],255&Jt,Jt>>16,Ze,Tt+(Mt-1)*S)))}}function Nt(){Qi[Bh]=_C,Qi[zh]=w2,Qi[f2]=bC,Qi[Ch]=y2,Qi[Sh]=_2,Qi[Yg]=b2,Qi[p2]=xC,Qi[Jg]=w2,Qi[Zg]=y2,Qi[Eh]=_2,Qi[ev]=b2}function Zt(f){return f&-16384?0>f?0:255:f>>BC}function vr(f,m){return Zt((19077*f>>8)+(26149*m>>8)-14234)}function Qr(f,m,S){return Zt((19077*f>>8)-(6419*m>>8)-(13320*S>>8)+8708)}function Tr(f,m){return Zt((19077*f>>8)+(33050*m>>8)-17685)}function Vr(f,m,S,T,X){T[X+0]=vr(f,S),T[X+1]=Qr(f,m,S),T[X+2]=Tr(f,m)}function kn(f,m,S,T,X){T[X+0]=Tr(f,m),T[X+1]=Qr(f,m,S),T[X+2]=vr(f,S)}function Kn(f,m,S,T,X){var oe=Qr(f,m,S);m=oe<<3&224|Tr(f,m)>>3,T[X+0]=248&vr(f,S)|oe>>5,T[X+1]=m}function ro(f,m,S,T,X){var oe=240&Tr(f,m)|15;T[X+0]=240&vr(f,S)|Qr(f,m,S)>>4,T[X+1]=oe}function To(f,m,S,T,X){T[X+0]=255,Vr(f,m,S,T,X+1)}function ao(f,m,S,T,X){kn(f,m,S,T,X),T[X+3]=255}function Wo(f,m,S,T,X){Vr(f,m,S,T,X),T[X+3]=255}function ss(f,m){return 0>f?0:f>m?m:f}function ws(f,m,S){N[f]=function(T,X,oe,Ae,he,we,Ue,Ge,ct){for(var ut=Ge+(-2&ct)*S;Ge!=ut;)m(T[X+0],oe[Ae+0],he[we+0],Ue,Ge),m(T[X+1],oe[Ae+0],he[we+0],Ue,Ge+S),X+=2,++Ae,++we,Ge+=2*S;1&ct&&m(T[X+0],oe[Ae+0],he[we+0],Ue,Ge)}}function _a(f,m,S){return S==0?f==0?m==0?6:5:m==0?4:0:S}function ba(f,m,S,T,X){switch(f>>>30){case 3:rA(m,S,T,X,0);break;case 2:bo(m,S,T,X);break;case 1:Qs(m,S,T,X)}}function Za(f,m){var S,T,X=m.M,oe=m.Nb,Ae=f.oc,he=f.pc+40,we=f.oc,Ue=f.pc+584,Ge=f.oc,ct=f.pc+600;for(S=0;16>S;++S)Ae[he+32*S-1]=129;for(S=0;8>S;++S)we[Ue+32*S-1]=129,Ge[ct+32*S-1]=129;for(0<X?Ae[he-1-32]=we[Ue-1-32]=Ge[ct-1-32]=129:(o(Ae,he-32-1,127,21),o(we,Ue-32-1,127,9),o(Ge,ct-32-1,127,9)),T=0;T<f.za;++T){var ut=m.ya[m.aa+T];if(0<T){for(S=-1;16>S;++S)r(Ae,he+32*S-4,Ae,he+32*S+12,4);for(S=-1;8>S;++S)r(we,Ue+32*S-4,we,Ue+32*S+4,4),r(Ge,ct+32*S-4,Ge,ct+32*S+4,4)}var tt=f.Gd,Pt=f.Hd+T,xt=ut.ad,We=ut.Hc;if(0<X&&(r(Ae,he-32,tt[Pt].y,0,16),r(we,Ue-32,tt[Pt].f,0,8),r(Ge,ct-32,tt[Pt].ea,0,8)),ut.Za){var Ze=Ae,Tt=he-32+16;for(0<X&&(T>=f.za-1?o(Ze,Tt,tt[Pt].y[15],4):r(Ze,Tt,tt[Pt+1].y,0,4)),S=0;4>S;S++)Ze[Tt+128+S]=Ze[Tt+256+S]=Ze[Tt+384+S]=Ze[Tt+0+S];for(S=0;16>S;++S,We<<=2)Ze=Ae,Tt=he+B2[S],Ki[ut.Ob[S]](Ze,Tt),ba(We,xt,16*+S,Ze,Tt)}else if(Ze=_a(T,X,ut.Ob[0]),OA[Ze](Ae,he),We!=0)for(S=0;16>S;++S,We<<=2)ba(We,xt,16*+S,Ae,he+B2[S]);for(S=ut.Gc,Ze=_a(T,X,ut.Dd),oA[Ze](we,Ue),oA[Ze](Ge,ct),We=xt,Ze=we,Tt=Ue,255&(ut=S>>0)&&(170&ut?Kc(We,256,Ze,Tt):Ei(We,256,Ze,Tt)),ut=Ge,We=ct,255&(S>>=8)&&(170&S?Kc(xt,320,ut,We):Ei(xt,320,ut,We)),X<f.Ub-1&&(r(tt[Pt].y,0,Ae,he+480,16),r(tt[Pt].f,0,we,Ue+224,8),r(tt[Pt].ea,0,Ge,ct+224,8)),S=8*oe*f.B,tt=f.sa,Pt=f.ta+16*T+16*oe*f.R,xt=f.qa,ut=f.ra+8*T+S,We=f.Ha,Ze=f.Ia+8*T+S,S=0;16>S;++S)r(tt,Pt+S*f.R,Ae,he+32*S,16);for(S=0;8>S;++S)r(xt,ut+S*f.B,we,Ue+32*S,8),r(We,Ze+S*f.B,Ge,ct+32*S,8)}}function Un(f,m,S,T,X,oe,Ae,he,we){var Ue=[0],Ge=[0],ct=0,ut=we!=null?we.kd:0,tt=we??new ga;if(f==null||12>S)return 7;tt.data=f,tt.w=m,tt.ha=S,m=[m],S=[S],tt.gb=[tt.gb];e:{var Pt=m,xt=S,We=tt.gb;if(e(f!=null),e(xt!=null),e(We!=null),We[0]=0,12<=xt[0]&&!t(f,Pt[0],"RIFF")){if(t(f,Pt[0]+8,"WEBP")){We=3;break e}var Ze=Me(f,Pt[0]+4);if(12>Ze||4294967286<Ze){We=3;break e}if(ut&&Ze>xt[0]-8){We=7;break e}We[0]=Ze,Pt[0]+=12,xt[0]-=12}We=0}if(We!=0)return We;for(Ze=0<tt.gb[0],S=S[0];;){e:{var Tt=f;xt=m,We=S;var Mt=Ue,Lt=Ge,or=Pt=[0];if((Jt=ct=[ct])[0]=0,8>We[0])We=7;else{if(!t(Tt,xt[0],"VP8X")){if(Me(Tt,xt[0]+4)!=10){We=3;break e}if(18>We[0]){We=7;break e}var Xt=Me(Tt,xt[0]+8),_r=1+_e(Tt,xt[0]+12);if(2147483648<=_r*(Tt=1+_e(Tt,xt[0]+15))){We=3;break e}or!=null&&(or[0]=Xt),Mt!=null&&(Mt[0]=_r),Lt!=null&&(Lt[0]=Tt),xt[0]+=18,We[0]-=18,Jt[0]=1}We=0}}if(ct=ct[0],Pt=Pt[0],We!=0)return We;if(xt=!!(2&Pt),!Ze&&ct)return 3;if(oe!=null&&(oe[0]=!!(16&Pt)),Ae!=null&&(Ae[0]=xt),he!=null&&(he[0]=0),Ae=Ue[0],Pt=Ge[0],ct&&xt&&we==null){We=0;break}if(4>S){We=7;break}if(Ze&&ct||!Ze&&!ct&&!t(f,m[0],"ALPH")){S=[S],tt.na=[tt.na],tt.P=[tt.P],tt.Sa=[tt.Sa];e:{Xt=f,We=m,Ze=S;var Jt=tt.gb;Mt=tt.na,Lt=tt.P,or=tt.Sa,_r=22,e(Xt!=null),e(Ze!=null),Tt=We[0];var _n=Ze[0];for(e(Mt!=null),e(or!=null),Mt[0]=null,Lt[0]=null,or[0]=0;;){if(We[0]=Tt,Ze[0]=_n,8>_n){We=7;break e}var Qn=Me(Xt,Tt+4);if(4294967286<Qn){We=3;break e}var vn=8+Qn+1&-2;if(_r+=vn,0<Jt&&_r>Jt){We=3;break e}if(!t(Xt,Tt,"VP8 ")||!t(Xt,Tt,"VP8L")){We=0;break e}if(_n[0]<vn){We=7;break e}t(Xt,Tt,"ALPH")||(Mt[0]=Xt,Lt[0]=Tt+8,or[0]=Qn),Tt+=vn,_n-=vn}}if(S=S[0],tt.na=tt.na[0],tt.P=tt.P[0],tt.Sa=tt.Sa[0],We!=0)break}S=[S],tt.Ja=[tt.Ja],tt.xa=[tt.xa];e:if(Jt=f,We=m,Ze=S,Mt=tt.gb[0],Lt=tt.Ja,or=tt.xa,Xt=We[0],Tt=!t(Jt,Xt,"VP8 "),_r=!t(Jt,Xt,"VP8L"),e(Jt!=null),e(Ze!=null),e(Lt!=null),e(or!=null),8>Ze[0])We=7;else{if(Tt||_r){if(Jt=Me(Jt,Xt+4),12<=Mt&&Jt>Mt-12){We=3;break e}if(ut&&Jt>Ze[0]-8){We=7;break e}Lt[0]=Jt,We[0]+=8,Ze[0]-=8,or[0]=_r}else or[0]=5<=Ze[0]&&Jt[Xt+0]==47&&!(Jt[Xt+4]>>5),Lt[0]=Ze[0];We=0}if(S=S[0],tt.Ja=tt.Ja[0],tt.xa=tt.xa[0],m=m[0],We!=0)break;if(4294967286<tt.Ja)return 3;if(he==null||xt||(he[0]=tt.xa?2:1),Ae=[Ae],Pt=[Pt],tt.xa){if(5>S){We=7;break}he=Ae,ut=Pt,xt=oe,f==null||5>S?f=0:5<=S&&f[m+0]==47&&!(f[m+4]>>5)?(Ze=[0],Jt=[0],Mt=[0],te(Lt=new z,f,m,S),mt(Lt,Ze,Jt,Mt)?(he!=null&&(he[0]=Ze[0]),ut!=null&&(ut[0]=Jt[0]),xt!=null&&(xt[0]=Mt[0]),f=1):f=0):f=0}else{if(10>S){We=7;break}he=Pt,f==null||10>S||!En(f,m+3,S-3)?f=0:(ut=f[m+0]|f[m+1]<<8|f[m+2]<<16,xt=16383&(f[m+7]<<8|f[m+6]),f=16383&(f[m+9]<<8|f[m+8]),1&ut||3<(ut>>1&7)||!(ut>>4&1)||ut>>5>=tt.Ja||!xt||!f?f=0:(Ae&&(Ae[0]=xt),he&&(he[0]=f),f=1))}if(!f||(Ae=Ae[0],Pt=Pt[0],ct&&(Ue[0]!=Ae||Ge[0]!=Pt)))return 3;we!=null&&(we[0]=tt,we.offset=m-we.w,e(4294967286>m-we.w),e(we.offset==we.ha-S));break}return We==0||We==7&&ct&&we==null?(oe!=null&&(oe[0]|=tt.na!=null&&0<tt.na.length),T!=null&&(T[0]=Ae),X!=null&&(X[0]=Pt),0):We}function Ao(f,m,S){var T=m.width,X=m.height,oe=0,Ae=0,he=T,we=X;if(m.Da=f!=null&&0<f.Da,m.Da&&(he=f.cd,we=f.bd,oe=f.v,Ae=f.j,11>S||(oe&=-2,Ae&=-2),0>oe||0>Ae||0>=he||0>=we||oe+he>T||Ae+we>X))return 0;if(m.v=oe,m.j=Ae,m.va=oe+he,m.o=Ae+we,m.U=he,m.T=we,m.da=f!=null&&0<f.da,m.da){if(!ee(he,we,S=[f.ib],oe=[f.hb]))return 0;m.ib=S[0],m.hb=oe[0]}return m.ob=f!=null&&f.ob,m.Kb=f==null||!f.Sd,m.da&&(m.ob=m.ib<3*T/4&&m.hb<3*X/4,m.Kb=0),1}function Xo(f){if(f==null)return 2;if(11>f.S){var m=f.f.RGBA;m.fb+=(f.height-1)*m.A,m.A=-m.A}else m=f.f.kb,f=f.height,m.O+=(f-1)*m.fa,m.fa=-m.fa,m.N+=(f-1>>1)*m.Ab,m.Ab=-m.Ab,m.W+=(f-1>>1)*m.Db,m.Db=-m.Db,m.F!=null&&(m.J+=(f-1)*m.lb,m.lb=-m.lb);return 0}function is(f,m,S,T){if(T==null||0>=f||0>=m)return 2;if(S!=null){if(S.Da){var X=S.cd,oe=S.bd,Ae=-2&S.v,he=-2&S.j;if(0>Ae||0>he||0>=X||0>=oe||Ae+X>f||he+oe>m)return 2;f=X,m=oe}if(S.da){if(!ee(f,m,X=[S.ib],oe=[S.hb]))return 2;f=X[0],m=oe[0]}}T.width=f,T.height=m;e:{var we=T.width,Ue=T.height;if(f=T.S,0>=we||0>=Ue||!(f>=Bh&&13>f))f=2;else{if(0>=T.Rd&&T.sd==null){Ae=oe=X=m=0;var Ge=(he=we*z2[f])*Ue;if(11>f||(oe=(Ue+1)/2*(m=(we+1)/2),f==12&&(Ae=(X=we)*Ue)),(Ue=s(Ge+2*oe+Ae))==null){f=1;break e}T.sd=Ue,11>f?((we=T.f.RGBA).eb=Ue,we.fb=0,we.A=he,we.size=Ge):((we=T.f.kb).y=Ue,we.O=0,we.fa=he,we.Fd=Ge,we.f=Ue,we.N=0+Ge,we.Ab=m,we.Cd=oe,we.ea=Ue,we.W=0+Ge+oe,we.Db=m,we.Ed=oe,f==12&&(we.F=Ue,we.J=0+Ge+2*oe),we.Tc=Ae,we.lb=X)}if(m=1,X=T.S,oe=T.width,Ae=T.height,X>=Bh&&13>X)if(11>X)f=T.f.RGBA,m&=(he=Math.abs(f.A))*(Ae-1)+oe<=f.size,m&=he>=oe*z2[X],m&=f.eb!=null;else{f=T.f.kb,he=(oe+1)/2,Ge=(Ae+1)/2,we=Math.abs(f.fa),Ue=Math.abs(f.Ab);var ct=Math.abs(f.Db),ut=Math.abs(f.lb),tt=ut*(Ae-1)+oe;m&=we*(Ae-1)+oe<=f.Fd,m&=Ue*(Ge-1)+he<=f.Cd,m=(m&=ct*(Ge-1)+he<=f.Ed)&we>=oe&Ue>=he&ct>=he,m&=f.y!=null,m&=f.f!=null,m&=f.ea!=null,X==12&&(m&=ut>=oe,m&=tt<=f.Tc,m&=f.F!=null)}else m=0;f=m?0:2}}return f!=0||S!=null&&S.fd&&(f=Xo(T)),f}var _o=64,Nr=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],un=24,xn=32,Ho=8,$n=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];me("Predictor0","PredictorAdd0"),N.Predictor0=function(){return 4278190080},N.Predictor1=function(f){return f},N.Predictor2=function(f,m,S){return m[S+0]},N.Predictor3=function(f,m,S){return m[S+1]},N.Predictor4=function(f,m,S){return m[S-1]},N.Predictor5=function(f,m,S){return Ee(Ee(f,m[S+1]),m[S+0])},N.Predictor6=function(f,m,S){return Ee(f,m[S-1])},N.Predictor7=function(f,m,S){return Ee(f,m[S+0])},N.Predictor8=function(f,m,S){return Ee(m[S-1],m[S+0])},N.Predictor9=function(f,m,S){return Ee(m[S+0],m[S+1])},N.Predictor10=function(f,m,S){return Ee(Ee(f,m[S-1]),Ee(m[S+0],m[S+1]))},N.Predictor11=function(f,m,S){var T=m[S+0];return 0>=Fe(T>>24&255,f>>24&255,(m=m[S-1])>>24&255)+Fe(T>>16&255,f>>16&255,m>>16&255)+Fe(T>>8&255,f>>8&255,m>>8&255)+Fe(255&T,255&f,255&m)?T:f},N.Predictor12=function(f,m,S){var T=m[S+0];return(de((f>>24&255)+(T>>24&255)-((m=m[S-1])>>24&255))<<24|de((f>>16&255)+(T>>16&255)-(m>>16&255))<<16|de((f>>8&255)+(T>>8&255)-(m>>8&255))<<8|de((255&f)+(255&T)-(255&m)))>>>0},N.Predictor13=function(f,m,S){var T=m[S-1];return(Qe((f=Ee(f,m[S+0]))>>24&255,T>>24&255)<<24|Qe(f>>16&255,T>>16&255)<<16|Qe(f>>8&255,T>>8&255)<<8|Qe(f>>0&255,T>>0&255))>>>0};var jo=N.PredictorAdd0;N.PredictorAdd1=Oe,me("Predictor2","PredictorAdd2"),me("Predictor3","PredictorAdd3"),me("Predictor4","PredictorAdd4"),me("Predictor5","PredictorAdd5"),me("Predictor6","PredictorAdd6"),me("Predictor7","PredictorAdd7"),me("Predictor8","PredictorAdd8"),me("Predictor9","PredictorAdd9"),me("Predictor10","PredictorAdd10"),me("Predictor11","PredictorAdd11"),me("Predictor12","PredictorAdd12"),me("Predictor13","PredictorAdd13");var lo=N.PredictorAdd2;Ie("ColorIndexInverseTransform","MapARGB","32b",function(f){return f>>8&255},function(f){return f}),Ie("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(f){return f},function(f){return f>>8&255});var ci,Yo=N.ColorIndexInverseTransform,eA=N.MapARGB,xl=N.VP8LColorIndexInverseTransformAlpha,vd=N.MapAlpha,xa=N.VP8LPredictorsAdd=[];xa.length=16,(N.VP8LPredictors=[]).length=16,(N.VP8LPredictorsAdd_C=[]).length=16,(N.VP8LPredictors_C=[]).length=16;var tA,as,As,Us,ls,ui,md,rA,bo,Kc,Qs,Ei,wd,_h,$c,Bl,zl,PA,Cl,yd,Sl,kA,Vc,Fi,Ii,Vn,Gn,xo,Ro=s(511),nA=s(2041),Gc=s(225),_d=s(767),bh=0,Xg=nA,xh=Gc,hi=_d,Ui=Ro,Bh=0,zh=1,f2=2,Ch=3,Sh=4,Yg=5,p2=6,Jg=7,Zg=8,Eh=9,ev=10,aC=[2,3,7],AC=[3,3,11],g2=[280,256,256,256,40],lC=[0,1,1,1,0],dC=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],cC=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],uC=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hC=8,tv=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],rv=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Wc=null,fC=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],pC=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],v2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],gC=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],vC=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],mC=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],wC=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],OA=[],Ki=[],oA=[],yC=1,m2=2,DA=[],Qi=[];Bt("UpsampleRgbLinePair",Vr,3),Bt("UpsampleBgrLinePair",kn,3),Bt("UpsampleRgbaLinePair",Wo,4),Bt("UpsampleBgraLinePair",ao,4),Bt("UpsampleArgbLinePair",To,4),Bt("UpsampleRgba4444LinePair",ro,2),Bt("UpsampleRgb565LinePair",Kn,2);var _C=N.UpsampleRgbLinePair,bC=N.UpsampleBgrLinePair,w2=N.UpsampleRgbaLinePair,y2=N.UpsampleBgraLinePair,_2=N.UpsampleArgbLinePair,b2=N.UpsampleRgba4444LinePair,xC=N.UpsampleRgb565LinePair,Fh=16,Ih=1<<Fh-1,Xc=-227,nv=482,BC=6,x2=0,zC=s(256),CC=s(256),SC=s(256),EC=s(256),FC=s(nv-Xc),IC=s(nv-Xc);ws("YuvToRgbRow",Vr,3),ws("YuvToBgrRow",kn,3),ws("YuvToRgbaRow",Wo,4),ws("YuvToBgraRow",ao,4),ws("YuvToArgbRow",To,4),ws("YuvToRgba4444Row",ro,2),ws("YuvToRgb565Row",Kn,2);var B2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Uh=[0,2,8],UC=[8,7,6,4,4,2,2,2,1,1,1,1],QC=1;this.WebPDecodeRGBA=function(f,m,S,T,X){var oe=zh,Ae=new Ci,he=new ot;Ae.ba=he,he.S=oe,he.width=[he.width],he.height=[he.height];var we=he.width,Ue=he.height,Ge=new Pe;if(Ge==null||f==null)var ct=2;else e(Ge!=null),ct=Un(f,m,S,Ge.width,Ge.height,Ge.Pd,Ge.Qd,Ge.format,null);if(ct!=0?we=0:(we!=null&&(we[0]=Ge.width[0]),Ue!=null&&(Ue[0]=Ge.height[0]),we=1),we){he.width=he.width[0],he.height=he.height[0],T!=null&&(T[0]=he.width),X!=null&&(X[0]=he.height);e:{if(T=new pn,(X=new ga).data=f,X.w=m,X.ha=S,X.kd=1,m=[0],e(X!=null),((f=Un(X.data,X.w,X.ha,null,null,null,m,null,X))==0||f==7)&&m[0]&&(f=4),(m=f)==0){if(e(Ae!=null),T.data=X.data,T.w=X.w+X.offset,T.ha=X.ha-X.offset,T.put=Qt,T.ac=Ft,T.bc=Et,T.ma=Ae,X.xa){if((f=St())==null){Ae=1;break e}if(function(ut,tt){var Pt=[0],xt=[0],We=[0];t:for(;;){if(ut==null)return 0;if(tt==null)return ut.a=2,0;if(ut.l=tt,ut.a=0,te(ut.m,tt.data,tt.w,tt.ha),!mt(ut.m,Pt,xt,We)){ut.a=3;break t}if(ut.xb=m2,tt.width=Pt[0],tt.height=xt[0],!jt(Pt[0],xt[0],1,ut,null))break t;return 1}return e(ut.a!=0),0}(f,T)){if(T=(m=is(T.width,T.height,Ae.Oa,Ae.ba))==0){t:{T=f;r:for(;;){if(T==null){T=0;break t}if(e(T.s.yc!=null),e(T.s.Ya!=null),e(0<T.s.Wb),e((S=T.l)!=null),e((X=S.ma)!=null),T.xb!=0){if(T.ca=X.ba,T.tb=X.tb,e(T.ca!=null),!Ao(X.Oa,S,Ch)){T.a=2;break r}if(!dr(T,S.width)||S.da)break r;if((S.da||Re(T.ca.S))&&nt(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&nt()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!$e(T.s.vb,T.s.Wa.Xa)){T.a=1;break r}T.xb=0}if(!Wt(T,T.V,T.Ba,T.c,T.i,S.o,$t))break r;X.Dc=T.Ma,T=1;break t}e(T.a!=0),T=0}T=!T}T&&(m=f.a)}else m=f.a}else{if((f=new Wr)==null){Ae=1;break e}if(f.Fa=X.na,f.P=X.P,f.qc=X.Sa,Do(f,T)){if((m=is(T.width,T.height,Ae.Oa,Ae.ba))==0){if(f.Aa=0,S=Ae.Oa,e((X=f)!=null),S!=null){if(0<(we=0>(we=S.Md)?0:100<we?255:255*we/100)){for(Ue=Ge=0;4>Ue;++Ue)12>(ct=X.pb[Ue]).lc&&(ct.ia=we*UC[0>ct.lc?0:ct.lc]>>3),Ge|=ct.ia;Ge&&(alert("todo:VP8InitRandom"),X.ia=1)}X.Ga=S.Id,100<X.Ga?X.Ga=100:0>X.Ga&&(X.Ga=0)}vs(f,T)||(m=f.a)}}else m=f.a}m==0&&Ae.Oa!=null&&Ae.Oa.fd&&(m=Xo(Ae.ba))}Ae=m}oe=Ae!=0?null:11>oe?he.f.RGBA.eb:he.f.kb.y}else oe=null;return oe};var z2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(N,re){for(var be="",L=0;L<4;L++)be+=String.fromCharCode(N[re++]);return be}function c(N,re){return(N[re+0]<<0|N[re+1]<<8|N[re+2]<<16)>>>0}function u(N,re){return(N[re+0]<<0|N[re+1]<<8|N[re+2]<<16|N[re+3]<<24)>>>0}new A;var h=[0],p=[0],v=[],w=new A,y=n,B=function(N,re){var be={},L=0,R=!1,J=0,se=0;if(be.frames=[],!function(E,F,I,O){for(var D=0;D<O;D++)if(E[F+D]!=I.charCodeAt(D))return!0;return!1}(N,re,"RIFF",4)){var fe,ie;for(u(N,re+=4),re+=8;re<N.length;){var pe=d(N,re),te=u(N,re+=4);re+=4;var Ce=te+(1&te);switch(pe){case"VP8 ":case"VP8L":be.frames[L]===void 0&&(be.frames[L]={}),(z=be.frames[L]).src_off=R?se:re-8,z.src_size=J+te+8,L++,R&&(R=!1,J=0,se=0);break;case"VP8X":(z=be.header={}).feature_flags=N[re];var ne=re+4;z.canvas_width=1+c(N,ne),ne+=3,z.canvas_height=1+c(N,ne),ne+=3;break;case"ALPH":R=!0,J=Ce+8,se=re-8;break;case"ANIM":(z=be.header).bgcolor=u(N,re),ne=re+4,z.loop_count=(fe=N)[(ie=ne)+0]<<0|fe[ie+1]<<8,ne+=2;break;case"ANMF":var ze,z;(z=be.frames[L]={}).offset_x=2*c(N,re),re+=3,z.offset_y=2*c(N,re),re+=3,z.width=1+c(N,re),re+=3,z.height=1+c(N,re),re+=3,z.duration=c(N,re),re+=3,ze=N[re++],z.dispose=1&ze,z.blend=ze>>1&1}pe!="ANMF"&&(re+=Ce)}return be}}(y,0);B.response=y,B.rgbaoutput=!0,B.dataurl=!1;var C=B.header?B.header:null,Q=B.frames?B.frames:null;if(C){C.loop_counter=C.loop_count,h=[C.canvas_height],p=[C.canvas_width];for(var k=0;k<Q.length&&Q[k].blend!=0;k++);}var H=Q[0],Z=w.WebPDecodeRGBA(y,H.src_off,H.src_size,p,h);H.rgba=Z,H.imgwidth=p[0],H.imgheight=h[0];for(var q=0;q<p[0]*h[0]*4;q++)v[q]=Z[q];return this.width=p,this.height=h,this.data=v,this}(function(n){var e=function(){return typeof Fm=="function"},t=function(h,p,v,w){var y=4,B=i;switch(w){case n.image_compression.FAST:y=1,B=s;break;case n.image_compression.MEDIUM:y=6,B=a;break;case n.image_compression.SLOW:y=9,B=A}h=r(h,p,v,B);var C=Fm(h,{level:y});return n.__addimage__.arrayBufferToBinaryString(C)},r=function(h,p,v,w){for(var y,B,C,Q=h.length/p,k=new Uint8Array(h.length+Q),H=c(),Z=0;Z<Q;Z+=1){if(C=Z*p,y=h.subarray(C,C+p),w)k.set(w(y,v,B),C+Z);else{for(var q,N=H.length,re=[];q<N;q+=1)re[q]=H[q](y,v,B);var be=u(re.concat());k.set(re[be],C+Z)}B=y}return k},o=function(h){var p=Array.apply([],h);return p.unshift(0),p},s=function(h,p){var v,w=[],y=h.length;w[0]=1;for(var B=0;B<y;B+=1)v=h[B-p]||0,w[B+1]=h[B]-v+256&255;return w},i=function(h,p,v){var w,y=[],B=h.length;y[0]=2;for(var C=0;C<B;C+=1)w=v&&v[C]||0,y[C+1]=h[C]-w+256&255;return y},a=function(h,p,v){var w,y,B=[],C=h.length;B[0]=3;for(var Q=0;Q<C;Q+=1)w=h[Q-p]||0,y=v&&v[Q]||0,B[Q+1]=h[Q]+256-(w+y>>>1)&255;return B},A=function(h,p,v){var w,y,B,C,Q=[],k=h.length;Q[0]=4;for(var H=0;H<k;H+=1)w=h[H-p]||0,y=v&&v[H]||0,B=v&&v[H-p]||0,C=d(w,y,B),Q[H+1]=h[H]-C+256&255;return Q},d=function(h,p,v){if(h===p&&p===v)return h;var w=Math.abs(p-v),y=Math.abs(h-v),B=Math.abs(h+p-v-v);return w<=y&&w<=B?h:y<=B?p:v},c=function(){return[o,s,i,a,A]},u=function(h){var p=h.map(function(v){return v.reduce(function(w,y){return w+Math.abs(y)},0)});return p.indexOf(Math.min.apply(null,p))};n.processPNG=function(h,p,v,w){var y,B,C,Q,k,H,Z,q,N,re,be,L,R,J,se,fe=this.decode.FLATE_DECODE,ie="";if(this.__addimage__.isArrayBuffer(h)&&(h=new Uint8Array(h)),this.__addimage__.isArrayBufferView(h)){if(h=(C=new yN(h)).imgData,B=C.bits,y=C.colorSpace,k=C.colors,[4,6].indexOf(C.colorType)!==-1){if(C.bits===8){N=(q=C.pixelBitlength==32?new Uint32Array(C.decodePixels().buffer):C.pixelBitlength==16?new Uint16Array(C.decodePixels().buffer):new Uint8Array(C.decodePixels().buffer)).length,be=new Uint8Array(N*C.colors),re=new Uint8Array(N);var pe,te=C.pixelBitlength-C.bits;for(J=0,se=0;J<N;J++){for(R=q[J],pe=0;pe<te;)be[se++]=R>>>pe&255,pe+=C.bits;re[J]=R>>>pe&255}}if(C.bits===16){N=(q=new Uint32Array(C.decodePixels().buffer)).length,be=new Uint8Array(N*(32/C.pixelBitlength)*C.colors),re=new Uint8Array(N*(32/C.pixelBitlength)),L=C.colors>1,J=0,se=0;for(var Ce=0;J<N;)R=q[J++],be[se++]=R>>>0&255,L&&(be[se++]=R>>>16&255,R=q[J++],be[se++]=R>>>0&255),re[Ce++]=R>>>16&255;B=8}w!==n.image_compression.NONE&&e()?(h=t(be,C.width*C.colors,C.colors,w),Z=t(re,C.width,1,w)):(h=be,Z=re,fe=void 0)}if(C.colorType===3&&(y=this.color_spaces.INDEXED,H=C.palette,C.transparency.indexed)){var ne=C.transparency.indexed,ze=0;for(J=0,N=ne.length;J<N;++J)ze+=ne[J];if((ze/=255)===N-1&&ne.indexOf(0)!==-1)Q=[ne.indexOf(0)];else if(ze!==N){for(q=C.decodePixels(),re=new Uint8Array(q.length),J=0,N=q.length;J<N;J++)re[J]=ne[q[J]];Z=t(re,C.width,1)}}var z=function(E){var F;switch(E){case n.image_compression.FAST:F=11;break;case n.image_compression.MEDIUM:F=13;break;case n.image_compression.SLOW:F=14;break;default:F=12}return F}(w);return fe===this.decode.FLATE_DECODE&&(ie="/Predictor "+z+" "),ie+="/Colors "+k+" /BitsPerComponent "+B+" /Columns "+C.width,(this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),(Z&&this.__addimage__.isArrayBuffer(Z)||this.__addimage__.isArrayBufferView(Z))&&(Z=this.__addimage__.arrayBufferToBinaryString(Z)),{alias:v,data:h,index:p,filter:fe,decodeParameters:ie,transparency:Q,palette:H,sMask:Z,predictor:z,width:C.width,height:C.height,bitsPerComponent:B,colorSpace:y}}}})(zr.API),function(n){n.processGIF89A=function(e,t,r,o){var s=new _N(e),i=s.width,a=s.height,A=[];s.decodeAndBlitFrameRGBA(0,A);var d={data:A,width:i,height:a},c=new l0(100).encode(d,100);return n.processJPEG.call(this,c,t,r,o)},n.processGIF87A=n.processGIF89A}(zr.API),Wi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var n=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(n);for(var e=0;e<n;e++){var t=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[e]={red:o,green:r,blue:t,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Wi.prototype.parseBGR=function(){this.pos=this.offset;try{var n="bit"+this.bitPP,e=this.width*this.height*4;this.data=new Uint8Array(e),this[n]()}catch(t){Hn.log("bit decode error:"+t)}},Wi.prototype.bit1=function(){var n,e=Math.ceil(this.width/8),t=e%4;for(n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,o=0;o<e;o++)for(var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+8*o*4,a=0;a<8&&8*o+a<this.width;a++){var A=this.palette[s>>7-a&1];this.data[i+4*a]=A.blue,this.data[i+4*a+1]=A.green,this.data[i+4*a+2]=A.red,this.data[i+4*a+3]=255}t!==0&&(this.pos+=4-t)}},Wi.prototype.bit4=function(){for(var n=Math.ceil(this.width/2),e=n%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<n;o++){var s=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+2*o*4,a=s>>4,A=15&s,d=this.palette[a];if(this.data[i]=d.blue,this.data[i+1]=d.green,this.data[i+2]=d.red,this.data[i+3]=255,2*o+1>=this.width)break;d=this.palette[A],this.data[i+4]=d.blue,this.data[i+4+1]=d.green,this.data[i+4+2]=d.red,this.data[i+4+3]=255}e!==0&&(this.pos+=4-e)}},Wi.prototype.bit8=function(){for(var n=this.width%4,e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var o=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;if(o<this.palette.length){var i=this.palette[o];this.data[s]=i.red,this.data[s+1]=i.green,this.data[s+2]=i.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}n!==0&&(this.pos+=4-n)}},Wi.prototype.bit15=function(){for(var n=this.width%3,e=parseInt("11111",2),t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,o=0;o<this.width;o++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var i=(s&e)/e*255|0,a=(s>>5&e)/e*255|0,A=(s>>10&e)/e*255|0,d=s>>15?255:0,c=r*this.width*4+4*o;this.data[c]=A,this.data[c+1]=a,this.data[c+2]=i,this.data[c+3]=d}this.pos+=n}},Wi.prototype.bit16=function(){for(var n=this.width%3,e=parseInt("11111",2),t=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var o=this.bottom_up?r:this.height-1-r,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(i&e)/e*255|0,A=(i>>5&t)/t*255|0,d=(i>>11)/e*255|0,c=o*this.width*4+4*s;this.data[c]=d,this.data[c+1]=A,this.data[c+2]=a,this.data[c+3]=255}this.pos+=n}},Wi.prototype.bit24=function(){for(var n=this.height-1;n>=0;n--){for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=e*this.width*4+4*t;this.data[i]=s,this.data[i+1]=o,this.data[i+2]=r,this.data[i+3]=255}this.pos+=this.width%4}},Wi.prototype.bit32=function(){for(var n=this.height-1;n>=0;n--)for(var e=this.bottom_up?n:this.height-1-n,t=0;t<this.width;t++){var r=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=e*this.width*4+4*t;this.data[a]=s,this.data[a+1]=o,this.data[a+2]=r,this.data[a+3]=i}},Wi.prototype.getData=function(){return this.data},function(n){n.processBMP=function(e,t,r,o){var s=new Wi(e,!1),i=s.width,a=s.height,A={data:s.getData(),width:i,height:a},d=new l0(100).encode(A,100);return n.processJPEG.call(this,d,t,r,o)}}(zr.API),E_.prototype.getData=function(){return this.data},function(n){n.processWEBP=function(e,t,r,o){var s=new E_(e),i=s.width,a=s.height,A={data:s.getData(),width:i,height:a},d=new l0(100).encode(A,100);return n.processJPEG.call(this,d,t,r,o)}}(zr.API),zr.API.processRGBA=function(n,e,t){for(var r=n.data,o=r.length,s=new Uint8Array(o/4*3),i=new Uint8Array(o/4),a=0,A=0,d=0;d<o;d+=4){var c=r[d],u=r[d+1],h=r[d+2],p=r[d+3];s[a++]=c,s[a++]=u,s[a++]=h,i[A++]=p}var v=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(i),data:v,index:e,alias:t,colorSpace:"DeviceRGB",bitsPerComponent:8,width:n.width,height:n.height}},zr.API.setLanguage=function(n){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[n]!==void 0&&(this.internal.languageSettings.languageCode=n,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},$d=zr.API,Vf=$d.getCharWidthsArray=function(n,e){var t,r,o=(e=e||{}).font||this.internal.getFont(),s=e.fontSize||this.internal.getFontSize(),i=e.charSpace||this.internal.getCharSpace(),a=e.widths?e.widths:o.metadata.Unicode.widths,A=a.fof?a.fof:1,d=e.kerning?e.kerning:o.metadata.Unicode.kerning,c=d.fof?d.fof:1,u=e.doKerning!==!1,h=0,p=n.length,v=0,w=a[0]||A,y=[];for(t=0;t<p;t++)r=n.charCodeAt(t),typeof o.metadata.widthOfString=="function"?y.push((o.metadata.widthOfGlyph(o.metadata.characterToGlyph(r))+i*(1e3/s)||0)/1e3):(h=u&&Pn(d[r])==="object"&&!isNaN(parseInt(d[r][v],10))?d[r][v]/c:0,y.push((a[r]||w)/A+h)),v=r;return y},B_=$d.getStringUnitWidth=function(n,e){var t=(e=e||{}).fontSize||this.internal.getFontSize(),r=e.font||this.internal.getFont(),o=e.charSpace||this.internal.getCharSpace();return $d.processArabic&&(n=$d.processArabic(n)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(n,t,o)/t:Vf.apply(this,arguments).reduce(function(s,i){return s+i},0)},z_=function(n,e,t,r){for(var o=[],s=0,i=n.length,a=0;s!==i&&a+e[s]<t;)a+=e[s],s++;o.push(n.slice(0,s));var A=s;for(a=0;s!==i;)a+e[s]>r&&(o.push(n.slice(A,s)),a=0,A=s),a+=e[s],s++;return A!==s&&o.push(n.slice(A,s)),o},C_=function(n,e,t){t||(t={});var r,o,s,i,a,A,d,c=[],u=[c],h=t.textIndent||0,p=0,v=0,w=n.split(" "),y=Vf.apply(this,[" ",t])[0];if(A=t.lineIndent===-1?w[0].length+2:t.lineIndent||0){var B=Array(A).join(" "),C=[];w.map(function(k){(k=k.split(/\s*\n/)).length>1?C=C.concat(k.map(function(H,Z){return(Z&&H.length?`
`:"")+H})):C.push(k[0])}),w=C,A=B_.apply(this,[B,t])}for(s=0,i=w.length;s<i;s++){var Q=0;if(r=w[s],A&&r[0]==`
`&&(r=r.substr(1),Q=1),h+p+(v=(o=Vf.apply(this,[r,t])).reduce(function(k,H){return k+H},0))>e||Q){if(v>e){for(a=z_.apply(this,[r,o,e-(h+p),e]),c.push(a.shift()),c=[a.pop()];a.length;)u.push([a.shift()]);v=o.slice(r.length-(c[0]?c[0].length:0)).reduce(function(k,H){return k+H},0)}else c=[r];u.push(c),h=v+A,p=y}else c.push(r),h+=p+v,p=y}return d=A?function(k,H){return(H?B:"")+k.join(" ")}:function(k){return k.join(" ")},u.map(d)},$d.splitTextToSize=function(n,e,t){var r,o=(t=t||{}).fontSize||this.internal.getFontSize(),s=(function(c){if(c.widths&&c.kerning)return{widths:c.widths,kerning:c.kerning};var u=this.internal.getFont(c.fontName,c.fontStyle);return u.metadata.Unicode?{widths:u.metadata.Unicode.widths||{0:1},kerning:u.metadata.Unicode.kerning||{}}:{font:u.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,t);r=Array.isArray(n)?n:String(n).split(/\r?\n/);var i=1*this.internal.scaleFactor*e/o;s.textIndent=t.textIndent?1*t.textIndent*this.internal.scaleFactor/o:0,s.lineIndent=t.lineIndent;var a,A,d=[];for(a=0,A=r.length;a<A;a++)d=d.concat(C_.apply(this,[r[a],i,s]));return d},function(n){n.__fontmetrics__=n.__fontmetrics__||{};for(var e="klmnopqrstuvwxyz",t={},r={},o=0;o<e.length;o++)t[e[o]]="0123456789abcdef"[o],r["0123456789abcdef"[o]]=e[o];var s=function(u){return"0x"+parseInt(u,10).toString(16)},i=n.__fontmetrics__.compress=function(u){var h,p,v,w,y=["{"];for(var B in u){if(h=u[B],isNaN(parseInt(B,10))?p="'"+B+"'":(B=parseInt(B,10),p=(p=s(B).slice(2)).slice(0,-1)+r[p.slice(-1)]),typeof h=="number")h<0?(v=s(h).slice(3),w="-"):(v=s(h).slice(2),w=""),v=w+v.slice(0,-1)+r[v.slice(-1)];else{if(Pn(h)!=="object")throw new Error("Don't know what to do with value type "+Pn(h)+".");v=i(h)}y.push(p+v)}return y.push("}"),y.join("")},a=n.__fontmetrics__.uncompress=function(u){if(typeof u!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,p,v,w,y={},B=1,C=y,Q=[],k="",H="",Z=u.length-1,q=1;q<Z;q+=1)(w=u[q])=="'"?h?(v=h.join(""),h=void 0):h=[]:h?h.push(w):w=="{"?(Q.push([C,v]),C={},v=void 0):w=="}"?((p=Q.pop())[0][p[1]]=C,v=void 0,C=p[0]):w=="-"?B=-1:v===void 0?t.hasOwnProperty(w)?(k+=t[w],v=parseInt(k,16)*B,B=1,k=""):k+=w:t.hasOwnProperty(w)?(H+=t[w],C[v]=parseInt(H,16)*B,B=1,v=void 0,H=""):H+=w;return y},A={codePages:["WinAnsiEncoding"],WinAnsiEncoding:a("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:A,"Courier-Bold":A,"Courier-BoldOblique":A,"Courier-Oblique":A,Helvetica:A,"Helvetica-Bold":A,"Helvetica-BoldOblique":A,"Helvetica-Oblique":A,"Times-Roman":A,"Times-Bold":A,"Times-BoldItalic":A,"Times-Italic":A}},c={Unicode:{"Courier-Oblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":a("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":a("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:a("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":a("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:a("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":a("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":a("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":a("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":a("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};n.events.push(["addFont",function(u){var h=u.font,p=c.Unicode[h.postScriptName];p&&(h.metadata.Unicode={},h.metadata.Unicode.widths=p.widths,h.metadata.Unicode.kerning=p.kerning);var v=d.Unicode[h.postScriptName];v&&(h.metadata.Unicode.encoding=v,h.encoding=v.codePages[0])}])}(zr.API),function(n){var e=function(t){for(var r=t.length,o=new Uint8Array(r),s=0;s<r;s++)o[s]=t.charCodeAt(s);return o};n.API.events.push(["addFont",function(t){var r=void 0,o=t.font,s=t.instance;if(!o.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");if(typeof(r=s.existsFileInVFS(o.postScriptName)===!1?s.loadFile(o.postScriptName):s.getFileFromVFS(o.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+o.postScriptName+"').");(function(i,a){a=/^\x00\x01\x00\x00/.test(a)?e(a):e(Ou(a)),i.metadata=n.API.TTFFont.open(a),i.metadata.Unicode=i.metadata.Unicode||{encoding:{},kerning:{},widths:[]},i.metadata.glyIdsUsed=[0]})(o,r)}}])}(zr),function(n){function e(){return(Fr.canvg?Promise.resolve(Fr.canvg):js(()=>import("./index.es.js"),[])).catch(function(t){return Promise.reject(new Error("Could not load canvg: "+t))}).then(function(t){return t.default?t.default:t})}zr.API.addSvgAsImage=function(t,r,o,s,i,a,A,d){if(isNaN(r)||isNaN(o))throw Hn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(i))throw Hn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=s,c.height=i;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var h={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},p=this;return e().then(function(v){return v.fromString(u,t,h)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(v){return v.render(h)}).then(function(){p.addImage(c.toDataURL("image/jpeg",1),r,o,s,i,A,d)})}}(),zr.API.putTotalPages=function(n){var e,t=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(e=new RegExp(n,"g"),t=this.internal.getNumberOfPages()):(e=new RegExp(this.pdfEscape16(n,this.internal.getFont()),"g"),t=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var o=0;o<this.internal.pages[r].length;o++)this.internal.pages[r][o]=this.internal.pages[r][o].replace(e,t);return this},zr.API.viewerPreferences=function(n,e){var t;n=n||{},e=e||!1;var r,o,s,i={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(i),A=[],d=0,c=0,u=0;function h(v,w){var y,B=!1;for(y=0;y<v.length;y+=1)v[y]===w&&(B=!0);return B}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(i)),this.internal.viewerpreferences.isSubscribed=!1),t=this.internal.viewerpreferences.configuration,n==="reset"||e===!0){var p=a.length;for(u=0;u<p;u+=1)t[a[u]].value=t[a[u]].defaultValue,t[a[u]].explicitSet=!1}if(Pn(n)==="object"){for(o in n)if(s=n[o],h(a,o)&&s!==void 0){if(t[o].type==="boolean"&&typeof s=="boolean")t[o].value=s;else if(t[o].type==="name"&&h(t[o].valueSet,s))t[o].value=s;else if(t[o].type==="integer"&&Number.isInteger(s))t[o].value=s;else if(t[o].type==="array"){for(d=0;d<s.length;d+=1)if(r=!0,s[d].length===1&&typeof s[d][0]=="number")A.push(String(s[d]-1));else if(s[d].length>1){for(c=0;c<s[d].length;c+=1)typeof s[d][c]!="number"&&(r=!1);r===!0&&A.push([s[d][0]-1,s[d][1]-1].join(" "))}t[o].value="["+A.join(" ")+"]"}else t[o].value=t[o].defaultValue;t[o].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,w=[];for(v in t)t[v].explicitSet===!0&&(t[v].type==="name"?w.push("/"+v+" /"+t[v].value):w.push("/"+v+" "+t[v].value));w.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+w.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=t,this},function(n){var e=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',o=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(r)),i=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),A=unescape(encodeURIComponent("</x:xmpmeta>")),d=s.length+i.length+a.length+o.length+A.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(o+s+i+a+A),this.internal.write("endstream"),this.internal.write("endobj")},t=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};n.addMetadata=function(r,o){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:o||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",t),this.internal.events.subscribe("postPutResources",e)),this}}(zr.API),function(n){var e=n.API,t=e.pdfEscape16=function(s,i){for(var a,A=i.metadata.Unicode.widths,d=["","0","00","000","0000"],c=[""],u=0,h=s.length;u<h;++u){if(a=i.metadata.characterToGlyph(s.charCodeAt(u)),i.metadata.glyIdsUsed.push(a),i.metadata.toUnicode[a]=s.charCodeAt(u),A.indexOf(a)==-1&&(A.push(a),A.push([parseInt(i.metadata.widthOfGlyph(a),10)])),a=="0")return c.join("");a=a.toString(16),c.push(d[4-a.length],a)}return c.join("")},r=function(s){var i,a,A,d,c,u,h;for(c=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,A=[],u=0,h=(a=Object.keys(s).sort(function(p,v){return p-v})).length;u<h;u++)i=a[u],A.length>=100&&(c+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar`,A=[]),s[i]!==void 0&&s[i]!==null&&typeof s[i].toString=="function"&&(d=("0000"+s[i].toString(16)).slice(-4),i=("0000"+(+i).toString(16)).slice(-4),A.push("<"+i+"><"+d+">"));return A.length&&(c+=`
`+A.length+` beginbfchar
`+A.join(`
`)+`
endbfchar
`),c+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};e.events.push(["putFont",function(s){(function(i){var a=i.font,A=i.out,d=i.newObject,c=i.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="Identity-H"){for(var u=a.metadata.Unicode.widths,h=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),p="",v=0;v<h.length;v++)p+=String.fromCharCode(h[v]);var w=d();c({data:p,addLength1:!0,objectId:w}),A("endobj");var y=d();c({data:r(a.metadata.toUnicode),addLength1:!0,objectId:y}),A("endobj");var B=d();A("<<"),A("/Type /FontDescriptor"),A("/FontName /"+Jd(a.fontName)),A("/FontFile2 "+w+" 0 R"),A("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),A("/Flags "+a.metadata.flags),A("/StemV "+a.metadata.stemV),A("/ItalicAngle "+a.metadata.italicAngle),A("/Ascent "+a.metadata.ascender),A("/Descent "+a.metadata.decender),A("/CapHeight "+a.metadata.capHeight),A(">>"),A("endobj");var C=d();A("<<"),A("/Type /Font"),A("/BaseFont /"+Jd(a.fontName)),A("/FontDescriptor "+B+" 0 R"),A("/W "+n.API.PDFObject.convert(u)),A("/CIDToGIDMap /Identity"),A("/DW 1000"),A("/Subtype /CIDFontType2"),A("/CIDSystemInfo"),A("<<"),A("/Supplement 0"),A("/Registry (Adobe)"),A("/Ordering ("+a.encoding+")"),A(">>"),A(">>"),A("endobj"),a.objectNumber=d(),A("<<"),A("/Type /Font"),A("/Subtype /Type0"),A("/ToUnicode "+y+" 0 R"),A("/BaseFont /"+Jd(a.fontName)),A("/Encoding /"+a.encoding),A("/DescendantFonts ["+C+" 0 R]"),A(">>"),A("endobj"),a.isAlreadyPutted=!0}})(s)}]),e.events.push(["putFont",function(s){(function(i){var a=i.font,A=i.out,d=i.newObject,c=i.putStream;if(a.metadata instanceof n.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var u=a.metadata.rawData,h="",p=0;p<u.length;p++)h+=String.fromCharCode(u[p]);var v=d();c({data:h,addLength1:!0,objectId:v}),A("endobj");var w=d();c({data:r(a.metadata.toUnicode),addLength1:!0,objectId:w}),A("endobj");var y=d();A("<<"),A("/Descent "+a.metadata.decender),A("/CapHeight "+a.metadata.capHeight),A("/StemV "+a.metadata.stemV),A("/Type /FontDescriptor"),A("/FontFile2 "+v+" 0 R"),A("/Flags 96"),A("/FontBBox "+n.API.PDFObject.convert(a.metadata.bbox)),A("/FontName /"+Jd(a.fontName)),A("/ItalicAngle "+a.metadata.italicAngle),A("/Ascent "+a.metadata.ascender),A(">>"),A("endobj"),a.objectNumber=d();for(var B=0;B<a.metadata.hmtx.widths.length;B++)a.metadata.hmtx.widths[B]=parseInt(a.metadata.hmtx.widths[B]*(1e3/a.metadata.head.unitsPerEm));A("<</Subtype/TrueType/Type/Font/ToUnicode "+w+" 0 R/BaseFont/"+Jd(a.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+n.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),A("endobj"),a.isAlreadyPutted=!0}})(s)}]);var o=function(s){var i,a=s.text||"",A=s.x,d=s.y,c=s.options||{},u=s.mutex||{},h=u.pdfEscape,p=u.activeFontKey,v=u.fonts,w=p,y="",B=0,C="",Q=v[w].encoding;if(v[w].encoding!=="Identity-H")return{text:a,x:A,y:d,options:c,mutex:u};for(C=a,w=p,Array.isArray(a)&&(C=a[0]),B=0;B<C.length;B+=1)v[w].metadata.hasOwnProperty("cmap")&&(i=v[w].metadata.cmap.unicode.codeMap[C[B].charCodeAt(0)]),i||C[B].charCodeAt(0)<256&&v[w].metadata.hasOwnProperty("Unicode")?y+=C[B]:y+="";var k="";return parseInt(w.slice(1))<14||Q==="WinAnsiEncoding"?k=h(y,w).split("").map(function(H){return H.charCodeAt(0).toString(16)}).join(""):Q==="Identity-H"&&(k=t(y,v[w])),u.isHex=!0,{text:k,x:A,y:d,options:c,mutex:u}};e.events.push(["postProcessText",function(s){var i=s.text||"",a=[],A={text:i,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(i)){var d=0;for(d=0;d<i.length;d+=1)Array.isArray(i[d])&&i[d].length===3?a.push([o(Object.assign({},A,{text:i[d][0]})).text,i[d][1],i[d][2]]):a.push(o(Object.assign({},A,{text:i[d]})).text);s.text=a}else s.text=o(Object.assign({},A,{text:i})).text}])}(zr),function(n){var e=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};n.existsFileInVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0},n.addFileToVFS=function(t,r){return e.call(this),this.internal.vFS[t]=r,this},n.getFileFromVFS=function(t){return e.call(this),this.internal.vFS[t]!==void 0?this.internal.vFS[t]:null}}(zr.API),function(n){n.__bidiEngine__=n.prototype.__bidiEngine__=function(r){var o,s,i,a,A,d,c,u=e,h=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],p=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},w={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],B=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),C=!1,Q=0;this.__bidiEngine__={};var k=function(L){var R=L.charCodeAt(),J=R>>8,se=w[J];return se!==void 0?u[256*se+(255&R)]:J===252||J===253?"AL":B.test(J)?"L":J===8?"R":"N"},H=function(L){for(var R,J=0;J<L.length;J++){if((R=k(L.charAt(J)))==="L")return!1;if(R==="R")return!0}return!1},Z=function(L,R,J,se){var fe,ie,pe,te,Ce=R[se];switch(Ce){case"L":case"R":C=!1;break;case"N":case"AN":break;case"EN":C&&(Ce="AN");break;case"AL":C=!0,Ce="R";break;case"WS":Ce="N";break;case"CS":se<1||se+1>=R.length||(fe=J[se-1])!=="EN"&&fe!=="AN"||(ie=R[se+1])!=="EN"&&ie!=="AN"?Ce="N":C&&(ie="AN"),Ce=ie===fe?ie:"N";break;case"ES":Ce=(fe=se>0?J[se-1]:"B")==="EN"&&se+1<R.length&&R[se+1]==="EN"?"EN":"N";break;case"ET":if(se>0&&J[se-1]==="EN"){Ce="EN";break}if(C){Ce="N";break}for(pe=se+1,te=R.length;pe<te&&R[pe]==="ET";)pe++;Ce=pe<te&&R[pe]==="EN"?"EN":"N";break;case"NSM":if(i&&!a){for(te=R.length,pe=se+1;pe<te&&R[pe]==="NSM";)pe++;if(pe<te){var ne=L[se],ze=ne>=1425&&ne<=2303||ne===64286;if(fe=R[pe],ze&&(fe==="R"||fe==="AL")){Ce="R";break}}}Ce=se<1||(fe=R[se-1])==="B"?"N":J[se-1];break;case"B":C=!1,o=!0,Ce=Q;break;case"S":s=!0,Ce="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":C=!1;break;case"BN":Ce="N"}return Ce},q=function(L,R,J){var se=L.split("");return J&&N(se,J,{hiLevel:Q}),se.reverse(),R&&R.reverse(),se.join("")},N=function(L,R,J){var se,fe,ie,pe,te,Ce=-1,ne=L.length,ze=0,z=[],E=Q?p:h,F=[];for(C=!1,o=!1,s=!1,fe=0;fe<ne;fe++)F[fe]=k(L[fe]);for(ie=0;ie<ne;ie++){if(te=ze,z[ie]=Z(L,F,z,ie),se=240&(ze=E[te][v[z[ie]]]),ze&=15,R[ie]=pe=E[ze][5],se>0)if(se===16){for(fe=Ce;fe<ie;fe++)R[fe]=1;Ce=-1}else Ce=-1;if(E[ze][6])Ce===-1&&(Ce=ie);else if(Ce>-1){for(fe=Ce;fe<ie;fe++)R[fe]=pe;Ce=-1}F[ie]==="B"&&(R[ie]=0),J.hiLevel|=pe}s&&function(I,O,D){for(var P=0;P<D;P++)if(I[P]==="S"){O[P]=Q;for(var K=P-1;K>=0&&I[K]==="WS";K--)O[K]=Q}}(F,R,ne)},re=function(L,R,J,se,fe){if(!(fe.hiLevel<L)){if(L===1&&Q===1&&!o)return R.reverse(),void(J&&J.reverse());for(var ie,pe,te,Ce,ne=R.length,ze=0;ze<ne;){if(se[ze]>=L){for(te=ze+1;te<ne&&se[te]>=L;)te++;for(Ce=ze,pe=te-1;Ce<pe;Ce++,pe--)ie=R[Ce],R[Ce]=R[pe],R[pe]=ie,J&&(ie=J[Ce],J[Ce]=J[pe],J[pe]=ie);ze=te}ze++}}},be=function(L,R,J){var se=L.split(""),fe={hiLevel:Q};return J||(J=[]),N(se,J,fe),function(ie,pe,te){if(te.hiLevel!==0&&c)for(var Ce,ne=0;ne<ie.length;ne++)pe[ne]===1&&(Ce=y.indexOf(ie[ne]))>=0&&(ie[ne]=y[Ce+1])}(se,J,fe),re(2,se,R,J,fe),re(1,se,R,J,fe),se.join("")};return this.__bidiEngine__.doBidiReorder=function(L,R,J){if(function(fe,ie){if(ie)for(var pe=0;pe<fe.length;pe++)ie[pe]=pe;a===void 0&&(a=H(fe)),d===void 0&&(d=H(fe))}(L,R),i||!A||d)if(i&&A&&a^d)Q=a?1:0,L=q(L,R,J);else if(!i&&A&&d)Q=a?1:0,L=be(L,R,J),L=q(L,R);else if(!i||a||A||d){if(i&&!A&&a^d)L=q(L,R),a?(Q=0,L=be(L,R,J)):(Q=1,L=be(L,R,J),L=q(L,R));else if(i&&a&&!A&&d)Q=1,L=be(L,R,J),L=q(L,R);else if(!i&&!A&&a^d){var se=c;a?(Q=1,L=be(L,R,J),Q=0,c=!1,L=be(L,R,J),c=se):(Q=0,L=be(L,R,J),L=q(L,R),Q=1,c=!1,L=be(L,R,J),c=se,L=q(L,R))}}else Q=0,L=be(L,R,J);else Q=a?1:0,L=be(L,R,J);return L},this.__bidiEngine__.setOptions=function(L){L&&(i=L.isInputVisual,A=L.isOutputVisual,a=L.isInputRtl,d=L.isOutputRtl,c=L.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var e=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],t=new n.__bidiEngine__({isInputVisual:!0});n.API.events.push(["postProcessText",function(r){var o=r.text,s=(r.x,r.y,r.options||{}),i=(r.mutex,s.lang,[]);if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,t.setOptions(s),Object.prototype.toString.call(o)==="[object Array]"){var a=0;for(i=[],a=0;a<o.length;a+=1)Object.prototype.toString.call(o[a])==="[object Array]"?i.push([t.doBidiReorder(o[a][0]),o[a][1],o[a][2]]):i.push([t.doBidiReorder(o[a])]);r.text=i}else r.text=t.doBidiReorder(o);t.setOptions({isInputVisual:!0})}])}(zr),zr.API.TTFFont=function(){function n(e){var t;if(this.rawData=e,t=this.contents=new ml(e),this.contents.pos=4,t.readString(4)==="ttcf")throw new Error("TTCF not supported.");t.pos=0,this.parse(),this.subset=new kN(this),this.registerTTF()}return n.open=function(e){return new n(e)},n.prototype.parse=function(){return this.directory=new bN(this.contents),this.head=new BN(this),this.name=new FN(this),this.cmap=new Bz(this),this.toUnicode={},this.hhea=new zN(this),this.maxp=new IN(this),this.hmtx=new UN(this),this.post=new SN(this),this.os2=new CN(this),this.loca=new PN(this),this.glyf=new QN(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},n.prototype.registerTTF=function(){var e,t,r,o,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var i,a,A,d;for(d=[],i=0,a=(A=this.bbox).length;i<a;i++)e=A[i],d.push(Math.round(e*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(o=this.post.italic_angle),32768&(t=o>>16)&&(t=-(1+(65535^t))),this.italicAngle=+(t+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},n.prototype.characterToGlyph=function(e){var t;return((t=this.cmap.unicode)!=null?t.codeMap[e]:void 0)||0},n.prototype.widthOfGlyph=function(e){var t;return t=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(e).advance*t},n.prototype.widthOfString=function(e,t,r){var o,s,i,a;for(i=0,s=0,a=(e=""+e).length;0<=a?s<a:s>a;s=0<=a?++s:--s)o=e.charCodeAt(s),i+=this.widthOfGlyph(this.characterToGlyph(o))+r*(1e3/t)||0;return i*(t/1e3)},n.prototype.lineHeight=function(e,t){var r;return t==null&&(t=!1),r=t?this.lineGap:0,(this.ascender+r-this.decender)/1e3*e},n}();var ua,ml=function(){function n(e){this.data=e??[],this.pos=0,this.length=this.data.length}return n.prototype.readByte=function(){return this.data[this.pos++]},n.prototype.writeByte=function(e){return this.data[this.pos++]=e},n.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},n.prototype.writeUInt32=function(e){return this.writeByte(e>>>24&255),this.writeByte(e>>16&255),this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt32=function(){var e;return(e=this.readUInt32())>=2147483648?e-4294967296:e},n.prototype.writeInt32=function(e){return e<0&&(e+=4294967296),this.writeUInt32(e)},n.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},n.prototype.writeUInt16=function(e){return this.writeByte(e>>8&255),this.writeByte(255&e)},n.prototype.readInt16=function(){var e;return(e=this.readUInt16())>=32768?e-65536:e},n.prototype.writeInt16=function(e){return e<0&&(e+=65536),this.writeUInt16(e)},n.prototype.readString=function(e){var t,r;for(r=[],t=0;0<=e?t<e:t>e;t=0<=e?++t:--t)r[t]=String.fromCharCode(this.readByte());return r.join("")},n.prototype.writeString=function(e){var t,r,o;for(o=[],t=0,r=e.length;0<=r?t<r:t>r;t=0<=r?++t:--t)o.push(this.writeByte(e.charCodeAt(t)));return o},n.prototype.readShort=function(){return this.readInt16()},n.prototype.writeShort=function(e){return this.writeInt16(e)},n.prototype.readLongLong=function(){var e,t,r,o,s,i,a,A;return e=this.readByte(),t=this.readByte(),r=this.readByte(),o=this.readByte(),s=this.readByte(),i=this.readByte(),a=this.readByte(),A=this.readByte(),128&e?-1*(72057594037927940*(255^e)+281474976710656*(255^t)+1099511627776*(255^r)+4294967296*(255^o)+16777216*(255^s)+65536*(255^i)+256*(255^a)+(255^A)+1):72057594037927940*e+281474976710656*t+1099511627776*r+4294967296*o+16777216*s+65536*i+256*a+A},n.prototype.writeLongLong=function(e){var t,r;return t=Math.floor(e/4294967296),r=4294967295&e,this.writeByte(t>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},n.prototype.readInt=function(){return this.readInt32()},n.prototype.writeInt=function(e){return this.writeInt32(e)},n.prototype.read=function(e){var t,r;for(t=[],r=0;0<=e?r<e:r>e;r=0<=e?++r:--r)t.push(this.readByte());return t},n.prototype.write=function(e){var t,r,o,s;for(s=[],r=0,o=e.length;r<o;r++)t=e[r],s.push(this.writeByte(t));return s},n}(),bN=function(){var n;function e(t){var r,o,s;for(this.scalarType=t.readInt(),this.tableCount=t.readShort(),this.searchRange=t.readShort(),this.entrySelector=t.readShort(),this.rangeShift=t.readShort(),this.tables={},o=0,s=this.tableCount;0<=s?o<s:o>s;o=0<=s?++o:--o)r={tag:t.readString(4),checksum:t.readInt(),offset:t.readInt(),length:t.readInt()},this.tables[r.tag]=r}return e.prototype.encode=function(t){var r,o,s,i,a,A,d,c,u,h,p,v,w;for(w in p=Object.keys(t).length,A=Math.log(2),u=16*Math.floor(Math.log(p)/A),i=Math.floor(u/A),c=16*p-u,(o=new ml).writeInt(this.scalarType),o.writeShort(p),o.writeShort(u),o.writeShort(i),o.writeShort(c),s=16*p,d=o.pos+s,a=null,v=[],t)for(h=t[w],o.writeString(w),o.writeInt(n(h)),o.writeInt(d),o.writeInt(h.length),v=v.concat(h),w==="head"&&(a=d),d+=h.length;d%4;)v.push(0),d++;return o.write(v),r=2981146554-n(o.data),o.pos=a+8,o.writeUInt32(r),o.data},n=function(t){var r,o,s,i;for(t=zz.call(t);t.length%4;)t.push(0);for(s=new ml(t),o=0,r=0,i=t.length;r<i;r=r+=4)o+=s.readUInt32();return 4294967295&o},e}(),xN={}.hasOwnProperty,Va=function(n,e){for(var t in e)xN.call(e,t)&&(n[t]=e[t]);function r(){this.constructor=n}return r.prototype=e.prototype,n.prototype=new r,n.__super__=e.prototype,n};ua=function(){function n(e){var t;this.file=e,t=this.file.directory.tables[this.tag],this.exists=!!t,t&&(this.offset=t.offset,this.length=t.length,this.parse(this.file.contents))}return n.prototype.parse=function(){},n.prototype.encode=function(){},n.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},n}();var BN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new ml).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),F_=function(){function n(e,t){var r,o,s,i,a,A,d,c,u,h,p,v,w,y,B,C,Q;switch(this.platformID=e.readUInt16(),this.encodingID=e.readShort(),this.offset=t+e.readInt(),u=e.pos,e.pos=this.offset,this.format=e.readUInt16(),this.length=e.readUInt16(),this.language=e.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(A=0;A<256;++A)this.codeMap[A]=e.readByte();break;case 4:for(p=e.readUInt16(),h=p/2,e.pos+=6,s=function(){var k,H;for(H=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)H.push(e.readUInt16());return H}(),e.pos+=2,w=function(){var k,H;for(H=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)H.push(e.readUInt16());return H}(),d=function(){var k,H;for(H=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)H.push(e.readUInt16());return H}(),c=function(){var k,H;for(H=[],A=k=0;0<=h?k<h:k>h;A=0<=h?++k:--k)H.push(e.readUInt16());return H}(),o=(this.length-e.pos+this.offset)/2,a=function(){var k,H;for(H=[],A=k=0;0<=o?k<o:k>o;A=0<=o?++k:--k)H.push(e.readUInt16());return H}(),A=B=0,Q=s.length;B<Q;A=++B)for(y=s[A],r=C=v=w[A];v<=y?C<=y:C>=y;r=v<=y?++C:--C)c[A]===0?i=r+d[A]:(i=a[c[A]/2+(r-v)-(h-A)]||0)!==0&&(i+=d[A]),this.codeMap[r]=65535&i}e.pos=u}return n.encode=function(e,t){var r,o,s,i,a,A,d,c,u,h,p,v,w,y,B,C,Q,k,H,Z,q,N,re,be,L,R,J,se,fe,ie,pe,te,Ce,ne,ze,z,E,F,I,O,D,P,K,M,ge,_e;switch(se=new ml,i=Object.keys(e).sort(function(Me,$e){return Me-$e}),t){case"macroman":for(w=0,y=function(){var Me=[];for(v=0;v<256;++v)Me.push(0);return Me}(),C={0:0},s={},fe=0,Ce=i.length;fe<Ce;fe++)C[K=e[o=i[fe]]]==null&&(C[K]=++w),s[o]={old:e[o],new:C[e[o]]},y[o]=C[e[o]];return se.writeUInt16(1),se.writeUInt16(0),se.writeUInt32(12),se.writeUInt16(0),se.writeUInt16(262),se.writeUInt16(0),se.write(y),{charMap:s,subtable:se.data,maxGlyphID:w+1};case"unicode":for(R=[],u=[],Q=0,C={},r={},B=d=null,ie=0,ne=i.length;ie<ne;ie++)C[H=e[o=i[ie]]]==null&&(C[H]=++Q),r[o]={old:H,new:C[H]},a=C[H]-o,B!=null&&a===d||(B&&u.push(B),R.push(o),d=a),B=o;for(B&&u.push(B),u.push(65535),R.push(65535),be=2*(re=R.length),N=2*Math.pow(Math.log(re)/Math.LN2,2),h=Math.log(N/2)/Math.LN2,q=2*re-N,A=[],Z=[],p=[],v=pe=0,ze=R.length;pe<ze;v=++pe){if(L=R[v],c=u[v],L===65535){A.push(0),Z.push(0);break}if(L-(J=r[L].new)>=32768)for(A.push(0),Z.push(2*(p.length+re-v)),o=te=L;L<=c?te<=c:te>=c;o=L<=c?++te:--te)p.push(r[o].new);else A.push(J-L),Z.push(0)}for(se.writeUInt16(3),se.writeUInt16(1),se.writeUInt32(12),se.writeUInt16(4),se.writeUInt16(16+8*re+2*p.length),se.writeUInt16(0),se.writeUInt16(be),se.writeUInt16(N),se.writeUInt16(h),se.writeUInt16(q),D=0,z=u.length;D<z;D++)o=u[D],se.writeUInt16(o);for(se.writeUInt16(0),P=0,E=R.length;P<E;P++)o=R[P],se.writeUInt16(o);for(M=0,F=A.length;M<F;M++)a=A[M],se.writeUInt16(a);for(ge=0,I=Z.length;ge<I;ge++)k=Z[ge],se.writeUInt16(k);for(_e=0,O=p.length;_e<O;_e++)w=p[_e],se.writeUInt16(w);return{charMap:r,subtable:se.data,maxGlyphID:Q+1}}},n}(),Bz=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,o,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,o=0;0<=s?o<s:o>s;o=0<=s?++o:--o)r=new F_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var o,s;return r==null&&(r="macroman"),o=F_.encode(t,r),(s=new ml).writeUInt16(0),s.writeUInt16(1),o.table=s.data.concat(o.subtable),o},e}(),zN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),CN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,o;for(o=[],r=0;r<10;++r)o.push(t.readByte());return o}(),this.charRange=function(){var r,o;for(o=[],r=0;r<4;++r)o.push(t.readInt());return o}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,o;for(o=[],r=0;r<2;r=++r)o.push(t.readInt());return o}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),SN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="post",e.prototype.parse=function(t){var r,o,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:break;case 131072:var i;for(o=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=o?i<o:i>o;i=0<=o?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)r=t.readByte(),s.push(this.names.push(t.readString(r)));return s;case 151552:return o=t.readUInt16(),this.offsets=t.read(o);case 196608:break;case 262144:return this.map=(function(){var a,A,d;for(d=[],i=a=0,A=this.file.maxp.numGlyphs;0<=A?a<A:a>A;i=0<=A?++a:--a)d.push(t.readUInt32());return d}).call(this)}},e}(),EN=function(n,e){this.raw=n,this.length=n.length,this.platformID=e.platformID,this.encodingID=e.encodingID,this.languageID=e.languageID},FN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="name",e.prototype.parse=function(t){var r,o,s,i,a,A,d,c,u,h,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),A=t.readShort(),o=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)o.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+A+t.readShort()});for(d={},i=u=0,h=o.length;u<h;i=++u)s=o[i],t.pos=s.offset,c=t.readString(s.length),a=new EN(c,s),d[p=s.nameID]==null&&(d[p]=[]),d[s.nameID].push(a);this.strings=d,this.copyright=d[0],this.fontFamily=d[1],this.fontSubfamily=d[2],this.uniqueSubfamily=d[3],this.fontName=d[4],this.version=d[5];try{this.postscriptName=d[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=d[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=d[7],this.manufacturer=d[8],this.designer=d[9],this.description=d[10],this.vendorUrl=d[11],this.designerUrl=d[12],this.license=d[13],this.licenseUrl=d[14],this.preferredFamily=d[15],this.preferredSubfamily=d[17],this.compatibleFull=d[18],this.sampleText=d[19]},e}(),IN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),UN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,o,s,i,a,A,d;for(t.pos=this.offset,this.metrics=[],r=0,A=this.file.hhea.numberOfMetrics;0<=A?r<A:r>A;r=0<=A?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,u;for(u=[],r=c=0;0<=s?c<s:c>s;r=0<=s?++c:--c)u.push(t.readInt16());return u}(),this.widths=(function(){var c,u,h,p;for(p=[],c=0,u=(h=this.metrics).length;c<u;c++)i=h[c],p.push(i.advance);return p}).call(this),o=this.widths[this.widths.length-1],d=[],r=a=0;0<=s?a<s:a>s;r=0<=s?++a:--a)d.push(this.widths.push(o));return d},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),zz=[].slice,QN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,o,s,i,a,A,d,c,u,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,o=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+o,a=(A=new ml(r.read(s))).readShort(),c=A.readShort(),h=A.readShort(),d=A.readShort(),u=A.readShort(),this.cache[t]=a===-1?new LN(A,c,h,d,u):new TN(A,a,c,h,d,u),this.cache[t]))},e.prototype.encode=function(t,r,o){var s,i,a,A,d;for(a=[],i=[],A=0,d=r.length;A<d;A++)s=t[r[A]],i.push(a.length),s&&(a=a.concat(s.encode(o)));return i.push(a.length),{table:a,offsets:i}},e}(),TN=function(){function n(e,t,r,o,s,i){this.raw=e,this.numberOfContours=t,this.xMin=r,this.yMin=o,this.xMax=s,this.yMax=i,this.compound=!1}return n.prototype.encode=function(){return this.raw.data},n}(),LN=function(){function n(e,t,r,o,s){var i,a;for(this.raw=e,this.xMin=t,this.yMin=r,this.xMax=o,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],i=this.raw;a=i.readShort(),this.glyphOffsets.push(i.pos),this.glyphIDs.push(i.readUInt16()),32&a;)i.pos+=1&a?4:2,128&a?i.pos+=8:64&a?i.pos+=4:8&a&&(i.pos+=2)}return n.prototype.encode=function(){var e,t,r;for(t=new ml(zz.call(this.raw.data)),e=0,r=this.glyphIDs.length;e<r;++e)t.pos=this.glyphOffsets[e];return t.data},n}(),PN=function(n){function e(){return e.__super__.constructor.apply(this,arguments)}return Va(e,ua),e.prototype.tag="loca",e.prototype.parse=function(t){var r,o;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var s,i;for(i=[],o=0,s=this.length;o<s;o+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],o=0,s=this.length;o<s;o+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var o=new Uint32Array(this.offsets.length),s=0,i=0,a=0;a<o.length;++a)if(o[a]=s,i<r.length&&r[i]==a){++i,o[a]=s;var A=this.offsets[a],d=this.offsets[a+1]-A;d>0&&(s+=d)}for(var c=new Array(4*o.length),u=0;u<o.length;++u)c[4*u+3]=255&o[u],c[4*u+2]=(65280&o[u])>>8,c[4*u+1]=(16711680&o[u])>>16,c[4*u]=(4278190080&o[u])>>24;return c},e}(),kN=function(){function n(e){this.font=e,this.subset={},this.unicodes={},this.next=33}return n.prototype.generateCmap=function(){var e,t,r,o,s;for(t in o=this.font.cmap.tables[0].codeMap,e={},s=this.subset)r=s[t],e[t]=o[r];return e},n.prototype.glyphsFor=function(e){var t,r,o,s,i,a,A;for(o={},i=0,a=e.length;i<a;i++)o[s=e[i]]=this.font.glyf.glyphFor(s);for(s in t=[],o)(r=o[s])!=null&&r.compound&&t.push.apply(t,r.glyphIDs);if(t.length>0)for(s in A=this.glyphsFor(t))r=A[s],o[s]=r;return o},n.prototype.encode=function(e,t){var r,o,s,i,a,A,d,c,u,h,p,v,w,y,B;for(o in r=Bz.encode(this.generateCmap(),"unicode"),i=this.glyphsFor(e),p={0:0},B=r.charMap)p[(A=B[o]).old]=A.new;for(v in h=r.maxGlyphID,i)v in p||(p[v]=h++);return c=function(C){var Q,k;for(Q in k={},C)k[C[Q]]=Q;return k}(p),u=Object.keys(c).sort(function(C,Q){return C-Q}),w=function(){var C,Q,k;for(k=[],C=0,Q=u.length;C<Q;C++)a=u[C],k.push(c[a]);return k}(),s=this.font.glyf.encode(i,w,p),d=this.font.loca.encode(s.offsets,w),y={cmap:this.font.cmap.raw(),glyf:s.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(t)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},n}();zr.API.PDFObject=function(){var n;function e(){}return n=function(t,r){return(Array(r+1).join("0")+t).slice(-r)},e.convert=function(t){var r,o,s,i;if(Array.isArray(t))return"["+function(){var a,A,d;for(d=[],a=0,A=t.length;a<A;a++)r=t[a],d.push(e.convert(r));return d}().join(" ")+"]";if(typeof t=="string")return"/"+t;if(t!=null&&t.isString)return"("+t+")";if(t instanceof Date)return"(D:"+n(t.getUTCFullYear(),4)+n(t.getUTCMonth(),2)+n(t.getUTCDate(),2)+n(t.getUTCHours(),2)+n(t.getUTCMinutes(),2)+n(t.getUTCSeconds(),2)+"Z)";if({}.toString.call(t)==="[object Object]"){for(o in s=["<<"],t)i=t[o],s.push("/"+o+" "+e.convert(i));return s.push(">>"),s.join(`
`)}return""+t},e}();var ON=$('<tr><td class="odz-text-xs"></td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td> </td></tr>'),DN=$('<tr><td></td><td colspan="5" class="odz-text-xs"> <!> <!></td><td> </td></tr>'),NN=$('<tr><td></td><td colspan="5" class="odz-text-xs"> <!></td><td> </td></tr>'),MN=$('<tr><td></td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td> </td></tr>'),HN=$('<tr><td></td><td class="odz-text-xs">[]</td><td class="odz-text-xs">-</td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td class="odz-text-xs"> </td><td> </td></tr>'),jN=$("<!> <!> <!> <!>",1),RN=$('<tr><td></td><td class="odz-text-xs">[]  </td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td class="odz-text-xs">-</td><td> </td></tr>'),qN=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl odz-p-8 odz-print-area"><h1 class="odz-text-center odz-text-3xl odz-font-bold odz-mb-8"></h1> <table class="odz-table odz-w-full odz-border odz-border-gray-400"><tbody><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200 odz-w-32"> </td><td>101-86-83287</td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td>()</td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"> </td><td colspan="3">  22 19-15</td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td></td><td class="odz-font-bold odz-bg-base-200"></td><td></td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td>02-6499-2267</td><td class="odz-font-bold odz-bg-base-200"></td><td>02-6499-2267</td></tr><tr class="odz-border-gray-400"><td class="odz-font-bold odz-bg-base-200"></td><td colspan="3"><div class="odz-flex odz-justify-between"><span> </span> <span></span></div></td></tr></tbody></table> <div class="odz-my-4"><div class="odz-font-bold">  (+)</div> <div class="odz-text-right"> </div></div> <table class="odz-table odz-table-bordered odz-w-full"><thead><tr class="odz-bg-base-200"><th></th><th>/</th><th></th><th></th><th></th><th></th><th></th></tr></thead><tbody><!><!><tr><td colspan="3" class="odz-text-center odz-font-bold"></td><td class="odz-font-bold"> </td><td class="odz-font-bold"></td><td class="odz-font-bold"> </td><td class="odz-font-bold"> </td></tr></tbody></table> <div class="odz-mt-4 odz-p-4 odz-bg-base-200 odz-rounded"><div class="odz-font-bold odz-mb-2"></div> <ul class="odz-list-disc odz-list-inside odz-text-sm"><li>   20 (   )</li> <li>      .</li> <li>   .</li> <li>   .</li> <li>       ,  .</li></ul></div> <div class="odz-flex odz-justify-end odz-gap-2 odz-mt-6 print:odz-hidden"><button class="odz-btn odz-btn-primary"></button> <button class="odz-btn odz-btn-secondary">PDF </button> <button class="odz-btn"></button></div></div></dialog>');function Cz(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t);let s=ht(e,"isOpen",12);function i(){s(!1)}function a(){window.print()}const A=new Date,d=`${A.getFullYear()} ${String(A.getMonth()+1).padStart(2,"0")} ${String(A.getDate()).padStart(2,"0")}`;async function c(){const I=document.querySelector(".odz-print-area");if(I)try{const O=I.querySelector(".print\\:odz-hidden");let D="";O&&(D=O.style.display,O.style.display="none");const P=I.scrollHeight,K=I.scrollWidth,M=I.scrollTop;I.scrollTop=0;const ge=await OD(I,{useCORS:!0,scale:2,x:0,y:0,width:K,height:P,backgroundColor:"#ffffff",logging:!1,allowTaint:!0,windowHeight:P});I.scrollTop=M,O&&(O.style.display=D);const _e=ge.toDataURL("image/png",1),Me=new zr({orientation:"portrait",unit:"mm",format:"a4"}),$e=Me.internal.pageSize.getWidth(),Y=Me.internal.pageSize.getHeight(),j=10,ee=$e-j*2,ae=Y-j*2,ue=ge.height/ge.width;let ye=ee*ue;if(ye>ae){const Ee=Math.ceil(ye/ae),de=ge.height/ye,Qe=ae*de;for(let Fe=0;Fe<Ee;Fe++){Fe>0&&Me.addPage();const Oe=-Fe*Qe/de;Me.addImage(_e,"PNG",j,Oe+j,ee,ge.height*(ee/ge.width))}}else Me.addImage(_e,"PNG",j,j,ee,ye);Me.save(".pdf")}catch(O){console.error("PDF    :",O)}}fn();var u=qN(),h=g(u),p=x(g(h),2),v=g(p),w=g(v),y=x(g(w),3);y.textContent=d;var B=x(w,5),C=x(g(B)),Q=g(C),k=g(Q),H=g(k),Z=x(p,2),q=x(g(Z),2),N=g(q),re=x(Z,2),be=x(g(re)),L=g(be);tr(L,1,()=>o().products,mr,(I,O,D)=>{var P=jN(),K=it(P);tr(K,1,()=>l(O).variants,mr,(j,ee,ae)=>{var ue=ON();const me=at(()=>l(ee).prices[0].amount),ye=at(()=>l(O).variants.reduce((xe,Re)=>xe+(Re.quantity||0),0)),Ee=at(()=>{var xe;return(xe=l(O).discountInfo)!=null&&xe.hasDiscount?(l(O).discountInfo.originalAmount-l(O).discountInfo.discountAmount)/l(ye):l(me)}),de=at(()=>l(Ee)*l(ee).quantity);var Qe=g(ue);Qe.textContent=`${D+1}-${ae+1}`;var Fe=x(Qe),Oe=g(Fe),Te=x(Fe),De=g(Te),ce=x(Te),Ie=g(ce),V=x(ce),G=g(V),le=x(V),Le=g(le),He=x(le),je=g(He);Ne((xe,Re)=>{Se(Oe,l(O).product.title),Se(De,l(ee).title||""),Se(Ie,l(ee).quantity),Se(G,xe),Se(Le,Re),Se(je,Re)},[()=>yr(l(Ee)),()=>yr(l(de))],at),U(j,ue)});var M=x(K,2);{var ge=j=>{var ee=kt(),ae=it(ee);tr(ae,1,()=>l(O).prints,mr,(ue,me)=>{var ye=DN(),Ee=x(g(ye)),de=g(Ee),Qe=x(de);{var Fe=Ie=>{var V=bn();Ne(G=>Se(V,`- ${G??""}`),[()=>l(me).parentTemplates.map(G=>G.name).join(" > ")],at),U(Ie,V)};ve(Qe,Ie=>{l(me).parentTemplates&&Ie(Fe)})}var Oe=x(Qe,2);{var Te=Ie=>{var V=bn();Ne(()=>Se(V,`- ${l(me).colors.length??""}`)),U(Ie,V)};ve(Oe,Ie=>{l(me).colors&&Ie(Te)})}var De=x(Ee),ce=g(De);Ne(Ie=>{Se(de,`: ${l(me).title??""} `),Se(ce,Ie)},[()=>yr(l(me).price||0)],at),U(ue,ye)}),U(j,ee)};ve(M,j=>{l(O).prints&&l(O).prints.length>0&&j(ge)})}var _e=x(M,2);{var Me=j=>{var ee=kt(),ae=it(ee);tr(ae,1,()=>l(O).simplePrints,mr,(ue,me)=>{var ye=NN(),Ee=x(g(ye)),de=g(Ee),Qe=x(de);{var Fe=De=>{var ce=bn();Ne(()=>Se(ce,`- ${l(me).print_method??""}`)),U(De,ce)};ve(Qe,De=>{l(me).print_method&&l(me).print_method!=="none"&&De(Fe)})}var Oe=x(Ee),Te=g(Oe);Ne(De=>{Se(de,`: ${l(me).title||l(me).object_id||" "} `),Se(Te,De)},[()=>yr(l(me).price||0)],at),U(ue,ye)}),U(j,ee)};ve(_e,j=>{l(O).simplePrints&&l(O).simplePrints.length>0&&j(Me)})}var $e=x(_e,2);{var Y=j=>{var ee=kt(),ae=it(ee);tr(ae,1,()=>Object.entries(l(O).addons),mr,(ue,me)=>{let ye=()=>l(me)[1];var Ee=kt(),de=it(Ee);{var Qe=Oe=>{var Te=kt();const De=at(()=>l(O).addonProductsMap[ye().productId]),ce=at(()=>{var G,le;return(le=(G=l(De))==null?void 0:G.variants)==null?void 0:le.find(Le=>Le.id===ye().variantId)});var Ie=it(Te);{var V=G=>{var le=MN(),Le=x(g(le)),He=g(Le),je=x(Le),xe=g(je),Re=x(je),et=g(Re),qe=x(Re),ot=g(qe),Pe=x(qe),Ye=g(Pe),rt=x(Pe),lt=g(rt);Ne((vt,Ft)=>{Se(He,`[] ${l(De).title??""}`),Se(xe,l(ce).title||""),Se(et,l(O).quantity),Se(ot,vt),Se(Ye,Ft),Se(lt,Ft)},[()=>yr(l(ce).prices[0].amount),()=>yr(l(ce).prices[0].amount*l(O).quantity)],at),U(G,le)};ve(Ie,G=>{l(De)&&l(ce)&&G(V)})}U(Oe,Te)},Fe=Oe=>{var Te=kt(),De=it(Te);{var ce=Ie=>{var V=HN();const G=at(()=>ye().quantity||l(O).quantity);var le=x(g(V),3),Le=g(le),He=x(le),je=g(He),xe=x(He),Re=g(xe),et=x(xe),qe=g(et);Ne((ot,Pe)=>{Se(Le,l(G)),Se(je,ot),Se(Re,Pe),Se(qe,Pe)},[()=>yr(ye().price),()=>yr(ye().price*l(G))],at),U(Ie,V)};ve(De,Ie=>{ye().price!==void 0&&Ie(ce)},!0)}U(Oe,Te)};ve(de,Oe=>{l(O).addonProductsMap?Oe(Qe):Oe(Fe,!1)})}U(ue,Ee)}),U(j,ee)};ve($e,j=>{l(O).addons&&Object.keys(l(O).addons).length>0&&j(Y)})}U(I,P)});var R=x(L);{var J=I=>{var O=RN(),D=x(g(O),6),P=g(D);Ne(K=>Se(P,K),[()=>yr(o().totalAdditionalAmount)],at),U(I,O)};ve(R,I=>{o().totalAdditionalAmount>0&&I(J)})}var se=x(R),fe=x(g(se)),ie=g(fe),pe=x(fe,2),te=g(pe),Ce=x(pe),ne=g(Ce),ze=x(re,4),z=g(ze),E=x(z,2),F=x(E,2);Ne((I,O)=>{Se(H,o().orderName||""),Se(N,` (  ${I??""} )`),Se(ie,`${o().totalQuantity??""}`),Se(te,O),Se(ne,I)},[()=>yr(o().totalAmount),()=>yr(o().totalProductAmount+o().totalPrintAmount+o().totalAddonAmount+o().totalAdditionalAmount)],at),At("click",z,a),At("click",E,c),At("click",F,i),U(n,u),dn(),r()}var KN=$("<!> <button> </button>",1),$N=$("<button> </button>"),VN=$('<div class="odz-flex odz-flex-wrap odz-gap-1.5"></div>'),GN=$('<div class="odz-flex odz-justify-center odz-items-center odz-h-32"><div class="odz-loading odz-loading-spinner odz-loading-md"></div></div>'),WN=$('<div class="odz-text-error odz-text-center odz-py-4"> </div>'),XN=$('<div class="odz-text-center odz-py-4 odz-text-gray-500">  .</div>'),YN=$('<img class="odz-w-12 odz-h-12 odz-object-cover odz-rounded odz-flex-shrink-0">'),JN=$('<div class="odz-w-12 odz-h-12 odz-bg-gray-100 odz-rounded odz-flex odz-items-center odz-justify-center odz-flex-shrink-0"><span class="odz-text-gray-400 odz-text-xs"></span></div>'),ZN=$('<div class="odz-flex odz-items-center odz-gap-3 odz-p-2 odz-bg-base-100 odz-rounded-lg odz-border odz-border-gray-100 hover:odz-bg-gray-50"><!> <div class="odz-flex-1 odz-min-w-0"><h3 class="odz-text-sm odz-font-medium odz-truncate"> </h3> <div class="odz-text-xs odz-text-gray-500"><!></div></div> <button class="odz-btn odz-btn-primary odz-btn-xs odz-flex-shrink-0"></button></div>'),eM=$('<div class="odz-flex odz-justify-center odz-items-center odz-py-3"><div class="odz-loading odz-loading-spinner odz-loading-sm"></div></div>'),tM=$('<div class="odz-flex odz-flex-col odz-gap-2"></div> <!>',1),rM=$('<div class="odz-fixed odz-inset-0 odz-bg-black odz-bg-opacity-50 odz-flex odz-items-center odz-justify-center odz-z-50"><div class="odz-bg-white odz-rounded-lg odz-w-full odz-max-w-2xl odz-mx-4 odz-max-h-[80vh] odz-overflow-hidden odz-flex odz-flex-col"><div class="odz-p-4 odz-border-b odz-flex odz-justify-between odz-items-center"><h2 class="odz-text-lg odz-font-bold"> </h2> <button class="odz-btn odz-btn-ghost odz-btn-sm"><!></button></div> <div class="odz-p-3 odz-border-b odz-space-y-3"><div class="odz-relative"><input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full odz-pl-10 odz-input-sm"> <!></div> <div class="odz-flex odz-items-center odz-gap-1.5 odz-text-xs odz-text-gray-500"><button></button> <!></div> <!></div> <div class="odz-flex-1 odz-overflow-y-auto odz-p-3"><!></div></div></div>');function r2(n,e){ln(e,!1);const t=Be();let r=ht(e,"addProduct",8),o=ht(e,"isProductSearchOpen",12),s=ht(e,"productType",8,""),i=ht(e,"excludeNoProcess",8,!1),a=Be(""),A=Be([]),d=Be([]),c=Be(""),u=Be([]),h=Be(!1),p=Be(null),v,w=!0,y=1;const B=20;let C=Be();to(async()=>{document.body.style.overflow="hidden",window.scrollTo(0,0),document.querySelectorAll('.odz-modal-box, .odz-overflow-y-auto, [style*="overflow"]').forEach(ge=>{ge instanceof HTMLElement&&(ge.scrollTop=0)});try{_(d,await s5()),await Q()}catch(ge){console.error("     :",ge)}}),gs(()=>{document.body.style.overflow=""});async function Q(){_(h,!0),_(p,null);try{const{products:M,total:ge}=await Xf("",void 0,1,B,s(),i());_(A,M),w=l(A).length<ge}catch(M){console.error("    :",M),_(p,"    .")}finally{_(h,!1)}}async function k(){if(!(l(h)||!w)){_(h,!0),y++;try{const{products:M,total:ge}=await Xf(l(a),l(c),y,B,s(),i());M.length>0?(_(A,[...l(A),...M]),w=l(A).length<ge):w=!1}catch(M){console.error("     :",M),_(p,"    .")}finally{_(h,!1)}}}async function H(){if(!l(a).trim()&&!l(c)){await Q();return}_(h,!0),_(p,null),y=1,_(A,[]);try{const{products:M,total:ge}=await Xf(l(a),l(c),1,B,s(),i());_(A,M),w=l(A).length<ge}catch(M){console.error("    :",M),_(p,"    .")}finally{_(h,!1)}}function Z(){clearTimeout(v),v=setTimeout(H,300)}function q(M){_(c,M.id),_(u,[...l(u),M]),H()}function N(M){_(u,l(u).slice(0,M+1)),_(c,l(u)[M].id),H()}function re(M){r()(M.id)}function be(){o(!1),_(a,""),_(c,""),_(u,[]),_(A,[]),_(p,null),y=1,w=!0}function L(){if(!l(C))return;const{scrollTop:M,scrollHeight:ge,clientHeight:_e}=l(C);ge-M<=_e*1.5&&k()}Yt(()=>(l(u),l(d)),()=>{var M;_(t,l(u).length===0?l(d):((M=l(u)[l(u).length-1])==null?void 0:M.children)||[])}),mo(),fn();var R=rM(),J=g(R),se=g(J),fe=x(g(se),2),ie=g(fe);xA(ie,{class:"odz-w-5 odz-h-5"});var pe=x(se,2),te=g(pe),Ce=g(te),ne=x(Ce,2);xp(ne,{class:"odz-absolute odz-left-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-w-4 odz-h-4 odz-text-gray-400"});var ze=x(te,2),z=g(ze),E=x(z,2);tr(E,1,()=>l(u),mr,(M,ge,_e)=>{var Me=KN(),$e=it(Me);vE($e,{class:"odz-w-3 odz-h-3"});var Y=x($e,2),j=g(Y);Ne(()=>{Dr(Y,`hover:odz-text-primary odz-transition-colors ${(_e===l(u).length-1?"odz-text-gray-900 odz-font-medium":"")??""}`),Se(j,l(ge).name)}),At("click",Y,()=>N(_e)),U(M,Me)});var F=x(ze,2);{var I=M=>{var ge=VN();tr(ge,5,()=>l(t),mr,(_e,Me)=>{var $e=$N(),Y=g($e);Ne(()=>{Dr($e,`odz-px-3 odz-py-1 odz-text-xs odz-rounded-full odz-transition-all odz-duration-200
                ${(l(c)===l(Me).id?"odz-bg-primary odz-text-primary-content odz-shadow-sm":"odz-bg-gray-100 odz-text-gray-600 hover:odz-bg-gray-200 hover:odz-text-gray-800")??""}`),Se(Y,l(Me).name)}),At("click",$e,()=>q(l(Me))),U(_e,$e)}),U(M,ge)};ve(F,M=>{l(t).length>0&&M(I)})}var O=x(pe,2),D=g(O);{var P=M=>{var ge=GN();U(M,ge)},K=M=>{var ge=kt(),_e=it(ge);{var Me=Y=>{var j=WN(),ee=g(j);Ne(()=>Se(ee,l(p))),U(Y,j)},$e=Y=>{var j=kt(),ee=it(j);{var ae=me=>{var ye=XN();U(me,ye)},ue=me=>{var ye=tM(),Ee=it(ye);tr(Ee,5,()=>l(A),mr,(Fe,Oe)=>{var Te=ZN(),De=g(Te);{var ce=et=>{var qe=YN();Ne(()=>{cr(qe,"src",l(Oe).thumbnail),cr(qe,"alt",l(Oe).title)}),U(et,qe)},Ie=et=>{var qe=JN();U(et,qe)};ve(De,et=>{l(Oe).thumbnail?et(ce):et(Ie,!1)})}var V=x(De,2),G=g(V),le=g(G),Le=x(G,2),He=g(Le);{var je=et=>{var qe=kt(),ot=it(qe);{var Pe=rt=>{var lt=bn();Ne(vt=>Se(lt,`${vt??""}`),[()=>yr(l(Oe).variants[0].prices[0].amount)],at),U(rt,lt)},Ye=rt=>{var lt=bn();Ne(vt=>Se(lt,`${vt??""} ~`),[()=>yr(Math.min(...l(Oe).variants.map(vt=>vt.prices[0].amount)))],at),U(rt,lt)};ve(ot,rt=>{l(Oe).variants.length===1?rt(Pe):rt(Ye,!1)})}U(et,qe)},xe=et=>{var qe=bn("  ");U(et,qe)};ve(He,et=>{l(Oe).variants&&l(Oe).variants.length>0?et(je):et(xe,!1)})}var Re=x(V,2);Ne(()=>Se(le,l(Oe).title)),At("click",Re,()=>re(l(Oe))),U(Fe,Te)});var de=x(Ee,2);{var Qe=Fe=>{var Oe=eM();U(Fe,Oe)};ve(de,Fe=>{l(h)&&l(A).length>0&&Fe(Qe)})}U(me,ye)};ve(ee,me=>{l(A).length===0&&(l(a)||l(c))?me(ae):me(ue,!1)},!0)}U(Y,j)};ve(_e,Y=>{l(p)?Y(Me):Y($e,!1)},!0)}U(M,ge)};ve(D,M=>{l(h)&&l(A).length===0?M(P):M(K,!1)})}fs(O,M=>_(C,M),()=>l(C)),Ne(()=>Dr(z,`hover:odz-text-primary odz-transition-colors ${(l(u).length===0?"odz-text-gray-900 odz-font-medium":"")??""}`)),At("click",fe,be),Cr(Ce,()=>l(a),M=>_(a,M)),At("input",Ce,Z),At("click",z,()=>{_(u,[]),_(c,""),H()}),At("scroll",O,L),U(n,R),dn()}var nM=$('<div class="odz-text-sm odz-text-gray-600 odz-mt-1"> </div>'),oM=$('<div class="odz-flex odz-items-center odz-justify-between odz-p-3 odz-bg-white odz-rounded-lg odz-border odz-border-gray-200"><div class="odz-flex-1"><div class="odz-font-semibold odz-text-gray-800"> </div> <!></div> <div class="odz-text-right"><div class="odz-font-bold odz-text-lg odz-text-gray-800"> </div></div></div>'),sM=$('<div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border odz-mt-6"><div class="odz-card-body odz-p-3"><h2 class="odz-text-lg odz-font-bold odz-mb-4 odz-flex odz-items-center odz-gap-2"></h2> <div class="odz-space-y-3"></div> <div class="odz-divider odz-my-4"></div> <div class="odz-flex odz-justify-between odz-items-center odz-p-3 odz-bg-white odz-rounded-lg odz-border odz-border-gray-200"><span class="odz-font-bold odz-text-lg odz-text-gray-800"> </span> <span class="odz-font-bold odz-text-xl odz-text-gray-800"> </span></div></div></div>');function iM(n,e){ln(e,!1);const t=Be();let r=ht(e,"additionalCosts",24,()=>[]);ht(e,"isEditable",8,!0),Yt(()=>oo(r()),()=>{_(t,r().reduce((a,A)=>a+Number(A.amount),0))}),mo(),fn();var o=kt(),s=it(o);{var i=a=>{var A=sM(),d=g(A),c=x(g(d),2);tr(c,5,r,v=>v.id,(v,w)=>{var y=oM(),B=g(y),C=g(B),Q=g(C),k=x(C,2);{var H=re=>{var be=nM(),L=g(be);Ne(()=>Se(L,l(w).description)),U(re,be)};ve(k,re=>{l(w).description&&re(H)})}var Z=x(B,2),q=g(Z),N=g(q);Ne(re=>{Se(Q,l(w).name),Se(N,`+${re??""}`)},[()=>yr(Number(l(w).amount))],at),U(v,y)});var u=x(c,4),h=x(g(u),2),p=g(h);Ne(v=>Se(p,`+${v??""}`),[()=>yr(l(t))],at),U(a,A)};ve(s,a=>{r().length>0&&a(i)})}U(n,o),dn()}var aM=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-12 odz-bg-gray-50 odz-rounded-lg"><div class="odz-text-6xl odz-mb-4"></div> <h3 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2"> </h3> <p class="odz-text-sm odz-text-gray-600 odz-mb-6">      </p> <button class="odz-btn odz-btn-primary odz-gap-2"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>  </button></div>'),AM=$("<div><!></div>"),lM=$("<div><!></div>"),dM=$("<div></div>"),cM=$('<div class="odz-mt-5"><div role="tablist" class="odz-tabs odz-tabs-boxed"><button role="tab"></button> <button role="tab"></button></div></div> <!>',1),uM=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-12"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-text-lg odz-font-medium odz-mt-4">   ...</p> <p class="odz-text-sm odz-text-gray-500 odz-mt-2"> ,  ,    .</p></div>'),hM=$('<button class="odz-btn odz-btn-primary"><!>  </button>'),fM=$('<div><h2 class="odz-text-2xl odz-font-bold odz-mb-4"> </h2> <!> <div class="odz-flex odz-justify-end odz-mt-4"><!></div> <!></div>'),pM=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-8"><div class="odz-loading odz-loading-spinner odz-loading-md odz-text-primary"></div> <p class="odz-text-base odz-font-medium odz-mt-3">   ...</p></div>'),gM=$('<span class="odz-badge odz-badge-warning"> </span>'),vM=$('<div class="odz-flex odz-items-center odz-gap-2"><span> </span> <!></div>'),mM=$('<div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="password-input"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input id="password-input" type="password" class="odz-input odz-input-bordered odz-w-full" placeholder="     "> <label class="odz-label" for="password-input"><span class="odz-label-text-alt">     .  !</span></label></div>'),wM=$(`<div class="odz-flex odz-justify-between odz-items-center odz-mb-4"><h2 class="odz-text-lg odz-font-bold odz-flex odz-items-center odz-gap-1">  <div class="odz-flex odz-items-center odz-gap-1"><!> <span class="odz-text-xs odz-text-gray-500 odz-ml-1">  </span></div></h2> <!></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4"><div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder="   . ) ' 000  '" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <input type="text" placeholder="  " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <div class="odz-flex odz-gap-2"><input type="text" placeholder="010" class="odz-input odz-input-bordered odz-w-1/4" maxlength="3"> <input type="text" placeholder="0000" class="odz-input odz-input-bordered odz-w-1/4" maxlength="4"> <input type="text" placeholder="0000" class="odz-input odz-input-bordered odz-w-1/4" maxlength="4"> <span class="odz-text-xs odz-self-center">   ,     .</span></div></div></div> <div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="address-section"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!>  </span></label> <div class="odz-flex odz-gap-2 odz-mb-2"><input type="text" id="postcode" placeholder="" readonly="" class="odz-input odz-input-bordered odz-w-1/4"> <button class="odz-btn odz-btn-secondary"></button> <button class="odz-btn odz-btn-outline"> </button></div> <input type="text" id="address1" placeholder=" " class="odz-input odz-input-bordered odz-w-full odz-mb-2"> <input type="text" id="address2" placeholder=" " class="odz-input odz-input-bordered odz-w-full"> <p class="odz-text-xs odz-mt-1">       .</p></div> <div class="odz-form-control odz-w-full odz-mt-4"><div class="odz-flex odz-gap-4 odz-items-center"><button class="odz-btn odz-btn-outline odz-flex-1"></button> <p class="odz-text-xs">      .</p></div></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-4 odz-mt-4"><div class="odz-form-control odz-w-full"><label class="odz-label" for="shipping-method"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"><!> </span></label> <select id="shipping-method" class="odz-select odz-select-bordered odz-w-full"><option disabled selected>==   ==</option><option></option><option></option><option></option></select></div> <div class="odz-form-control odz-w-full"><label class="odz-label" for="pref-delivery-date"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"></span></label> <input id="pref-delivery-date" type="date" class="odz-input odz-input-bordered odz-w-full"> <label class="odz-label" for="pref-delivery-date-note"><span class="odz-label-text-alt">        .</span></label></div></div> <!> <div class="odz-form-control odz-w-full odz-mt-4"><label class="odz-label" for="request-notes"><span class="odz-label-text odz-font-medium odz-flex odz-items-center odz-gap-1"> </span></label> <textarea id="request-notes" class="odz-textarea odz-textarea-bordered odz-h-24 odz-w-full" placeholder="   ."></textarea></div> <div class="odz-flex odz-justify-end odz-gap-3 odz-mt-6"><button type="button" class="odz-btn odz-btn-outline odz-btn-secondary"><!>  </button> <button class="odz-btn odz-w-full odz-btn-primary md:odz-w-auto disabled:bg-primary/50 disabled:odz-bg-secondary/20"><!> <!></button></div>`,1),yM=$('<!> <!> <div class="odz-card odz-bg-base-100 odz-shadow odz-p-4 odz-rounded-lg odz-border odz-mt-6"><div class="odz-card-body odz-p-3"><!></div></div>',1),_M=$('<div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-ml-3 odz-text-lg odz-font-medium">  ...</span></div>'),bM=$('<div class="odz-text-xs odz-text-gray-400 odz-line-through"> </div> <div class="odz-text-xs odz-text-green-600 odz-font-medium"> </div>',1),xM=$('<div class="odz-text-xs odz-text-gray-400"> </div>'),BM=$('<span class="odz-text-gray-400"></span>'),zM=$('<div class="odz-text-xs odz-text-green-600">   </div>'),CM=$('<div class="odz-text-xs odz-text-blue-600">   -  </div>'),SM=$('<div class="odz-text-xs odz-text-gray-400"> </div>'),EM=$('<div class="odz-text-xs odz-text-gray-500">    </div>'),FM=$('<div class="odz-grid odz-grid-cols-2 md:odz-grid-cols-5 odz-gap-3 md:odz-gap-4 odz-p-4 md:odz-p-6 odz-bg-white"><div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"> </div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400">1  </div></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <!></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"><!></div> <!></div> <div class="odz-text-center"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"></div> <div class="odz-text-2xl odz-font-bold odz-text-gray-900 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400">    </div></div> <div class="odz-text-center md:odz-col-span-1 odz-col-span-2"><div class="odz-text-sm odz-text-gray-500 odz-mb-1"> </div> <div class="odz-text-3xl md:odz-text-2xl odz-font-bold odz-text-red-600 odz-mb-1"> </div> <div class="odz-text-xs odz-text-gray-400"> <!> <!></div></div></div>'),IM=$(`<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><h3 class="odz-text-lg odz-font-bold"> </h3> <div class="odz-space-y-4 odz-py-4"><div><ul class="odz-list-disc odz-ml-5 odz-space-y-2"><li>        
                     
                  </li> <li>   .     
               .</li> <li>( :   22 19-15 3)</li></ul></div> <div><table class="odz-table odz-table-zebra odz-w-full"><tbody><tr><td>*Name:</td><td></td></tr><tr><td>*Country:</td><td></td></tr><tr><td>*ZipCode:</td><td></td></tr><tr><td>*Address:</td><td></td></tr><tr><td>*Tel.No.():</td><td></td></tr><tr><td>*E-mail:</td><td></td></tr></tbody></table></div></div> <div class="odz-modal-action"><button class="odz-btn"></button></div></div></dialog>`),UM=$('<!> <div class="odz-sticky odz-bottom-0 odz-left-0 odz-right-0 odz-mt-6 odz-bg-white odz-border-t odz-shadow-lg"><!></div> <!> <!> <!> <!>',1);function QM(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=()=>an(ni,"$shopStore",t),i=()=>an(Gl,"$customerStore",t);let a=ht(e,"productId",12),A=ht(e,"isEstimateModal",12),d=ht(e,"estimate",12),c=Be(null),u=Be(!1),h=Be(""),p=Be(""),v=Be(0),w=Be(!1),y=Be(""),B=Be(""),C=Be(""),Q=!1,k=Be(!1),H=Be(""),Z=Be(""),q=Be(""),N=Be(),re=Be(),be=Be(),L=Be(""),R=Be(!1),J=Be(!0),se=Be([]),fe=Be(!1);function ie(){var de;if(_(v,0),(de=d())!=null&&de.id&&(console.log(" Edit mode - clearing sessionStorage before DB load"),IE()),er(gt,dt(o).estimateName=d().name||"",dt(o)),er(gt,dt(o).organizationName=d().organization_name||"",dt(o)),er(gt,dt(o).orderName=d().order_name||"",dt(o)),er(gt,dt(o).orderPhone=d().order_phone||"",dt(o)),er(gt,dt(o).postcode=d().postcode||"",dt(o)),er(gt,dt(o).address1=d().address1||"",dt(o)),er(gt,dt(o).address2=d().address2||"",dt(o)),er(gt,dt(o).comment=d().comment||"",dt(o)),er(gt,dt(o).shippingMethod=d().shipping_method||"",dt(o)),er(gt,dt(o).prefDeliveryDate=d().pref_delivery_date||"",dt(o)),er(gt,dt(o).estDeliveryDate=d().est_delivery_date||"",dt(o)),er(gt,dt(o).uploadMemo=d().upload_memo||"",dt(o)),er(gt,dt(o).designUploads=d().design_uploads&&typeof d().design_uploads=="object"&&Array.isArray(d().design_uploads.files)?d().design_uploads.files.map(Qe=>Qe.url):[],dt(o)),er(gt,dt(o).designConfirm=d().design_confirm||"",dt(o)),o().prefDeliveryDate&&_(L,new Date(o().prefDeliveryDate).toISOString().split("T")[0]),_(y,d().postcode||""),_(B,d().address1||""),_(C,d().address2||""),_(J,cc(d().status)),d().order_phone){const Qe=d().order_phone;Qe.length>=3&&_(H,Qe.slice(0,3)),Qe.length>=7&&_(Z,Qe.slice(3,7)),Qe.length>=11&&_(q,Qe.slice(7,11))}D(d().id)}function pe(de){a(o().products[de].product.id),er(gt,dt(o).index=de,dt(o)),_(v,1)}function te(){var de,Qe;if(_(v,1),(!a()||a().trim()==="")&&(o().products.length>0&&o().index>=0&&((Qe=(de=o().products[o().index])==null?void 0:de.product)!=null&&Qe.id)?(a(o().products[o().index].product.id),console.log("   productId :",a())):console.log(" productId     ")),typeof window<"u"&&a()){const Fe=`extended-product-data-cache-${a()}`;try{const Oe=window.sessionStorage.getItem(Fe);if(Oe){const Te=JSON.parse(Oe);Te.printSelection&&!Te.printSelection.isCompleted&&(Te.printSelection.currentMethod="selection",window.sessionStorage.setItem(Fe,JSON.stringify(Te)),console.log("     "))}}catch(Oe){console.warn("     :",Oe)}}}function Ce(){if(!o().products||o().products.length===0||o().index<0||!o().products[o().index]){_(u,!0),_(h," "),_(p,"  .");return}if(o().products[o().index].variants.length<1){_(u,!0),_(h," "),_(p,"1   .");return}if(o().products[o().index].variants.some(Qe=>Qe.quantity===0)){_(u,!0),_(h," "),_(p," 1  ");return}_(v,2)}function ne(){_(w,!0)}function ze(){return Q?Promise.resolve():new Promise(de=>{const Qe=document.createElement("script");Qe.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",Qe.onload=()=>{Q=!0,de()},document.head.appendChild(Qe)})}async function z(){await ze(),new window.daum.Postcode({oncomplete(de){if(_(y,de.zonecode),_(B,de.roadAddress||de.jibunAddress),de.userSelectedType==="R"){let Qe="";de.bname!==""&&/[||]$/g.test(de.bname)&&(Qe+=de.bname),de.buildingName!==""&&de.apartment==="Y"&&(Qe+=Qe!==""?", "+de.buildingName:de.buildingName),Qe!==""&&_(B,l(B)+(" ("+Qe+")"))}}}).open()}function E(){_(k,!0)}function F(de,Qe){const Fe=de.target;Fe.value.length>=parseInt(Fe.getAttribute("maxlength")||"0")&&Qe&&Qe.focus()}function I(de){return de?de.length<4?{valid:!1,message:"  4  ."}:{valid:!0,message:""}:{valid:!1,message:" ."}}async function O(){var de,Qe,Fe,Oe,Te,De,ce,Ie,V,G,le,Le,He,je,xe,Re,et,qe,ot,Pe;try{if(!o().estimateName||!o().organizationName||!o().orderName||!o().orderPhone||!o().shippingMethod){_(u,!0),_(h,"  "),_(p,", ,    .");return}if(!s().customer_id){const lt=I(o().password);if(!lt.valid){_(u,!0),_(h," "),_(p,lt.message);return}}const Ye={name:o().estimateName,organization_name:o().organizationName,order_name:o().orderName,order_phone:o().orderPhone,postcode:l(y),address1:l(B),address2:l(C),comment:o().comment,password:s().customer_id?null:o().password,shipping_method:o().shippingMethod,pref_delivery_date:o().prefDeliveryDate,upload_memo:o().uploadMemo,sess:s().sess,customer_id:s().customer_id,mall_type:i().mallType,shop_id:s().id};let rt;if((de=d())!=null&&de.id){rt=await xc(d().id,Ye);const lt=await Xu(d().id);for(const Ft of lt)Ft.id&&await l5(Ft.id);const vt=await Bc(d().id);for(const Ft of vt)Ft.id&&await d5(Ft.id);for(let Ft=0;Ft<o().products.length;Ft++)await _5(d().id,Ft)}else rt=await h1(Ye);if(!rt.id)throw new Error("  .");for(let lt=0;lt<o().products.length;lt++){const vt=o().products[lt],Ft=vt.discountInfo,Qt=Ft==null?void 0:Ft.discountDetails;for(const Et of vt.variants)if(Et.quantity>0){const mt=Et.prices[0].amount;let Gt=mt,Ht=0;const Ut=vt.variants.reduce(($t,Rt)=>$t+(Rt.quantity||0),0),st=ia(Ut,mt,vt.product.quantity_discounts);st.hasDiscount&&(Gt=st.discountedPrice,Ht=st.discountAmount);const pt=vt.prints&&vt.prints.length>0?"detailed":vt.simplePrints&&vt.simplePrints.length>0?"simple":"none",_t={estimate_id:rt.id,product_id:vt.product.id,variant_id:Et.id,quantity:Et.quantity,idx:lt,price:Gt,original_price:mt,discount_amount:Ht,discount_type:((Qe=st==null?void 0:st.discountInfo)==null?void 0:Qe.type)||null,discount_value:((Fe=st==null?void 0:st.discountInfo)==null?void 0:Fe.value)||null,discount_direction:((Oe=st==null?void 0:st.discountInfo)==null?void 0:Oe.direction)||null,discount_min_quantity:((Te=st==null?void 0:st.discountInfo)==null?void 0:Te.min_quantity)||null,discount_max_quantity:((De=st==null?void 0:st.discountInfo)==null?void 0:De.max_quantity)||null,print_type:pt};await f1(_t)}if(vt.prints&&vt.prints.length>0)for(const Et of vt.prints){const mt={estimate_id:rt.id,idx:lt,template_id:Et.template.id,variant_id:Et.variant_id,price:Et.price||0,colors:Et.colors||null,uploads:Et.uploads||null,name_sheet:Et.nameSheet||null,object_id:Et.objectId||null,original_price:((ce=Et.discountInfo)==null?void 0:ce.originalPrice)||null,discount_amount:((Ie=Et.discountInfo)==null?void 0:Ie.discountAmount)||null,discount_type:((G=(V=Et.discountInfo)==null?void 0:V.discountDetails)==null?void 0:G.type)||null,discount_value:((Le=(le=Et.discountInfo)==null?void 0:le.discountDetails)==null?void 0:Le.value)||null,discount_direction:((je=(He=Et.discountInfo)==null?void 0:He.discountDetails)==null?void 0:je.direction)||null,discount_min_quantity:((Re=(xe=Et.discountInfo)==null?void 0:xe.discountDetails)==null?void 0:Re.min_quantity)||null,discount_max_quantity:((qe=(et=Et.discountInfo)==null?void 0:et.discountDetails)==null?void 0:qe.max_quantity)||null};await g1(mt)}if(vt.addons)for(const[Et,mt]of Object.entries(vt.addons)){if(!mt.variantId||mt.variantId.trim()===""){console.warn("  variantId    :",mt);continue}let Gt=0;if(vt.addonProductsMap&&vt.addonProductsMap[mt.productId]){const st=vt.addonProductsMap[mt.productId].variants.find(pt=>pt.id===mt.variantId);st&&st.prices&&st.prices.length>0&&(Gt=st.prices[0].amount)}const Ht={estimate_id:rt.id,idx:lt,addon_id:Et,selected_product_id:mt.productId,selected_variant_id:mt.variantId,price:Gt,quantity:vt.quantity||0};await y1(Ht)}}console.log(" Estimate    ..."),await b1(rt.id),console.log(" Estimate    "),_(u,!0),_(h,(ot=d())!=null&&ot.id?"  ":"  "),_(p,(Pe=d())!=null&&Pe.id?"  .":s().customer_id?"  .":"  .      ."),A(!1),i().mallType==="godo5"&&(window.location.href="/odiz/list.php")}catch(Ye){console.error("    :",Ye),_(u,!0),_(h," "),_(p,"    .  .")}}to(()=>{var de,Qe;if(er(gt,dt(o).index=o().products.length,dt(o)),(de=d())!=null&&de.id){ie();const Fe=ug(d().id,Oe=>{d(Oe),_(J,cc(Oe.status))});return()=>{Fe.unsubscribe()}}else a()&&P(a());if(!((Qe=d())!=null&&Qe.id)&&i())if(er(gt,dt(o).orderName=i().name,dt(o)),er(gt,dt(o).orderPhone=i().phone.replace(/-/g,""),dt(o)),_(B,i().address1),_(C,i().address2),_(y,i().postcode),i().phone){const Fe=i().phone.replace(/-/g,"");er(gt,dt(o).orderPhone=Fe,dt(o)),Fe.length>=3&&_(H,Fe.slice(0,3)),Fe.length>=7&&_(Z,Fe.slice(3,7)),Fe.length>=11&&_(q,Fe.slice(7,11))}else er(gt,dt(o).orderPhone="",dt(o));ze()});async function D(de){var Qe;_(fe,!0);try{const Fe=await Xu(de),Oe=await Bc(de),Te=await hg(de);_(se,await _1(de));const De=[],ce={};for(const xe of Fe)if(xe.product_id&&xe.product){const Re=xe.idx||0;if(ce[Re]||(ce[Re]={product:xe.product,variants:[],quantity:0,prints:[],addons:{}}),xe.variant_id&&xe.quantity){const et={id:xe.variant_id,quantity:xe.quantity,prices:[{amount:xe.original_price||xe.price||0}],thumbnail:((Qe=xe.variant)==null?void 0:Qe.thumbnail)||null,title:xe.variant_title||` ${xe.variant_id.substring(0,4)}`};ce[Re].variants.push(et),ce[Re].quantity+=xe.quantity}}const Ie=[];for(const xe of Oe)if(xe.template_id&&xe.estimate_id){const Re=xe.idx||0;if(ce[Re]){const et=(async()=>{try{const qe=await ud(xe.template_id);let ot=null;try{ot=await Lc(xe.template_id)}catch(rt){console.warn("templateProduct  :",rt)}const Ye={template:{id:xe.template_id,name:qe.length>0&&qe[qe.length-1].name||"",templateProduct:ot},parentTemplates:qe,price:xe.price||0,colors:xe.colors?typeof xe.colors=="string"?JSON.parse(xe.colors):xe.colors:[],uploads:xe.uploads?typeof xe.uploads=="string"?JSON.parse(xe.uploads):xe.uploads:null,nameSheet:xe.name_sheet?typeof xe.name_sheet=="string"?JSON.parse(xe.name_sheet):xe.name_sheet:null,title:qe.length>0?qe[0].name:"",objectId:xe.object_id||null,variant_id:xe.variant_id||null,discountInfo:xe.original_price?{originalPrice:xe.original_price,discountAmount:xe.discount_amount||0,discountDetails:xe.discount_type?{type:xe.discount_type,value:xe.discount_value||0,direction:xe.discount_direction||null,min_quantity:xe.discount_min_quantity||null,max_quantity:xe.discount_max_quantity||null}:void 0,hasDiscount:(xe.discount_amount||0)>0}:void 0};ce[Re].prints.push(Ye)}catch(qe){console.error("    :",qe);const Pe={template:{id:xe.template_id,name:"",templateProduct:null},parentTemplates:[],price:xe.price||0,colors:xe.colors?typeof xe.colors=="string"?JSON.parse(xe.colors):xe.colors:[],uploads:xe.uploads?typeof xe.uploads=="string"?JSON.parse(xe.uploads):xe.uploads:null,title:"",objectId:xe.object_id||null,variant_id:xe.variant_id||null,nameSheet:xe.name_sheet?typeof xe.name_sheet=="string"?JSON.parse(xe.name_sheet):xe.name_sheet:null,discountInfo:xe.original_price?{originalPrice:xe.original_price,discountAmount:xe.discount_amount||0,discountDetails:xe.discount_type?{type:xe.discount_type,value:xe.discount_value||0,direction:xe.discount_direction||null,min_quantity:xe.discount_min_quantity||null,max_quantity:xe.discount_max_quantity||null}:void 0,hasDiscount:(xe.discount_amount||0)>0}:void 0};ce[Re].prints.push(Pe)}})();Ie.push(et)}}await Promise.all(Ie),Te.forEach(xe=>{const Re=xe.idx||0;ce[Re]?(ce[Re].addons||(ce[Re].addons={}),ce[Re].addons[xe.addon_id]={productId:xe.selected_product_id,variantId:xe.selected_variant_id||""}):console.log(`productGroups[${Re}]  `)});const V=[];for(const xe in ce){const Re=ce[xe];if(Re.product&&Object.keys(Re.addons||{}).length>0){const et=(async()=>{try{const qe=await hh(Re.product.id);Re.addonProductsMap={},qe.forEach(ot=>{ot.items.forEach(Pe=>{var Ye,rt,lt;Pe.addon_product&&((lt=(rt=(Ye=Pe.addon_product.variants)==null?void 0:Ye[0])==null?void 0:rt.prices)!=null&&lt[0])&&(Re.addonProductsMap[Pe.addon_product.id]={price:Pe.addon_product.variants[0].prices[0].amount,title:Pe.addon_product.title,variants:Pe.addon_product.variants})})})}catch(qe){console.error(`idx ${xe}    :`,qe),Re.addonProductsMap={}}})();V.push(et)}De.push(Re)}await Promise.all(V),Nb(gt,{...o(),products:De,index:(De.length>0,0)});const G=De.reduce((xe,Re)=>xe+Re.quantity,0),le=De.reduce((xe,Re)=>xe+(Re.variants||[]).reduce((et,qe)=>{const ot=qe.quantity||0;return et+qe.prices[0].amount*ot},0),0),Le=De.reduce((xe,Re)=>xe+(Re.prints||[]).reduce((et,qe)=>et+(qe.price||0),0),0),He=De.reduce((xe,Re)=>{if(!Re.addons||Object.keys(Re.addons).length===0||!Re.addonProductsMap)return xe;const et=Re.quantity||0,qe=Object.values(Re.addons).reduce((ot,Pe)=>{const Ye=Re.addonProductsMap[Pe.productId];if(Ye&&Pe.variantId){const rt=Ye.variants.find(lt=>lt.id===Pe.variantId);if(rt&&rt.prices&&rt.prices.length>0){const lt=rt.prices[0].amount*et;return ot+lt}}return ot},0);return xe+qe},0),je=l(se).reduce((xe,Re)=>xe+Number(Re.amount),0);er(gt,dt(o).totalQuantity=G,dt(o)),er(gt,dt(o).totalProductAmount=le,dt(o)),er(gt,dt(o).totalPrintAmount=Le,dt(o)),er(gt,dt(o).totalAddonAmount=He,dt(o)),er(gt,dt(o).totalAdditionalAmount=je,dt(o)),er(gt,dt(o).totalAmount=le+Le+He+je,dt(o)),setTimeout(()=>{gt.updateTotalAmounts()},200)}catch(Fe){console.error("     :",Fe),er(gt,dt(o).products=[],dt(o))}finally{_(fe,!1)}}function P(de){_(R,!1),a(de),er(gt,dt(o).index=o().products.length,dt(o)),_(v,1)}Yt(()=>(l(k),l(w),l(c)),()=>{var de;(l(k)||l(w))&&(_(c,(de=document.getElementById("estimate-modal"))==null?void 0:de.querySelector(".odz-modal-box")),l(c)&&br(c,l(c).scrollTop=0))}),Yt(()=>(o(),l(H),l(Z),l(q)),()=>{if(o().orderPhone&&!l(H)&&!l(Z)&&!l(q)){const de=o().orderPhone;de.length>=3&&_(H,de.slice(0,3)),de.length>=7&&_(Z,de.slice(3,7)),de.length>=11&&_(q,de.slice(7,11))}}),Yt(()=>(l(H),l(Z),l(q)),()=>{er(gt,dt(o).orderPhone=`${l(H)}${l(Z)}${l(q)}`,dt(o))}),Yt(()=>(l(u),l(c)),()=>{var de;l(u)&&(_(c,(de=document.getElementById("estimate-modal"))==null?void 0:de.querySelector(".odz-modal-box")),l(c)&&br(c,l(c).scrollTop=0))}),Yt(()=>l(L),()=>{l(L)&&er(gt,dt(o).prefDeliveryDate=new Date(l(L)).toISOString(),dt(o))}),mo(),fn();var K=UM(),M=it(K);{var ge=de=>{var Qe=cM(),Fe=it(Qe),Oe=g(Fe),Te=g(Oe),De=x(Te,2),ce=x(Fe,2);{var Ie=G=>{var le=AM(),Le=g(le);{var He=xe=>{EF(xe,{get productId(){return a()},get step(){return l(v)},set step(Re){_(v,Re)},$$legacy:!0})},je=xe=>{var Re=aM(),et=x(g(Re),6);At("click",et,()=>_(R,!0)),U(xe,Re)};ve(Le,xe=>{a()&&a().trim()!==""?xe(He):xe(je,!1)})}U(G,le)},V=G=>{var le=kt(),Le=it(le);{var He=xe=>{var Re=lM(),et=g(Re);const qe=at(()=>{var ot;return(ot=d())==null?void 0:ot.id});Gx(et,{get productId(){return a()},get estimateId(){return l(qe)},get idx(){return o().index},get step(){return l(v)},set step(ot){_(v,ot)},$$legacy:!0}),U(xe,Re)},je=xe=>{var Re=kt(),et=it(Re);{var qe=ot=>{var Pe=dM();U(ot,Pe)};ve(et,ot=>{l(v)===3&&ot(qe)},!0)}U(xe,Re)};ve(Le,xe=>{l(v)===2?xe(He):xe(je,!1)},!0)}U(G,le)};ve(ce,G=>{l(v)===1?G(Ie):G(V,!1)})}Ne(()=>{Dr(Te,`odz-tab ${(l(v)===1?"odz-tab-active":"")??""}`),Dr(De,`odz-tab ${(l(v)===2?"odz-tab-active":"")??""}`)}),At("click",Te,te),At("click",De,Ce),U(de,Qe)},_e=de=>{var Qe=yM(),Fe=it(Qe);{var Oe=He=>{var je=uM();U(He,je)},Te=He=>{var je=fM(),xe=x(g(je),2);M5(xe,{onSelectProduct:pe,get isEditable(){return l(J)},set isEditable(Pe){_(J,Pe)},$$legacy:!0});var Re=x(xe,2),et=g(Re);{var qe=Pe=>{var Ye=hM(),rt=g(Ye);Wu(rt,{class:"odz-w-5 odz-h-5 odz-mr-2"}),At("click",Ye,()=>_(R,!0)),U(Pe,Ye)};ve(et,Pe=>{l(J)&&Pe(qe)})}var ot=x(Re,2);iM(ot,{get additionalCosts(){return l(se)},get isEditable(){return l(J)}}),U(He,je)};ve(Fe,He=>{l(fe)?He(Oe):He(Te,!1)})}var De=x(Fe,2);{var ce=He=>{r2(He,{addProduct:P,productType:"godo",get isProductSearchOpen(){return l(R)},set isProductSearchOpen(je){_(R,je)},$$legacy:!0})};ve(De,He=>{l(R)&&He(ce)})}var Ie=x(De,2),V=g(Ie),G=g(V);{var le=He=>{var je=pM();U(He,je)},Le=He=>{var je=wM(),xe=it(je),Re=g(xe),et=x(g(Re)),qe=g(et);qA(qe,{class:"odz-text-error",size:10});var ot=x(Re,2);{var Pe=yt=>{var rr=vM(),Br=g(rr),gn=g(Br),Dn=x(Br,2);{var Sr=Xr=>{var Fn=gM();U(Xr,Fn)};ve(Dn,Xr=>{l(J)||Xr(Sr)})}Ne(()=>{Dr(Br,`odz-badge odz-badge-${(d().status==="pending"?"warning":d().status==="progress"?"info":d().status==="completed"?"success":"error")??""}`),Se(gn,d().status==="pending"?"":d().status==="progress"?"":d().status==="completed"?"":"")}),U(yt,rr)};ve(ot,yt=>{var rr;(rr=d())!=null&&rr.id&&yt(Pe)})}var Ye=x(xe,2),rt=g(Ye),lt=g(rt),vt=g(lt),Ft=g(vt);qA(Ft,{class:"odz-text-error",size:12});var Qt=x(lt,2),Et=x(rt,2),mt=g(Et),Gt=g(mt),Ht=g(Gt);qA(Ht,{class:"odz-text-error",size:12});var Ut=x(mt,2),st=x(Et,2),pt=g(st),_t=g(pt),$t=g(_t);qA($t,{class:"odz-text-error",size:12});var Rt=x(pt,2),Ot=x(st,2),Ct=g(Ot),Wt=g(Ct),It=g(Wt);qA(It,{class:"odz-text-error",size:12});var St=x(Ct,2),jt=g(St);fs(jt,yt=>_(N,yt),()=>l(N));var dr=x(jt,2);fs(dr,yt=>_(re,yt),()=>l(re));var pr=x(dr,2);fs(pr,yt=>_(be,yt),()=>l(be));var ar=x(Ye,2),ur=g(ar),Ir=g(ur),Yr=g(Ir);qA(Yr,{class:"odz-text-error",size:12});var Jr=x(ur,2),qr=g(Jr),Ar=x(qr,2),Lr=x(Ar,2),Kr=x(Jr,2),xr=x(Kr,2),Pr=x(ar,4),Hr=g(Pr),cn=g(Hr),pn=g(cn),Wr=g(pn);qA(Wr,{class:"odz-text-error",size:12});var wr=x(cn,2);Ne(()=>{o(),Ru(()=>{l(J)})});var En=g(wr);En.value=((En.__value="")==null,"");var Do=x(En);Do.value=(Do.__value="delivery")==null?"":"delivery";var wo=x(Do);wo.value=(wo.__value="pickup")==null?"":"pickup";var yo=x(wo);yo.value=(yo.__value="quick")==null?"":"quick";var vs=x(Hr,2),io=x(g(vs),2),No=x(Pr,2);{var Rn=yt=>{var rr=mM(),Br=g(rr),gn=g(Br),Dn=g(gn);qA(Dn,{class:"odz-text-error",size:12});var Sr=x(Br,2);Ne(()=>Sr.readOnly=!l(J)),Cr(Sr,()=>o().password,Xr=>er(gt,dt(o).password=Xr,dt(o))),U(yt,rr)};ve(No,yt=>{s().customer_id||yt(Rn)})}var Ve=x(No,2),wt=x(g(Ve),2),qt=x(Ve,2),Kt=g(qt),kr=g(Kt);L0(kr,{class:"odz-w-5 odz-h-5 odz-mr-2"});var fr=x(Kt,2),ir=g(fr);L0(ir,{class:"odz-w-5 odz-h-5 odz-mr-2"});var Ur=x(ir,2);{var Or=yt=>{var rr=bn(" ");U(yt,rr)},Yn=yt=>{var rr=bn(" ");U(yt,rr)};ve(Ur,yt=>{var rr;(rr=d())!=null&&rr.id?yt(Or):yt(Yn,!1)})}Ne(yt=>{Qt.readOnly=!l(J),Ut.readOnly=!l(J),Rt.readOnly=!l(J),jt.readOnly=!l(J),dr.readOnly=!l(J),pr.readOnly=!l(J),Kr.readOnly=!l(J),xr.readOnly=!l(J),wr.disabled=!l(J),io.disabled=!l(J),cr(io,"min",yt),wt.readOnly=!l(J),fr.disabled=!l(J)},[()=>new Date().toISOString().split("T")[0]],at),Cr(Qt,()=>o().estimateName,yt=>er(gt,dt(o).estimateName=yt,dt(o))),Cr(Ut,()=>o().organizationName,yt=>er(gt,dt(o).organizationName=yt,dt(o))),Cr(Rt,()=>o().orderName,yt=>er(gt,dt(o).orderName=yt,dt(o))),Cr(jt,()=>l(H),yt=>_(H,yt)),At("input",jt,yt=>F(yt,l(re))),Cr(dr,()=>l(Z),yt=>_(Z,yt)),At("input",dr,yt=>F(yt,l(be))),Cr(pr,()=>l(q),yt=>_(q,yt)),At("input",pr,yt=>F(yt)),Cr(qr,()=>l(y),yt=>_(y,yt)),At("click",Ar,z),At("click",Lr,E),Cr(Kr,()=>l(B),yt=>_(B,yt)),Cr(xr,()=>l(C),yt=>_(C,yt)),Ku(wr,()=>o().shippingMethod,yt=>er(gt,dt(o).shippingMethod=yt,dt(o))),Cr(io,()=>l(L),yt=>_(L,yt)),Cr(wt,()=>o().comment,yt=>er(gt,dt(o).comment=yt,dt(o))),At("click",Kt,ne),At("click",fr,O),U(He,je)};ve(G,He=>{l(fe)?He(le):He(Le,!1)})}U(de,Qe)};ve(M,de=>{l(v)>0?de(ge):de(_e,!1)})}var Me=x(M,2),$e=g(Me);{var Y=de=>{var Qe=_M();U(de,Qe)},j=de=>{var Qe=FM(),Fe=g(Qe),Oe=x(g(Fe),2),Te=g(Oe),De=x(Fe,2),ce=x(g(De),2),Ie=g(ce),V=x(ce,2);{var G=st=>{var pt=bM();const _t=at(()=>o().products.reduce((It,St)=>{var jt;return It+(((jt=St.discountInfo)==null?void 0:jt.originalAmount)||0)},0)),$t=at(()=>o().products.reduce((It,St)=>{var jt;return It+(((jt=St.discountInfo)==null?void 0:jt.discountAmount)||0)},0));var Rt=it(pt),Ot=g(Rt),Ct=x(Rt,2),Wt=g(Ct);Ne((It,St)=>{Se(Ot,`${It??""}`),Se(Wt,`-${St??""} `)},[()=>yr(l(_t)),()=>yr(l($t))],at),U(st,pt)},le=st=>{var pt=xM();U(st,pt)};ve(V,st=>{o().products.some(pt=>{var _t;return(_t=pt.discountInfo)==null?void 0:_t.hasDiscount})?st(G):st(le,!1)})}var Le=x(De,2),He=x(g(Le),2),je=g(He);{var xe=st=>{var pt=BM();U(st,pt)},Re=st=>{var pt=bn();Ne(_t=>Se(pt,`${_t??""}`),[()=>yr(o().totalPrintAmount)],at),U(st,pt)};ve(je,st=>{o().totalPrintAmount===0?st(xe):st(Re,!1)})}var et=x(He,2);{var qe=st=>{var pt=zM();U(st,pt)},ot=st=>{var pt=kt(),_t=it(pt);{var $t=Ot=>{var Ct=CM();U(Ot,Ct)},Rt=Ot=>{var Ct=kt(),Wt=it(Ct);{var It=jt=>{var dr=SM();U(jt,dr)},St=jt=>{var dr=EM();U(jt,dr)};ve(Wt,jt=>{o().products.some(dr=>dr.print_type==="none")?jt(It):jt(St,!1)},!0)}U(Ot,Ct)};ve(_t,Ot=>{o().products.some(Ct=>Ct.print_type==="simple")?Ot($t):Ot(Rt,!1)},!0)}U(st,pt)};ve(et,st=>{o().totalPrintAmount>0?st(qe):st(ot,!1)})}var Pe=x(Le,2),Ye=x(g(Pe),2),rt=g(Ye),lt=x(Pe,2),vt=x(g(lt),2),Ft=g(vt),Qt=x(vt,2),Et=g(Qt),mt=x(Et);{var Gt=st=>{var pt=bn("+ ( )");U(st,pt)};ve(mt,st=>{o().totalPrintAmount>0&&st(Gt)})}var Ht=x(mt,2);{var Ut=st=>{var pt=bn();Ne(_t=>Se(pt,`+ ${_t??""}`),[()=>yr(o().totalAdditionalAmount)],at),U(st,pt)};ve(Ht,st=>{o().totalAdditionalAmount>0&&st(Ut)})}Ne((st,pt,_t)=>{Se(Te,`${o().totalQuantity||0}`),Se(Ie,`${st??""}`),Se(rt,`${pt??""}`),Se(Ft,`${_t??""}`),Se(Et,` ${st??""} + 
          ${pt??""} `)},[()=>yr(o().totalProductAmount),()=>yr(o().totalAddonAmount),()=>yr(o().totalAmount)],at),U(de,Qe)};ve($e,de=>{l(fe)?de(Y):de(j,!1)})}var ee=x(Me,2);{var ae=de=>{var Qe=IM(),Fe=g(Qe),Oe=x(g(Fe),4),Te=g(Oe);At("click",Te,()=>_(k,!1)),U(de,Qe)};ve(ee,de=>{l(k)&&de(ae)})}var ue=x(ee,2);{var me=de=>{Cz(de,{get isOpen(){return l(w)},set isOpen(Qe){_(w,Qe)},$$legacy:!0})};ve(ue,de=>{l(w)&&de(me)})}var ye=x(ue,2);Pc(ye,{get isOpen(){return l(u)},set isOpen(de){_(u,de)},get title(){return l(h)},set title(de){_(h,de)},get message(){return l(p)},set message(de){_(p,de)},$$legacy:!0});var Ee=x(ye,2);kc(Ee,{get isLoading(){return l(fe)},set isLoading(de){_(fe,de)},$$legacy:!0}),U(n,K),dn(),r()}var TM=$('<div class="odz-alert odz-alert-error"> </div>'),LM=$('<div class="odz-mb-4"><!></div>'),PM=$('<div class="odz-border odz-rounded odz-p-2 odz-text-center"><img class="odz-max-w-full odz-mx-auto odz-mb-2 odz-object-contain"></div>'),kM=$('<div><h4 class="odz-font-semibold odz-mb-2"> </h4> <div class="odz-flex odz-flex-col odz-justify-center"></div></div>'),OM=$('<p class="odz-text-base odz-font-semibold odz-mb-3"> </p>'),DM=$('<div class="odz-border odz-rounded-lg odz-p-2 odz-w-full sm:odz-w-48 md:odz-w-56 odz-flex odz-items-center odz-gap-3"><img class="odz-w-12 odz-h-12 odz-object-cover odz-rounded odz-flex-shrink-0"> <div class="odz-flex-grow odz-min-w-0"><p class="odz-text-xs odz-font-medium odz-truncate"> </p> <p class="odz-text-xs odz-text-gray-500"> </p></div></div>'),NM=$('<div class="odz-mb-4"><!> <div class="odz-flex odz-flex-wrap odz-gap-3"></div></div>'),MM=$('<div class="odz-border odz-rounded odz-p-2 odz-text-center"><img class="odz-max-w-full odz-mx-auto odz-mb-2 odz-object-contain"></div>'),HM=$('<div class="odz-flex odz-flex-col odz-justify-center"></div>'),jM=$('<p class="odz-text-xs odz-text-gray-500">     .</p>'),RM=$('<div class="odz-mb-2"><h6 class="odz-font-medium odz-text-sm odz-mb-2"> </h6> <!></div>'),qM=$('<div class="odz-mb-6 odz-p-4 odz-border odz-rounded-lg"><h5 class="odz-font-medium odz-text-base odz-mb-3"> </h5> <!> <!></div>'),KM=$("<div></div>"),$M=$('<p class="odz-text-center odz-text-gray-500 odz-py-4">   .</p>'),VM=$('<div class="odz-mt-4"><!></div>'),GM=$('<div class="odz-chat odz-chat-end"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1">[]</div> <div class="odz-chat-bubble odz-text-sm odz-chat-bubble-success odz-chat-bubble-outline"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),WM=$('<div class="odz-chat odz-chat-end"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1"></div> <div class="odz-chat-bubble odz-chat-bubble-secondary odz-chat-bubble-outline"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),XM=$('<div class="odz-chat odz-chat-start"><div class="odz-chat-header odz-text-xs odz-opacity-50 odz-mb-1"> </div> <div class="odz-chat-bubble odz-chat-bubble-gray"> <div class="odz-chat-footer odz-opacity-50 odz-text-xs"> </div></div></div>'),YM=$('<p class="odz-text-center odz-text-sm odz-text-gray-500">  .</p>'),JM=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),ZM=$('<div role="alert" class="odz-alert odz-alert-warning"><svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <span> :    .</span></div>'),e7=$('<div role="alert" class="odz-alert odz-alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),t7=$('<div role="alert" class="odz-alert odz-alert-info"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),r7=$('<div role="alert" class="odz-alert odz-alert-secondary"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="stroke-current shrink-0 w-6 h-6"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> :     .</span></div>'),n7=$('<div role="alert" class="odz-alert odz-alert-success odz-alert-outline"><span> :   .</span></div>'),o7=$('<button class="odz-btn odz-btn-success"> </button> <button class="odz-btn odz-btn-error"> </button>',1),s7=$('<div class="odz-space-y-6"><!> <!> <!> <!></div> <div class="odz-divider odz-my-6"></div> <div class="odz-space-y-4"><div class="odz-max-h-60 odz-overflow-y-auto odz-p-2 odz-bg-base-200 odz-rounded-lg odz-space-y-3"></div> <div class="odz-flex odz-gap-2 odz-items-center"><input type="text" placeholder=" ..." class="odz-input odz-input-bordered odz-flex-grow"> <button class="odz-btn odz-btn-primary"><!> </button></div></div> <div class="odz-mt-6"><!></div> <div class="odz-modal-action odz-mt-6"><button class="odz-btn"></button> <!></div>',1),i7=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-5xl"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button> <h3 class="odz-font-bold odz-text-lg odz-mb-4"> </h3> <!></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),a7=$('<div class="odz-flex odz-gap-4"><label class="odz-label odz-cursor-pointer odz-gap-1"><span class="odz-label-text odz-text-xs odz-whitespace-nowrap"></span> <input type="radio" class="odz-radio odz-radio-sm"></label> <label class="odz-label odz-cursor-pointer odz-gap-1"><span class="odz-label-text odz-text-xs odz-whitespace-nowrap"></span> <input type="radio" class="odz-radio odz-radio-sm"></label></div>'),A7=$('<input type="checkbox" class="odz-checkbox odz-checkbox-sm">'),l7=$('<div class="odz-form-control"><label class="odz-label odz-cursor-pointer odz-gap-4"><span class="odz-label-text odz-text-xs"> </span> <!></label></div>'),d7=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>   ...',1),c7=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-2xl"><h3 class="odz-font-bold odz-text-lg">    </h3> <p class="odz-py-4 odz-text-sm">       .</p> <div class="odz-form-control odz-mb-4"><label class="odz-label odz-cursor-pointer"><span class="odz-label-text odz-font-semibold"> .</span> <input type="checkbox" class="odz-checkbox odz-checkbox-primary"></label></div> <div class="odz-space-y-2 odz-border-t odz-border-b odz-py-4 odz-max-h-60 odz-overflow-y-auto"></div> <div class="odz-modal-action odz-mt-6"><button class="odz-btn"></button> <button class="odz-btn odz-btn-primary"><!></button></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),u7=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>  ...',1),h7=$('<dialog class="odz-modal odz-modal-open"><div class="odz-modal-box"><h3 class="odz-font-bold odz-text-lg odz-mb-4">   </h3> <textarea class="odz-textarea odz-textarea-bordered odz-w-full odz-h-32" placeholder="   ..."></textarea> <div class="odz-modal-action odz-mt-4"><button class="odz-btn"></button> <button class="odz-btn odz-btn-error"><!></button></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),f7=$("<!> <!> <!> <!>",1);function p7(n,e){ln(e,!1);let t=ht(e,"estimateId",8),r=ht(e,"isOpen",12),o=Be(null),s=Be(!0),i=Be(null),a=Be({}),A=Be([]),d=Be(""),c=Be(""),u=null,h=null,p=null,v=Be(!1),w=Be(""),y=Be(""),B=Be([]),C=Be(""),Q=Be(!1),k=Be(),H=Be(!1),Z=Be(""),q=Be(!1),N=Be(!1),re=Be([!1,!1,!1,!1,!1,!1,!1]),be=Be(!1),L=Be(!1);const R=["     .","          .","    .","    ,    ?","           .","   , ,       .","    ? ( ,  3 )"];function J(Y){if(!Y)return null;try{return typeof Y=="object"&&Y!==null?Y:JSON.parse(Y)}catch(j){return console.error("Failed to parse JSON:",j,"Input:",Y),null}}async function se(){await ra(),l(k)&&br(k,l(k).scrollTop=l(k).scrollHeight)}function fe(){var j;if(!l(o))return;if((j=l(o).estimate)!=null&&j.design_uploads){const ee=typeof l(o).estimate.design_uploads=="string"?J(l(o).estimate.design_uploads):l(o).estimate.design_uploads;ee&&Array.isArray(ee.files)?_(A,ee.files.map(ae=>({url:ae.url,name:ae.name}))):_(A,[]),_(d,(ee==null?void 0:ee.topHTML)||""),_(c,(ee==null?void 0:ee.bottomHTML)||"")}else _(A,[]),_(d,""),_(c,"");const Y={};l(o).items.length>0&&(l(o).items.forEach(ee=>{const ae=ee.idx??0;Y[ae]||(Y[ae]={items:[],prints:[]}),Y[ae].items.push(ee)}),l(o).prints.forEach(ee=>{const ae=ee.idx??0;Y[ae]||(console.warn(`Print found for idx ${ae} but no corresponding item group exists.`),Y[ae]={items:[],prints:[]});const ue=typeof ee.design_uploads=="string"?J(ee.design_uploads):ee.design_uploads;ee.parsed_uploads=(ue==null?void 0:ue.files)||[],Y[ae].prints.find(ye=>ye.id===ee.id)||Y[ae].prints.push(ee)})),_(a,Y),console.log("Processed and grouped data:",l(a)),Object.entries(l(a)).forEach(([ee,ae])=>{console.log(`idx ${ee}: ${ae.prints.length} print(s)`,ae.prints.map(ue=>{var me;return{id:ue.id,parsed_uploads_count:(me=ue.parsed_uploads)==null?void 0:me.length}}))})}to(async()=>{if(!t()){_(i," ID  ."),_(s,!1);return}_(s,!0),_(i,null);try{const[Y,j]=await Promise.all([v1(t()),u5(t())]);_(o,Y),_(B,j),console.log("Fetched initial details in component:",l(o)),console.log("Fetched initial comments in component:",l(B)),fe(),u=ug(t(),ee=>{console.log("Received estimate update:",ee),l(o)&&(br(o,l(o).estimate={...l(o).estimate,...ee}),fe())}),console.log("Subscribed to estimate changes:",u),h=m1(t(),ee=>{console.log("Received comment update payload:",ee),ee.eventType==="INSERT"&&ee.new?_(B,[...l(B),ee.new]):ee.eventType==="DELETE"&&ee.old?_(B,l(B).filter(ae=>ae.id!==ee.old.id)):ee.eventType==="UPDATE"&&ee.new&&_(B,l(B).map(ae=>{var ue;return ae.id===((ue=ee.new)==null?void 0:ue.id)?{...ae,...ee.new}:ae})),se()}),console.log("Subscribed to comment changes:",h),p=w1(t(),ee=>{if(console.log("Received print update payload:",ee),l(o)){let ae=!1;if(ee.eventType==="INSERT"&&ee.new)br(o,l(o).prints=[...l(o).prints,ee.new]),ae=!0;else if(ee.eventType==="DELETE"&&ee.old){const ue=l(o).prints.length;br(o,l(o).prints=l(o).prints.filter(me=>me.id!==ee.old.id)),l(o).prints.length<ue&&(ae=!0)}else if(ee.eventType==="UPDATE"&&ee.new){const ue=l(o).prints.findIndex(me=>{var ye;return me.id===((ye=ee.new)==null?void 0:ye.id)});ue!==-1&&(br(o,l(o).prints[ue]={...l(o).prints[ue],...ee.new}),ae=!0)}ae&&(fe(),console.log("Prints array updated, re-processed data"))}}),console.log("Subscribed to print changes:",p),se()}catch(Y){console.error("Error loading initial data or subscribing:",Y),_(i,"        .")}finally{_(s,!1)}}),gs(()=>{u&&(console.log("Unsubscribing from estimate changes"),u.unsubscribe()),h&&(console.log("Unsubscribing from comment changes"),h.unsubscribe()),p&&(console.log("Unsubscribing from print changes"),p.unsubscribe())});function ie(){r(!1)}function pe(){_(re,Array(R.length).fill(!1)),_(be,!1),_(N,!0)}function te(){_(N,!1)}function Ce(){for(let Y=0;Y<R.length-1;Y++)br(re,l(re)[Y]=l(be));_(re,[...l(re)]),console.log({confirmationChecks:l(re)})}function ne(Y,j){br(re,l(re)[Y]=j),Y<R.length-1&&_(be,l(re).slice(0,-1).every(ee=>ee===!0)),_(re,[...l(re)])}function ze(){_(Z,""),_(H,!0)}function z(){_(H,!1)}async function E(){var ae,ue;if(!l(Z).trim()){_(w," "),_(y,"   ."),_(v,!0);return}if(!((ue=(ae=l(o))==null?void 0:ae.estimate)!=null&&ue.id))return;const Y=l(o).estimate.id;_(q,!0);let j=null,ee=null;try{try{await Jf({estimate_id:Y,comment:`[] ${l(Z)}`,system:!1,writer:"customer"}),console.log("Rejection comment added successfully.")}catch(me){throw j=me,console.error("Error adding rejection comment:",j),new Error("     .")}try{await xc(Y,{design_confirm:"processing"}),console.log("Estimate status updated to processing.")}catch(me){throw ee=me,console.error("Error updating estimate status after rejection:",ee),new Error("    .")}z(),ie()}catch(me){console.error("Error during rejection process:",me),_(w,""),_(y,me.message||"     ."),_(v,!0)}finally{_(q,!1)}}async function F(){var ue,me;if(!((me=(ue=l(o))==null?void 0:ue.estimate)!=null&&me.id))return;const Y=l(o).estimate.id,j=l(re)[R.length-1];_(L,!0);let ee=null,ae=null;try{await xc(Y,{design_confirm:"completed",use_reorder:j,...l(o).estimate.auto_complete_on_approval?{status:"completed"}:{}}),console.log(`Estimate status updated to completed with use_reorder: ${j}.`);try{await Jf({estimate_id:Y,comment:"",system:!0,writer:"customer"}),console.log("System comment added successfully with writer as customer.")}catch(ye){ae=ye,console.error("Error adding system comment after approval:",ae)}}catch(ye){ee=ye,console.error("Error approving design:",ee)}finally{_(L,!1),ee?(_(w,""),_(y,"      ."),_(v,!0)):ae?(_(w,""),_(y," ,      ."),_(v,!0)):(te(),ie())}}async function I(){var Y,j;if(!(!l(C).trim()||!((j=(Y=l(o))==null?void 0:Y.estimate)!=null&&j.id))){_(Q,!0);try{await Jf({estimate_id:l(o).estimate.id,comment:l(C),system:!1,writer:"customer"}),_(C,"")}catch(ee){console.error("Error sending comment:",ee),_(w,""),_(y,"    ."),_(v,!0)}finally{_(Q,!1)}}}function O(Y){if(!Y)return"";try{return new Date(Y).toLocaleString("ko-KR",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})}catch{return Y}}fn();var D=f7(),P=it(D);{var K=Y=>{var j=i7(),ee=g(j),ae=g(ee),ue=x(ae,2),me=g(ue),ye=x(ue,2);{var Ee=Oe=>{kc(Oe,{get isLoading(){return l(s)},set isLoading(Te){_(s,Te)},$$legacy:!0})},de=Oe=>{var Te=kt(),De=it(Te);{var ce=V=>{var G=TM(),le=g(G);Ne(()=>Se(le,l(i))),U(V,G)},Ie=V=>{var G=kt(),le=it(G);{var Le=He=>{var je=s7(),xe=it(je),Re=g(xe);{var et=It=>{var St=LM(),jt=g(St);x0(jt,()=>l(d),!1,!1),U(It,St)};ve(Re,It=>{l(d)&&It(et)})}var qe=x(Re,2);{var ot=It=>{var St=kM(),jt=x(g(St),2);tr(jt,5,()=>l(A),mr,(dr,pr)=>{var ar=PM(),ur=g(ar);Ne(()=>{cr(ur,"src",l(pr).url),cr(ur,"alt",l(pr).name)}),U(dr,ar)}),U(It,St)};ve(qe,It=>{l(A).length>0&&It(ot)})}var Pe=x(qe,2);{var Ye=It=>{var St=KM();tr(St,5,()=>Object.entries(l(a)),mr,(jt,dr)=>{let pr=()=>l(dr)[0],ar=()=>l(dr)[1];var ur=qM(),Ir=g(ur),Yr=g(Ir),Jr=x(Ir,2);{var qr=Kr=>{var xr=NM(),Pr=g(xr);{var Hr=pn=>{var Wr=OM(),wr=g(Wr);Ne(()=>Se(wr,ar().items[0].product.title)),U(pn,Wr)};ve(Pr,pn=>{var Wr;(Wr=ar().items[0].product)!=null&&Wr.title&&pn(Hr)})}var cn=x(Pr,2);tr(cn,5,()=>ar().items,mr,(pn,Wr)=>{var wr=DM(),En=g(wr),Do=x(En,2),wo=g(Do),yo=g(wo),vs=x(wo,2),io=g(vs);Ne(()=>{var No,Rn,Ve;cr(En,"src",((No=l(Wr).variant)==null?void 0:No.thumbnail)||l(Wr).thumbnail||"/placeholder.png"),cr(En,"alt",l(Wr).variant_title||((Rn=l(Wr).variant)==null?void 0:Rn.title)),Se(yo,l(Wr).variant_title||((Ve=l(Wr).variant)==null?void 0:Ve.title)||"  "),Se(io,`${l(Wr).quantity??""}`)}),U(pn,wr)}),U(Kr,xr)};ve(Jr,Kr=>{ar().items.length>0&&Kr(qr)})}var Ar=x(Jr,2);{var Lr=Kr=>{var xr=RM();const Pr=at(()=>ar().prints[0]),Hr=at(()=>{var wr;return((wr=l(Pr))==null?void 0:wr.parsed_uploads)||[]});var cn=x(g(xr),2);{var pn=wr=>{var En=HM();tr(En,5,()=>l(Hr),mr,(Do,wo)=>{var yo=MM(),vs=g(yo);Ne(()=>{cr(vs,"src",l(wo).url),cr(vs,"alt",l(wo).name)}),U(Do,yo)}),U(wr,En)},Wr=wr=>{var En=jM();U(wr,En)};ve(cn,wr=>{l(Hr).length>0?wr(pn):wr(Wr,!1)})}U(Kr,xr)};ve(Ar,Kr=>{ar().prints.length>0&&Kr(Lr)})}Ne(Kr=>{cr(ur,"data-idx",pr()),Se(Yr,` ${Kr??""}`)},[()=>Number(pr())+1],at),U(jt,ur)}),U(It,St)},rt=It=>{var St=kt(),jt=it(St);{var dr=pr=>{var ar=$M();U(pr,ar)};ve(jt,pr=>{l(A).length===0&&pr(dr)},!0)}U(It,St)};ve(Pe,It=>{Object.keys(l(a)).length>0?It(Ye):It(rt,!1)})}var lt=x(Pe,2);{var vt=It=>{var St=VM(),jt=g(St);x0(jt,()=>l(c),!1,!1),U(It,St)};ve(lt,It=>{l(c)&&It(vt)})}var Ft=x(xe,4),Qt=g(Ft);tr(Qt,5,()=>l(B),It=>It.id,(It,St)=>{var jt=kt(),dr=it(jt);{var pr=ur=>{var Ir=GM(),Yr=x(g(Ir),2),Jr=g(Yr),qr=x(Jr),Ar=g(qr);Ne(Lr=>{Se(Jr,`${l(St).comment??""} `),Se(Ar,Lr)},[()=>O(l(St).created_at)],at),U(ur,Ir)},ar=ur=>{var Ir=kt(),Yr=it(Ir);{var Jr=Ar=>{var Lr=WM(),Kr=x(g(Lr),2),xr=g(Kr),Pr=x(xr),Hr=g(Pr);Ne(cn=>{Se(xr,`${l(St).comment??""} `),Se(Hr,cn)},[()=>O(l(St).created_at)],at),U(Ar,Lr)},qr=Ar=>{var Lr=XM(),Kr=g(Lr),xr=g(Kr),Pr=x(Kr,2),Hr=g(Pr),cn=x(Hr),pn=g(cn);Ne(Wr=>{Se(xr,l(St).writer||""),Se(Hr,`${l(St).comment??""} `),Se(pn,Wr)},[()=>O(l(St).created_at)],at),U(Ar,Lr)};ve(Yr,Ar=>{l(St).writer==="customer"?Ar(Jr):Ar(qr,!1)},!0)}U(ur,Ir)};ve(dr,ur=>{l(St).system?ur(pr):ur(ar,!1)})}U(It,jt)},It=>{var St=YM();U(It,St)}),fs(Qt,It=>_(k,It),()=>l(k));var Et=x(Qt,2),mt=g(Et),Gt=x(mt,2),Ht=g(Gt);{var Ut=It=>{var St=JM();U(It,St)};ve(Ht,It=>{l(Q)&&It(Ut)})}var st=x(Ft,2),pt=g(st);{var _t=It=>{var St=ZM();U(It,St)},$t=It=>{var St=kt(),jt=it(St);{var dr=ar=>{var ur=e7();U(ar,ur)},pr=ar=>{var ur=kt(),Ir=it(ur);{var Yr=qr=>{var Ar=t7();U(qr,Ar)},Jr=qr=>{var Ar=kt(),Lr=it(Ar);{var Kr=Pr=>{var Hr=r7();U(Pr,Hr)},xr=Pr=>{var Hr=kt(),cn=it(Hr);{var pn=Wr=>{var wr=n7();U(Wr,wr)};ve(cn,Wr=>{var wr,En;((En=(wr=l(o))==null?void 0:wr.estimate)==null?void 0:En.design_confirm)==="completed"&&Wr(pn)},!0)}U(Pr,Hr)};ve(Lr,Pr=>{var Hr,cn;((cn=(Hr=l(o))==null?void 0:Hr.estimate)==null?void 0:cn.design_confirm)==="confirming"?Pr(Kr):Pr(xr,!1)},!0)}U(qr,Ar)};ve(Ir,qr=>{var Ar,Lr;((Lr=(Ar=l(o))==null?void 0:Ar.estimate)==null?void 0:Lr.design_confirm)==="processing"?qr(Yr):qr(Jr,!1)},!0)}U(ar,ur)};ve(jt,ar=>{var ur,Ir;((Ir=(ur=l(o))==null?void 0:ur.estimate)==null?void 0:Ir.design_confirm)==="waiting"?ar(dr):ar(pr,!1)},!0)}U(It,St)};ve(pt,It=>{var St,jt;((jt=(St=l(o))==null?void 0:St.estimate)==null?void 0:jt.design_confirm)==="none"?It(_t):It($t,!1)})}var Rt=x(st,2),Ot=g(Rt),Ct=x(Ot,2);{var Wt=It=>{var St=o7(),jt=it(St),dr=x(jt,2);Ne(()=>{jt.disabled=l(L),dr.disabled=l(L)}),At("click",jt,pe),At("click",dr,ze),U(It,St)};ve(Ct,It=>{var St,jt;((jt=(St=l(o))==null?void 0:St.estimate)==null?void 0:jt.design_confirm)==="confirming"&&It(Wt)})}Ne(It=>{mt.disabled=l(Q),Gt.disabled=It,Ot.disabled=l(L)},[()=>l(Q)||!l(C).trim()],at),Cr(mt,()=>l(C),It=>_(C,It)),At("keydown",mt,It=>It.key==="Enter"&&!It.isComposing&&I()),At("click",Gt,I),At("click",Ot,ie),U(He,je)};ve(le,He=>{l(o)&&He(Le)},!0)}U(V,G)};ve(De,V=>{l(i)?V(ce):V(Ie,!1)},!0)}U(Oe,Te)};ve(ye,Oe=>{l(s)?Oe(Ee):Oe(de,!1)})}var Qe=x(ee,2),Fe=g(Qe);Ne(()=>{var Oe,Te;return Se(me,`  - ${((Te=(Oe=l(o))==null?void 0:Oe.estimate)==null?void 0:Te.name)||""}`)}),At("click",ae,ie),At("click",Fe,ie),U(Y,j)};ve(P,Y=>{r()&&Y(K)})}var M=x(P,2);{var ge=Y=>{var j=c7(),ee=g(j),ae=x(g(ee),4),ue=g(ae),me=x(g(ue),2),ye=x(ae,2);tr(ye,5,()=>R,mr,(Ie,V,G)=>{var le=l7(),Le=g(le),He=g(Le),je=g(He),xe=x(He,2);{var Re=qe=>{var ot=a7(),Pe=g(ot),Ye=x(g(Pe),2);cr(Ye,"name",`reorder-${G??""}`);var rt=x(Pe,2),lt=x(g(rt),2);cr(lt,"name",`reorder-${G??""}`),Ne(()=>{qu(Ye,l(re)[G]),qu(lt,!l(re)[G])}),At("change",Ye,vt=>ne(G,vt.target.checked)),At("change",lt,vt=>ne(G,!vt.target.checked)),U(qe,ot)},et=qe=>{var ot=A7();z0(ot,()=>l(re)[G],Pe=>br(re,l(re)[G]=Pe)),At("change",ot,Pe=>ne(G,Pe.target.checked)),U(qe,ot)};ve(xe,qe=>{G===6?qe(Re):qe(et,!1)})}Ne(()=>Se(je,l(V))),U(Ie,le)});var Ee=x(ye,2),de=g(Ee),Qe=x(de,2),Fe=g(Qe);{var Oe=Ie=>{var V=d7();U(Ie,V)},Te=Ie=>{var V=bn("");U(Ie,V)};ve(Fe,Ie=>{l(L)?Ie(Oe):Ie(Te,!1)})}var De=x(ee,2),ce=g(De);Ne(()=>{de.disabled=l(L),Qe.disabled=!l(be)||l(L)}),z0(me,()=>l(be),Ie=>_(be,Ie)),At("change",me,Ce),At("click",de,te),At("click",Qe,F),At("click",ce,te),U(Y,j)};ve(M,Y=>{l(N)&&Y(ge)})}var _e=x(M,2);{var Me=Y=>{var j=h7(),ee=g(j),ae=x(g(ee),2),ue=x(ae,2),me=g(ue),ye=x(me,2),Ee=g(ye);{var de=Te=>{var De=u7();U(Te,De)},Qe=Te=>{var De=bn(" ");U(Te,De)};ve(Ee,Te=>{l(q)?Te(de):Te(Qe,!1)})}var Fe=x(ee,2),Oe=g(Fe);Ne(Te=>{ae.disabled=l(q),me.disabled=l(q),ye.disabled=Te},[()=>l(q)||!l(Z).trim()],at),Cr(ae,()=>l(Z),Te=>_(Z,Te)),At("click",me,z),At("click",ye,E),At("click",Oe,z),U(Y,j)};ve(_e,Y=>{l(H)&&Y(Me)})}var $e=x(_e,2);Pc($e,{get isOpen(){return l(v)},set isOpen(Y){_(v,Y)},get title(){return l(w)},set title(Y){_(w,Y)},get message(){return l(y)},set message(Y){_(y,Y)},$$legacy:!0}),U(n,D),dn()}function Sz(n,e){return function(){return n.apply(e,arguments)}}const{toString:g7}=Object.prototype,{getPrototypeOf:n2}=Object,{iterator:jg,toStringTag:Ez}=Symbol,Rg=(n=>e=>{const t=g7.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),ha=n=>(n=n.toLowerCase(),e=>Rg(e)===n),qg=n=>e=>typeof e===n,{isArray:Rc}=Array,ih=qg("undefined");function v7(n){return n!==null&&!ih(n)&&n.constructor!==null&&!ih(n.constructor)&&ti(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Fz=ha("ArrayBuffer");function m7(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Fz(n.buffer),e}const w7=qg("string"),ti=qg("function"),Iz=qg("number"),Kg=n=>n!==null&&typeof n=="object",y7=n=>n===!0||n===!1,up=n=>{if(Rg(n)!=="object")return!1;const e=n2(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Ez in n)&&!(jg in n)},_7=ha("Date"),b7=ha("File"),x7=ha("Blob"),B7=ha("FileList"),z7=n=>Kg(n)&&ti(n.pipe),C7=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||ti(n.append)&&((e=Rg(n))==="formdata"||e==="object"&&ti(n.toString)&&n.toString()==="[object FormData]"))},S7=ha("URLSearchParams"),[E7,F7,I7,U7]=["ReadableStream","Request","Response","Headers"].map(ha),Q7=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function wh(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,o;if(typeof n!="object"&&(n=[n]),Rc(n))for(r=0,o=n.length;r<o;r++)e.call(null,n[r],r,n);else{const s=t?Object.getOwnPropertyNames(n):Object.keys(n),i=s.length;let a;for(r=0;r<i;r++)a=s[r],e.call(null,n[a],a,n)}}function Uz(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,o;for(;r-- >0;)if(o=t[r],e===o.toLowerCase())return o;return null}const $l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Qz=n=>!ih(n)&&n!==$l;function km(){const{caseless:n}=Qz(this)&&this||{},e={},t=(r,o)=>{const s=n&&Uz(e,o)||o;up(e[s])&&up(r)?e[s]=km(e[s],r):up(r)?e[s]=km({},r):Rc(r)?e[s]=r.slice():e[s]=r};for(let r=0,o=arguments.length;r<o;r++)arguments[r]&&wh(arguments[r],t);return e}const T7=(n,e,t,{allOwnKeys:r}={})=>(wh(e,(o,s)=>{t&&ti(o)?n[s]=Sz(o,t):n[s]=o},{allOwnKeys:r}),n),L7=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),P7=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},k7=(n,e,t,r)=>{let o,s,i;const a={};if(e=e||{},n==null)return e;do{for(o=Object.getOwnPropertyNames(n),s=o.length;s-- >0;)i=o[s],(!r||r(i,n,e))&&!a[i]&&(e[i]=n[i],a[i]=!0);n=t!==!1&&n2(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},O7=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},D7=n=>{if(!n)return null;if(Rc(n))return n;let e=n.length;if(!Iz(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},N7=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&n2(Uint8Array)),M7=(n,e)=>{const r=(n&&n[jg]).call(n);let o;for(;(o=r.next())&&!o.done;){const s=o.value;e.call(n,s[0],s[1])}},H7=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},j7=ha("HTMLFormElement"),R7=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,o){return r.toUpperCase()+o}),I_=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),q7=ha("RegExp"),Tz=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};wh(t,(o,s)=>{let i;(i=e(o,s,n))!==!1&&(r[s]=i||o)}),Object.defineProperties(n,r)},K7=n=>{Tz(n,(e,t)=>{if(ti(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(ti(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},$7=(n,e)=>{const t={},r=o=>{o.forEach(s=>{t[s]=!0})};return Rc(n)?r(n):r(String(n).split(e)),t},V7=()=>{},G7=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function W7(n){return!!(n&&ti(n.append)&&n[Ez]==="FormData"&&n[jg])}const X7=n=>{const e=new Array(10),t=(r,o)=>{if(Kg(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[o]=r;const s=Rc(r)?[]:{};return wh(r,(i,a)=>{const A=t(i,o+1);!ih(A)&&(s[a]=A)}),e[o]=void 0,s}}return r};return t(n,0)},Y7=ha("AsyncFunction"),J7=n=>n&&(Kg(n)||ti(n))&&ti(n.then)&&ti(n.catch),Lz=((n,e)=>n?setImmediate:e?((t,r)=>($l.addEventListener("message",({source:o,data:s})=>{o===$l&&s===t&&r.length&&r.shift()()},!1),o=>{r.push(o),$l.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",ti($l.postMessage)),Z7=typeof queueMicrotask<"u"?queueMicrotask.bind($l):typeof process<"u"&&process.nextTick||Lz,eH=n=>n!=null&&ti(n[jg]),bt={isArray:Rc,isArrayBuffer:Fz,isBuffer:v7,isFormData:C7,isArrayBufferView:m7,isString:w7,isNumber:Iz,isBoolean:y7,isObject:Kg,isPlainObject:up,isReadableStream:E7,isRequest:F7,isResponse:I7,isHeaders:U7,isUndefined:ih,isDate:_7,isFile:b7,isBlob:x7,isRegExp:q7,isFunction:ti,isStream:z7,isURLSearchParams:S7,isTypedArray:N7,isFileList:B7,forEach:wh,merge:km,extend:T7,trim:Q7,stripBOM:L7,inherits:P7,toFlatObject:k7,kindOf:Rg,kindOfTest:ha,endsWith:O7,toArray:D7,forEachEntry:M7,matchAll:H7,isHTMLForm:j7,hasOwnProperty:I_,hasOwnProp:I_,reduceDescriptors:Tz,freezeMethods:K7,toObjectSet:$7,toCamelCase:R7,noop:V7,toFiniteNumber:G7,findKey:Uz,global:$l,isContextDefined:Qz,isSpecCompliantForm:W7,toJSONObject:X7,isAsyncFn:Y7,isThenable:J7,setImmediate:Lz,asap:Z7,isIterable:eH};function Rr(n,e,t,r,o){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),o&&(this.response=o,this.status=o.status?o.status:null)}bt.inherits(Rr,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:bt.toJSONObject(this.config),code:this.code,status:this.status}}});const Pz=Rr.prototype,kz={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{kz[n]={value:n}});Object.defineProperties(Rr,kz);Object.defineProperty(Pz,"isAxiosError",{value:!0});Rr.from=(n,e,t,r,o,s)=>{const i=Object.create(Pz);return bt.toFlatObject(n,i,function(A){return A!==Error.prototype},a=>a!=="isAxiosError"),Rr.call(i,n.message,e,t,r,o),i.cause=n,i.name=n.name,s&&Object.assign(i,s),i};const tH=null;function Om(n){return bt.isPlainObject(n)||bt.isArray(n)}function Oz(n){return bt.endsWith(n,"[]")?n.slice(0,-2):n}function U_(n,e,t){return n?n.concat(e).map(function(o,s){return o=Oz(o),!t&&s?"["+o+"]":o}).join(t?".":""):e}function rH(n){return bt.isArray(n)&&!n.some(Om)}const nH=bt.toFlatObject(bt,{},null,function(e){return/^is[A-Z]/.test(e)});function $g(n,e,t){if(!bt.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=bt.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(w,y){return!bt.isUndefined(y[w])});const r=t.metaTokens,o=t.visitor||c,s=t.dots,i=t.indexes,A=(t.Blob||typeof Blob<"u"&&Blob)&&bt.isSpecCompliantForm(e);if(!bt.isFunction(o))throw new TypeError("visitor must be a function");function d(v){if(v===null)return"";if(bt.isDate(v))return v.toISOString();if(!A&&bt.isBlob(v))throw new Rr("Blob is not supported. Use a Buffer instead.");return bt.isArrayBuffer(v)||bt.isTypedArray(v)?A&&typeof Blob=="function"?new Blob([v]):Buffer.from(v):v}function c(v,w,y){let B=v;if(v&&!y&&typeof v=="object"){if(bt.endsWith(w,"{}"))w=r?w:w.slice(0,-2),v=JSON.stringify(v);else if(bt.isArray(v)&&rH(v)||(bt.isFileList(v)||bt.endsWith(w,"[]"))&&(B=bt.toArray(v)))return w=Oz(w),B.forEach(function(Q,k){!(bt.isUndefined(Q)||Q===null)&&e.append(i===!0?U_([w],k,s):i===null?w:w+"[]",d(Q))}),!1}return Om(v)?!0:(e.append(U_(y,w,s),d(v)),!1)}const u=[],h=Object.assign(nH,{defaultVisitor:c,convertValue:d,isVisitable:Om});function p(v,w){if(!bt.isUndefined(v)){if(u.indexOf(v)!==-1)throw Error("Circular reference detected in "+w.join("."));u.push(v),bt.forEach(v,function(B,C){(!(bt.isUndefined(B)||B===null)&&o.call(e,B,bt.isString(C)?C.trim():C,w,h))===!0&&p(B,w?w.concat(C):[C])}),u.pop()}}if(!bt.isObject(n))throw new TypeError("data must be an object");return p(n),e}function Q_(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function o2(n,e){this._pairs=[],n&&$g(n,this,e)}const Dz=o2.prototype;Dz.append=function(e,t){this._pairs.push([e,t])};Dz.toString=function(e){const t=e?function(r){return e.call(this,r,Q_)}:Q_;return this._pairs.map(function(o){return t(o[0])+"="+t(o[1])},"").join("&")};function oH(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Nz(n,e,t){if(!e)return n;const r=t&&t.encode||oH;bt.isFunction(t)&&(t={serialize:t});const o=t&&t.serialize;let s;if(o?s=o(e,t):s=bt.isURLSearchParams(e)?e.toString():new o2(e,t).toString(r),s){const i=n.indexOf("#");i!==-1&&(n=n.slice(0,i)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class T_{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){bt.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Mz={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},sH=typeof URLSearchParams<"u"?URLSearchParams:o2,iH=typeof FormData<"u"?FormData:null,aH=typeof Blob<"u"?Blob:null,AH={isBrowser:!0,classes:{URLSearchParams:sH,FormData:iH,Blob:aH},protocols:["http","https","file","blob","url","data"]},s2=typeof window<"u"&&typeof document<"u",Dm=typeof navigator=="object"&&navigator||void 0,lH=s2&&(!Dm||["ReactNative","NativeScript","NS"].indexOf(Dm.product)<0),dH=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",cH=s2&&window.location.href||"http://localhost",uH=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:s2,hasStandardBrowserEnv:lH,hasStandardBrowserWebWorkerEnv:dH,navigator:Dm,origin:cH},Symbol.toStringTag,{value:"Module"})),Fs={...uH,...AH};function hH(n,e){return $g(n,new Fs.classes.URLSearchParams,Object.assign({visitor:function(t,r,o,s){return Fs.isNode&&bt.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function fH(n){return bt.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function pH(n){const e={},t=Object.keys(n);let r;const o=t.length;let s;for(r=0;r<o;r++)s=t[r],e[s]=n[s];return e}function Hz(n){function e(t,r,o,s){let i=t[s++];if(i==="__proto__")return!0;const a=Number.isFinite(+i),A=s>=t.length;return i=!i&&bt.isArray(o)?o.length:i,A?(bt.hasOwnProp(o,i)?o[i]=[o[i],r]:o[i]=r,!a):((!o[i]||!bt.isObject(o[i]))&&(o[i]=[]),e(t,r,o[i],s)&&bt.isArray(o[i])&&(o[i]=pH(o[i])),!a)}if(bt.isFormData(n)&&bt.isFunction(n.entries)){const t={};return bt.forEachEntry(n,(r,o)=>{e(fH(r),o,t,0)}),t}return null}function gH(n,e,t){if(bt.isString(n))try{return(e||JSON.parse)(n),bt.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const yh={transitional:Mz,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",o=r.indexOf("application/json")>-1,s=bt.isObject(e);if(s&&bt.isHTMLForm(e)&&(e=new FormData(e)),bt.isFormData(e))return o?JSON.stringify(Hz(e)):e;if(bt.isArrayBuffer(e)||bt.isBuffer(e)||bt.isStream(e)||bt.isFile(e)||bt.isBlob(e)||bt.isReadableStream(e))return e;if(bt.isArrayBufferView(e))return e.buffer;if(bt.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return hH(e,this.formSerializer).toString();if((a=bt.isFileList(e))||r.indexOf("multipart/form-data")>-1){const A=this.env&&this.env.FormData;return $g(a?{"files[]":e}:e,A&&new A,this.formSerializer)}}return s||o?(t.setContentType("application/json",!1),gH(e)):e}],transformResponse:[function(e){const t=this.transitional||yh.transitional,r=t&&t.forcedJSONParsing,o=this.responseType==="json";if(bt.isResponse(e)||bt.isReadableStream(e))return e;if(e&&bt.isString(e)&&(r&&!this.responseType||o)){const i=!(t&&t.silentJSONParsing)&&o;try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?Rr.from(a,Rr.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Fs.classes.FormData,Blob:Fs.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};bt.forEach(["delete","get","head","post","put","patch"],n=>{yh.headers[n]={}});const vH=bt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),mH=n=>{const e={};let t,r,o;return n&&n.split(`
`).forEach(function(i){o=i.indexOf(":"),t=i.substring(0,o).trim().toLowerCase(),r=i.substring(o+1).trim(),!(!t||e[t]&&vH[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},L_=Symbol("internals");function hu(n){return n&&String(n).trim().toLowerCase()}function hp(n){return n===!1||n==null?n:bt.isArray(n)?n.map(hp):String(n)}function wH(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const yH=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function d0(n,e,t,r,o){if(bt.isFunction(r))return r.call(this,e,t);if(o&&(e=t),!!bt.isString(e)){if(bt.isString(r))return e.indexOf(r)!==-1;if(bt.isRegExp(r))return r.test(e)}}function _H(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function bH(n,e){const t=bt.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(o,s,i){return this[r].call(this,e,o,s,i)},configurable:!0})})}let ri=class{constructor(e){e&&this.set(e)}set(e,t,r){const o=this;function s(a,A,d){const c=hu(A);if(!c)throw new Error("header name must be a non-empty string");const u=bt.findKey(o,c);(!u||o[u]===void 0||d===!0||d===void 0&&o[u]!==!1)&&(o[u||A]=hp(a))}const i=(a,A)=>bt.forEach(a,(d,c)=>s(d,c,A));if(bt.isPlainObject(e)||e instanceof this.constructor)i(e,t);else if(bt.isString(e)&&(e=e.trim())&&!yH(e))i(mH(e),t);else if(bt.isObject(e)&&bt.isIterable(e)){let a={},A,d;for(const c of e){if(!bt.isArray(c))throw TypeError("Object iterator must return a key-value pair");a[d=c[0]]=(A=a[d])?bt.isArray(A)?[...A,c[1]]:[A,c[1]]:c[1]}i(a,t)}else e!=null&&s(t,e,r);return this}get(e,t){if(e=hu(e),e){const r=bt.findKey(this,e);if(r){const o=this[r];if(!t)return o;if(t===!0)return wH(o);if(bt.isFunction(t))return t.call(this,o,r);if(bt.isRegExp(t))return t.exec(o);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=hu(e),e){const r=bt.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||d0(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let o=!1;function s(i){if(i=hu(i),i){const a=bt.findKey(r,i);a&&(!t||d0(r,r[a],a,t))&&(delete r[a],o=!0)}}return bt.isArray(e)?e.forEach(s):s(e),o}clear(e){const t=Object.keys(this);let r=t.length,o=!1;for(;r--;){const s=t[r];(!e||d0(this,this[s],s,e,!0))&&(delete this[s],o=!0)}return o}normalize(e){const t=this,r={};return bt.forEach(this,(o,s)=>{const i=bt.findKey(r,s);if(i){t[i]=hp(o),delete t[s];return}const a=e?_H(s):String(s).trim();a!==s&&delete t[s],t[a]=hp(o),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return bt.forEach(this,(r,o)=>{r!=null&&r!==!1&&(t[o]=e&&bt.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(o=>r.set(o)),r}static accessor(e){const r=(this[L_]=this[L_]={accessors:{}}).accessors,o=this.prototype;function s(i){const a=hu(i);r[a]||(bH(o,i),r[a]=!0)}return bt.isArray(e)?e.forEach(s):s(e),this}};ri.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);bt.reduceDescriptors(ri.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});bt.freezeMethods(ri);function c0(n,e){const t=this||yh,r=e||t,o=ri.from(r.headers);let s=r.data;return bt.forEach(n,function(a){s=a.call(t,s,o.normalize(),e?e.status:void 0)}),o.normalize(),s}function jz(n){return!!(n&&n.__CANCEL__)}function qc(n,e,t){Rr.call(this,n??"canceled",Rr.ERR_CANCELED,e,t),this.name="CanceledError"}bt.inherits(qc,Rr,{__CANCEL__:!0});function Rz(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new Rr("Request failed with status code "+t.status,[Rr.ERR_BAD_REQUEST,Rr.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function xH(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function BH(n,e){n=n||10;const t=new Array(n),r=new Array(n);let o=0,s=0,i;return e=e!==void 0?e:1e3,function(A){const d=Date.now(),c=r[s];i||(i=d),t[o]=A,r[o]=d;let u=s,h=0;for(;u!==o;)h+=t[u++],u=u%n;if(o=(o+1)%n,o===s&&(s=(s+1)%n),d-i<e)return;const p=c&&d-c;return p?Math.round(h*1e3/p):void 0}}function zH(n,e){let t=0,r=1e3/e,o,s;const i=(d,c=Date.now())=>{t=c,o=null,s&&(clearTimeout(s),s=null),n.apply(null,d)};return[(...d)=>{const c=Date.now(),u=c-t;u>=r?i(d,c):(o=d,s||(s=setTimeout(()=>{s=null,i(o)},r-u)))},()=>o&&i(o)]}const Yp=(n,e,t=3)=>{let r=0;const o=BH(50,250);return zH(s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,A=i-r,d=o(A),c=i<=a;r=i;const u={loaded:i,total:a,progress:a?i/a:void 0,bytes:A,rate:d||void 0,estimated:d&&a&&c?(a-i)/d:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(u)},t)},P_=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},k_=n=>(...e)=>bt.asap(()=>n(...e)),CH=Fs.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,Fs.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(Fs.origin),Fs.navigator&&/(msie|trident)/i.test(Fs.navigator.userAgent)):()=>!0,SH=Fs.hasStandardBrowserEnv?{write(n,e,t,r,o,s){const i=[n+"="+encodeURIComponent(e)];bt.isNumber(t)&&i.push("expires="+new Date(t).toGMTString()),bt.isString(r)&&i.push("path="+r),bt.isString(o)&&i.push("domain="+o),s===!0&&i.push("secure"),document.cookie=i.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function EH(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function FH(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function qz(n,e,t){let r=!EH(e);return n&&(r||t==!1)?FH(n,e):e}const O_=n=>n instanceof ri?{...n}:n;function id(n,e){e=e||{};const t={};function r(d,c,u,h){return bt.isPlainObject(d)&&bt.isPlainObject(c)?bt.merge.call({caseless:h},d,c):bt.isPlainObject(c)?bt.merge({},c):bt.isArray(c)?c.slice():c}function o(d,c,u,h){if(bt.isUndefined(c)){if(!bt.isUndefined(d))return r(void 0,d,u,h)}else return r(d,c,u,h)}function s(d,c){if(!bt.isUndefined(c))return r(void 0,c)}function i(d,c){if(bt.isUndefined(c)){if(!bt.isUndefined(d))return r(void 0,d)}else return r(void 0,c)}function a(d,c,u){if(u in e)return r(d,c);if(u in n)return r(void 0,d)}const A={url:s,method:s,data:s,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:a,headers:(d,c,u)=>o(O_(d),O_(c),u,!0)};return bt.forEach(Object.keys(Object.assign({},n,e)),function(c){const u=A[c]||o,h=u(n[c],e[c],c);bt.isUndefined(h)&&u!==a||(t[c]=h)}),t}const Kz=n=>{const e=id({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:o,xsrfCookieName:s,headers:i,auth:a}=e;e.headers=i=ri.from(i),e.url=Nz(qz(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&i.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let A;if(bt.isFormData(t)){if(Fs.hasStandardBrowserEnv||Fs.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if((A=i.getContentType())!==!1){const[d,...c]=A?A.split(";").map(u=>u.trim()).filter(Boolean):[];i.setContentType([d||"multipart/form-data",...c].join("; "))}}if(Fs.hasStandardBrowserEnv&&(r&&bt.isFunction(r)&&(r=r(e)),r||r!==!1&&CH(e.url))){const d=o&&s&&SH.read(s);d&&i.set(o,d)}return e},IH=typeof XMLHttpRequest<"u",UH=IH&&function(n){return new Promise(function(t,r){const o=Kz(n);let s=o.data;const i=ri.from(o.headers).normalize();let{responseType:a,onUploadProgress:A,onDownloadProgress:d}=o,c,u,h,p,v;function w(){p&&p(),v&&v(),o.cancelToken&&o.cancelToken.unsubscribe(c),o.signal&&o.signal.removeEventListener("abort",c)}let y=new XMLHttpRequest;y.open(o.method.toUpperCase(),o.url,!0),y.timeout=o.timeout;function B(){if(!y)return;const Q=ri.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),H={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:Q,config:n,request:y};Rz(function(q){t(q),w()},function(q){r(q),w()},H),y=null}"onloadend"in y?y.onloadend=B:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(B)},y.onabort=function(){y&&(r(new Rr("Request aborted",Rr.ECONNABORTED,n,y)),y=null)},y.onerror=function(){r(new Rr("Network Error",Rr.ERR_NETWORK,n,y)),y=null},y.ontimeout=function(){let k=o.timeout?"timeout of "+o.timeout+"ms exceeded":"timeout exceeded";const H=o.transitional||Mz;o.timeoutErrorMessage&&(k=o.timeoutErrorMessage),r(new Rr(k,H.clarifyTimeoutError?Rr.ETIMEDOUT:Rr.ECONNABORTED,n,y)),y=null},s===void 0&&i.setContentType(null),"setRequestHeader"in y&&bt.forEach(i.toJSON(),function(k,H){y.setRequestHeader(H,k)}),bt.isUndefined(o.withCredentials)||(y.withCredentials=!!o.withCredentials),a&&a!=="json"&&(y.responseType=o.responseType),d&&([h,v]=Yp(d,!0),y.addEventListener("progress",h)),A&&y.upload&&([u,p]=Yp(A),y.upload.addEventListener("progress",u),y.upload.addEventListener("loadend",p)),(o.cancelToken||o.signal)&&(c=Q=>{y&&(r(!Q||Q.type?new qc(null,n,y):Q),y.abort(),y=null)},o.cancelToken&&o.cancelToken.subscribe(c),o.signal&&(o.signal.aborted?c():o.signal.addEventListener("abort",c)));const C=xH(o.url);if(C&&Fs.protocols.indexOf(C)===-1){r(new Rr("Unsupported protocol "+C+":",Rr.ERR_BAD_REQUEST,n));return}y.send(s||null)})},QH=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,o;const s=function(d){if(!o){o=!0,a();const c=d instanceof Error?d:this.reason;r.abort(c instanceof Rr?c:new qc(c instanceof Error?c.message:c))}};let i=e&&setTimeout(()=>{i=null,s(new Rr(`timeout ${e} of ms exceeded`,Rr.ETIMEDOUT))},e);const a=()=>{n&&(i&&clearTimeout(i),i=null,n.forEach(d=>{d.unsubscribe?d.unsubscribe(s):d.removeEventListener("abort",s)}),n=null)};n.forEach(d=>d.addEventListener("abort",s));const{signal:A}=r;return A.unsubscribe=()=>bt.asap(a),A}},TH=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,o;for(;r<t;)o=r+e,yield n.slice(r,o),r=o},LH=async function*(n,e){for await(const t of PH(n))yield*TH(t,e)},PH=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},D_=(n,e,t,r)=>{const o=LH(n,e);let s=0,i,a=A=>{i||(i=!0,r&&r(A))};return new ReadableStream({async pull(A){try{const{done:d,value:c}=await o.next();if(d){a(),A.close();return}let u=c.byteLength;if(t){let h=s+=u;t(h)}A.enqueue(new Uint8Array(c))}catch(d){throw a(d),d}},cancel(A){return a(A),o.return()}},{highWaterMark:2})},Vg=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$z=Vg&&typeof ReadableStream=="function",kH=Vg&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Vz=(n,...e)=>{try{return!!n(...e)}catch{return!1}},OH=$z&&Vz(()=>{let n=!1;const e=new Request(Fs.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),N_=64*1024,Nm=$z&&Vz(()=>bt.isReadableStream(new Response("").body)),Jp={stream:Nm&&(n=>n.body)};Vg&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Jp[e]&&(Jp[e]=bt.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new Rr(`Response type '${e}' is not supported`,Rr.ERR_NOT_SUPPORT,r)})})})(new Response);const DH=async n=>{if(n==null)return 0;if(bt.isBlob(n))return n.size;if(bt.isSpecCompliantForm(n))return(await new Request(Fs.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(bt.isArrayBufferView(n)||bt.isArrayBuffer(n))return n.byteLength;if(bt.isURLSearchParams(n)&&(n=n+""),bt.isString(n))return(await kH(n)).byteLength},NH=async(n,e)=>{const t=bt.toFiniteNumber(n.getContentLength());return t??DH(e)},MH=Vg&&(async n=>{let{url:e,method:t,data:r,signal:o,cancelToken:s,timeout:i,onDownloadProgress:a,onUploadProgress:A,responseType:d,headers:c,withCredentials:u="same-origin",fetchOptions:h}=Kz(n);d=d?(d+"").toLowerCase():"text";let p=QH([o,s&&s.toAbortSignal()],i),v;const w=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let y;try{if(A&&OH&&t!=="get"&&t!=="head"&&(y=await NH(c,r))!==0){let H=new Request(e,{method:"POST",body:r,duplex:"half"}),Z;if(bt.isFormData(r)&&(Z=H.headers.get("content-type"))&&c.setContentType(Z),H.body){const[q,N]=P_(y,Yp(k_(A)));r=D_(H.body,N_,q,N)}}bt.isString(u)||(u=u?"include":"omit");const B="credentials"in Request.prototype;v=new Request(e,{...h,signal:p,method:t.toUpperCase(),headers:c.normalize().toJSON(),body:r,duplex:"half",credentials:B?u:void 0});let C=await fetch(v);const Q=Nm&&(d==="stream"||d==="response");if(Nm&&(a||Q&&w)){const H={};["status","statusText","headers"].forEach(re=>{H[re]=C[re]});const Z=bt.toFiniteNumber(C.headers.get("content-length")),[q,N]=a&&P_(Z,Yp(k_(a),!0))||[];C=new Response(D_(C.body,N_,q,()=>{N&&N(),w&&w()}),H)}d=d||"text";let k=await Jp[bt.findKey(Jp,d)||"text"](C,n);return!Q&&w&&w(),await new Promise((H,Z)=>{Rz(H,Z,{data:k,headers:ri.from(C.headers),status:C.status,statusText:C.statusText,config:n,request:v})})}catch(B){throw w&&w(),B&&B.name==="TypeError"&&/Load failed|fetch/i.test(B.message)?Object.assign(new Rr("Network Error",Rr.ERR_NETWORK,n,v),{cause:B.cause||B}):Rr.from(B,B&&B.code,n,v)}}),Mm={http:tH,xhr:UH,fetch:MH};bt.forEach(Mm,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const M_=n=>`- ${n}`,HH=n=>bt.isFunction(n)||n===null||n===!1,Gz={getAdapter:n=>{n=bt.isArray(n)?n:[n];const{length:e}=n;let t,r;const o={};for(let s=0;s<e;s++){t=n[s];let i;if(r=t,!HH(t)&&(r=Mm[(i=String(t)).toLowerCase()],r===void 0))throw new Rr(`Unknown adapter '${i}'`);if(r)break;o[i||"#"+s]=r}if(!r){const s=Object.entries(o).map(([a,A])=>`adapter ${a} `+(A===!1?"is not supported by the environment":"is not available in the build"));let i=e?s.length>1?`since :
`+s.map(M_).join(`
`):" "+M_(s[0]):"as no adapter specified";throw new Rr("There is no suitable adapter to dispatch the request "+i,"ERR_NOT_SUPPORT")}return r},adapters:Mm};function u0(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new qc(null,n)}function H_(n){return u0(n),n.headers=ri.from(n.headers),n.data=c0.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Gz.getAdapter(n.adapter||yh.adapter)(n).then(function(r){return u0(n),r.data=c0.call(n,n.transformResponse,r),r.headers=ri.from(r.headers),r},function(r){return jz(r)||(u0(n),r&&r.response&&(r.response.data=c0.call(n,n.transformResponse,r.response),r.response.headers=ri.from(r.response.headers))),Promise.reject(r)})}const Wz="1.9.0",Gg={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Gg[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const j_={};Gg.transitional=function(e,t,r){function o(s,i){return"[Axios v"+Wz+"] Transitional option '"+s+"'"+i+(r?". "+r:"")}return(s,i,a)=>{if(e===!1)throw new Rr(o(i," has been removed"+(t?" in "+t:"")),Rr.ERR_DEPRECATED);return t&&!j_[i]&&(j_[i]=!0,console.warn(o(i," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,i,a):!0}};Gg.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function jH(n,e,t){if(typeof n!="object")throw new Rr("options must be an object",Rr.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let o=r.length;for(;o-- >0;){const s=r[o],i=e[s];if(i){const a=n[s],A=a===void 0||i(a,s,n);if(A!==!0)throw new Rr("option "+s+" must be "+A,Rr.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new Rr("Unknown option "+s,Rr.ERR_BAD_OPTION)}}const fp={assertOptions:jH,validators:Gg},Ca=fp.validators;let ed=class{constructor(e){this.defaults=e||{},this.interceptors={request:new T_,response:new T_}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let o={};Error.captureStackTrace?Error.captureStackTrace(o):o=new Error;const s=o.stack?o.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=id(this.defaults,t);const{transitional:r,paramsSerializer:o,headers:s}=t;r!==void 0&&fp.assertOptions(r,{silentJSONParsing:Ca.transitional(Ca.boolean),forcedJSONParsing:Ca.transitional(Ca.boolean),clarifyTimeoutError:Ca.transitional(Ca.boolean)},!1),o!=null&&(bt.isFunction(o)?t.paramsSerializer={serialize:o}:fp.assertOptions(o,{encode:Ca.function,serialize:Ca.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),fp.assertOptions(t,{baseUrl:Ca.spelling("baseURL"),withXsrfToken:Ca.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let i=s&&bt.merge(s.common,s[t.method]);s&&bt.forEach(["delete","get","head","post","put","patch","common"],v=>{delete s[v]}),t.headers=ri.concat(i,s);const a=[];let A=!0;this.interceptors.request.forEach(function(w){typeof w.runWhen=="function"&&w.runWhen(t)===!1||(A=A&&w.synchronous,a.unshift(w.fulfilled,w.rejected))});const d=[];this.interceptors.response.forEach(function(w){d.push(w.fulfilled,w.rejected)});let c,u=0,h;if(!A){const v=[H_.bind(this),void 0];for(v.unshift.apply(v,a),v.push.apply(v,d),h=v.length,c=Promise.resolve(t);u<h;)c=c.then(v[u++],v[u++]);return c}h=a.length;let p=t;for(u=0;u<h;){const v=a[u++],w=a[u++];try{p=v(p)}catch(y){w.call(this,y);break}}try{c=H_.call(this,p)}catch(v){return Promise.reject(v)}for(u=0,h=d.length;u<h;)c=c.then(d[u++],d[u++]);return c}getUri(e){e=id(this.defaults,e);const t=qz(e.baseURL,e.url,e.allowAbsoluteUrls);return Nz(t,e.params,e.paramsSerializer)}};bt.forEach(["delete","get","head","options"],function(e){ed.prototype[e]=function(t,r){return this.request(id(r||{},{method:e,url:t,data:(r||{}).data}))}});bt.forEach(["post","put","patch"],function(e){function t(r){return function(s,i,a){return this.request(id(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:i}))}}ed.prototype[e]=t(),ed.prototype[e+"Form"]=t(!0)});let RH=class Xz{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(o=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](o);r._listeners=null}),this.promise.then=o=>{let s;const i=new Promise(a=>{r.subscribe(a),s=a}).then(o);return i.cancel=function(){r.unsubscribe(s)},i},e(function(s,i,a){r.reason||(r.reason=new qc(s,i,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Xz(function(o){e=o}),cancel:e}}};function qH(n){return function(t){return n.apply(null,t)}}function KH(n){return bt.isObject(n)&&n.isAxiosError===!0}const Hm={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Hm).forEach(([n,e])=>{Hm[e]=n});function Yz(n){const e=new ed(n),t=Sz(ed.prototype.request,e);return bt.extend(t,ed.prototype,e,{allOwnKeys:!0}),bt.extend(t,e,null,{allOwnKeys:!0}),t.create=function(o){return Yz(id(n,o))},t}const ho=Yz(yh);ho.Axios=ed;ho.CanceledError=qc;ho.CancelToken=RH;ho.isCancel=jz;ho.VERSION=Wz;ho.toFormData=$g;ho.AxiosError=Rr;ho.Cancel=ho.CanceledError;ho.all=function(e){return Promise.all(e)};ho.spread=qH;ho.isAxiosError=KH;ho.mergeConfig=id;ho.AxiosHeaders=ri;ho.formToJSON=n=>Hz(bt.isHTMLForm(n)?new FormData(n):n);ho.getAdapter=Gz.getAdapter;ho.HttpStatusCode=Hm;ho.default=ho;const{Axios:Z$,AxiosError:eV,CanceledError:tV,isCancel:rV,CancelToken:nV,VERSION:oV,all:sV,Cancel:iV,isAxiosError:aV,spread:AV,toFormData:lV,AxiosHeaders:dV,HttpStatusCode:cV,formToJSON:uV,getAdapter:hV,mergeConfig:fV}=ho,Jz=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",$H=Jz+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040",VH="["+Jz+"]["+$H+"]*",GH=new RegExp("^"+VH+"$");function Zz(n,e){const t=[];let r=e.exec(n);for(;r;){const o=[];o.startIndex=e.lastIndex-r[0].length;const s=r.length;for(let i=0;i<s;i++)o.push(r[i]);t.push(o),r=e.exec(n)}return t}const i2=function(n){const e=GH.exec(n);return!(e===null||typeof e>"u")};function WH(n){return typeof n<"u"}const XH={allowBooleanAttributes:!1,unpairedTags:[]};function YH(n,e){e=Object.assign({},XH,e);const t=[];let r=!1,o=!1;n[0]==="\uFEFF"&&(n=n.substr(1));for(let s=0;s<n.length;s++)if(n[s]==="<"&&n[s+1]==="?"){if(s+=2,s=q_(n,s),s.err)return s}else if(n[s]==="<"){let i=s;if(s++,n[s]==="!"){s=K_(n,s);continue}else{let a=!1;n[s]==="/"&&(a=!0,s++);let A="";for(;s<n.length&&n[s]!==">"&&n[s]!==" "&&n[s]!=="	"&&n[s]!==`
`&&n[s]!=="\r";s++)A+=n[s];if(A=A.trim(),A[A.length-1]==="/"&&(A=A.substring(0,A.length-1),s--),!sj(A)){let u;return A.trim().length===0?u="Invalid space after '<'.":u="Tag '"+A+"' is an invalid name.",zo("InvalidTag",u,Ps(n,s))}const d=ej(n,s);if(d===!1)return zo("InvalidAttr","Attributes for '"+A+"' have open quote.",Ps(n,s));let c=d.value;if(s=d.index,c[c.length-1]==="/"){const u=s-c.length;c=c.substring(0,c.length-1);const h=$_(c,e);if(h===!0)r=!0;else return zo(h.err.code,h.err.msg,Ps(n,u+h.err.line))}else if(a)if(d.tagClosed){if(c.trim().length>0)return zo("InvalidTag","Closing tag '"+A+"' can't have attributes or invalid starting.",Ps(n,i));if(t.length===0)return zo("InvalidTag","Closing tag '"+A+"' has not been opened.",Ps(n,i));{const u=t.pop();if(A!==u.tagName){let h=Ps(n,u.tagStartPos);return zo("InvalidTag","Expected closing tag '"+u.tagName+"' (opened in line "+h.line+", col "+h.col+") instead of closing tag '"+A+"'.",Ps(n,i))}t.length==0&&(o=!0)}}else return zo("InvalidTag","Closing tag '"+A+"' doesn't have proper closing.",Ps(n,s));else{const u=$_(c,e);if(u!==!0)return zo(u.err.code,u.err.msg,Ps(n,s-c.length+u.err.line));if(o===!0)return zo("InvalidXml","Multiple possible root nodes found.",Ps(n,s));e.unpairedTags.indexOf(A)!==-1||t.push({tagName:A,tagStartPos:i}),r=!0}for(s++;s<n.length;s++)if(n[s]==="<")if(n[s+1]==="!"){s++,s=K_(n,s);continue}else if(n[s+1]==="?"){if(s=q_(n,++s),s.err)return s}else break;else if(n[s]==="&"){const u=nj(n,s);if(u==-1)return zo("InvalidChar","char '&' is not expected.",Ps(n,s));s=u}else if(o===!0&&!R_(n[s]))return zo("InvalidXml","Extra text at the end",Ps(n,s));n[s]==="<"&&s--}}else{if(R_(n[s]))continue;return zo("InvalidChar","char '"+n[s]+"' is not expected.",Ps(n,s))}if(r){if(t.length==1)return zo("InvalidTag","Unclosed tag '"+t[0].tagName+"'.",Ps(n,t[0].tagStartPos));if(t.length>0)return zo("InvalidXml","Invalid '"+JSON.stringify(t.map(s=>s.tagName),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}else return zo("InvalidXml","Start tag expected.",1);return!0}function R_(n){return n===" "||n==="	"||n===`
`||n==="\r"}function q_(n,e){const t=e;for(;e<n.length;e++)if(n[e]=="?"||n[e]==" "){const r=n.substr(t,e-t);if(e>5&&r==="xml")return zo("InvalidXml","XML declaration allowed only at the start of the document.",Ps(n,e));if(n[e]=="?"&&n[e+1]==">"){e++;break}else continue}return e}function K_(n,e){if(n.length>e+5&&n[e+1]==="-"&&n[e+2]==="-"){for(e+=3;e<n.length;e++)if(n[e]==="-"&&n[e+1]==="-"&&n[e+2]===">"){e+=2;break}}else if(n.length>e+8&&n[e+1]==="D"&&n[e+2]==="O"&&n[e+3]==="C"&&n[e+4]==="T"&&n[e+5]==="Y"&&n[e+6]==="P"&&n[e+7]==="E"){let t=1;for(e+=8;e<n.length;e++)if(n[e]==="<")t++;else if(n[e]===">"&&(t--,t===0))break}else if(n.length>e+9&&n[e+1]==="["&&n[e+2]==="C"&&n[e+3]==="D"&&n[e+4]==="A"&&n[e+5]==="T"&&n[e+6]==="A"&&n[e+7]==="["){for(e+=8;e<n.length;e++)if(n[e]==="]"&&n[e+1]==="]"&&n[e+2]===">"){e+=2;break}}return e}const JH='"',ZH="'";function ej(n,e){let t="",r="",o=!1;for(;e<n.length;e++){if(n[e]===JH||n[e]===ZH)r===""?r=n[e]:r!==n[e]||(r="");else if(n[e]===">"&&r===""){o=!0;break}t+=n[e]}return r!==""?!1:{value:t,index:e,tagClosed:o}}const tj=new RegExp(`(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['"])(([\\s\\S])*?)\\5)?`,"g");function $_(n,e){const t=Zz(n,tj),r={};for(let o=0;o<t.length;o++){if(t[o][1].length===0)return zo("InvalidAttr","Attribute '"+t[o][2]+"' has no space in starting.",fu(t[o]));if(t[o][3]!==void 0&&t[o][4]===void 0)return zo("InvalidAttr","Attribute '"+t[o][2]+"' is without value.",fu(t[o]));if(t[o][3]===void 0&&!e.allowBooleanAttributes)return zo("InvalidAttr","boolean attribute '"+t[o][2]+"' is not allowed.",fu(t[o]));const s=t[o][2];if(!oj(s))return zo("InvalidAttr","Attribute '"+s+"' is an invalid name.",fu(t[o]));if(!r.hasOwnProperty(s))r[s]=1;else return zo("InvalidAttr","Attribute '"+s+"' is repeated.",fu(t[o]))}return!0}function rj(n,e){let t=/\d/;for(n[e]==="x"&&(e++,t=/[\da-fA-F]/);e<n.length;e++){if(n[e]===";")return e;if(!n[e].match(t))break}return-1}function nj(n,e){if(e++,n[e]===";")return-1;if(n[e]==="#")return e++,rj(n,e);let t=0;for(;e<n.length;e++,t++)if(!(n[e].match(/\w/)&&t<20)){if(n[e]===";")break;return-1}return e}function zo(n,e,t){return{err:{code:n,msg:e,line:t.line||t,col:t.col}}}function oj(n){return i2(n)}function sj(n){return i2(n)}function Ps(n,e){const t=n.substring(0,e).split(/\r?\n/);return{line:t.length,col:t[t.length-1].length+1}}function fu(n){return n.startIndex+n[1].length}const ij={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(n,e){return e},attributeValueProcessor:function(n,e){return e},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(n,e,t){return n},captureMetaData:!1},aj=function(n){return Object.assign({},ij,n)};let Zp;typeof Symbol!="function"?Zp="@@xmlMetadata":Zp=Symbol("XML Node Metadata");class Nl{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e,t){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child}),t!==void 0&&(this.child[this.child.length-1][Zp]={startIndex:t})}static getMetaDataSymbol(){return Zp}}function Aj(n,e){const t={};if(n[e+3]==="O"&&n[e+4]==="C"&&n[e+5]==="T"&&n[e+6]==="Y"&&n[e+7]==="P"&&n[e+8]==="E"){e=e+9;let r=1,o=!1,s=!1,i="";for(;e<n.length;e++)if(n[e]==="<"&&!s){if(o&&Ml(n,"!ENTITY",e)){e+=7;let a,A;[a,A,e]=lj(n,e+1),A.indexOf("&")===-1&&(t[a]={regx:RegExp(`&${a};`,"g"),val:A})}else if(o&&Ml(n,"!ELEMENT",e)){e+=8;const{index:a}=cj(n,e+1);e=a}else if(o&&Ml(n,"!ATTLIST",e))e+=8;else if(o&&Ml(n,"!NOTATION",e)){e+=9;const{index:a}=dj(n,e+1);e=a}else if(Ml(n,"!--",e))s=!0;else throw new Error("Invalid DOCTYPE");r++,i=""}else if(n[e]===">"){if(s?n[e-1]==="-"&&n[e-2]==="-"&&(s=!1,r--):r--,r===0)break}else n[e]==="["?o=!0:i+=n[e];if(r!==0)throw new Error("Unclosed DOCTYPE")}else throw new Error("Invalid Tag instead of DOCTYPE");return{entities:t,i:e}}const Al=(n,e)=>{for(;e<n.length&&/\s/.test(n[e]);)e++;return e};function lj(n,e){e=Al(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e])&&n[e]!=='"'&&n[e]!=="'";)t+=n[e],e++;if(a2(t),e=Al(n,e),n.substring(e,e+6).toUpperCase()==="SYSTEM")throw new Error("External entities are not supported");if(n[e]==="%")throw new Error("Parameter entities are not supported");let r="";return[e,r]=pp(n,e,"entity"),e--,[t,r,e]}function dj(n,e){e=Al(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e]);)t+=n[e],e++;a2(t),e=Al(n,e);const r=n.substring(e,e+6).toUpperCase();if(r!=="SYSTEM"&&r!=="PUBLIC")throw new Error(`Expected SYSTEM or PUBLIC, found "${r}"`);e+=r.length,e=Al(n,e);let o=null,s=null;if(r==="PUBLIC")[e,o]=pp(n,e,"publicIdentifier"),e=Al(n,e),(n[e]==='"'||n[e]==="'")&&([e,s]=pp(n,e,"systemIdentifier"));else if(r==="SYSTEM"&&([e,s]=pp(n,e,"systemIdentifier"),!s))throw new Error("Missing mandatory system identifier for SYSTEM notation");return{notationName:t,publicIdentifier:o,systemIdentifier:s,index:--e}}function pp(n,e,t){let r="";const o=n[e];if(o!=='"'&&o!=="'")throw new Error(`Expected quoted string, found "${o}"`);for(e++;e<n.length&&n[e]!==o;)r+=n[e],e++;if(n[e]!==o)throw new Error(`Unterminated ${t} value`);return e++,[e,r]}function cj(n,e){e=Al(n,e);let t="";for(;e<n.length&&!/\s/.test(n[e]);)t+=n[e],e++;if(!a2(t))throw new Error(`Invalid element name: "${t}"`);e=Al(n,e);let r="";if(n[e]==="E"&&Ml(n,"MPTY",e))e+=6;else if(n[e]==="A"&&Ml(n,"NY",e))e+=4;else if(n[e]==="("){for(e++;e<n.length&&n[e]!==")";)r+=n[e],e++;if(n[e]!==")")throw new Error("Unterminated content model")}else throw new Error(`Invalid Element Expression, found "${n[e]}"`);return{elementName:t,contentModel:r.trim(),index:e}}function Ml(n,e,t){for(let r=0;r<e.length;r++)if(e[r]!==n[t+r+1])return!1;return!0}function a2(n){if(i2(n))return n;throw new Error(`Invalid entity name ${n}`)}const uj=/^[-+]?0x[a-fA-F0-9]+$/,hj=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/,fj={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};function pj(n,e={}){if(e=Object.assign({},fj,e),!n||typeof n!="string")return n;let t=n.trim();if(e.skipLike!==void 0&&e.skipLike.test(t))return n;if(n==="0")return 0;if(e.hex&&uj.test(t))return wj(t,16);if(t.search(/.+[eE].+/)!==-1)return vj(n,t,e);{const r=hj.exec(t);if(r){const o=r[1]||"",s=r[2];let i=mj(r[3]);const a=o?n[s.length+1]===".":n[s.length]===".";if(!e.leadingZeros&&(s.length>1||s.length===1&&!a))return n;{const A=Number(t),d=String(A);if(A===0||A===-0)return A;if(d.search(/[eE]/)!==-1)return e.eNotation?A:n;if(t.indexOf(".")!==-1)return d==="0"||d===i||d===`${o}${i}`?A:n;let c=s?i:t;return s?c===d||o+c===d?A:n:c===d||c===o+d?A:n}}else return n}}const gj=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function vj(n,e,t){if(!t.eNotation)return n;const r=e.match(gj);if(r){let o=r[1]||"";const s=r[3].indexOf("e")===-1?"E":"e",i=r[2],a=o?n[i.length+1]===s:n[i.length]===s;return i.length>1&&a?n:i.length===1&&(r[3].startsWith(`.${s}`)||r[3][0]===s)?Number(e):t.leadingZeros&&!a?(e=(r[1]||"")+r[3],Number(e)):n}else return n}function mj(n){return n&&n.indexOf(".")!==-1&&(n=n.replace(/0+$/,""),n==="."?n="0":n[0]==="."?n="0"+n:n[n.length-1]==="."&&(n=n.substring(0,n.length-1))),n}function wj(n,e){if(parseInt)return parseInt(n,e);if(Number.parseInt)return Number.parseInt(n,e);if(window&&window.parseInt)return window.parseInt(n,e);throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}function yj(n){return typeof n=="function"?n:Array.isArray(n)?e=>{for(const t of n)if(typeof t=="string"&&e===t||t instanceof RegExp&&t.test(e))return!0}:()=>!1}class _j{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(t,r)=>String.fromCodePoint(Number.parseInt(r,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(t,r)=>String.fromCodePoint(Number.parseInt(r,16))}},this.addExternalEntities=bj,this.parseXml=Sj,this.parseTextData=xj,this.resolveNameSpace=Bj,this.buildAttributesMap=Cj,this.isItStopNode=Uj,this.replaceEntitiesValue=Fj,this.readStopNodeData=Tj,this.saveTextToParentTag=Ij,this.addChild=Ej,this.ignoreAttributesFn=yj(this.options.ignoreAttributes)}}function bj(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:n[r]}}}function xj(n,e,t,r,o,s,i){if(n!==void 0&&(this.options.trimValues&&!r&&(n=n.trim()),n.length>0)){i||(n=this.replaceEntitiesValue(n));const a=this.options.tagValueProcessor(e,n,t,o,s);return a==null?n:typeof a!=typeof n||a!==n?a:this.options.trimValues?Rm(n,this.options.parseTagValue,this.options.numberParseOptions):n.trim()===n?Rm(n,this.options.parseTagValue,this.options.numberParseOptions):n}}function Bj(n){if(this.options.removeNSPrefix){const e=n.split(":"),t=n.charAt(0)==="/"?"/":"";if(e[0]==="xmlns")return"";e.length===2&&(n=t+e[1])}return n}const zj=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");function Cj(n,e,t){if(this.options.ignoreAttributes!==!0&&typeof n=="string"){const r=Zz(n,zj),o=r.length,s={};for(let i=0;i<o;i++){const a=this.resolveNameSpace(r[i][1]);if(this.ignoreAttributesFn(a,e))continue;let A=r[i][4],d=this.options.attributeNamePrefix+a;if(a.length)if(this.options.transformAttributeName&&(d=this.options.transformAttributeName(d)),d==="__proto__"&&(d="#__proto__"),A!==void 0){this.options.trimValues&&(A=A.trim()),A=this.replaceEntitiesValue(A);const c=this.options.attributeValueProcessor(a,A,e);c==null?s[d]=A:typeof c!=typeof A||c!==A?s[d]=c:s[d]=Rm(A,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(s[d]=!0)}if(!Object.keys(s).length)return;if(this.options.attributesGroupName){const i={};return i[this.options.attributesGroupName]=s,i}return s}}const Sj=function(n){n=n.replace(/\r\n?/g,`
`);const e=new Nl("!xml");let t=e,r="",o="";for(let s=0;s<n.length;s++)if(n[s]==="<")if(n[s+1]==="/"){const a=Vl(n,">",s,"Closing Tag is not closed.");let A=n.substring(s+2,a).trim();if(this.options.removeNSPrefix){const u=A.indexOf(":");u!==-1&&(A=A.substr(u+1))}this.options.transformTagName&&(A=this.options.transformTagName(A)),t&&(r=this.saveTextToParentTag(r,t,o));const d=o.substring(o.lastIndexOf(".")+1);if(A&&this.options.unpairedTags.indexOf(A)!==-1)throw new Error(`Unpaired tag can not be used as closing tag: </${A}>`);let c=0;d&&this.options.unpairedTags.indexOf(d)!==-1?(c=o.lastIndexOf(".",o.lastIndexOf(".")-1),this.tagsNodeStack.pop()):c=o.lastIndexOf("."),o=o.substring(0,c),t=this.tagsNodeStack.pop(),r="",s=a}else if(n[s+1]==="?"){let a=jm(n,s,!1,"?>");if(!a)throw new Error("Pi Tag is not closed.");if(r=this.saveTextToParentTag(r,t,o),!(this.options.ignoreDeclaration&&a.tagName==="?xml"||this.options.ignorePiTags)){const A=new Nl(a.tagName);A.add(this.options.textNodeName,""),a.tagName!==a.tagExp&&a.attrExpPresent&&(A[":@"]=this.buildAttributesMap(a.tagExp,o,a.tagName)),this.addChild(t,A,o,s)}s=a.closeIndex+1}else if(n.substr(s+1,3)==="!--"){const a=Vl(n,"-->",s+4,"Comment is not closed.");if(this.options.commentPropName){const A=n.substring(s+4,a-2);r=this.saveTextToParentTag(r,t,o),t.add(this.options.commentPropName,[{[this.options.textNodeName]:A}])}s=a}else if(n.substr(s+1,2)==="!D"){const a=Aj(n,s);this.docTypeEntities=a.entities,s=a.i}else if(n.substr(s+1,2)==="!["){const a=Vl(n,"]]>",s,"CDATA is not closed.")-2,A=n.substring(s+9,a);r=this.saveTextToParentTag(r,t,o);let d=this.parseTextData(A,t.tagname,o,!0,!1,!0,!0);d==null&&(d=""),this.options.cdataPropName?t.add(this.options.cdataPropName,[{[this.options.textNodeName]:A}]):t.add(this.options.textNodeName,d),s=a+2}else{let a=jm(n,s,this.options.removeNSPrefix),A=a.tagName;const d=a.rawTagName;let c=a.tagExp,u=a.attrExpPresent,h=a.closeIndex;this.options.transformTagName&&(A=this.options.transformTagName(A)),t&&r&&t.tagname!=="!xml"&&(r=this.saveTextToParentTag(r,t,o,!1));const p=t;p&&this.options.unpairedTags.indexOf(p.tagname)!==-1&&(t=this.tagsNodeStack.pop(),o=o.substring(0,o.lastIndexOf("."))),A!==e.tagname&&(o+=o?"."+A:A);const v=s;if(this.isItStopNode(this.options.stopNodes,o,A)){let w="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)A[A.length-1]==="/"?(A=A.substr(0,A.length-1),o=o.substr(0,o.length-1),c=A):c=c.substr(0,c.length-1),s=a.closeIndex;else if(this.options.unpairedTags.indexOf(A)!==-1)s=a.closeIndex;else{const B=this.readStopNodeData(n,d,h+1);if(!B)throw new Error(`Unexpected end of ${d}`);s=B.i,w=B.tagContent}const y=new Nl(A);A!==c&&u&&(y[":@"]=this.buildAttributesMap(c,o,A)),w&&(w=this.parseTextData(w,A,o,!0,u,!0,!0)),o=o.substr(0,o.lastIndexOf(".")),y.add(this.options.textNodeName,w),this.addChild(t,y,o,v)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){A[A.length-1]==="/"?(A=A.substr(0,A.length-1),o=o.substr(0,o.length-1),c=A):c=c.substr(0,c.length-1),this.options.transformTagName&&(A=this.options.transformTagName(A));const w=new Nl(A);A!==c&&u&&(w[":@"]=this.buildAttributesMap(c,o,A)),this.addChild(t,w,o,v),o=o.substr(0,o.lastIndexOf("."))}else{const w=new Nl(A);this.tagsNodeStack.push(t),A!==c&&u&&(w[":@"]=this.buildAttributesMap(c,o,A)),this.addChild(t,w,o,v),t=w}r="",s=h}}else r+=n[s];return e.child};function Ej(n,e,t,r){this.options.captureMetaData||(r=void 0);const o=this.options.updateTag(e.tagname,t,e[":@"]);o===!1||(typeof o=="string"&&(e.tagname=o),n.addChild(e,r))}const Fj=function(n){if(this.options.processEntities){for(let e in this.docTypeEntities){const t=this.docTypeEntities[e];n=n.replace(t.regx,t.val)}for(let e in this.lastEntities){const t=this.lastEntities[e];n=n.replace(t.regex,t.val)}if(this.options.htmlEntities)for(let e in this.htmlEntities){const t=this.htmlEntities[e];n=n.replace(t.regex,t.val)}n=n.replace(this.ampEntity.regex,this.ampEntity.val)}return n};function Ij(n,e,t,r){return n&&(r===void 0&&(r=e.child.length===0),n=this.parseTextData(n,e.tagname,t,!1,e[":@"]?Object.keys(e[":@"]).length!==0:!1,r),n!==void 0&&n!==""&&e.add(this.options.textNodeName,n),n=""),n}function Uj(n,e,t){const r="*."+t;for(const o in n){const s=n[o];if(r===s||e===s)return!0}return!1}function Qj(n,e,t=">"){let r,o="";for(let s=e;s<n.length;s++){let i=n[s];if(r)i===r&&(r="");else if(i==='"'||i==="'")r=i;else if(i===t[0])if(t[1]){if(n[s+1]===t[1])return{data:o,index:s}}else return{data:o,index:s};else i==="	"&&(i=" ");o+=i}}function Vl(n,e,t,r){const o=n.indexOf(e,t);if(o===-1)throw new Error(r);return o+e.length-1}function jm(n,e,t,r=">"){const o=Qj(n,e+1,r);if(!o)return;let s=o.data;const i=o.index,a=s.search(/\s/);let A=s,d=!0;a!==-1&&(A=s.substring(0,a),s=s.substring(a+1).trimStart());const c=A;if(t){const u=A.indexOf(":");u!==-1&&(A=A.substr(u+1),d=A!==o.data.substr(u+1))}return{tagName:A,tagExp:s,closeIndex:i,attrExpPresent:d,rawTagName:c}}function Tj(n,e,t){const r=t;let o=1;for(;t<n.length;t++)if(n[t]==="<")if(n[t+1]==="/"){const s=Vl(n,">",t,`${e} is not closed`);if(n.substring(t+2,s).trim()===e&&(o--,o===0))return{tagContent:n.substring(r,t),i:s};t=s}else if(n[t+1]==="?")t=Vl(n,"?>",t+1,"StopNode is not closed.");else if(n.substr(t+1,3)==="!--")t=Vl(n,"-->",t+3,"StopNode is not closed.");else if(n.substr(t+1,2)==="![")t=Vl(n,"]]>",t,"StopNode is not closed.")-2;else{const s=jm(n,t,">");s&&((s&&s.tagName)===e&&s.tagExp[s.tagExp.length-1]!=="/"&&o++,t=s.closeIndex)}}function Rm(n,e,t){if(e&&typeof n=="string"){const r=n.trim();return r==="true"?!0:r==="false"?!1:pj(n,t)}else return WH(n)?n:""}const h0=Nl.getMetaDataSymbol();function Lj(n,e){return eC(n,e)}function eC(n,e,t){let r;const o={};for(let s=0;s<n.length;s++){const i=n[s],a=Pj(i);let A="";if(t===void 0?A=a:A=t+"."+a,a===e.textNodeName)r===void 0?r=i[a]:r+=""+i[a];else{if(a===void 0)continue;if(i[a]){let d=eC(i[a],e,A);const c=Oj(d,e);i[h0]!==void 0&&(d[h0]=i[h0]),i[":@"]?kj(d,i[":@"],A,e):Object.keys(d).length===1&&d[e.textNodeName]!==void 0&&!e.alwaysCreateTextNode?d=d[e.textNodeName]:Object.keys(d).length===0&&(e.alwaysCreateTextNode?d[e.textNodeName]="":d=""),o[a]!==void 0&&o.hasOwnProperty(a)?(Array.isArray(o[a])||(o[a]=[o[a]]),o[a].push(d)):e.isArray(a,A,c)?o[a]=[d]:o[a]=d}}}return typeof r=="string"?r.length>0&&(o[e.textNodeName]=r):r!==void 0&&(o[e.textNodeName]=r),o}function Pj(n){const e=Object.keys(n);for(let t=0;t<e.length;t++){const r=e[t];if(r!==":@")return r}}function kj(n,e,t,r){if(e){const o=Object.keys(e),s=o.length;for(let i=0;i<s;i++){const a=o[i];r.isArray(a,t+"."+a,!0,!0)?n[a]=[e[a]]:n[a]=e[a]}}}function Oj(n,e){const{textNodeName:t}=e,r=Object.keys(n).length;return!!(r===0||r===1&&(n[t]||typeof n[t]=="boolean"||n[t]===0))}class Dj{constructor(e){this.externalEntities={},this.options=aj(e)}parse(e,t){if(typeof e!="string")if(e.toString)e=e.toString();else throw new Error("XML data is accepted in String or Bytes[] form.");if(t){t===!0&&(t={});const s=YH(e,t);if(s!==!0)throw Error(`${s.err.msg}:${s.err.line}:${s.err.col}`)}const r=new _j(this.options);r.addExternalEntities(this.externalEntities);const o=r.parseXml(e);return this.options.preserveOrder||o===void 0?o:Lj(o,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1)throw new Error("Entity value can't have '&'");if(e.indexOf("&")!==-1||e.indexOf(";")!==-1)throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if(t==="&")throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}static getMetaDataSymbol(){return Nl.getMetaDataSymbol()}}class tC{constructor(){this.partner_key="JUZFJThGJUQ0JUQ0JUNCUVBD",this.key="JUI5JTgyR3QlMTMtUSVBRiUxMyVEQUslQzclN0ZHJTBCVzQlOUUyLSUxMiUwRmMlODQlNUMlRTglQTYlRjUlMTVMJThBVTclRTIlOTElM0E=",this.parser=new Dj({ignoreAttributes:!1,trimValues:!0})}async getProduct(e){var t,r;try{const o=await ho.get("https://openhub.godo.co.kr/godomall5/goods/Goods_Search.php",{params:{partner_key:this.partner_key,key:this.key,goodsNo:e}});if(typeof o.data!="string")throw new Error("XML    .");const i=this.parser.parse(o.data).data.return.goods_data,a=((t=i.optionName)==null?void 0:t.split("^|^").map(d=>d))||[];console.log({godoProduct:i});const A=a.map((d,c)=>{var v;const u=((v=i.optionData)==null?void 0:v.map(w=>w[`optionValue${c+1}`]).filter(w=>w))||[],h=[...new Set(u)],p=h.map(w=>{var y,B;if(c===0){const Q=(((B=(y=i.optionData)==null?void 0:y.find(H=>H[`optionValue${c+1}`]===w))==null?void 0:B.optionImage)||"").split("http").pop();return Q?"http"+Q:""}return""});return{title:d,values:h,images:p}});return{title:i.goodsNm,description:i.goodsDescription,handle:i.goodsNo,thumbnail:i.listImageData?i.listImageData["#text"]:"",goodsNo:i.goodsNo,goodsNm:i.goodsNm,goodsDescription:i.goodsDescription.replace(/\\r\\n/g,`
`).replace(/\\n/g,`
`).replace(/\\"/g,'"').replace(/\\/g,"")||"",status:"draft",productOptionValues:A,variants:((r=i.optionData)==null?void 0:r.map(d=>{const c=Array.from({length:5},(v,w)=>d[`optionValue${w+1}`]).filter(v=>v!==void 0&&v!==""),h=(d.optionImage||"").split("http").pop(),p=h?"http"+h:"";return{title:c.join(" / "),sku:d.optionCode||`${i.goodsNo}-${c.join("-")}`,thumbnail:p,barcode:"",inventory_quantity:parseInt(d.stockCnt||"0"),price:parseInt(i.goodsPrice+d.optionPrice||"0")}}))||[],mallType:"godo5",mallProductId:e,textOptionData:i.textOptionData}}catch(o){throw console.error("Godo5 API Error:",o),new Error("5    .")}}async getAddProduct(e){try{const t=await ho.get("https://openhub.godo.co.kr/godomall5/goods/Goods_Add_Search.php",{params:{partner_key:this.partner_key,key:this.key,addGoodsNo:e}});if(typeof t.data!="string")throw new Error("XML    .");console.log({response:t});const r=this.parser.parse(t.data);console.log({result:r});const o=r.data.return.goods_data;return console.log({addGoodsData:o}),{addGoodsNo:o.addGoodsNo,goodsNm:o.goodsNm,goodsPrice:parseInt(o.goodsPrice||"0"),stockCnt:parseInt(o.stockCnt||"0"),listImageData:o.listImageData,soldOutFl:o.soldOutFl==="y"}}catch(t){throw console.error("Godo5 API Error:",t),new Error("5    .")}}parseOptionInfo(e){try{return JSON.parse(e).map(r=>({name:r[0]||"",value:r[1]||"",code:r[2]||"",stock:r[3]||"",price:parseInt(r[3]||"0")})).filter(r=>r.name&&r.value)}catch(t){return console.error("   :",t),[]}}getOptionCode(e){try{return JSON.parse(e)[0][2]||""}catch(t){return console.error("   :",t),""}}async getOrder(e){try{const t=await ho.get("https://openhub.godo.co.kr/godomall5/order/Order_Search.php",{params:{partner_key:this.partner_key,key:this.key,orderNo:e}});if(typeof t.data!="string")throw new Error("XML    .");const o=this.parser.parse(t.data).data.return.order_data;return console.log({orderData:o}),{orderNo:o.orderNo,orderDate:o.orderDate,orderStatus:o.orderStatus,orderName:o.orderInfoData.orderName,orderEmail:o.orderInfoData.orderEmail,orderPhone:o.orderInfoData.orderPhone,receiverName:o.orderInfoData.receiverName,receiverPhone:o.orderInfoData.receiverPhone,receiverAddress:`${o.orderInfoData.receiverZonecode} ${o.orderInfoData.receiverAddress} ${o.orderInfoData.receiverAddressSub}`,totalPrice:parseInt(o.settlePrice),orderGoodsData:Array.isArray(o.orderGoodsData)?o.orderGoodsData.map(s=>({goodsNo:s.goodsNo||"",goodsNm:s.goodsNm||"",goodsType:"orderGoods",goodsCnt:s.goodsCnt||0,goodsPrice:s.goodsPrice||0,listImageData:s.listImageData||"",exist:!1,options:this.parseOptionInfo(s.optionInfo||"[]"),orderCd:s.orderCd||"",optionCode:this.getOptionCode(s.optionInfo||"")})):[],addGoodsData:Array.isArray(o.addGoodsData)?o.addGoodsData.map(s=>({goodsNm:s.goodsNm,addGoodsNo:s.addGoodsNo,goodsType:"addGoods",goodsCnt:parseInt(String(s.goodsCnt)),goodsPrice:parseInt(String(s.goodsPrice)),listImageData:s.listImageData,exist:!1,options:this.parseOptionInfo(s.optionInfo||"[]"),orderCd:s.orderCd||"",optionCode:this.getOptionCode(s.optionInfo||"")})):[]}}catch(t){throw console.error("Godo5 API Error:",t),new Error("5    .")}}}new tC;async function Nj(n,e){const t=[],r=n.filter(o=>o.product&&o.product.mall_type==="godo5"&&o.product.mall_product_id);if(r.length===0)return console.log("5  ."),t;console.log(`${r.length} 5  .`);try{const o=document.createElement("form");o.method="POST",o.action="/order/cart_ps.php",o.style.display="none";const s=(i,a)=>{const A=document.createElement("input");A.type="hidden",A.name=i,A.value=a,o.appendChild(A)};s("mode","cartIn"),s("cartMode","d"),s("useBundleGoods","1"),s("scmNo","1");for(const i of r)try{const A=i.product.mall_product_id,d=i.idx;let c=1;i.isAdditionalCost?c=1:c=Array.isArray(i.items)?i.items.reduce((p,v)=>p+(v.quantity||0),0):1;let u="";e&&d!==void 0&&(i.isAdditionalCost?u=`${e}-add-${i.id}`:u=`${e}-${d}`);const h=await Hj(i.product.mall_product_id);console.log(`   (${i.isAdditionalCost?"":""}):`,h),s("goodsNo[]",A),s("goodsCnt[]",c.toString()),s("optionFl[]","n"),s("displayOptionkey[]",""),s("goodsPriceSum[]","0"),s("addGoodsPriceSum[]","0"),u&&h.textOptionData.optionName==="odiz"&&s(`optionText[${d}][${h.textOptionData.sno}]`,u),t.push(A)}catch(a){console.error("    :",a)}return document.body.appendChild(o),console.log(o),o.submit(),console.log(`${r.length} 5     `),t}catch(o){return console.error("    :",o),t}}async function Mj(n){var t,r,o,s;const e={success:!1,submittedOrders:[]};try{const i=((t=n[0])==null?void 0:t.estimate_id)||((s=(o=(r=n[0])==null?void 0:r.items)==null?void 0:o[0])==null?void 0:s.estimate_id),a=await Nj(n,i);a.length>0&&(e.submittedOrders.push({mallType:"godo5",productIds:a}),e.success=!0)}catch(i){console.error("    :",i)}return e}async function Hj(n){return await new tC().getProduct(n)}function jj(n,e,t,r){_(e,""),_(t,""),_(r,"")}var Rj=(n,e,t)=>{_(e,""),_(t,"")},qj=$('<button type="button" class="odz-absolute odz-right-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-text-gray-400 hover:odz-text-gray-600 odz-transition-colors"><!></button>'),Kj=$('<button type="button" class="odz-btn odz-btn-outline odz-btn-sm sm:odz-btn-md"></button>'),$j=$('<div class="odz-mt-3 odz-text-sm odz-text-gray-600"><span class="odz-font-medium odz-text-indigo-600"> </span>  .</div>'),Vj=$('<button class="odz-btn odz-btn-outline odz-ml-2"></button>'),Gj=(n,e)=>e("1week"),Wj=(n,e)=>e("1month"),Xj=(n,e)=>e("6months"),Yj=(n,e)=>e("1year"),Jj=$('<div class="odz-text-xs odz-text-gray-500 odz-mt-2"> </div>'),Zj=$('<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-6"><div class="odz-card-body odz-p-4"><fieldset class="odz-border odz-border-solid odz-border-base-300 odz-rounded-md odz-p-4"><legend class="odz-px-2 odz-font-medium odz-text-sm"> </legend> <div class="odz-form-control odz-w-full"><div class="odz-flex odz-flex-row odz-flex-wrap odz-gap-3 odz-items-end"><div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"></span></label> <input type="date" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"></span></label> <input type="date" class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-mt-6"><button class="odz-btn odz-btn-primary"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-5 odz-w-5 odz-mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> </button> <!></div></div> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mt-3"><button class="odz-btn odz-btn-xs odz-btn-outline">1</button> <button class="odz-btn odz-btn-xs odz-btn-outline"></button> <button class="odz-btn odz-btn-xs odz-btn-outline">6</button> <button class="odz-btn odz-btn-xs odz-btn-outline">1</button></div> <!></div></fieldset></div></div>'),eR=$('<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-6"><div class="odz-card-body odz-p-4"><fieldset class="odz-border odz-border-solid odz-border-base-300 odz-rounded-md odz-p-4"><legend class="odz-px-2 odz-font-medium odz-text-sm">  </legend> <div class="odz-form-control odz-w-full"><div class="odz-flex odz-flex-row odz-flex-wrap odz-gap-3 odz-items-end"><div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"> *</span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-flex-1 odz-min-w-200"><label class="odz-label odz-pb-1"><span class="odz-label-text"> *</span></label> <input type="text" placeholder=" " class="odz-input odz-input-bordered odz-w-full"></div> <div class="odz-mt-6"><button class="odz-btn odz-btn-primary"><svg xmlns="http://www.w3.org/2000/svg" class="odz-h-5 odz-w-5 odz-mr-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path></svg> </button></div></div> <div class="odz-text-xs odz-text-gray-500 odz-mt-2">* /      .</div></div></fieldset></div></div>'),tR=(n,e)=>e("current"),rR=(n,e)=>e("previous"),nR=$('<div class="odz-flex odz-gap-2 odz-mb-4 odz-border-b odz-border-gray-200"><button type="button"> </button> <button type="button">  (2026 )</button></div>'),oR=$('<div class="odz-flex odz-justify-center odz-my-8"><span class="odz-loading odz-loading-spinner odz-loading-lg"></span></div>'),sR=$('<div class="odz-alert odz-alert-error"><span> </span></div>'),iR=$('<div class="odz-text-center odz-text-sm odz-text-gray-500 odz-my-8"><!></div>'),aR=$('<img loading="lazy" class="odz-w-24 odz-h-24 odz-rounded-xl odz-object-cover odz-ring-2 odz-ring-gray-100 odz-transition-transform odz-duration-300 group-hover:odz-scale-105"> <div class="odz-w-24 odz-h-24 odz-rounded-xl odz-bg-gradient-to-br odz-from-indigo-50 odz-via-purple-50 odz-to-pink-50 odz-flex odz-items-center odz-justify-center odz-ring-2 odz-ring-gray-100" style="display: none;"><svg class="odz-w-10 odz-h-10 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>',1),AR=$('<div class="odz-w-24 odz-h-24 odz-rounded-xl odz-bg-gradient-to-br odz-from-indigo-50 odz-via-purple-50 odz-to-pink-50 odz-flex odz-items-center odz-justify-center odz-ring-2 odz-ring-gray-100"><svg class="odz-w-10 odz-h-10 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg></div>'),lR=$('<div class="odz-absolute -odz-bottom-2 -odz-right-2 odz-bg-indigo-600 odz-text-white odz-text-xs odz-font-bold odz-px-2.5 odz-py-1 odz-rounded-full odz-shadow-lg odz-ring-2 odz-ring-white"> </div>'),dR=$('<p class="odz-text-sm odz-text-gray-600 odz-mb-2 odz-truncate"> <!></p>'),cR=$('<span class="odz-inline-flex odz-items-center odz-gap-1.5 odz-px-3 odz-py-1.5 odz-rounded-lg odz-bg-indigo-50 odz-text-indigo-700 odz-text-xs odz-font-medium odz-border odz-border-indigo-100"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m2 16l4-16M6 9h14M4 15h14"></path></svg> </span>'),uR=$('<span class="odz-inline-flex odz-items-center odz-gap-1.5 odz-px-3 odz-py-1.5 odz-rounded-lg odz-bg-amber-50 odz-text-amber-700 odz-text-xs odz-font-medium odz-border odz-border-amber-100"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> </span>'),hR=(n,e,t,r)=>{l(e)&&t(l(r).id)},fR=(n,e,t)=>e(l(t)),pR=lg('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>'),gR=lg('<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"></path>',1),vR=(n,e,t)=>e(l(t)),mR=$('<button class="odz-btn odz-btn-outline odz-w-full odz-shadow-sm hover:odz-shadow-md odz-transition-all"><!> </button>'),wR=(n,e,t)=>e(l(t)),yR=$('<button class="odz-btn odz-btn-outline odz-w-full odz-shadow-sm hover:odz-shadow-md odz-transition-all"><svg class="odz-w-4 odz-h-4 odz-mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"></path></svg> </button>'),_R=$('<article class="odz-group odz-relative odz-flex odz-flex-col odz-overflow-hidden odz-bg-white odz-border odz-border-gray-200 odz-rounded-2xl odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)] odz-transition-all odz-duration-300 hover:odz-shadow-[0_12px_40px_rgba(0,0,0,0.12)] hover:odz-border-indigo-200"><div class="odz-absolute odz-top-4 odz-right-4 odz-z-10"><span><svg class="odz-w-2 odz-h-2 odz-fill-current svelte-ryvuky" viewBox="0 0 8 8"><circle cx="4" cy="4" r="3" class="svelte-ryvuky"></circle></svg> </span></div> <div class="odz-flex odz-flex-col lg:odz-flex-row"><div class="odz-flex odz-flex-1 odz-flex-col odz-p-6"><div class="odz-flex odz-items-start odz-gap-5 odz-mb-5"><div class="odz-relative odz-flex-shrink-0"><!> <!></div> <div class="odz-flex-1 odz-min-w-0 odz-pt-1"><h3 class="odz-text-xl odz-font-bold odz-text-slate-900 odz-mb-2 odz-line-clamp-2 odz-leading-tight"> </h3> <!> <div class="odz-flex odz-items-center odz-gap-2 odz-text-xs odz-text-gray-500"><svg class="odz-w-3.5 odz-h-3.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg> </div></div></div> <div class="odz-flex odz-flex-wrap odz-gap-2 odz-mb-5"><!> <!></div> <div class="odz-grid odz-grid-cols-1 sm:odz-grid-cols-3 odz-gap-3 odz-mb-5 odz-p-4 odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-50/50 odz-rounded-xl odz-border odz-border-gray-100"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-indigo-100 odz-text-indigo-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-emerald-100 odz-text-emerald-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-amber-100 odz-text-amber-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div></div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 odz-gap-3 odz-p-5 odz-bg-gradient-to-br odz-from-slate-50 odz-to-indigo-50/30 odz-rounded-xl odz-border odz-border-slate-200"><div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"></span> <span class="odz-text-base odz-font-bold odz-text-gray-900"> </span></div> <div class="odz-flex odz-flex-col odz-gap-1.5 odz-col-span-2 sm:odz-col-span-1"><span class="odz-text-xs odz-text-gray-600 odz-font-medium"> </span> <span class="odz-text-lg odz-font-bold odz-text-indigo-600"> </span></div></div></div> <div class="odz-flex odz-flex-col odz-gap-4 odz-p-6 odz-bg-gradient-to-br odz-from-slate-50 odz-to-gray-50 odz-border-t lg:odz-border-t-0 lg:odz-border-l odz-border-gray-200 lg:odz-w-56 odz-justify-between"><div class="odz-flex odz-flex-col odz-gap-2"><span class="odz-text-xs odz-font-medium odz-text-gray-500 odz-uppercase odz-tracking-wide"> </span> <button type="button"><svg class="odz-w-4 odz-h-4 svelte-ryvuky" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zm0 0h12a2 2 0 002-2v-4a2 2 0 00-2-2h-2.343M11 7.343l1.657-1.657a2 2 0 012.828 0l2.829 2.829a2 2 0 010 2.828l-8.486 8.485M7 17h.01" class="svelte-ryvuky"></path></svg> </button></div> <div class="odz-flex odz-flex-col odz-gap-2.5"><button class="odz-btn odz-btn-primary odz-w-full odz-shadow-sm hover:odz-shadow-md odz-transition-all"><svg class="odz-w-4 odz-h-4 odz-mr-1.5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><!></svg> </button> <!></div></div></div></article>'),bR=$('<div class="odz-flex odz-flex-col odz-gap-4"></div>'),xR=$('<div class="odz-flex odz-justify-center odz-my-8"><span class="odz-loading odz-loading-spinner odz-loading-lg"></span></div>'),BR=$('<div class="odz-alert odz-alert-error"><span> </span></div>'),zR=$('<div class="odz-text-center odz-text-sm odz-text-gray-500 odz-my-8">  .</div>'),CR=(n,e,t)=>{_(e,""),_(t,"")},SR=$('<button type="button" class="odz-absolute odz-right-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-text-gray-400 hover:odz-text-gray-600"><!></button>'),ER=$('<div class="odz-text-center odz-text-sm odz-text-gray-500 odz-my-8">  .</div>'),FR=$('<span class="odz-text-gray-300">|</span> <span> </span>',1),IR=$('<img class="odz-w-12 odz-h-12 odz-rounded odz-object-cover odz-flex-shrink-0">'),UR=$('<div class="odz-w-12 odz-h-12 odz-rounded odz-bg-gray-200 odz-flex odz-items-center odz-justify-center odz-flex-shrink-0"><!></div>'),QR=(n,e,t)=>e(l(t).sno),TR=$('<div class="odz-flex odz-items-center odz-gap-3 odz-p-3 odz-bg-gray-50 odz-rounded-lg odz-border odz-border-gray-100"><!> <div class="odz-flex-1 odz-min-w-0"><p class="odz-text-sm odz-font-medium odz-text-slate-900 odz-truncate"> </p> <p class="odz-text-xs odz-text-gray-500 odz-truncate"> </p></div> <button type="button" class="odz-btn odz-btn-xs odz-btn-outline odz-flex-shrink-0"><!> </button></div>'),LR=$('<div class="odz-px-5 odz-mb-4"><div class="odz-text-xs odz-font-medium odz-text-gray-500 odz-mb-2 odz-flex odz-items-center odz-gap-1"><!> </div> <div class="odz-flex odz-flex-col odz-gap-2"></div></div>'),PR=$("<span> </span>"),kR=(n,e,t)=>e(l(t)),OR=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span> ...',1),DR=$("<!> ",1),NR=$('<div class="odz-card odz-bg-white odz-border odz-border-gray-200 odz-shadow-sm odz-rounded-2xl odz-overflow-hidden"><div class="odz-flex odz-justify-between odz-items-center odz-px-5 odz-pt-5"><span> </span> <span class="odz-text-sm odz-text-gray-500"> </span></div> <div class="odz-p-5"><h3 class="odz-font-bold odz-text-lg odz-text-slate-900 odz-mb-1"> </h3> <p class="odz-text-sm odz-text-gray-600 odz-mb-3"> </p> <div class="odz-flex odz-items-center odz-gap-2 odz-text-xs odz-text-gray-500"><span> </span> <!></div></div> <!> <div class="odz-grid odz-grid-cols-1 sm:odz-grid-cols-3 odz-gap-3 odz-mx-5 odz-mb-5 odz-p-4 odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-50/50 odz-rounded-xl odz-border odz-border-gray-100"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-indigo-100 odz-text-indigo-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-emerald-100 odz-text-emerald-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-items-center odz-justify-center odz-w-9 odz-h-9 odz-rounded-lg odz-bg-sky-100 odz-text-sky-600"><!></div> <div class="odz-flex odz-flex-col odz-min-w-0"><span class="odz-text-xs odz-text-gray-500"></span> <span class="odz-text-sm odz-font-semibold odz-text-slate-900 odz-truncate"> </span></div></div></div> <div class="odz-flex odz-justify-between odz-items-center odz-px-5 odz-py-4 odz-border-t odz-border-gray-100 odz-bg-gray-50/50"><div class="odz-text-sm odz-text-gray-500"><!></div> <div class="odz-text-right"><span class="odz-text-xs odz-text-gray-500"></span> <p class="odz-text-lg odz-font-bold odz-text-primary"> </p></div></div> <div class="odz-flex odz-justify-end odz-px-5 odz-pb-5"><button type="button" class="odz-btn odz-btn-primary odz-btn-sm odz-gap-1"><!></button></div></div>'),MR=$('<div class="odz-flex odz-flex-col odz-gap-4"></div>'),HR=$(`<div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-4"><div class="odz-card-body odz-p-4"><div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-3"><div class="odz-relative odz-flex-1"><div class="odz-absolute odz-left-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-text-gray-400"><!></div> <input type="search" placeholder=", , , , ,  ..." class="odz-input odz-input-bordered odz-w-full odz-pl-10 odz-pr-10" autocomplete="off" readonly=""> <!></div></div></div></div> <div class="odz-bg-emerald-50 odz-border odz-border-emerald-200 odz-rounded-lg odz-p-4 odz-mb-4"><p class="odz-text-sm odz-text-emerald-800"><strong></strong>    <strong> </strong>
          .</p></div> <!>`,1),jR=(n,e)=>{n.key==="Enter"&&e()},RR=$('<label class="odz-label"><span class="odz-label-text-alt odz-text-error"> </span></label>'),qR=$('<div class="odz-fixed odz-inset-0 odz-flex odz-items-center odz-justify-center odz-bg-black odz-bg-opacity-50 odz-z-50"><div class="odz-bg-white odz-p-6 odz-rounded-lg odz-shadow-xl"><div class="odz-flex odz-flex-col odz-items-center"><span class="odz-loading odz-loading-spinner odz-loading-lg odz-mb-4"></span> <p class="odz-text-lg odz-font-medium">  ...</p> <p class="odz-text-sm odz-text-gray-500 odz-mt-2">  </p></div></div></div>'),KR=$('<div class="odz-w-full"><h2 class="odz-text-xl odz-font-bold odz-mb-4"> </h2> <div class="odz-card odz-bg-base-100 odz-shadow-sm odz-mb-4"><div class="odz-card-body odz-p-4"><div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-3"><div class="odz-relative odz-flex-1"><div class="odz-absolute odz-left-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-text-gray-400"><!></div> <input type="search" placeholder=", , ,  ..." class="odz-input odz-input-bordered odz-w-full odz-pl-10 odz-pr-10" autocomplete="off" readonly=""> <!></div> <div class="odz-relative odz-min-w-[140px]"><div class="odz-absolute odz-left-3 odz-top-1/2 odz-transform -odz-translate-y-1/2 odz-text-gray-400"><!></div> <select class="odz-select odz-select-bordered odz-w-full odz-pl-9"><option> </option><option></option><option></option><option></option><option></option><option></option></select></div> <!></div> <!></div></div> <!> <!> <!> <!> <!></div> <!> <dialog id="password_confirm_modal"><div class="odz-modal-box odz-max-w-sm"><h3 class="odz-font-bold odz-text-lg odz-mb-4">  </h3> <p class="odz-text-sm odz-mb-4">     .</p> <div class="odz-form-control odz-w-full"><label class="odz-label"><span class="odz-label-text"></span></label> <input type="password" placeholder=" "> <!></div> <div class="odz-modal-action"><button class="odz-btn odz-btn-outline"></button> <button class="odz-btn odz-btn-primary"></button></div></div> <div class="odz-modal-backdrop"></div></dialog> <!>',1);function $R(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(ni,"$shopStore",t),s=()=>an(Gl,"$customerStore",t),i=Be(),a=Be();let A=ht(e,"openEstimateModal",8,()=>{}),d=Be([]),c=Be(!0),u=Be(null),h,p=Be(!1),v=Be(null),w=Be(""),y=Be(""),B=Be(null),C=Be(""),Q=Be(""),k=Be(""),H=Be(!1),Z=Be(!1),q=Be(""),N=Be(""),re=Be(!1),be=Be(!1),L=Be(""),R=null,J=Be(""),se=Be(!1),fe=Be(!1),ie=null,pe=Be(null),te=Be("current"),Ce=Be([]),ne=Be(!1),ze=Be(null),z=!1,E=Be(""),F=Be(""),I=Be(null),O=Be(!1),D=Be(null);const P={thumbnail:null,productNames:[],itemCount:0,totalQuantity:0};let K={};to(async()=>{try{if(l(H)){_(c,!0);try{console.log("[ODIZ Debug]   "),console.log("[ODIZ Debug] shop_id:",o().id),console.log("[ODIZ Debug] sess:",o().sess),console.log("[ODIZ Debug] mallType:",s().mallType);const Ve=await ft.from("estimates").select("*").eq("shop_id",o().id).is("customer_id",null).eq("sess",o().sess).neq("status","temp").order("created_at",{ascending:!1});if(Ve.error)throw Ve.error;_(d,Ve.data||[]),s().mallType&&s().mallType.trim()!==""&&_(d,l(d).filter(wt=>wt.mall_type===s().mallType)),await ye(l(d)),h=D0(o().sess,o().id,async wt=>{var qt,Kt,kr,fr,ir,Ur;wt.eventType==="UPDATE"?((qt=wt.new)==null?void 0:qt.status)!=="temp"?(_(d,l(d).map(Or=>Or.id===wt.new.id?{...Or,...wt.new}:Or)),await Ee((Kt=wt.new)==null?void 0:Kt.id)):(_(d,l(d).filter(Or=>Or.id!==wt.new.id)),de((kr=wt.new)==null?void 0:kr.id)):wt.eventType==="INSERT"?((fr=wt.new)==null?void 0:fr.status)!=="temp"&&(!s().mallType||s().mallType.trim()===""||wt.new.mall_type===s().mallType)&&(_(d,[wt.new,...l(d)]),await Ee((ir=wt.new)==null?void 0:ir.id)):wt.eventType==="DELETE"&&(_(d,l(d).filter(Or=>Or.id!==wt.old.id)),de((Ur=wt.old)==null?void 0:Ur.id))},void 0)}catch(Ve){console.error("    :",Ve),_(d,[])}_(c,!1)}else{const Ve=new Date,wt=new Date(Ve);wt.setMonth(wt.getMonth()-1),_(q,ge(wt)),_(N,ge(Ve)),_(re,!0);const{getEstimatesWithDateFilter:qt}=await js(async()=>{const{getEstimatesWithDateFilter:Kt}=await Promise.resolve().then(()=>Gh);return{getEstimatesWithDateFilter:Kt}},void 0);_(d,await qt(o().sess,o().customer_id,o().id,l(q),l(N))),await ye(l(d)),h=D0(o().sess,o().id,async Kt=>{var kr,fr,ir,Ur,Or,Yn;Kt.eventType==="UPDATE"?((kr=Kt.new)==null?void 0:kr.status)!=="temp"?(_(d,l(d).map(yt=>yt.id===Kt.new.id?{...yt,...Kt.new}:yt)),await Ee((fr=Kt.new)==null?void 0:fr.id)):(_(d,l(d).filter(yt=>yt.id!==Kt.new.id)),de((ir=Kt.new)==null?void 0:ir.id)):Kt.eventType==="INSERT"?((Ur=Kt.new)==null?void 0:Ur.status)!=="temp"&&(_(d,[Kt.new,...l(d)]),await Ee((Or=Kt.new)==null?void 0:Or.id)):Kt.eventType==="DELETE"&&(_(d,l(d).filter(yt=>yt.id!==Kt.old.id)),de((Yn=Kt.old)==null?void 0:Yn.id))},o().customer_id)}}catch(Ve){_(u,Ve.message||"     ."),K={}}finally{_(c,!1)}}),gs(()=>{h&&h.unsubscribe()});function M(Ve){if(!Ve)return"";const wt=new Date(Ve);return`${wt.getFullYear()}-${String(wt.getMonth()+1).padStart(2,"0")}-${String(wt.getDate()).padStart(2,"0")}`}function ge(Ve){const wt=Ve.getFullYear(),qt=String(Ve.getMonth()+1).padStart(2,"0"),Kt=String(Ve.getDate()).padStart(2,"0");return`${wt}-${qt}-${Kt}`}function _e(Ve){const wt=new Date,qt=ge(wt);let Kt=new Date(wt);switch(Ve){case"1week":Kt.setDate(Kt.getDate()-7);break;case"1month":Kt.setMonth(Kt.getMonth()-1);break;case"6months":Kt.setMonth(Kt.getMonth()-6);break;case"1year":Kt.setFullYear(Kt.getFullYear()-1);break}_(q,ge(Kt)),_(N,qt)}function Me(Ve){return{1:"",2:"",3:"",4:"",5:"",6:""}[Ve]||`${Ve}`}function $e(Ve){return{1:"odz-badge-warning",2:"odz-badge-info",3:"odz-badge-success",4:"odz-badge-primary",5:"odz-badge-neutral",6:"odz-badge-error"}[Ve]||"odz-badge-ghost"}function Y(Ve){return!Ve||Ve==="0000-00-00 00:00:00"?"-":new Date(Ve).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"})}function j(Ve){const wt=typeof Ve=="string"?parseFloat(Ve):Ve;return isNaN(wt)?"0":wt.toLocaleString("ko-KR")+""}function ee(Ve){return!Ve.imageStorage||!Ve.imagePath||!Ve.imageName?"":`${Ve.imageStorage}/${Ve.imagePath}${Ve.imageName}`}function ae(Ve){try{if(!Ve)return{summary:"-",totalQty:0};const wt=Ve.replace(/\\"/g,'"'),qt=JSON.parse(wt);if(!Array.isArray(qt)||qt.length===0)return{summary:"-",totalQty:0};const Kt=qt.reduce((Ur,Or)=>Ur+(Or.ea||0),0),kr=qt[0],fr=[kr.optionValue1,kr.optionValue2].filter(Boolean).join(" / ");return{summary:qt.length>1?`${fr}  ${qt.length-1} `:fr,totalQty:Kt}}catch{return{summary:"-",totalQty:0}}}function ue(Ve){const wt=`http://dantee771.godomall.com/estimate/estimate_goods_design.php?estimateGoodsSno=${Ve}`;window.open(wt,`design_${Ve}`,"width=900,height=700,scrollbars=yes,resizable=yes")}function me(Ve){const wt=new Set;let qt=null,Kt=0,kr=0;return(Ve||[]).forEach((ir,Ur)=>{var yt,rr;if(!ir)return;kr+=1,Kt+=ir.quantity||0;const Or=(yt=ir.product)==null?void 0:yt.title;Or&&wt.add(Or);const Yn=(rr=ir.product)==null?void 0:rr.thumbnail;!qt&&Yn&&(qt=Yn)}),{thumbnail:qt,productNames:Array.from(wt),itemCount:kr,totalQuantity:Kt}}async function ye(Ve){const wt=Ve.map(qt=>qt.id).filter(qt=>!!qt);if(wt.length===0){K={};return}try{const{data:qt,error:Kt}=await ft.from("estimate_items").select(`
          estimate_id,
          idx,
          quantity,
          product:products(
            title,
            thumbnail
          )
        `).in("estimate_id",wt);if(Kt){console.error("    :",Kt);return}const kr={};(qt||[]).forEach(ir=>{ir!=null&&ir.estimate_id&&(kr[ir.estimate_id]||(kr[ir.estimate_id]=[]),kr[ir.estimate_id].push(ir))});const fr={};wt.forEach(ir=>{fr[ir]=me(kr[ir])}),K=fr}catch(qt){console.error("     :",qt)}}async function Ee(Ve){if(Ve)try{const{data:wt,error:qt}=await ft.from("estimate_items").select(`
          estimate_id,
          idx,
          quantity,
          product:products(
            title,
            thumbnail
          )
        `).eq("estimate_id",Ve);if(qt){console.error("[ERROR]      :",qt),console.error("[ERROR] estimateId:",Ve);return}const Kt=me(wt);K={...K,[Ve]:Kt}}catch(wt){console.error("[ERROR]       :",wt),console.error("[ERROR] estimateId:",Ve)}}function de(Ve){if(!Ve)return;const{[Ve]:wt,...qt}=K;K=qt}function Qe(Ve){return Ve&&K[Ve]||P}function Fe(Ve){switch(Ve){case"pending":return"";case"progress":return"";case"completed":return"";case"temp":return"";case"canceled":return"";case"hold":return"";default:return""}}function Oe(Ve){switch(Ve){case"pending":return"odz-bg-amber-100 odz-text-amber-700 odz-border-amber-200";case"progress":return"odz-bg-sky-100 odz-text-sky-700 odz-border-sky-200";case"completed":return"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200";case"canceled":return"odz-bg-rose-100 odz-text-rose-700 odz-border-rose-200";case"hold":case"temp":return"odz-bg-slate-200 odz-text-slate-600 odz-border-slate-300";default:return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200"}}function Te(Ve){switch(Ve){case"none":return" ";case"waiting":return" ";case"processing":return" ";case"confirming":return" ";case"completed":return" ";case"rejected":return" ";default:return"-"}}function De(Ve){switch(Ve){case"none":return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200";case"waiting":return"odz-bg-sky-100 odz-text-sky-700 odz-border-sky-200";case"processing":return"odz-bg-indigo-100 odz-text-indigo-700 odz-border-indigo-200";case"confirming":return"odz-bg-purple-100 odz-text-purple-700 odz-border-purple-200";case"completed":return"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200";case"rejected":return"odz-bg-rose-100 odz-text-rose-700 odz-border-rose-200";default:return"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200"}}function ce(Ve){_(v,Ve),_(p,!0)}async function Ie(){_(c,!0),_(u,null),_(Z,!0);try{_(d,await m5(o().id,l(Q),l(k),o().sess,s().mallType)),await ye(l(d)),l(d).length===0&&(!l(Q)&&!l(k)?_(u,"   ."):_(u,"    ."))}catch(Ve){_(u,Ve.message||"    ."),_(d,[]),K={}}finally{_(c,!1)}}async function V(){if(!l(q)&&!l(N)){_(u,"   .");return}_(c,!0),_(u,null),_(re,!0);try{const{getEstimatesWithDateFilter:Ve}=await js(async()=>{const{getEstimatesWithDateFilter:wt}=await Promise.resolve().then(()=>Gh);return{getEstimatesWithDateFilter:wt}},void 0);_(d,await Ve(o().sess,o().customer_id,o().id,l(q),l(N))),await ye(l(d)),l(d).length===0&&_(u,"   .")}catch(Ve){_(u,Ve.message||"    ."),_(d,[]),K={}}finally{_(c,!1)}}async function G(){_(u,null);const Ve=new Date,wt=new Date(Ve);wt.setMonth(wt.getMonth()-1),_(q,ge(wt)),_(N,ge(Ve)),_(re,!0),_(c,!0);try{const{getEstimatesWithDateFilter:qt}=await js(async()=>{const{getEstimatesWithDateFilter:Kt}=await Promise.resolve().then(()=>Gh);return{getEstimatesWithDateFilter:Kt}},void 0);_(d,await qt(o().sess,o().customer_id,o().id,l(q),l(N))),await ye(l(d))}catch(qt){_(u,qt.message||"     ."),K={}}finally{_(c,!1)}}async function le(){_(c,!0),_(u,null);try{const Ve=new Date,wt=new Date(Ve);wt.setMonth(wt.getMonth()-1),_(q,ge(wt)),_(N,ge(Ve)),_(re,!0);const{getEstimatesWithDateFilter:qt}=await js(async()=>{const{getEstimatesWithDateFilter:Kt}=await Promise.resolve().then(()=>Gh);return{getEstimatesWithDateFilter:Kt}},void 0);_(d,await qt(o().sess,o().customer_id,o().id,l(q),l(N))),await ye(l(d)),console.log("[loadEstimates]    -  :",l(d).length)}catch(Ve){console.error("[loadEstimates] :",Ve),_(u,Ve.message||"     ."),K={}}finally{_(c,!1)}}function Le(Ve){l(H)&&Ve.status==="pending"?(R=Ve,_(L,""),_(J,""),_(be,!0)):window.location.href=`?mode=register&estimateId=${Ve.id}`}async function He(){if(!R||!l(L).trim()){_(J," .");return}try{const{data:Ve,error:wt}=await ft.from("estimates").select("id").eq("id",R.id).eq("password",l(L)).single();if(wt||!Ve){_(J,"  .");return}_(be,!1),A()(!0,R)}catch(Ve){_(J,"    ."),console.error("  :",Ve)}}function je(){_(be,!1),_(L,""),_(J,""),R=null}async function xe(Ve){if(!(!Ve||!Ve.id))try{_(se,!0),_(pe,Ve.id);const wt=await w5(Ve.id);let qt=[...wt];const Kt=await b5(Ve.id);if((Kt==null?void 0:Kt.length)>0){const fr=wt.length>0?Math.max(...wt.map(Ur=>Ur.idx||0)):0,ir=Kt.map((Ur,Or)=>({...Ur,idx:fr+Or+1,items:Ur.items.map(Yn=>({...Yn,idx:fr+Or+1}))}));qt=[...qt,...ir]}if(!qt.some(fr=>fr.product&&fr.product.mall_type==="godo5"&&fr.product.mall_product_id)){alert("5    .");return}if(ie=await Mj(qt),ie.success){const fr=ie.submittedOrders.reduce((ir,Ur)=>ir+Ur.productIds.length,0);alert(` .  ${fr}  .`)}else alert("  .   .")}catch(wt){console.error("    :",wt),alert("    : "+wt.message)}finally{_(se,!1)}}async function Re(Ve){if(Ve!=null&&Ve.id)try{_(fe,!0),_(pe,Ve.id);const wt=await I5(Ve.id);if(wt.success&&wt.newEstimateId){const qt=await rd(wt.newEstimateId);qt&&(alert(" ."),A()(!0,qt))}else alert(wt.error||"    .")}catch(wt){console.error("   :",wt),alert("    .")}finally{_(fe,!1),_(pe,null)}}async function et(Ve){var fr;if(!(Ve!=null&&Ve.estimateNo))return;const wt=document.getElementById("odiz-shop-id"),qt=wt==null?void 0:wt.value;if(console.log("[handleLegacyReorder]  - shopIdElement:",wt,"shopId:",qt),!qt||qt.trim()===""){console.error("[handleLegacyReorder] shopId . HTML   :",{elementExists:!!wt,value:qt}),alert(`    .
(    )`);return}const Kt=(fr=document.getElementById("odiz-customer-id"))==null?void 0:fr.value,kr=Kt&&Kt.trim()!==""?Kt:null;console.log("[handleLegacyReorder] shopId:",qt,"customerId:",kr);try{_(O,!0),_(D,Ve.estimateNo);const ir=await k5(Ve,qt,kr);ir.success?(alert(` .
 : ${ir.newEstimateNo}`),_(te,"current"),await le()):alert(ir.error||"    .")}catch(ir){console.error("[handleLegacyReorder] :",ir),alert("    .")}finally{_(O,!1),_(D,null)}}async function qe(){var Kt,kr,fr;const Ve=(Kt=document.getElementById("odiz-customer-id"))==null?void 0:Kt.value,wt=(kr=document.getElementById("odiz-customer-name"))==null?void 0:kr.value,qt=(fr=document.getElementById("odiz-customer-phone"))==null?void 0:fr.value;if(console.log("[ODIZ Debug]    "),console.log("[ODIZ Debug] customerId:",Ve),console.log("[ODIZ Debug] customerName:",wt),console.log("[ODIZ Debug] customerPhone:",qt),!Ve&&!wt&&!qt){_(ze,"    ."),alert("    .");return}_(ne,!0),_(ze,null);try{const ir=`https://dantee7728.godomall.com/proxy/api_proxy.php?endpoint=estimate/get_data&memId=${encodeURIComponent(Ve)}&orderName=${encodeURIComponent(wt)}&orderPhone=${encodeURIComponent(qt)}`;console.log("[ODIZ Debug] API URL:",ir);const Ur=await fetch(ir);if(!Ur.ok)throw new Error(`API  : ${Ur.status}`);const Or=await Ur.json();console.log("[ODIZ Debug] API :",Or),_(Ce,Array.isArray(Or)?Or:Or.data||Or.estimates||[Or]),z=!0}catch(ir){console.error("Previous estimates API error:",ir),_(ze,"     .")}finally{_(ne,!1)}}async function ot(Ve){_(te,Ve),Ve==="previous"&&!z&&await qe()}Yt(()=>(l(B),l(w)),()=>{l(B)&&clearTimeout(l(B)),_(B,setTimeout(()=>{_(y,l(w))},300))}),Yt(()=>(l(te),l(d),l(C),l(y)),()=>{_(i,(l(te),l(d).filter(Ve=>{if(l(C)&&Ve.status!==l(C))return!1;if(l(y)){const wt=l(y).toLowerCase().trim(),Kt=Qe(Ve.id).productNames.join(" ").toLowerCase();return String(Ve.estimate_no||"").toLowerCase().includes(wt)||String(Ve.name||"").toLowerCase().includes(wt)||String(Ve.organization_name||"").toLowerCase().includes(wt)||String(Ve.order_name||"").toLowerCase().includes(wt)||String(Ve.order_phone||"").includes(wt)||Kt.includes(wt)}return!0})))}),Yt(()=>(l(I),l(E)),()=>{l(I)&&clearTimeout(l(I)),_(I,setTimeout(()=>{_(F,l(E))},300))}),Yt(()=>(l(Ce),l(F)),()=>{_(a,l(Ce).filter(Ve=>{var wt,qt,Kt,kr,fr,ir;if(Ve.state!==3)return!1;if(l(F)){const Ur=l(F).toLowerCase().trim();return String(Ve.estimateNo).includes(Ur)||((wt=Ve.estimateNm)==null?void 0:wt.toLowerCase().includes(Ur))||((qt=Ve.ex1)==null?void 0:qt.toLowerCase().includes(Ur))||((Kt=Ve.receiverName)==null?void 0:Kt.toLowerCase().includes(Ur))||((kr=Ve.memNm)==null?void 0:kr.toLowerCase().includes(Ur))||((fr=Ve.receiverCellPhone)==null?void 0:fr.includes(Ur))||((ir=Ve.orderGoodsNm)==null?void 0:ir.toLowerCase().includes(Ur))}return!0}))}),Yt(()=>o(),()=>{_(H,!o().customer_id)}),mo(),fn();var Pe=KR(),Ye=it(Pe),rt=x(g(Ye),2),lt=g(rt),vt=g(lt),Ft=g(vt),Qt=g(Ft),Et=g(Qt);xp(Et,{size:18});var mt=x(Qt,2),Gt=x(mt,2);{var Ht=Ve=>{var wt=qj();wt.__click=[Rj,w,y];var qt=g(wt);xA(qt,{size:16}),U(Ve,wt)};ve(Gt,Ve=>{l(w)&&Ve(Ht)})}var Ut=x(Ft,2),st=g(Ut),pt=g(st);mE(pt,{size:16});var _t=x(st,2);Ne(()=>{l(C),Ru(()=>{})});var $t=g(_t);$t.value=(($t.__value="")==null,"");var Rt=x($t);Rt.value=(Rt.__value="pending")==null?"":"pending";var Ot=x(Rt);Ot.value=(Ot.__value="progress")==null?"":"progress";var Ct=x(Ot);Ct.value=(Ct.__value="completed")==null?"":"completed";var Wt=x(Ct);Wt.value=(Wt.__value="hold")==null?"":"hold";var It=x(Wt);It.value=(It.__value="canceled")==null?"":"canceled";var St=x(Ut,2);{var jt=Ve=>{var wt=Kj();wt.__click=[jj,w,y,C],U(Ve,wt)};ve(St,Ve=>{(l(w)||l(C))&&Ve(jt)})}var dr=x(vt,2);{var pr=Ve=>{var wt=$j(),qt=g(wt),Kt=g(qt);Ne(()=>Se(Kt,l(i).length)),U(Ve,wt)};ve(dr,Ve=>{!l(c)&&(l(w)||l(C))&&Ve(pr)})}var ar=x(rt,2);{var ur=Ve=>{var wt=Zj(),qt=g(wt),Kt=g(qt),kr=x(g(Kt),2),fr=g(kr),ir=g(fr),Ur=x(g(ir),2),Or=x(ir,2),Yn=x(g(Or),2),yt=x(Or,2),rr=g(yt);rr.__click=V;var Br=x(rr,2);{var gn=Zr=>{var Vt=Vj();Vt.__click=G,Ne(()=>Vt.disabled=l(c)),U(Zr,Vt)};ve(Br,Zr=>{l(re)&&Zr(gn)})}var Dn=x(fr,2),Sr=g(Dn);Sr.__click=[Gj,_e];var Xr=x(Sr,2);Xr.__click=[Wj,_e];var Fn=x(Xr,2);Fn.__click=[Xj,_e];var Dt=x(Fn,2);Dt.__click=[Yj,_e];var Mo=x(Dn,2);{var Nn=Zr=>{var Vt=Jj(),en=g(Vt);Ne(()=>Se(en,`*  ${l(q)||""} ~ ${l(N)||""} 
                 `)),U(Zr,Vt)};ve(Mo,Zr=>{l(re)&&Zr(Nn)})}Ne(()=>{rr.disabled=l(c),Sr.disabled=l(c),Xr.disabled=l(c),Fn.disabled=l(c),Dt.disabled=l(c)}),Cr(Ur,()=>l(q),Zr=>_(q,Zr)),Cr(Yn,()=>l(N),Zr=>_(N,Zr)),U(Ve,wt)};ve(ar,Ve=>{l(H)||Ve(ur)})}var Ir=x(ar,2);{var Yr=Ve=>{var wt=eR(),qt=g(wt),Kt=g(qt),kr=x(g(Kt),2),fr=g(kr),ir=g(fr),Ur=x(g(ir),2),Or=x(ir,2),Yn=x(g(Or),2),yt=x(Or,2),rr=g(yt);rr.__click=Ie,Cr(Ur,()=>l(Q),Br=>_(Q,Br)),Cr(Yn,()=>l(k),Br=>_(k,Br)),U(Ve,wt)};ve(Ir,Ve=>{l(H)&&Ve(Yr)})}var Jr=x(Ir,2);{var qr=Ve=>{var wt=nR(),qt=g(wt);qt.__click=[tR,ot];var Kt=x(qt,2);Kt.__click=[rR,ot],Ne(()=>{Dr(qt,`odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-transition-all odz-duration-200 odz-border-b-2 ${(l(te)==="current"?"odz-border-indigo-600 odz-text-indigo-600":"odz-border-transparent odz-text-gray-500 hover:odz-text-gray-700 hover:odz-border-gray-300")??""}`),Dr(Kt,`odz-px-4 odz-py-2 odz-text-sm odz-font-medium odz-transition-all odz-duration-200 odz-border-b-2 ${(l(te)==="previous"?"odz-border-indigo-600 odz-text-indigo-600":"odz-border-transparent odz-text-gray-500 hover:odz-text-gray-700 hover:odz-border-gray-300")??""}`)}),U(Ve,wt)};ve(Jr,Ve=>{l(H)||Ve(qr)})}var Ar=x(Jr,2);{var Lr=Ve=>{var wt=kt(),qt=it(wt);{var Kt=fr=>{var ir=oR();U(fr,ir)},kr=fr=>{var ir=kt(),Ur=it(ir);{var Or=yt=>{var rr=sR(),Br=g(rr),gn=g(Br);Ne(()=>Se(gn,l(u))),U(yt,rr)},Yn=yt=>{var rr=kt(),Br=it(rr);{var gn=Sr=>{var Xr=iR(),Fn=g(Xr);{var Dt=Nn=>{var Zr=bn("    .");U(Nn,Zr)},Mo=Nn=>{var Zr=kt(),Vt=it(Zr);{var en=fo=>{var Qo=bn("   .    .");U(fo,Qo)},In=fo=>{var Qo=bn("  .");U(fo,Qo)};ve(Vt,fo=>{l(H)?fo(en):fo(In,!1)},!0)}U(Nn,Zr)};ve(Fn,Nn=>{l(H)&&l(Z)?Nn(Dt):Nn(Mo,!1)})}U(Sr,Xr)},Dn=Sr=>{var Xr=bR();tr(Xr,5,()=>l(i),Fn=>Fn.id??Fn.created_at,(Fn,Dt)=>{var Mo=_R();const Nn=at(()=>Qe(l(Dt).id)),Zr=at(()=>l(Dt).design_confirm==="confirming"||l(Dt).design_confirm==="completed");var Vt=g(Mo),en=g(Vt),In=x(g(en)),fo=x(Vt,2),Qo=g(fo),ai=g(Qo),Bi=g(ai),zi=g(Bi);{var Ai=Nr=>{var un=aR(),xn=it(un);Ne(()=>{cr(xn,"src",l(Nn).thumbnail),cr(xn,"alt",(l(Dt).name||"")+"  ")}),At("error",xn,Ho=>{Ho.currentTarget.style.display="none";const $n=Ho.currentTarget.nextElementSibling;$n&&($n.style.display="flex")}),Tb(xn),U(Nr,un)},qs=Nr=>{var un=AR();U(Nr,un)};ve(zi,Nr=>{l(Nn).thumbnail?Nr(Ai):Nr(qs,!1)})}var ji=x(zi,2);{var qn=Nr=>{var un=lR(),xn=g(un);Ne(()=>Se(xn,`${l(Nn).totalQuantity??""}`)),U(Nr,un)};ve(ji,Nr=>{l(Nn).totalQuantity>0&&Nr(qn)})}var Go=x(Bi,2),Jn=g(Go),tn=g(Jn),fa=x(Jn,2);{var Ga=Nr=>{var un=dR(),xn=g(un),Ho=x(xn);{var $n=jo=>{var lo=bn();Ne(()=>Se(lo,` ${l(Nn).productNames.length-1}`)),U(jo,lo)};ve(Ho,jo=>{l(Nn).productNames.length>1&&jo($n)})}Ne(()=>Se(xn,l(Nn).productNames[0])),U(Nr,un)};ve(fa,Nr=>{l(Nn).productNames.length>0&&Nr(Ga)})}var pa=x(fa,2),Ks=x(g(pa)),$s=x(ai,2),IA=g($s);{var li=Nr=>{var un=cR(),xn=x(g(un));Ne(()=>Se(xn,` ${l(Dt).estimate_no??""}`)),U(Nr,un)};ve(IA,Nr=>{l(Dt).estimate_no&&Nr(li)})}var ms=x(IA,2);{var Wa=Nr=>{var un=uR(),xn=x(g(un));Ne(Ho=>Se(xn,`  ${Ho??""}`),[()=>M(l(Dt).pref_delivery_date)],at),U(Nr,un)};ve(ms,Nr=>{l(Dt).pref_delivery_date&&Nr(Wa)})}var di=x($s,2),UA=g(di),Ri=g(UA),QA=g(Ri);Bw(QA,{size:18});var Xa=x(Ri,2),Ya=x(g(Xa),2),TA=g(Ya),Ci=x(UA,2),ga=g(Ci),va=g(ga);Wl(va,{size:18});var Ja=x(ga,2),LA=x(g(Ja),2),ma=g(LA),qi=x(Ci,2),wa=g(qi),Si=g(wa);P0(Si,{size:18});var ya=x(wa,2),b=x(g(ya),2),W=g(b),ke=x(di,2),Ke=g(ke),nt=x(g(Ke),2),Bt=g(nt),Nt=x(Ke,2),Zt=x(g(Nt),2),vr=g(Zt),Qr=x(Nt,2),Tr=x(g(Qr),2),Vr=g(Tr),kn=x(Qr,2),Kn=x(g(kn),2),ro=g(Kn),To=x(Qo,2),ao=g(To),Wo=x(g(ao),2);Wo.__click=[hR,Zr,ce,Dt];var ss=x(g(Wo)),ws=x(ao,2),_a=g(ws);_a.__click=[fR,Le,Dt];var ba=g(_a),Za=g(ba);{var Un=Nr=>{var un=pR();U(Nr,un)},Ao=Nr=>{var un=gR();U(Nr,un)};ve(Za,Nr=>{l(Dt).status==="pending"?Nr(Un):Nr(Ao,!1)})}var Xo=x(ba),is=x(_a,2);{var _o=Nr=>{var un=kt(),xn=it(un);{var Ho=jo=>{var lo=mR();lo.__click=[vR,Re,Dt];var ci=g(lo);zw(ci,{class:"odz-w-4 odz-h-4 odz-mr-1.5"});var Yo=x(ci);Ne(()=>{lo.disabled=l(fe)||l(pe)===l(Dt).id,Se(Yo,` ${(l(fe)&&l(pe)===l(Dt).id?"...":"")??""}`)}),U(jo,lo)},$n=jo=>{var lo=yR();lo.__click=[wR,xe,Dt];var ci=x(g(lo));Ne(()=>{lo.disabled=l(se)||l(pe)===l(Dt).id,Se(ci,` ${(l(se)&&l(pe)===l(Dt).id?"...":"")??""}`)}),U(jo,lo)};ve(xn,jo=>{l(Dt).is_payment?jo(Ho):jo($n,!1)})}U(Nr,un)};ve(is,Nr=>{l(Dt).status==="completed"&&Nr(_o)})}Ne((Nr,un,xn,Ho,$n,jo,lo,ci,Yo)=>{Dr(en,`${Nr??""} svelte-ryvuky`),Se(In,` ${un??""}`),Se(tn,l(Dt).name||"  "),Se(Ks,` ${xn??""}`),Se(TA,l(Dt).organization_name||"-"),Se(ma,l(Dt).order_name||"-"),Se(W,l(Dt).order_phone||"-"),Se(Bt,Ho),Se(vr,$n),Se(Vr,jo),Se(ro,lo),Dr(Wo,`${ci??""} svelte-ryvuky`),Wo.disabled=!l(Zr),Se(ss,` ${Yo??""}`),Se(Xo,` ${(l(Dt).status==="pending"?"":"")??""}`)},[()=>`odz-inline-flex odz-items-center odz-gap-1.5 odz-rounded-full odz-px-3.5 odz-py-1.5 odz-text-xs odz-font-semibold odz-shadow-sm odz-backdrop-blur-sm ${Oe(l(Dt).status)}`,()=>Fe(l(Dt).status),()=>M(l(Dt).created_at),()=>l(Dt).product_amount!==null&&l(Dt).product_amount!==void 0?`${yr(l(Dt).product_amount)}`:"-",()=>l(Dt).print_amount!==null&&l(Dt).print_amount!==void 0?`${yr(l(Dt).print_amount)}`:"-",()=>l(Dt).addon_amount!==null&&l(Dt).addon_amount!==void 0?`${yr(l(Dt).addon_amount)}`:"-",()=>l(Dt).total_amount!==null&&l(Dt).total_amount!==void 0?`${yr(l(Dt).total_amount)}`:"-",()=>`odz-inline-flex odz-items-center odz-justify-center odz-gap-2 odz-px-4 odz-py-2.5 odz-rounded-lg odz-text-sm odz-font-semibold odz-transition-all odz-duration-200 ${De(l(Dt).design_confirm)} ${l(Zr)?"hover:odz-shadow-md hover:odz-scale-105":"odz-opacity-60 odz-cursor-not-allowed"}`,()=>Te(l(Dt).design_confirm)],at),U(Fn,Mo)}),U(Sr,Xr)};ve(Br,Sr=>{l(d).length===0?Sr(gn):Sr(Dn,!1)},!0)}U(yt,rr)};ve(Ur,yt=>{l(u)?yt(Or):yt(Yn,!1)},!0)}U(fr,ir)};ve(qt,fr=>{l(c)?fr(Kt):fr(kr,!1)})}U(Ve,wt)};ve(Ar,Ve=>{(l(te)==="current"||l(H))&&Ve(Lr)})}var Kr=x(Ar,2);{var xr=Ve=>{var wt=kt(),qt=it(wt);{var Kt=fr=>{var ir=xR();U(fr,ir)},kr=fr=>{var ir=kt(),Ur=it(ir);{var Or=yt=>{var rr=BR(),Br=g(rr),gn=g(Br);Ne(()=>Se(gn,l(ze))),U(yt,rr)},Yn=yt=>{var rr=kt(),Br=it(rr);{var gn=Sr=>{var Xr=zR();U(Sr,Xr)},Dn=Sr=>{var Xr=HR(),Fn=it(Xr),Dt=g(Fn),Mo=g(Dt),Nn=g(Mo),Zr=g(Nn),Vt=g(Zr);xp(Vt,{size:18});var en=x(Zr,2),In=x(en,2);{var fo=qn=>{var Go=SR();Go.__click=[CR,E,F];var Jn=g(Go);xA(Jn,{size:16}),U(qn,Go)};ve(In,qn=>{l(E)&&qn(fo)})}var Qo=x(Fn,2),ai=g(Qo),Bi=x(g(ai),2),zi=g(Bi),Ai=x(Qo,2);{var qs=qn=>{var Go=ER();U(qn,Go)},ji=qn=>{var Go=MR();tr(Go,5,()=>l(a),mr,(Jn,tn)=>{var fa=NR(),Ga=g(fa),pa=g(Ga),Ks=g(pa),$s=x(pa,2),IA=g($s),li=x(Ga,2),ms=g(li),Wa=g(ms),di=x(ms,2),UA=g(di),Ri=x(di,2),QA=g(Ri),Xa=g(QA),Ya=x(QA,2);{var TA=Un=>{var Ao=FR(),Xo=x(it(Ao),2),is=g(Xo);Ne(()=>Se(is,`: ${l(tn).goodsCnt??""}`)),U(Un,Ao)};ve(Ya,Un=>{l(tn).goodsCnt&&l(tn).goodsCnt!=="0"&&Un(TA)})}var Ci=x(li,2);{var ga=Un=>{var Ao=LR(),Xo=g(Ao),is=g(Xo);Gu(is,{size:14});var _o=x(is),Nr=x(Xo,2);tr(Nr,5,()=>l(tn).estimateGoods,mr,(un,xn)=>{var Ho=TR();const $n=at(()=>ae(l(xn).selectOptions)),jo=at(()=>ee(l(xn)));var lo=g(Ho);{var ci=Us=>{var ls=IR();Ne(()=>{cr(ls,"src",l(jo)),cr(ls,"alt",l(xn).goodsNm)}),At("error",ls,ui=>ui.currentTarget.style.display="none"),U(Us,ls)},Yo=Us=>{var ls=UR(),ui=g(ls);Gu(ui,{size:20,class:"odz-text-gray-400"}),U(Us,ls)};ve(lo,Us=>{l(jo)?Us(ci):Us(Yo,!1)})}var eA=x(lo,2),xl=g(eA),vd=g(xl),xa=x(xl,2),tA=g(xa),as=x(eA,2);as.__click=[QR,ue,xn];var As=g(as);i5(As,{size:14,class:"odz-mr-1"}),Ne(()=>{Se(vd,l(xn).goodsNm),Se(tA,`${l($n).summary??""}  ${l($n).totalQty??""}`)}),U(un,Ho)}),Ne(()=>Se(_o,`  (${l(tn).estimateGoods.length??""})`)),U(Un,Ao)};ve(Ci,Un=>{l(tn).estimateGoods&&l(tn).estimateGoods.length>0&&Un(ga)})}var va=x(Ci,2),Ja=g(va),LA=g(Ja),ma=g(LA);Bw(ma,{size:18});var qi=x(LA,2),wa=x(g(qi),2),Si=g(wa),ya=x(Ja,2),b=g(ya),W=g(b);Wl(W,{size:18});var ke=x(b,2),Ke=x(g(ke),2),nt=g(Ke),Bt=x(ya,2),Nt=g(Bt),Zt=g(Nt);P0(Zt,{size:18});var vr=x(Nt,2),Qr=x(g(vr),2),Tr=g(Qr),Vr=x(va,2),kn=g(Vr),Kn=g(kn);{var ro=Un=>{var Ao=PR(),Xo=g(Ao);Ne(is=>Se(Xo,`: ${is??""}`),[()=>Y(l(tn).eventDate)],at),U(Un,Ao)};ve(Kn,Un=>{l(tn).eventDate&&l(tn).eventDate!=="0000-00-00 00:00:00"&&Un(ro)})}var To=x(kn,2),ao=x(g(To),2),Wo=g(ao),ss=x(Vr,2),ws=g(ss);ws.__click=[kR,et,tn];var _a=g(ws);{var ba=Un=>{var Ao=OR();U(Un,Ao)},Za=Un=>{var Ao=DR(),Xo=it(Ao);zw(Xo,{size:14}),U(Un,Ao)};ve(_a,Un=>{l(O)&&l(D)===l(tn).estimateNo?Un(ba):Un(Za,!1)})}Ne((Un,Ao,Xo,is)=>{Dr(pa,Un),Se(Ks,Ao),Se(IA,Xo),Se(Wa,l(tn).estimateNm||` #${l(tn).estimateNo}`),Se(UA,l(tn).orderGoodsNm||"-"),Se(Xa,`: ${l(tn).estimateNo??""}`),Se(Si,l(tn).ex1||"-"),Se(nt,l(tn).receiverName||l(tn).memNm||"-"),Se(Tr,l(tn).receiverCellPhone||"-"),Se(Wo,is),ws.disabled=l(O)&&l(D)===l(tn).estimateNo},[()=>`odz-badge ${$e(l(tn).state)}`,()=>Me(l(tn).state),()=>Y(l(tn).regDt),()=>j(l(tn).totalPrice)],at),U(Jn,fa)}),U(qn,Go)};ve(Ai,qn=>{l(a).length===0?qn(qs):qn(ji,!1)})}Ne(()=>Se(zi,`${l(a).length??""}`)),At("focus",en,qn=>qn.currentTarget.removeAttribute("readonly")),Cr(en,()=>l(E),qn=>_(E,qn)),U(Sr,Xr)};ve(Br,Sr=>{l(Ce).length===0?Sr(gn):Sr(Dn,!1)},!0)}U(yt,rr)};ve(Ur,yt=>{l(ze)?yt(Or):yt(Yn,!1)},!0)}U(fr,ir)};ve(qt,fr=>{l(ne)?fr(Kt):fr(kr,!1)})}U(Ve,wt)};ve(Kr,Ve=>{!l(H)&&l(te)==="previous"&&Ve(xr)})}var Pr=x(Ye,2);{var Hr=Ve=>{var wt=kt(),qt=it(wt);V4(qt,()=>l(v),Kt=>{p7(Kt,{get estimateId(){return l(v)},get isOpen(){return l(p)},set isOpen(kr){_(p,kr)},$$legacy:!0})}),U(Ve,wt)};ve(Pr,Ve=>{l(v)&&Ve(Hr)})}var cn=x(Pr,2),pn=g(cn),Wr=x(g(pn),4),wr=x(g(Wr),2);wr.__keydown=[jR,He];var En=x(wr,2);{var Do=Ve=>{var wt=RR(),qt=g(wt),Kt=g(qt);Ne(()=>Se(Kt,l(J))),U(Ve,wt)};ve(En,Ve=>{l(J)&&Ve(Do)})}var wo=x(Wr,2),yo=g(wo);yo.__click=je;var vs=x(yo,2);vs.__click=He;var io=x(pn,2);io.__click=je;var No=x(cn,2);{var Rn=Ve=>{var wt=qR();U(Ve,wt)};ve(No,Ve=>{l(se)&&Ve(Rn)})}Ne(()=>{Dr(cn,`odz-modal ${(l(be)?"odz-modal-open":"")??""}`),Dr(wr,`odz-input odz-input-bordered odz-w-full ${(l(J)?"odz-input-error":"")??""}`)}),At("focus",mt,Ve=>Ve.currentTarget.removeAttribute("readonly")),Cr(mt,()=>l(w),Ve=>_(w,Ve)),Ku(_t,()=>l(C),Ve=>_(C,Ve)),Cr(wr,()=>l(L),Ve=>_(L,Ve)),U(n,Pe),dn(),r()}Fb(["click","keydown"]);var VR=$('<div class="ed-text-sm odz-text-gray-600 ed-leading-relaxed svelte-1sldu2b"> </div>'),GR=$('<div class="odz-mb-8"><h3 class="ed-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200 svelte-1sldu2b"> </h3> <div class="odz-flex odz-justify-between odz-items-start odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-p-4"><div class="odz-flex-1"><div class="ed-text-base odz-font-semibold odz-text-gray-800 odz-mb-1 svelte-1sldu2b"> </div> <!></div> <div class="ed-text-lg odz-font-bold odz-text-gray-900 odz-ml-4 svelte-1sldu2b"> </div></div></div>'),WR=$('<div class="odz-bg-white odz-border odz-border-gray-300 odz-rounded odz-px-2 odz-py-1 ed-text-xs odz-text-gray-700 svelte-1sldu2b"> </div>'),XR=$('<div class="odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-px-4 odz-py-3 odz-flex-shrink-0"><div class="ed-text-sm odz-font-semibold odz-text-gray-800 odz-mb-2 svelte-1sldu2b"> </div> <div class="odz-flex odz-flex-wrap odz-gap-1"></div></div>'),YR=$('<div class="ed-text-xs odz-text-blue-600 odz-mt-1 svelte-1sldu2b"><!></div>'),JR=$('<div class="odz-bg-blue-50 odz-border odz-border-blue-200 odz-rounded-md odz-p-3 odz-mb-3"><div class="odz-flex odz-justify-between odz-items-center odz-mb-2"><div class="odz-flex odz-items-center odz-gap-2"><svg class="odz-w-5 odz-h-5 odz-text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="odz-font-medium odz-text-blue-700">  </span></div> <div class="odz-text-right"><div class="ed-text-xs odz-text-gray-500 odz-line-through svelte-1sldu2b"> </div> <div class="ed-text-sm odz-font-semibold odz-text-red-600 svelte-1sldu2b"> </div></div></div> <!></div>'),ZR=$('<div class="odz-mb-8"><h3 class="ed-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200 svelte-1sldu2b"> </h3> <div class="odz-flex odz-flex-wrap odz-gap-3 odz-mb-4"></div> <div class="ed-text-sm odz-text-gray-600 odz-mb-2 odz-text-right svelte-1sldu2b"> </div> <!> <div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-100 odz-border odz-border-gray-200 odz-rounded-md odz-p-3"><span class="odz-font-medium odz-text-gray-700"> </span> <span class="odz-font-semibold odz-text-gray-900"> </span></div></div>'),e9=$('<span class="odz-w-6 odz-h-6 odz-rounded-full odz-border-2 odz-border-white odz-shadow-sm"></span>'),t9=$('<div class="odz-bg-gray-50 odz-rounded-lg odz-p-4"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3"><svg class="odz-w-4 odz-h-4 odz-text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21a4 4 0 01-4-4V5a2 2 0 012-2h4a2 2 0 012 2v12a4 4 0 01-4 4zM21 5a2 2 0 00-2-2h-4a2 2 0 00-2 2v12a4 4 0 004 4h4a2 2 0 002-2V5z"></path></svg> <span class="ed-text-sm odz-font-medium odz-text-gray-700 svelte-1sldu2b"> </span></div> <div class="odz-flex odz-items-center odz-gap-3"><div class="odz-flex odz-gap-1"></div> <div class="ed-text-sm odz-text-gray-800 svelte-1sldu2b"> </div></div></div>'),r9=$('<div class="odz-bg-white odz-border odz-border-gray-100 odz-rounded-xl odz-p-5 odz-shadow-sm odz-hover:shadow-md odz-transition-all odz-duration-200"><div class="odz-flex odz-items-center odz-justify-between odz-mb-4"><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-w-8 odz-h-8 odz-bg-blue-100 odz-text-blue-600 odz-rounded-full odz-flex odz-items-center odz-justify-center ed-text-sm odz-font-semibold svelte-1sldu2b"></div> <span class="odz-font-medium odz-text-gray-900"> </span></div> <div class="odz-text-right"><div class="ed-text-lg odz-font-bold odz-text-gray-900 svelte-1sldu2b"> </div></div></div> <div class="odz-grid odz-grid-cols-1 odz-gap-4"><!> <div class="odz-bg-gray-50 odz-rounded-lg odz-p-4"><div class="odz-flex odz-items-center odz-gap-2 odz-mb-3"><svg class="odz-w-4 odz-h-4 odz-text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg> <span class="ed-text-sm odz-font-medium odz-text-gray-700 svelte-1sldu2b"> </span></div> <div class="ed-text-sm odz-text-gray-800 ed-leading-relaxed svelte-1sldu2b"> </div></div></div></div>'),n9=$('<div class="odz-mb-8"><h3 class="ed-text-xl odz-font-semibold odz-text-gray-800 odz-mb-6 svelte-1sldu2b"> </h3> <div class="odz-space-y-4"></div></div>'),o9=$('<span class="odz-text-gray-600"> </span>'),s9=$('<div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-lg odz-p-4"><div class="odz-flex-1"><div class="odz-font-medium odz-text-gray-800 odz-mb-1"> <!></div> <div class="ed-text-sm odz-text-gray-600 svelte-1sldu2b"> </div></div> <div class="odz-font-semibold odz-text-gray-900"> </div></div>'),i9=$('<div class="odz-mb-8"><h3 class="ed-text-xl odz-font-semibold odz-text-gray-800 odz-mb-4 odz-pb-2 odz-border-b-2 odz-border-gray-200 svelte-1sldu2b"> </h3> <div class="odz-flex odz-flex-col odz-gap-3 odz-mb-4"></div> <div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-100 odz-border odz-border-gray-200 odz-rounded-md odz-p-3"><span class="odz-font-medium odz-text-gray-700"> </span> <span class="odz-font-semibold odz-text-gray-900"> </span></div></div>'),a9=$("<!> <!> <!>",1),A9=$('<div class="odz-fixed odz-inset-0 odz-z-50 odz-flex odz-items-center odz-justify-center odz-p-4 odz-animate-in odz-fade-in odz-duration-300 ed-root svelte-1sldu2b"><div class="odz-fixed odz-inset-0 odz-bg-black odz-bg-opacity-60 odz-backdrop-blur-sm odz-cursor-pointer"></div> <div class="odz-relative odz-bg-white odz-rounded-xl odz-shadow-2xl odz-max-w-2xl odz-max-h-[90vh] odz-w-full odz-overflow-hidden odz-flex odz-flex-col odz-animate-in odz-zoom-in-95 odz-slide-in-from-bottom-4 odz-duration-300 odz-cursor-default"><div class="odz-flex odz-justify-between odz-items-center odz-p-6 odz-border-b odz-border-gray-200 odz-bg-gradient-to-r odz-from-slate-50 odz-to-slate-100 odz-sticky odz-top-0 odz-z-10"><h2 class="ed-text-2xl odz-font-bold odz-text-gray-900 svelte-1sldu2b">  </h2> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-hover:odz-bg-gray-100 odz-transition-all odz-duration-200"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg></button></div> <div class="odz-flex-1 odz-overflow-y-auto odz-p-6"><!> <div class="odz-border-t-2 odz-border-gray-200 odz-pt-6 odz-mt-6"><div class="odz-flex odz-justify-between odz-items-center odz-bg-gray-900 odz-rounded-lg odz-p-4"><span class="ed-text-lg odz-font-semibold odz-text-white svelte-1sldu2b"> </span> <span class="ed-text-2xl odz-font-bold odz-text-white svelte-1sldu2b"> </span></div></div></div></div></div>');function l9(n,e){ln(e,!1);let t=ht(e,"estimateDetails",8),r=ht(e,"productAmount",8);ht(e,"printAmount",8);let o=ht(e,"addonAmount",8),s=ht(e,"totalAmount",8),i=ht(e,"printInfoList",8),a=ht(e,"addonItems",8),A=ht(e,"addCostItems",8,null),d=ht(e,"isAddCost",8,!1),c=ht(e,"addonProductsMap",24,()=>({}));const u=dg();let h=Be([]);function p(){if(!t()||!t().items||t().items.length===0)return;const pe=new Map;t().items.forEach(Ce=>{const ze=(Ce.variant||{}).title||Ce.variant_title||" ",z=ze.match(/(.+)\s*-\s*(.+)/),E=z?z[1]:ze,F=z?z[2]:"";pe.has(E)||pe.set(E,{name:E,sizes:new Map});const I=pe.get(E);I.sizes.has(F)||I.sizes.set(F,{size:F,quantity:0});const O=I.sizes.get(F);O.quantity+=Ce.quantity||1}),_(h,Array.from(pe.values()).map(Ce=>({name:Ce.name,sizes:Array.from(Ce.sizes.values())}))),_(h,l(h).filter(Ce=>Ce.name!==""));const te=new Set;l(h).forEach(Ce=>{Ce.sizes.forEach(ne=>{te.add(ne.size)})}),Array.from(te)}function v(pe){return`background-color: ${pe.hex};`}function w(pe,te){const Ce=[];if(pe&&Ce.push(`: ${pe}`),te&&te.length>0){const ne=te.map(ze=>ze.name).join(" > ");Ce.push(`: ${ne}`)}return Ce.length>0?Ce.join(" | "):" "}function y(){return A()&&A().amount||0}function B(){u("close")}Yt(()=>oo(t()),()=>{t()&&p()}),mo(),fn();var C=A9(),Q=g(C),k=x(Q,2),H=g(k),Z=x(g(H),2),q=x(H,2),N=g(q);{var re=pe=>{var te=GR(),Ce=x(g(te),2),ne=g(Ce),ze=g(ne),z=g(ze),E=x(ze,2);{var F=D=>{var P=VR(),K=g(P);Ne(()=>Se(K,A().description)),U(D,P)};ve(E,D=>{A().description&&D(F)})}var I=x(ne,2),O=g(I);Ne(D=>{Se(z,A().name),Se(O,`${D??""}`)},[()=>A().amount.toLocaleString()],at),U(pe,te)},be=pe=>{var te=kt(),Ce=it(te);{var ne=ze=>{var z=a9(),E=it(z);{var F=K=>{var M=ZR(),ge=x(g(M),2);tr(ge,5,()=>l(h),mr,(ue,me)=>{var ye=XR(),Ee=g(ye),de=g(Ee),Qe=x(Ee,2);tr(Qe,5,()=>l(me).sizes,mr,(Fe,Oe)=>{var Te=WR(),De=g(Te);Ne(()=>Se(De,`${l(Oe).size??""}: ${l(Oe).quantity??""}`)),U(Fe,Te)}),Ne(()=>Se(de,l(me).name)),U(ue,ye)});var _e=x(ge,2),Me=g(_e),$e=x(_e,2);{var Y=ue=>{var me=JR();const ye=at(()=>t().items.reduce((V,G)=>V+(G.discount_amount||0)*(G.quantity||0),0)),Ee=at(()=>t().items.find(V=>V.discount_amount&&V.discount_amount>0));var de=g(me),Qe=x(g(de),2),Fe=g(Qe),Oe=g(Fe),Te=x(Fe,2),De=g(Te),ce=x(de,2);{var Ie=V=>{var G=YR(),le=g(G);{var Le=je=>{var xe=bn();Ne(Re=>Se(xe,`${l(Ee).discount_value??""}%  ( ${Re??""})`),[()=>(l(Ee).discount_amount||0).toLocaleString()],at),U(je,xe)},He=je=>{var xe=bn();Ne(Re=>Se(xe,` ${Re??""} `),[()=>l(Ee).discount_value.toLocaleString()],at),U(je,xe)};ve(le,je=>{l(Ee).discount_type==="percentage"?je(Le):je(He,!1)})}U(V,G)};ve(ce,V=>{l(Ee)&&l(Ee).discount_type&&l(Ee).discount_value&&V(Ie)})}Ne((V,G)=>{Se(Oe,`${V??""}`),Se(De,`-${G??""}`)},[()=>t().items.reduce((V,G)=>V+(G.original_price||G.price||0)*(G.quantity||0),0).toLocaleString(),()=>l(ye).toLocaleString()],at),U(ue,me)};ve($e,ue=>{t().items&&t().items.some(me=>me.discount_amount&&me.discount_amount>0)&&ue(Y)})}var j=x($e,2),ee=x(g(j),2),ae=g(ee);Ne((ue,me)=>{Se(Me,` : ${ue??""}`),Se(ae,`${me??""}`)},[()=>l(h).reduce((ue,me)=>ue+me.sizes.reduce((ye,Ee)=>ye+Ee.quantity,0),0),()=>r().toLocaleString()],at),U(K,M)};ve(E,K=>{l(h).length>0&&K(F)})}var I=x(E,2);{var O=K=>{var M=n9(),ge=x(g(M),2);tr(ge,5,i,mr,(_e,Me,$e)=>{var Y=r9(),j=g(Y),ee=g(j),ae=g(ee);ae.textContent=$e+1;var ue=x(ee,2),me=g(ue),ye=g(me),Ee=x(j,2),de=g(Ee);{var Qe=De=>{var ce=t9(),Ie=x(g(ce),2),V=g(Ie);tr(V,5,()=>l(Me).colorInfo,mr,(Le,He)=>{var je=e9();Ne(xe=>{cr(je,"style",xe),cr(je,"title",l(He).name)},[()=>v(l(He))],at),U(Le,je)});var G=x(V,2),le=g(G);Ne(Le=>Se(le,Le),[()=>l(Me).colorInfo.map(Le=>Le.name).join(", ")],at),U(De,ce)};ve(de,De=>{l(Me).colorInfo&&l(Me).colorInfo.length>0&&De(Qe)})}var Fe=x(de,2),Oe=x(g(Fe),2),Te=g(Oe);Ne((De,ce)=>{Se(ye,`${De??""}`),Se(Te,ce)},[()=>l(Me).price.toLocaleString(),()=>w(l(Me).printAreaTitle,l(Me).parentTemplates)],at),U(_e,Y)}),U(K,M)};ve(I,K=>{i().length>0&&K(O)})}var D=x(I,2);{var P=K=>{var M=i9(),ge=x(g(M),2);tr(ge,5,a,mr,(Y,j)=>{var ee=s9();const ae=at(()=>`${l(j).selected_product_id}_${l(j).selected_variant_id}`),ue=at(()=>c()[l(ae)]);var me=g(ee),ye=g(me),Ee=g(ye),de=x(Ee);{var Qe=ce=>{var Ie=o9(),V=g(Ie);Ne(()=>Se(V,`- ${l(ue).variantTitle??""}`)),U(ce,Ie)};ve(de,ce=>{var Ie;(Ie=l(ue))!=null&&Ie.variantTitle&&ce(Qe)})}var Fe=x(ye,2),Oe=g(Fe),Te=x(me,2),De=g(Te);Ne(ce=>{var Ie;Se(Ee,`${((Ie=l(ue))==null?void 0:Ie.productTitle)||""} `),Se(Oe,`${l(j).quantity??""}`),Se(De,`${ce??""}`)},[()=>(l(j).price*l(j).quantity).toLocaleString()],at),U(Y,ee)});var _e=x(ge,2),Me=x(g(_e),2),$e=g(Me);Ne(Y=>Se($e,`${Y??""}`),[()=>o().toLocaleString()],at),U(K,M)};ve(D,K=>{a().length>0&&K(P)})}U(ze,z)};ve(Ce,ze=>{t()&&t().estimate&&ze(ne)},!0)}U(pe,te)};ve(N,pe=>{d()&&A()?pe(re):pe(be,!1)})}var L=x(N,2),R=g(L),J=g(R),se=g(J),fe=x(J,2),ie=g(fe);Ne(pe=>{Se(se,d()?" ":" "),Se(ie,`${pe??""}`)},[()=>d()?y().toLocaleString():s().toLocaleString()],at),At("click",Q,B),At("click",Z,B),U(n,C),dn()}var d9=$('<p class="odiz-loading"> ...</p>'),c9=$('<p class="odiz-error"> </p>'),u9=$('<div class="odiz-addcost-description"> </div>'),h9=$('<div class="odiz-addcost-detailed"><div class="odiz-addcost-header"><h3 class="odiz-addcost-title"> </h3></div> <div class="odiz-addcost-items"><div class="odiz-addcost-item"><div class="odiz-addcost-info"><div class="odiz-addcost-name"> </div> <!></div> <div class="odiz-addcost-amount"> </div></div></div> <div class="odiz-divider"></div> <div class="odiz-total-price"><div class="odiz-price-label"> </div> <div class="odiz-price-value odiz-total-value"> </div></div></div>'),f9=$('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value"><!></span></div>'),p9=$('<span class="odz-color-dot-compact"></span>'),g9=$('<span class="odz-color-count"> </span>'),v9=$('<span class="odz-color-dots-compact"><!> <!></span>'),m9=$('<span class="odz-print-area-compact"> </span>'),w9=$("<!> <!>",1),y9=$('<span class="odz-print-count"> </span>'),_9=$('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value odz-print-inline"><!> <!></span></div>'),b9=$('<div class="odz-info-row"><span class="odz-label"></span> <span class="odz-value"> </span></div>'),x9=$('<button class="odz-detail-btn odz-estimate-mgmt-btn" type="button"> </button>'),B9=$('<div class="odiz-estimate-detailed"><div class="odz-estimate-summary"><div class="odz-summary-content"><!> <!> <!></div> <div class="odz-summary-actions"><button class="odz-detail-btn" type="button">  </button> <!></div></div> <div class="odz-price-summary"><div class="odz-price-label"></div> <div class="odz-price-value"><span class="odz-text-lg odz-font-bold"> </span></div></div></div>'),z9=$('<p class="odiz-empty">  .</p>'),C9=$('<div class="odiz-estimate-preview odz-estimate-preview-root"><!></div> <!>',1);function S9(n,e){ln(e,!1);let t=ht(e,"uuid",8),r=ht(e,"idx",8),o=ht(e,"appType",8),s=ht(e,"isAddCost",8),i=Be(!0),a=Be(null),A=Be(null),d=Be(0),c=Be(0),u=Be(0),h=Be(0),p=Be([]),v=Be([]),w=Be(null),y=Be({}),B=Be([]),C=Be(!1);async function Q(){var te,Ce;_(y,{});for(const ne of l(v)){const ze=`${ne.selected_product_id}_${ne.selected_variant_id}`;if(!l(y)[ze])try{if(ne.selected_variant_id){const z=await hl(ne.selected_variant_id);if(z){const{data:E}=await ft.from("products").select("id, title").eq("id",ne.selected_product_id).single();br(y,l(y)[ze]={productTitle:(E==null?void 0:E.title)||"",variantTitle:z.title||"",price:((Ce=(te=z.prices)==null?void 0:te[0])==null?void 0:Ce.amount)||0})}}else{const{data:z}=await ft.from("products").select("id, title").eq("id",ne.selected_product_id).single();br(y,l(y)[ze]={productTitle:(z==null?void 0:z.title)||"",variantTitle:null,price:ne.price||0})}}catch{br(y,l(y)[ze]={productTitle:"",variantTitle:null,price:ne.price||0})}}}async function k(){try{_(i,!0),_(a,null),_(A,await v1(t()));const te=await hg(t());if(s()&&(_(w,await y5(r())),console.log("addCostItems",l(w))),l(A)){br(A,l(A).items=l(A).items.filter(ne=>{var ze;return((ze=ne.idx)==null?void 0:ze.toString())===r()}));const Ce=l(A).prints.filter(ne=>{var ze;return((ze=ne.idx)==null?void 0:ze.toString())===r()});br(A,l(A).prints=l(A).prints.filter(ne=>{var ze;return((ze=ne.idx)==null?void 0:ze.toString())===r()})),_(v,te.filter(ne=>{var ze;return((ze=ne.idx)==null?void 0:ze.toString())===r()})),await Q(),Z(),H(),_(p,[]);for(const ne of Ce){const ze={id:ne.id||0,price:ne.price||0,templateId:ne.template_id,objectId:ne.object_id,colorInfo:[]};try{if(ne.template_id&&(console.log("template_id:",ne.template_id),ze.parentTemplates=await ud(ne.template_id),console.log("template_id   :",ze.parentTemplates)),ne.object_id){console.log("object_id:",ne.object_id);const z=await fg(ne.object_id);z&&(ze.printAreaTitle=z.title,console.log(" :",z.title))}}catch(z){console.error("    :",z)}if(ne.colors)try{let z=null;if(typeof ne.colors=="string"?z=JSON.parse(ne.colors):z=ne.colors,Array.isArray(z)){let E=[];if(z.length>0&&Array.isArray(z[0]))for(const F of z)Array.isArray(F)&&(E=E.concat(F));else E=z;E.length>0&&(typeof E[0]=="object"&&E[0]!==null?ze.colorInfo=E:ze.colorInfo=E.map(F=>({hex:F,name:F})))}console.log("  :",ze.colorInfo)}catch(z){console.error("    :",z)}l(p).push(ze)}console.log("   :",l(p))}}catch(te){console.error("    :",te),_(a,"     .")}finally{_(i,!1)}}function H(){if(!l(A)||!l(A).items||l(A).items.length===0)return;const te=new Map;l(A).items.forEach(ne=>{const z=(ne.variant||{}).title||ne.variant_title||" ",E=z.match(/(.+)\s*-\s*(.+)/),F=E?E[1]:z,I=E?E[2]:"";te.has(F)||te.set(F,{name:F,sizes:new Map});const O=te.get(F);O.sizes.has(I)||O.sizes.set(I,{size:I,quantity:0});const D=O.sizes.get(I);D.quantity+=ne.quantity||1}),_(B,Array.from(te.values()).map(ne=>({name:ne.name,sizes:Array.from(ne.sizes.values())}))),_(B,l(B).filter(ne=>ne.name!==""));const Ce=new Set;l(B).forEach(ne=>{ne.sizes.forEach(ze=>{Ce.add(ze.size)})}),Array.from(Ce)}function Z(){if(l(A)){_(d,0),_(c,0),_(u,0);for(const te of l(A).items)te.quantity&&te.price&&_(d,l(d)+te.quantity*te.price);for(const te of l(A).prints)te.price&&_(c,l(c)+te.price);for(const te of l(v))te.price&&te.quantity&&_(u,l(u)+te.price*te.quantity);_(h,l(d)+l(c)+l(u))}}function q(){return l(w)&&l(w).amount||0}to(()=>{k()});function N(){window.open(`https://odiz.vercel.app/dashboard/estimates/${t()}`,"_blank")}function re(){_(C,!0)}function be(){_(C,!1)}fn();var L=C9(),R=it(L),J=g(R);{var se=te=>{var Ce=d9();U(te,Ce)},fe=te=>{var Ce=kt(),ne=it(Ce);{var ze=E=>{var F=c9(),I=g(F);Ne(()=>Se(I,l(a))),U(E,F)},z=E=>{var F=kt(),I=it(F);{var O=P=>{var K=h9(),M=x(g(K),2),ge=g(M),_e=g(ge),Me=g(_e),$e=g(Me),Y=x(Me,2);{var j=Ee=>{var de=u9(),Qe=g(de);Ne(()=>Se(Qe,l(w).description)),U(Ee,de)};ve(Y,Ee=>{l(w).description&&Ee(j)})}var ee=x(_e,2),ae=g(ee),ue=x(M,4),me=x(g(ue),2),ye=g(me);Ne((Ee,de)=>{Se($e,l(w).name),Se(ae,`${Ee??""}`),Se(ye,`${de??""}`)},[()=>l(w).amount.toLocaleString(),()=>q().toLocaleString()],at),U(P,K)},D=P=>{var K=kt(),M=it(K);{var ge=Me=>{var $e=B9(),Y=g($e),j=g(Y),ee=g(j);{var ae=V=>{var G=f9(),le=x(g(G),2),Le=g(le);{var He=xe=>{var Re=bn();Ne(et=>Se(Re,`${l(B)[0].name??""} (${et??""})`),[()=>l(B).reduce((et,qe)=>et+qe.sizes.reduce((ot,Pe)=>ot+Pe.quantity,0),0)],at),U(xe,Re)},je=xe=>{var Re=bn();Ne(et=>Se(Re,`${l(B)[0].name??""}  ${l(B).length-1} (${et??""})`),[()=>l(B).reduce((et,qe)=>et+qe.sizes.reduce((ot,Pe)=>ot+Pe.quantity,0),0)],at),U(xe,Re)};ve(Le,xe=>{l(B).length===1?xe(He):xe(je,!1)})}U(V,G)};ve(ee,V=>{l(B).length>0&&V(ae)})}var ue=x(ee,2);{var me=V=>{var G=_9(),le=x(g(G),2),Le=g(le);tr(Le,1,()=>l(p).slice(0,1),mr,(xe,Re)=>{var et=w9(),qe=it(et);{var ot=rt=>{var lt=v9(),vt=g(lt);tr(vt,1,()=>l(Re).colorInfo.slice(0,3),mr,(Et,mt)=>{var Gt=p9();Ne(()=>{cr(Gt,"style",`background-color: ${l(mt).hex??""};`),cr(Gt,"title",l(mt).name)}),U(Et,Gt)});var Ft=x(vt,2);{var Qt=Et=>{var mt=g9(),Gt=g(mt);Ne(()=>Se(Gt,`+${l(Re).colorInfo.length-3}`)),U(Et,mt)};ve(Ft,Et=>{l(Re).colorInfo.length>3&&Et(Qt)})}U(rt,lt)};ve(qe,rt=>{l(Re).colorInfo&&l(Re).colorInfo.length>0&&rt(ot)})}var Pe=x(qe,2);{var Ye=rt=>{var lt=m9(),vt=g(lt);Ne(()=>Se(vt,l(Re).printAreaTitle)),U(rt,lt)};ve(Pe,rt=>{l(Re).printAreaTitle&&rt(Ye)})}U(xe,et)});var He=x(Le,2);{var je=xe=>{var Re=y9(),et=g(Re);Ne(()=>Se(et,` ${l(p).length-1}`)),U(xe,Re)};ve(He,xe=>{l(p).length>1&&xe(je)})}U(V,G)};ve(ue,V=>{l(p).length>0&&V(me)})}var ye=x(ue,2);{var Ee=V=>{var G=b9(),le=x(g(G),2),Le=g(le);Ne(()=>Se(Le,`${l(v).length??""}`)),U(V,G)};ve(ye,V=>{l(v).length>0&&V(Ee)})}var de=x(j,2),Qe=g(de),Fe=x(Qe,2);{var Oe=V=>{var G=x9();At("click",G,N),U(V,G)};ve(Fe,V=>{o()==="admin"&&V(Oe)})}var Te=x(Y,2),De=x(g(Te),2),ce=g(De),Ie=g(ce);Ne(V=>Se(Ie,`${V??""}`),[()=>l(h).toLocaleString()],at),At("click",Qe,re),U(Me,$e)},_e=Me=>{var $e=z9();U(Me,$e)};ve(M,Me=>{l(A)&&l(A).estimate?Me(ge):Me(_e,!1)},!0)}U(P,K)};ve(I,P=>{s()&&l(w)?P(O):P(D,!1)},!0)}U(E,F)};ve(ne,E=>{l(a)?E(ze):E(z,!1)},!0)}U(te,Ce)};ve(J,te=>{l(i)?te(se):te(fe,!1)})}var ie=x(R,2);{var pe=te=>{l9(te,{get estimateDetails(){return l(A)},get productAmount(){return l(d)},get printAmount(){return l(c)},get addonAmount(){return l(u)},get totalAmount(){return l(h)},get printInfoList(){return l(p)},get addonItems(){return l(v)},get addCostItems(){return l(w)},get isAddCost(){return s()},get addonProductsMap(){return l(y)},$$events:{close:be}})};ve(ie,te=>{l(C)&&l(A)&&te(pe)})}U(n,L),dn()}var E9=$('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),F9=$('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div> <button class="odz-mt-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-px-4 odz-py-2 odz-rounded-lg odz-text-sm"> </button></div>'),I9=$('<span class="odz-text-red-500 odz-ml-2"> </span>'),U9=$('<div class="odz-text-sm odz-text-gray-600"> <!></div>'),Q9=$('<div class="odz-absolute -odz-top-1 -odz-right-1 odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path></svg></div>'),T9=$("<img> <!>",1),L9=$('<div class="odz-flex odz-items-center odz-gap-1 odz-bg-red-100 odz-px-2 odz-py-1 odz-rounded-full"><span class="odz-text-xs odz-font-medium odz-text-red-600"> </span></div>'),P9=$('<button><div class="odz-flex odz-items-center odz-gap-3"><div class="odz-relative odz-flex-shrink-0"><!></div> <span> </span> <div class="odz-flex odz-items-center odz-gap-2 odz-flex-shrink-0"><!> <div><svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 18 6-6-6-6"></path></svg></div></div></div></button>'),k9=$('<div><h3 class="odz-font-bold odz-text-lg odz-mb-4 odz-text-gray-800"> </h3> <div class="odz-grid odz-grid-cols-1 sm:odz-grid-cols-2 lg:odz-grid-cols-4 xl:odz-grid-cols-5 odz-gap-3"></div></div>'),O9=$('<div class="odz-relative"><img class="odz-w-12 odz-h-12 odz-rounded-lg odz-object-cover odz-shadow-md odz-ring-2 odz-ring-white"></div>'),D9=$('<div class="odz-absolute -odz-top-2 -odz-right-2"><div class="odz-w-5 odz-h-5 odz-bg-red-500 odz-rounded-full odz-flex odz-items-center odz-justify-center odz-shadow-lg"><svg class="odz-w-3 odz-h-3 odz-text-white" fill="currentColor" viewBox="0 0 20 20"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg></div></div>'),N9=$('<span class="odz-text-sm odz-font-semibold odz-text-gray-700"> </span>'),M9=$(`<div class="odz-group odz-relative"><div><!> <div class="odz-text-center odz-mb-3"><div> </div> <div class="odz-mt-2 odz-min-h-[2rem] odz-flex odz-flex-col odz-items-center odz-justify-center"><!></div></div> <div class="odz-flex odz-items-center odz-bg-gray-50 odz-rounded-lg odz-p-1 odz-gap-1"><button aria-label=" "><svg class="odz-w-3 odz-h-3 sm:odz-w-4 sm:odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg></button> <input type="number" class="odz-flex-1 odz-text-center odz-bg-transparent odz-border-0 odz-text-xs sm:odz-text-sm odz-font-bold odz-text-gray-800
                                                           focus:odz-outline-none focus:odz-ring-0 odz-min-w-0" min="0" placeholder="0"> <button class="odz-flex odz-items-center odz-justify-center odz-w-7 odz-h-7 sm:odz-w-8 sm:odz-h-8 odz-bg-white odz-rounded-md odz-shadow-sm
                                                           odz-text-gray-600 hover:odz-text-red-500 hover:odz-bg-red-50 odz-transition-colors odz-duration-150 hover:odz-scale-110" aria-label=" "><svg class="odz-w-3 odz-h-3 sm:odz-w-4 sm:odz-h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v12m6-6H6"></path></svg></button></div></div></div>`),H9=$('<div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-3 md:odz-grid-cols-4 lg:odz-grid-cols-5 odz-gap-3"></div>'),j9=$('<div class="odz-text-center odz-py-8"><svg class="odz-w-12 odz-h-12 odz-text-gray-400 odz-mx-auto odz-mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg> <p class="odz-text-sm odz-text-gray-500">     .</p></div>'),R9=$('<div class="odz-bg-gradient-to-br odz-from-gray-50 odz-to-gray-100 odz-border-2 odz-border-gray-200 odz-rounded-2xl odz-p-6 odz-shadow-sm"><div class="odz-flex odz-items-center odz-gap-4 odz-mb-6"><!> <div><h4 class="odz-text-xl odz-font-bold odz-text-gray-800"> </h4> <p class="odz-text-sm odz-text-gray-600">  </p></div></div> <!></div>'),q9=$('<div class="odz-space-y-6 odz-mt-6"></div>'),K9=$('<div class="odz-card odz-card-side odz-bg-base-100 odz-border odz-rounded odz-p-3"><figure><img class="odz-max-h-24 odz-border"></figure> <div class="odz-card-body"><h2 class="odz-card-title odz-text-base"> </h2> <!></div></div> <!> <!> <!>',1),$9=$('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><!></div> <!>',1);function V9(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gr,"$fixedEstimateStore",t),s=()=>an(gt,"$estimateStore",t),i=()=>an(ni,"$shopStore",t),a=Be();let A=ht(e,"productId",8),d=ht(e,"estimateId",8,void 0),c=ht(e,"idx",8,void 0),u=ht(e,"onNext",8,void 0),h=Be(null),p=Be(!1),v=Be(null),w=Be(!1),y=Be(""),B=Be(""),C=Be([]),Q=Be({}),k=Be({}),H=Be({}),Z=Be(0),q=Be(0),N=null;function re(M){var ee,ae,ue,me,ye,Ee;if(!l(a)||!l(a).variants||!l(a).options||l(a).options.length===0)return;const ge=o();if((ae=(ee=ge==null?void 0:ge.productSelection)==null?void 0:ee.quantityByVariant)!=null&&ae[M]&&Object.keys(ge.productSelection.quantityByVariant[M]).length>0,(((me=(ue=ge==null?void 0:ge.productSelection)==null?void 0:ue.quantityByVariant)==null?void 0:me[M])!==void 0||l(C).includes(M))&&d()&&d()!=="temp"){if(l(C).includes(M)){_(C,l(C).filter(Fe=>Fe!==M));const de={...l(k)};delete de[M],_(k,de);const Qe={...l(Q)};Qe[M]&&Object.keys(Qe[M]).forEach(Fe=>{Qe[M][Fe]=0}),_(Q,Qe),gr.update(Fe=>{if(!Fe||!Fe.productSelection)return Fe;const Oe={...Fe.productSelection.quantityByVariant};Oe[M]&&Object.keys(Oe[M]).forEach(De=>{Oe[M][De]=0});const Te=Object.values(Oe).reduce((De,ce)=>De+Object.values(ce).reduce((Ie,V)=>Ie+V,0),0);return{...Fe,productSelection:{...Fe.productSelection,selectedColors:l(C),variantsByColor:de,quantityByVariant:Oe,totalQuantity:Te}}}),pe(),Ia(q);return}if(!l(C).includes(M)){const de=l(a).options[0].id,Qe=l(a).variants.filter(Fe=>{var Oe;return!Fe.option_values||!Array.isArray(Fe.option_values)?!1:(Oe=Fe.option_values)==null?void 0:Oe.some(Te=>Te.option_value&&Te.option_value.option?Te.option_value.option.id===de&&Te.option_value.value===M:Te.option_id?Te.option_id===de&&Te.value===M:!1)});Qe.length>0&&(_(k,{...l(k),[M]:Qe}),_(C,[...l(C),M]),gr.update(Fe=>!Fe||!Fe.productSelection?Fe:{...Fe,productSelection:{...Fe.productSelection,selectedColors:[...Fe.productSelection.selectedColors,M],variantsByColor:{...Fe.productSelection.variantsByColor,[M]:Qe},quantityByVariant:{...Fe.productSelection.quantityByVariant,[M]:Fe.productSelection.quantityByVariant[M]||{}}}}),Ia(q))}return}const Me=l(a).options[0].id,$e=l(a).variants.filter(de=>{var Qe;return!de.option_values||!Array.isArray(de.option_values)?!1:(Qe=de.option_values)==null?void 0:Qe.some(Fe=>Fe.option_value&&Fe.option_value.option?Fe.option_value.option.id===Me&&Fe.option_value.value===M:Fe.option_id?Fe.option_id===Me&&Fe.value===M:!1)}),Y={...l(k)};if($e.length>0&&(Y[M]=$e),d()&&d()!=="temp"){const de=o();((Ee=(ye=de==null?void 0:de.productSelection)==null?void 0:ye.selectedColors)==null?void 0:Ee.includes(M))?(_(k,{...l(k),...Y}),gr.update(Fe=>!Fe||!Fe.productSelection?Fe:{...Fe,productSelection:{...Fe.productSelection,variantsByColor:{...Fe.productSelection.variantsByColor,...Y}}})):(l(C).includes(M)||_(C,[...l(C),M]),_(k,{...l(k),...Y}),gr.update(Fe=>{var Ie,V,G,le,Le;if(!Fe||!Fe.productSelection)return Fe;const Oe=Object.keys(Fe.productSelection.quantityByVariant||{}),Te=new Set([...Oe,M]),De=Array.from(Te),ce={...((Ie=Fe.productSelection)==null?void 0:Ie.variantsByColor)||{},...Y};return console.log(" Edit :   (  ):",{colorValue:M,colorsWithQuantity:Oe,newSelectedColors:De,variantsInColor:((V=Y[M])==null?void 0:V.length)||0,quantityByVariant:Fe.productSelection.quantityByVariant}),{...Fe,productSelection:{...Fe.productSelection,selectedColors:De,variantsByColor:ce,quantityByVariant:{...((G=Fe.productSelection)==null?void 0:G.quantityByVariant)||{},[M]:((Le=(le=Fe.productSelection)==null?void 0:le.quantityByVariant)==null?void 0:Le[M])||{}}}}}))}else gr.toggleColorSelection(M,Y)}function be(M){var Me;if(!l(a)||l(a).options.length<2||!M||!M.option_values||!Array.isArray(M.option_values))return"";const ge=l(a).options[1].id,_e=M.option_values.find($e=>$e.option_value&&$e.option_value.option?$e.option_value.option.id===ge:$e.option_id?$e.option_id===ge:!1);return((Me=_e==null?void 0:_e.option_value)==null?void 0:Me.value)||(_e==null?void 0:_e.value)||""}function L(M,ge){var $e;const _e=(($e=l(Q)[M])==null?void 0:$e[ge])||0,Me=_e+1;gr.updateQuantity(M,ge,Me),se("increase",M,ge,_e,Me)}function R(M,ge){var Me;const _e=((Me=l(Q)[M])==null?void 0:Me[ge])||0;if(_e>0){const $e=_e-1;gr.updateQuantity(M,ge,$e),se("decrease",M,ge,_e,$e)}}function J(M,ge,_e){var j;const Me=parseInt(M.target.value)||0,$e=Math.max(0,Me),Y=((j=l(Q)[ge])==null?void 0:j[_e])||0;gr.updateQuantity(ge,_e,$e),se("input",ge,_e,Y,$e)}function se(M,ge,_e,Me,$e){var Y;if(typeof window<"u"){const j=Object.values(l(Q)).reduce((ee,ae)=>ee+Object.values(ae).reduce((ue,me)=>ue+me,0),0)-Me+$e;window.dispatchEvent(new CustomEvent("productQuantityUpdate",{detail:{productId:(Y=l(a))==null?void 0:Y.id,action:M,color:ge,variantId:_e,oldQuantity:Me,newQuantity:$e,newTotalQuantity:j,timestamp:Date.now(),source:"product.svelte"}}))}}let fe=!1,ie=!1;function pe(){const M=Object.values(l(Q)).reduce((ge,_e)=>ge+Object.values(_e).reduce((Me,$e)=>Me+$e,0),0);l(Z)!==M&&(_(Z,M),te())}function te(){var M,ge;if(!fe){fe=!0;try{const _e={};if(!((M=l(a))!=null&&M.quantity_discounts)||l(Z)===0){Object.keys(l(H)).length>0&&(_(H,{}),gr.updateVariantDiscounts({}));return}const Me=Object.keys(l(Q)),$e=Object.keys(l(k));Me.filter(ue=>!$e.includes(ue)).length>0;for(const ue in l(Q))for(const me in l(Q)[ue])if(l(Q)[ue][me]>0){const Ee=(ge=l(k)[ue])==null?void 0:ge.find(de=>de.id===me);if(Ee&&Ee.prices&&Ee.prices.length>0){const de=Ee.prices[0].amount,Qe=ia(l(Z),de,l(a).quantity_discounts);Qe!=null&&Qe.hasDiscount&&(_e[me]=Qe)}}const j=Object.keys(l(H)).sort(),ee=Object.keys(_e).sort();(JSON.stringify(j)!==JSON.stringify(ee)||Object.keys(_e).some(ue=>JSON.stringify(l(H)[ue])!==JSON.stringify(_e[ue])))&&(_(H,_e),gr.updateVariantDiscounts(l(H)))}finally{fe=!1}}}function Ce(){var Me;let M=0,ge=0,_e=!1;for(const $e in l(Q))for(const Y in l(Q)[$e]){const j=l(Q)[$e][Y];if(j>0){const ee=(Me=l(k)[$e])==null?void 0:Me.find(ae=>ae.id===Y);if(ee&&ee.prices&&ee.prices.length>0){const ae=ee.prices[0].amount,ue=l(H)[Y];M+=ae*j,ue!=null&&ue.hasDiscount?(ge+=ue.discountedPrice*j,_e=!0):ge+=ae*j}}}return{originalTotal:M,discountedTotal:_e?ge:M,hasDiscount:_e}}function ne(){if(l(Z)===0){_(w,!0),_(y," "),_(B," 1   .");return}gr.completeProductSelection();const M=[];for(const _e in l(Q))for(const Me in l(Q)[_e]){const $e=l(Q)[_e][Me];if($e>0){const Y=l(k)[_e].find(j=>j.id===Me);Y&&M.push({...Y,quantity:$e})}}const ge=s().products.findIndex(_e=>{var Me;return((Me=_e.product)==null?void 0:Me.id)===l(a).id});ge>=0?er(gt,dt(s).products[ge]={product:l(a),variants:M,quantity:l(Z),prints:[],addons:{},addonProductsMap:{}},dt(s)):er(gt,dt(s).products=[...s().products,{product:l(a),variants:M,quantity:l(Z),prints:[],addons:{},addonProductsMap:{}}],dt(s)),gt.updateTotalAmounts(),_(w,!0),_(y," "),_(B,`${l(Z)}  .`),u()&&u()()}async function ze(){var ge,_e,Me,$e,Y,j,ee,ae,ue;if(!A())return;const M=o().productSelection;if(M&&M.product&&M.productId===A()){_(p,!0),_(v,null);try{_(h,await Zd.loadIntegratedProductData(A(),i().id)),console.log(" Edit : productDataStore   ( variants ):",{productId:A(),variantsCount:((Me=(_e=(ge=l(h))==null?void 0:ge.product)==null?void 0:_e.variants)==null?void 0:Me.length)||0,hasOptionValues:(ee=(j=(Y=($e=l(h))==null?void 0:$e.product)==null?void 0:Y.variants)==null?void 0:j[0])!=null&&ee.option_values?"yes":"no"}),(ae=l(h))!=null&&ae.product&&Xn.updateProduct(A(),{product:l(h).product,addons:l(h).addons||[],addonItems:l(h).addonItems||[]})}catch(me){_(v,me instanceof Error?me.message:"   .")}finally{_(p,!1)}return}_(p,!0),_(v,null);try{if(_(h,await Zd.loadIntegratedProductData(A(),i().id)),(ue=l(h))!=null&&ue.product){Xn.updateProduct(A(),{product:l(h).product,addons:l(h).addons||[],addonItems:l(h).addonItems||[]});const me=s().products.find(ye=>{var Ee;return((Ee=ye.product)==null?void 0:Ee.id)===l(h).product.id});if(me&&me.variants.length>0){const ye={},Ee=l(h).product.options[0].id;me.variants.forEach(de=>{var Fe;if(!de||!de.option_values||!Array.isArray(de.option_values))return;const Qe=de.option_values.find(Oe=>Oe.option_value&&Oe.option_value.option?Oe.option_value.option.id===Ee:Oe.option_id?Oe.option_id===Ee:!1);if(Qe){const Oe=((Fe=Qe.option_value)==null?void 0:Fe.value)||Qe.value||"";ye[Oe]||(ye[Oe]=[]),ye[Oe].push(de)}});for(const de in ye)re(de),ye[de].forEach(Qe=>{l(Q)[de]&&br(Q,l(Q)[de][Qe.id]=Qe.quantity||0)});_(Q,{...l(Q)}),pe()}}}catch(me){_(v,me instanceof Error?me.message:"   .")}finally{_(p,!1)}}function z(){const M=o();if(!(M!=null&&M.productSelection)||!l(a))return;const ge=M.productSelection;if(_(C,[...ge.selectedColors]),_(Q,{...ge.quantityByVariant}),_(Z,ge.totalQuantity),d()&&d(),l(C).length>0&&l(a)&&l(a).variants){_(k,{});const _e=l(a).options[0].id;Object.keys(ge.quantityByVariant||{}).forEach($e=>{const Y=l(a).variants.filter(j=>{var ee;return(ee=j.option_values)==null?void 0:ee.some(ae=>ae.option_value&&ae.option_value.option?ae.option_value.option.id===_e&&ae.option_value.value===$e:ae.option_id?ae.option_id===_e&&ae.value===$e:!1)});Y.length>0&&br(k,l(k)[$e]=Y)})}_(k,{...l(k)}),Ia(q),Object.keys(l(k)).length>0&&gr.update(_e=>!_e||!_e.productSelection?_e:{..._e,productSelection:{..._e.productSelection,variantsByColor:l(k)}}),l(Z)>0&&te()}function E(){N=gr.subscribe(M=>{if(M!=null&&M.productSelection&&M.productId===A()){const ge=M.productSelection;if(!l(a)||!l(a).variants)return;if(_(C,[...ge.selectedColors]),_(Q,{...ge.quantityByVariant}),_(Z,ge.totalQuantity),Ia(q),l(a)&&l(a).variants&&l(C).length>0){d()&&d();const _e={},Me=l(a).options[0].id;if(Object.keys(ge.quantityByVariant||{}).forEach(Y=>{const j=l(a).variants.filter(ee=>{var ae;return(ae=ee.option_values)==null?void 0:ae.some(ue=>ue.option_value&&ue.option_value.option?ue.option_value.option.id===Me&&ue.option_value.value===Y:ue.option_id?ue.option_id===Me&&ue.value===Y:!1)});j.length>0&&(_e[Y]=j)}),_(k,_e),Ia(q),!ie){const Y=Object.keys(ge.variantsByColor||{}).sort(),j=Object.keys(_e).sort();if(JSON.stringify(Y)!==JSON.stringify(j)){ie=!0;try{console.log(" Store variantsByColor  ( ):",{before:Y.length,after:j.length,beforeKeys:Y,afterKeys:j}),gr.update(ae=>!ae||!ae.productSelection?ae:{...ae,productSelection:{...ae.productSelection,variantsByColor:_e}})}finally{setTimeout(()=>{ie=!1},0)}}}}else l(C).length===0&&(_(k,{}),Ia(q));ge.needsDiscountRecalculation&&l(Z)>0&&setTimeout(()=>{te()},0)}})}to(async()=>{d()&&d()!=="temp"||gr.initialize(A(),d()),E(),await ze(),z()}),gs(()=>{N&&N()}),Yt(()=>(o(),oo(A()),l(h)),()=>{var M,ge,_e;(ge=(M=o())==null?void 0:M.productSelection)!=null&&ge.product&&o().productSelection.productId===A()&&(!l(h)||((_e=l(h).product)==null?void 0:_e.id)!==o().productSelection.product.id)&&_(h,{product:o().productSelection.product,addons:o().productSelection.addons||[],addonItems:o().productSelection.addonItems||[]})}),Yt(()=>l(h),()=>{var M;_(a,((M=l(h))==null?void 0:M.product)||null)}),Yt(()=>(l(a),l(C),oo(d()),l(q)),()=>{var M,ge;if(l(a)&&l(a).variants&&l(C).length>0){const _e=d()&&d()!=="temp";console.log(` Reactive: product  , variantsByColor  (${_e?"Edit":"Create"} )`,{productId:l(a).id,variantsCount:l(a).variants.length,selectedColors:l(C),firstVariant:l(a).variants[0],hasOptionValues:!!((M=l(a).variants[0])!=null&&M.option_values)});const Me={},$e=(ge=l(a).options[0])==null?void 0:ge.id;$e&&(l(C).forEach(Y=>{const j=l(a).variants.filter(ee=>{var ae;return l(C).indexOf(Y)===0&&l(a).variants.indexOf(ee),(ae=ee.option_values)==null?void 0:ae.some(ue=>ue.option_value&&ue.option_value.option?ue.option_value.option.id===$e&&ue.option_value.value===Y:ue.option_id?ue.option_id===$e&&ue.value===Y:!1)});j.length>0&&(Me[Y]=j)}),_(k,Me),Ia(q))}}),Yt(()=>(o(),l(H),l(q)),()=>{var M,ge;if((ge=(M=o())==null?void 0:M.productSelection)!=null&&ge.variantDiscounts){const _e=o().productSelection.variantDiscounts,Me=Object.keys(l(H)).sort(),$e=Object.keys(_e).sort();(JSON.stringify(Me)!==JSON.stringify($e)||Object.keys(_e).some(j=>JSON.stringify(l(H)[j])!==JSON.stringify(_e[j])))&&(_(H,{..._e}),Ia(q))}}),mo(),fn();var F=$9(),I=it(F),O=g(I);{var D=M=>{var ge=E9();U(M,ge)},P=M=>{var ge=kt(),_e=it(ge);{var Me=Y=>{var j=F9(),ee=g(j),ae=x(g(ee),2),ue=x(g(ae),2),me=g(ue),ye=x(ee,2);Ne(()=>Se(me,l(v))),At("click",ye,ze),U(Y,j)},$e=Y=>{var j=kt(),ee=it(j);{var ae=ue=>{var me=K9(),ye=it(me),Ee=g(ye),de=g(Ee),Qe=x(Ee,2),Fe=g(Qe),Oe=g(Fe),Te=x(Fe,2);{var De=xe=>{var Re=U9();const et=at(Ce);var qe=g(Re),ot=x(qe);{var Pe=Ye=>{var rt=I9();U(Ye,rt)};ve(ot,Ye=>{l(et).hasDiscount&&Ye(Pe)})}Ne(()=>Se(qe,` : ${l(Z)??""} `)),U(xe,Re)};ve(Te,xe=>{l(Z)>0&&xe(De)})}var ce=x(ye,2);{var Ie=xe=>{var Re=k9(),et=x(g(Re),2);tr(et,5,()=>l(a).options[0].values,mr,(qe,ot)=>{var Pe=P9();const Ye=at(()=>l(C).includes(l(ot).value));var rt=g(Pe),lt=g(rt),vt=g(lt);{var Ft=pt=>{var _t=T9(),$t=it(_t),Rt=x($t,2);{var Ot=Ct=>{var Wt=Q9();U(Ct,Wt)};ve(Rt,Ct=>{l(Ye)&&Ct(Ot)})}Ne(()=>{cr($t,"src",l(ot).image),cr($t,"alt",l(ot).value),Dr($t,`odz-w-12 odz-h-12 odz-object-cover odz-rounded-lg odz-shadow-sm
                                                   ${(l(Ye)?"odz-ring-2 odz-ring-red-400 odz-ring-offset-2":"")??""}`)}),U(pt,_t)};ve(vt,pt=>{l(ot).image&&pt(Ft)})}var Qt=x(lt,2),Et=g(Qt),mt=x(Qt,2),Gt=g(mt);{var Ht=pt=>{var _t=kt();const $t=at(()=>Object.values(l(Q)[l(ot).value]||{}).reduce((Ct,Wt)=>Ct+Wt,0));var Rt=it(_t);{var Ot=Ct=>{var Wt=L9(),It=g(Wt),St=g(It);Ne(()=>Se(St,`${l($t)??""}`)),U(Ct,Wt)};ve(Rt,Ct=>{l($t)>0&&Ct(Ot)})}U(pt,_t)};ve(Gt,pt=>{var _t;l(Ye)&&((_t=l(k)[l(ot).value])==null?void 0:_t.length)>0&&l(q)>=0&&pt(Ht)})}var Ut=x(Gt,2),st=g(Ut);Ne(()=>{Dr(Pe,`odz-w-full odz-transition-all odz-duration-200 odz-ease-in-out
                                   ${(l(Ye)?"odz-bg-gradient-to-r odz-from-red-50 odz-to-rose-50 odz-border-2 odz-border-red-400 odz-shadow-md":"odz-bg-white odz-border-2 odz-border-gray-200 hover:odz-border-gray-300 hover:odz-shadow-sm")??""}
                                   odz-rounded-xl odz-p-3`),Dr(Qt,`odz-flex-1 odz-text-sm odz-font-semibold odz-text-gray-700 odz-text-left
                                            ${(l(Ye)?"odz-text-red-700":"")??""}`),Se(Et,l(ot).value),Dr(Ut,`odz-transition-transform odz-duration-300
                                               ${(l(Ye)?"odz-rotate-90":"")??""}`),tS(st,`odz-w-4 odz-h-4 odz-text-gray-400
                                                   ${(l(Ye)?"odz-text-red-500":"")??""}`)}),At("click",Pe,()=>re(l(ot).value)),U(qe,Pe)}),U(xe,Re)};ve(ce,xe=>{l(a).options.length>0&&xe(Ie)})}var V=x(ce,2);{var G=xe=>{var Re=q9();tr(Re,5,()=>l(C),mr,(et,qe)=>{var ot=R9();const Pe=at(()=>l(k)[l(qe)]||[]),Ye=at(()=>l(a).options[0].values.find(Ut=>Ut.value===l(qe)));var rt=g(ot),lt=g(rt);{var vt=Ut=>{var st=O9(),pt=g(st);Ne(()=>{cr(pt,"src",l(Ye).image),cr(pt,"alt",l(qe))}),U(Ut,st)};ve(lt,Ut=>{var st;(st=l(Ye))!=null&&st.image&&Ut(vt)})}var Ft=x(lt,2),Qt=g(Ft),Et=g(Qt),mt=x(rt,2);{var Gt=Ut=>{var st=H9();tr(st,5,()=>l(Pe),mr,(pt,_t)=>{var $t=M9();const Rt=at(()=>be(l(_t))),Ot=at(()=>{var xr;return((xr=l(Q)[l(qe)])==null?void 0:xr[l(_t).id])||0}),Ct=at(()=>l(H)[l(_t).id]),Wt=at(()=>l(Ot)>0);var It=g($t),St=g(It);{var jt=xr=>{var Pr=D9();U(xr,Pr)};ve(St,xr=>{var Pr;l(Wt)&&((Pr=l(Ct))!=null&&Pr.hasDiscount)&&xr(jt)})}var dr=x(St,2),pr=g(dr),ar=g(pr),ur=x(pr,2),Ir=g(ur);{var Yr=xr=>{H5(xr,{get originalPrice(){return l(_t).prices[0].amount},get finalPrice(){return l(Ct).discountedPrice},hasDiscount:!0,size:"sm"})},Jr=xr=>{var Pr=N9(),Hr=g(Pr);Ne(cn=>Se(Hr,`${cn??""}`),[()=>yr(l(_t).prices[0].amount)],at),U(xr,Pr)};ve(Ir,xr=>{var Pr;(Pr=l(Ct))!=null&&Pr.hasDiscount&&l(Ot)>0?xr(Yr):xr(Jr,!1)})}var qr=x(dr,2),Ar=g(qr),Lr=x(Ar,2),Kr=x(Lr,2);Ne(()=>{Dr(It,`odz-bg-white odz-border-2 odz-rounded-xl odz-p-2 odz-transition-all odz-duration-200
                                                    ${(l(Wt)?"odz-border-red-300 odz-shadow-lg odz-scale-105":"odz-border-gray-200 hover:odz-border-red-200 hover:odz-shadow-md")??""}`),Dr(pr,`odz-bg-gradient-to-r odz-from-slate-600 odz-to-slate-800 odz-text-white
                                                           odz-px-3 odz-py-1 odz-rounded-lg odz-text-sm odz-font-bold odz-shadow-sm
                                                           ${(l(Wt)?"odz-from-red-500 odz-to-red-700":"")??""}`),Se(ar,l(Rt)),Dr(Ar,`odz-flex odz-items-center odz-justify-center odz-w-7 odz-h-7 sm:odz-w-8 sm:odz-h-8 odz-bg-white odz-rounded-md odz-shadow-sm
                                                           odz-text-gray-600 hover:odz-text-red-500 hover:odz-bg-red-50 odz-transition-colors odz-duration-150
                                                           ${(l(Ot)<=0?"odz-opacity-50 odz-cursor-not-allowed":"hover:odz-scale-110")??""}`),Ar.disabled=l(Ot)<=0,n1(Lr,l(Ot))}),At("click",Ar,()=>R(l(qe),l(_t).id)),At("input",Lr,xr=>J(xr,l(qe),l(_t).id)),At("click",Kr,()=>L(l(qe),l(_t).id)),U(pt,$t)}),U(Ut,st)},Ht=Ut=>{var st=j9();U(Ut,st)};ve(mt,Ut=>{l(Pe).length>0&&l(q)>=0?Ut(Gt):Ut(Ht,!1)})}Ne(()=>Se(Et,l(qe))),U(et,ot)}),U(xe,Re)};ve(V,xe=>{l(C).length>0&&xe(G)})}var le=x(V,2);const Le=at(()=>d()||null),He=at(()=>c()!==void 0?c():null),je=at(()=>l(Z)>0);kp(le,{get productId(){return A()},get estimateId(){return l(Le)},get idx(){return l(He)},debugSource:"product-tab",get showNextButton(){return l(je)},nextButtonText:"  ",onNext:ne}),Ne(()=>{cr(de,"src",l(a).thumbnail),cr(de,"alt",l(a).title),Se(Oe,l(a).title)}),U(ue,me)};ve(ee,ue=>{l(a)&&ue(ae)},!0)}U(Y,j)};ve(_e,Y=>{l(v)?Y(Me):Y($e,!1)},!0)}U(M,ge)};ve(O,M=>{l(p)?M(D):M(P,!1)})}var K=x(I,2);Pc(K,{get isOpen(){return l(w)},set isOpen(M){_(w,M)},get title(){return l(y)},set title(M){_(y,M)},get message(){return l(B)},set message(M){_(B,M)},$$legacy:!0}),U(n,F),dn(),r()}var G9=$('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-justify-center odz-py-8"><div class="odz-text-center"><div class="odz-animate-spin odz-w-8 odz-h-8 odz-border-4 odz-border-blue-500 odz-border-t-transparent odz-rounded-full odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">   ...</p></div></div></div>'),W9=$('<div class="odz-bg-red-50 odz-border odz-border-red-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-red-800">  </h3> <p class="odz-text-sm odz-text-red-600"> </p></div></div></div>'),X9=$('<div class="odz-w-12 odz-h-12 odz-flex-shrink-0 odz-overflow-hidden odz-rounded-lg odz-border odz-border-gray-200"><img class="odz-w-full odz-h-full odz-object-cover" loading="lazy"></div>'),Y9=$('<div class="odz-w-12 odz-h-12 odz-flex-shrink-0 odz-bg-gray-100 odz-rounded-lg odz-border odz-border-gray-200 odz-flex odz-items-center odz-justify-center"><svg class="odz-w-6 odz-h-6 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg></div>'),J9=$('<label><input type="radio" class="odz-w-4 odz-h-4 odz-text-red-600 odz-border-gray-300 odz-focus:ring-red-500"> <div class="odz-flex-1"><span class="odz-font-medium odz-text-gray-900"> </span> <div class="odz-text-sm odz-text-red-600 odz-font-semibold"> </div></div></label>'),Z9=$('<div class="odz-mt-4 odz-p-3 odz-bg-green-50 odz-border odz-border-green-200 odz-rounded-lg"><div class="odz-flex odz-items-center odz-gap-2 odz-text-sm"><svg class="odz-w-4 odz-h-4 odz-text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg> <span class="odz-text-green-800">: <strong> </strong> </span></div></div>'),eq=$('<div class="odz-border odz-border-gray-200 odz-rounded-lg odz-p-6"><div class="odz-flex odz-items-center odz-gap-3 odz-mb-4"><!> <h4 class="odz-text-md odz-font-semibold odz-text-gray-800"> </h4></div> <fieldset class="odz-space-y-3"><legend class="odz-sr-only"> </legend> <!></fieldset> <!></div>'),tq=$('<div class="odz-bg-white odz-border odz-border-gray-200 odz-rounded-xl odz-p-6"><h3 class="odz-text-lg odz-font-semibold odz-text-gray-800 odz-mb-6 odz-flex odz-items-center odz-gap-2"><svg class="odz-w-5 odz-h-5 odz-text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg>  </h3> <div class="odz-space-y-8"></div></div>'),rq=$('<div class="odz-bg-gray-50 odz-border odz-border-gray-200 odz-rounded-xl odz-p-8 odz-text-center"><svg class="odz-w-12 odz-h-12 odz-text-gray-400 odz-mx-auto odz-mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"></path></svg> <h3 class="odz-text-lg odz-font-semibold odz-text-gray-700 odz-mb-2"> </h3> <p class="odz-text-gray-500">     .</p></div>'),nq=$("<!> <!>",1),oq=$('<div class="odz-bg-yellow-50 odz-border odz-border-yellow-200 odz-rounded-xl odz-p-6"><div class="odz-flex odz-items-center odz-gap-3"><svg class="odz-w-6 odz-h-6 odz-text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path></svg> <div><h3 class="odz-font-semibold odz-text-yellow-800">    </h3> <p class="odz-text-sm odz-text-yellow-600"> ID   .</p></div></div></div>'),sq=$('<div class="odz-modal odz-modal-open"><div class="odz-modal-box odz-max-w-md odz-p-8"><div class="odz-text-center odz-mb-8"><h3 class="odz-text-lg odz-font-medium odz-text-gray-800">   .</h3></div> <div class="odz-space-y-3"><button type="button" class="odz-w-full odz-px-6 odz-py-4 odz-bg-gray-900 hover:odz-bg-gray-800 odz-text-white odz-font-medium odz-rounded-lg odz-transition-colors odz-flex odz-items-center odz-justify-center odz-gap-3"><div class="odz-w-6 odz-h-6 odz-bg-green-500 odz-rounded-full odz-flex odz-items-center odz-justify-center"><svg class="odz-w-4 odz-h-4 odz-text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path></svg></div>   </button> <button type="button" class="odz-w-full odz-px-6 odz-py-4 odz-bg-red-600 hover:odz-bg-red-700 odz-text-white odz-font-medium odz-rounded-lg odz-transition-colors">  </button></div></div></div>'),iq=$('<div class="odz-addon-tab"><div class="odz-mb-6"><h2 class="odz-text-xl odz-font-bold odz-text-gray-800 odz-mb-2"> </h2> <p class="odz-text-sm odz-text-gray-600">  </p></div> <div class="odz-space-y-6"><!></div></div> <!>',1);function aq(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=()=>an(gr,"$fixedEstimateStore",t),i=()=>an(ni,"$shopStore",t);let a=ht(e,"productId",8),A=ht(e,"estimateId",8,void 0),d=ht(e,"idx",8,void 0),c=ht(e,"onSave",8,void 0);ht(e,"onNext",8,void 0);let u=ht(e,"onPrev",8,void 0),h=null,p=Be(null),v=Be(!1),w=Be(null),y=Be({}),B=Be(!1),C="";function Q(z,E,F){var I,O;gr.toggleAddonSelection(z,E,F),((I=l(y)[z])==null?void 0:I.productId)===E&&((O=l(y)[z])==null?void 0:O.variantId)===F?delete l(y)[z]:br(y,l(y)[z]={productId:E,variantId:F}),_(y,{...l(y)}),k(),typeof window<"u"&&(window.dispatchEvent(new CustomEvent("addonSelectionUpdate",{detail:{productId:E,addonId:z,variantId:F,selectedAddons:{...l(y)},timestamp:Date.now(),source:"addon.svelte"}})),console.log(" addonSelectionUpdate   (variantId ):",{productId:E,addonId:z,variantId:F,selectedAddonsCount:Object.keys(l(y)).length}))}function k(){const z=o().index;z>=0&&o().products[z]&&(er(gt,dt(o).products[z].addons={...l(y)},dt(o)),Nb(gt,{...o()}))}async function H(){if(!a())return;const z=s().productSelection;if(z&&z.product&&z.productId===a()){_(p,{product:z.product,addons:z.addons||[],addonItems:z.addonItems||[]}),_(v,!1);return}_(v,!0),_(w,null);try{_(p,await Xn.loadIntegratedProductData(a(),i().id))}catch(E){_(w,E instanceof Error?E.message:"   .")}finally{_(v,!1)}}function Z(){const z=s();if(z&&z.productId===a()&&z.addonSelection&&z.addonSelection.selectedAddons){const E={...z.addonSelection.selectedAddons};Object.keys(l(y)).length,Object.keys(E).length,_(y,E),_(y,{...l(y)})}}function q(){h=gr.subscribe(z=>{if(z&&z.productId===a())if(z.addonSelection&&z.addonSelection.selectedAddons){const E={...z.addonSelection.selectedAddons};Object.keys(l(y)).length,Object.keys(E).length,JSON.stringify(l(y))!==JSON.stringify(E)&&(_(y,E),typeof window<"u"&&window.dispatchEvent(new CustomEvent("addonSelectionChanged",{detail:{selectedAddons:E}})))}else Object.keys(l(y)).length>0&&_(y,{})})}function N(z){var O;const E={printMethod:null,simplePrintState:null,detailedPrintState:null},F=o().products[z];F&&(F.print_type&&F.print_type!=="selection"&&(E.printMethod=F.print_type),F.simplePrints&&F.simplePrints.length>0&&(E.simplePrintState=F.simplePrints),F.prints&&F.prints.length>0&&(E.detailedPrintState=F.prints));const I=s();return(O=I==null?void 0:I.printSelection)!=null&&O.currentMethod&&(E.printMethod=I.printSelection.currentMethod),E}async function re(z,E,F,I){var de,Qe,Fe,Oe,Te,De;const{shopData:O,customerData:D,fixedEstimateData:P,estimateStoreData:K}=z,M=new Date().toISOString(),ge={shop_id:(O==null?void 0:O.id)||null,sess:(O==null?void 0:O.sess)||null,customer_id:(O==null?void 0:O.customer_id)||null,name:(D==null?void 0:D.name)||(E==null?void 0:E.name)||null,order_name:(D==null?void 0:D.name)||(E==null?void 0:E.name)||null,order_phone:(D==null?void 0:D.phone)||(E==null?void 0:E.phone)||null,address1:(D==null?void 0:D.address1)||(E==null?void 0:E.address1)||null,address2:(D==null?void 0:D.address2)||(E==null?void 0:E.address2)||null,postcode:(D==null?void 0:D.postcode)||(E==null?void 0:E.postcode)||null,mall_type:(D==null?void 0:D.mallType)||(E==null?void 0:E.mallType)||null,upload_memo:(K==null?void 0:K.uploadMemo)||null,status:"temp",created_at:M,updated_at:M},_e=[];let Me=((de=P==null?void 0:P.printSelection)==null?void 0:de.currentMethod)||(F==null?void 0:F.printMethod)||"none";if(Me==="selection"&&(console.warn(' [prepareDataForDatabase] print_type "selection" . "none" .'),Me="none"),["simple","detailed","self-design","none"].includes(Me)||(console.warn(` [prepareDataForDatabase]   print_type: "${Me}". "none" .`),Me="none"),(Qe=P==null?void 0:P.productSelection)!=null&&Qe.quantityByVariant&&((Fe=P==null?void 0:P.productSelection)!=null&&Fe.variantsByColor)){const ce=P.productSelection.quantityByVariant,Ie=P.productSelection.variantsByColor,V=P.productSelection.variantDiscounts||{};for(const G in ce){const le=ce[G],Le=Ie[G]||[];for(const He in le){const je=le[He];if(je>0){const xe=Le.find(Re=>Re.id===He);if(xe){const Re=xe.prices&&xe.prices.length>0?xe.prices[0].amount:0,et=V[He];let qe=Re,ot=0,Pe="amount",Ye=0,rt="minus",lt=null,vt=null;if(et&&et.hasDiscount){qe=et.discountedPrice,ot=et.discountAmount;const Ft=et.discountInfo;Ft&&(Pe=Ft.type||"amount",Ye=Ft.value||0,rt=Ft.direction||"minus",lt=Ft.min_quantity||null,vt=Ft.max_quantity||null)}_e.push({idx:0,variant_id:He,quantity:je,price:qe,print_type:Me,original_price:Re,discount_amount:ot,discount_type:Pe,discount_value:Ye,discount_direction:rt,discount_min_quantity:lt,discount_max_quantity:vt,product_id:I,created_at:M,updated_at:M})}}}}}if(_e.length===0&&(K!=null&&K.products)){const ce=K.products.find(Ie=>{var V;return((V=Ie.product)==null?void 0:V.id)===I});ce&&ce.variants&&ce.variants.length>0&&ce.variants.forEach((Ie,V)=>{var G;if(Ie.quantity>0){const le=Ie.prices&&Ie.prices.length>0?Ie.prices[0].amount:0,Le=(G=Ie.product)==null?void 0:G.quantity_discounts,He=ia(Ie.quantity,le,Le),je=He.discountInfo;_e.push({idx:V,variant_id:Ie.id,quantity:Ie.quantity,price:He.discountedPrice,original_price:le,discount_amount:He.discountAmount,discount_type:(je==null?void 0:je.type)||"amount",discount_value:(je==null?void 0:je.value)||0,discount_direction:(je==null?void 0:je.direction)||"minus",discount_min_quantity:(je==null?void 0:je.min_quantity)||null,discount_max_quantity:(je==null?void 0:je.max_quantity)||null,product_id:I,created_at:M,updated_at:M})}})}const Y=[];F.simplePrintState&&Array.isArray(F.simplePrintState)&&F.simplePrintState.forEach((ce,Ie)=>{Y.push({idx:0,object_id:ce.objectId||`area-${Ie}`,title:ce.title||`  ${Ie+1}`,print_method:ce.printMethod||null,uploaded_files:ce.uploadedFiles||null,file_metadata:ce.savedFileInfo||null,price:ce.price||0,created_at:M,updated_at:M})});const j=[],ee=new Set,ae=((Oe=P==null?void 0:P.printSelection)==null?void 0:Oe.currentMethod)==="detailed"||Array.isArray(F.detailedPrintState)&&F.detailedPrintState.length>0;async function ue(ce,Ie){var et,qe,ot,Pe;if(!ce)return;const V=((et=ce.template)==null?void 0:et.id)??ce.template_id??null,G=ce.objectId??ce.object_id??null;if(!V&&!G||G&&ee.has(G))return;let le=0;const Le=ce.price??0,He=Number(Le);if(Number.isFinite(He)&&He>0)le=He;else try{const Ye=((qe=P==null?void 0:P.productSelection)==null?void 0:qe.totalQuantity)||0;let rt=0,lt=0;if(ce.colors&&((ot=ce.template)!=null&&ot.templateProduct)){const vt=ce.colors.length,Ft=ce.template.templateProduct.template_product_variants.find(Qt=>Qt.color_count===vt);if(Ft){const Qt=await hl(Ft.variant_id);if(Qt)if(rt=Qt.prices[0].amount,Ft.min_quantity<=Ye)if(lt=rt*Ye,ce.template.templateProduct.product.quantity_discounts&&ce.template.templateProduct.product.quantity_discounts.length>0){const Et=ia(Ye,rt,ce.template.templateProduct.product.quantity_discounts);le=Et.hasDiscount?Et.discountedPrice*Ye:lt}else le=lt;else le=Ft.plate_price}}else if((Pe=ce.template)!=null&&Pe.templateProduct){const vt=ce.template.templateProduct.template_product_variants[0];if(vt){const Ft=await hl(vt.variant_id);if(Ft)if(rt=Ft.prices[0].amount,vt.min_quantity<=Ye)if(lt=rt*Ye,ce.template.templateProduct.product.quantity_discounts&&ce.template.templateProduct.product.quantity_discounts.length>0){const Qt=ia(Ye,rt,ce.template.templateProduct.product.quantity_discounts);le=Qt.hasDiscount?Qt.discountedPrice*Ye:lt}else le=lt;else le=vt.plate_price}}}catch{le=0}const je=ce.discountInfo||{},xe=je.discountDetails||je.discountInfo||{};j.push({idx:0,template_id:V,variant_id:ce.variant_id??null,price:le,colors:ce.colors||null,uploads:ce.uploads||null,name_sheet:ce.nameSheet??ce.name_sheet??null,object_id:G,original_price:je.originalPrice??ce.original_price??null,discount_amount:je.discountAmount??ce.discount_amount??null,discount_type:xe.type??ce.discount_type??null,discount_value:xe.value??ce.discount_value??null,discount_direction:xe.direction??ce.discount_direction??null,discount_min_quantity:xe.min_quantity??ce.discount_min_quantity??null,discount_max_quantity:xe.max_quantity??ce.discount_max_quantity??null,created_at:M,updated_at:M}),G&&ee.add(G)}if(ae){if(Array.isArray(F.detailedPrintState)&&F.detailedPrintState.length>0)for(let ce=0;ce<F.detailedPrintState.length;ce++){const Ie=F.detailedPrintState[ce];await ue(Ie)}if(j.length===0&&(K!=null&&K.products)){const ce=K.products.find(Ie=>{var V;return((V=Ie.product)==null?void 0:V.id)===I});if(ce!=null&&ce.prints&&ce.prints.length>0)for(let Ie=0;Ie<ce.prints.length;Ie++)await ue(ce.prints[Ie])}}const me=[],ye=(Te=P==null?void 0:P.addonSelection)==null?void 0:Te.selectedAddons,Ee=((De=P==null?void 0:P.productSelection)==null?void 0:De.totalQuantity)||0;return ye&&Object.keys(ye).length>0&&Object.entries(ye).forEach(([ce,Ie])=>{var le,Le,He;let V=0,G=0;if((Le=(le=l(p))==null?void 0:le.addonProductsMap)!=null&&Le[Ie.productId]){const xe=(He=l(p).addonProductsMap[Ie.productId].variants)==null?void 0:He.find(Re=>Re.id===Ie.variantId);xe&&xe.prices&&xe.prices.length>0&&(G=xe.prices[0].amount||0,V=G)}me.push({idx:0,addon_id:ce,selected_product_id:Ie.productId,selected_variant_id:Ie.variantId,quantity:Ee,price:V,created_at:M,updated_at:M})}),{estimate:ge,estimate_items:_e,estimate_simple_prints:Y,estimate_prints:j,estimate_addon_items:me}}function be(z){const E=[];return z.estimate.shop_id||E.push(" ID "),z.estimate_items.length===0&&E.push("  "),z.estimate_items.forEach((F,I)=>{F.variant_id||E.push(` ${I+1}:  ID `),(!F.quantity||F.quantity<=0)&&E.push(` ${I+1}:  `)}),z.estimate_simple_prints.forEach((F,I)=>{F.object_id||E.push(`  ${I+1}:  ID `)}),z.estimate_prints&&z.estimate_prints.length>0&&z.estimate_prints.forEach((F,I)=>{!F.template_id&&!F.object_id&&E.push(`  ${I+1}: template_id  object_id `)}),{isValid:E.length===0,errors:E}}async function L(){var z;try{let E=null,F=null,I=null,O=null,D=null;gr.subscribe(ye=>{E=ye})(),Xn.subscribe(ye=>{F=ye})(),gt.subscribe(ye=>{I=ye})(),Gl.subscribe(ye=>{O=ye})(),ni.subscribe(ye=>{D=ye})();const Me=d()??o().index??0,$e=N(Me),Y={shopData:D,customerData:O,fixedEstimateData:E,extendedProductData:F,estimateStoreData:I},j={name:O==null?void 0:O.name,phone:O==null?void 0:O.phone,address1:O==null?void 0:O.address1,address2:O==null?void 0:O.address2,postcode:O==null?void 0:O.postcode,mallType:O==null?void 0:O.mallType},ee=await re(Y,j,$e,a()),ae=be(ee);if(!ae.isValid){alert(`   :

${ae.errors.join(`
`)}

   .`);return}const ue=await B5(ee,(O==null?void 0:O.mallType)||(j==null?void 0:j.mallType),D==null?void 0:D.customer_id,D==null?void 0:D.sess);if(ue.success){const ye=`
   !

  : ${((z=ue.details)==null?void 0:z.estimateNumber)||"N/A"}
  ID: ${ue.estimateId}
  ID: ${a()}
   : ${ee.estimate_items.length}
   : ${ee.estimate_simple_prints.length}
   : ${ee.estimate_prints.length}
  : ${ee.estimate_addon_items.length}

   : ${new Date().toLocaleString()}

   !
                `.trim();_(B,!0),C=ue.estimateId}else{const ye=`
   !

  ID: ${a()}
  : ${ue.error}

  : ${new Date().toLocaleString()}

    .
                `.trim();alert(ye)}const me={version:"1.0.0",timestamp:new Date().toISOString(),productId:a(),databaseData:ee,validationResult:ae,saveResult:ue,stores:{shopStore:D,customerStore:O,fixedEstimateStore:E,extendedProductDataStore:F,estimateStore:I},storeDataBackup:$e,integratedProductData:l(p),selectedAddons:l(y),formData:j};window.lastEstimateDataPackage=me}catch(E){const F=`
     !

  : ${E instanceof Error?E.message:"   "}
  ID: ${a()}
  : ${new Date().toLocaleString()}

   .
            `.trim();alert(F)}}function R(){_(B,!1),gr.reset(),Xn.reset(),gt.reset(),_(y,{}),_(p,null),gr.setCurrentStep("product"),setTimeout(()=>{window.location.href="/"},100)}function J(){_(B,!1),window.location.href="/odiz/estimate.php"}to(async()=>{var F;const z=s();(!z||z.productId!==a())&&gr.initialize(a(),A()),q(),await H(),Z();const E=o().index;if(E>=0&&((F=o().products[E])!=null&&F.addons)){const I=o().products[E].addons;Object.keys(I).length>0&&_(y,{...I})}}),gs(()=>{h&&h()}),fn();var se=iq(),fe=it(se),ie=x(g(fe),2),pe=g(ie);{var te=z=>{var E=G9();U(z,E)},Ce=z=>{var E=kt(),F=it(E);{var I=D=>{var P=W9(),K=g(P),M=x(g(K),2),ge=x(g(M),2),_e=g(ge);Ne(()=>Se(_e,l(w))),U(D,P)},O=D=>{var P=kt(),K=it(P);{var M=_e=>{var Me=nq(),$e=it(Me);{var Y=ye=>{var Ee=tq(),de=x(g(Ee),2);tr(de,5,()=>l(p).addons,Qe=>Qe.id,(Qe,Fe)=>{var Oe=eq(),Te=g(Oe),De=g(Te);{var ce=et=>{var qe=X9(),ot=g(qe);Ne(()=>{cr(ot,"src",l(Fe).items[0].addon_product.thumbnail),cr(ot,"alt",l(Fe).name)}),Tb(ot),At("error",ot,Pe=>{const Ye=Pe.target;Ye.style.display="none",Ye.parentElement&&(Ye.parentElement.innerHTML=`
                                                        <div class="odz-w-full odz-h-full odz-bg-gray-100 odz-flex odz-items-center odz-justify-center">
                                                            <svg class="odz-w-6 odz-h-6 odz-text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2.586a1 1 0 00-.707.293l-2.414 2.414a1 1 0 01-.707.293h-3.172a1 1 0 01-.707-.293l-2.414-2.414A1 1 0 006.586 13H4"/>
                                                            </svg>
                                                        </div>
                                                    `)}),U(et,qe)},Ie=et=>{var qe=Y9();U(et,qe)};ve(De,et=>{l(Fe).items&&l(Fe).items.length>0&&l(Fe).items[0].addon_product.thumbnail?et(ce):et(Ie,!1)})}var V=x(De,2),G=g(V),le=x(Te,2),Le=g(le),He=g(Le),je=x(Le,2);tr(je,1,()=>l(Fe).items,et=>et.id,(et,qe)=>{var ot=kt(),Pe=it(ot);{var Ye=rt=>{var lt=kt(),vt=it(lt);tr(vt,1,()=>l(qe).addon_product.variants,Ft=>Ft.id,(Ft,Qt)=>{var Et=J9();const mt=at(()=>{var Ot,Ct;return((Ot=l(y)[l(Fe).id])==null?void 0:Ot.productId)===l(qe).addon_product.id&&((Ct=l(y)[l(Fe).id])==null?void 0:Ct.variantId)===l(Qt).id}),Gt=at(()=>l(Qt).prices&&l(Qt).prices.length>0?l(Qt).prices[0].amount:0);var Ht=g(Et),Ut=_c(()=>(()=>{var pr,ar;const Ot=l(Fe).id,Ct=l(Fe).name,Wt=l(qe).addon_product.id,It=l(qe).addon_product.title,St=l(Qt).id,jt=l(Qt).title,dr=(ar=(pr=l(Qt).prices)==null?void 0:pr[0])==null?void 0:ar.amount;return ur=>{console.log(" Radio button clicked ( ):",{addonId:Ot,addonName:Ct,productId:Wt,productTitle:It,variantId:St,variantTitle:jt,variantPrice:dr,radioId:ur.target.id,timestamp:Date.now()}),Q(Ot,Wt,St)}})()),st=x(Ht,2),pt=g(st),_t=g(pt),$t=x(pt,2),Rt=g($t);Ne(Ot=>{cr(Et,"for",`addon-${l(Fe).id??""}-${l(qe).id??""}-${l(Qt).id??""}`),Dr(Et,`odz-flex odz-items-center odz-gap-4 odz-p-4 odz-border-2 odz-rounded-lg odz-cursor-pointer odz-transition-all
                                                           ${(l(mt)?"odz-border-red-500 odz-bg-red-50":"odz-border-gray-200 odz-bg-white hover:odz-border-gray-300")??""}`),cr(Ht,"id",`addon-${l(Fe).id??""}-${l(qe).id??""}-${l(Qt).id??""}`),cr(Ht,"name",`addon-${l(Fe).id??""}`),qu(Ht,l(mt)),Se(_t,l(Qt).title||l(qe).addon_product.title),Se(Rt,` ${Ot??""}`)},[()=>yr(l(Gt))],at),At("change",Ht,function(...Ot){var Ct;(Ct=l(Ut))==null||Ct.apply(this,Ot)}),U(Ft,Et)}),U(rt,lt)};ve(Pe,rt=>{l(qe).addon_product.variants&&l(qe).addon_product.variants.length>0&&rt(Ye)})}U(et,ot)});var xe=x(le,2);{var Re=et=>{var qe=kt();const ot=at(()=>l(Fe).items.find(lt=>lt.addon_product.id===l(y)[l(Fe).id].productId)),Pe=at(()=>{var lt,vt;return(vt=(lt=l(ot))==null?void 0:lt.addon_product.variants)==null?void 0:vt.find(Ft=>Ft.id===l(y)[l(Fe).id].variantId)});var Ye=it(qe);{var rt=lt=>{var vt=Z9(),Ft=g(vt),Qt=x(g(Ft),2),Et=x(g(Qt)),mt=g(Et),Gt=x(Et);Ne(Ht=>{Se(mt,l(Pe).title||l(ot).addon_product.title),Se(Gt,` ( ${Ht??""})`)},[()=>{var Ht,Ut;return yr(((Ut=(Ht=l(Pe).prices)==null?void 0:Ht[0])==null?void 0:Ut.amount)||0)}],at),U(lt,vt)};ve(Ye,lt=>{l(ot)&&l(Pe)&&lt(rt)})}U(et,qe)};ve(xe,et=>{l(y)[l(Fe).id]&&et(Re)})}Ne(()=>{Se(G,l(Fe).name),Se(He,`${l(Fe).name??""} `)}),U(Qe,Oe)}),U(ye,Ee)},j=ye=>{var Ee=rq();U(ye,Ee)};ve($e,ye=>{l(p).addons.length>0?ye(Y):ye(j,!1)})}var ee=x($e,2);const ae=at(()=>A()||null),ue=at(()=>d()!==void 0?d():null),me=at(()=>({type:"double",buttons:[{text:" ",action:u()||(()=>{}),style:"secondary",icon:"arrow-left"},{text:" ",action:A()&&typeof d()=="number"&&c()?c():L,style:"primary",icon:"save",size:"large"}]}));kp(ee,{get productId(){return a()},get estimateId(){return l(ae)},get idx(){return l(ue)},debugSource:"addon-tab",get buttonConfig(){return l(me)}}),U(_e,Me)},ge=_e=>{var Me=oq();U(_e,Me)};ve(K,_e=>{l(p)?_e(M):_e(ge,!1)},!0)}U(D,P)};ve(F,D=>{l(w)?D(I):D(O,!1)},!0)}U(z,E)};ve(pe,z=>{l(v)?z(te):z(Ce,!1)})}var ne=x(fe,2);{var ze=z=>{var E=sq(),F=g(E),I=x(g(F),2),O=g(I),D=x(O,2);At("click",O,R),At("click",D,J),U(z,E)};ve(ne,z=>{l(B)&&z(ze)})}U(n,se),dn(),r()}var Aq=$('<button><div class="odz-flex odz-items-center odz-justify-center odz-gap-2"><span class="odz-hidden sm:odz-inline"> </span></div></button>'),lq=$('<div class="odz-flex odz-flex-col odz-gap-4 odz-p-4"><div class="odz-w-full"><div class="odz-flex odz-w-full odz-border-b odz-border-gray-200"></div></div>  <div><div><!></div> <div><!></div> <div><!></div></div></div>');function Du(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=()=>an(gr,"$fixedEstimateStore",t),i=()=>an(ni,"$shopStore",t);let a=ht(e,"productId",8),A=ht(e,"estimateId",8,void 0),d=ht(e,"idx",8,void 0),c=ht(e,"onSave",8,void 0),u=Be("product"),h=null,p=null,v=!1,w=null;const y=[{id:"product",label:"",description:"   "},{id:"print",label:"",description:"   "},{id:"addon",label:"",description:"  "}];function B(fe){var Ce;const ie=l(u),pe=fe;if(_(u,pe),gr.setCurrentStep(pe),Xn.getProductData(a())&&(Xn.saveToSession(a()),typeof window<"u"))try{const ne=d()??0,ze=`tab-state-${a()}_${ne}`,z={currentTab:pe,previousTab:ie,timestamp:Date.now(),productId:a(),idx:ne};window.sessionStorage.setItem(ze,JSON.stringify(z))}catch{}if(typeof window<"u")try{let ne;const ze=d()??0,z=o().products;if(z&&z[ze]){const F=z[ze];F.print_type&&F.print_type!=="selection"&&(ne=F.print_type,console.log(" toMethod (estimateStore ):",{idx:ze,toMethod:ne}))}if(!ne){const F=s();if((F==null?void 0:F.idx)===d()&&((Ce=F==null?void 0:F.printSelection)!=null&&Ce.currentMethod)){const I=F.printSelection.currentMethod;I!=="selection"&&(ne=I,console.log(" toMethod (fixedEstimateStore ):",{idx:d(),toMethod:ne}))}}console.log("   - toMethod :",{estimateId:A(),idx:d(),productId:a(),toMethod:ne,source:ne?"store":"none"});const E=new CustomEvent("printAmountRecalc",{detail:{productId:a(),fromTab:ie,toTab:pe,toMethod:ne,estimateId:A(),idx:d(),timestamp:Date.now(),source:"tab-change"}});window.dispatchEvent(E)}catch{}console.log("   ( ):",{from:ie,to:pe,productId:a(),sessionSaved:!0})}function C(){l(u)==="product"?B("print"):l(u)==="print"&&B("addon")}function Q(){if(typeof window>"u")return!1;try{const fe=d()??0,ie=`tab-state-${a()}_${fe}`,pe=window.sessionStorage.getItem(ie);if(pe){const te=JSON.parse(pe);if(te.productId===a()&&te.idx===fe&&te.currentTab)return _(u,te.currentTab),console.log("   :",{productId:a(),idx:fe,tab:l(u)}),!0}}catch{}return!1}async function k(){try{await Xn.loadIntegratedProductData(a(),i().id)}catch{}}to(async()=>{const fe=A()&&A()!=="temp";await k();const ie=Q();v=ie,fe||gr.initialize(a()),ie&&!fe&&gr.setCurrentStep(l(u)),h=gr.subscribe(pe=>{pe&&pe.productId===a()&&!v&&(pe.currentStep,l(u))}),p=Xn.subscribe(pe=>{}),w=pe=>{const te=pe.detail;te&&["product","print","addon"].includes(te)&&B(te)},typeof window<"u"&&window.addEventListener("changeTab",w)}),gs(()=>{h&&h(),p&&p(),typeof window<"u"&&w&&window.removeEventListener("changeTab",w)}),fn();var H=lq(),Z=g(H),q=g(Z);tr(q,5,()=>y,mr,(fe,ie)=>{var pe=Aq(),te=g(pe),Ce=g(te),ne=g(Ce);Ne(()=>{Dr(pe,`odz-flex-1 odz-px-4 odz-py-3 odz-text-sm odz-font-medium odz-transition-all odz-duration-200 odz-border-b-2
                           ${(l(u)===l(ie).id?"odz-text-red-600 odz-border-red-400 odz-bg-red-50":"odz-text-gray-600 odz-border-transparent hover:odz-text-gray-800 hover:odz-border-gray-300")??""}`),Se(ne,l(ie).label)}),At("click",pe,()=>B(l(ie).id)),U(fe,pe)});var N=x(Z,2),re=g(N),be=g(re);V9(be,{get productId(){return a()},get estimateId(){return A()},get idx(){return d()},onNext:()=>B("print")});var L=x(re,2),R=g(L);Gx(R,{get productId(){return a()},get estimateId(){return A()},get idx(){return d()},onNext:C});var J=x(L,2),se=g(J);aq(se,{get productId(){return a()},get estimateId(){return A()},get idx(){return d()},onNext:C,onPrev:()=>B("print"),get onSave(){return c()}}),Ne(()=>{Cs(re,"odz-hidden",l(u)!=="product"),Cs(L,"odz-hidden",l(u)!=="print"),Cs(J,"odz-hidden",l(u)!=="addon")}),U(n,H),dn(),r()}var dq=$('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-ml-4 odz-text-gray-600">  ...</p></div>'),cq=$('<div class="odz-alert odz-alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="odz-stroke-current odz-shrink-0 odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),uq=$('<dialog class="odz-modal odz-modal-open odz-backdrop:odz-bg-black odz-backdrop:odz-bg-opacity-50"><div class="odz-modal-box odz-max-w-6xl odz-w-full odz-h-[90vh] odz-p-0 odz-relative"><div class="odz-sticky odz-top-0 odz-z-10 odz-bg-white odz-border-b odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-between odz-items-center"><h3 class="odz-text-lg odz-font-bold odz-text-gray-900">  </h3> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost"><!></button></div> <div class="odz-overflow-y-auto odz-h-[calc(90vh-140px)] odz-px-6 odz-py-4"><!></div> <div class="odz-sticky odz-bottom-0 odz-z-10 odz-bg-white odz-border-t odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-end odz-gap-2"><button class="odz-btn odz-btn-ghost"></button> <button class="odz-btn odz-btn-primary"></button></div></div></dialog>');function hq(n,e){ln(e,!1);let t=ht(e,"isOpen",8,!1),r=ht(e,"estimateId",8),o=ht(e,"idx",8),s=ht(e,"productIndex",8),i=ht(e,"productId",8),a=ht(e,"onClose",8),A=ht(e,"onSave",8),d=Be(!0),c=Be(""),u=Be();async function h(){var J,se,fe;try{_(d,!0),_(c,"");const ie=await z5(r(),o());if(!ie.items||ie.items.length===0)throw new Error(`     . (estimateId: ${r()}, idx: ${o()})`);if(!((J=ie.items[0])!=null&&J.product_id))throw new Error(" ID   .");if(!ie.items.some(E=>E.variant&&E.variant.id)){const E=ie.items.map(F=>F.variant_id).filter(Boolean);throw E.length===0?new Error("    .  ."):new Error(`     . ( ID: ${E[0]})
     .  .`)}const te=S5(ie),Ce=r()||"temp",ne=Date.now().toString(36)+Math.random().toString(36).substr(2),ze={productId:i(),productSelection:te.fixedEstimateData.productSelection,printSelection:te.fixedEstimateData.printSelection||null,addonSelection:te.fixedEstimateData.addonSelection||null,additionalInfo:te.fixedEstimateData.additionalInfo||null,currentStep:"product",isDebugMode:!0,sessionId:ne,estimateId:Ce,idx:o()};gr.set(ze);const{sessionStorageData:z}=te;gt.updateProductAtIndex(s(),{print_type:((se=ze.printSelection)==null?void 0:se.currentMethod)||"selection",prints:z.detailedPrintState||[],simplePrints:z.simplePrintState||[],simplePrintState:z.simplePrintState||[],productSelection:te.fixedEstimateData.productSelection,addons:((fe=te.fixedEstimateData.addonSelection)==null?void 0:fe.selectedAddons)||{}}),await new Promise(E=>setTimeout(E,50)),_(d,!1)}catch(ie){ie instanceof Error?_(c,ie.message):_(c,"    ."),_(d,!1)}}function p(){gr.reset(),a()()}function v(){A()()}function w(J){J.key==="Escape"&&p()}function y(J){J.target===l(u)&&p()}gs(()=>{gr.reset()}),Yt(()=>(l(u),oo(t())),()=>{l(u)&&(t()?(l(u).showModal(),h()):l(u).close())}),mo(),fn();var B=uq(),C=g(B),Q=g(C),k=x(g(Q),2),H=g(k);xA(H,{class:"odz-w-5 odz-h-5"});var Z=x(Q,2),q=g(Z);{var N=J=>{var se=dq();U(J,se)},re=J=>{var se=kt(),fe=it(se);{var ie=te=>{var Ce=cq(),ne=x(g(Ce),2),ze=g(ne);Ne(()=>Se(ze,l(c))),U(te,Ce)},pe=te=>{Du(te,{get productId(){return i()},get estimateId(){return r()},get idx(){return o()},onSave:v})};ve(fe,te=>{l(c)?te(ie):te(pe,!1)},!0)}U(J,se)};ve(q,J=>{l(d)?J(N):J(re,!1)})}var be=x(Z,2),L=g(be),R=x(L,2);fs(B,J=>_(u,J),()=>l(u)),Ne(()=>R.disabled=l(d)),At("click",k,p),At("click",L,p),At("click",R,v),At("keydown",B,w),At("click",B,y),U(n,B),dn()}var fq=$('<div class="odz-flex odz-items-center odz-justify-center odz-min-h-screen"><div class="odz-text-center"><div class="odz-w-12 odz-h-12 odz-border-4 odz-border-red-500 odz-border-t-transparent odz-rounded-full odz-animate-spin odz-mx-auto odz-mb-4"></div> <p class="odz-text-sm odz-text-gray-600">  ...</p></div></div>'),pq=$('<div class="odz-mb-4"><button class="odz-flex odz-items-center odz-gap-2 odz-text-gray-600 hover:odz-text-gray-900 odz-transition-colors"><svg class="odz-w-5 odz-h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path></svg> <span class="odz-text-sm odz-font-medium"> </span></button></div>'),gq=$('<div class="odz-fixed odz-top-4 odz-right-4 odz-z-50 odz-bg-green-500 odz-text-white odz-px-4 odz-py-3 odz-rounded-lg odz-shadow-lg odz-flex odz-items-center odz-gap-2"><!> <span class="odz-text-sm"></span></div>'),vq=$('<button class="odz-bg-red-500 hover:odz-bg-red-600 odz-text-white odz-px-6 odz-py-3 odz-rounded-lg odz-font-medium odz-text-sm odz-transition-colors"> </button>'),mq=$('<div class="odz-text-center odz-py-12"><!> <p class="odz-text-sm odz-text-gray-500 odz-mb-4">  </p> <!></div>'),wq=$('<p class="odz-mt-1 odz-text-xs odz-text-red-500"> </p>'),yq=$('<p class="odz-mt-1 odz-text-xs odz-text-gray-500">  4  </p>'),_q=$('<div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <div class="odz-relative"><!> <input type="password" placeholder="     "></div> <!></div>'),bq=$('<div class="odz-flex odz-justify-between odz-text-sm odz-text-red-600"><span></span> <span class="odz-font-medium"> </span></div>'),xq=$('<div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-4 odz-mb-4 odz-border odz-border-gray-200"><button class="odz-w-full odz-flex odz-items-center odz-justify-center odz-gap-2 odz-bg-white odz-border odz-border-gray-300 hover:odz-bg-gray-50 odz-text-gray-700 odz-py-3 odz-rounded-lg odz-font-medium odz-text-sm odz-transition-colors"><!>  </button></div>'),Bq=$('<span class="odz-flex odz-items-center odz-justify-center odz-gap-2"><div class="odz-w-5 odz-h-5 odz-border-2 odz-border-white odz-border-t-transparent odz-rounded-full odz-animate-spin"></div>  ...</span>'),zq=$('<div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-4 odz-border odz-border-gray-200 odz-sticky odz-bottom-0"><button class="odz-w-full odz-bg-red-500 hover:odz-bg-red-600 odz-text-white odz-py-4 odz-rounded-lg odz-font-medium odz-text-base odz-transition-colors disabled:odz-opacity-50 disabled:odz-cursor-not-allowed"><!></button></div>'),Cq=$('<div class="odz-max-w-5xl odz-mx-auto odz-px-4 odz-py-6"><!> <!> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><!></div> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><div class="odz-space-y-4"><div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="text" placeholder="  ()" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <div class="odz-flex odz-gap-2"><select class="odz-w-20 odz-px-3 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"><option>010</option><option>011</option><option>016</option><option>017</option><option>018</option><option>019</option></select> <input type="tel" placeholder="0000" maxlength="4" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"> <input type="tel" placeholder="0000" maxlength="4" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500"></div></div> <div class="odz-col-span-full odz-border-t odz-border-gray-200 odz-my-2"></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <div class="odz-flex odz-gap-2"><input type="text" placeholder="" readonly="" class="odz-flex-1 odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm odz-bg-gray-50"> <button type="button" class="odz-px-6 odz-py-2.5 odz-bg-gray-700 hover:odz-bg-gray-800 odz-text-white odz-rounded-lg odz-text-sm odz-font-medium odz-transition-colors odz-whitespace-nowrap disabled:odz-opacity-50"> </button></div></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> <span class="odz-text-red-500">*</span></label> <input type="text" placeholder="    " readonly="" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm odz-bg-gray-50"></div> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="text" placeholder=" " class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <select class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"><option></option><option></option><option></option><option></option></select></div> <div><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"></label> <input type="date" class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50"></div> <!> <div class="odz-col-span-full"><label class="odz-block odz-text-sm odz-font-medium odz-text-gray-700 odz-mb-2"> </label> <textarea class="odz-w-full odz-px-4 odz-py-2.5 odz-border odz-border-gray-300 odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 odz-resize-none disabled:odz-bg-gray-50" rows="3" placeholder="  "></textarea></div></div></div> <div class="odz-bg-white odz-rounded-lg odz-shadow-sm odz-p-6 odz-mb-4 odz-border odz-border-gray-200"><div class="odz-space-y-3"><div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"> </span> <span class="odz-font-medium"> </span></div> <div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"></span> <span class="odz-font-medium"> </span></div> <div class="odz-flex odz-justify-between odz-text-sm"><span class="odz-text-gray-600"></span> <span class="odz-font-medium"> </span></div> <!> <div class="odz-border-t odz-border-gray-200 odz-pt-3 odz-flex odz-justify-between"><span class="odz-font-semibold odz-text-gray-900"> </span> <span class="odz-text-xl odz-font-bold odz-text-red-600"> </span></div></div></div> <!> <!></div>'),Sq=$('<div class="odz-min-h-screen odz-bg-gray-50"><!></div> <!> <!> <!> <!> <!>',1);function Eq(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(gt,"$estimateStore",t),s=Be();let i=ht(e,"mallType",8,""),a=ht(e,"customerId",8,""),A=ht(e,"sess",8,""),d=ht(e,"shopId",8,""),c=ht(e,"estimateId",12,void 0),u=ht(e,"returnTo",8,"list"),h=Be(null),p=Be(!1),v=Be(!1),w=Be(!1),y=Be(!1),B=Be(""),C=Be(""),Q=Be(void 0),k=Be(!1),H=Be(!1),Z=Be(!1),q=!1,N=Be(""),re=Be("");function be(G){return G?G.length<4?{valid:!1,message:"  4  ."}:{valid:!0,message:""}:{valid:!1,message:" ."}}let L=Be(!1),R=Be(-1),J=Be(""),se=Be(-1),fe=[],ie=null,pe=!1;async function te(){var G;if(pe){console.log(" [Realtime]     ");return}if(!((G=l(h))!=null&&G.id)){console.log(" [Realtime]  ID ,  ");return}ie&&clearTimeout(ie),ie=setTimeout(async()=>{try{console.log(" [Realtime]    :",l(h).id),await M(l(h).id),console.log(" [Realtime]    ")}catch(le){console.error(" [Realtime]   :",le)}},300)}function Ce(G){console.log(" [Realtime]    :",G);const le=ug(G,qe=>{console.log(" [Realtime] Estimate  :",qe),_(h,qe),_(w,cc(qe.status))});fe.push(()=>le.unsubscribe());const Le=f5(G,qe=>{console.log(" [Realtime] EstimateItems  :",qe.eventType),te()});fe.push(()=>Le.unsubscribe());const He=w1(G,qe=>{console.log(" [Realtime] EstimatePrints  :",qe.eventType),te()});fe.push(()=>He.unsubscribe());const je=p5(G,qe=>{console.log(" [Realtime] EstimateSimplePrints  :",qe.eventType),te()});fe.push(()=>je.unsubscribe());const xe=g5(G,qe=>{console.log(" [Realtime] EstimateAddonItems  :",qe.eventType),te()});fe.push(()=>xe.unsubscribe());const Re=v5(G,qe=>{console.log(" [Realtime] EstimateAdditionalCosts  :",qe.eventType),te()});fe.push(()=>Re.unsubscribe());const et=m1(G,qe=>{console.log(" [Realtime] EstimateComments  :",qe.eventType)});fe.push(()=>et.unsubscribe()),console.log(" [Realtime]     (7 )")}function ne(){const{phone1:G,phone2:le,phone3:Le}=o();G&&le&&Le&&gt.update(He=>({...He,orderPhone:`${G}-${le}-${Le}`}))}function ze(G){if(G&&G.includes("-")){const le=G.split("-");le.length===3&&gt.update(Le=>({...Le,phone1:le[0]||"010",phone2:le[1]||"",phone3:le[2]||""}))}}function z(){return q?Promise.resolve():new Promise(G=>{const le=document.createElement("script");le.src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js",le.onload=()=>{q=!0,G()},document.head.appendChild(le)})}async function E(){try{await z(),new window.daum.Postcode({oncomplete(G){gt.update(le=>({...le,postcode:G.zonecode,address1:G.roadAddress||G.jibunAddress}))},onresize(G){}}).open()}catch{_(y,!0),_(B,"  "),_(C,"     .    .")}}to(async()=>{ni.set({id:d(),name:"",sess:A(),customer_id:a()}),Gl.set({name:"",phone:"",address1:"",address2:"",postcode:"",mallType:i()}),c()?await I(c()):await F()}),gs(()=>{fe.forEach(G=>{try{G()}catch(le){console.error("   :",le)}}),fe=[]});async function F(){_(p,!0);try{const G=await u1(i(),a(),A());G?(_(h,G),_(w,cc(G.status)),await P(G),Ce(G.id)):(gt.reset(),_(w,!0))}catch{_(y,!0),_(B," "),_(C,"     .")}finally{_(p,!1)}}async function I(G){_(p,!0);try{let le=await rd(G);if(le){const Le=!!(A()||a());if(O5(le)&&Le){console.log("[loadEstimateById]    ,   ...");const je=await F5(G,d(),A()||null,a()||null,i()||null);if(je.success&&je.newEstimateId){if(console.log(`[loadEstimateById]   : ${G}  ${je.newEstimateId}`),O(je.newEstimateId),le=await rd(je.newEstimateId),!le)throw new Error("    .");c(je.newEstimateId)}else{console.error("[loadEstimateById]   :",je.error),_(y,!0),_(B," "),_(C,`    : ${je.error}`);return}}_(h,le),_(w,cc(le.status)),await P(le),Ce(le.id)}else _(y,!0),_(B," "),_(C,"   .")}catch(le){console.error("[loadEstimateById] :",le),_(y,!0),_(B," "),_(C,"    .")}finally{_(p,!1)}}function O(G){try{const le=new URL(window.location.href);le.searchParams.set("estimateId",G),window.history.replaceState({},"",le.toString()),console.log(`[updateUrlWithNewEstimateId] URL  : ${le.toString()}`)}catch(le){console.error("[updateUrlWithNewEstimateId] URL  :",le)}}function D(G){const le={delivery:"",pickup:"",quick:""};return G&&le[G]||""}async function P(G){try{er(gt,dt(o).estimateName=G.name||"",dt(o)),er(gt,dt(o).organizationName=G.organization_name||"",dt(o)),er(gt,dt(o).orderName=G.order_name||"",dt(o)),er(gt,dt(o).orderPhone=G.order_phone||"",dt(o)),er(gt,dt(o).postcode=G.postcode||"",dt(o)),er(gt,dt(o).address1=G.address1||"",dt(o)),er(gt,dt(o).address2=G.address2||"",dt(o)),er(gt,dt(o).comment=G.comment||"",dt(o)),er(gt,dt(o).shippingMethod=D(G.shipping_method),dt(o)),er(gt,dt(o).prefDeliveryDate=G.pref_delivery_date||"",dt(o)),er(gt,dt(o).uploadMemo=G.upload_memo||"",dt(o)),er(gt,dt(o).designConfirm=G.design_confirm||"",dt(o)),G.order_phone&&ze(G.order_phone),await M(G.id)}catch(le){le instanceof SyntaxError&&le.message.includes("JSON")?(_(y,!0),_(B," "),_(C,"    .  .")):(_(y,!0),_(B," "),_(C,"    ."))}}function K(G){if(G==null)return null;if(typeof G=="object")return G;if(typeof G=="string")try{return JSON.parse(G)}catch{return null}return G}async function M(G){var le;try{const Le=await Xu(G),He=await Bc(G),je=await p1(G),xe=await hg(G),Re=await _1(G),et=[],qe={};for(const Pe of Le)if(Pe.product_id&&Pe.product){const Ye=Pe.idx||0;if(qe[Ye]||(qe[Ye]={product:Pe.product,variants:[],quantity:0,prints:[],addons:{},print_type:Pe.print_type||"none",simplePrints:[]}),Pe.variant_id&&Pe.quantity){const rt=Pe.original_price?parseFloat(Pe.original_price.toString()):0,lt=Pe.price?parseFloat(Pe.price.toString()):0,vt=rt>0,Ft=vt?rt:lt,Qt={id:Pe.variant_id,quantity:Pe.quantity,prices:[{amount:Ft}],thumbnail:((le=Pe.variant)==null?void 0:le.thumbnail)||null,title:Pe.variant_title||` ${Pe.variant_id.substring(0,4)}`,discountInfo:vt&&Pe.discount_amount?{discountAmount:Pe.discount_amount,discountType:Pe.discount_type,discountValue:Pe.discount_value,discountDirection:Pe.discount_direction}:void 0,isDiscountedPrice:!vt};qe[Ye].variants.push(Qt),qe[Ye].quantity+=Pe.quantity}}const ot=[];for(const Pe of He)if(Pe.template_id&&Pe.estimate_id){const Ye=Pe.idx||0;if(qe[Ye]){const rt=(async()=>{try{const lt=await ud(Pe.template_id),Ft={template:{id:Pe.template_id,name:lt.length>0&&lt[lt.length-1].name||""},parentTemplates:lt,price:Pe.price||0,colors:K(Pe.colors)||[],uploads:K(Pe.uploads)||null,title:lt.length>0?lt[0].name:"",objectId:Pe.object_id||null,variant_id:Pe.variant_id||null};qe[Ye].prints.push(Ft)}catch{const vt={template:{id:Pe.template_id,name:""},price:Pe.price||0,colors:K(Pe.colors)||[],uploads:K(Pe.uploads)||null,title:"",objectId:Pe.object_id||null,variant_id:Pe.variant_id||null};qe[Ye].prints.push(vt)}})();ot.push(rt)}}await Promise.all(ot);for(const Pe of je){const Ye=Pe.idx||0;qe[Ye]&&(qe[Ye].simplePrints||(qe[Ye].simplePrints=[]),qe[Ye].simplePrints.push({object_id:Pe.object_id||null,title:Pe.title||" ",print_method:Pe.print_method||"none",uploaded_files:K(Pe.uploaded_files)||null,file_metadata:K(Pe.file_metadata)||null,price:Pe.price||0}))}xe.forEach(Pe=>{const Ye=Pe.idx||0;qe[Ye]&&(qe[Ye].addons||(qe[Ye].addons={}),qe[Ye].addons[Pe.addon_id]={productId:Pe.selected_product_id,variantId:Pe.selected_variant_id||"",price:Pe.price||0,quantity:Pe.quantity||1})});for(const Pe in qe)et.push({...qe[Pe],idx:parseInt(Pe)});er(gt,dt(o).products=et,dt(o)),er(gt,dt(o).index=(et.length>0,0),dt(o)),gt.updateTotalAmounts()}catch(Le){throw Le instanceof SyntaxError&&Le.message.includes("JSON")?(_(y,!0),_(B," "),_(C,"     .  .")):(_(y,!0),_(B," "),_(C,"     .")),Le}}function ge(G){_(v,!1)}function _e(G){var le,Le;try{const He=o().products[G];if(!He||He.idx===void 0){_(y,!0),_(B," "),_(C,"    .");return}if(!((le=He.product)!=null&&le.id)){_(y,!0),_(B," "),_(C," ID   .");return}if(!((Le=l(h))!=null&&Le.id)){_(y,!0),_(B," "),_(C,"    .");return}_(R,G),_(J,He.product.id),_(se,He.idx),pe=!0,console.log(" [Edit]    - Realtime   "),_(L,!0)}catch{_(y,!0),_(B,""),_(C,"    .")}}function Me(){_(L,!1),_(R,-1),_(J,""),_(se,-1),pe=!1,console.log(" [Edit]    - Realtime   ")}async function $e(){var G,le,Le,He,je,xe,Re,et,qe,ot,Pe,Ye,rt,lt;_(k,!0);try{if(!((G=l(h))!=null&&G.id))throw new Error(" ID .");if(l(se)===-1)throw new Error(" idx  .");const vt=Er(gr);if(!vt||!vt.productSelection)throw new Error("  .");if(!vt.productSelection.quantityByVariant||Object.keys(vt.productSelection.quantityByVariant).length===0)throw new Error("   .");await N0(l(h).id,l(se));const Ft=[],{quantityByVariant:Qt,variantDiscounts:Et,variantsByColor:mt}=vt.productSelection;let Gt="none";const Ht=Er(gt).products;if(l(R)<0||l(R)>=Ht.length)throw console.error(" [Edit ] productIndex  :",{editingProductIndex:l(R),storeProductsLength:Ht.length}),new Error(`  . (productIndex: ${l(R)})`);const Ut=Ht[l(R)];(le=Ut==null?void 0:Ut.product)!=null&&le.id&&Ut.product.id!==vt.productId&&console.warn(" [Edit ] productIndex productId   (  ):",{editingProductIndex:l(R),editingIdx:l(se),storeProductId:Ut.product.id,currentProductId:vt.productId});const st=Ut==null?void 0:Ut.prints,pt=Ut==null?void 0:Ut.simplePrints;if(st&&Array.isArray(st)&&st.length>0)Gt="detailed";else if(pt&&Array.isArray(pt)&&pt.length>0)Gt="simple";else if((Le=vt.printSelection)!=null&&Le.currentMethod){const _t=vt.printSelection.currentMethod;(_t==="detailed"||_t==="simple"||_t==="self-design")&&(Gt=_t)}console.log(" [Edit ]  print_type:",Gt),console.log(" [Edit ] estimateStore.products[editingProductIndex]:",{editingProductIndex:l(R),editingIdx:l(se),prints:(st==null?void 0:st.length)||0,simplePrints:(pt==null?void 0:pt.length)||0,print_type:Ut==null?void 0:Ut.print_type}),console.log(" [Edit ] currentStore.printSelection:",vt.printSelection);for(const _t in Qt)for(const $t in Qt[_t]){const Rt=Qt[_t][$t];if(Rt>0){const Ot=Et==null?void 0:Et[$t],Ct=(He=mt[_t])==null?void 0:He.find(St=>St.id===$t),Wt=((xe=(je=Ct==null?void 0:Ct.prices)==null?void 0:je[0])==null?void 0:xe.amount)||0,It=(Ot==null?void 0:Ot.discountedPrice)||Wt;Ft.push({estimate_id:l(h).id,product_id:vt.productId,variant_id:$t,quantity:Rt,price:It,original_price:Wt,discount_amount:(Ot==null?void 0:Ot.discountAmount)||0,discount_type:((Re=Ot==null?void 0:Ot.discountInfo)==null?void 0:Re.type)||null,discount_value:((et=Ot==null?void 0:Ot.discountInfo)==null?void 0:et.value)||null,discount_direction:((qe=Ot==null?void 0:Ot.discountInfo)==null?void 0:qe.direction)||null,discount_min_quantity:((ot=Ot==null?void 0:Ot.discountInfo)==null?void 0:ot.min_quantity)||null,discount_max_quantity:((Pe=Ot==null?void 0:Ot.discountInfo)==null?void 0:Pe.max_quantity)||null,idx:l(se),print_type:Gt})}}if(Ft.length>0){const{error:_t}=await ft.from("estimate_items").insert(Ft);if(_t)throw new Error(`  : ${_t.message}`)}if(st&&Array.isArray(st)&&st.length>0){const _t=st,$t=((Ye=vt.productSelection)==null?void 0:Ye.totalQuantity)||0;async function Rt(Ct,Wt){var It,St,jt,dr;try{const pr=((It=Ct.template)==null?void 0:It.id)||Ct.template_id;if(!pr)return Ct.price||0;const ar=await Lc(pr);if(!(ar!=null&&ar.template_product_variants)||ar.template_product_variants.length===0)return Ct.price||0;let ur=null;Ct.variant_id&&(ur=ar.template_product_variants.find(Ar=>Ar.variant_id===Ct.variant_id)),!ur&&Array.isArray(Ct.colors)&&Ct.colors.length>0&&(ur=ar.template_product_variants.find(Ar=>Ar.color_count===Ct.colors.length)),ur||(ur=ar.template_product_variants[0]);const Ir=await hl(ur.variant_id),Yr=((jt=(St=Ir==null?void 0:Ir.prices)==null?void 0:St[0])==null?void 0:jt.amount)||0;if(ur.min_quantity&&Wt<ur.min_quantity)return ur.plate_price||0;let Jr=Yr;const qr=((dr=ar.product)==null?void 0:dr.quantity_discounts)||[];if(qr.length>0){const Ar=ia(Wt,Yr,qr);Ar!=null&&Ar.hasDiscount&&(Jr=Ar.discountedPrice)}return Jr*Wt}catch{return Ct.price||0}}const Ot=await Promise.all(_t.map(async Ct=>{var It,St,jt,dr,pr,ar,ur,Ir,Yr,Jr,qr,Ar,Lr;const Wt=await Rt(Ct,$t);return{estimate_id:l(h).id,template_id:((It=Ct.template)==null?void 0:It.id)||Ct.template_id||null,colors:Ct.colors||[],price:Wt,object_id:Ct.objectId||Ct.object_id||null,variant_id:Ct.variant_id||null,name_sheet:Ct.nameSheet||Ct.name_sheet||null,uploads:Ct.uploads||null,original_price:Ct.original_price||((St=Ct.discountInfo)==null?void 0:St.originalPrice)||Wt||0,discount_amount:Ct.discount_amount||((jt=Ct.discountInfo)==null?void 0:jt.discountAmount)||0,discount_type:Ct.discount_type||((pr=(dr=Ct.discountInfo)==null?void 0:dr.discountDetails)==null?void 0:pr.type)||null,discount_value:Ct.discount_value||((ur=(ar=Ct.discountInfo)==null?void 0:ar.discountDetails)==null?void 0:ur.value)||null,discount_direction:Ct.discount_direction||((Yr=(Ir=Ct.discountInfo)==null?void 0:Ir.discountDetails)==null?void 0:Yr.direction)||null,discount_min_quantity:Ct.discount_min_quantity||((qr=(Jr=Ct.discountInfo)==null?void 0:Jr.discountDetails)==null?void 0:qr.min_quantity)||null,discount_max_quantity:Ct.discount_max_quantity||((Lr=(Ar=Ct.discountInfo)==null?void 0:Ar.discountDetails)==null?void 0:Lr.max_quantity)||null,idx:l(se)}}));if(Ot.length>0){const{error:Ct}=await ft.from("estimate_prints").insert(Ot);if(Ct)throw new Error(`   : ${Ct.message}`)}}if(pt&&Array.isArray(pt)&&pt.length>0){const $t=pt.map(Rt=>({estimate_id:l(h).id,object_id:Rt.objectId||Rt.object_id||null,title:Rt.title||null,print_method:Rt.printMethod||Rt.print_method||null,uploaded_files:Rt.uploadedFiles||Rt.uploaded_files||null,file_metadata:Rt.savedFileInfo||Rt.file_metadata||null,price:Rt.price||0,idx:l(se)}));if($t.length>0){const{error:Rt}=await ft.from("estimate_simple_prints").insert($t);if(Rt)throw new Error(`   : ${Rt.message}`)}}if((rt=vt.addonSelection)!=null&&rt.selectedAddons){const _t=[],$t=((lt=vt.productSelection)==null?void 0:lt.totalQuantity)||0;for(const[Rt,Ot]of Object.entries(vt.addonSelection.selectedAddons)){const Ct=Ot;let Wt=0;if(Ct.variantId)try{const{data:It,error:St}=await ft.from("prices").select("amount").eq("variant_id",Ct.variantId).single();!St&&It&&(Wt=It.amount)}catch{}_t.push({estimate_id:l(h).id,addon_id:Rt,selected_product_id:Ct.productId,selected_variant_id:Ct.variantId||null,price:Wt,quantity:$t,idx:l(se)})}if(_t.length>0){const{error:Rt}=await ft.from("estimate_addon_items").insert(_t);if(Rt)throw new Error(`  : ${Rt.message}`)}}_(H,!0),setTimeout(()=>{_(H,!1)},3e3),Me(),await M(l(h).id)}catch(vt){let Ft="     .";vt instanceof Error&&(Ft=vt.message,vt.message.includes("duplicate key")?Ft="  .  .":vt.message.includes("foreign key")?Ft="   .     .":vt.message.includes("not null")?Ft="  .    .":vt.message.includes("permission")&&(Ft="   .  .")),_(y,!0),_(B," "),_(C,Ft)}finally{_(k,!1)}}async function Y(G){var le;try{const Le=o().products[G];if(!Le||Le.idx===void 0){_(y,!0),_(B," "),_(C,"    .");return}if(!((le=l(h))!=null&&le.id)){_(y,!0),_(B," "),_(C,"    .");return}await N0(l(h).id,Le.idx),er(gt,dt(o).products=o().products.filter((He,je)=>je!==G),dt(o)),gt.updateTotalAmounts()}catch{_(y,!0),_(B," "),_(C,"    .")}}function j(G){const le={:"delivery",:"pickup",:"quick"};return G&&le[G]||null}async function ee(){var G;if(!l(s)){_(y,!0),_(B," "),_(C,"    .");return}if(!a()){const le=be(l(N));if(!le.valid){_(re,le.message),_(y,!0),_(B," "),_(C,le.message);return}_(re,"")}ne(),_(k,!0);try{if(!((G=l(h))!=null&&G.id))throw new Error("  .");const le=j(o().shippingMethod);await xc(l(h).id,{name:o().estimateName,organization_name:o().organizationName,order_name:o().orderName,order_phone:o().orderPhone,postcode:o().postcode,address1:o().address1,address2:o().address2,comment:o().comment||null,shipping_method:le,pref_delivery_date:o().prefDeliveryDate||null,upload_memo:o().uploadMemo||null,design_confirm:o().designConfirm||"none",password:a()?null:l(N)}),await c5(l(h).id,"pending"),_(H,!0),setTimeout(()=>{_(H,!1)},3e3),_(y,!0),_(B," "),_(C,"  ."),_(Q,()=>{window.location.href="/odiz/list.php"})}catch(le){_(y,!0),_(B," "),_(C,le instanceof Error?le.message:"    ."),_(Q,void 0)}finally{_(k,!1)}}function ae(){_(Z,!0)}Yt(()=>o(),()=>{_(s,o().estimateName&&o().orderName&&o().phone1&&o().phone2&&o().phone3&&o().postcode&&o().address1)}),mo(),fn();var ue=Sq(),me=it(ue),ye=g(me);{var Ee=G=>{var le=fq();U(G,le)},de=G=>{var le=Cq(),Le=g(le);{var He=yt=>{var rr=pq(),Br=g(rr);At("click",Br,()=>window.location.href=`?mode=${u()}`),U(yt,rr)};ve(Le,yt=>{c()&&yt(He)})}var je=x(Le,2);{var xe=yt=>{var rr=gq(),Br=g(rr);l1(Br,{class:"odz-w-4 odz-h-4"}),U(yt,rr)};ve(je,yt=>{l(H)&&yt(xe)})}var Re=x(je,2),et=g(Re);{var qe=yt=>{M5(yt,{onSelectProduct:_e,onDeleteProduct:Y,get isEditable(){return l(w)},set isEditable(rr){_(w,rr)},$$legacy:!0})},ot=yt=>{var rr=mq(),Br=g(rr);zE(Br,{class:"odz-w-16 odz-h-16 odz-text-gray-300 odz-mx-auto odz-mb-4"});var gn=x(Br,4);{var Dn=Sr=>{var Xr=vq();At("click",Xr,()=>_(v,!0)),U(Sr,Xr)};ve(gn,Sr=>{l(w)&&Sr(Dn)})}U(yt,rr)};ve(et,yt=>{o().products&&o().products.length>0?yt(qe):yt(ot,!1)})}var Pe=x(Re,2),Ye=g(Pe),rt=g(Ye),lt=x(g(rt),2),vt=x(rt,2),Ft=x(g(vt),2),Qt=x(vt,2),Et=x(g(Qt),2),mt=x(Qt,2),Gt=x(g(mt),2),Ht=g(Gt);Ne(()=>{o(),Ru(()=>{l(w)})});var Ut=g(Ht);Ut.value=(Ut.__value="010")==null?"":"010";var st=x(Ut);st.value=(st.__value="011")==null?"":"011";var pt=x(st);pt.value=(pt.__value="016")==null?"":"016";var _t=x(pt);_t.value=(_t.__value="017")==null?"":"017";var $t=x(_t);$t.value=($t.__value="018")==null?"":"018";var Rt=x($t);Rt.value=(Rt.__value="019")==null?"":"019";var Ot=x(Ht,2),Ct=x(Ot,2),Wt=x(mt,4),It=x(g(Wt),2),St=g(It),jt=x(St,2),dr=x(Wt,2),pr=x(g(dr),2),ar=x(dr,2),ur=x(g(ar),2),Ir=x(ar,2),Yr=x(g(Ir),2);Ne(()=>{o(),Ru(()=>{l(w)})});var Jr=g(Yr);Jr.value=((Jr.__value="")==null,"");var qr=x(Jr);qr.value=(qr.__value="")==null?"":"";var Ar=x(qr);Ar.value=(Ar.__value="")==null?"":"";var Lr=x(Ar);Lr.value=(Lr.__value="")==null?"":"";var Kr=x(Ir,2),xr=x(g(Kr),2),Pr=x(Kr,2);{var Hr=yt=>{var rr=_q(),Br=x(g(rr),2),gn=g(Br);d1(gn,{class:"odz-absolute odz-left-3 odz-top-1/2 odz-transform odz--translate-y-1/2 odz-w-5 odz-h-5 odz-text-gray-400"});var Dn=x(gn,2),Sr=x(Br,2);{var Xr=Dt=>{var Mo=wq(),Nn=g(Mo);Ne(()=>Se(Nn,l(re))),U(Dt,Mo)},Fn=Dt=>{var Mo=yq();U(Dt,Mo)};ve(Sr,Dt=>{l(re)?Dt(Xr):Dt(Fn,!1)})}Ne(()=>{Dr(Dn,`odz-w-full odz-pl-10 odz-pr-4 odz-py-2.5 odz-border ${(l(re)?"odz-border-red-500":"odz-border-gray-300")??""} odz-rounded-lg odz-text-sm focus:odz-outline-none focus:odz-border-red-500 focus:odz-ring-1 focus:odz-ring-red-500 disabled:odz-bg-gray-50`),Dn.disabled=!l(w)}),Cr(Dn,()=>l(N),Dt=>_(N,Dt)),U(yt,rr)};ve(Pr,yt=>{a()||yt(Hr)})}var cn=x(Pr,2),pn=x(g(cn),2),Wr=x(Pe,2),wr=g(Wr),En=g(wr),Do=x(g(En),2),wo=g(Do),yo=x(En,2),vs=x(g(yo),2),io=g(vs),No=x(yo,2),Rn=x(g(No),2),Ve=g(Rn),wt=x(No,2);{var qt=yt=>{var rr=bq(),Br=x(g(rr),2),gn=g(Br);Ne(Dn=>Se(gn,`-${Dn??""}`),[()=>yr(o().totalDiscountAmount)],at),U(yt,rr)};ve(wt,yt=>{o().totalDiscountAmount>0&&yt(qt)})}var Kt=x(wt,2),kr=x(g(Kt),2),fr=g(kr),ir=x(Wr,2);{var Ur=yt=>{var rr=xq(),Br=g(rr),gn=g(Br);L0(gn,{class:"odz-w-5 odz-h-5"}),At("click",Br,ae),U(yt,rr)};ve(ir,yt=>{o().products&&o().products.length>0&&yt(Ur)})}var Or=x(ir,2);{var Yn=yt=>{var rr=zq(),Br=g(rr),gn=g(Br);{var Dn=Xr=>{var Fn=Bq();U(Xr,Fn)},Sr=Xr=>{var Fn=bn(" ");U(Xr,Fn)};ve(gn,Xr=>{l(k)?Xr(Dn):Xr(Sr,!1)})}Ne(()=>Br.disabled=l(k)||!l(s)),At("click",Br,ee),U(yt,rr)};ve(Or,yt=>{l(w)&&yt(Yn)})}Ne((yt,rr,Br)=>{lt.disabled=!l(w),Ft.disabled=!l(w),Et.disabled=!l(w),Ht.disabled=!l(w),Ot.disabled=!l(w),Ct.disabled=!l(w),jt.disabled=!l(w),ur.disabled=!l(w),Yr.disabled=!l(w),xr.disabled=!l(w),pn.disabled=!l(w),Se(wo,`${o().totalQuantity||0}`),Se(io,yt),Se(Ve,rr),Se(fr,Br)},[()=>yr(o().totalProductAmount),()=>yr(o().totalPrintAmount),()=>yr(o().totalAmount)],at),Cr(lt,()=>o().estimateName,yt=>er(gt,dt(o).estimateName=yt,dt(o))),Cr(Ft,()=>o().organizationName,yt=>er(gt,dt(o).organizationName=yt,dt(o))),Cr(Et,()=>o().orderName,yt=>er(gt,dt(o).orderName=yt,dt(o))),Ku(Ht,()=>o().phone1,yt=>er(gt,dt(o).phone1=yt,dt(o))),At("change",Ht,ne),Cr(Ot,()=>o().phone2,yt=>er(gt,dt(o).phone2=yt,dt(o))),At("input",Ot,ne),Cr(Ct,()=>o().phone3,yt=>er(gt,dt(o).phone3=yt,dt(o))),At("input",Ct,ne),Cr(St,()=>o().postcode,yt=>er(gt,dt(o).postcode=yt,dt(o))),At("click",jt,E),Cr(pr,()=>o().address1,yt=>er(gt,dt(o).address1=yt,dt(o))),Cr(ur,()=>o().address2,yt=>er(gt,dt(o).address2=yt,dt(o))),Ku(Yr,()=>o().shippingMethod,yt=>er(gt,dt(o).shippingMethod=yt,dt(o))),Cr(xr,()=>o().prefDeliveryDate,yt=>er(gt,dt(o).prefDeliveryDate=yt,dt(o))),Cr(pn,()=>o().comment,yt=>er(gt,dt(o).comment=yt,dt(o))),U(G,le)};ve(ye,G=>{l(p)?G(Ee):G(de,!1)})}var Qe=x(me,2);{var Fe=G=>{r2(G,{addProduct:ge,productType:"godo",get isProductSearchOpen(){return l(v)},set isProductSearchOpen(le){_(v,le)},$$legacy:!0})};ve(Qe,G=>{l(v)&&G(Fe)})}var Oe=x(Qe,2);{var Te=G=>{hq(G,{get isOpen(){return l(L)},get estimateId(){return l(h).id},get idx(){return l(se)},get productIndex(){return l(R)},get productId(){return l(J)},onClose:Me,onSave:$e})};ve(Oe,G=>{l(L)&&l(h)&&G(Te)})}var De=x(Oe,2);{var ce=G=>{Cz(G,{get isOpen(){return l(Z)},set isOpen(le){_(Z,le)},$$legacy:!0})};ve(De,G=>{l(Z)&&G(ce)})}var Ie=x(De,2);Pc(Ie,{get onClose(){return l(Q)},get isOpen(){return l(y)},set isOpen(G){_(y,G)},get title(){return l(B)},set title(G){_(B,G)},get message(){return l(C)},set message(G){_(C,G)},$$legacy:!0});var V=x(Ie,2);kc(V,{get isLoading(){return l(p)},set isLoading(G){_(p,G)},$$legacy:!0}),U(n,ue),dn(),r()}const V_={qnaId:null,title:"",content:"",customerName:"",customerPhone:"",customerEmail:"",products:[],nextIdx:0,editingIdx:null,editingProductId:null,isLoading:!1,isSaving:!1};function Fq(){const{subscribe:n,set:e,update:t}=ld({...V_});return{subscribe:n,reset:()=>{e({...V_})},setQnaId:r=>{t(o=>({...o,qnaId:r}))},setTitle:r=>{t(o=>({...o,title:r}))},setContent:r=>{t(o=>({...o,content:r}))},setCustomerInfo:(r,o,s)=>{t(i=>({...i,customerName:r,customerPhone:o,customerEmail:s}))},addProduct:r=>{t(o=>{const s={...r,idx:o.nextIdx};return{...o,products:[...o.products,s],nextIdx:o.nextIdx+1}})},updateProduct:(r,o)=>{t(s=>({...s,products:s.products.map(i=>i.idx===r?{...i,...o}:i)}))},removeProduct:r=>{t(o=>({...o,products:o.products.filter(s=>s.idx!==r)}))},setEditing:(r,o)=>{t(s=>({...s,editingIdx:r,editingProductId:o}))},clearEditing:()=>{t(r=>({...r,editingIdx:null,editingProductId:null}))},setLoading:r=>{t(o=>({...o,isLoading:r}))},setSaving:r=>{t(o=>({...o,isSaving:r}))},setState:r=>{t(o=>({...o,...r}))},getState:()=>Er({subscribe:n})}}const Yi=Fq();function rC(n,e,t){return`qna_product_${e}_${n||"new"}_${t}`}function nC(n,e,t,r){const o=rC(n,e,t);try{sessionStorage.setItem(o,JSON.stringify(r))}catch(s){console.error("[QnaStore] Failed to save to session:",s)}}function Iq(n,e,t){const r=rC(n,e,t);try{const o=sessionStorage.getItem(r);return o?JSON.parse(o):null}catch(o){return console.error("[QnaStore] Failed to load from session:",o),null}}function f0(n){try{const e=[];for(let t=0;t<sessionStorage.length;t++){const r=sessionStorage.key(t);r&&r.startsWith("qna_product_")&&r.includes(`_${n||"new"}_`)&&e.push(r)}e.forEach(t=>sessionStorage.removeItem(t))}catch(e){console.error("[QnaStore] Failed to clear all session:",e)}}async function Uq(n){const{data:e,error:t}=await ft.rpc("hash_inquiry_password",{plain_password:n});if(t)throw console.error("[QnaService] hashPassword error:",t),t;return e}async function Qq(n,e){const{data:t,error:r}=await ft.rpc("verify_inquiry_password",{inquiry_id_param:n,plain_password:e});if(r)throw console.error("[QnaService] verifyPassword error:",r),r;return t===!0}async function Tq(n,e){try{const t=await Wg(n);return t?t.customer_id?e&&t.customer_id===e?{canAccess:!0,requiresPassword:!1}:{canAccess:!1,requiresPassword:!1,message:"     ."}:{canAccess:!1,requiresPassword:!0,message:" ."}:{canAccess:!1,requiresPassword:!1,message:"   ."}}catch(t){return console.error("[QnaService] checkQnaAccess error:",t),{canAccess:!1,requiresPassword:!1,message:"     ."}}}async function Lq(n,e){try{return await Qq(n,e)?{canAccess:!0,requiresPassword:!1}:{canAccess:!1,requiresPassword:!0,message:"  ."}}catch(t){return console.error("[QnaService] accessQnaWithPassword error:",t),{canAccess:!1,requiresPassword:!0,message:"    ."}}}function Pq(){const n=new Date,e=n.getFullYear(),t=String(n.getMonth()+1).padStart(2,"0"),r=String(n.getDate()).padStart(2,"0"),o=String(n.getHours()).padStart(2,"0"),s=String(n.getMinutes()).padStart(2,"0"),i=String(Math.floor(Math.random()*1e3)).padStart(3,"0");return`Q${e}${t}${r}${o}${s}${i}`}async function kq(n){const e=Pq();let t;!n.customer_id&&n.password&&(t=await Uq(n.password));const{password:r,...o}=n,s={...o,inquiry_no:e,status:n.status||"pending"};t&&(s.password=t);const{data:i,error:a}=await ft.from("inquiries").insert(s).select().single();if(a)throw console.error("[QnaService] createQna error:",a),a;return i}async function Wg(n){const{data:e,error:t}=await ft.from("inquiries").select("*").eq("id",n).single();if(t){if(t.code==="PGRST116")return null;throw console.error("[QnaService] getQnaById error:",t),t}return e}async function Oq(n,e,t){let r=ft.from("inquiries").select("*").eq("shop_id",n).order("created_at",{ascending:!1});const{data:o,error:s}=await r;if(s)throw console.error("[QnaService] getQnaList error:",s),s;return o||[]}async function A2(n,e){const{data:t,error:r}=await ft.from("inquiries").update({...e,updated_at:new Date().toISOString()}).eq("id",n).select().single();if(r)throw console.error("[QnaService] updateQna error:",r),r;return t}async function oC(n,e){return A2(n,{status:e})}async function Dq(n){const{error:e}=await ft.from("inquiries").delete().eq("id",n);if(e)throw console.error("[QnaService] deleteQna error:",e),e}async function Nq(n,e){const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_items").insert(t).select();if(o)throw console.error("[QnaService] addQnaItems error:",o),o;return r||[]}async function l2(n){const{data:e,error:t}=await ft.from("inquiry_items").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaItems error:",t),t;return e||[]}async function Mq(n){const{error:e}=await ft.from("inquiry_items").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaItems error:",e),e}async function Hq(n,e){const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_prints").insert(t).select();if(o)throw console.error("[QnaService] addQnaPrints error:",o),o;return r||[]}async function d2(n){const{data:e,error:t}=await ft.from("inquiry_prints").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaPrints error:",t),t;return e||[]}async function jq(n){const{error:e}=await ft.from("inquiry_prints").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaPrints error:",e),e}async function sC(n,e){const{data:t,error:r}=await ft.from("inquiry_comments").insert({...e,inquiry_id:n}).select().single();if(r)throw console.error("[QnaService] addQnaComment error:",r),r;return e.writer==="manager"&&await oC(n,"answered"),t}async function Rq(n){const{data:e,error:t}=await ft.from("inquiry_comments").select("*").eq("inquiry_id",n).order("created_at",{ascending:!0});if(t)throw console.error("[QnaService] getQnaComments error:",t),t;return e||[]}async function qq(n){const{error:e}=await ft.from("inquiry_comments").delete().eq("id",n);if(e)throw console.error("[QnaService] deleteQnaComment error:",e),e}async function Kq(n){const e=await Wg(n);if(!e)throw new Error("   .");const t=await l2(n),r=await d2(n),o=await u2(n),s=await h2(n),i=await h1({shop_id:e.shop_id,customer_id:e.customer_id,name:e.title,order_name:e.customer_name,phone:e.customer_phone,email:e.customer_email,status:"temp",memo:`: ${e.inquiry_no}

${e.content}`});if(!i.id)throw new Error("  .");for(const a of t)await f1({estimate_id:i.id,idx:a.idx,product_id:a.product_id,variant_id:a.variant_id,quantity:a.quantity});for(const a of r)a.print_type==="simple"?await O0({estimate_id:i.id,idx:a.idx,object_id:a.object_id,title:a.title,print_method:a.print_method,uploaded_files:a.uploaded_files,file_metadata:a.file_metadata}):a.print_type==="detailed"&&await g1({estimate_id:i.id,idx:a.idx,object_id:a.object_id,template_id:a.template_id,colors:a.colors,uploads:a.uploaded_files});for(const a of o)await O0({estimate_id:i.id,idx:a.idx,object_id:a.object_id,print_method:a.print_method,template_id:a.template_id,selected_colors:a.selected_colors,print_config:a.print_config,uploads:a.uploads,name_sheet:a.name_sheet,memo:a.memo});for(const a of s)await y1({estimate_id:i.id,idx:a.idx,addon_id:a.addon_id,selected_product_id:a.selected_product_id,selected_variant_id:a.selected_variant_id});return await A2(n,{converted_estimate_id:i.id,status:"closed"}),await sC(n,{writer:"system",writer_name:"",content:` . (: ${i.estimate_no})`}),i.id}function $q(n,e){return ft.channel(`qna-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiries",filter:`id=eq.${n}`},e).subscribe()}function Vq(n,e){return ft.channel(`qna-list-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiries",filter:`shop_id=eq.${n}`},e).subscribe()}function Gq(n,e){return ft.channel(`qna-comments-${n}`).on("postgres_changes",{event:"*",schema:"public",table:"inquiry_comments",filter:`inquiry_id=eq.${n}`},e).subscribe()}function c2(n){n&&ft.removeChannel(n)}async function Wq(n,e){if(e.length===0)return[];const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_simple_prints").insert(t).select();if(o)throw console.error("[QnaService] addQnaSimplePrints error:",o),o;return r||[]}async function u2(n){const{data:e,error:t}=await ft.from("inquiry_simple_prints").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaSimplePrints error:",t),t;return e||[]}async function Xq(n){const{error:e}=await ft.from("inquiry_simple_prints").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaSimplePrints error:",e),e}async function Yq(n,e){if(e.length===0)return[];const t=e.map(s=>({...s,inquiry_id:n})),{data:r,error:o}=await ft.from("inquiry_addon_items").insert(t).select();if(o)throw console.error("[QnaService] addQnaAddonItems error:",o),o;return r||[]}async function h2(n){const{data:e,error:t}=await ft.from("inquiry_addon_items").select("*").eq("inquiry_id",n).order("idx",{ascending:!0});if(t)throw console.error("[QnaService] getQnaAddonItems error:",t),t;if(!e||e.length===0)return[];const r=[...new Set(e.map(h=>h.addon_id).filter(Boolean))],o=[...new Set(e.map(h=>h.selected_product_id).filter(Boolean))],s=[...new Set(e.map(h=>h.selected_variant_id).filter(Boolean))],[i,a,A]=await Promise.all([r.length>0?ft.from("product_addons").select("id, name").in("id",r):{data:[]},o.length>0?ft.from("products").select("id, title").in("id",o):{data:[]},s.length>0?ft.from("product_variants").select("id, title").in("id",s):{data:[]}]),d=new Map((i.data||[]).map(h=>[h.id,h.name])),c=new Map((a.data||[]).map(h=>[h.id,h.title])),u=new Map((A.data||[]).map(h=>[h.id,h.title]));return e.map(h=>({...h,addon_name:d.get(h.addon_id)||null,selected_product_name:c.get(h.selected_product_id)||null,selected_variant_name:u.get(h.selected_variant_id)||null}))}async function Jq(n){const{error:e}=await ft.from("inquiry_addon_items").delete().eq("inquiry_id",n);if(e)throw console.error("[QnaService] deleteAllQnaAddonItems error:",e),e}async function Zq(n){const{data:e}=await ft.from("inquiry_items").select("quantity, price").eq("inquiry_id",n);let t=0,r=0;if(e)for(const h of e){const p=h.quantity||0,v=h.price||0;t+=p*v,r+=p}const{data:o}=await ft.from("inquiry_prints").select("price").eq("inquiry_id",n);let s=0;if(o)for(const h of o)s+=h.price||0;const{data:i}=await ft.from("inquiry_simple_prints").select("price").eq("inquiry_id",n);if(i)for(const h of i)s+=h.price||0;const{data:a}=await ft.from("inquiry_addon_items").select("price, quantity").eq("inquiry_id",n);let A=0;if(a)for(const h of a){const p=h.quantity||1,v=h.price||0;A+=p*v}const{data:d}=await ft.from("inquiry_additional_costs").select("amount").eq("inquiry_id",n);let c=0;if(d)for(const h of d)c+=h.amount||0;const u=t+s+A+c;return{product_amount:t,print_amount:s,addon_amount:A,additional_amount:c,total_quantity:r,total_amount:u}}async function eK(n){const e=await Zq(n),{error:t}=await ft.from("inquiries").update({product_amount:e.product_amount,print_amount:e.print_amount,addon_amount:e.addon_amount,additional_amount:e.additional_amount,total_quantity:e.total_quantity,total_amount:e.total_amount,updated_at:new Date().toISOString()}).eq("id",n);if(t)throw console.error("[QnaService] updateInquirySummary error:",t),t}async function tK(n){const{data:e,error:t}=await ft.from("inquiry_estimates").select(`
      id,
      inquiry_id,
      estimate_id,
      created_at,
      created_by,
      memo,
      estimates:estimate_id (
        estimate_no,
        status,
        total_amount,
        created_at,
        name
      )
    `).eq("inquiry_id",n).order("created_at",{ascending:!1});if(t)throw console.error("[QnaService] getLinkedEstimates error:",t),t;return(e||[]).map(r=>({id:r.id,inquiry_id:r.inquiry_id,estimate_id:r.estimate_id,created_at:r.created_at,created_by:r.created_by,memo:r.memo,estimate:r.estimates}))}var rK=$(`<div class="odz-text-center odz-py-12 odz-bg-slate-50 odz-rounded-2xl odz-border odz-border-dashed odz-border-slate-300"><!> <p class="odz-text-slate-500 odz-font-bold">  .</p> <p class="odz-text-sm odz-text-slate-400 odz-mt-1">   ' '  .</p></div>`),nK=$('<div class="odz-flex odz-gap-1"><button type="button" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square" title=""><!></button> <button type="button" class="odz-btn odz-btn-ghost odz-btn-sm odz-btn-square odz-text-error" title=""><!></button></div>'),oK=$('<li class="odz-flex odz-justify-between"><span> </span> <span class="odz-font-bold odz-text-slate-800"> </span></li>'),sK=$('<div class="odz-mt-4 odz-bg-slate-50 odz-rounded-xl odz-p-3 odz-border odz-border-slate-100"><ul class="odz-text-sm odz-text-gray-600 odz-space-y-1.5"></ul></div>'),iK=$('<span class="odz-font-semibold odz-text-blue-900"> </span> <span class="odz-text-blue-300"></span>',1),aK=$('<span class="odz-text-gray-400"></span>'),AK=$('<span class="odz-text-blue-800"> </span> <!>',1),lK=$('<span class="odz-flex odz-items-center odz-gap-1"></span>'),dK=$("<span> </span>"),cK=$('<span class="odz-text-blue-500"> </span>'),uK=$('<span class="odz-text-gray-500"> </span>'),hK=$('<li class="odz-flex odz-flex-wrap odz-items-center odz-gap-1"><!> <!> <!> <!></li>'),fK=$('<div class="odz-mt-3 odz-bg-sky-50/50 odz-rounded-xl odz-p-3 odz-border odz-border-sky-100"><p class="odz-text-xs odz-font-medium odz-text-blue-800 odz-mb-1"> </p> <ul class="odz-text-xs odz-text-blue-700 odz-space-y-1"></ul></div>'),pK=$('<span class="odz-text-green-600"> </span>'),gK=$('<span class="odz-text-green-500"> </span>'),vK=$('<span class="odz-text-gray-500"> </span>'),mK=$('<li class="odz-flex odz-items-center odz-gap-1"><span> </span> <!> <!> <!></li>'),wK=$('<div class="odz-mt-3 odz-bg-emerald-50/50 odz-rounded-xl odz-p-3 odz-border odz-border-emerald-100"><p class="odz-text-xs odz-font-medium odz-text-green-800 odz-mb-1"> </p> <ul class="odz-text-xs odz-text-green-700 odz-space-y-1"></ul></div>'),yK=$('<span class="odz-text-purple-500"> </span>'),_K=$('<span class="odz-text-purple-600"> </span>'),bK=$('<span class="odz-text-purple-600 odz-font-medium odz-whitespace-nowrap"> </span>'),xK=$('<li class="odz-flex odz-items-center odz-justify-between"><span class="odz-flex odz-items-center odz-gap-1 odz-flex-wrap"><span class="odz-font-medium"> </span> <!> <!></span> <!></li>'),BK=$('<div class="odz-mt-3 odz-bg-purple-50/50 odz-rounded-xl odz-p-3 odz-border odz-border-purple-100"><p class="odz-text-xs odz-font-medium odz-text-purple-800 odz-mb-1"></p> <ul class="odz-text-xs odz-text-purple-700 odz-space-y-1"></ul></div>'),zK=$('<div class="odz-group odz-relative odz-bg-white odz-rounded-2xl odz-border odz-border-slate-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)] odz-transition-all hover:odz-shadow-[0_8px_30px_rgba(0,0,0,0.1)] hover:odz-border-primary/20"><div class="odz-card-body odz-p-4"><div class="odz-flex odz-items-start odz-justify-between"><div class="odz-flex-1"><h4 class="odz-font-bold odz-text-slate-900 odz-text-xl odz-tracking-tight"> </h4> <p class="odz-text-base odz-text-slate-500 odz-mt-1.5 odz-flex odz-items-center odz-gap-1"> : <span class="odz-font-bold odz-text-primary"> </span></p></div> <!></div> <div class="odz-mt-4 odz-pt-4 odz-border-t odz-border-gray-100 odz-space-y-3"><div class="odz-flex odz-items-start odz-gap-2.5 odz-text-base"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <div class="odz-flex odz-items-start odz-gap-2.5 odz-text-base"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <div class="odz-flex odz-items-start odz-gap-2.5 odz-text-base"><!> <div class="odz-flex-1"><span class="odz-text-gray-500">:</span> <span class="odz-text-gray-700 odz-ml-1"> </span></div></div> <!> <!> <!> <!></div></div></div>'),CK=$('<div class="odz-modal odz-modal-open" style="z-index: 9999;"><div class="odz-modal-box odz-max-w-sm"><h3 class="odz-font-bold odz-text-lg"> </h3> <p class="odz-py-4"> </p> <div class="odz-modal-action"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-error"></button></div></div> <button type="button" class="odz-modal-backdrop" aria-label=""></button></div>'),SK=$('<div class="odz-space-y-3"><!></div> <!>',1);function iC(n,e){ln(e,!1);const t=dg();let r=ht(e,"products",24,()=>[]),o=ht(e,"disabled",8,!1),s=Be(!1),i=Be(null),a=null,A=0;function d(q,N){q.stopPropagation(),q.preventDefault(),!o()&&t("edit",{idx:N.idx,productId:N.productId})}function c(q,N){if(q.stopPropagation(),q.preventDefault(),o())return;_(i,N);const re=q.currentTarget;a=re.closest(".odz-overflow-y-auto")||re.closest('[style*="overflow"]')||document.querySelector(".odz-modal-box"),a&&(A=a.scrollTop,a.scrollTop=0,a.classList.add("odz-overflow-hidden")),_(s,!0)}function u(){l(i)&&t("delete",{idx:l(i).idx}),a&&(a.classList.remove("odz-overflow-hidden"),a=null),_(s,!1),_(i,null)}function h(){a&&(a.classList.remove("odz-overflow-hidden"),a.scrollTop=A,a=null),_(s,!1),_(i,null)}function p(q){return!q.variants||q.variants.length===0?" ":q.variants.map(N=>`${N.variantName||N.variantId}: ${N.quantity}`).join(", ")}function v(q){const N=q.prints&&q.prints.length>0,re=q.simplePrints&&q.simplePrints.length>0;if(!N&&!re)return" ";const be=[];return N&&be.push(`  ${q.prints.length}`),re&&be.push(`  ${q.simplePrints.length}`),be.join(", ")}function w(q){return!q.addons||q.addons.length===0?" ":` ${q.addons.length}`}fn();var y=SK(),B=it(y),C=g(B);{var Q=q=>{var N=rK(),re=g(N);Gu(re,{class:"odz-w-16 odz-h-16 odz-mx-auto odz-text-slate-300 odz-mb-4"}),U(q,N)},k=q=>{var N=kt(),re=it(N);tr(re,1,r,be=>be.idx,(be,L)=>{var R=zK(),J=g(R),se=g(J),fe=g(se),ie=g(fe),pe=g(ie),te=x(ie,2),Ce=x(g(te)),ne=g(Ce),ze=x(fe,2);{var z=Te=>{var De=nK(),ce=g(De),Ie=g(ce);A5(Ie,{class:"odz-w-4 odz-h-4"});var V=x(ce,2),G=g(V);c1(G,{class:"odz-w-4 odz-h-4"}),At("click",ce,le=>d(le,l(L))),At("click",V,le=>c(le,l(L))),U(Te,De)};ve(ze,Te=>{o()||Te(z)})}var E=x(se,2),F=g(E),I=g(F);Gu(I,{class:"odz-w-5 odz-h-5 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var O=x(I,2),D=x(g(O),2),P=g(D),K=x(F,2),M=g(K);_E(M,{class:"odz-w-5 odz-h-5 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var ge=x(M,2),_e=x(g(ge),2),Me=g(_e),$e=x(K,2),Y=g($e);k0(Y,{class:"odz-w-5 odz-h-5 odz-text-gray-400 odz-mt-0.5 odz-flex-shrink-0"});var j=x(Y,2),ee=x(g(j),2),ae=g(ee),ue=x($e,2);{var me=Te=>{var De=sK(),ce=g(De);tr(ce,5,()=>l(L).variants,mr,(Ie,V)=>{var G=oK(),le=g(G),Le=g(le),He=x(le,2),je=g(He);Ne(()=>{Se(Le,l(V).variantName||l(V).variantId),Se(je,`${l(V).quantity??""}`)}),U(Ie,G)}),U(Te,De)};ve(ue,Te=>{l(L).variants&&l(L).variants.length>0&&Te(me)})}var ye=x(ue,2);{var Ee=Te=>{var De=fK(),ce=x(g(De),2);tr(ce,5,()=>l(L).prints,mr,(Ie,V)=>{var G=hK(),le=g(G);{var Le=Pe=>{var Ye=iK(),rt=it(Ye),lt=g(rt);Ne(()=>Se(lt,l(V).title)),U(Pe,Ye)};ve(le,Pe=>{l(V).title&&Pe(Le)})}var He=x(le,2);{var je=Pe=>{var Ye=lK();tr(Ye,5,()=>l(V).parentTemplates,mr,(rt,lt,vt)=>{var Ft=AK(),Qt=it(Ft),Et=g(Qt),mt=x(Qt,2);{var Gt=Ht=>{var Ut=aK();U(Ht,Ut)};ve(mt,Ht=>{vt<l(V).parentTemplates.length-1&&Ht(Gt)})}Ne(()=>Se(Et,l(lt).name)),U(rt,Ft)}),U(Pe,Ye)},xe=Pe=>{var Ye=kt(),rt=it(Ye);{var lt=vt=>{var Ft=dK(),Qt=g(Ft);Ne(()=>Se(Qt,`: ${(l(V).templateName||l(V).templateId)??""}`)),U(vt,Ft)};ve(rt,vt=>{l(V).templateId&&vt(lt)},!0)}U(Pe,Ye)};ve(He,Pe=>{l(V).parentTemplates&&l(V).parentTemplates.length>0?Pe(je):Pe(xe,!1)})}var Re=x(He,2);{var et=Pe=>{var Ye=cK(),rt=g(Ye);Ne(()=>Se(rt,`(${l(V).colors.length??""})`)),U(Pe,Ye)};ve(Re,Pe=>{l(V).colors&&Array.isArray(l(V).colors)&&l(V).colors.length>0&&Pe(et)})}var qe=x(Re,2);{var ot=Pe=>{var Ye=uK(),rt=g(Ye);Ne(()=>Se(rt,`- ${l(V).memo??""}`)),U(Pe,Ye)};ve(qe,Pe=>{l(V).memo&&Pe(ot)})}U(Ie,G)}),U(Te,De)};ve(ye,Te=>{l(L).prints&&l(L).prints.length>0&&Te(Ee)})}var de=x(ye,2);{var Qe=Te=>{var De=wK(),ce=x(g(De),2);tr(ce,5,()=>l(L).simplePrints,mr,(Ie,V)=>{var G=mK(),le=g(G),Le=g(le),He=x(le,2);{var je=ot=>{var Pe=pK(),Ye=g(Pe);Ne(()=>Se(Ye,`(${l(V).printMethod??""})`)),U(ot,Pe)};ve(He,ot=>{l(V).printMethod&&ot(je)})}var xe=x(He,2);{var Re=ot=>{var Pe=gK(),Ye=g(Pe);Ne(()=>Se(Ye,`(${l(V).selectedColors.length??""})`)),U(ot,Pe)};ve(xe,ot=>{l(V).selectedColors&&Array.isArray(l(V).selectedColors)&&l(V).selectedColors.length>0&&ot(Re)})}var et=x(xe,2);{var qe=ot=>{var Pe=vK(),Ye=g(Pe);Ne(()=>Se(Ye,`- ${l(V).memo??""}`)),U(ot,Pe)};ve(et,ot=>{l(V).memo&&ot(qe)})}Ne(()=>Se(Le,l(V).objectId||" ")),U(Ie,G)}),U(Te,De)};ve(de,Te=>{l(L).simplePrints&&l(L).simplePrints.length>0&&Te(Qe)})}var Fe=x(de,2);{var Oe=Te=>{var De=BK(),ce=x(g(De),2);tr(ce,5,()=>l(L).addons,mr,(Ie,V)=>{var G=xK(),le=g(G),Le=g(le),He=g(Le),je=x(Le,2);{var xe=Pe=>{var Ye=yK(),rt=g(Ye);Ne(()=>Se(rt,`(${l(V).selectedProductName||""}${(l(V).selectedVariantName?` - ${l(V).selectedVariantName}`:"")??""})`)),U(Pe,Ye)};ve(je,Pe=>{(l(V).selectedProductName||l(V).selectedVariantName)&&Pe(xe)})}var Re=x(je,2);{var et=Pe=>{var Ye=_K(),rt=g(Ye);Ne(()=>Se(rt,`x${l(V).quantity??""}`)),U(Pe,Ye)};ve(Re,Pe=>{l(V).quantity&&l(V).quantity>1&&Pe(et)})}var qe=x(le,2);{var ot=Pe=>{var Ye=bK(),rt=g(Ye);Ne(lt=>Se(rt,`${lt??""}`),[()=>l(V).price.toLocaleString()],at),U(Pe,Ye)};ve(qe,Pe=>{l(V).price&&Pe(ot)})}Ne(()=>Se(He,l(V).addonName||l(V).addonId)),U(Ie,G)}),U(Te,De)};ve(Fe,Te=>{l(L).addons&&l(L).addons.length>0&&Te(Oe)})}Ne((Te,De,ce)=>{Se(pe,l(L).productName||l(L).productId),Se(ne,l(L).totalQuantity),Se(P,Te),Se(Me,De),Se(ae,ce)},[()=>p(l(L)),()=>v(l(L)),()=>w(l(L))],at),U(be,R)}),U(q,N)};ve(C,q=>{r().length===0?q(Q):q(k,!1)})}var H=x(B,2);{var Z=q=>{var N=CK(),re=g(N),be=x(g(re),2),L=g(be),R=x(be,2),J=g(R),se=x(J,2),fe=x(re,2);Ne(()=>{var ie,pe;return Se(L,`'${(((ie=l(i))==null?void 0:ie.productName)||((pe=l(i))==null?void 0:pe.productId))??""}' 
        ?`)}),At("click",J,h),At("click",se,u),At("click",fe,h),U(q,N)};ve(H,q=>{l(s)&&q(Z)})}U(n,y),dn()}var EK=$('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <p class="odz-ml-4 odz-text-gray-600">  ...</p></div>'),FK=$('<div class="odz-alert odz-alert-error"><svg xmlns="http://www.w3.org/2000/svg" class="odz-stroke-current odz-shrink-0 odz-h-6 odz-w-6" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span> </span></div>'),IK=$('<dialog class="odz-modal odz-modal-open odiz-app odz-items-center odz-justify-center"><div class="odz-modal-box odz-w-[90vw] odz-max-w-[1200px] odz-h-[90vh] odz-p-0 odz-relative odz-rounded-xl odz-shadow-2xl odz-bg-white"><div class="odz-sticky odz-top-0 odz-z-10 odz-bg-white odz-border-b odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-between odz-items-center"><h3 class="odz-text-lg odz-font-bold odz-text-gray-900"> </h3> <button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost"><!></button></div> <div class="odz-overflow-y-auto odz-h-[calc(90vh-140px)] odz-px-6 odz-py-4"><!></div> <div class="odz-sticky odz-bottom-0 odz-z-10 odz-bg-white odz-border-t odz-border-gray-200 odz-px-6 odz-py-4 odz-flex odz-justify-end odz-gap-2"><button class="odz-btn odz-btn-ghost"></button> <button class="odz-btn odz-btn-primary"> </button></div></div></dialog>');function UK(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(Yi,"$qnaStore",t),s=Be(),i=Be(),a=dg();let A=ht(e,"isOpen",8,!1),d=ht(e,"productId",8),c=ht(e,"shopId",8);ht(e,"mallType",8,"");let u=ht(e,"qnaId",8,null),h=ht(e,"editingIdx",8,null),p=Be(!0),v=Be(""),w=Be(),y=Be("");async function B(){try{_(p,!0),_(v,"");const F=await uh(d(),c());if(_(y,(F==null?void 0:F.title)||(F==null?void 0:F.name)||d()),h()!==null){const I=Iq(u(),d(),h());I?await Q(I):await C()}else await C();_(p,!1)}catch(F){console.error("[QnaProductSelector]  :",F),F instanceof Error?_(v,F.message):_(v,"     ."),_(p,!1)}}async function C(){k();const F=Date.now().toString(36)+Math.random().toString(36).substr(2),I={productId:d(),productSelection:{selectedColors:[],quantityByVariant:{},totalQuantity:0,variantsData:[]},printSelection:null,addonSelection:null,additionalInfo:null,currentStep:"product",isDebugMode:!1,sessionId:F,estimateId:l(s)};if(gr.set(I),typeof window<"u"){const O=`fixedEstimate_${d()}_${l(s)}_${l(i)}`;window.sessionStorage.setItem(O,JSON.stringify(I))}}async function Q(F){const I=Date.now().toString(36)+Math.random().toString(36).substr(2),O={productId:d(),productSelection:F.productSelection||{selectedColors:[],quantityByVariant:{},totalQuantity:0,variantsData:[]},printSelection:F.printSelection||null,addonSelection:F.addonSelection||null,additionalInfo:F.additionalInfo||null,currentStep:"product",isDebugMode:!1,sessionId:I,estimateId:l(s)};if(typeof window<"u"){const D=`fixedEstimate_${d()}_${l(s)}_${l(i)}`,P=`simplePrint_${d()}_${l(s)}`,K=`detailedPrint_${d()}_${l(s)}`;window.sessionStorage.removeItem(P),window.sessionStorage.removeItem(K),window.sessionStorage.setItem(D,JSON.stringify(O)),F.simplePrintState&&(window.sessionStorage.setItem(P,JSON.stringify(F.simplePrintState)),console.log("[QnaProductSelector] simplePrint  :",F.simplePrintState)),F.detailedPrintState&&(window.sessionStorage.setItem(K,JSON.stringify(F.detailedPrintState)),console.log("[QnaProductSelector] detailedPrint  :",F.detailedPrintState))}gr.set(O),await new Promise(D=>setTimeout(D,50))}function k(){typeof window<"u"&&[`fixedEstimate_${d()}_${l(s)}_${l(i)}`,`simplePrint_${d()}_${l(s)}`,`detailedPrint_${d()}_${l(s)}`,`tab-state-${d()}`].forEach(I=>window.sessionStorage.removeItem(I))}function H(){var F,I,O,D;try{const P=Er(gr);if(!P.productSelection||P.productSelection.totalQuantity===0){alert("   .");return}const K=[],M=P.productSelection.quantityByVariant||{},ge=P.productSelection.variantsByColor||{};for(const[ye,Ee]of Object.entries(M)){if(typeof Ee!="object"||Ee===null)continue;const de=ge[ye]||[];for(const[Qe,Fe]of Object.entries(Ee))if(Fe&&Number(Fe)>0){const Oe=de.find(De=>De.id===Qe),Te=((I=(F=Oe==null?void 0:Oe.prices)==null?void 0:F[0])==null?void 0:I.amount)||0;K.push({variantId:Qe,variantName:(Oe==null?void 0:Oe.name)||(Oe==null?void 0:Oe.title)||`${ye} - ${Qe}`,quantity:Number(Fe),price:Te,optionValues:(Oe==null?void 0:Oe.optionValues)||{color:ye}})}}const _e=[],Me=[],$e=[],j=Er(gt).products[l(i)],ee=j==null?void 0:j.simplePrints,ae=j==null?void 0:j.prints;if(console.log("[QnaProductSelector]   :",{currentIdx:l(i),hasSimplePrints:(ee==null?void 0:ee.length)||0,hasDetailedPrints:(ae==null?void 0:ae.length)||0,printMethod:(O=P.printSelection)==null?void 0:O.currentMethod}),P.printSelection){const ye=P.printSelection.currentMethod;ye==="simple"?ee&&Array.isArray(ee)&&ee.length>0&&ee.forEach(Ee=>{Me.push({objectId:Ee.objectId,printMethod:Ee.printMethod,templateId:Ee.templateId,selectedColors:Ee.selectedColors,printConfig:Ee.printConfig,uploads:Ee.uploadedFiles||Ee.uploads,nameSheet:Ee.nameSheet,memo:Ee.memo,price:Ee.price||0})}):ye==="detailed"&&ae&&Array.isArray(ae)&&ae.length>0&&ae.forEach(Ee=>{var Qe,Fe,Oe;const de=[];Ee.parentTemplates&&Array.isArray(Ee.parentTemplates)&&Ee.parentTemplates.forEach(Te=>{de.push({id:Te.id,name:Te.name||Te.id})}),(Qe=Ee.template)!=null&&Qe.id&&de.push({id:Ee.template.id,name:Ee.template.name||Ee.template.id}),_e.push({objectId:Ee.objectId,printType:"detailed",templateId:(Fe=Ee.template)==null?void 0:Fe.id,templateName:(Oe=Ee.template)==null?void 0:Oe.name,parentTemplates:de.length>0?de:void 0,colors:Ee.colors,uploadedFiles:Ee.uploads,memo:Ee.memo,price:Ee.price||0})})}if(console.log("[QnaProductSelector] currentState.addonSelection:",P.addonSelection),(D=P.addonSelection)!=null&&D.selectedAddons){const ye=P.addonSelection.selectedAddons;console.log("[QnaProductSelector] selectedAddons entries:",Object.entries(ye));for(const[Ee,de]of Object.entries(ye))if(console.log("[QnaProductSelector] Processing addon:",{addonId:Ee,selection:de}),de&&typeof de=="object"){const Qe=de;console.log("[QnaProductSelector] sel.productId:",Qe.productId),Qe.productId?($e.push({addonId:Ee,selectedProductId:Qe.productId,selectedVariantId:Qe.variantId,price:Qe.price||0,quantity:Qe.quantity||1}),console.log("[QnaProductSelector] Addon added to array:",$e[$e.length-1])):console.log("[QnaProductSelector] Addon skipped - no productId")}}else console.log("[QnaProductSelector] No selectedAddons in addonSelection");console.log("[QnaProductSelector] Final addons array:",$e);const ue={productId:d(),productName:l(y),variants:K,prints:_e,simplePrints:Me,addons:$e,totalQuantity:P.productSelection.totalQuantity||0},me={productSelection:P.productSelection,printSelection:P.printSelection,addonSelection:P.addonSelection,additionalInfo:P.additionalInfo,simplePrintState:null,detailedPrintState:null};ee&&Array.isArray(ee)&&ee.length>0&&(me.simplePrintState=ee),ae&&Array.isArray(ae)&&ae.length>0&&(me.detailedPrintState=ae),nC(u(),d(),l(i),me),a("save",{idx:l(i),productData:ue,isEdit:h()!==null}),Z()}catch(P){console.error("[QnaProductSelector]  :",P),alert("   .")}}function Z(){k(),gr.reset(),a("close")}function q(F){F.key==="Escape"&&Z()}function N(F){F.target===l(w)&&Z()}gs(()=>{document.body.style.overflow="",k(),gr.reset()}),Yt(()=>oo(u()),()=>{_(s,`qna_${u()||"new"}`)}),Yt(()=>(oo(h()),o()),()=>{_(i,h()??o().nextIdx)}),Yt(()=>(l(w),oo(A())),()=>{l(w)&&(A()?(document.body.style.overflow="hidden",window.scrollTo(0,0),document.querySelectorAll('.odz-modal-box, .odz-overflow-y-auto, [style*="overflow"]').forEach(I=>{I instanceof HTMLElement&&(I.scrollTop=0)}),l(w).showModal(),B()):(document.body.style.overflow="",l(w).close()))}),mo(),fn();var re=IK(),be=g(re),L=g(be),R=g(L),J=g(R),se=x(R,2),fe=g(se);xA(fe,{class:"odz-w-5 odz-h-5"});var ie=x(L,2),pe=g(ie);{var te=F=>{var I=EK();U(F,I)},Ce=F=>{var I=kt(),O=it(I);{var D=K=>{var M=FK(),ge=x(g(M),2),_e=g(ge);Ne(()=>Se(_e,l(v))),U(K,M)},P=K=>{Du(K,{get productId(){return d()},get estimateId(){return l(s)},get idx(){return l(i)},onSave:H})};ve(O,K=>{l(v)?K(D):K(P,!1)},!0)}U(F,I)};ve(pe,F=>{l(p)?F(te):F(Ce,!1)})}var ne=x(ie,2),ze=g(ne),z=x(ze,2),E=g(z);fs(re,F=>_(w,F),()=>l(w)),Ne(()=>{Se(J,`${(h()!==null?" ":" ")??""} - ${(l(y)||d())??""}`),z.disabled=l(p),Se(E,h()!==null?"":"")}),At("click",se,Z),At("click",ze,Z),At("click",z,H),At("keydown",re,q),At("click",re,N),U(n,re),dn(),r()}var QK=$('<div class="loading-state svelte-azeior"><div class="loading-spinner svelte-azeior"><!></div> <p class="odz-text-slate-500 odz-mt-4 odz-text-sm svelte-azeior"> ...</p></div>'),TK=$('<div class="section-badge svelte-azeior"><!></div>'),LK=$('<span class="field-error svelte-azeior">4  </span>'),PK=$('<span class="field-error svelte-azeior">  </span>'),kK=$('<div class="password-section svelte-azeior"><div class="password-header svelte-azeior"><!> <div class="svelte-azeior"><h4 class="password-title svelte-azeior">  </h4> <p class="password-desc svelte-azeior">      (4~16)</p></div></div> <div class="password-fields svelte-azeior"><div class="form-field svelte-azeior"><label class="field-label svelte-azeior" for="password"> <span class="required svelte-azeior">*</span></label> <input type="password" id="password" placeholder=" " minlength="4" maxlength="16" class="text-input svelte-azeior"> <!></div> <div class="form-field svelte-azeior"><label class="field-label svelte-azeior" for="passwordConfirm">  <span class="required svelte-azeior">*</span></label> <input type="password" id="passwordConfirm" placeholder=" " maxlength="16" class="text-input svelte-azeior"> <!></div></div></div>'),OK=$('<div class="section-badge svelte-azeior"><!></div>'),DK=$('<div class="product-list-container svelte-azeior"><!></div>'),NK=$('<div class="empty-products svelte-azeior"><div class="empty-icon svelte-azeior"><!></div> <p class="empty-title svelte-azeior">  </p> <p class="empty-desc svelte-azeior">   </p> <button type="button" class="empty-add-btn svelte-azeior"><!>  </button></div>'),MK=$('<!> <span class="svelte-azeior"> ...</span>',1),HK=$('<!> <span class="svelte-azeior"> </span>',1),jK=$('<header class="qna-header svelte-azeior"><div class="header-content svelte-azeior"><div class="header-title-area svelte-azeior"><div class="header-icon svelte-azeior"><!></div> <div class="svelte-azeior"><h1 class="header-title svelte-azeior"> </h1> <p class="header-subtitle svelte-azeior">     </p></div></div> <button type="button" class="close-button svelte-azeior" title=""><!></button></div> <div class="progress-indicator svelte-azeior"><div class="progress-step svelte-azeior"><div class="step-icon svelte-azeior"><!></div> <span class="step-label svelte-azeior"></span></div> <div class="progress-line svelte-azeior"></div> <div class="progress-step svelte-azeior"><div class="step-icon svelte-azeior"><!></div> <span class="step-label svelte-azeior"></span></div> <div class="progress-line svelte-azeior"></div> <div class="progress-step svelte-azeior"><div class="step-icon svelte-azeior"><!></div> <span class="step-label svelte-azeior"></span></div></div></header> <main class="qna-main svelte-azeior"><section class="form-section svelte-azeior"><div class="section-header svelte-azeior"><div class="section-icon svelte-azeior"><!></div> <div class="section-title-area svelte-azeior"><h2 class="section-title svelte-azeior"> </h2> <p class="section-desc svelte-azeior">    </p></div> <!></div> <div class="form-field svelte-azeior" style="margin-bottom: 20px;"><label class="field-label svelte-azeior" for="customerName"> <span class="required svelte-azeior">*</span></label> <div class="input-wrapper svelte-azeior" style="position: relative;"><!> <input type="text" id="customerName" placeholder=" " class="text-input with-icon svelte-azeior" style="padding-left: 42px;"></div></div> <div class="form-field svelte-azeior" style="margin-bottom: 20px;"><label class="field-label svelte-azeior" for="customerPhone"></label> <div class="input-wrapper svelte-azeior" style="position: relative;"><!> <div class="phone-input-group svelte-azeior" style="padding-left: 42px;"><input type="text" placeholder="010" maxlength="3" class="phone-input svelte-azeior"> <span class="phone-separator svelte-azeior">-</span> <input type="text" placeholder="0000" maxlength="4" class="phone-input svelte-azeior"> <span class="phone-separator svelte-azeior">-</span> <input type="text" placeholder="0000" maxlength="4" class="phone-input svelte-azeior"></div></div></div> <div class="form-field svelte-azeior"><label class="field-label svelte-azeior" for="customerEmail"></label> <div class="input-wrapper svelte-azeior" style="position: relative;"><!> <input type="email" id="customerEmail" placeholder="example@email.com" class="text-input with-icon svelte-azeior" style="padding-left: 42px;"></div></div> <!></section> <section class="form-section svelte-azeior"><div class="section-header svelte-azeior"><div class="section-icon svelte-azeior"><!></div> <div class="section-title-area svelte-azeior"><h2 class="section-title svelte-azeior"> </h2> <p class="section-desc svelte-azeior">    </p></div> <!></div> <div class="form-stack svelte-azeior"><div class="form-field svelte-azeior"><label class="field-label svelte-azeior" for="title"> <span class="required svelte-azeior">*</span></label> <input type="text" id="title" placeholder="  " class="text-input svelte-azeior"></div> <div class="form-field svelte-azeior"><label class="field-label svelte-azeior" for="content"> <span class="required svelte-azeior">*</span></label> <textarea id="content" placeholder="    .  : -     -     -    " rows="8" class="textarea-input svelte-azeior"></textarea> <div class="field-hint svelte-azeior"><span class="char-count svelte-azeior"> </span></div></div></div></section> <section class="form-section product-section svelte-azeior"><div class="section-header svelte-azeior"><div class="section-icon product-icon svelte-azeior"><!></div> <div class="section-title-area svelte-azeior"><h2 class="section-title svelte-azeior">  <span class="optional-badge svelte-azeior"></span></h2> <p class="section-desc svelte-azeior">   </p></div> <button type="button" class="add-product-btn svelte-azeior"><!> <span class="svelte-azeior"> </span></button></div> <!></section></main> <footer class="action-bar svelte-azeior"><div class="action-content svelte-azeior"><button type="button" class="cancel-btn svelte-azeior"></button> <button type="button" class="submit-btn svelte-azeior"><!></button></div></footer>',1),RK=$(`<div class="qna-register-container odiz-app svelte-azeior" style="
    --primary: #d01b22;
    --primary-dark: #b01820;
    --primary-light: #fef2f2;
    --gray-50: #f8fafc;
    --gray-100: #f1f5f9;
    --gray-200: #e2e8f0;
    --gray-300: #cbd5e1;
    --gray-400: #94a3b8;
    --gray-500: #64748b;
    --gray-600: #475569;
    --gray-700: #334155;
    --gray-800: #1e293b;
    --gray-900: #0f172a;
    --amber-50: #fffbeb;
    --amber-100: #fef3c7;
    --amber-500: #f59e0b;
    --amber-600: #d97706;
    --green-500: #22c55e;
    --green-600: #16a34a;
    --radius-sm: 8px;
    --radius-md: 12px;
    --radius-lg: 16px;
    --radius-xl: 20px;
    --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
    --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
    --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
    --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
    min-height: 100%;
    background: linear-gradient(180deg, #f8fafc 0%, #fff 100%);
    display: flex;
    flex-direction: column;
  "><!> <!> <!> <dialog class="cancel-dialog svelte-azeior"><div class="cancel-dialog-content svelte-azeior"><div class="cancel-dialog-icon svelte-azeior"><!></div> <h3 class="cancel-dialog-title svelte-azeior"> ?</h3> <p class="cancel-dialog-desc svelte-azeior">    .</p> <div class="cancel-dialog-actions svelte-azeior"><button type="button" class="dialog-btn-secondary svelte-azeior"> </button> <button type="button" class="dialog-btn-danger svelte-azeior"></button></div></div></dialog></div>`);function qK(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(Yi,"$qnaStore",t),s=Be(),i=Be(),a=Be(),A=Be(),d=Be(),c=Be(),u=Be(),h=Be();let p=ht(e,"mallType",8,""),v=ht(e,"customerId",8,"");ht(e,"sess",8,"");let w=ht(e,"shopId",8,""),y=ht(e,"qnaId",8,""),B=ht(e,"onSubmitSuccess",8,void 0),C=ht(e,"onCancel",8,void 0),Q=Be(""),k=Be(""),H=Be(""),Z=Be(""),q=Be(""),N=Be(""),re=Be(""),be=Be(!1),L=Be(!1),R=Be(!1),J=Be(!1),se=Be(""),fe=Be(),ie=Be(),pe=Be();function te(){l(Z).length>=3&&l(ie)&&l(ie).focus()}function Ce(){l(q).length>=4&&l(pe)&&l(pe).focus()}let ne=null,ze=Be([]),z=Be(""),E=Be("");to(async()=>{Yi.reset(),y()&&await F()}),gs(()=>{Yi.reset(),f0(y()||null)});async function F(){_(be,!0);try{if(ne=await Wg(y()),ne){if(_(Q,ne.title||""),_(k,ne.content||""),_(H,ne.customer_name||""),_(re,ne.customer_email||""),ne.customer_phone){const Le=ne.customer_phone.split("-");Le.length===3&&(_(Z,Le[0]),_(q,Le[1]),_(N,Le[2]))}const ce=await l2(y()),Ie=await d2(y()),V=await u2(y()),G=await h2(y()),le=new Map;for(const Le of ce){const He=Le.idx||0;le.has(He)||le.set(He,{idx:He,productId:Le.product_id,productName:Le.product_name,variants:[],prints:[],simplePrints:[],addons:[],totalQuantity:0});const je=le.get(He);je.variants.push({variantId:Le.variant_id,variantName:Le.variant_name,quantity:Le.quantity||1,optionValues:Le.option_values}),je.totalQuantity+=Le.quantity||1}for(const Le of Ie){const He=Le.idx||0;if(le.has(He)){let je=[];if(Le.template_id)try{je=(await ud(Le.template_id)).map(et=>({id:et.id,name:et.name,image_url:et.image_url})),console.log("[QnaRegister] parentTemplates :",je)}catch(Re){console.warn("[QnaRegister] parentTemplates  :",Re)}let xe=Le.title;if(!xe&&Le.object_id)try{const Re=await fg(Le.object_id);Re&&(xe=Re.title||Re.name,console.log("[QnaRegister] print area title :",xe))}catch(Re){console.warn("[QnaRegister] print area  :",Re)}le.get(He).prints.push({objectId:Le.object_id,printType:Le.print_type,title:xe,printMethod:Le.print_method,templateId:Le.template_id,colors:Le.colors,uploadedFiles:Le.uploaded_files,fileMetadata:Le.file_metadata,memo:Le.memo,parentTemplates:je})}}for(const Le of V){const He=Le.idx||0;le.has(He)&&le.get(He).simplePrints.push({objectId:Le.object_id,printMethod:Le.print_method,templateId:Le.template_id,selectedColors:Le.selected_colors,printConfig:Le.print_config,uploads:Le.uploads,nameSheet:Le.name_sheet,memo:Le.memo})}for(const Le of G){const He=Le.idx||0;le.has(He)&&le.get(He).addons.push({addonId:Le.addon_id,addonName:Le.addon_name||void 0,selectedProductId:Le.selected_product_id,selectedProductName:Le.selected_product_name||void 0,selectedVariantId:Le.selected_variant_id,selectedVariantName:Le.selected_variant_name||void 0,price:Le.price||0,quantity:Le.quantity||1})}_(ze,Array.from(le.values())),Yi.setState({qnaId:y(),title:l(Q),content:l(k),customerName:l(H),customerPhone:l(d),customerEmail:l(re),products:l(ze),nextIdx:l(ze).length>0?Math.max(...l(ze).map(Le=>Le.idx))+1:0})}}catch(ce){console.error("[QnaRegister] loadQna error:",ce),alert("   .")}finally{_(be,!1)}}function I(){_(R,!0)}function O(ce){_(R,!1),_(se,ce),_(J,!0)}function D(ce){const{productData:Ie,isEdit:V,idx:G}=ce.detail;Ie&&(V&&G!==void 0?Yi.updateProduct(G,Ie):Yi.addProduct(Ie),_(ze,[...o().products])),_(J,!1),_(se,""),Yi.clearEditing()}function P(ce){var le,Le;const{idx:Ie,productId:V}=ce.detail,G=o().products.find(He=>He.idx===Ie);if(G){const He={},je=[];for(const Pe of G.variants){const Ye=((le=Pe.optionValues)==null?void 0:le.color)||((Le=Pe.optionValues)==null?void 0:Le.)||"default";He[Ye]||(He[Ye]={},je.push(Ye)),He[Ye][Pe.variantId]=Pe.quantity}const xe={};for(const Pe of G.addons||[])xe[Pe.addonId]={productId:Pe.selectedProductId,variantId:Pe.selectedVariantId,price:Pe.price||0,quantity:Pe.quantity||1};let Re=null,et=null,qe=null;G.simplePrints&&G.simplePrints.length>0&&(Re=G.simplePrints.map(Pe=>({objectId:Pe.objectId,printMethod:Pe.printMethod,templateId:Pe.templateId,selectedColors:Pe.selectedColors,printConfig:Pe.printConfig,uploadedFiles:Pe.uploads,uploads:Pe.uploads,nameSheet:Pe.nameSheet,memo:Pe.memo,price:Pe.price||0})),qe={currentMethod:"simple"}),G.prints&&G.prints.length>0&&(et=G.prints.map(Pe=>({objectId:Pe.objectId,title:Pe.title,template:Pe.templateId?{id:Pe.templateId,name:Pe.templateName||Pe.title}:null,parentTemplates:Pe.parentTemplates||[],colors:Pe.colors,uploads:Pe.uploadedFiles,memo:Pe.memo,price:Pe.price||0})),qe={currentMethod:"detailed"},console.log("[QnaRegister] detailedPrintState :",et));const ot={productSelection:{selectedColors:je,quantityByVariant:He,totalQuantity:G.totalQuantity,variantsData:[]},printSelection:qe,addonSelection:{selectedAddons:xe},additionalInfo:null,simplePrintState:Re,detailedPrintState:et};nC(o().qnaId,V,Ie,ot),console.log("[QnaRegister]    sessionStorage :",{idx:Ie,productId:V,sessionData:ot})}Yi.setEditing(Ie,V),_(se,V),_(J,!0)}function K(ce){const{idx:Ie}=ce.detail;Yi.removeProduct(Ie),_(ze,[...o().products])}async function M(ce){if(ce&&(ce.stopPropagation(),ce.preventDefault()),!l(A)){l(s)&&!y()?l(z)?l(z).length<4?alert(" 4  ."):l(z)!==l(E)?alert("  ."):alert(", ,    ."):alert("   ."):alert(", ,    .");return}_(L,!0);try{let Ie;if(y()&&ne?(Ie=await A2(y(),{title:l(Q),content:l(k),customer_name:l(H),customer_phone:l(d),customer_email:l(re)}),await Mq(y()),await jq(y()),await Xq(y()),await Jq(y())):Ie=await kq({shop_id:w(),customer_id:v()||void 0,customer_name:l(H),customer_phone:l(d),customer_email:l(re),title:l(Q),content:l(k),password:l(s)?l(z):void 0}),!Ie.id)throw new Error("  .");const V=o().products;if(V.length>0){const G=[];for(const je of V)for(const xe of je.variants)G.push({idx:je.idx,product_id:je.productId,variant_id:xe.variantId,quantity:xe.quantity,price:xe.price||0,product_name:je.productName,variant_name:xe.variantName,option_values:xe.optionValues});G.length>0&&await Nq(Ie.id,G);const le=[];for(const je of V)for(const xe of je.prints||[])le.push({idx:je.idx,object_id:xe.objectId,print_type:xe.printType,title:xe.title,print_method:xe.printMethod,template_id:xe.templateId,colors:xe.colors,uploaded_files:xe.uploadedFiles,file_metadata:xe.fileMetadata,memo:xe.memo,price:xe.price||0});le.length>0&&await Hq(Ie.id,le);const Le=[];for(const je of V)for(const xe of je.simplePrints||[])Le.push({idx:je.idx,object_id:xe.objectId,print_method:xe.printMethod,template_id:xe.templateId,selected_colors:xe.selectedColors,print_config:xe.printConfig,uploads:xe.uploads,name_sheet:xe.nameSheet,memo:xe.memo,price:xe.price||0});Le.length>0&&await Wq(Ie.id,Le);const He=[];console.log("[QnaRegister] Processing addon save for products:",V.map(je=>{var xe;return{idx:je.idx,productId:je.productId,addonsCount:((xe=je.addons)==null?void 0:xe.length)||0,addons:je.addons}}));for(const je of V){console.log("[QnaRegister] Product addons:",je.addons);for(const xe of je.addons||[])He.push({idx:je.idx,addon_id:xe.addonId,selected_product_id:xe.selectedProductId,selected_variant_id:xe.selectedVariantId,price:xe.price||0,quantity:xe.quantity||1})}console.log("[QnaRegister] addonsToSave:",He),He.length>0?(console.log("[QnaRegister] Saving addons to database..."),await Yq(Ie.id,He),console.log("[QnaRegister] Addons saved successfully")):console.log("[QnaRegister] No addons to save"),await eK(Ie.id)}if(f0(y()||null),B()&&Ie.id)B()(Ie.id);else{const G=y()?`?qnaMode=detail&qnaId=${Ie.id}`:"?qnaMode=list";window.location.href=window.location.pathname+G}}catch(Ie){console.error("[QnaRegister] submitQna error:",Ie),alert("  .  .")}finally{_(L,!1)}}function ge(ce){ce.stopPropagation(),ce.preventDefault(),l(fe)&&l(fe).showModal()}function _e(){l(fe)&&l(fe).close(),f0(y()||null),C()?C()():window.location.href=window.location.pathname+"?qnaMode=list"}function Me(){l(fe)&&l(fe).close()}Yt(()=>oo(v()),()=>{_(s,!v())}),Yt(()=>(l(z),l(E)),()=>{_(i,!l(z)||!l(E)||l(z)===l(E))}),Yt(()=>(l(s),oo(y()),l(z),l(i)),()=>{_(a,!l(s)||!y()&&l(z).length>=4&&l(z).length<=16&&l(i))}),Yt(()=>(l(Q),l(k),l(H),oo(v()),oo(y()),l(z),l(E)),()=>{_(A,l(Q).trim()&&l(k).trim()&&l(H).trim()&&(v()||y()||l(z).trim()&&l(z)===l(E)&&l(z).length>=4))}),Yt(()=>(l(Z),l(q),l(N)),()=>{_(d,l(Z)&&l(q)&&l(N)?`${l(Z)}-${l(q)}-${l(N)}`:"")}),Yt(()=>l(H),()=>{_(c,l(H).trim().length>0)}),Yt(()=>(l(Q),l(k)),()=>{_(u,l(Q).trim().length>0&&l(k).trim().length>0)}),Yt(()=>(l(s),oo(y()),l(z),l(i)),()=>{_(h,!l(s)||y()||l(z).length>=4&&l(i))}),mo(),fn();var $e=RK(),Y=g($e);{var j=ce=>{var Ie=QK(),V=g(Ie),G=g(V);dc(G,{class:"odz-w-10 odz-h-10 odz-animate-spin"}),U(ce,Ie)},ee=ce=>{var Ie=jK(),V=it(Ie),G=g(V),le=g(G),Le=g(le),He=g(Le);a5(He,{class:"odz-w-6 odz-h-6"});var je=x(Le,2),xe=g(je),Re=g(xe),et=x(le,2),qe=g(et);xA(qe,{class:"odz-w-5 odz-h-5"});var ot=x(G,2),Pe=g(ot),Ye=g(Pe),rt=g(Ye);{var lt=Vt=>{su(Vt,{class:"odz-w-4 odz-h-4"})},vt=Vt=>{Wl(Vt,{class:"odz-w-4 odz-h-4"})};ve(rt,Vt=>{l(c)?Vt(lt):Vt(vt,!1)})}var Ft=x(Pe,2),Qt=x(Ft,2),Et=g(Qt),mt=g(Et);{var Gt=Vt=>{su(Vt,{class:"odz-w-4 odz-h-4"})},Ht=Vt=>{ec(Vt,{class:"odz-w-4 odz-h-4"})};ve(mt,Vt=>{l(u)?Vt(Gt):Vt(Ht,!1)})}var Ut=x(Qt,2),st=x(Ut,2),pt=g(st),_t=g(pt);{var $t=Vt=>{su(Vt,{class:"odz-w-4 odz-h-4"})},Rt=Vt=>{k0(Vt,{class:"odz-w-4 odz-h-4"})};ve(_t,Vt=>{l(ze).length>0?Vt($t):Vt(Rt,!1)})}var Ot=x(V,2),Ct=g(Ot),Wt=g(Ct),It=g(Wt),St=g(It);Wl(St,{class:"odz-w-5 odz-h-5"});var jt=x(It,4);{var dr=Vt=>{var en=TK(),In=g(en);su(In,{class:"odz-w-4 odz-h-4"}),U(Vt,en)};ve(jt,Vt=>{l(c)&&Vt(dr)})}var pr=x(Wt,2),ar=x(g(pr),2),ur=g(ar);Wl(ur,{class:"input-icon",style:"position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #94a3b8; pointer-events: none;"});var Ir=x(ur,2),Yr=x(pr,2),Jr=x(g(Yr),2),qr=g(Jr);P0(qr,{class:"input-icon",style:"position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #94a3b8; pointer-events: none; z-index: 1;"});var Ar=x(qr,2),Lr=g(Ar),Kr=x(Lr,4);fs(Kr,Vt=>_(ie,Vt),()=>l(ie));var xr=x(Kr,4);fs(xr,Vt=>_(pe,Vt),()=>l(pe));var Pr=x(Yr,2),Hr=x(g(Pr),2),cn=g(Hr);yE(cn,{class:"input-icon",style:"position: absolute; left: 14px; top: 50%; transform: translateY(-50%); width: 18px; height: 18px; color: #94a3b8; pointer-events: none;"});var pn=x(cn,2),Wr=x(Pr,2);{var wr=Vt=>{var en=kK(),In=g(en),fo=g(In);wE(fo,{class:"odz-w-5 odz-h-5 odz-text-amber-600"});var Qo=x(In,2),ai=g(Qo),Bi=x(g(ai),2),zi=x(Bi,2);{var Ai=Jn=>{var tn=LK();U(Jn,tn)};ve(zi,Jn=>{l(z)&&l(z).length<4&&Jn(Ai)})}var qs=x(ai,2),ji=x(g(qs),2),qn=x(ji,2);{var Go=Jn=>{var tn=PK();U(Jn,tn)};ve(qn,Jn=>{l(E)&&!l(i)&&Jn(Go)})}Ne(()=>{Cs(Bi,"input-error",l(z)&&l(z).length<4),Cs(ji,"input-error",l(E)&&!l(i))}),Cr(Bi,()=>l(z),Jn=>_(z,Jn)),Cr(ji,()=>l(E),Jn=>_(E,Jn)),U(Vt,en)};ve(Wr,Vt=>{l(s)&&!y()&&Vt(wr)})}var En=x(Ct,2),Do=g(En),wo=g(Do),yo=g(wo);ec(yo,{class:"odz-w-5 odz-h-5"});var vs=x(wo,4);{var io=Vt=>{var en=OK(),In=g(en);su(In,{class:"odz-w-4 odz-h-4"}),U(Vt,en)};ve(vs,Vt=>{l(u)&&Vt(io)})}var No=x(Do,2),Rn=g(No),Ve=x(g(Rn),2),wt=x(Rn,2),qt=x(g(wt),2),Kt=x(qt,2),kr=g(Kt),fr=g(kr),ir=x(En,2),Ur=g(ir),Or=g(Ur),Yn=g(Or);k0(Yn,{class:"odz-w-5 odz-h-5"});var yt=x(Or,4),rr=g(yt);Wu(rr,{class:"odz-w-4 odz-h-4"});var Br=x(Ur,2);{var gn=Vt=>{var en=DK(),In=g(en);iC(In,{get products(){return l(ze)},$$events:{edit:P,delete:K}}),U(Vt,en)},Dn=Vt=>{var en=NK(),In=g(en),fo=g(In);Gu(fo,{class:"odz-w-12 odz-h-12"});var Qo=x(In,6),ai=g(Qo);Wu(ai,{class:"odz-w-4 odz-h-4"}),At("click",Qo,I),U(Vt,en)};ve(Br,Vt=>{l(ze).length>0?Vt(gn):Vt(Dn,!1)})}var Sr=x(Ot,2),Xr=g(Sr),Fn=g(Xr),Dt=x(Fn,2),Mo=g(Dt);{var Nn=Vt=>{var en=MK(),In=it(en);dc(In,{class:"odz-w-5 odz-h-5 odz-animate-spin"}),U(Vt,en)},Zr=Vt=>{var en=HK(),In=it(en);xE(In,{class:"odz-w-5 odz-h-5"});var fo=x(In,2),Qo=g(fo);Ne(()=>Se(Qo,y()?" ":" ")),U(Vt,en)};ve(Mo,Vt=>{l(L)?Vt(Nn):Vt(Zr,!1)})}Ne(()=>{Se(Re,y()?" ":" "),Cs(Pe,"completed",l(c)),Cs(Ft,"active",l(c)),Cs(Qt,"completed",l(u)),Cs(Ut,"active",l(u)),Cs(st,"completed",l(ze).length>0),Cs(Ct,"section-complete",l(c)),Cs(En,"section-complete",l(u)),Se(fr,`${l(k).length??""}`),Cs(ir,"section-complete",l(ze).length>0),Dt.disabled=!l(A)||l(L)}),At("click",et,Vt=>ge(Vt)),Cr(Ir,()=>l(H),Vt=>_(H,Vt)),Cr(Lr,()=>l(Z),Vt=>_(Z,Vt)),At("input",Lr,te),Cr(Kr,()=>l(q),Vt=>_(q,Vt)),At("input",Kr,Ce),Cr(xr,()=>l(N),Vt=>_(N,Vt)),Cr(pn,()=>l(re),Vt=>_(re,Vt)),Cr(Ve,()=>l(Q),Vt=>_(Q,Vt)),Cr(qt,()=>l(k),Vt=>_(k,Vt)),At("click",yt,I),At("click",Fn,Vt=>ge(Vt)),At("click",Dt,Vt=>M(Vt)),U(ce,Ie)};ve(Y,ce=>{l(be)?ce(j):ce(ee,!1)})}var ae=x(Y,2);{var ue=ce=>{r2(ce,{addProduct:O,get productType(){return p()},excludeNoProcess:!0,get isProductSearchOpen(){return l(R)},set isProductSearchOpen(Ie){_(R,Ie)},$$legacy:!0})};ve(ae,ce=>{l(R)&&ce(ue)})}var me=x(ae,2);{var ye=ce=>{const Ie=at(()=>y()||null);UK(ce,{get isOpen(){return l(J)},get productId(){return l(se)},get shopId(){return w()},get mallType(){return p()},get qnaId(){return l(Ie)},get editingIdx(){return o().editingIdx},$$events:{save:D,close:()=>{_(J,!1),_(se,""),Yi.clearEditing()}}})};ve(me,ce=>{l(J)&&ce(ye)})}var Ee=x(me,2),de=g(Ee),Qe=g(de),Fe=g(Qe);xA(Fe,{class:"odz-w-6 odz-h-6"});var Oe=x(Qe,6),Te=g(Oe),De=x(Te,2);fs(Ee,ce=>_(fe,ce),()=>l(fe)),At("click",Te,Me),At("click",De,_e),At("click",Ee,Ob(Me)),U(n,$e),dn(),r()}var KK=$(' <span class="odz-font-mono odz-font-medium odz-text-primary"> </span>',1),$K=$('<label class="odz-label"><span class="odz-label-text-alt odz-text-error"> </span></label>'),VK=$("<!>  ...",1),GK=$('<div class="odz-modal odz-modal-open"><div class="odz-modal-box odz-max-w-sm"><button type="button" class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"><!></button> <h3 class="odz-font-bold odz-text-lg odz-mb-4 odz-flex odz-items-center odz-gap-2"><!>  </h3> <p class="odz-text-sm odz-text-gray-600 odz-mb-4"><!>  .</p> <div class="odz-form-control odz-mb-4"><input type="password" placeholder=" (4~16)" maxlength="16" autocomplete="new-password" class="odz-input odz-input-bordered odz-w-full"> <!></div> <div class="odz-modal-action"><button type="button" class="odz-btn odz-btn-ghost"></button> <button type="button" class="odz-btn odz-btn-primary"><!></button></div></div></div>');function WK(n,e){ln(e,!1);let t=ht(e,"isOpen",8,!1),r=ht(e,"qnaId",8,""),o=ht(e,"inquiryNo",8,"");const s=dg();let i=Be(""),a=Be(!1),A=Be("");async function d(){if(!l(i).trim()){_(A," .");return}if(l(i).length<4){_(A," 4  .");return}_(a,!0),_(A,""),s("verify",{qnaId:r(),password:l(i)})}function c(y,B){_(a,!1),!y&&B&&_(A,B)}function u(){_(i,""),_(A,""),_(a,!1),s("cancel")}function h(y){y.key==="Enter"&&!l(a)?d():y.key==="Escape"&&u()}Yt(()=>oo(t()),()=>{t()&&(_(i,""),_(A,""),_(a,!1))}),mo(),fn();var p=kt(),v=it(p);{var w=y=>{var B=GK(),C=g(B),Q=g(C),k=g(Q);xA(k,{class:"odz-w-4 odz-h-4"});var H=x(Q,2),Z=g(H);d1(Z,{class:"odz-w-5 odz-h-5 odz-text-warning"});var q=x(H,2),N=g(q);{var re=ne=>{var ze=KK(),z=x(it(ze)),E=g(z);Ne(()=>Se(E,o())),U(ne,ze)};ve(N,ne=>{o()&&ne(re)})}var be=x(q,2),L=g(be),R=x(L,2);{var J=ne=>{var ze=$K(),z=g(ze),E=g(z);Ne(()=>Se(E,l(A))),U(ne,ze)};ve(R,ne=>{l(A)&&ne(J)})}var se=x(be,2),fe=g(se),ie=x(fe,2),pe=g(ie);{var te=ne=>{var ze=VK(),z=it(ze);dc(z,{class:"odz-w-4 odz-h-4 odz-animate-spin odz-mr-2"}),U(ne,ze)},Ce=ne=>{var ze=bn("");U(ne,ze)};ve(pe,ne=>{l(a)?ne(te):ne(Ce,!1)})}Ne(ne=>{Q.disabled=l(a),L.disabled=l(a),Cs(L,"odz-input-error",l(A)),fe.disabled=l(a),ie.disabled=ne},[()=>l(a)||!l(i).trim()],at),At("click",Q,u),Cr(L,()=>l(i),ne=>_(i,ne)),At("keydown",L,h),At("click",fe,u),At("click",ie,d),At("click",B,Ob(u)),U(y,B)};ve(v,y=>{t()&&y(w)})}return U(n,p),Pb(e,"setVerifyResult",c),dn({setVerifyResult:c})}var XK=$('<button class="odz-btn odz-btn-primary odz-btn-sm odz-gap-1"><!>  </button>'),YK=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-16 odz-gap-4"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-text-gray-500">   ...</span></div>'),JK=$('<div class="odz-alert odz-alert-error"><!> <span> </span> <button class="odz-btn odz-btn-sm odz-btn-ghost"> </button></div>'),ZK=$('<button class="odz-btn odz-btn-primary odz-btn-sm odz-mt-4 odz-gap-1"><!>   </button>'),e$=$('<p class="odz-text-gray-600 odz-font-medium">  </p> <p class="odz-text-sm odz-text-gray-400 odz-mt-1">  </p> <!>',1),t$=$('<p class="odz-text-gray-600 odz-font-medium">  </p> <p class="odz-text-sm odz-text-gray-400 odz-mt-1">   </p>',1),r$=$('<div class="odz-text-center odz-py-12 odz-bg-gray-50 odz-rounded-lg odz-border odz-border-gray-200"><!> <!></div>'),n$=$('<span class="odz-badge odz-badge-xs odz-badge-info"></span>'),o$=$('<tr class="odz-cursor-pointer hover:odz-bg-blue-50/50 odz-transition-colors"><td class="odz-text-center odz-py-3"><span class="odz-inline-flex odz-items-center odz-gap-1 odz-text-sm odz-text-gray-500"> <!></span></td><td class="odz-text-center odz-py-3"><span> </span></td><td class="odz-py-3"><div class="odz-flex odz-items-center odz-gap-2"><span class="odz-text-sm odz-text-gray-800 odz-truncate odz-max-w-xs hover:odz-text-primary hover:odz-underline odz-transition-colors"> </span> <!></div></td><td class="odz-text-center odz-text-sm odz-text-gray-500 odz-py-3 odz-hidden sm:odz-table-cell odz-whitespace-nowrap"> </td><td class="odz-text-center odz-text-sm odz-text-gray-400 odz-py-3 odz-hidden md:odz-table-cell"> </td></tr>'),s$=$('<span class="odz-text-gray-300"> </span>'),i$=$('<div class="odz-bg-white odz-rounded-lg odz-border odz-border-gray-200 odz-overflow-hidden"><table class="odz-table odz-table-sm odz-w-full"><thead><tr class="odz-bg-gray-50 odz-border-b odz-border-gray-200"><th class="odz-text-center odz-w-24 odz-text-xs odz-font-medium odz-text-gray-600"></th><th class="odz-text-center odz-w-24 odz-text-xs odz-font-medium odz-text-gray-600"></th><th class="odz-text-left odz-text-xs odz-font-medium odz-text-gray-600"></th><th class="odz-text-center odz-w-24 odz-text-xs odz-font-medium odz-text-gray-600 odz-hidden sm:odz-table-cell"></th><th class="odz-text-center odz-w-32 odz-text-xs odz-font-medium odz-text-gray-600 odz-hidden md:odz-table-cell"></th></tr></thead><tbody class="odz-divide-y odz-divide-gray-100"></tbody></table></div> <div class="odz-text-center odz-text-xs odz-text-gray-400 odz-pt-2"> <!></div>',1),a$=$('<div class="odz-space-y-4"><div class="odz-flex odz-items-center odz-justify-between odz-pb-4 odz-border-b odz-border-gray-200"><h2 class="odz-text-xl odz-font-bold odz-text-gray-900"> </h2> <!></div> <div class="odz-flex odz-flex-col sm:odz-flex-row odz-gap-2"><div class="odz-relative odz-flex-1"><!> <input type="search" placeholder=", ,  ..." class="odz-input odz-input-bordered odz-input-sm odz-w-full odz-pl-9" autocomplete="off"></div> <select class="odz-select odz-select-bordered odz-select-sm odz-w-full sm:odz-w-32"><option></option><option></option><option></option><option></option></select></div> <!></div> <!>',1);function A$(n,e){ln(e,!1);let t=ht(e,"shopId",8),r=ht(e,"customerId",8,void 0),o=ht(e,"onSelectQna",8,void 0),s=ht(e,"onCreateNew",8,void 0),i=Be([]),a=Be([]),A=Be(!0),d=Be(""),c=Be(""),u=Be("all"),h=null,p=Be(!1),v=Be(null),w=Be();to(async()=>{await y(),B()}),gs(()=>{h&&c2(h)});async function y(){try{_(A,!0),_(d,""),_(i,await Oq(t(),r()))}catch(P){console.error("[QnaList]   :",P),_(d,"     .")}finally{_(A,!1)}}function B(){h=Vq(t(),async P=>{console.log("[QnaList]  :",P),await y()})}function C(P){switch(P){case"pending":return{label:"",class:"odz-badge-warning",icon:bp};case"answered":return{label:"",class:"odz-badge-success",icon:l1};case"closed":return{label:"",class:"odz-badge-neutral",icon:Vu};default:return{label:"",class:"odz-badge-ghost",icon:bp}}}function Q(P){return P?new Date(P).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}async function k(P){if(P.id)try{const K=await Tq(P.id,r());K.canAccess?o()&&o()(P.id):K.requiresPassword?(_(v,P),_(p,!0)):alert(K.message||"  .")}catch(K){console.error("[QnaList]    :",K),alert("     .")}}async function H(P){const{qnaId:K,password:M}=P.detail;try{const ge=await Lq(K,M);ge.canAccess?(_(p,!1),_(v,null),o()&&o()(K)):l(w)&&l(w).setVerifyResult(!1,ge.message||"  .")}catch(ge){console.error("[QnaList]   :",ge),l(w)&&l(w).setVerifyResult(!1,"    .")}}function Z(){_(p,!1),_(v,null)}function q(){s()&&s()()}Yt(()=>(l(i),l(c),l(u)),()=>{let P=l(i);if(l(c).trim()){const K=l(c).toLowerCase();P=P.filter(M=>{var ge,_e,Me;return((ge=M.title)==null?void 0:ge.toLowerCase().includes(K))||((_e=M.customer_name)==null?void 0:_e.toLowerCase().includes(K))||((Me=M.inquiry_no)==null?void 0:Me.toLowerCase().includes(K))})}l(u)!=="all"&&(P=P.filter(K=>K.status===l(u))),_(a,P)}),mo(),fn();var N=a$(),re=it(N),be=g(re),L=x(g(be),2);{var R=P=>{var K=XK(),M=g(K);Wu(M,{class:"odz-w-4 odz-h-4"}),At("click",K,q),U(P,K)};ve(L,P=>{s()&&P(R)})}var J=x(be,2),se=g(J),fe=g(se);xp(fe,{class:"odz-absolute odz-left-3 odz-top-1/2 odz--translate-y-1/2 odz-w-4 odz-h-4 odz-text-gray-400"});var ie=x(fe,2),pe=x(se,2);Ne(()=>{l(u),Ru(()=>{})});var te=g(pe);te.value=(te.__value="all")==null?"":"all";var Ce=x(te);Ce.value=(Ce.__value="pending")==null?"":"pending";var ne=x(Ce);ne.value=(ne.__value="answered")==null?"":"answered";var ze=x(ne);ze.value=(ze.__value="closed")==null?"":"closed";var z=x(J,2);{var E=P=>{var K=YK();U(P,K)},F=P=>{var K=kt(),M=it(K);{var ge=Me=>{var $e=JK(),Y=g($e);Vu(Y,{class:"odz-w-5 odz-h-5"});var j=x(Y,2),ee=g(j),ae=x(j,2);Ne(()=>Se(ee,l(d))),At("click",ae,y),U(Me,$e)},_e=Me=>{var $e=kt(),Y=it($e);{var j=ae=>{var ue=r$(),me=g(ue);a5(me,{class:"odz-w-10 odz-h-10 odz-mx-auto odz-text-gray-300 odz-mb-3"});var ye=x(me,2);{var Ee=Qe=>{var Fe=e$(),Oe=x(it(Fe),4);{var Te=De=>{var ce=ZK(),Ie=g(ce);Wu(Ie,{class:"odz-w-4 odz-h-4"}),At("click",ce,q),U(De,ce)};ve(Oe,De=>{s()&&De(Te)})}U(Qe,Fe)},de=Qe=>{var Fe=t$();U(Qe,Fe)};ve(ye,Qe=>{l(i).length===0?Qe(Ee):Qe(de,!1)})}U(ae,ue)},ee=ae=>{var ue=i$(),me=it(ue),ye=g(me),Ee=x(g(ye));tr(Ee,5,()=>l(a),Te=>Te.id,(Te,De)=>{var ce=o$();const Ie=at(()=>C(l(De).status));var V=g(ce),G=g(V),le=g(G),Le=x(le);{var He=Et=>{d1(Et,{class:"odz-w-3 odz-h-3 odz-text-amber-500",title:" "})};ve(Le,Et=>{l(De).customer_id||Et(He)})}var je=x(V),xe=g(je),Re=g(xe),et=x(je),qe=g(et),ot=g(qe),Pe=g(ot),Ye=x(ot,2);{var rt=Et=>{var mt=n$();U(Et,mt)};ve(Ye,Et=>{l(De).converted_estimate_id&&Et(rt)})}var lt=x(et),vt=g(lt),Ft=x(lt),Qt=g(Ft);Ne(Et=>{Se(le,`${l(De).inquiry_no??""} `),Dr(xe,`odz-badge odz-badge-sm odz-gap-0.5 odz-whitespace-nowrap ${l(Ie).class??""}`),Se(Re,l(Ie).label),Se(Pe,l(De).title||"( )"),Se(vt,l(De).customer_name),Se(Qt,Et)},[()=>Q(l(De).created_at)],at),At("click",ce,()=>k(l(De))),U(Te,ce)});var de=x(me,2),Qe=g(de),Fe=x(Qe);{var Oe=Te=>{var De=s$(),ce=g(De);Ne(()=>Se(ce,`/  ${l(i).length??""}`)),U(Te,De)};ve(Fe,Te=>{l(a).length!==l(i).length&&Te(Oe)})}Ne(()=>Se(Qe,` ${l(a).length??""} `)),U(ae,ue)};ve(Y,ae=>{l(a).length===0?ae(j):ae(ee,!1)},!0)}U(Me,$e)};ve(M,Me=>{l(d)?Me(ge):Me(_e,!1)},!0)}U(P,K)};ve(z,P=>{l(A)?P(E):P(F,!1)})}var I=x(re,2);const O=at(()=>{var P;return((P=l(v))==null?void 0:P.id)||""}),D=at(()=>{var P;return((P=l(v))==null?void 0:P.inquiry_no)||""});fs(WK(I,{get qnaId(){return l(O)},get inquiryNo(){return l(D)},get isOpen(){return l(p)},set isOpen(P){_(p,P)},$$events:{verify:H,cancel:Z},$$legacy:!0}),P=>_(w,P),()=>l(w)),Cr(ie,()=>l(c),P=>_(c,P)),Ku(pe,()=>l(u),P=>_(u,P)),U(n,N),dn()}var l$=$('<div class="odz-flex odz-items-center odz-justify-center odz-h-full"><div class="odz-loading odz-loading-dots odz-loading-md odz-text-gray-400"></div></div>'),d$=$('<div class="odz-text-center odz-text-red-500 odz-py-4"> </div>'),c$=$('<div class="odz-text-center odz-text-gray-500 odz-py-8"><p>  .</p> <p class="odz-text-sm odz-mt-1">   .</p></div>'),u$=$('<div class="odz-flex odz-justify-center"><div class="odz-px-3.5 odz-py-2 odz-bg-gray-200 odz-text-gray-600 odz-text-sm odz-rounded-full"> </div></div>'),h$=$("<button><!></button>"),f$=$('<div><div class="odz-flex-shrink-0"><div><!></div></div> <div><span class="odz-text-sm odz-text-gray-500 odz-mb-1"> </span> <div class="odz-group odz-relative"><div> </div> <!></div> <span class="odz-text-xs odz-text-gray-400 odz-mt-1"> </span></div></div>'),p$=$('<span class="odz-loading odz-loading-spinner odz-loading-sm"></span>'),g$=$('<div class="odz-flex odz-flex-col odz-h-full odz-min-h-[300px]"><div class="odz-flex-1 odz-overflow-y-auto odz-space-y-4 odz-p-5 odz-bg-slate-50/50 odz-rounded-2xl odz-border odz-border-slate-100 odz-max-h-[500px] odz-shadow-inner"><!></div> <div class="odz-mt-4 odz-flex odz-gap-2"><textarea placeholder=" ..." class="odz-textarea odz-textarea-bordered odz-flex-1 odz-resize-none odz-h-14 odz-rounded-2xl odz-bg-white odz-border-slate-200 focus:odz-border-primary odz-shadow-sm odz-p-4"></textarea> <button class="odz-btn odz-btn-primary odz-rounded-2xl odz-h-14 odz-w-14 odz-p-0 odz-shadow-sm hover:odz-shadow-md hover:odz-scale-105 odz-transition-all"><!></button></div></div>');function v$(n,e){ln(e,!1);let t=ht(e,"qnaId",8),r=ht(e,"isManager",8,!1),o=ht(e,"customerName",8,""),s=Be([]),i=Be(""),a=Be(!0),A=Be(!1),d=Be(""),c=null,u=Be();to(async()=>{await h(),p()}),gs(()=>{c&&c2(c)}),AS(()=>{v()});async function h(){try{_(a,!0),_(d,""),_(s,await Rq(t()))}catch(fe){console.error("[QnaComments]  :",fe),_(d,"    .")}finally{_(a,!1)}}function p(){c=Gq(t(),async fe=>{console.log("[QnaComments]  :",fe),await h()})}function v(){l(u)&&br(u,l(u).scrollTop=l(u).scrollHeight)}async function w(){if(l(i).trim())try{_(A,!0);const fe=r()?"manager":"customer",ie=r()?"":o();await sC(t(),{writer:fe,writer_name:ie,content:l(i).trim()}),_(i,"")}catch(fe){console.error("[QnaComments]  :",fe),alert("    .")}finally{_(A,!1)}}async function y(fe){if(confirm("  ?"))try{await qq(fe),_(s,l(s).filter(ie=>ie.id!==fe))}catch(ie){console.error("[QnaComments]  :",ie),alert("    .")}}function B(fe){fe.key==="Enter"&&!fe.shiftKey&&(fe.preventDefault(),w())}function C(fe){switch(r()?fe.writer:fe.writer,fe.writer){case"customer":return{icon:Wl,class:"odz-bg-blue-100 odz-text-blue-600",isMe:!r()};case"manager":return{icon:CE,class:"odz-bg-green-100 odz-text-green-600",isMe:r()};case"system":return{icon:gE,class:"odz-bg-gray-100 odz-text-gray-600",isMe:!1};default:return{icon:Wl,class:"odz-bg-gray-100 odz-text-gray-600",isMe:!1}}}function Q(fe){if(!fe)return"";const ie=new Date(fe),pe=new Date;return ie.toDateString()===pe.toDateString()?ie.toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}):ie.toLocaleDateString("ko-KR",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}fn();var k=g$(),H=g(k),Z=g(H);{var q=fe=>{var ie=l$();U(fe,ie)},N=fe=>{var ie=kt(),pe=it(ie);{var te=ne=>{var ze=d$(),z=g(ze);Ne(()=>Se(z,l(d))),U(ne,ze)},Ce=ne=>{var ze=kt(),z=it(ze);{var E=I=>{var O=c$();U(I,O)},F=I=>{var O=kt(),D=it(O);tr(D,1,()=>l(s),P=>P.id,(P,K)=>{var M=kt();const ge=at(()=>C(l(K)));var _e=it(M);{var Me=Y=>{var j=u$(),ee=g(j),ae=g(ee);Ne(()=>Se(ae,l(K).content)),U(Y,j)},$e=Y=>{var j=f$(),ee=g(j),ae=g(ee),ue=g(ae);Ib(ue,()=>l(ge).icon,(Ie,V)=>{V(Ie,{class:"odz-w-4 odz-h-4"})});var me=x(ee,2),ye=g(me),Ee=g(ye),de=x(ye,2),Qe=g(de),Fe=g(Qe),Oe=x(Qe,2);{var Te=Ie=>{var V=h$(),G=g(V);c1(G,{class:"odz-w-3.5 odz-h-3.5 odz-text-gray-400 hover:odz-text-red-500"}),Ne(()=>Dr(V,`odz-absolute odz-top-0 ${(l(ge).isMe?"odz-left-0 -odz-translate-x-full odz-pr-1":"odz-right-0 odz-translate-x-full odz-pl-1")??""} odz-opacity-0 group-hover:odz-opacity-100 odz-transition-opacity`)),At("click",V,()=>y(l(K).id)),U(Ie,V)};ve(Oe,Ie=>{(l(ge).isMe||r())&&l(K).writer!=="system"&&Ie(Te)})}var De=x(de,2),ce=g(De);Ne(Ie=>{Dr(j,`odz-flex odz-gap-2 ${(l(ge).isMe?"odz-flex-row-reverse":"")??""}`),Dr(ae,`odz-w-8 odz-h-8 odz-rounded-full ${l(ge).class??""} odz-flex odz-items-center odz-justify-center`),Dr(me,`odz-flex odz-flex-col odz-max-w-[70%] ${(l(ge).isMe?"odz-items-end":"odz-items-start")??""}`),Se(Ee,l(K).writer_name||l(K).writer),Dr(Qe,`odz-px-4 odz-py-2.5 odz-rounded-2xl odz-text-base odz-whitespace-pre-wrap odz-shadow-sm ${(l(ge).isMe?"odz-bg-primary odz-text-white":"odz-bg-white odz-text-slate-800 odz-border odz-border-slate-200")??""}`),Se(Fe,l(K).content),Se(ce,Ie)},[()=>Q(l(K).created_at)],at),U(Y,j)};ve(_e,Y=>{l(K).writer==="system"?Y(Me):Y($e,!1)})}U(P,M)}),U(I,O)};ve(z,I=>{l(s).length===0?I(E):I(F,!1)},!0)}U(ne,ze)};ve(pe,ne=>{l(d)?ne(te):ne(Ce,!1)},!0)}U(fe,ie)};ve(Z,fe=>{l(a)?fe(q):fe(N,!1)})}fs(H,fe=>_(u,fe),()=>l(u));var re=x(H,2),be=g(re),L=x(be,2),R=g(L);{var J=fe=>{var ie=p$();U(fe,ie)},se=fe=>{BE(fe,{class:"odz-w-5 odz-h-5"})};ve(R,fe=>{l(A)?fe(J):fe(se,!1)})}Ne(fe=>{be.disabled=l(A),L.disabled=fe},[()=>l(A)||!l(i).trim()],at),Cr(be,()=>l(i),fe=>_(i,fe)),At("keydown",be,B),At("click",L,w),U(n,k),dn()}var m$=$('<button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-transition-transform hover:odz-rotate-90" title=""><!></button>'),w$=$('<div class="odz-flex odz-flex-col odz-items-center odz-justify-center odz-py-20 odz-gap-4"><div class="odz-loading odz-loading-spinner odz-loading-lg odz-text-primary"></div> <span class="odz-text-gray-500 odz-animate-pulse">   ...</span></div>'),y$=$('<div class="odz-alert odz-alert-error odz-shadow-sm odz-rounded-2xl"><!> <span> </span></div>'),_$=$('<span class="odz-inline-flex odz-items-center odz-gap-1.5 odz-px-3.5 odz-py-1.5 odz-rounded-full odz-bg-primary/10 odz-text-primary odz-text-xs odz-font-semibold odz-border odz-border-primary/20 odz-shadow-sm"><!> </span>'),b$=$('<button class="odz-btn odz-btn-sm odz-btn-outline odz-gap-1.5 odz-rounded-xl odz-shadow-sm hover:odz-shadow-md odz-transition-all"><!> </button>'),x$=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),B$=$('<button class="odz-btn odz-btn-sm odz-btn-primary odz-gap-1.5 odz-rounded-xl odz-shadow-sm hover:odz-shadow-md hover:odz-scale-105 odz-transition-all"><!> </button>'),z$=$('<span class="odz-loading odz-loading-spinner odz-loading-xs"></span>'),C$=$('<div class="odz-dropdown odz-dropdown-end"><button tabindex="0" role="button" class="odz-btn odz-btn-sm odz-btn-outline odz-gap-1.5 odz-rounded-xl odz-shadow-sm hover:odz-shadow-md odz-transition-all"><!> </button> <ul tabindex="0" class="odz-dropdown-content odz-z-[1] odz-menu odz-p-2 odz-shadow-xl odz-bg-base-100 odz-rounded-2xl odz-w-32 odz-mt-2 odz-border odz-border-gray-100 odz-backdrop-blur-sm"><li><button class="odz-rounded-lg"></button></li> <li><button class="odz-rounded-lg"></button></li> <li><button class="odz-rounded-lg"></button></li></ul></div> <!> <button class="odz-btn odz-btn-sm odz-btn-ghost odz-text-error odz-btn-square odz-rounded-xl hover:odz-bg-error/10 odz-transition-colors" title=""><!></button>',1),S$=$('<button type="button" class="odz-w-full odz-text-left odz-bg-slate-50 odz-rounded-2xl odz-p-4 odz-border odz-border-slate-100 hover:odz-bg-white hover:odz-shadow-xl hover:odz-border-primary/30 odz-transition-all odz-cursor-pointer odz-group"><div class="odz-flex odz-items-center odz-justify-between odz-mb-2"><div class="odz-flex odz-items-center odz-gap-2"><div class="odz-p-1.5 odz-rounded-lg odz-bg-white odz-border odz-border-slate-200 group-hover:odz-border-primary/20 group-hover:odz-bg-primary/10 odz-transition-colors"><!></div> <span class="odz-font-mono odz-text-sm odz-font-bold odz-text-slate-900"> </span></div> <span> </span></div> <div class="odz-flex odz-items-end odz-justify-between odz-gap-4"><p class="odz-text-sm odz-font-semibold odz-text-slate-700 odz-line-clamp-1 odz-flex-1"> </p> <span class="odz-text-[11px] odz-text-slate-400 odz-whitespace-nowrap"> </span></div></button>'),E$=$('<div class="odz-bg-white odz-rounded-2xl odz-p-6 odz-border odz-border-gray-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)]"><div class="odz-flex odz-items-center odz-justify-between odz-mb-5"><h4 class="odz-text-base odz-font-bold odz-text-primary odz-uppercase odz-tracking-widest odz-flex odz-items-center odz-gap-2"><!>  </h4> <span class="odz-inline-flex odz-items-center odz-px-3 odz-py-1 odz-rounded-full odz-bg-primary/10 odz-text-primary odz-text-sm odz-font-bold"> </span></div> <div class="odz-grid odz-grid-cols-1 md:odz-grid-cols-2 odz-gap-3"></div></div>'),F$=$('<div class="odz-bg-white odz-rounded-2xl odz-p-6 odz-border odz-border-gray-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)]"><div class="odz-flex odz-items-center odz-justify-between odz-mb-5"><h4 class="odz-text-base odz-font-bold odz-text-slate-900 odz-uppercase odz-tracking-widest odz-flex odz-items-center odz-gap-2"><div class="odz-w-1.5 odz-h-5 odz-bg-primary odz-rounded-full"></div>  </h4> <span class="odz-inline-flex odz-items-center odz-px-3 odz-py-1 odz-rounded-full odz-bg-slate-100 odz-text-slate-600 odz-text-sm odz-font-bold"> </span></div> <!></div>'),I$=$('<div class="odz-relative odz-overflow-hidden odz-bg-white odz-rounded-2xl odz-p-6 odz-border odz-border-gray-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)]"><div class="odz-absolute odz-top-0 odz-right-0 odz-w-64 odz-h-64 odz-bg-primary/5 -odz-z-10 odz-rounded-full -odz-mr-20 -odz-mt-20"></div> <div class="odz-flex odz-flex-wrap odz-items-start odz-justify-between odz-gap-6"><div class="odz-flex odz-flex-col odz-gap-3"><div class="odz-flex odz-items-center odz-gap-2 odz-flex-wrap"><span class="odz-px-2.5 odz-py-1 odz-bg-slate-50 odz-rounded-lg odz-text-xs odz-font-mono odz-font-semibold odz-text-slate-600 odz-border odz-border-slate-200 odz-shadow-sm"> </span> <span><!> </span> <!></div> <h3 class="odz-text-2xl odz-font-extrabold odz-text-slate-900 odz-leading-tight"> </h3></div> <div class="odz-flex odz-items-center odz-gap-2 odz-flex-wrap"><!> <!></div></div> <div class="odz-divider odz-my-5"></div> <div class="odz-grid odz-grid-cols-2 sm:odz-grid-cols-4 odz-gap-6 odz-p-6 odz-bg-slate-50 odz-rounded-2xl odz-border odz-border-slate-100"><div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-[13px] odz-font-bold odz-text-slate-500 odz-uppercase odz-tracking-wider"></span> <p class="odz-text-base odz-text-slate-900"> </p></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-[13px] odz-font-bold odz-text-slate-500 odz-uppercase odz-tracking-wider"></span> <p class="odz-text-base odz-text-slate-900"> </p></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-[13px] odz-font-bold odz-text-slate-500 odz-uppercase odz-tracking-wider"></span> <p class="odz-text-sm odz-text-slate-900 odz-break-all"> </p></div> <div class="odz-flex odz-flex-col odz-gap-1.5"><span class="odz-text-[13px] odz-font-bold odz-text-slate-500 odz-uppercase odz-tracking-wider"></span> <p class="odz-text-sm odz-text-slate-900"> </p></div></div></div> <!> <div class="odz-bg-white odz-rounded-2xl odz-p-6 odz-border odz-border-gray-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)]"><h4 class="odz-text-base odz-font-bold odz-text-slate-900 odz-uppercase odz-tracking-widest odz-mb-4 odz-flex odz-items-center odz-gap-2"><div class="odz-w-1.5 odz-h-5 odz-bg-primary odz-rounded-full"></div>  </h4> <div class="odz-prose odz-prose-lg odz-max-w-none odz-text-slate-900 odz-whitespace-pre-wrap odz-leading-relaxed odz-bg-slate-50/50 odz-p-8 odz-rounded-2xl odz-border odz-text-base odz-border-slate-100"> </div></div> <!> <div class="odz-bg-white odz-rounded-2xl odz-p-6 odz-border odz-border-gray-200 odz-shadow-[0_4px_20px_rgba(0,0,0,0.06)]"><h4 class="odz-text-base odz-font-bold odz-text-slate-900 odz-uppercase odz-tracking-widest odz-mb-5 odz-flex odz-items-center odz-gap-2"><div class="odz-w-1.5 odz-h-5 odz-bg-primary odz-rounded-full"></div> </h4> <!></div>',1),U$=$('<div class="odz-space-y-4"><div class="odz-flex odz-items-center odz-justify-between odz-pb-4 odz-border-b odz-border-gray-200"><div class="odz-flex odz-items-center odz-gap-3"><h2 class="odz-text-2xl odz-font-bold odz-text-slate-900 odz-tracking-tight"> </h2></div> <!></div> <!></div>');function Q$(n,e){ln(e,!1);const t=Be();let r=ht(e,"qnaId",8);ht(e,"shopId",8);let o=ht(e,"isManager",8,!1),s=ht(e,"onBack",8,void 0),i=ht(e,"onEdit",8,void 0),a=ht(e,"onConvertToEstimate",8,void 0),A=ht(e,"onViewEstimate",8,void 0),d=Be(null),c=[],u=[],h=Be([]),p=Be([]),v=Be(!0),w=Be(""),y=Be(!1),B=Be(!1),C=null;to(async()=>{await Q(),k()}),gs(()=>{C&&c2(C)});async function Q(){try{if(_(v,!0),_(w,""),_(d,await Wg(r())),!l(d)){_(w,"   .");return}const[E,F,I,O]=await Promise.all([l2(r()),d2(r()),u2(r()),h2(r())]);c=E,u=F,_(h,H(c,u,I,O)),await Z(l(h));try{_(p,await tK(r()))}catch(D){console.warn("[QnaDetail]    :",D),_(p,[])}}catch(E){console.error("[QnaDetail]  :",E),_(w,"     .")}finally{_(v,!1)}}function k(){C=$q(r(),async E=>{console.log("[QnaDetail]  :",E),await Q()})}function H(E,F,I,O){const D=new Map;return E.forEach(P=>{const K=P.idx??0;D.has(K)||D.set(K,{idx:K,productId:P.product_id,productName:P.product_name,variants:[],prints:[],simplePrints:[],addons:[],totalQuantity:0});const M=D.get(K);M.variants.push({variantId:P.variant_id||"",variantName:P.variant_name,quantity:P.quantity||0,optionValues:P.option_values}),M.totalQuantity+=P.quantity||0}),F.forEach(P=>{const K=P.idx??0,M=D.get(K);M&&M.prints.push({objectId:P.object_id||"",printType:P.print_type||"none",title:P.title,printMethod:P.print_method,templateId:P.template_id,colors:P.colors,uploadedFiles:P.uploaded_files,fileMetadata:P.file_metadata,memo:P.memo})}),I.forEach(P=>{const K=P.idx??0,M=D.get(K);M&&M.simplePrints&&M.simplePrints.push({objectId:P.object_id||"",printMethod:P.print_method,templateId:P.template_id,selectedColors:P.selected_colors,printConfig:P.print_config,uploads:P.uploads,nameSheet:P.name_sheet,memo:P.memo,price:P.price})}),O.forEach(P=>{const K=P.idx??0,M=D.get(K);M&&M.addons&&M.addons.push({addonId:P.addon_id,addonName:P.addon_name||"",selectedProductId:P.selected_product_id,selectedProductName:P.selected_product_name||"",selectedVariantId:P.selected_variant_id,selectedVariantName:P.selected_variant_name||"",quantity:P.quantity||0})}),Array.from(D.values())}async function Z(E){for(const F of E)for(const I of F.prints){if(!I.title&&I.objectId)try{const O=await fg(I.objectId);O&&(I.title=O.title)}catch(O){console.warn("[QnaDetail]    :",O)}if(I.templateId)try{const O=await ud(I.templateId);O.length>0&&(I.parentTemplates=O.map(D=>({id:D.id,name:D.name||D.id})))}catch(O){console.warn("[QnaDetail]    :",O)}}}function q(E){switch(E){case"pending":return{label:"",class:"odz-bg-amber-100 odz-text-amber-700 odz-border-amber-200",icon:bp};case"answered":return{label:"",class:"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200",icon:l1};case"closed":return{label:"",class:"odz-bg-slate-200 odz-text-slate-600 odz-border-slate-300",icon:Vu};default:return{label:"",class:"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200",icon:bp}}}function N(E){return E?new Date(E).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-"}function re(E){switch(E){case"temp":return{label:"",class:"odz-bg-slate-200 odz-text-slate-600 odz-border-slate-300"};case"pending":return{label:"",class:"odz-bg-amber-100 odz-text-amber-700 odz-border-amber-200"};case"progress":return{label:"",class:"odz-bg-sky-100 odz-text-sky-700 odz-border-sky-200"};case"completed":return{label:"",class:"odz-bg-emerald-100 odz-text-emerald-700 odz-border-emerald-200"};case"canceled":return{label:"",class:"odz-bg-rose-100 odz-text-rose-700 odz-border-rose-200"};case"hold":return{label:"",class:"odz-bg-slate-200 odz-text-slate-600 odz-border-slate-300"};default:return{label:E,class:"odz-bg-slate-100 odz-text-slate-600 odz-border-slate-200"}}}function be(){s()&&s()()}function L(E){A()?A()(E):window.location.href=`/?mode=register&estimateId=${E}&returnTo=qna`}function R(){var E;i()&&((E=l(d))!=null&&E.id)&&i()(l(d).id)}async function J(){var E;if((E=l(d))!=null&&E.id&&confirm("  ?     ."))try{_(B,!0),await Dq(l(d).id),alert(" ."),s()&&s()()}catch(F){console.error("[QnaDetail]  :",F),alert("   .")}finally{_(B,!1)}}async function se(){var E;if((E=l(d))!=null&&E.id&&confirm("   ?"))try{_(y,!0);const F=await Kq(l(d).id);alert(" ."),a()&&a()(F)}catch(F){console.error("[QnaDetail]   :",F),alert("    .")}finally{_(y,!1)}}async function fe(E){var F;if((F=l(d))!=null&&F.id)try{await oC(l(d).id,E),_(d,{...l(d),status:E})}catch(I){console.error("[QnaDetail]   :",I),alert("    .")}}Yt(()=>l(d),()=>{_(t,l(d)&&((l(d).product_amount??0)>0||(l(d).print_amount??0)>0||(l(d).addon_amount??0)>0||(l(d).additional_amount??0)>0))}),mo(),fn();var ie=U$(),pe=g(ie),te=x(g(pe),2);{var Ce=E=>{var F=m$(),I=g(F);xA(I,{class:"odz-w-5 odz-h-5"}),At("click",F,be),U(E,F)};ve(te,E=>{s()&&E(Ce)})}var ne=x(pe,2);{var ze=E=>{var F=w$();U(E,F)},z=E=>{var F=kt(),I=it(F);{var O=P=>{var K=y$(),M=g(K);Vu(M,{class:"odz-w-6 odz-h-6"});var ge=x(M,2),_e=g(ge);Ne(()=>Se(_e,l(w))),U(P,K)},D=P=>{var K=kt(),M=it(K);{var ge=_e=>{var Me=I$();const $e=at(()=>q(l(d).status));var Y=it(Me),j=x(g(Y),2),ee=g(j),ae=g(ee),ue=g(ae),me=g(ue),ye=x(ue,2),Ee=g(ye);Ib(Ee,()=>l($e).icon,(pt,_t)=>{_t(pt,{class:"odz-w-3 odz-h-3"})});var de=x(Ee),Qe=x(ye,2);{var Fe=pt=>{var _t=_$(),$t=g(_t);ec($t,{class:"odz-w-3 odz-h-3"}),U(pt,_t)};ve(Qe,pt=>{l(d).converted_estimate_id&&pt(Fe)})}var Oe=x(ae,2),Te=g(Oe),De=x(ee,2),ce=g(De);{var Ie=pt=>{var _t=b$(),$t=g(_t);A5($t,{class:"odz-w-4 odz-h-4"}),At("click",_t,R),U(pt,_t)};ve(ce,pt=>{i()&&l(d).status==="pending"&&pt(Ie)})}var V=x(ce,2);{var G=pt=>{var _t=C$(),$t=it(_t),Rt=g($t),Ot=g(Rt);bE(Ot,{class:"odz-w-4 odz-h-4"});var Ct=x(Rt,2),Wt=g(Ct),It=g(Wt),St=x(Wt,2),jt=g(St),dr=x(St,2),pr=g(dr),ar=x($t,2);{var ur=Ar=>{var Lr=B$(),Kr=g(Lr);{var xr=Hr=>{var cn=x$();U(Hr,cn)},Pr=Hr=>{ec(Hr,{class:"odz-w-4 odz-h-4"})};ve(Kr,Hr=>{l(y)?Hr(xr):Hr(Pr,!1)})}Ne(()=>Lr.disabled=l(y)),At("click",Lr,se),U(Ar,Lr)};ve(ar,Ar=>{!l(d).converted_estimate_id&&l(h).length>0&&Ar(ur)})}var Ir=x(ar,2),Yr=g(Ir);{var Jr=Ar=>{var Lr=z$();U(Ar,Lr)},qr=Ar=>{c1(Ar,{class:"odz-w-4 odz-h-4"})};ve(Yr,Ar=>{l(B)?Ar(Jr):Ar(qr,!1)})}Ne(()=>{Cs(It,"odz-font-bold",l(d).status==="pending"),Cs(jt,"odz-font-bold",l(d).status==="answered"),Ir.disabled=l(B)}),At("click",It,()=>fe("pending")),At("click",jt,()=>fe("answered")),At("click",pr,()=>fe("closed")),At("click",Ir,J),U(pt,_t)};ve(V,pt=>{o()&&l(d).status!=="closed"&&pt(G)})}var le=x(j,4),Le=g(le),He=x(g(Le),2),je=g(He),xe=x(Le,2),Re=x(g(xe),2),et=g(Re),qe=x(xe,2),ot=x(g(qe),2),Pe=g(ot),Ye=x(qe,2),rt=x(g(Ye),2),lt=g(rt),vt=x(Y,2);{var Ft=pt=>{var _t=E$(),$t=g(_t),Rt=g($t),Ot=g(Rt);ec(Ot,{class:"odz-w-5 odz-h-5"});var Ct=x(Rt,2),Wt=g(Ct),It=x($t,2);tr(It,5,()=>l(p),mr,(St,jt)=>{var dr=S$();const pr=at(()=>{var pn;return re(((pn=l(jt).estimate)==null?void 0:pn.status)||"")});var ar=g(dr),ur=g(ar),Ir=g(ur),Yr=g(Ir);ec(Yr,{class:"odz-w-4 odz-h-4 odz-text-slate-400 group-hover:odz-text-primary"});var Jr=x(Ir,2),qr=g(Jr),Ar=x(ur,2),Lr=g(Ar),Kr=x(ar,2),xr=g(Kr),Pr=g(xr),Hr=x(xr,2),cn=g(Hr);Ne(pn=>{var Wr,wr;Se(qr,((Wr=l(jt).estimate)==null?void 0:Wr.estimate_no)||"-"),Dr(Ar,`odz-inline-flex odz-items-center odz-px-2 odz-py-1 odz-rounded-md odz-text-[10px] odz-font-bold odz-border ${l(pr).class??""}`),Se(Lr,l(pr).label),Se(Pr,((wr=l(jt).estimate)==null?void 0:wr.name)||"  "),Se(cn,pn)},[()=>N(l(jt).created_at)],at),At("click",dr,()=>L(l(jt).estimate_id)),U(St,dr)}),Ne(()=>Se(Wt,l(p).length)),U(pt,_t)};ve(vt,pt=>{l(p).length>0&&pt(Ft)})}var Qt=x(vt,2),Et=x(g(Qt),2),mt=g(Et),Gt=x(Qt,2);{var Ht=pt=>{var _t=F$(),$t=g(_t),Rt=x(g($t),2),Ot=g(Rt),Ct=x($t,2);iC(Ct,{get products(){return l(h)},disabled:!0}),Ne(()=>Se(Ot,`${l(h).length??""}`)),U(pt,_t)};ve(Gt,pt=>{l(h).length>0&&pt(Ht)})}var Ut=x(Gt,2),st=x(g(Ut),2);v$(st,{get qnaId(){return r()},get isManager(){return o()}}),Ne(pt=>{Se(me,`#${l(d).inquiry_no??""}`),Dr(ye,`odz-inline-flex odz-items-center odz-gap-1.5 odz-rounded-full odz-px-3.5 odz-py-1.5 odz-text-xs odz-font-semibold odz-shadow-sm odz-border ${l($e).class??""}`),Se(de,` ${l($e).label??""}`),Se(Te,l(d).title||"( )"),Se(je,l(d).customer_name),Se(et,l(d).customer_phone||"-"),Se(Pe,l(d).customer_email||"-"),Se(lt,pt),Se(mt,l(d).content||"( )")},[()=>N(l(d).created_at)],at),U(_e,Me)};ve(M,_e=>{l(d)&&_e(ge)},!0)}U(P,K)};ve(I,P=>{l(w)?P(O):P(D,!1)},!0)}U(E,F)};ve(ne,E=>{l(v)?E(ze):E(z,!1)})}U(n,ie),dn()}var T$=$('<dialog id="estimate-modal" class="odz-modal odz-py-10 odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-7xl odz-h-full main-estimate-modal-box"><form method="dialog"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2"></button></form> <!></div></dialog>'),L$=$('<dialog id="button-estimate-modal" class="odz-modal odz-modal-open"><div class="odz-modal-box odz-w-11/12 odz-max-w-7xl odz-h-[90vh] odz-overflow-y-auto odz-relative"><button class="odz-btn odz-btn-sm odz-btn-circle odz-btn-ghost odz-absolute odz-right-2 odz-top-2 odz-z-10" type="button"></button> <div id="button-fixed-products-container" class="odiz-app"></div></div> <form method="dialog" class="odz-modal-backdrop"><button>close</button></form></dialog>'),P$=$("<main><!> <!></main>");function k$(n,e){ln(e,!1);const[t,r]=Vo(),o=()=>an(Gl,"$customerStore",t);let s=Be(""),i="",a="",A="",d="",c="",u="",h="",p="",v="",w="",y=Be(!1),B=null,C=Be(null),Q=[],k=null,H=null,Z="list",q=!1,N=null,re=null,be=null,L=null,R=Be(!1),J=null;function se(){var Y,j,ee,ae,ue,me,ye,Ee,de,Qe;i=((Y=document.getElementById("odiz-product-id"))==null?void 0:Y.value)||"",A=((j=document.getElementById("odiz-shop-id"))==null?void 0:j.value)||"",d=((ee=document.getElementById("odiz-sess"))==null?void 0:ee.value)||"",c=((ae=document.getElementById("odiz-customer-id"))==null?void 0:ae.value)||"",a=((ue=document.getElementById("odiz-mall_type"))==null?void 0:ue.value)||"",u=((me=document.getElementById("odiz-customer-name"))==null?void 0:me.value)||"",h=((ye=document.getElementById("odiz-customer-phone"))==null?void 0:ye.value)||"",p=((Ee=document.getElementById("odiz-customer-address1"))==null?void 0:Ee.value)||"",v=((de=document.getElementById("odiz-customer-address2"))==null?void 0:de.value)||"",w=((Qe=document.getElementById("odiz-customer-postcode"))==null?void 0:Qe.value)||""}function fe(){document.querySelectorAll("input.odiz-hidden-class").forEach(j=>{const ee=j.value;if(ee){const ae=document.getElementsByClassName(ee);for(let ue=0;ue<ae.length;ue++)ae[ue].style.display="none"}})}function ie(Y,j,ee,ae,ue){const me=document.createElement("div");me.className="odiz-estimate-preview-container odiz-app";const ye=ee.closest("div");ye&&(ye.insertAdjacentElement("afterend",me),Sa(S9,{target:me,props:{uuid:Y,idx:j,appType:ae,isAddCost:ue}}))}function pe(Y){const j=document.getElementById("inc_order_view");if(!j){console.warn("[ODIZ] #inc_order_view    .");return}j.querySelectorAll(".info").forEach(ae=>{var Ee;if(ae.hasAttribute("data-odiz-processed"))return;const ue=((Ee=ae.textContent)==null?void 0:Ee.replace(/\s+/g," ").trim())||"";if(!ue.toLowerCase().includes("odiz"))return;const me=/([a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}(?:-add)?)-(\d+)/i,ye=ue.match(me);if(ye){let de=ye[1],Qe=!1;de.endsWith("-add")&&(de=de.slice(0,-4),Qe=!0);const Fe=ye[2];Q.push({uuid:de,idx:Fe}),ae.setAttribute("data-odiz-processed","true"),ie(de,Fe,ae,Y,Qe),console.log(`[ODIZ] Admin UUID : ${de}-${Fe} (isAddCost: ${Qe})`)}})}function te(Y){let ae=0;function ue(){return document.getElementById("inc_order_view")&&(pe(Y),Q.length>0)?(console.log(`[ODIZ] Admin : ${Q.length} UUID   (: ${ae+1})`),!0):!1}if(ue())return;console.log("[ODIZ] Admin : #inc_order_view   ...  ");const me=setInterval(()=>{if(ae++,ue()){clearInterval(me);return}ae>=10?(clearInterval(me),console.warn("[ODIZ] Admin : 10   UUID  ")):console.log(`[ODIZ] Admin :  ${ae}/10...`)},1e3)}function Ce(Y,j=5e3){return new Promise(ee=>{const ae=document.getElementById(Y);if(ae)return ee(ae);const ue=new MutationObserver(()=>{const me=document.getElementById(Y);me&&(ue.disconnect(),ee(me))});ue.observe(document.body,{childList:!0,subtree:!0}),setTimeout(()=>{ue.disconnect(),ee(null)},j)})}function ne(Y){let ee=new URLSearchParams(window.location.search).get(Y);if(ee)return ee;try{if(ee=new URL(window.location.href).searchParams.get(Y),ee)return ee}catch{}const ae=document.getElementById(`odiz-${Y}`);return ae!=null&&ae.value?ae.value:null}to(async()=>{var de,Qe,Fe,Oe,Te;try{const De=await h5();De>0&&console.log(`[ODIZ]   : ${De}    .`)}catch(De){console.error("[ODIZ]    :",De)}const Y=ne("mode"),j=ne("estimateId"),ee=ne("returnTo");console.log("[ODIZ] URL parameters:",{urlMode:Y,urlEstimateId:j,urlReturnTo:ee});let ae=((de=document.getElementById("odiz-app-type"))==null?void 0:de.value)||"";(Y==="register"||Y==="list")&&(ae=Y,console.log("[ODIZ] AppType set from URL:",ae)),j&&(k=j,console.log("[ODIZ] EditingEstimateId set:",k));const ue=ne("qnaId"),me=ne("qnaMode"),ye=ne("isManager");if(ue&&(H=ue,console.log("[ODIZ] EditingQnaId set:",H)),(me==="register"||me==="list"||me==="detail")&&(Z=me,console.log("[ODIZ] QnaMode set from URL:",Z)),(ye==="true"||ye==="1")&&(q=!0,console.log("[ODIZ] IsQnaManager set:",q)),!ae){console.warn("[ODIZ] No appType detected, exiting early");return}const Ee=document.getElementById("odiz-estimate");if(Ee&&Ee.addEventListener("click",z),se(),fe(),ni.set({id:A,name:"",sess:d,customer_id:c}),Gl.set({name:u,phone:h,address1:p,address2:v,postcode:w,mallType:a}),B=document.getElementById("odiz-estimate-list"),ae==="order"||ae==="admin")if(ae==="admin")te(ae);else{const De=document.getElementById("select-order-class"),ce=document.getElementById("select-order-class-uuid");if(De&&ce){const Ie=De.value,V=ce.value,G=document.getElementsByClassName(Ie);if(G.length>0){const le=G[0].getElementsByClassName(V);for(let Le=0;Le<le.length;Le++){const He=le[Le],je=((Qe=He.textContent)==null?void 0:Qe.trim())||"",xe=/odiz\s*:\s*([a-f0-9-]+)-(\d+)/i,Re=je.match(xe);if(Re){let et=Re[1],qe=!1;et.endsWith("-add")&&(et=et.slice(0,-4),qe=!0);const ot=Re[2];Q.push({uuid:et,idx:ot}),ie(et,ot,He,ae,qe)}}}}}if(ae==="list"&&B&&Sa($R,{target:B,props:{openEstimateModal:(De,ce)=>{gt.reset(),_(y,De),_(C,ce)}}}),ae==="run"&&i){const De=document.getElementById("odiz-run-btn"),ce=((Fe=document.getElementById("odiz-run-btn-name"))==null?void 0:Fe.value)||" ";if(De){const Ie=document.createElement("button");Ie.textContent=ce,Ie.type="button",Ie.className="odz-btn odz-btn-primary",Ie.onclick=ze,De.appendChild(Ie)}}if(ae==="fixed"){const De=document.getElementById("odiz-fixed-area");if(De&&i){const ce=document.createElement("div");if(ce.className="odiz-fixed-product-container odiz-app",De.appendChild(ce),a)try{const Ie=await Yf(a,i);Ie&&(_(s,Ie.id),Sa(Du,{target:ce,props:{productId:l(s)}}))}catch{}else i&&(_(s,i),Sa(Du,{target:ce,props:{productId:l(s)}}))}}if(ae==="button"){const De=document.getElementById("odiz-button-area");if(De&&i){const ce=((Oe=document.getElementById("odiz-button-text"))==null?void 0:Oe.value)||"  ",Ie=((Te=document.getElementById("odiz-button-class"))==null?void 0:Te.value)||"odz-btn odz-btn-primary",V=document.createElement("button");V.textContent=ce,V.type="button",V.className=Ie,V.onclick=E,De.appendChild(V),console.log("[ODIZ] Button mode initialized",{buttonText:ce,productIdValue:i,mallType:a,shopId:A})}else console.warn("[ODIZ] Button mode: Missing odiz-button-area or product ID")}if(ae==="register"){console.log("[ODIZ] Register mode detected, waiting for container...");const De=await Ce("odiz-estimate-register-area");if(De){console.log("[ODIZ] Container found, mounting EstimateRegister with estimateId:",k);const ce=document.createElement("div");ce.className="odiz-estimate-register-container odiz-app",De.appendChild(ce),Sa(Eq,{target:ce,props:{mallType:a,customerId:c,sess:d,shopId:A,estimateId:k,returnTo:ee||"list"}})}else console.error("[ODIZ] Failed to find #odiz-estimate-register-area after 5s timeout"),console.error('[ODIZ] Make sure PHP template includes: <div id="odiz-estimate-register-area"></div>')}if(ae==="qna"){console.log("[ODIZ] QNA mode detected (dialog-based)");const De=await Ce("odiz-qna-area");if(De){console.log("[ODIZ] QNA container found, mounting QnaList as main view...");const ce=document.createElement("div");ce.className="odiz-qna-container odiz-app",De.appendChild(ce),Sa(A$,{target:ce,props:{shopId:A,customerId:c||void 0,onSelectQna:Ie=>{re=Ie,K()},onCreateNew:()=>{N=null,P()}}}),H?Z==="detail"?(re=H,setTimeout(()=>K(),100)):Z==="register"&&(N=H,setTimeout(()=>P(),100)):Z==="register"&&(N=null,setTimeout(()=>P(),100))}else console.error("[ODIZ] Failed to find #odiz-qna-area after 5s timeout"),console.error('[ODIZ] Make sure PHP template includes: <div id="odiz-qna-area"></div>')}});async function ze(){gt.reset(),_(C,null);try{a&&er(Gl,dt(o).mallType=a,dt(o));const Y=await Yf(a,i);Y?(_(s,Y.id),_(y,!0)):alert("     .")}catch{alert("     .")}}function z(){_(s,""),gt.reset(),_(C,null),_(y,!0)}async function E(){console.log("[ODIZ] Button mode click triggered");try{if(a&&i){const Y=await Yf(a,i);if(Y)_(s,Y.id),console.log("[ODIZ] Button mode: Product resolved",{productId:l(s),mallType:a,productIdValue:i});else{console.error("[ODIZ] Button mode: Product not found"),alert("     .");return}}else if(i)_(s,i);else{console.error("[ODIZ] Button mode: No product ID available"),alert("   .");return}gr.reset(),Xn.reset(),_(R,!0),await ra(),I()}catch(Y){console.error("[ODIZ] Button mode error:",Y),alert("     .")}}function F(){if(console.log("[ODIZ] Button mode: Closing modal"),J){try{hv(J)}catch(j){console.warn("[ODIZ] Button mode: Failed to unmount component:",j)}J=null}const Y=document.getElementById("button-fixed-products-container");Y&&(Y.innerHTML=""),_(R,!1)}function I(){const Y=document.getElementById("button-fixed-products-container");if(!Y){console.error("[ODIZ] Button mode: Container not found");return}Y.innerHTML="",J=Sa(Du,{target:Y,props:{productId:l(s)}}),console.log("[ODIZ] Button mode: FixedProducts mounted",{productId:l(s)})}function O(Y){Y.style.cssText=`
      display: flex !important;
      justify-content: center !important;
      align-items: center !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      width: 100vw !important;
      height: 100vh !important;
      max-width: 100vw !important;
      max-height: 100vh !important;
      margin: 0 !important;
      padding: 0 !important;
      border: none !important;
      background: transparent !important;
    `}function D(Y){Y.style.cssText="",Y.close()}function P(){const Y=document.getElementById("qna-register-dialog-wrapper"),j=document.getElementById("qna-register-dialog");if(Y&&j){if(Y.classList.add("odiz-app"),be){try{hv(be)}catch(ee){console.warn("[ODIZ] Failed to unmount previous QnaRegister instance:",ee)}be=null}j.innerHTML="",Y.oncancel=ee=>{ee.preventDefault()},be=Sa(qK,{target:j,props:{shopId:A,mallType:a,customerId:c||void 0,customerName:u,customerPhone:h,qnaId:N||"",onSubmitSuccess:ee=>{D(Y),re=ee,K()},onCancel:()=>{D(Y)}}}),Y.showModal(),O(Y)}}function K(){const Y=document.getElementById("qna-detail-dialog-wrapper"),j=document.getElementById("qna-detail-dialog");if(Y&&j&&re){if(Y.classList.add("odiz-app"),L){try{hv(L)}catch(ee){console.warn("[ODIZ] Failed to unmount previous QnaDetail instance:",ee)}L=null}j.innerHTML="",Y.oncancel=ee=>{ee.preventDefault()},L=Sa(Q$,{target:j,props:{qnaId:re,shopId:A,isManager:q,onBack:()=>{D(Y)},onEdit:ee=>{D(Y),N=ee,P()},onConvertToEstimate:ee=>{console.log("[ODIZ] Converted to estimate:",ee),alert(` . ( ID: ${ee})`)}}}),Y.showModal(),O(Y)}}fn();var M=P$(),ge=g(M);{var _e=Y=>{var j=T$(),ee=g(j),ae=g(ee),ue=g(ae),me=x(ae,2);QM(me,{get productId(){return l(s)},get estimate(){return l(C)},get isEstimateModal(){return l(y)},set isEstimateModal(ye){_(y,ye)},$$legacy:!0}),At("click",ue,()=>_(y,!1)),U(Y,j)};ve(ge,Y=>{l(y)&&Y(_e)})}var Me=x(ge,2);{var $e=Y=>{var j=L$(),ee=g(j),ae=g(ee),ue=x(ee,2),me=g(ue);At("click",ae,F),At("click",me,F),U(Y,j)};ve(Me,Y=>{l(R)&&l(s)&&Y($e)})}U(n,M),dn(),r()}Sa(k$,{target:document.getElementById("odiz-app")});export{Pn as _,O$ as c,mS as g};
